unaggregated data distribute prevalent diverse source interaction user web service IP traffic data cooky user query interleave analytics data typically utilizes statistic express sum specify function apply frequency occurrence distinct active sum sum frequency frequency cap statistic cap frequency parameter random sample effective efficient estimation statistic query ideally estimate statistic function sample frequency probability roughly proportional challenge standard sample easily compute aggregate data compute frequency aggregation costly structure proportional active sample framework unaggregated data pas distribute data structure proportional desire sample unifies classic distinct sum specifically capped sample nonnegative unbiased estimate monotone non decrease frequency statistic statistical guarantee quality standard cap statistic furthermore multi objective sample statistical guarantee quality concave sub linear statistic nonnegative span cap function incur logarithmic overhead sample CCS concept theory computation sketch sample additional frequency statistic distribute aggregation processing introduction data available service interaction user web service content IP traffic unaggregated model data val universe val multiple data reside distribute storage aggregate  data active data unique  val sum data unweighted uniform val data refer frequency proportional actual frequency dataset consistency refer frequency frequency statistic data fundamental data analytics query nonnegative function selection predicate specifies population typically monotone non decrease frequent contribution frequent prominent pth frequency frequency cap statistic cap function parameter capT min cap statistic frequency widely apply data analytics distinct distinct active cap assume sum sum cap cap function extreme mitigate domination statistic typically frequent representation frequent cap statistic prevalent online advertising platform advertiser specify limit impression campaign individual user expose duration advertisement typically target  user demographic geographic location  capT qualify opportunity query data advertiser prediction potential qualify impression prediction compute estimate quickly facilitate interactive campaign planning computation frequency statistic aggregate data representation aggregate however runtime structure linear distinct distinct whereas scalable computation limit runtime structure translates memory communication data discard IP traffic limited pas constraint motivate summary dataset approximate random sample effective summary data sample data compute aggregate compute compute sample data classic scheme probability proportion pps  successive sample without replacement ppswor sequential poisson priority sample sample compute approximate frequency statistic apply appropriate estimator sample understood tradeoff sample statistical guarantee quality approximation proportion statistic population upper bound coefficient variation CV roughly inverse acm transaction algorithm vol article publication date september sample framework application frequency cap statistic CV standard error normalize unbiased estimator normalize error NRMSE obtain NRMSE statistic sample usually distinct obtain confidence interval estimate actual sample moreover CV bound worstcase tight distribution dominate scheme apply aggregate data standard sample scheme estimator challenge sample scheme realize structure desire sample perform data achieve tradeoff estimation quality aggregate standard sample scheme distinct sum query sample SH sample scheme another  sum query distinct reservoir sample distinct query SH distinct sample unbiased estimate frequency statistic CV upper bound target statistic SH establish however comparable statistical guarantee statistic contribution overview sample framework unaggregated data generalizes exist scheme distinct SH sample sample aggregate data sample scheme framework specify random function apply isolation data tailor statistic estimate accordingly define random variable minimum finally sample framework detailed pas algorithm identifies sample pas computes frequency pas facilitate estimation summary structure composable allows parallel distribute computation scheme sample distribution pas scheme partial information frequency sample partial frequency estimation generic pas algorithm applies unweighted cast distinct classic SH sample scheme sample scheme tailor frequency cap statistic function intuitive discrete applies uniform powerful continuous applies arbitrary positive generalize function distinct classic SH sample specify discrete scheme SH parametrized integer cap parameter maximum frequency scheme SH approach classic SH identical distinct sample express unique unbiased admissible estimator discrete frequency statistic specify nonnegative integer continuous scheme SH parameter positive exposition rely discrete maxx SH approach sample version acm transaction algorithm vol article publication date september cohen sample minx SH approach distinct sample derive estimator frequency statistic function continuous differentiable almost everywhere statistic frequency cap statistic express continuous monotone function differentiable almost everywhere surprisingly continuous yield elegant specification estimator estimate capT statistic SH sample CV upper bound  CV bound standard statistic sample tailor gracefully degrades disparity max sample cap parameter statistic cap parameter estimate frequency function SH sample unbiased monotone non decrease nonnegative versatile estimator derive express sample transform frequency sample frequency invert transform transform matrix vector discrete integral transform continuous latter estimator expression derivative estimator unique inverse transform minimum variance unbiased nonnegative estimator sample scheme meaning variance optimally information sample discrete estimator generalize matrix inversion apply reference estimate distribution sample netflow SH IP continuous scheme estimator novel SH scheme previously estimator sum statistic address application estimate statistical guarantee multiple possibly concave sublinear statistic concave sublinear statistic capT function statistic nonnegative span cap function express nonnegative linear combination cap function important frequency compute SH sample exponentially increase cap parameter capT statistic query estimate sample parameter closest statistic span estimate respective linear combination estimate capT statistic multi objective sample efficient sample tradeoff accuracy sample continuous scheme multi objective scheme aggregate data sample coordination multi objective sample target CV bound lnn distinct propose sample algorithm estimator highly practical despite technical analysis application resembles classic SH distinct sample approximate distinct counting algorithm prevalent industrial application experimental evaluation demonstrates superior accuracy versus sample tradeoff sample statistic PRELIMINARIES datasets consist val universe val dataset aggregate unaggregated otherwise define frequency val sum active define uniform aggregate unaggregated dataset active acm transaction algorithm vol article publication date september sample framework application frequency cap statistic review relevant sample scheme aggregate datasets poisson sample dataset specify sample probability sample independent probability estimate frequency statistic sample apply inverse probability estimator estimator interpret sum  estimate otherwise estimator apply available nonnegative unbiased actually minimum variance unbiased nonnegative sum estimator sum per estimate probability data function sample optimal sample probability sample probability proportional contribution pps minimize sum per variance pps statistical guarantee estimate  proportion statistic variance estimate var  CV normalize standard error bound average proportion scheme others sample scheme mention introduction statistical guarantee fix sample  quality estimation closer sequential poisson priority sample quality scheme particularly relevant treatment unaggregated datasets ppswor successively without replacement probability proportional frequency unaggregated data relative remain unsampled sample realize associate random exp exponentially distribute parameter increase correspond exactly ppswor sample fix threshold sample pre specify threshold alternatively obtain fix sample latter convenient define finally estimate statistic ppswor sample fix threshold sample compute probability sample apply inverse probability  depends available sample fix sample define interpret probability sample fix randomization estimator unbiased moreover estimate obtain zero covariance allows bound variance acm transaction algorithm vol article publication date september cohen query variance expression pre specify threshold appendix proof unbiasedness nonnegative covariance extends broader framework unaggregated data introduce outline bound var per fix threshold var appendix theorem CV statistic proportion essentially within sample standard CV ppswor sample respect compute distribute aggregate data structure sample sample respect simply replace compute ppswor sample sum statistic unaggregated distribute data efficiency albeit caveat obtain frequency sample efficient sample unaggregated data however polynomial bound structure algorithm approximates frequency sampling framework framework sample unaggregated datasets extends ppswor sample sample scheme realize distribute setting structure cache sample structure exceeds sample sample scheme framework specify mapping function data numeric mapping specify distribution hdist random hash distribution hdist independent function hdist monotone non decrease  hdist function randomly data numeric ElementScore exp val exp val independent exponential random variable parameter val define min ElementScore random variable minimum data ppswor obtain fix threshold sample fix sample specify sample notation express distribution function distribution hdist establish useful assumption assumption streamline analysis limited independence suffices hash representation code sketch typically performance non perfect hash function analysis acm transaction algorithm vol article publication date september sample framework application frequency cap statistic lemma SeedDist SeedDist hdist exp random variable independent prr SeedDist proof distribution monotonicity minimum independent random variable exp val exponentially distribute sum obtain exp  distribution specify exp assumption hdist independence ideal random hash function positive probability assumption combine exponential distribution positive cdf positive lemma implies joint distribution depends aggregate data corollary fix threshold fix sample positive probability sample positive probability minimum estimation overview sample apply estimator approximate  ppswor estimator express sum per estimate estimate sample therefore suffices sum estimate sample unbiasedness sample positive probability estimation information frequency sample frequency sample compute pas data allows compute inclusion probability inverse probability estimate pure sequential pas generally partial information frequency sample random variable distribution parametrized independent sample fix scheme distribution distribution fix threshold sample derive estimator express sample transform depends distribution outcome distribution unbiased  obtain invert transform express function independent subset sample  independent transforms obtain unique inverse estimator optimal minimum variance unbiased nonnegative sum estimator pas estimator optimal rely information instead sample distribution acm transaction algorithm vol article publication date september cohen  variance estimator pas estimator appendix establish fix scheme unbiasedness nonpositive covariance per estimate allows express variance estimator statistic distribution per variance allows extend variance analysis ppswor appendix unaggregated data scheme estimation quality approach standard CV upper bound sample probability roughly proportional function roughly distributes exp challenge identify achieve distribute data structure sampling ALGORITHMS pas sample scheme pas identifies sample fix threshold sample sample contains specify threshold fix sample sample contains minimum specify sample operation summary structure distribute summarization initialize structure processing data update structure merge compose summary structure datasets obtain summary structure union algorithm specifies operation pas fix sample initialization empty sample threshold upper bound processing sample update minimum sample sample sample delete update merge procedure union sample sample otherwise sample obtain sample remove easy verify sample satisfies definition respective operation fix sample structure simpler initialization empty sample processing sample delete sample merge sample union associate sample pas compute frequency algorithm specifies structure operation distribute computation fix  sample sampling ALGORITHMS discrete pas scheme sequential processing data apply multiple sharded shard sample facilitate estimation partial information frequency sample discrete continuous differently algorithm discrete applies acm transaction algorithm vol article publication date september sample framework application frequency cap statistic algorithm pas fix sample pas data sample output sample initialize structure sample upper bound ElementScore data update sample sample min ElementScore ElementScore sample sample sample arg  sample sample delete sample merge sample sample obtain sample foreach sample sample sample sample sample sample sample sample sample min sample sample min sample sample delete sample return sample algorithm pas sample pas II input sample indexed output frequency sample initialize frequency foreach sample frequency data update frequency sample frequency frequency merge frequency frequency frequency foreach sample frequency frequency frequency return frequency uniform unweighted continuous fix threshold sample fix threshold sample algorithm discrete algorithm maintains empty counter indexed sample otherwise ElementScore insert initialize computation per fix sample algorithm sample algorithm fix sample discrete algorithm maintain counter counter indexed empty sample denote counter maintain lazily compute recall define minimum algorithm maintains lazy fashion delay randomize currently  otherwise ElementScore insert sample evict maximum fully evaluate reflect currently acm transaction algorithm vol article publication date september cohen algorithm sample fix threshold discrete data threshold output counter initialize counter cache foreach counter counter counter ElementScore counter initialize return counter counter algorithm sample fix discrete data sample output counter initialization upper bound ElementScore foreach counter counter counter ElementScore counter counter arg max counter counter counter counter ElementScore counter delete counter return counter counter evict pop maximum candidate eviction  iterate decrease  becomes evict obtain latter  candidate eviction algorithm computation however decrease counter processing amortize per algorithm plus priority queue operation ofO priority queue distinct sum sampling cast exist classic sample scheme framework distinct cap statistic SH cap sum statistic discrete continuous function generalize distinct sample distinct sample uniform sample active meaning sample subset active equally likely hdist specify ElementScore distribution SeedDist sample respect fix threshold retain active fix sample scheme distinct variant reservoir sample compute retain hash acm transaction algorithm vol article publication date september sample framework application frequency cap statistic distinct sample algorithm obtain frequency sample enters cache evict fix scheme probability sample therefore apply inverse probability estimator distribute sample algorithm distinct cap statistic obtain active pas estimator without pas estimate quality distinct sample optimize distinct statistic cap CV upper bound proportion distinct cap CV upper bound equivalent ppswor estimator capT statistic however CV grows rapidly uniform sample active easily contribute statistic sample SH classic SH fix sample threshold fix sample specify uniform  cast framework distribution hdist ElementScore exp independent drawn minimum exp exponentially distribute parameter SeedDist exp therefore reference SH sample actually ppswor sample respect frequency pas distribute algorithm algorithm frequency apply ppswor estimator sample algorithm algorithm geometric parameter exp truncate probability exp  unbiased estimator statistic SH sample exp exp estimator nonnegative monotone non decrease exp cap statistic  ppswor sample CV exceeds target frequency distribution highly skewed ppswor sample dominate proportion capT statistic mostly frequency  representation sample error estimator related scheme drawn replacement reference estimator reference instead exp equivalent due monotone mapping preserve minimum fix sample instead stratify exp acm transaction algorithm vol article publication date september cohen SH sample probability axis per frequency axis probability constant probability proportional probability proportional min estimate cap statistic discrete cap FUNCTIONS discrete scheme apply data uniform scheme parametrized integer distinct sample SH classic SH SH SH estimate frequency cap statistic SH function uniform random bucket return hash hash bucket independent ElementScore hash rand define minimum distribution uniform generally attempt bucket obtain likely sample diminish return min sample probability roughly proportional whereas  min roughly constant inclusion probability regardless frequency cap parameter relative inverse sample threshold SH SH illustrates sample probability function parameter estimator SH output sample algorithm threshold coefficient express estimator vector depends threshold parameter ith entry contribution estimate estimate statistic  distinct sample estimator express  notation whereas classic SH estimator express seek estimator unbiased admissible nonnegative non decrease acm transaction algorithm vol article publication date september sample framework application frequency cap statistic probability vector probability ith SH vector depends parameter  aij probability exactly min bucket definition aij min otherwise min compute relation aij grows vector converge vector entry therefore suffices compute entry coupon collector probability bucket vector min suffices compute min  entry vanishes beyond pas estimator probability sample illustrate pas scheme apply inverse probability estimator invert sample derive estimator notation random variable statistic express relation notation upper triangular matrix corresponds vector therefore linearity unbiased estimator therefore compute estimate invert inverse matrix upper triangular structure express respect another   constraint obtain ofy ofy obtain equation  acm transaction algorithm vol article publication date september cohen allows iteratively compute  distinct sample classic SH however non zero entry theorem estimator  unbiased proof substitute obtain estimator unbiased estimate   unbiased estimate contribution statistic   therefore contribution express  inverse unique estimator unbiased estimator admissible minimum variance compute entry limit sum expression min application coefficient compute sketch estimate nonnegative monotone non decrease theorem monotone non decrease proof prefix sum  positive induction induction  acm transaction algorithm vol article publication date september sample framework application frequency cap statistic rearrange obtain argue nonnegative summand nonnegative nonnegativity sum induction hypothesis nonnegativity difference non increase recall probability ith nonnegative therefore establish nonnegativity estimation coefficient nonnegativity monotonicity nonnegativity  prefix sum continuous cap FUNCTIONS continuous SH sample scheme generalizes SH scheme reference continuous advantage discrete apply uniform fix sample sample longer explicitly maintain lazy cached algorithm lazy implicitly capture threshold estimator express derivative continuous scheme facilitates multi objective sample scheme parameter specify hash hdist function return otherwise hash function KeyBase ElementScore KeyBase exp exp KeyBase distribution SeedDist lemma SeedDist exp equivalently return probability exp otherwise proof lemma SeedDist hdist exp equation obtain exp happens probability KeyBase otherwise memoryless exponential distribution implies conditional distribution exp probability distribution exp qualitatively exponentially distribute parameter ppswor  uniform distinct sample obtain acm transaction algorithm vol article publication date september cohen algorithm cont SH sample fix data threshold  output counter initialize counter cache foreach counter counter counter rand max exp max KeyBase min initialize counter counter return counter counter relative sample probability function frequency SH pps ppswor compute respect cap axis inclusion probability maximum inclusion probability scheme normalize threshold inclusion probability maximizes ppswor SH plot overlap sample probability roughly proportional cap approach standard CV estimation pas sample pas sample obtain frequency sample compute probability sample lemma sample function max min proof exp KeyBase independent joint probability exp probability express combine probability obtain allows apply inverse probability estimator equation estimate statistic proof appendix theorem CV capT estimator apply SH sample frequency CV capT max obtain bound CV bound max obtain sample compute aggregate data CV upper bound degrades smoothly disparity max increase CV due constant disparity arise analysis inherent acm transaction algorithm vol article publication date september sample framework application frequency cap statistic relative inclusion probability function frequency SH pps ppswor respect cap gap ratio SH pps ppswor realizable aggregate data illustrates loss relative standard CV gap frequency around cap parameter maximizes ratio data frequency cap threshold variance fix sample sample algorithm maintain fix sample threshold decrease cached evict algorithm simulates threshold eviction fix randomization compute cached threshold evict randomization capture compute maximum threshold evict respect randomization threshold maximum maximum evict remain counter update accord elaborate threshold compute cache distribution randomization  requirement evict threshold    treat processing uncached frequency threshold cache simply reverse entry cache cache KeyBase algorithm compute sample cached partial frequency continuously assign frequency algorithm performs fix threshold sample processing cached update otherwise fix randomization allows obtain decrease function compute minimum max otherwise KeyBase finally initialize counter equivalent insert cache remain express distribution  counter verify satisfies requirement depends recall fix threshold SH specify whereas fix cache SH statement randomization determines proof appendix theorem fix SH algorithm fix SH algorithm max density exp max interval acm transaction algorithm vol article publication date september cohen algorithm continuous SH sample fix data sample output counter initialize cache foreach counter counter counter rand max exp max KeyBase min insert counter counter evict foreach counter rand rand min  counter eviction threshold KeyBase arg maxx counter delete counter evict threshold foreach counter adjust counter accord max counter max delete deallocate memory arg maxx counter KeyBase delete counter evict KeyBase threshold return counter counter batch eviction optimization decrease threshold involves scan cache eviction however lnn val val distinct threshold sample contains KeyBase random permutation  distinct probability update threshold min sum lnn threshold obtain expectation processing frequency expectation val decrease threshold expectation factor cached exponentially distribute reduce amortize eviction slight modification algorithm evicts cache cache modification  instead maximum evict threshold computation estimator respect threshold batch eviction eviction acm transaction algorithm vol article publication date september sample framework application frequency cap statistic estimator continuous SH seek unbiased nonnegative estimator coefficient function define estimator theorem continuous differentiable almost everywhere estimator min unbiased proof separately treat unbiased estimation coefficient density otherwise estimate contribution estimate unbiased estimation coefficient frequency density continuous monotone function capT function differentiable almost everywhere hence satisfies requirement theorem acm transaction algorithm vol article publication date september cohen upper bound CV fix SH estimator proof appendix theorem CV estimator capT specify equation coefficient SH sample upper bound CV capT max max CV CV sum estimation sample scheme sample estimation coefficient establish appendix theorem CV upper bound bound frequency sample multi objective  establish fix SH sample estimate capT statistic  interested estimate statistical guarantee cap suffices SH sample parameter fori query capT statistic SH sample closest within factor fromt estimate cap statistic suffices sample maxx minx moreover estimate statistic continuous discrete combine nonnegative linear combination capT function respective sum estimate capT capT capT capT unbiased estimator unbiased expectation sum sum expectation moreover CV bound estimate capT lemma CV max CV capT proof bound variance variance sum random variable var cov capT capT  var capT var capT  capT acm transaction algorithm vol article publication date september sample framework application frequency cap statistic bound CV CV var capT capT max capT capT max CV capT improve approach instead sample respective cap sample SL improvement component sample coordination ensures sample closer SL estimator benefit combine sample sample algorithm structure proportional SL sample coordination coordinate sample randomization context randomization constitutes independent random variable hash exp minimum exp component coordination express function hash sample threshold active surprisingly distinct SL sample coordinate lnn active dataset lemma coordinate fix SH sample SL lnn moreover probability SL lnn decrease exponentially proof increase sample sample contains sample hash sort compute probability participates participate sample hence participate probability ith participate sample hash prefix therefore suffices prefix exactly recall hash independent hence probability moreover probability independent sequence SL participate sample sum probability SL min lnn concentration independence inclusion apply chernoff bound acm transaction algorithm vol article publication date september cohen corollary proof fix randomization membership contiguous interval endpoint hash hash estimation estimator leverage sample SL allows obtain tighter estimate sample pas sample available sample compute probability fix randomization probability apply inverse probability estimate inclusion probability individual variance estimate query obtain   sample estimate decompose sum capT estimate variance hence CV estimate obtain dedicate sample hence lemma CV estimate dedicate estimator capT detail compute probability probability compute define kth threshold otherwise  lemma exp max proof independent random variable exp hash inclusion max hash inclusion SL hash satisfy contains contiguous interval express kth function piecewise linear function lnn expectation allows compute SL sample algorithm realize sample scheme structure proportional distinct SL cap parameter decrease maintain hash hash composable sketch  data expectation lnn  experimental evaluation aim understand error distribution estimator analysis statistical guarantee error standard acm transaction algorithm vol article publication date september sample framework application frequency cap statistic attainable aggregate data analysis however dependence disparity max factor pas pas assume frequency distribution error reflect advantage replacement sample significant skew therefore actual error upper bound sample algorithm estimator implement python numpy random  library simulation perform macbook mac mini computer attempt benchmark performance computationally algorithm widely apply distinct sample counting algorithm easily tune datasets platform generate uniform drawn zipf distribution parameter zipf parameter typical datasets finely understand error dependence skew zipf skewed distinct per average distinct simulation respective sample compute frequency reference error computation estimate sample cap parameter continuous sample compute discrete continuous fix SH sample discrete SH sample algorithm function continuous SH sample algorithm sample compute estimate frequency cap statistic capT parameter discrete SH estimator compute estimation coefficient theorem continuous SH estimator coefficient function capT statistic min min combination compute estimate obtain pas algorithm apply equation discrete scheme equation continuous scheme inverse probability estimate min continuous scheme outline discrete scheme estimate compute relative NRMSE error average multiple rep rep simulation hash function randomness simulation error combination discrete SH continuous SH minimum error statistic across sample bold discussion parameter error cap statistic diagonal analysis error minimize degrades disparity  distinct sample threshold therefore effectively emulate  SH realistic distribution considerable performance gain appropriate sample cap statistic sensitivity error parameter increase skew zipf parameter ratio error bold minimum sample estimate distinct acm transaction algorithm vol article publication date september cohen simulation discrete SH factor whereas reverse fold increase error  statistic instead minimum however optimistic error population frequency distribution population error error pas versus estimate distinct diverge otherwise benefit pas limited typically agrees CV upper bound slightly estimate suggests choice scheme computational platform estimate NRMSE upper bound approximate distinct counting fairly tight dependence frequency distribution simulation cap minimum error typically CV upper bound suggests adaptive confidence bound sample frequency rely CV upper bound related compute statistic unaggregated data toolbox deterministic structure misra gries frequent sample algorithm random linear projection linear sketch clearer population sample sample estimation quality deterioration disparity due allocation sample probability within theory bound tightly adversely sample skewed distribution distinct frequency obtain sample acm transaction algorithm vol article publication date september sample framework application frequency cap statistic simulation continuous SH linear sketch project frequency vector dimensional vector linearity implies efficient update sketch processing distribute related frequency cap statistic sketch stable distribution estimate frequency sample technique apply cap statistic appropriate stable distribution cap function specific choice query sample sample roughly proportionally  replacement effective skewed data polylogarithmic encode overhead relevance characterization monotone frequency statistic estimate polylogarithmic pas construction however mostly theoretical generally linear sketch significant encode overhead update positive outperform sample sketch practical distinct counting algorithm sample MinHash sketch sum query SH experimentally dominate linear sketch presence negative update conclusion propose powerful sample framework suitable distribute unaggregated data framework generalizes classic scheme distinct sum acm transaction algorithm vol article publication date september cohen statistic core randomize function data tailor statistic estimate sample specify function tailor cap statistic derive correspond estimator quality nearly sample compute aggregate ahead apply framework statistic extend negative update understand theoretical limit approach   sample sample specify continuous probability distribution SeedDist parametrized nonnegative SeedDist assign independent SeedDist sample denote sample estimate statistic compute per  positive estimate sample scheme sample aggregate data perform pas frequency sample estimate assumption estimator scheme instead sample obtain random  assume  distribution parameterized EA random  independent variance estimator non increase var EA non increase assumption inverse probability estimator establish useful assumption unbiased estimate therefore linearity expectation equation unbiased estimate statistic establish assumption lemma unbiasedness acm transaction algorithm vol article publication date september sample framework application frequency cap statistic proof kth random variable distribution expectation fix fix assumption EA finally estimate nonpositive covariance assumption estimate independent inclusion lemma nonpositive covariance proof sample sample estimate  strict inequality negative covariance covariance zero determines  distribution independent distribution  random variable independent probability happens sample threshold  assumption   independent nonnegative random variable expectation sample sample hence expectation expectation probability sample  expectation therefore  expectation  acm transaction algorithm vol article publication date september cohen bound variance zero covariance allows bound variance estimate statistic sum per variance var var variance var EA EA  variance depends distribution slightly var var relate variance per variance bound assumption var non increase notion domination distribution another distribution function distribution density function dominate function bound equation specify expression function dominates distribution relation lemma var non increase dominate var var var var lemma enables bound variance statistic per  variance var var var partial frequency  distribution proof theorem proof fix SH equation probability frequency sample probability processing occurrence frequency partial derivative respect density function frequency min max exp max exp max acm transaction algorithm vol article publication date september sample framework application frequency cap statistic density function  elsewhere probability sample establish fix sample algorithm precise definition conditioning randomization random hash KeyBase randomization assign  freshly drawn per eviction adjust counter cached threshold depends randomization cached threshold randomization distribution claimed density threshold correctness treatment fix threshold remains eviction threshold eviction threshold eviction evict otherwise kth depends randomization computation adjustment preserve claimed distribution assume distribution claimed respect initial threshold express function threshold probability density probability integral density density deduction exp density deduction adjustment assumption obtain probability KeyBase probability KeyBase remains otherwise probability KeyBase density sum previous deduction exp obtain  probability maintains KeyBase KeyBase probability otherwise acm transaction algorithm vol article publication date september cohen obtain density ppswor variance analysis framework variance analysis methodology  upper bound CV ppswor bound sample scheme ppswor proof notation SW respectively density  distribution function erlang distribution erlang sum independent exponential distribution parameter lemma distribution express sum independent exponential distribution parameter parameter random variable parameter independent dominate erlang proof distribution exp dominate exp exp exp suppose distribution dominate domination applies sum distribution sum random variable dominate distribution sum proof induction ppswor sample respect distribution kth lemma distribution dominate erlang proof definition kth independent exponential random variable parameter exponential distribution minimum exponentially distribute parameter difference minimum exponentially distribute parameter minimum therefore distribution sum exponential random variable parameter  distribution convex combination distribution distribution subset choice probability probability subset ppswor sample therefore lemma distribution dominate erlang parameter theorem ppswor sample respect proportion CV estimate proof extend analysis reference sample without threshold whereas reference wlog sample aggregate data assume population variance inverse probability estimate respect fix threshold variance var relation acm transaction algorithm vol article publication date september sample framework application frequency cap statistic perspective distribution kth lemma dominate erlang bound variance estimate relation var var variance var non increase lemma domination implies var SW var therefore suffices upper bound expectation SW erlang density function kxk relation   bound variance var  var   covariance nonpositive appendix variance sum variance var obtain upper bound CV CV bound sum  WEIGHTED SH fix SH estimator apply sum statistic estimate Qˆ estimate obtain continuous estimator estimation coefficient recall sample distribution ppswor estimator variance ppswor estimator frequency information ppswor inverse probability estimator minimizes variance unbiased estimator express sum sample per unbiased estimate surprisingly obtain upper bound CV theorem SH sum estimator proportion CV proof bound variance estimate probability sample estimate contribution variance otherwise density estimate contribution variance obtain var inequality relation acm transaction algorithm vol article publication date september cohen variance bound obtain proof theorem distribution kth ppswor conclude proof theorem expectation variance distribution SW dominates nonpositive covariance bound variance CV bound  statistic SH variance analysis continuous bound variance relate distribution fix SH distribution ppswor respect min exp min purpose analysis SH distribution exponential instead uniform algorithm estimation monotone transformation preserve SH density function frequency relate exp min lemma cap  density function fix SH dominate max min min proof max min min  max min proof via analysis therefore establish max min min relation equation acm transaction algorithm vol article publication date september sample framework application frequency cap statistic min inequality function exp monotone decrease therefore implies implies therefore obtain equation min therefore equation verify equation max min immediate suffices max suffices max substitute equation inequality obtain max express dominate distribution distribution kth fix SH lemma distribution kth independently drawn dominate function max min density erlang acm transaction algorithm vol article publication date september cohen proof lemma dominate max density kth accord exp min latter distribution dominate lemma transitivity domination CV bound pas estimator bound variance fix SH estimator frequency sample available estimator apply SH sample capT sample bound variance estimate lemma var  max min proof inclusion probability threshold variance inverse probability estimate var  min  inequality relation substitute equation obtain var  min  min remains treat establish min fix maximize    obtain establishes equation recall already assume maximize equation assumption minimize denominator derivative negative therefore minimize substitute obtain equation equation fully establish acm transaction algorithm vol article publication date september sample framework application frequency cap statistic equation substitute equation obtain var  min min min min min min inequality assumption conclude proof theorem bound variance respect distribution dominate function lemma obtain variance var  max min conclude proof theorem estimate  capT proportion capT statistic CV max CV bound pas proof theorem bound variance pas estimator estimator apply sample distribution proof outline pas estimator theorem component bound conditional variance var   available cannot apply lemma instead compute variance pas estimator apply partial frequency lemma var  min min proof estimation coefficient theorem bound var  min inequality unbiasedness capT capT otherwise therefore min min density function ofc  theorem density function analysis acm transaction algorithm vol article publication date september cohen inequality relation forc therefore  maximize inequality function increase therefore fix expression maximize acm transaction algorithm vol article publication date september sample framework application frequency cap statistic derivation substitute maximizes expression discretized threshold sampling variation fix discrete SH sample scheme useful limit algorithm discrete threshold algorithm algorithm sample max discretized threshold data sample output counter initialization sample threshold processing foreach counter counter counter ElementScore counter counter max counter arg max counter counter counter counter ElementScore counter delete counter return counter counter acm transaction algorithm vol article publication date september cohen cache threshold adjust iteration discretized threshold fix SH reference discretized threshold advantage priority queue update another advantage estimator express coefficient reuse sample approximate capT counter computes sample active statistic estimate estimate statistic dataset cap corresponds approximate distinct fundamental cap frequency trivially compute counter construction modify efficient interested estimate capT instead identifier cached sample hash domain domain polynomial distinct sketch logn hash cap polynomial ensure representation logt approximate capT counter structure logt logn estimate CV approximate distinct counter however logarithmic dependence appropriate representation compress logn lightweight algorithm rough approximation capT logarithmic apply return function ElementScore discrete  algorithm apply shelf approximate distinct counter ElementScore recall identifier bucket bucket drawn independently appearance analyse quality approximation lemma distinct generate capT capT proof distinct generate cardinality probability bucket empty bucket expectation distinct counter apply bucket underestimate relative error obtain relative error however error depends distribution cardinality approach obtain rough estimate  capT within logn inherent error benefit accurate distinct counter approach reduce error future apply counting multiple acm transaction 