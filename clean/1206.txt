markov blanket purely subset variable consistent bayesian network inconsistency negative impact markov blanket structure propose markov blanket consistency graph morality define alternative concept moral graph weak recursive  without rely bayesian network although NP undirected graph moral propose linear quadratic algorithm morality maximum graph respectively addition remains NP graph maximum hence remain unknown complexity keywords markov blanket moral graph weakly recursive simplicial computational complexity introduction introduce subset variable bayesian network BN target variable conditionally independent variable markov blanket become popular feature selection causal model throughout assume BN faithful joint probability distribution acyclic graph dag entail exactly conditional independence BN markov blanket MB target variable consists spouse MB vertex subset variable valid MBs variable BN satisfies symmetry consistency symmetry consequence graphical interpretation MBs consistency exist dag admits MBs image KB image dag moral graph MBs dag report explicit causal relation variable prevent symmetry quickly checked enforce previous enforce symmetry arbitrarily union intersection MBs however non trivial consistency without consistent dag MBs incorrect assumption generate model faithful BN hidden variable literature attention MB consistency therefore motivation address importance potential structure feature selection algorithm MB approach motivation emphasize equivalence MB consistency graph morality concept moral graph introduce junction algorithm belief propagation BNs moral graph BN trivially obtain non adjacent vertex BN direction graph moral graph dag vertex non adjacent spouse dag  implies MB vertex dag becomes vertex neighbourhood moral graph hence MBs consistent dag neighbourhood consistent dag undirected graph neighbourhood consistent dag undirected graph moral despite simplicity obtain moral graph BN graph morality NP efficient algorithm morality undirected graph maximum algorithm  candidate graph dag partially graph statistical equivalence DAGs assign direction incident simplicial vertex neighbour subgraph efficient maximum undirected graphical model markov model admits causal interpretation furthermore complexity gap graph morality dimension maximum NP completeness morality graph maximum modification proof important definition moral equivalent weakly recursively simplicial linear quadratic algorithm maximum graph respectively addition hardness morality undirected graph maximum preliminary throughout graph graph treat component simplicity refer graph graph subset vertex denote induced subgraph subgraph emphasize deletion vertex simplify vertex similarly subset denote subgraph denote supergraph graph notation simplify graph simplicial vertex vertex neighbour subgraph deficiency vertex addition neighbourhood clearly vertex simplicial graph weakly recursively simplicial WRS simplicial vertex subset neighbour subgraph weakly recursively simplicial convention empty graph WRS subset empty implies chordal graph WRS subgraph obtain eliminate simplicial vertex neighbour elimination graph graph sequence elimination empty graph WRS however impossible completely eliminate graph WRS graph WRS completely eliminate remove graph however WRS image KB image WRS non WRS graph bayesian network markov blanket variable BN denote minimum subset variable satisfy conditional independency image variable denote vertex denote moral graph acyclic graph underlie undirected structure graph additional connects non adjacent vertex definition implicitly trivial  dag moral graph morality weak recursive  equivalence moral graph WRS graph lemma lemma dag moral graph WRS lemma WRS graph moral graph dag lemma induction vertex dag sink becomes simplicial vertex  detailed proof appendix theorem graph moral WRS proof theorem lemma lemma theorem morality graph  dag chordal implies moral chordal graph recursively simplicial WRS remove delete simplicial vertex converse necessarily graph simplicial vertex recursive WRS eliminate simplicial vertex lemma WRS graph simplicial vertex graph eliminate completely proof theorem implies dag moral graph sink subgraph dag moral graph implies subset neighbour theorem graph completely eliminate hence elimination eliminate completely theorem lemma backtracking algorithm graph moral algorithm return orient hybrid graph exist consistent dag extension   remark graph moral reduce backtracking algorithm remark graph moral simplicial vertex remark graph moral cycle clique complexity morality WRS morality however morality NP surprising subset simplicial vertex neighbour exponentially vertex deletion vertex simplicial later recursive cannot anticipate deletion vertex exponential complexity restrict maximum easy maximum graph trivial morality graph maximum graph chordal recognize polynomial exists polynomial algorithm maximum graph lemma denote neighbour vertex lemma graph moral non adjacent vertex neighbour moral lemma non moral graph vertex neighbour supergraph moral proof graph moral implies possibility simplicial vertex simplicial vertex cannot fully eliminate empty graph dealt separately non simplicial vertex graph simplicial vertex supergraph deficiency deficiency neighbour vertex hence premise neighbour implies supergraph remains non moral assumption non moral simplicial vertex implies elimination exists subgraph non empty supergraph moral additional enable simplicial vertex empty deficiency correspond elimination graph deficiency subgraph however contradict assumption neighbour therefore supergraph remains non moral image KB image vertex simplicial correspond elimination graph benefit vertex vertex graph lemma morality preserve remove simplicial vertex neighbour define neighbourhood vertex union neighbourhood lemma moral graph contains simplicial vertex neighbour neighbour neighbourhood subgraph moral proof assume subgraph moral deletion implies neighbour non adjacent addition neighbour subset implies lemma non empty subset neighbour subgraph moral moreover neighbour graph additional simplicial vertex hence moral hence subset neighbour subgraph non moral lemma morality checked simplicial vertex therefore moral contradicts moral moral lemma conclude morality maximum graph checked recursively remove simplicial vertex neighbour lemma lemma moral graph maximum simplicial vertex subgraph moral proof vertex leaf remove without issue neighbourhood clique vertex assumption implies graph vertex neighbourhood contains vertex neighbour besides vertex moral lemma another neighbour maximum hence graph induced subgraph via vertex therefore subgraph moral image KB image maximum graph vertex simplicial neighbour algorithm appendix pseudocode morality graph maximum loop algorithm eliminates input graph simplicial vertex neighbour algorithm return graph fully eliminate otherwise return false theorem completes algorithm image KB image algorithm morality maximum graph theorem morality maximum graph linear proof correctness algorithm lemma assume graph vertex adjacency vertex bound simplicity vertex algorithm spends  vertex simplicial vertex queue due bound maximum vertex removal constant deletion affect  constant neighbour queue update constant therefore algorithm maximum graph maximum allows simplicial vertex freedom graph therefore choice removal remove simplicial vertex correspond elimination graph later simplicial vertex remove fix denote vertex neighbour graph rid simplicial vertex proof lemma appendix lemma moral graph maximum vertex simplicial subgraph moral simplicial vertex define another concept useful subcases non intersect respectively clique graph obtain definition vertex satisfy otherwise empty graph clique distinct clique contains vertex clique contains odd clique hence vertex clique contains clique hence denote clique clique contains distinct clique focus maximum graph vertex maximum vertex respectively clique clique vertex clique respectively vertex respectively graph contains clique vertex respectively induced subgraph vertex maximum image KB image clique clique clique graph maximal subgraph another clique clique graph maximal subgraph clique clique however maximal subgraph clique situation maximal clique assume maximal unless otherwise corollary moral graph maximum assume contains clique subgraph vertex simplicial subgraph moral proof lemma neighbour neighbour lemma demonstrates morality preserve delete simplicial vertex clique lemma moral graph maximum assume contains clique vertex simplicial subgraph moral proof graph assume subgraph moral implies sequence elimination empty graph another subgraph lemma morality  subgraph imply moral assumption clique maximal implies neither neighbour implies sequence elimination completely eliminates delete assume without loss generality sequence elimination completely eliminates subgraph remove vertex prior sequence eliminate subgraph completely subgraphs remove vertex remove hence subgraph moral contradicts assumption therefore moral graph image KB image maximum graph contains clique lemma simplicial vertex clique clique critical elimination vertex graph without loss generality assume clique vertex vertex lemma moral graph maximum assume contains clique subgraph vertex simplicial distance vertex subgraph subgraph moral proof graph assume subgraph moral another subgraph obtain addition guarantee clique clique useful WRS  cycle implies cycle furthermore distance subgraph infinity implies cycle hence subgraph moral subgraph moral contradicts premise moral therefore subgraph moral image KB image maximum graph contains clique subgraph subgraph lemma moral graph maximum assume contains clique subgraph vertex simplicial distance vertex subgraph subgraph moral proof graph vertex maximum clique cycle clique assume without loss generality cycle remove simplicial vertex render vertex simplicial elimination graph cycle therefore moral subgraph remains moral image KB image maximum graph contains subgraph distance subgraph lemma moral graph maximum assume contains clique subgraph vertex simplicial vertex distance vertex subgraph subgraph moral proof assume without loss generality simplicial vertex graph remove simplicial vertex introduce simplicial vertex elimination graph hence moral subgraph moral simplicial vertex clique lemma shorten morality preserve lemma moral graph maximum assume contains clique vertex simplicial subgraph moral proof assume graph contains clique vertex maximum simplicial subgraph remains moral remove addition clique reduce image KB image clique lemma delete simplicial vertex clique contains reduce consequently clique decrease therefore simplicial vertex clique aim reduce dealt action previously algorithm appendix pseudocode morality graph maximum algorithm simplicial vertex fix moral graph cannot completely eliminate simplicial vertex remove algorithm image KB image algorithm morality maximum graph image KB image maximum moral graph simplicial vertex simplicial vertex remove algorithm otherwise graph recognize moral action lemma theorem morality maximum graph quadratic proof correctness algorithm corollary lemma algorithm initial queue simplicial vertex graph limited maximum simplicial vertex remove neighbour algorithm simplicial vertex algorithm clique however sufficient identify discover breadth calculate distance correspond subgraph graph maximum constraint implies increase linearly vertex breadth assume algorithm simplicial vertex queue therefore algorithm algorithm maximum graph simplicial vertex dealt algorithm vertex bound simplicial vertex clique action algorithm although remove simplicial vertex remove neighbour consequently incident graph graph maximum morality polynomial equivalent consistency MBs maximum checked polynomial remains NP graph maximum graph maximum verma pearl morality NP hardness graph arises freedom delete subset neighbour simplicial vertex impossible anticipate deletion issue maximum graph demonstrate precede however theorem remains NP maximum graph remain unknown complexity theorem morality maximum graph NP theorem straightforwardly modify reduction graph max input formula sketch proof formal proof theorem appendix denote variable clause reduction building variable gadget variable clause gadget clause simulate behaviour variable clause formula auxiliary gadget variable clause gadget desire graph reduction graph maximum graph moral input formula satisfiable sufficient theorem auxiliary gadget gadget modify avoid violate maximum constraint introduce concept WRS ass graph morality weak recursive  obtain dag verma pearl corollary theorem corollary morality graph maximum NP conclusion emphasize importance MB consistency structure feature selection MB approach drew connection MB consistency graph morality despite NP completeness morality propose linear quadratic algorithm morality graph maximum respectively algorithm developed newly define equivalent morality namely weak recursive  gap NP graph maximum modify proof graph maximum leaf NP completeness morality implies minimum minimal  NP useful develop approximation algorithm  undirected graph without appendix proof WRS lemma lemma dag moral graph WRS proof lemma induction vertex denote respectively dag moral graph vertex lemma graph vertex chordal WRS assume moral graph vertex dag WRS moral graph dag WRS dag contains sink vertex dag sink vertex becomes simplicial clique  remove obtain subgraph dag addition moral graph subgraph moral graph vertex incident inductive hypothesis assumes moral graph WRS therefore supergraph WRS image KB image vertex addition removal DAGs correspond moral graph lemma lemma WRS graph moral graph dag proof denote WRS graph vertex define statement node graph WRS graph moral graph dag assume WRS graph moral graph dag WRS graph moral graph dag definition graph WRS simplicial vertex possibly empty WRS graph WRS verify subgraph WRS simplicial vertex inductive assumption WRS graph moral graph dag hence neighbour sink dag moral graph lemma lemma moral graph maximum vertex simplicial subgraph moral proof vertex leaf remove without issue neighbourhood clique vertex hence graph graph vertex assume graph remains lemma simplicial vertex suppose neighbourhood simplicial implies neighbour maximum assumption ensures neighbour neighbour subgraph moral lemma neighbour neighbour subgraph obtain remove vertex moral clique cycle broken remove maximum cycle exists adjacent vertex deletion cycle hence clique broken without issue therefore subgraph moral image KB image maximum graph vertex simplicial neighbour vertex neighbour neighbourhood NG appendix algorithm WRS algorithm pseudocode morality graph maximum computational complexity algorithm pseudocode morality graph maximum computational complexity appendix proof NP theorem theorem morality maximum graph NP proof variable cnf formula false simultaneously hence variable gadget graph variable gadget contains isomorphic subgraphs label variable negation later proof gadget gadget via vertex simplicial vertex gadget purpose avoid upper subgraphs sequence elimination isomorphic sub DAGs image KB image variable gadget variable formula contains subgraphs corresponds literal corresponds literal ensures vertex simplicial elimination neither vertex eliminate clause formula false literal clause cnf formula contains literal simplicity explain clause exactly literal clause disjunction literal literal clause gadget subgraphs corresponds literal isomorphism label literal indicates simultaneously subgraphs clique simulates disjunction operation image KB image clause gadget clause formula consists isomorphic subgraphs label literal clique simulate disjunctive operation auxiliary gadget obtain desire graph auxiliary gadget moral graph exactly simplicial vertex auxiliary gadget clause gadget clause formula verma pearl avoid vertex image KB image auxiliary gadget assist gadget obtain desire graph auxiliary gadget contains vertex clause formula cnf cnf formula variable clause construction graph vertex vertex vertex variable gadget vertex clause gadget vertex auxiliary gadget gadget graph variable gadget auxiliary gadget variable gadget auxiliary gadget variable gadget clause gadget via auxiliary gadget literal clause formula correspond variable clause gadget clause clause clause respectively correspond clause gadget gadget graph construct satisfiable cnf formula connects clause gadget clause avoid vertex auxiliary gadget clause gadget literal correspond variable gadget avoid vertex arbitrary accord verma pearl vertex respectively formula construction described vertex guaranteed image KB image reduction satisfiable cnf moral graph maximum variable gadget clause gadget reduction cnf formula desire graph clearly polynomial remains satisfiable moral gadget implies graph eliminate perfectly variable gadget due elimination vertex suppose subgraph corresponds variable clause gadget vertex eliminate clause satisfied literal otherwise satisfied literal formula satisfiable clause satisfied literal implies clique clause gadget graph eliminate consequently perfectly eliminate completely formula satisfiable clause cannot satisfied assignment variable hence correspond clause gadget cannot eliminate consequently elimination variable gadget vertex therefore graph moral