hieragen automatically generate hierarchical cache coherence protocol hieragen input atomic stable protocol hierarchy hieragen output highly concurrent hierarchical protocol finite machine cache directory controller hieragen reduces complexity architect offload challenge task compose protocol manage concurrency hieragen automatically generate construction MOESI hierarchical protocol dozen transition verify generate protocol safety deadlock freedom model checker introduction cache coherence protocol multicore processor challenge task protocol frequently multicore processor processor addition core core communication incentive coherence protocol protocol radical departure previous protocol validate arduous bug prone source protocol complexity concurrency considers atomic protocol sometimes textbook protocol fairly atomic protocol stable protocol SSPs handful stable coherence MESI easily understood transition diagram however protocol highly concurrent achieve performance transaction progress concurrent transaction complexity concurrent directory protocol dozen transient significant complexity industrial coherence protocol complicate overcome complexity coherence protocol recent automation scheme ProtoGen convert ssp highly concurrent protocol designer ssp transient extra transition accommodate concurrency ProtoGen effective concurrent directory protocol directory colocated cache communicates directly core private cache hierarchy ProtoGen towards automation restrict narrow protocol model directory coherence persist trend away protocol towards protocol hierarchy hierarchy strategy scalable attractive approach multicore processor core increase hierarchy enable coherence protocol scalable hierarchical model hierarchical directory hierarchical cache hierarchy desirable feature greatly complicates coherence protocol transition concurrency crucially communication hierarchy preserve coherence invariant addition complexity verification challenge hierarchy due primarily sidestep challenge verify hierarchical coherence protocol introduce hieragen automation generate construction hierarchical protocol user input SSPs independently user input SSPs protocol subtree oblivious protocol oblivious subtree user specify protocol subtree protocol node protocol clarity refer core private cache core cache node directory collocate optional cache directory cache node standard terminology identify node hierarchy ssp specification directory cache core cache node specification protocol information possibility integrate directory cache node http github com  cap hieragen acm annual international symposium computer architecture isca doi isca directory hierarchical directory multi hierarchical directory hieragen composition SSPs model input hieragen concurrent hierarchical protocol  output finite machine currently murφ model checker facilitate verification easily transform finite machine representation verilog VHDL  accommodate hierarchy introduces challenge beyond ProtoGen address hieragen intermediate non directory cache node completely specify user hieragen compose cache directory intermediate directory cache node hieragen address challenge automatically encapsulate coherence action within coherence transaction vice versa coherence invariant enforce globally hieragen implement concurrency hierarchical multiple coherence transaction serialization directory observation hierarchical ssp correctly enforces coherence globally coherence transaction serialize exactly directory invariant allows leverage ProtoGen generate concurrency hieragen currently limited coherence protocol enforce writer multiple reader SWMR coherence invariant limited inclusive cache hierarchy finally protocol generate hieragen communication node hierarchy summary contribution hieragen automate ssp specification coherence protocol hierarchical generate concurrent hierarchical protocol preserve safety prevent deadlock hieragen generate performance hierarchical protocol standard MOESI coherence verify generate protocol safety deadlock freedom murφ model checker II background brief background coherence protocol brief overview ProtoGen hieragen leverage generate concurrency coherence protocol important coherence protocol multicore coherence protocol satisfy multiple reader SWMR invariant memory location core core addition data invariant mandate return location hieragen currently restrict protocol enforce SWMR protocol however enforce SWMR instance recently propose protocol relax SWMR instead enforce consistency model directly ProtoGen ProtoGen pillar hieragen automatic generation concurrency ProtoGen input hieragen ssp directory protocol domain specific input describes behavior cache controller directory controller assume atomic model transaction flight ProtoGen output finite machine cache controller directory finite machine format murφ model checker facilitate verification ProtoGen overcomes challenge generate protocol cache directory controller correctly handle incoming coherence message transaction leverage insight directory coherence protocol transaction serialize directory ProtoGen enables directory convey serialization cache via request sends cache overcomes ambiguity rename request cache directory achieve consensus transaction ProtoGen generate highly concurrent non non stall controller action consistent ProtoGen flag limit concurrency generate stall protocol latter cache directory controller stall potentially request performance prevent deadlock former generate protocol avoids stall whenever expense increase transient baseline model terminology explanation baseline model constraint explain hieragen vii discus impact hieragen relax constraint baseline model encompasses purpose hieragen equivalent directory cache node coherence private cache collocate cache directory cache attach memory refer closer refer farther subtree brevity refer distinct node directory cache cache core cache node protocol cache core cache node protocol dir cache intermediate directory cache node refer SSPs ssp ssp respectively assume constraint vii relax constraint hierarchy directory inclusive eviction directory knowledge coherence ssp directory protocol cache inclusive communication across hierarchy strictly node cannot communicate directly node communication within hierarchy throughout terminology terminology coherence transient denote transient coherence request  GetS IV hieragen hieragen ssp hierarchy finite machine  inclusion cache without directory knowledge distinct core cache directory cache node illustrate hieragen input output SSPs atomic hierarchical protocol atomic hierarchical protocol concurrent hierarchical protocol SSPs described domain specific DSL employ DSL ProtoGen output finite machine FSMs concurrent hierarchical protocol enable verification FSMs murφ model checker discus detail atomic hierarchical protocol complexity involves generation dir cache intermediate directory cache node highlight node differs input specification node effectively pas unchanged specifically hieragen compose cache dir intermediate dir cache node dir cache node integrate functionality directory functionality intuition hieragen philosophy perform protocol composition without aware specific protocol modify input SSPs encapsulate coherence action within coherence transaction SWMR data invariant enforce globally specifically request originate hieragen ensures writer writer downgrade vein request hieragen ensures reader writer reader writer invalidate encapsulate coherence action within coherence transaction enforce hieragen coherence request originate cache dir suppose dir determines request cannot completely satisfied hieragen encapsulates protocol action within transaction ensure access perform processing ssp hieragen access coherence request leverage ssp hieragen cache generate request access ssp enforces SWMR cache receives response dir infer access perform therefore hieragen resume coherence transaction dir responds cache coherence transaction globally enforce SWMR encapsulate coherence action within coherence transaction via proxy cache coherence request originate cache dir another cache suppose request cannot  satisfied hieragen encapsulates protocol action within transaction ensure request previous scenario hieragen leverage ssp access request entity hieragen leverage request access cache cannot logically belongs dir cannot directly request typically originate directory therefore hieragen clone cache controller ssp proxy cache integrates intermediate dir cache node hieragen proxy cache generate coherence request dir cache proxy cache receives response infer access perform proxy cache proceeds evict cache cache respond requestor thereby enforce SWMR globally hieragen detail via transaction illustrate hieragen protocol activity generate transaction transaction load cache involves dash arrow denote message internal dir cache proxy cache  transaction transaction cache involves dash arrow denote message internal dir cache concrete assume hierarchy typical msi protocol protocol transaction dir cache functionality effectively unchanged respect input SSPs request cache completely satisfied within ssp occurs  GetS request cache dir cache purely handle dir cache data directly dir cache request owner dir cache behaves ssp similarly request cache satisfied within ssp occurs request involvement dir dir cache behaves ssp transaction dir cache functionality hieragen generate correspond dir cache logic concrete transaction ssp load involve ssp illustrate cache cache issue GetS dir cache hieragen processing ssp GetS request corresponds infer otherwise ambiguous label coherence message denote protocol transaction allows writes similarly hieragen processing ssp coherence request cache issue obtain permission GetS hieragen request cache GetS permission dir cache issue GetS request dir cache issue obtain permission dir ssp behave coherence request dir GetS readable data cache owner owner responds data dir cache dir cache cache data responds cache GetS request response response GetS request ssp ssp load involve ssp illustrate concrete GetM request cache cache cache cache sends GetM dir dir request invalidation dir cache sends message request cache acknowledgment hieragen processing ssp invalidation corresponds dir cache emulate due request writable data hieragen functionality via proxy cache introduce previous recall proxy cache essentially clone cache controller integrate dir cache encapsulate coherence transaction perform load hieragen processing ssp coherence request cache issue obtain permission GetM proxy cache issue GetM dir GetM internal request proxy cache dir controller dir sends invalidation cache transition proxy cache GetM transaction completes cache invalidation ack proxy cache transaction ensures cache node appropriate coherence invalid respect cache GetM request GetM transaction completes proxy cache immediately evicts cache dir cache dir dir cache responds appropriate response ssp invalidation ack response data cache node owner dir cache eviction maintain directory inclusion eviction dir cache evict cache node hieragen employ proxy cache purpose hieragen exploit ability ssp discover ssp coherence request invalidates cache node proxy cache issue GetM proxy cache ssp cache owner invalidate sends data proxy cache proxy cache evicts dir cache dir cache dir cache issue  coherence request evict ssp algorithm precisely illustrate algorithm composes cache dir cache proxy cache intermediate dir cache controller algorithm essentially code input controller stitch therefore specify algorithm notation controller discussion access refers access load evict request fwd request refer request request resp associate controller cache refers stable associate cache controller similarly request fwd request await response update response variable code cache controller cache controller component ssp specifies stable happens access incoming request specify abstract specification instantiate specific cache controller illustrates access access cache cache request access cache await response access cache update access fwd request cache fwd request cache cache update fwd request cache response fwd request msi cache controller cache request code sends GetM dir cache await response code data cache update code code pointer empty action message update directory controller directory controller component ssp specifies stable happens incoming request specify abstract specification instantiate specific directory controller request dir request dir dir fwd request request dir await response request dir update request generate dir cache controller specify dir cache cache compose intermediate dir cache controller compound controller directory cache specify dir cache happens incoming request cache incoming request dir former request dir request dir cache dir cache compute access generate request access compute access request ssp issue request access cache request access cache cache await response access cache cache update access cache respond request dir fwd request request dir dir await response request dir dir update request dir parse ssp access request controller request access finally controller respond request fwd request cache fwd request dir cache dir cache compute access generate fwd request access compute access fwd request ssp proxy cache logically issue request access dir request internal actually simply compute request generate invalid dir respond virtual request request compute request access invalid ssp dir fwd request request dir dir await response request dir dir update request dir virtual proxy cache response cache await response access invalid proxy cache update cache update access invalid proxy cache evict internal request simply compute request generate dir respond virtual eviction request evict request compute request evict ssp dir update evict request dir respond request cache update fwd request cache cache response fwd request cache incoming request compute access request parse ssp worth reiterate computation indeed controller perform access code available input ssp source transaction cache leverage proxy cache initiate transaction reality proxy cache temporary cache physically integrate within dir cache controller therefore request proxy cache dir physically instead compute request simply dir react request controller await response proxy cache normally response controller update evict dir eviction virtual message actually instead request correspond evict access compute dir react request finally cache respond incoming request compatibility protocol hieragen compose SSPs hierarchical protocol SSPs  compatible specifically protocol feature upgrade coherence permission incompatibility handle appropriately typical protocol subset MOESI stable coherence culprit  cache silently upgrade issue protocol compatibility explain incompatibility ssp MESI ssp msi assume invalid cache cache performs load issue GetS dir cache dir cache issue GetS responds dir cache permission data dir cache ssp MESI sharer GetS request cache dir cache responds cache data exclusive permission cache silently transition meanwhile cache issue GetS obtain access situation hierarchical protocol violates SWMR coherence invariant fortunately hieragen automatically detect incompatibility processing SSPs detect ssp permit permission upgrade cache silently transition hieragen infer writable intuitive performance intuitive hieragen dir cache conservatively issue GetM request corresponds permission cache access GetS request corresponds request access ensures safety negative performance implication due needle ssp invalidation originate cache performance avoids needle invalidation dir cache issue GetS responds dir cache access hieragen generate dir cache logic detect mismatch permission cache ssp permission dir otherwise grant cache requestor silently  proxy cache issue request permission proxy cache issue GetS proxy cache mimic behavior external cache proxy cache GetS serialize cache GetS dir momentarily grant permission request cache dir cache respond cache dir proxy cache evicts optimize issue resolve assume ssp ssp protocol assume situation cache issue GetS request reading dir cache obtains due ssp request cache due ssp cache silently upgrade modify without notify dir cache per ssp another mismatch resolve dir cache cache compatible earlier perform cache furthermore without modify ssp recall hieragen philosophy cache evicts dir cache eviction message   reveals access perform cache  reveals therefore cache update evict data cache already issue request dir silently per ssp optimize protocol finite machine explain hieragen somewhat unoptimized finite machine dir cache machine 2D matrix coherence incoming coherence message entry specify happens naively specification directory directory dir cache cache controller entry   entry however entry actually reachable cannot without optimization finite machine directory needlessly logic handle unreachable logic harmful unnecessary complicate debug useful unreachable implement custom model checker explores reachable protocol eliminate unreachable VI concurrent hierarchical protocol hieragen atomic hierarchical protocol finite machine cache dir cache cache concurrency protocol protocol ProtoGen inject concurrency explain II ProtoGen leverage coherence transaction serialize directory unique serialization transaction directory protocol hieragen leverage transaction serialization hierarchical protocol multiple serialization protocol owner model request cache satisfied entirely within ssp serialize dir cache however request cache request cache cannot satisfied within ssp serialize despite serialization hierarchy structure hierarchy invariant coherence transaction serialize exactly serialization ProtoGen leveraged extract concurrency cache writable assume transaction cache cache accordingly request attempt obtain ownership request serialization initial cache writable transaction specifically assume cache cache obtain ownership situation although potentially serialization hierarchical transaction dir cache transaction dir cache infer lose proceed dir cache serialization generalize hieragen generate atomic protocol enforces SWMR globally exactly owner cache writable cache owner transaction therefore attempt unique owner traverse consist directory node structure guarantee exactly directory node across transaction node infer lose proceed towards owner directory unique serialization ProtoGen perform vii MODELS baseline model constraint impose explore relax deeper hierarchy likely incentive hierarchy deeper hierarchy affect hieragen composes SSPs hierarchy hieragen introduces concurrency composition unaffected depth hierarchy ssp composition structure interface consist dir cache node cache functionality directory functionality structure interface hieragen ensure coherence request completes allows coherence request without violate SWMR globally hieragen permit communication across without structure interface hieragen compose SSPs hierarchy apply compose additional SSPs hieragen deeper hierarchy cache via dir cache via dir cache illustrates hieragen structure ensures SWMR globally hierarchy cache cache jth performs assume sharer cache request hieragen issue request via dir cache via dir cache thereby ensure SWMR globally similarly deeper hierarchy impact hieragen introduces concurrency hierarchical protocol irrespective depth hierarchy transaction serialize exactly node enables ProtoGen uncover concurrency incomplete directory knowledge directory incomplete stale knowledge coherence directory incomplete data structure coarse vector cache permit perform eviction directory inclusive fortunately issue affect hieragen handle input SSPs assume ssp non inclusive directory recall non inclusive directory directory uncached therefore ensure SWMR ssp already revert broadcast directory feature ssp hieragen leverage ensure SWMR hence globally ssp protocol assume ssp directory protocol flexibility protocol structure interface hierarchy directory protocol naturally structure directory however snoop protocol directory protocol null directory sometimes denote  snoop protocol coherence request directory stateless directory simply broadcast request interconnection network directory protocol broadcast snoop non inclusive cache assume cache inclusive exclusion non inclusion neither strictly inclusive exclusive hieragen limited inclusive cache underlie limitation philosophy user specify SSPs completely independently modify SSPs compose drawn SSPs knowledge illustrate non inclusion scenario cache dir cache cache cache dir cache non inclusive model cache consult dir proceed cache cache evict silently cache date silently however separation SSPs cache cannot consult dir fashion cannot proceed future explore possibility relax SSPs enable non inclusive cache communication across assume structure hierarchy communication strictly hierarchical node communicate sibling cache cannot directly communicate cache assumption enables clearly composition SSPs critical implementation hieragen future overcomes limitation project future experimental evaluation goal evaluation effectiveness hieragen concurrent hierarchical protocol illustrate automation benefit hieragen complexity input SSPs complexity hierarchical ssp concurrent hierarchical protocol discus verification generate protocol hierarchy useful architect exist hierarchical protocol perform quantitatively confirm benefit benchmark benchmark input SSPs along description hierarchy structure ssp attach ssp specify SSPs typical msi MESI  MOESI protocol without concurrency complexity input SSPs complexity quantify precisely coherence protocol reachable transition reasonable proxy protocol cache directory MI msi MESI  MOESI atomic protocol entry stable transition ssp ssp dir cache dir cache msi MI MI msi msi msi MESI msi MESI MESI  msi   MOESI MOESI II complexity atomic hierarchical protocol hieragen entry stable transient transition complexity goal hieragen overcome complexity manually hierarchical protocol hieragen input SSPs ssp ssp concurrent hierarchical protocol additional insight atomic hierarchical protocol II quantifiable complexity hierarchical protocol hierarchical protocol complexity dir cache input SSPs automatically generate dir cache dir cache complexity discrepancy dir cache hieragen expand transient concurrency potential introduce due transient hence report transient complexity introduce considerable varies considerably across protocol dir cache msi MI hierarchy sum constituent roughly reachable transition MOESI MOESI dir cache transition sum transition remind reader transition equally easy particularly challenge dir cache bridge SSPs examine additional complexity introduce hieragen concurrency protocol hieragen twice protocol input flag stall protocol flag unset quantifiable complexity hieragen output reproduces II facilitate visual comparison curious node concurrent protocol approximately correspond atomic protocol phenomenon protocol complexity increase hieragen discover merge equivalent cache msi protocol MI SI denote cache evict respectively message distinct merge manual protocol designer author tend merge clarity reading debug protocol designer likely distinguish hieragen readability  generate protocol construction ultimately important quantifiable complexity metric hieragen ability automatically nearly instantaneously protocol construction hieragen correctly generate protocol atomic protocol transient atomicity simply message transaction cannot intervene transient atomic hierarchical concurrent hierarchical stall concurrent hierarchical non stall ssp ssp cache dir cache cache cache dir cache cache cache dir cache cache msi MI MI msi msi msi MESI msi MESI MESI  msi   MOESI MOESI concurrent hierarchical protocol complexity hieragen generate concurrent cache dir cache cache node atomic counterpart stall non stall protocol variant entry stable transient transition verification correctness confirm hieragen protocol protocol violate coherence deadlock perform verification protocol murφ model checker formally completely verify atomic hierarchical protocol hieragen configuration depict configuration consists directory cache node generate dir cache proxy cache cache node verify concurrent hierarchical protocol generate hieragen configuration verification perform server 6GB memory gain confidence additional cache node configuration consist directory cache node generate dir cache proxy cache cache node however murφ memory configuration extend verification configuration hash compaction capability murφ hash compaction compress descriptor within reduce memory footprint model checker verification due compression exists non zero probability omit verification verification murφ model report omission probability murφ randomly independent compression function descriptor omission probability coherence protocol perform multiple verification probability undetected bug threshold IX related primary related framework structure hierarchical protocol automation coherence protocol hierarchical protocol verifiability MCP framework seek minimize complexity cleanly functionality dir cache manager directory client cache unlike hieragen MCP automation automates protocol communication template template nice feature hierarchy critical constraint directory sibling sibling communication cache writebacks related automation coherence protocol already ProtoGen scheme prior  hardware description concurrent protocol compiler rtl unlike hieragen concurrent protocol contribution allows designer  instead directly rtl  specify atomic protocol compiler generate concurrency however concurrency limited compiler conservatively serialize coherence transaction cache   synchronize transition approach program synthesis specify protocol synthesize transit  highly constrain explosion related hierarchical protocol facilitates verification verifiability ensure bug likely introduce manual protocol verifiability necessarily simplify verifiable hierarchical protocol HCC fractal coherence protocol conform neo framework neo CONCLUSIONS hieragen automatic generation hierarchical cache coherence protocol demonstrate hieragen successfully compose atomic SSPs highly concurrent hierarchical protocol generate protocol verifiably avoid substantial verification effort cache directory controller dozen transition manual automation hierarchical protocol practical preferable manual