propose automatic infer dynamic illumination limited dynamic photograph indoor scene contrast previous relies specialized image capture user input scene model neural network directly regress limited photo hdr illumination without assumption scene geometry accomplish robust classifier automatically annotate location source dataset ldr environment annotation neural network predicts location scene limited photo tune network dataset hdr environment predict intensity allows automatically recover highquality hdr illumination estimate significantly outperform previous consequently illumination estimate application 3D insertion photo realistic validate via perceptual user CCS concept compute methodology scene understand image manipulation computational photography additional indoor illumination introduction infer scene illumination photograph challenge pixel intensity image complex function scene geometry illumination image device subsequent processing disentangle factor another ill inverse limited image factor contribute scene illumination directly photo typically address assume scene geometry reflectance depth sensor reconstruct annotate user impose dimensional model frequency spherical harmonic significant progress image geometric reconstruction reflectance estimation ofthe technique significantly error prone error propagate estimate directly render optimization fundamentally indoor varies widely geometric photometric scene diffuse lamp  typically cannot accurately dimensional model proposes infer dynamic hdr illumination limited dynamic ldr photograph indoor scene goal model typical indoor source spherical environment  representation illumination inference robust error geometry reflectance scene appearance model introduce approach image input predicts illumination neural network acm transaction graphic vol article publication date november extract panorama normal lens image spherical panorama neural network successfully apply closely related depth estimation reflectance estimation intrinsic image vein previous propose training neural network representation image appearance illumination however training network database image hdr illumination dataset currently exist significant amount effort assemble instead resort database ldr panorama however ldr panorama training data additional challenge source explicitly available hence introduce detect source ldr panorama image significantly outperforms algorithm output training image cropped correspond panorama input allows predict location source scene intensity information accurately capture ldr panorama resolve capture dataset consist hdr environment tune network ldr panorama hdr data allows network directly regress ldr limited photo hdr scene illumination unlike previous technique image capture user input rely assumption scene appearance geometry instead automatically recover illumination estimate image indoor scene truly capture significantly outperforms previous consequently illumination estimate application 3D insertion photo realistic demonstrate via perceptual user indicates lit illumination estimate almost indistinguishable lit truth illumination significant important challenge scene understand contribution contribution illumination estimation leverage convolutional network limited image input estimation hdr illumination source detection ldr panorama panorama warp generate training data illumination estimation network hdr environment dataset evaluate illumination estimation scene inference task benchmarking image scene illumination estimation perceptual user related reconstruct scene geometry reflectance illumination image goal computer vision graphic extensively literature intrinsically estimate relies reconstruct others related specifically focus technique recover illumination seminal  image demonstrate capture photograph mirror sphere exposure reconstruct physically omnidirectional hdr radiance realistically render novel scene followup demonstrate shot diffuse sphere scene metallic diffuse hybrid sphere previous illumination estimation typically model scene appearance function scene geometry reflectance illumination optimizes explain capture image appearance model typically lambertian shade dimensional model spherical harmonic combine geometry capture depth sensor reconstruct multi stereo model fitting estimate assume consists discrete technique recover illumination isolated dimensional model sufficient geometry reflectance model however interested recover illumination indoor scene exhibit complex clutter geometry  non lambertian appearance variety cannot parameterized accurately  model therefore environment representation directly regress image without rely potentially inaccurate appearance model focus recover outdoor illumination approximate analytical model propose predict outdoor illumination input image network image illumination panorama database however outdoor illumination approximate dimensional analytical model parameter   model ldr panorama recover hdr illumination neural network predict parameter contrast indoor scene complex cannot approximate dimensional model instead non parametric hdr  representation indoor illumination challenge data generation network training acm transaction graphic vol article publication date november predict indoor illumination image overview automatically predicts hdr photograph relies cnn stage rely database ldr panorama compensate dynamic source detect panorama warp generate target mask combine extract panorama cnn predict direction network tune novel dataset hdr panorama allows predict intensity address challenge novel contribution propose stage training learns predict location ldr data later finetuned predict intensity hdr dataset generate data location prediction task develop theart detector annotate ldr panorama dataset propose panorama warp account spatially localize indoor outdoor illumination multi neural network recover indoor illumination novel render loss progressively improves prediction estimate propose flip hdr input image approximate illumination 2D compositing technique approximation completely incorrect others dominant illuminate scene camera contrast prediction significantly accurate ldr image input estimate scene illumination image rely user input annotate geometry initial refine render optimization scheme recover illumination rgbd scan scene user annotate propose automatic scene inference technique detect source visible image leverage panorama database predict panorama appearance input image pre classify source panorama source input image transforms illumination estimation image metric however coarse approximation panorama arbitrarily actual illumination image contrast propose directly mapping image appearance scene illumination demonstrate illumination estimate recently neural network technique propose estimate reflectance convolution BRDF incident illumination image reflectance reflectance illumination estimate however technique focus approximately spatially constant reflectance contrast indoor scene focus significantly complex reflectance variation cnn propose estimate scene depth normal intrinsic decomposition indoor scene challenge involve recover directly image unlike indirectly scene appearance recover illumination image likely benefit scene inference task overview goal illustrate predict hdr photograph cast goal training data photo hdr probe ideal task sufficient data regress hdr probe directly photo however data exist currently gathering sufficient quantity prohibitively expensive datasets ldr panorama already exist capture entire environment scene potentially illumination generate input data training extract rectify panorama various orientation focal attempt relationship panorama acm transaction graphic vol article publication date november unfortunately cannot directly indoor ldr panorama dynamic capture properly addition indoor illumination tends localize source cannot assume directional projection panorama arbitrarily away cropped scene illumination incident warp version panorama limitation propose ldr data network identify location source scene novel practical aforementioned issue introduce sec robust detect source ldr panoramic image introduce warp panorama reflect cropped scene sec dataset ldr panorama predict indoor photograph introduce sec convolutional neural network binary mask resolution rgb approximation entire panorama standard loss function binary mask heavily penalizes shift source introduce network differentiable cosine filter enables efficient addition estimate source estimate intensity recover scene illumination achieve capture dataset quality hdr environment span scene illumination dataset network scratch sufficient tune pre prediction network infer intensity sec tune network intensity rgb panorama combine hdr environment sec relight virtual input photo ldr panorama source detection ldr panorama training cnn detect source detect panorama correspond source propose novel source detector significantly outperforms approach classification convert grayscale panorama rotate angle yield prot  align horizon rotation account distortion equirectangular projection severely around pole feature compute prot separately patch hog patch elevation standard deviation percentile intensity feature logistic regression classifier spotlight lamp recall precision spotlight lamp detector reflection detector baseline detector precision recall curve detector detector curve spotlight lamp detection curve reflection cyan curve baseline detector rely solely intensity pixel inherent uncertainty importance reflection relative others annotator perfect algorithm prediction highly unlikely reflection source training classifier separately yield performance source significantly another logistic regression classifier apply slide fashion prot yield pixel classifier merge per pixel manner accord elevation angle  rot sin indicates regression pixel elevation rot  rotate orientation thresholded obtain binary mask refine dense crf adjust opening closing morphological operation optimal threshold obtain maximize intersection  iou binary mask truth label training training detail evaluation classifier manually annotate panorama database source label spotlight lamp bounce reflection panorama training classifier label positive sample random negative sample subsequently negative mining entire training discard panorama watermark source seldom camera report comparison precision recall curve detector baseline directly intensity pixel probability belonging source approach baseline performs poorly ldr data detector performance performs significantly recall detection panorama dataset acm transaction graphic vol article publication date november predict indoor illumination image detection panorama input ldr panorama detection cyan overlaid panorama reference detector handle arrangement patch spotlight panorama  warp detect source ldr panorama sufficient training cnn photo fundamental panorama cropped scene panorama projection arbitrarily away location scene cropped photo illustrates issue photo cropped panorama treat panorama source incorrect  bunny capture actual probe scene scene panorama database photo access scene capture truth training novel warp panorama approximate cropped photo warp operator aim warp operator generate panorama capture virtual camera photo extract panorama hdr panorama treat source outline photo bunny model relit panorama capture photo location warp importance locality indoor scene photo estimate photo cropped panorama treat panorama source photo projection scene photo relighting virtual bunny  hdr panorama capture probe cropped photo capture location scene introduce warp operator estimate scene information distorts panorama approximate location source relighting warp panorama yield closer truth cropped photo challenge harder scene geometry assumption task feasible assume scene sphere scene equidistant projection assume image warp suffices model camera occlusion important factor assumption scene however goal model source typically scene extremity ceiling etc approximate assumption assume panorama sphere camera capture panorama origin sphere outgo ray emanate virtual camera parameterized   intersect ray panorama sphere yield   illustrate model virtual camera nadir angle corresponds panorama photo extract discus compute shortly translate along axis camera sin warp arbitrary direction trivially achieve rotate environment warp substitute acm transaction graphic vol article publication date november overview warp illustrate 2D simplicity slice spherical panorama along projection illustrate camera aim warp operator virtual projection nadir angular distance respect nadir angle corresponds panorama photo extract input image normal panorama warp panorama selection procedure extract normal insertion pixel horizontal  panorama nadir trivially recover warp panorama equation  sin sin positive negative intersection sphere coordinate environment warp camera coordinate panorama photo extract user insert horizontal photo reflect choice approach detect normal cropped image thresholding angular distance normal vector project coordinate  horizontal panorama obtain horizontal panorama warp comparison relit panorama warp panorama panorama warp  relit panorama closely approximate obtain  without lengthy manual annotation vertical warp apply panorama assume sufficiently scene assume insertion network estimate image impact estimation warp panorama truth panorama capture scene spherical warp geometry warp obtain  extract spatially environment project onto proxy geometry estimate manual annotation comparative relighting spherical warp geometry warp panorama operator simplify scene assumption illustrate relighting approach approximation expensive technique completely automatic without access scene contrast manual label geometric warp around per panorama limitation warp operator fails appropriately model occlusion treat panorama projection sphere illuminate scene visible camera handle approach however situation rare network filter outlier learns robust scene appearance illumination mapping acm transaction graphic vol article publication date november predict indoor illumination image propose cnn architecture series convolutional layer conv residual connection fully layer FC  aim reconstruct mask  rgb panorama  series deconvolutional layer deconv elu activation function batch normalization layer output  mask tangent hyperbolic panorama prediction stride layer parenthesis identifier residual layer layer stride input conv conv FC FC FC deconv deconv deconv deconv deconv deconv deconv deconv deconv deconv conv conv sigmoid tanh output mask  output rgb panorama  learning ldr  extract accurate information ldr panorama detail approach relationship photo training data preparation indoor panorama compute mask truth sec panorama random elevation projection rectilinear photo  warp sec generate correspond warp panorama mask rectilinear photo rotate warp panorama correspond mask sits azimuth input output input photo output warp panorama correspond mask network architecture convolutional neural network photo input dimensional encode input series convolution downstream split upstream expansion distinct task intensity estimation binary mask prediction rgb panorama cosine blurring mask various blurring differentiable scheme allows smooth progression towards frequency content without artifact spherical harmonic prediction encoder split standard convolution layer residual layer individual decoder exclusively compose deconvolution layer input photo whereas panorama mask output stride encounter convolution deconvolution layer resolution output feature output mask  probability pixel environment rgb panorama  serf texture environment sec estimate mask rgb panorama loss function rgb panorama prediction task distance pixel output width height image network prediction truth panorama solid angle pixel loss function mask  straightforward standard binary entropy loss compute mask directly spotlight estimate slightly truth location penalty incur pinpoint location source photo instead blur target mask filter compute loss blur version filter coarse  representation target mask progressively  training filter cosine distance loss mask lcos correspond epoch formally epoch mini batch mini batch filter define acm transaction graphic vol article publication date november epoch distance mask loss epoch distance intensity loss ldr network hdr network evolution training loss epoch ldr hdr training hemisphere pixel panorama normal pixel sum solid angle vector specific direction solid angle pixel direction define training sample collectively normalize training sample differentiable propagation efficiently cnn visual cosine distance filter binary mask target mask becomes progressively sharper global loss function define       filter scheme render interpretation reflection lambertian model pas filter specular preserve frequency illumination loss function evaluate infer illumination appearance sphere increasingly glossy reflectance vein directly illumination spherical harmonic gradually increase coefficient frequency illumination network tendency overfit artifact frequency binary mask training detail panorama training data data generate split panorama exist training hence perform scene network adam optimizer minibatch rate momentum parameter loss curve training training training roughly nvidia titan pascal gpu inference mask rgb photo approximately batch 2GB memory gpu learning dynamic illumination network predict source accurately sec ldr data intensity source network novel dataset dynamic panorama enables jointly source direction intensity dataset hdr indoor panorama capture novel dataset resolution dynamic indoor panorama canon 5D camera sigma fisheye lens tripod equip robotic panoramic tripod programmed shoot bracket exposure increment photo shot raw mode automatically stitch hdr panorama  pro commercial software dynamic sufficient correctly expose pixel scene source panorama capture variety indoor environment apartment museum laboratory factory sport facility etc visual overview panorama novel hdr dataset supplementary variety dataset significantly datasets literature consist panorama extremely useful training scene inference dynamic image processing render adapt network hdr data source saturate hdr data network adjust directly source intensity  instead binary mask  network undergoes layer mask predictor conv initialize random training perform update decoder FC layer avoid overfitting encoder target intensity  define hdr intensity intensity median training dataset clamped source unusual pixel threshold ambient rgb recovery scene finally loss modify           lcos define respectively continued training ldr data hdr intensity  intensity reduce deconvolution artifact training otherwise perform parameter sec ldr data hdr data training ldr data sec extract panorama hdr dataset yield input output mapped ensure input network ldr image finally panorama warp procedure ldr counterpart loss curve training training dataset publicly available http  project  acm transaction graphic vol article publication date november predict indoor illumination image relit estimate predict probability relit estimate predict probability evaluation ldr network predict source virtual bunny model insert background image relit ldr network estimate image predict probability overlaid panorama generalizes indoor scene illumination available supplementary EXPERIMENTS evaluate approach prediction dataset ldr data detector sec treat truth hdr finetuning procedure actual hdr truth finally technique previous user performance relighting virtual analysis ldr network refers network dataset recovers binary mask sec hdr network refers network finetuned hdr dataset recovers intensity sec otherwise specify estimate supplementary compute completely automatically manual intervention virtual scene refer supplementary evaluation ldr network qualitative evaluate ldr network ability estimate direction image render virtual bunny model image coarse environment obtain thresholding mask  detect component assign correspond probability  component modify mask combine rgb panorama  environment   mask  mask  parameter   respectively choice arbitrary visualize ldr network capability predict source ldr network successfully localizes source image visually obvious illumination cue handle occlude sec warp operator approximation handle occlude source however scenario rare network robustly generalize beyond erroneous input data demonstrate network predicts truth annotation occlusion consistent shade shadow cropped photo acm transaction graphic vol article publication date november occlusion ldr network prediction warp operator handle occlusion network generalize beyond rare instance shadow handle image occlude panorama network probability direction truth evaluation hdr network thorough evaluation hdr network quantitative qualitative quantitative evaluation evaluate performance hdr network hdr distribution hdr loss image qualitative correspond various percentile distribution truth intensity loss error indicates global relative error around network pinpoint location concentrate source succeed dominant source scene outside photo error typically scene lit source virtual relighting hdr network output directly generate hdr environment suitable relighting combine output    hdr network output intensity  rgb rgb prediction source rgb input image assumption reflectance capture illumination virtual insert extract hdr relighting truth network prediction yield convincing relighting truth global intensity recover absolute illumination intensity uncalibrated ldr image ill combination intensity camera parameter shutter iso etc image lit network estimate sometimes network recovers relative illumination ratio intensity panorama accurate fix issue boil histogram cumulative histogram loss intensity hdr convergence qualitative correspond loss percentile selection global intensity parameter parameter easily specify production  user ensure render properly expose relighting truth  addition automatically estimate global intensity manually specify supplementary parameter appearance composite automatic estimate reasonable slightly tune factor compelling almost comparison previous automatic estimate finally qualitative insert generic stock photo internet network obtain robust illumination estimate image viewpoint uncontrolled capture setting unknown processing factor outside hdr training comparison previous approach comparative relighting estimate illumination project background image directly sphere flip environment fails estimate dynamic source contrast approach robust estimate direction intensity visible image classifier detect estimate location background image database panorama estimate intensity render optimization author code estimate panorama image appearance feature necessarily correlate scene illumination technique sometimes retrieves retrieve arbitrarily adjust intensity converge satisfy source acm transaction graphic vol article publication date november predict indoor illumination image truth intensity predict intensity predict rgb truth rgb truth intensity predict intensity predict rgb truth rgb truth intensity predict intensity predict rgb truth rgb truth intensity predict intensity predict rgb truth rgb truth intensity predict intensity predict rgb truth rgb truth intensity predict intensity predict rgb truth rgb qualitative intensity rgb prediction hdr input image truth intensity  rgb panorama  correspond prediction hdr network   intensity cod intensity intensity sort error percentile loss reading error distribution input photo relit estimate input photo relit estimate relighting variety generic stock photo internet estimation perform completely automatically hdr network output directly render relight virtual acm transaction graphic vol article publication date november truth hdr network hdr network intensity tune comparison intensity factor humanly tune truth virtual relighting sometimes visually truth yield realistic insertion contrast estimate hdr render rely intrinsic decomposition geometry estimation inverse sensitive error therefore render available supplementary virtual image lit truth output hdr network GT GT optimization addition inverse approach relies reconstruct depth diffuse albedo scene challenge error estimate error prediction contrast learns hdr network ldr network vote user prefer user prefer truth equally participate user vote user prefer instead truth whereas vote user preference truth mapping image appearance scene illumination yield robust accurate user addition infer scene illumination interested estimate graphic application 3D insertion  realistic synthetic lit estimate composited input image acm transaction graphic vol article publication date november predict indoor illumination image ass axis performance via perceptual user prepared scene hdr insert variety virtual generate reference composite relighting image truth illumination obtain warp hdr panorama image extract relit probe estimate hdr network without artist tune sec ldr network technique user image reference image render truth illumination render image realistic realism composite significantly affected geometric alignment scene quality geometry render setting choice allows somewhat remove factor isolate estimation realism composite quality truth illumination hdr dataset comparison user user option realistic image choice additional option equally plausible aggregate user response unique participant comparison respect truth hdr network render realistic truth response significant improvement ldr network comparable significant improvement beyond significant improvement automatic previous improve simply tune global intensity cannot recover distinct shadow direction significant effort discussion contribution frame illumination estimation indoor scene benefit approach learns mapping image therefore assumption scene capture indoors explicitly estimate scene scene camera geometry inverse render optimize prone local minimum introduce additional contribution detect source ldr panorama outperforms panorama warp operation allows adapt cropped photo extract panorama automatically label data dataset xiao input photo truth prediction typical failure incorrect spatial extent orientation source blurring scene complex geometry image local illumination variation image lit upper ldr illumination prediction network tune network dataset hdr environment predict hdr scene illumination quantitative perceptual evaluation significantly limitation future network predict location sometimes issue infer spatial extent orientation source particularly partly network filter detect typically source blur crisp cast shadow characteristic finally network fail image complex ambiguous geometric photometric cue illustrates scenario generally network recover source location intensity pre training network retrieve training tune relevant exposure input ldr image intensity estimator sensitive location estimator network predict intensity scheme assign needle important role image appearance robustly infer network predict input image however previously indoor illumination localize within image goal recover spatially distribution challenge certainly datasets annotate geometry illumination finally estimation closely related scene inference task geometric reconstruction intrinsic image infer jointly benefit individual task