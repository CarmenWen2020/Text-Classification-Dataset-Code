image relighting synthesize scene appearance novel illumination visible hemisphere image capture pre define directional convolutional neural network regress relit image image relighting network synthetic dataset comprise procedurally generate reflectance combine custom sample network relighting network jointly optimal input direction relighting function extensive evaluation network empirical analysis reconstruction quality optimal configuration scenario alternative network architecture demonstrate synthetic scene reproduce complex frequency specularities cast shadow outperforms image relighting magnitude image CCS concept compute methodology render additional image relighting illumination convolutional neural network sparse sample appearance capture introduction render scene novel vision graphic application visual virtual augment reality visualization commerce approach relighting reconstruct geometry scene render reconstruction novel however reconstruction extremely challenge scene complex geometry reflectance image relighting bypass reconstruction directly model scene transport function assume illumination transport function incident illumination direction outgo radiance pixel towards camera allows scene render novel radiance incident illumination direction transport function sample capture image image scene directional direction yield sample image relighting sample reproduce scene appearance novel transport acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi function already combine interaction incident illumination scene geometry reproduce photorealistic reconstruct render brute image relighting densely sample transport function capture image scene relight scene interpolate dense sample however transport function highly coherent reconstruct image relight image dimensional function however image considerable acquisition specialized hardware technique render scene appearance novel illumination image previous imagebased relighting exploit coherence transport function instead leverage commonality transport function estimate non linear dimensional function appearance scene sparse pre define directional appearance scene directional upper hemisphere inspire challenge appearance analysis task function convolutional neural network sec network refer relight net synthetically render dataset consist scene procedurally generate BRDFs sec image scene directional relight net reproduce scene appearance directional visible hemisphere visual quality relight net output function input direction therefore sample net custom layer chooses sparse subset dense image prepend sample net relight net construct network jointly optimal input direction relighting function sec extensive evaluation empirical analysis reconstruction quality optimal configuration incident illumination alternative network architecture sec propose refinement relight net robust deviation optimal input direction likely capture scenario sec generates photorealistic scene complex frequency cast shadow specularities visual quality generate image previous image relighting magnitude image significantly reduces acquisition complexity imagebased relighting towards practical related dimensionality transport illumination drastic image scene previous image dimensional subspace image lambertian scene dimensional manifold scene complex geometry reflectance dimensional transport local exploit render relighting technique linear analysis globally local dimensionality transport scene exploit correlation transport across scene non linear cnn representation dramatically reduces image scene relighting relighting sparse sample brute image relighting densely sample transport function recent leveraged coherence transport function reconstruct sample approach specially illumination capture reconstruct transport matrix sample subset however image acquisition desire illumination contrast relight scene image directional polynomial texture ptm model per pixel radiance polynomial function direction function approximately capture image render scene novel scheme difference shallow neural network instead polynomial demonstrate impressive scene complex transport image achieve contrast exploit spatial angular coherence transport across scene complex non linear relighting function achieve image relighting sample visual quality ptm image BRDF estimation technique reconstruct BRDFs image capture illumination linear data driven BRDF model derive optimal direction BRDF estimation sparse sample propose technique optimal direction quality scene relighting non linear cnn reconstruction photometric stereo scene reconstruction acquisition setup photometric stereo reconstruct geometry reflectance image scene illumination recent technique handle non lambertian BRDFs assume homogeneous BRDFs image reconstruct spatially BRDFs addition photometric stereo cast shadow global illumination transport contrast reproduce sample outperforms photometric stereo appearance analysis synthesis recently successfully apply acm transaction graphic vol article publication date august image relighting optimal sparse sample convolution kernel stride BN relu convolution kernel stride BN relu deconvolution kernel stride BN relu convolution kernel stride sigmoid skip link feature skip link feature channel feature vector vector fully tanh feature  feature vector max sample net sec dense input sample sparse input sample relight net sec relit output novel trainable matrix overview network stack dense input image direction channel input sample net sec sample net consists trainable matrix parameter softmax layer construct sparse sample matrix multiplies dense input sparse channel sample input relight net sec relight net fully convolutional encoder decoder encoder  input sample intermediate representation pas output direction fully layer replicate concatenate intermediate representation decoder upsamples recover output relit image skip link introduce frequency feature output sample net relight net jointly optimal sample relighting function relighting scene sec relight net relight input sparse sample input novel inverse render scene reconstruction reflectance illumination estimation reflectance capture depth normal estimation simplify assumption scene reconstruction tractable bypass reconstruction directly generate relit image complex scene network interpolation relatively unstructured camera camera assumes fix viewpoint attempt interpolate extrapolate learning image BASED relighting image scene individual source render scene novel assume scene image fix viewpoint illumination assume illumination scene minimal contribution appearance ignore assumption transport matrix proportion incident radiance direction sample upper hemisphere pixel image scene directional wise sample transport matrix sample image scene capture predefined directional respectively goal reconstruct image novel directional via relighting function hypothesize scene agnostic transform sparse input sample scene render scene novel transport highly coherent formulation enables radiance pixel potentially function entire scene sparse direction model relighting function convolutional neural network cnn refer relight net relight net synthetic dataset consist procedurally generate render complex spatially BRDFs demonstrate reconstruct frequency transport specularities cast shadow  illustrate described sec quality reconstruction relight net depends pre define direction input sample intuitively ability generalize limited input direction improve span incident hemisphere therefore propose scheme optimal input sample direction relighting specifically densely sample input direction layer selects sparse direction layer sample net sec prepend sample net relight net construct network jointly estimate optimal direction correspond relighting function relight relight net core relight net fully convolutional neural network approximates eqn explore architecture relight net conventional encoder decoder architecture disentangles global illumination component scene relight net network architecture relight net directly generate relit image sparse input sample pas input direction 2D coordinate direction vector project acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi disk network construct channel constant image resolution input image channel respectively concatenate input rgb image yield channel input per sample stack sample channel input relight net illustrate relight net net style  architecture encoder channel input series convolutional layer stride downsampling batch normalization BN relu layer target direction fully layer tanh activation layer linear operation expand dimensional vector dimensional feature vector replicate feature vector spatially construct channel feature concatenate encoder output decoder convolves concatenate encoder output upsamples feature deconvolution transpose convolution layer convolution deconvolution BN relu layer skip connection encoder decoder improve per pixel detail output decoder convolution layer sigmoid activation relit image network loss output image LA truth image render directional source structure relight net allows leverage coherence transport matrix convolutional layer exploit spatial coherence aggregate network receptive combine feature across channel exploit correlation direction allows handle diffuse specular reflectance shadow global illumination relight net relight net directly regress relit image input sample render specific constraint alternative architecture relight net evaluate explicit inclusion render prior improve relighting specifically appearance scene directional sum global illumination component component per pixel visibility global illumination component respectively relight net explicitly decode component relight net consists encoder decoder decoder generate combine reconstruct encoder decoder identical relight net synthetic render data network generate truth data illumination image visibility relit image supervision render component compute local per pixel shade without visibility construct  shadow ray cast loss relight net sum loss supervise LB optimal sample sample net relight net relit image sparse input sample capture fix predefined direction structure input contributes quality however relight net relight net encoder decoder architecture however relight net encoder decoder reconstruct illumination visibility indirect illumination image combine reconstruct relit output skip link encoder decoder recover  detail specific choice direction substantial bearing relighting quality apriori optimal configuration choice optimal direction regress parameter network however direction complex scene appearance challenge model differentiable shadow instead densely sample domain incident illumination upper hemisphere pre render image training scene estimate optimal sample sparse subset dense sample dense input sample vectorizing stack sample construct dense sample matrix pixel input image subset sample WS WS binary matrix entry correspond sample sample net trainable matrix multiplies dense input sample sparse sample however enforce matrix binary inspire apply softmax layer WS softmax  scalar parameter gradually increase epoch training softmax layer exp exp WS sparser initialize stage training sample linear combination sample infinity WS gradually converges non zero acm transaction graphic vol article publication date august image relighting optimal sparse sample corresponds chosen optimal sample quadratic model tunable hyper parameter eqn vectorizes input sample vector channel input apply channel sample illustrates combine sample net relight net sec jointly generate training data network synthetic render dataset allows aspect training scene truth data relit image intermediate relight net generate primitive cube ellipsoid cylinder random parameter apply height frequency variation random construct scene geometry combine multiple apply random translation rotation scene training definition adobe stock 3D dataset dataset realistic spatially BRDFs SVBRDFs dataset physically  BRDF model resolution diffuse roughness normal texture random SVBRDFs SVBRDFs training synthetic scene training render resolution training image mitsuba bidirectional trace sample applicable dynamic image capture conventional camera apply gamma clip image combination mitsuba   diffuse  plugins render illustrates render scene composition scene realistic locally exhibit complex transport complex reflection cast shadow inter reflection allows relighting function generalizes scene training relight net sample net sec illustrate sample net jointly relight net dense scene sample sample net selects sparse subset input relight net relit jointly densely sample incident illumination domain cone towards viewpoint discrete render training scene dense input sample combine sample relight net fashion minimize relight net loss function across scene output http stock adobe com asset training data scene consist multiple random primitive augment height texture SVBRDFs adobe stock 3D dataset render mitsuba direction WS construct described sec loss function evaluates error reconstruct image image patch render image scene patch training training  correspond training sample net load completely batch implies swap repeatedly significant overhead instead organize training batch load random scene randomly image target relight net reconstruct batch scene  training image relight net training adam rate joint training generally network typically converge epoch model scene render image code generate release project website relight net fully convolutional apply arbitrary resolution image although considers appearance within moreover relight net discrete relight directional continuous domain analysis synthetic data analysis relight net sample net analysis empirical evaluation component network unless otherwise specify relight net later relight net relight net http   edu project  acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi incident illumination domain sample model scene appearance directional cone hemisphere towards direction illustrate hemisphere domain 2D densely sample discrete direction construct domain sparse sample training  relight net minimize eqn relight scene direction investigate domain cone angle performance network network domain uniformly sample coordinate direction domain reject sample outside disk tom distinct direction subset direction respectively detail addition illumination domain quality reconstruction depends sparse sample input relight net illumination domain increase sample preserve reconstruction quality therefore analyze performance sample net relight net architecture domain sample configuration learnt optimal sample joint training sample net gradually converges optimal sample illustrate sample WS sample gradually converges optimal sample intuitively sample distribute indicates learnt optimal direction representative network angle optimal direction around cone direction cone nearly collocate viewpoint optimal direction domain sample net chooses direction relight net interpolate extrapolate input sample relit sample net converge local minimum network however direction reconstruction arbitrarily chosen direction sample epoch evolution optimal sparse sample joint training WS distribution WS gradually becomes  till converges sample epoch learnt optimal direction configuration direction standard spherical parameterization strategy heuristic discus shortly optimal direction remain configuration supplementary document reconstruction quality network relight scene direction domain aggregate error perform analysis choice illustrate error distribution observation relight net reconstruction error input sample quality interpolate sample output direction within convex hull input direction extrapolate relight scene outside convex hull sparse input sample error interpolation scene optimal sample direction geometry reflectance direction optimal scene addition optimal direction chosen relight net tradeoff error interpolation extrapolation scenario reconstruction error domain network acm transaction graphic vol article publication date august image relighting optimal sparse sample PSNRs psnr distribution dierent  truth truth PSNRs PSNRs reconstruction error configuration visualize reconstruction quality psnr direction aggregate scene error direction input sample convex hull input sample direction away input sample average psnr across direction relighting scene capture setup truth correspond output direction marked reconstruction accurate direction setup fail directional extreme  angle minimal impact integrate environment psnr network photorealistic direction entire upper hemisphere setup showcased accurate across domain network blur frequency shadow specularities however issue evident render scene frequency directional render scene environment illumination perceptually indistinguishable truth image moreover additional sample improves performance sample net optimize sample configuration specific scene capture scenario comparison alternative sample strategy evaluate quality learnt sample heuristic strategy distribute sample random dart cluster evaluate configuration ensure random dart distribute sample specify minimal threshold distance sample apply minimal threshold distance boundary domain  angle without sample tend converge towards boundary domain sample relighting performance dart cluster PSNRs comparison random dart sample representative cluster sample sample sample average psnr threshold distance apriori generate sample gradually increase threshold allows sample baseline cluster sample cluster cluster generally converges distribution central direction direction distribute around direction around domain randomly random dart cluster representative distribution relight net sample input scene patch training data network scene reconstruction error sample net sample significantly outperform random dart acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi average psnr relight net relight net relight net relight net component psnr truth visibility psnr visibility component component visibility relight net truth relight net relight net relighting error across direction relight net architecture configuration optimal direction overall psnr psnr relight net component relight net marginally performance visual inspection scene direction marked arrow shadow sometimes inset inaccurate inset visibility component relight net cluster reliable distribution approach performance distribution significantly moreover easy predict relighting performance sample strategy without training relight net contrast sample net conjunction relight net allows training pas jointly optimal sample relighting function maximizes relighting performance relight net relight net evaluate introduce render constraint relighting function performance relight net relight net configuration sample net relight net optimal input direction relight net direction comparison relighting error network relight net marginally average performance psnr relight net consistently outperform relight net visual quality attributable difficulty frequency visibility function psnr contrast reconstruction illumination component accurate psnr chose relight net relight net relighting performance faster evaluate however relight net scene decomposition technique scene reconstruction direction future refining relight net joint training relight net relight scene sparse sample learnt optimal direction however acquisition recreate optimal direction exactly challenge reduce requirement refine relight net training   average psnr average PSNRs input away optimal evaluation network refinement reconstruction error optimal input relight net refinement refinement improves dataset moreover refine network performs scenario non optimal input direction optimal average psnr compute across entire scenario refine network robust deviation outperforms non refine network performance optimal input handle input direction local neighborhood optimal direction input direction input relight net refine relight net generate training dataset comprise training scene scene scene scene render random input sample sample within cone around learnt optimal direction another output image random direction entire cone image generate described sec refine relight net random image relight net error distribution refinement dataset refinement improves reconstruction quality refinement optimal input direction joint optimization consequence refining  scene dataset combine sample net relight net dataset computational requirement sample net intractable importantly refine network handle input away optimal direction  randomly input direction away optimal direction relighting performance direction entire dataset average PSNRs setting input optimal direction refine network achieves average psnr outperforms non refine network optimal input sample data robustness input direction allows quality datasets capture acquisition setup exactly specification RESULTS evaluation evaluation comparison synthetic data unless otherwise specify generate refine relight net model additional video acm transaction graphic vol article publication date august image relighting optimal sparse sample hui  input hui  image image truth psnr psnr input image correspond image image image comparison photometric stereo sample polynomial texture sample synthetic scene scene capture input direction deviate optimal direction input image correspond psnr image psnr input image moreover visual quality reproduce cast shadow specularities inset accompany supplementary video encourage reader zoom image image detail datasets evaluate synthetic scene scene data datasets capture  acquisition additional scene capture stage setup supplementary video  capture image learnt optimal direction latter datasets direction closest direction deviate average scene rely refine network robustness input direction timing relight scene directional pas network model nvidia geforce resolution image comparison photometric stereo reconstruction mention sec approach image relighting reconstruct scene render novel approach photometric stereo handle spatially BRDFs comparison image photometric stereo error reconstruct scene image significant artifact relit moreover handle non local cast shadow inter reflection comparison significantly psnr visual quality acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi comparison image relighting imagebased relighting dense input sample capture specialized hardware therefore representative polynomial texture mapping ptm barycentric interpolation performance sample ptm polynomial input image polynomial input image network outperforms ptm setting synthetic data polynomial sample allows ptm outperform psnr scene unlike network reconstruct specularities completely blur shadow moreover ptm performance consistently improve sample polynomial possibly polynomial approximation transport presence cast shadow error unstable ptm largely planar scene minimal cast shadow contrast handle complex scene sample barycentric interpolation sample barycentric interpolation sample barycentric interpolation sample sample truth psnr comparison barycentric interpolation increase sample resolution sample dot relighting direction psnr barycentric interpolation sample resolution barycentric interpolation psnr subjective visual quality significant ghost artifact shadow boundary inset analyze sample barycentric interpolation approach quality uniformly sample upper hemisphere direction render synthetic scene direction image barycentric interpolation frontal hemisphere model reasonable plausible slightly jagged shadow novel relighting direction outside convex hull input sample sample psnr barycentric interpolation image resolution sample increase barycentric interpolation outperform quantitatively psnr image however visual quality superior barycentric interpolation significant ghost artifact input image issue exacerbate animation refer supplementary video reconstruct shadow specularities smoothly intuitively barycentric interpolation exhibit significant spatial ghost temporal aliasing directional environment relighting network handle directional allows relight scene upper hemisphere environment render image direction environment sum environment radiance  environment output direction network allows pre compute encoder feature input image decoder direction comparison directional environment illumination truth image synthetic scene directional truth image closely minor artifact along shadow boundary moreover frequency environment generate sparse sample visually imperceptible truth indicates render environment illumination accuracy relighting direction sufficient compensate error  angle demonstrates behavior scene exhibit diffuse highly specular geometry arbitrary complex scene layout medium network faithfully reproduces appearance novel directional creates photorealistic environment illumination sample deviate optimal direction obtain quality illustrate ability network relight direction perfectly optimal truth environment limitation fails recover cast shadow highly non convex geometry however rendering environment illumination plausible rightmost limitation quality artifact remain capture cast shadow artifact network image patch determines receptive feature spatial analyze scene acm transaction graphic vol article publication date august image relighting optimal sparse sample truth truth truth truth truth truth truth truth truth relighting sample synthetic data input output direction marked truth image faithfully error shadow boundary moreover error visually imperceptible frequency  environment illumination fourth environment inset truth comparison incident significant cast shadow shadow artifact arrow artifact away sample artifact mitigate environment appearance consequently cannot handle non local appearance shadow  angle highly non convex geometry blur specularities issue ameliorate sample render environment limited training data assumption generate assume scene opaque model complex  increase diversity composition scene mitigate conclusion future novel approach relighting scene sparse input image accomplish training cnn image scene directional render scene novel directional upper hemisphere moreover scheme optimal direction sparse sample conjunction relighting function jointly training combine sample relighting network extensive evaluation comparison previous stateof image relighting approach achieve performance magnitude input sample suggests direction future previous scene appearance analysis rely linear analysis network extremely successful representation image similarly representation scene appearance representation reduce memory relight render scene optimal directional non directional illumination avoid explicit scene reconstruction acm transaction graphic vol article publication date august zexiang kalyan sunkavalli sunil hadap ravi ramamoorthi truth truth truth truth truth truth truth truth truth truth  image directional environment scene render environment scene complex reflectance intricate geometry span scene layout accurate relighting directional output direction marked environment fourth sixth training relight net network decompose scene factor input sample combine reconstruction another extension