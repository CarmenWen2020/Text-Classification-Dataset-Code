intrinsic image decomposition algorithm interpret shade unified component photometric shade transition generally smoother reflectance albedo fail distinguish photometric reflectance variation therefore propose decompose shade component illumination indirect shade ambient shadow subcomponents aim distinguish photometric reflectance variation convolutional neural network ShadingNet propose operates coarse manner specialized fusion refinement exploit grain shade model specific reflectance cue specific photometric analyze disentanglement capability dataset scene synthetic image outdoor environment grain intrinsic image truth approach grain shade decomposition outperforms algorithm utilize unified shade ned mpi sintel GTA IIW mit intrinsic image  SRD datasets introduction intrinsic image decomposition aim recover image formation component reflectance albedo shade illumination reflectance component contains information albedo independent illumination camera viewpoint shade component contains photometric ambient inter intra reflection shadow cast intrinsic image raw rgb image favourable computer vision task instance reflectance image illumination invariant useful semantic segmentation task scene understand prefer computational photography application plausible photo edit task recoloring edit  recently textile improve fabric  shade image source information 3D reconstruction task constancy intrinsic image decomposition ill multiple reflectance shade reconstruct input consequence traditional impose prior intrinsic component constrain optimization recent approach datasets powerful intrinsic image decomposition traditional assume unified shade component photometric assumption image variation due reflectance smooth image variation shade however assumption image suffer photometric due environmental shadow cast inter reflection demonstrate intrinsic image decomposition perform poorly handle shadow cast alter shadow cast reflectance variation negatively influence quality intrinsic image decomposition therefore goal photometric separately source indirect ambient shadow cast component aim explicitly model photometric drastic pixel extra cue reflectance estimation disentanglement intensity variation extend standard image formation model decompose shade component source indirect ambient shadow cast grain model convolutional neural network cnn propose operates coarse manner specialized fusion refinement precisely contribution propose ShadingNet model grain shade decomposition photometric scene specifically model couple shade decomposition reflectance prediction specific reflectance cue specific photometric analyze disentanglement capability propose generic render pipeline generate grain shade decomposition demonstrate blender cycle extend subset environment dataset ned footnote systematically analyze quality contribution grain shade decomposition quantitative qualitative evaluation datasets ned mpi sintel GTA IIW mit intrinsic image  SRD achieve superior performance model estimate unified shade related intrinsic image decomposition ill constrain reflectance shade reconstruct input traditional usually aim constrain impose prior intrinsic component pioneer retinex algorithm assumes reflectance gradient whereas shade variation prior introduce approach reflectance sparsity texture depth infrared image sequence video favorable intrinsic image decomposition imposes constant reflectance prior shade pixel within sequence recent research generally datasets supervise cnns  directly regress reflectance shade rgb image propose instance ShapeNet model exploit correlation intrinsic component interconnect decoder feature physic reflection model intrinsic gradient supervision steer utilize adversarial  leverage datasets intrinsic image decomposition steer physic invariant descriptor incorporates guidance network domain filter obtain realistically flatten reflectance image task approach unsupervised fashion rgb image addition image sequence exploit constrain reflectance within framework finally recent inverse scene render aim estimate scene reflectance intrinsic image decomposition algorithm shade unified component photometric nonetheless optimization disentangle shade perform additional decomposition instance illumination image multiple indirect component plausible however additional user stroke  recovers reflectance chromatic illumination performs poorly scene improve version depth information propose model reflectance illumination factorizes illumination indirect layer model multiple scene another image decompose reflectance shade irradiance indirect irradiance illumination multiplicative model prevents decomposition shadow cast ambient likewise dependent depth information perform additional decomposition decomposes image reflectance however instead model photometric approximate shade render aim estimate unified shade component decompose image reflectance occlusion diffuse illumination specular shade normal user friendly photo edit finally  predicts global spherical harmonic reflectance normal contrast exist propose decompose scene shade indirect shade model photometric without specialized regularization additional sensory information depth factorize indirect shade model ambient shadow cast whereas shade define geometry source interaction aim explicitly model photometric specific cue reflectance estimation disentanglement photometric intensity variation recently supervise cnn datasets outdoor scene frequently influence shadow cast unfortunately exist datasets lack variation photometric environment dataset ned datasets indoor scene ned contains outdoor environment illumination dense intrinsic image truth extend subset dataset generate shade shade due geometry illumination shadow cast ambient inter reflection truth image  additionally generic render pipeline generate grain shade decomposition grain shade decomposition standard image formation model lambertian component  reflection model basis image formation image visible spectrum model  indicates normal denotes source direction function geometric dependency lambertian furthermore wavelength indicates camera spectral sensitivity describes spectral distribution  finally denotes reflectance albedo intrinsic assume linear sensor response source narrow filter equation simplify  image model unified shade reflectance component source information embed illumination shade component context intrinsic image decomposition shade component define occlusion intensity source obviously photometric ambient shadow cast however assumption violate image compute intrinsic image explicitly model photometric correctly distinguish shadow cue drastic pixel reflectance variation image formation model composite shade incorporate photometric ambient assume ambient uniform linear function model relationship indirect   intensity ambient model cast shadow occluder illumination entirely portion ambient shadow intensity     occluder indicates reduce ambient cast shadow denote  linear function model relationship ambient shadow cast  indirect consists ambient denote additive shadow model negative ambient brighter whereas shadow  sample scene ned truth intrinsics grain shade component ambient  cannot shadow cast occlude image dataset environment dataset ned model baseline extend subset synthetic environment dataset ned introduce generate reflectance shade shade due geometry illumination ambient shadow cast truth image dataset contains park outdoor scene bush fence etc furthermore scene render terrain landscape additionally hdr image parallel source realistic ambient moreover source model daytime enrich photometric illustrates sample scene dataset dense truth annotation dataset randomly scene split training around image around image grain shade render pipeline render aforementioned obtain grain shade component dense truth annotation scene render physic blender cycle  render pipeline modify output reflectance unified shade truth intrinsic image truth normal image source intensity lambert shade component blender cycle modify output normal source truth shade component compute truth indirect ambient shadow cast task truth unified shade component already available render ambient due extra shade shadow cast reduction intensity shade truth unified shade truth indirect model significant deviation shade component subtraction component positive due extra indirect negative due lack pixel classify positive ambient whereas negative classify shadow cast therefore procedure label pixel dominant indirect cue scene simultaneously shadow source lit indirect ambient simultaneous action regulates pixel intensity dominant cue label accord  indirect shadow pixel classify shadow continuous   shadow intensity nonetheless formulation modify facilitate binary shadow threshold finally input image construct wise unified shade reflectance component obtain composite image physic image formation model ShadingNet image formation model propose ShadingNet grain shade component outdoor scene model estimate photometric refines reflectance prediction specialized fusion refinement coarse manner illustrate generation module encoder decoder decoder generate unified shade shadow cast ambient related reflectance prediction enhance feature discriminability relevant feature decoder attention module adapt encoder bottleneck decoder receives specialized bottleneck feature decoder tightly couple reflectance prediction shade intrinsic enforce feature discriminability shadow decoder disentangle shadow reflectance cue aim decoder specific reflectance cue specific photometric unified shade rationale allows analyze disentanglement quality photometric reflectance prediction finally estimate grain photometric component reflectance prediction fuse refine generate reflectance reflectance image predict parameter decoder identical exploit fusion aim generate learnable combination reflectance image contrast generation module feature cue reflectance photometric cue output refinement module fuse reflectance photometric cue input exploitation photometric motivation explicitly distinguish photometric reflectance variation predict shade component nonetheless indirect supervision signal explain entire model trainable ShadingNet model architecture decoder tightly couple reflectance prediction shade intrinsic generation module learnable attention module apply encoder bottleneck feature relevant decoder enhance feature discriminability fusion module combine reflectance prediction convolution learnable average fusion combine photometric cue fed refinement module generate reflectance image network detail intrinsics generation module encoder stride convolution layer downsampling initial convolution layer convolution consecutive residual residual compose batch norm relu conv sequence twice bottleneck encoder fed distinct efficient channel attention module individually fed decoder decoder conv batch norm  sequence feature  sample concatenate encoder counterpart skip connection resolution initial encoder input image channel rgb feature feature convolution operation penultimate bottleneck feature efficient channel attention kernel generate feature decoder receives specialized bottleneck feature decoder generate feature layer generates channel channel intrinsic component kernel initialize initialization slope  output  avoid negative pixel fusion reflectance prediction combine learnable convolution generate combination kernel initialize initialization module reflectance image input channel generates channel combination concatenate photometric fed refinement network refinement module module input fuse intrinsics photometric output reflectance unlike generation module feature cue refinement module fuse reflectance photometric cue input module convolution layer consecutive residual dilation generation module dilate residual compose batch norm relu conv sequence twice kernel initialize initialization module involve downsampling upsampling operation layer generates feature layer predicts channel reflectance image output relu avoid negative pixel entire model refinement module improves estimation generation module propagation training detail model adam optimizer rate batch rate halve epoch model convergence input output image normalize directly model convergence invariant error  truth intrinsic image estimation network error mse define  valid pixel  mse    mse  combine loss function evaluate quality estimation intrinsic component loss becomes   loss backbone implementation   assign intrinsic component yield distinct loss function reflectance combine shade ambient shadow cast furthermore image formation loss IMF constrain generate reflectance shade image formation model reconstruct image enforce input image reconstruct image predict reflectance shade image   finally shade component indirect supervision signal sect derive intensity composite model predicts ambient shadow cast unified shade reconstruct shade component image formation loss calculate shade truth shade image mse finally generation module loss function combine    loss define albedo prediction   additionally refinement module reflectance prediction supervise pixel loss gradient loss utilized image gradient compute intermediate difference pixel apply vertically horizontally pixel loss gradient loss generation loss without entire model scratch baseline estimate grain shade intrinsics extend version model comparison modification apply regular encoder decoder cnn architecture standard intrinsic image decomposition task extend ShapeNet model network enforce correlation intrinsic component increase intrinsic component predict model equip illustrates modification baseline grain shade model standard encoder decoder architecture baseline    baseline extra decoder denotes shade shadow cast ambient unified shade reflectance image baseline extend shade decoder multiple output photometric baseline shade decoder shade feature decompose correspond photometric shade component squeeze excitation SE shade decoder perform feature calibration SE prediction grain shading unified shade decoder enhance feature discriminability baseline extend architecture extra decoder per grain shade component baseline architecture encoder distinct decoder reflectance shade shadow cast ambient prediction unlike baseline shade feature derive decoder ShapeNet model decoder feature interconnect gradient decoder individually increase feature discriminability footnote evaluation fairly evaluate capability intrinsic image decomposition model along baseline supervise cnn architecture ned training split convergence training detail author addition model unsupervised cnn model finally optimization advanced retinex model model directly apply image without tune domain adaptation report invariant error  absolute brightness image adjust local error  structural dissimilarity index  perceptual quality comparison IIW disagreement rate  model intrinsics directly regress reflectance shade rgb image supervise fashion adapts multi architecture extract global contextual information refine sub network  reflectance shade prediction gradient loss reflectance prediction ShapeNet model supervise compose encoder decoder layer exploit correlation intrinsic component interconnect decoder feature skip connection encoder decoder  reflectance shade prediction  image gradient accurate prediction  model supervise employ vgg architecture encoder decoder skip connection apply encoder decoder standard mse reflectance shade prediction image formation loss  model supervise diverges distinct encoders parallel variant net  gradient reflectance shade prediction image formation loss  model adversarially learns latent feature representation reflectance shade intrinsics unsupervised uncorrelated data assumption distribution image domain domain invariant content reflectance shade independence reversible latent code encoders  unsupervised cnn model image sequence scene illumination therefore learns sequence constant factor reflectance illumination varies boost smoothness prior reflectance shade intrinsics evaluation importance model shadow handle capability due multi exposure  inverse render architecture uncontrolled outdoor image collection without truth network encoder layer decoder layer supervision model differentiable renderer structure multi stereo finally utilizes prior constraint reflectance generation piecewise smooth model powerful aware multi image normal illumination prior spherical harmonic structure texture aware advanced retinex model exponentiated local derivative model optimization label data datasets evaluation datasets quantitative truth label available environment dataset ned split rgb image correspond truth data unseen training mpi sintel dataset evaluation image rgb image truth scene render animate cartoon film blender software render distribution camera ned GTA dataset evaluation subset scene exclude scene fog scene outside scope randomly scene yield around rgb image dataset reflectance truth scene extract theft auto scene render  advanced  render distribution camera ned mpi sintel intrinsic image IIW dataset evaluation complex scene dataset consists sparse source noisy relative reflectance annotation mostly indoor image annotation classification task pixel pixel darker dataset identify around outdoor scene evaluation image flickr camera setup detailed information annotation evaluation metric mit intrinsic image dataset evaluation image dataset contains however author recommendation exclude  phone potato deem problematic previous datasets mit intrinsic image laboratory environment  dataset evaluation outdoor dataset image  robot semantically photometric camera setup scene ned equivalent ned qualitative evaluation dataset truth shadow removal dataset SRD dataset evaluation outdoor dataset specifically construct shadow removal task image canon 5D camera tripod shadow introduce various camera elevation setup illumination semantically scene reflectance phenomenon various shadow silhouette qualitative evaluation dataset truth unfortunately densely annotate intrinsic image outdoor scene technology generate truth intrinsic image fully indoor laboratory setting scene densely label truth intrinsic image exist evaluation ned mpi sintel datasets evaluation ned mpi sintel GTA extensive quantitative evaluation synthetic outdoor datasets completely render ned mpi sintel evaluation reflectance evaluation GTA addition qualitative comparison reflectance estimation qualitative comparison shade estimation image photometric ned appendix finally qualitative evaluation mpi sintel appendix quantitative evaluation ned domain gap baseline improve reflectance estimation ShapeNet backbone hence decomposition shade component improve reflectance explicit photometric cue significant difference baseline baseline ShadingNet metric reflectance shade model outperforms baseline grain shading model predict unified shade advanced retinex qualitative comparison reflectance estimation ned propose ShadingNet significantly reflectance image almost minimal shadow leakage truth image significant visual difference extend baseline ShapeNet backbone extend baseline exhibit shadow handle  estimation problematic undesired cast artefact similarly  generation blurry lack information qualitative comparison shade estimation ned appendix mpi sintel GTA dataset evaluation ass generalization capability model model directly apply image without tune domain adaptation mpi sintel ned baseline improve reflectance estimation ShapeNet backbone baseline ShadingNet model outperforms others metric  shade estimation nonetheless model specifically improve reflectance estimation GTA baseline cannot improve reflectance estimation ShapeNet backbone model metric qualitative comparison propose ShadingNet generates reflectance closer truth minimal shadow artefact performs shadow handle appendix reflectance evaluation GTA scene qualitative reflectance estimation ned propose ShadingNet significantly reflectance image almost minimal shadow leakage truth image significant visual difference extend baseline ShapeNet backbone  estimation problematic undesired cast artefact similarly  generation blurry lack information image electronic version image conclude conduct datasets completely render model grain shade estimation outperform improve generalization capability baseline grain shade component improve ShapeNet backbone ned mpi sintel GTA whereas achieve superior performance highlight importance choice qualitative quality propose model generate reflectance image almost minimal shadow leakage decent truth image similarly achieve sharper shade prediction evaluation intrinsic image IIW qualitative estimation IIW propose ShadingNet generate reflectance perform shadow handle shade handle environment vivid structure preserve  clearly visible reflectance estimation electronic version image evaluation IIW dataset quantitative evaluation qualitative reflectance prediction quantitative evaluation model grain photometric estimation outperforms estimate uniform shade inverse render model optimization advanced retinex baseline improves ShapeNet backbone margin baseline deteriorates margin model predict unified shade achieve propose suppresses baseline model estimate grain shade component highlight importance choice model  achieves attribute model exposure image sequence smoothness prior model  metric bias towards wise smooth reflectance prediction data driven approach exploit ned standard reconstruction loss without wise smoothness prior ned various rough terrain texture scatter bush wise smooth therefore supervise model without smoothness constraint metric dataset nonetheless improve performance apply filter enforce wise constant reflectance assumption processing reflectance evaluation IIW outdoor scene merit compelling evaluate visually qualitative comparison baseline prediction corrupt  cast model fails generate reflectance image scene dominate baseline prediction display partial  information relatively baseline generate dull ShapeNet estimation strongly resembles input image intensity although smooth  prediction fail model fails properly generate cast generates artefact jean jacket shade visible  dull fade blur cast attribute smoothness loss training quantitatively contributes qualitatively generate undesired estimation handle shading structure visible anymore model handle model qualitative comparison model appendix baseline improves ShapeNet backbone shadow evaluation IIW scene model generates sharper richer shadow capable handle diverse cue complex scene image propose ShadingNet generates significantly reflectance vivid structure preserve perform shadow handle shadow due bush mostly eliminate stair upper background shade model capable handle properly jean abrupt geometry model generate relatively smooth reflectance prediction addition environment model handle capability finally  clearly visible reflectance prediction bush carpet leaf moss  stair particularly important  information perfectly reflectance ideal model capable extract meaningful reflectance information rgb image finally shadow evaluation model generates richer shadow model capture shadow hallway  arch  due occlusion bush baseline fail capture shadow hallway arch  model detect occlusion leaf intensity stair model perform similarly model estimation sharper model capable detect shadow due occlusion ivy however baseline wrongly detects stair  baseline fails detect upper background conclude ShadingNet generate reflectance image emerge stable obtain quantitative vivid realistic handle shading environment abrupt geometry generalization capability complex outdoor image shadow image sharper capable handle diverse cue various complex outdoor scene although  achieves quantitative image sequence training applies smoothness prior address metric explicitly estimate photometric contributes improve reflectance evaluation mit intrinsic image evaluate model mit intrinsic image quantitative evaluation qualitative reflectance prediction quantitative demonstrate baseline estimate grain shade component improve reflectance estimation ShapeNet backbone estimate unified shade propose ShadingNet generates reflectance significantly outperforms metric  shade estimation achieve  shade estimation advanced retinex model achieves shade estimation  metric nonetheless average achieve significantly moreover shade estimation competitive model specifically improve reflectance estimation reflectance metric improve dataset completely domain generate sharper estimation closer truth reproduction shade handle exhibit significantly generalization performance mit intrinsic image image qualitative reflectance evaluation image propose ShadingNet generates significantly reflectance vivid structure preserve perform handle various shadow image shadow evaluation scene baseline wrongly focus baseline limited depth emphasis occlusion bush shadow cast generate richer shadow diverse shadow image ambient evaluation scene baseline overfit brightest pixel ambient prediction model differentiate brightness attribute reflectance illumination image qualitative demonstrate model generates reflectance model previous baseline tend generate undesired  cast ShapeNet generate dull fade IIW  tends confuse generate erroneous reflectance image moreover fails handle shade cue reflectance prediction  generate reflectance contaminate artefact dull fade ShadingNet generate reflectance image sharper closer truth image reproduction shade handle qualitative comparison model appendix previous scene ned mpi sintel GTA IIW already generalization ability propose ShadingNet addition ShadingNet model significantly performance totally domain image quantitatively qualitatively therefore ShadingNet model exceptional generalization performance baseline grain shading model predict unified shade advanced retinex evaluation  outdoor scene extensive qualitative comparison outdoor dataset  equivalent ned reflectance prediction previous baseline prediction corrupt  cast model detects shadow cannot properly eliminate reflectance generation baseline shadow handle baseline ShapeNet backbone ShapeNet model fails generate wrongly classifies shadow cue reflectance prediction  model generates smooth reflectance prediction however shadow photometric reflection prediction contaminate shadow cue furthermore lighter negatively affected cast behaviour  image cast model fail scene dominate moreover  prediction highly resemble input rgb image although model image sequence quality shadow handle fails achieve finally  estimation contaminate artefact dull fade   model shadow qualitative comparison model appendix propose ShadingNet generates reflectance vivid structure preserve lively perform shadow handle shadow due bush mostly eliminate behaviour shadow due bush handle shadow cast patter  building mostly eliminate none model handle recognize likewise model handle shadow  shading building visible others finally qualitative evaluation photometric estimation shadow generation evaluation baseline wrongly focus numerous baseline limited depth generate information away background building totally discard occlusion completely neglect model generate richer shadow aware various shadow baseline cannot capture shadow due bush baseline cannot detect shadow bush addition emphasis occlusion bush shadow cast model detect shadow cast  background building shadow cast background building baseline detects baseline fail detect shadow cast  ambient estimation evaluation model mostly focus image formation data generation model ambient illumination extra shade component although training data generate synthetic truth model mostly aware ambient however baseline directly anticipate brightest pixel highlight ambient cue baseline emphasis aluminum roof building shiny reflectance pixel scene baseline overfit brightest pixel ambient prediction model differentiate brightness attribute reflectance illumination model mostly focus shiny roof reflectance whereas baseline highlight roof shadow cast baseline uniformly highlight roof emphasis conclude ShadingNet generate reflectance image emerge stable generate vivid realistic handle diversified shadow environment generalization capability outdoor scene shadow estimation capable capture diverse cue aware limited depth scene finally model differentiate brightness attribute reflectance illumination whereas baseline directly overfit brightest pixel qualitative reflectance evaluation shadow removal dataset propose ShadingNet generates significantly reflectance vivid structure preserve whereas cannot properly handle shadow cast generate additional artefact model remove shadow cast achromatic image electronic version image shadow cast evaluation shadow removal dataset model generate richer shadow capture various shadow aware achromatic image evaluation shadow removal dataset SRD demonstrate quality model complex outdoor dataset specifically craft shadow removal task qualitative comparison reflectance prediction baseline improve ShapeNet backbone baseline generates baseline generates additional shadow artefact  ShapeNet prediction dull previous  tends confuse generate erroneous reflectance image reflectance estimation completely addition instead remove shadow cue reflectance image model boost shadow pixel cluster intensity contrast shadow emphasize suggests model cannot properly handle outdoor shadow  estimation resemble input rgb image previous image dull shadow cue reflectance estimation although model image sequence cannot properly handle outdoor shadow fail handle shadow cast SRD model handle shadow cast however others generates reflectance image structure visible anymore background building  visible anymore qualitative comparison model appendix propose ShadingNet generates significantly reflectance vivid structure preserve perform shadow handle shadow shadow due occlusion  mostly eliminate similarly handle relatively shadow cast addition model properly handle shadow cast achromatic uniformity background minimum shadow leakage whereas model generate additional artefact finally realistic finally qualitative evaluation shadow cast estimation baseline detect occlusion leaf  model fully detect intersection  shadow micro occlusion model behave practically model fully detect shadow cast achromatic whereas baseline focus darker pixel distribute baseline partially detect emphasis darker  moss  attribute reflection estimation baseline generates relatively sharper estimation ignores  shadow due occlusion model detect shadow cast whereas baseline fails conclude ShadingNet generates significantly reflectance intrinsics camera elevation setup generate vivid addition model handle various shadow cast achromatic dominate scene whereas baseline generally struggle diverse distribution evaluation refinement module evaluate quality individual reflectance estimation refinement module quantitative ned domain gap GTA dataset evaluation ass generalization performance refinement module improves reconstruction quality reflectance estimation metric reflectance estimate shadow achieve photometric suggests shadow cast cue negatively reflectance estimation explicitly classify generates reflectance evaluation refinement module addition ned qualitative demonstrate benefit propose refinement module demonstrates shade generate reflectance suffers estimation quality shadow cast fence likewise shade generate reflectance generation cannot properly handle photometric cue contaminate shadow cast significant visual difference estimation nonetheless prediction shadow leakage reflectance generate refinement module truth module handle shadow leakage generates sharper estimation improves augmentation capture grain orange visual evaluation image without truth appendix evaluation refinement module shade generate reflectance suffers estimation quality refinement module handle shadow leakage improves augmentation scene image evaluation grain shading evaluate reconstruction quality grain shade estimation extend ned baseline comparison quantitative baseline conditioning photometric prediction unified shade decoder achieves baseline individual decoder model significantly achieves reconstruction quality baseline component predict shade component supervision signal achieve reconstruction quality shade generation highlight importance choice grain shade component shade component challenge model evaluation grain shading shadow estimation ned model aware diverse generates sharper image ambient estimation ned model aware cannot image shade estimation ned model aware texture cue cast shadow feature image addition shadow cast estimation baseline handle cue baseline estimation relatively model aware diverse shadow estimation closer truth image sharper baseline additionally ambient estimation model aware indirect cue recognize cannot baseline tend fail demonstrates perform relatively reasonable handle shadow cast evaluation baseline estimation baseline ambient estimation significantly superior baseline finally shade estimation baseline aware texture cue pot cannot properly ass source likewise fail capture source visible anymore estimation pollute indirect shadow cast feature model aware source texture cue cast shadow feature mistake shadow fence shadow cue attribute supervision mechanism shade component calculate estimate shade component therefore individual error accumulate furthermore quantitative shade component challenge component model geometry information entangle representation truth component calculate lambertian shade normal source whereas estimation extract rgb image without explicit supervision regularization normal feature source shade evaluation ShadingNet generates shade sharper properly capture photometric cue image electronic version image shade estimation focus reflectance prediction grain shade component explicitly model photometric cue improves reflectance estimation quality quantitative evaluation shade estimation truth label available qualitative evaluation shade estimation image baseline generate blurry shade robot clearly visible baseline fails capture crisp shadow significant difference baseline ShapeNet backbone  generates additional undesired shadow artifact  estimation  blurry due smoothness prior achieves decent estimation shade estimation remarkably reflectance ShadingNet generates shade sharper properly capture photometric cue generation sharper estimation contrast conclusion aim improve reflectance image estimation quality explicitly model photometric cue achieve standard lambertian image formation model extend incorporate grain shade component shade component factorize photometric shade shade geometry indirect shade shadow ambient generate reflectance scene supervise cnn model ShadingNet utilized exploit grain model model specifically improve reflectance estimation decoder attention mechanism novel refinement module estimate grain shade intrinsics extend version intrinsic image decomposition model baseline comparison along baseline exploit grain model performance supervise model utilize unified shade evaluate furthermore model dataset synthetic image outdoor environment ned extend generate grain intrinsic image model extend ned unsupervised outdoor inverse render model image sequence evaluation finally structure texture aware optimization advanced retinex evaluate evaluation datasets ned mpi sintel GTA IIW mit intrinsic image  SRD comprehensively setup without tune domain adaptation stage evaluation intrinsic image decomposition highly benefit propose grain shade model explicitly classify photometric significantly improves reflectance estimation baseline grain estimation improve backbone model predict unified shade component propose ShadingNet constantly outperforms baseline grain shading supervise model predict unified shade outdoor inverse render model image sequence advanced retinex margin qualitative comparison demonstrate ShadingNet properly handle diverse shadow environment shade generate reflectance sharper vivid augmentation reproduction addition generate sharper richer shadow various shadow patter aware achromatic model differentiate brightness detect source pixel  attribute reflectance ambient finally model emerges stable exceptional generalization performance ability properly handle synthetic scene complex scene image