 utilizes truth prior distribution patch rebuild image distribution generative conditional prior couple distribution obtain reconstructive adversarial introduce patch attention layer exploit relation decoder encoder feature improve appearance consistency visible generate yield various datasets exist multiple diverse output access auckland library introduction image completion involves issue alternative content image restore damage painting remove unwanted generate content incomplete scene approach propose non trivial task diffusion patch approach rapidly improve completion optimal masked image capacity generate variety semantically meaningful remains challenge multiple diverse plausible highly subjective suppose image various occupy related expert  restore damage semantic content overall scene ensure structural continuity masked unmasked visually realistic content nonetheless expert independently substantially detail various universally semantics placement damage portrait observation goal research generate multiple diverse plausible masked image refer task  image completion depict oppose exist attempt generate ill completion image building scenery various mask mask visual purpose masked input image sample model without processing diverse plausible rectangle highlight diverse content zoom detail image obtain diverse input utilize conditional variational auto encoders CVAE conditional extension variational auto encoders VAE explicitly code distribution sample however specifically image completion scenario standard formulation usually grossly underestimate variance label masked image truth instance training data label typically complement masked image hence estimate conditional distribution tend limited variation reconstruct image important insight partial image patch superset image generate latent smooth prior distribution mechanism alleviate scarce sample per conditional masked image introduce  image completion network PICNet parallel link training pipeline pipeline VAE reconstructive utilizes instance truth imposes smooth prior latent partial image pipeline generative learns predict latent prior distribution visible pixel sample generate diverse training latter attempt steer output towards reconstruct instance specific instead  driven auxiliary discriminator network substantially variability generation utilize information visible partial image introduce enhance patch attention layer generic attention mechanism allows information visible scheme converges quickly significantly increase quality comprehensively evaluate approach exist variety scene sect various mask regular irregular mask erode image additionally application model image edit sect removal edit scene content aware extensive experimental demonstrate propose PICNet generates quality completion multiple diverse subjective processing task summary probabilistically principled framework image completion maintain sample diversity exist PICNet parallel training reconstruct training data maintain variance conditional distribution novel patch attention layer exploit context information ensure appearance consistency image domain manner superior purely gans demonstrate mask multiple plausible substantial diversity preliminary version manuscript publish  journal extension improve propose image completion conduct thorough analysis component extensive restrict distribution estimation training phase extend attention patch modification successfully extend probabilistically principled framework image completion arbitrary input mask thorough ablation analyze propose component moreover additionally evaluate approach various mask conduct quantitative comparison feature metric user qualitative resolution image various image edit application recent consistently benchmark  image completion framework extend task code interactive demo publicly available footnote structure discus related sect propose probabilistically principled framework sect improve attention module sect thorough analysis propose component correspond discus sect conclude sect related exist image completion information within image information image dataset approach generate per masked image precisely downside address intra image completion traditional intra image completion inpainting mainly propagate realign background focus assume appearance visible category intra image completion diffusion image synthesis surround background propagate local narrow another category intra image completion patch approach copying information visible quality texture consistent however intra image cannot capture global semantics hallucinate content significant image completion inter image completion hallucinate semantically content inter image completion borrows information dataset hay  image completion image recently approach propose initial focus propose context encoders CE handle built upon combine global local discriminator GL adversarial loss multi cnns cosine similarity loss quality image painting recent introduce partial convolution irregular mask image completion explore additional information semantically image completion closest feature latent masked image generate image introduce additional parse loss ensure semantic consistency image propose spg net simultaneously semantic rgb appearance completion moreover sketch    SC  drawback utilize visible information local convolutional operation creates distort structure blurry texture inconsistent visible degrade image truth image masked image correspond complement image masked image reasonable strongly enforce masked identical truth variation content perfectly consistent visible entire masked image combine intra inter image completion mitigate blurry propose multi neural patch synthesis generates frequency detail copying patch mid layer feature recently exploit spatial attention frequency detail propose contextual attention layer frequency detail copying feature visible propose PatchMatch feature domain propose contextual residual aggregation resolution image inpainting however identify feature feature visible somewhat contradictory feature transfer unnecessary feature feature easily furthermore information content differs visible model solves extend attention harness abundant context image generation image generation progress significantly VAE gans apply conditional image generation task image translation synthetic realistic future prediction 3D model relevant spirit conditional VAEs CVAE CVAE gan specially target image completion CVAE useful conditional label discrete sufficient training instance per label recent utilize image translation diverse output situation sample mapping local pixel pixel visual appearance without generate content  image completion conditional label masked image training instance output obtain completion specify facial attribute domain specific target attribute contrast propose probabilistically principled framework multiple diverse plausible various datasets label information training approach suppose image originally truth degrade pixel become masked partial image comprise visible pixel define complement partial image comprise pixel completion strategy masked image deterministic structure directly predicts truth instance CVAE random sample diversify output truth instance blind masked instance training unstable generative parallel reconstructive training training online image prior image completion attempt reconstruct unmasked image deterministic fashion deterministic however rigid approach limitation rebuild image visible tightly constrain content masked unnecessarily limit visible perceptually consistent completion expression building appearance equally acceptable deterministic generate recover richer distribution reasonable possibility instead goal sample reconstruct image correspond complement partial image training  image completion network probabilistic framework distribution sample approach employ CVAE estimate parametric distribution latent sample involves variational bound conditional likelihood logùëù KL  logùëùùúÉ latent vector patch recognition network conditional prior likelihood network parameter correspond function bound maximize parameter purpose difficulty CVAE directly dof recognition network conditional prior network easily separable besides conditional prior network sufficiently unconstrained lean narrow delta prior distribution maximum latent likelihood variance latent distribution easily driven towards zero approximately equivalent maximize  logùëùùúÉ  variant directly recognition network prior network variance prior useful estimate sample negligible diversity image completion CVAE variant assumes conditional prior instead network learns ignore latent sample directly estimate fix truth diversify output simply incentivize output reconstruct instance specific training training distribution deem adversarial discriminator instance blind however approach unstable complex scene detail analysis sect latent prior approach partial image patch superset image arise latent distribution smooth prior variational bound logùëù KL  logùëùùúÉ kingma prior however discern partial image pixel complement image pixel masked image prior variance complement image pixel masked partial image pixel completely deterministic hence generalize prior adapt pixel overview architecture parallel pipeline reconstructive pipeline combine information training generative pipeline infers conditional distribution hidden sample representation network generation network identical online image prior conditional couple combine latent prior conditional bound distribution target partial image naturally infer target image available training update logùëù KL  logùëùùúÉ however unlike longer freely training presence intuitively regularize prior conditional prior regularize reconstruction creative generation issue sample training available  sample adequately role mitigate modify blend formulation without importance sample typically image completion training instance unique function network hardcoded dependency input assume network model explicit constraint impose training KL divergence zero function logùëù  logùëùùúÉ  version however unlike variance distribution zero mention sample visible without importance sample contrary importance sample finally combine obtain reconstruction creative generation function logùëù   KL   implicitly training loss coefficient sect sample importance function instance information available formulate likelihood  focus reconstruct conversely sample distribution facilitate creative generation likelihood model   independent instance instead encourages generate sample overall training distribution joint unconditional conditional variational bound overall training objective express jointly maximize bound unify likelihood  sample important sample rebuild define combine function maximization goal      bound related unconditional likelihood partial image relates likelihood function hybrid objective function conditional prior network recognition network longer freely constrain mask related prior furthermore without importance sample sample predict fix instance training encourages diversity network structure training loss formula implement dual pipeline illustrate consists representation inference generation auxiliary discriminator network upper pipeline reconstruction training corresponds bound contains information image hence combine conditional feature easily rebuild image contrast training responsible bound information infer masked image restrictive prediction transfer bound correspond loss function training jointly maximize bound minimize loss consists component loss          KL regularizes consistency distribution KL divergence app encourages appearance fidelity sample image training distribution reconstructive generative respectively distributive regularization typical interpretation KL divergence VAE regularizes importance sample function latent prior define gaussians KL KL generative appropriate interpretation reverse conditional prior gaussian regularize KL KL conditional prior importance function access appearance loss likelihood  interpret probabilistically encourage appearance however framework auto encodes masked image via deterministically loss function cater reconstruction per instance loss app rec rec reconstruct image respectively purpose loss bias representation towards actual visible information contrast generative latent distribution infer visible significantly accurate inference upper ignore instance specific appearance focus reconstruct app gen gen generate image binary mask visible pixel adversarial loss formulation  instance blind  incorporates adversarially discriminator judge generate image training distribution inspire feature loss reconstructive generator rec feature output layer encourages reconstruct feature discriminator conversely adversarial loss generative generator gen generator loss  performs gan loss scenario discriminator loss  analysis network structure investigate influence training structure comparison variant CVAE instance blind structure multi model BicycleGAN celeba HQ dataset mask quantitative comparison network structure celeba HQ mask compute diversity perceptual image patch similarity LPIPS metric report LPIPS metric calculates average distance sample feature domain random pre network extract feature image distance vector calculate distance distance indicates diverse generate sample randomly generate image masked image   output masked output respectively furthermore popular fr√©chet inception distance fid ass visual quality image distance distribution image feature domain traditional pixel patch image quality metric loss structural similarity ssim peak signal ratio psnr closest generate image truth image calculation metric diversity image quality analysis network structure improve image quality significantly relative improvement fid generate multiple diverse completion BicycleGAN obtain relatively diversity baseline framework cycle loss instead reconstruction loss however image quality suggests despite increase diversity network structure directly suitable image completion qualitative comparison training strategy masked image others diverse style expression realistic appearance image sample structure CVAE obtains reasonable variation framework likely ignore sample predict deterministic outcome rebuild truth training mask degrade input instance blind enforce generate image truth CVAE visual BicycleGAN model latent code encoder replicate spatial random semantic meaning contrary latent code infer visible pixel predict semantic information visible pixel quantitative comparison variance imagenet mask dynamic propose dynamic variance previous fix variance VAE CVAE diversity naturally related masked ratio masked diversity fix version achieve diversity sample vector variation fid average contrast dynamic  sample vector generates quality diversity recent aim simultaneously improve diversity image quality patch attention layer attention directly compute decoder feature estimate content similarity domain obtain attention compute attention decoder feature contextual encoder feature image texture arrow  generate content mask masked input image multiple diverse query dot correspond attention upsampled image visualization query output quality texture visible rectangle generate rectangle content generate highlight attention online image texture arrow masked image masked input image degrade query denote dot correspond attention query output attend visible rectangle visible content online image patch attention weakness purely convolutional operation limited spatial cannot efficiently exploit correlation extend beyond attention  propose novel patch attention layer attention within decoder layer harness spatial context capture feature feature context encoder decoder layer novel insight network choice attend finer grain visible feature encoder semantically generative feature decoder circumstance propose structure patch attention feature attention widely image completion task calculate attention frequency decoder feature frequency encoder feature visible frequency feature visible similarity however contradictory feature transfer unnecessary feature feature easily address calculate content similarity feature domain decoder feature attention calculates response sequence attention sequence feature previous decoder layer calculates attention exp exp   similarity ith location jth location pixel convolution filter refining feature inspire PatchMatch ensure consistency attention fuse similarity patch  neighborhood patch jth ith location separately fix throughout attention decoder obtain attention non local information fuse decoder feature intra layer attention feature attention output     parameter balance attention feature decoder feature initial zero attention encoder visible addition specifically image completion task quality ensure appearance consistency generate patch patch visible introduce inter layer attention feature attention response attends visible encode feature therefore output     parameter combine encoder feature attention feature however unlike decoder feature information generate image encoder feature visible hence binary mask denotes visible quality visible feature content similarity finally attention feature aggregate fed decoder layer comparison various attention module image masked input image contextual attention attention multiple patch attention correspond attention query focus visible attention attends generate attention information visible generate attention online image analysis reader propose attention layer achieve performance exist contextual attention layer propose module exploit non local information visible generate instead purely copying frequency information visible along correspond attention query attention highlight arrow explicitly texture attention layer information quality visible feature rectangle originally masked rectangle propose attention layer attends visible differently generate content sample model model ensures appearance consistency  generate appearance visible pixel texture visible masked mask propose attention layer learns quality pixel correspond visible rectangle rectangle propose attention layer previous contextual attention CA attention SA image completion propose attention layer borrows feature directly copying feature visible CA building scene CA quality due presence structure however mask CA SA unable generate quality worth mention CA quality pixel purple rectangle visible obtain unrealistic rectangle masked cannot non local patch visible conversely SA feature decoder network ignore quality visible feature generates plausible appearance generate inconsistent visible attention module utilize decoder feature masked encoder feature appropriately information  decode masked focus encode feature visible qualitative paris validation completion PM CE shift net EC PICNet generates realistic appearance image experimental experimental detail datasets evaluate propose PICNet arbitrary mask various datasets paris celeba HQ imagenet model evaluate irregular mask regular mask metric quantitative evaluation tricky  image completion task goal diverse reasonable masked image image comparison image therefore fr√©chet inception distance fid inception ass quality image feature report traditional pixel patch image quality metric loss structure similarity index ssim peak signal ratio psnr additionally visual realism judgment previously propose widely adopt image generation training PICNet implement pytorch input highlight visual purpose mini batch image per nvidia gpu input reconstructive generative output binary mask randomly regular irregular however unrestricted mask mask prior network convergence training completion network loss reconstructive information visible estimate distribution relate mask obtain distribution reconstructive generative infer distribution visible generate multiple optimization loss    inference generation apply generate multiple diverse visible information sample image masked input image distribution sample visible fix distribution previous visual automatically discriminator comparison exist mainly PM PatchMatch non approach  context encoder  globally locally arbitrary  contextual attention combine patch  partial convolution irregular    gate convolution completion network auxiliary information approach PICNet multiple various datasets ill comparison mainly report model correspond dataset release model respective author website perform model qualitative comparison PM CE GL CA imagenet validation PICNet generate semantic significant semantic information image completion qualitative visual paris dataset PM cop patch visible obtains dataset repetitive structure CE generates reasonable structure blurry texture shift net copying feature visible CA CA release model paris EC reasonable PICNet model generates image quality multiple report performance challenge imagenet dataset comparison subset training image imagenet model previous visual variety validation visual image chosen CE GL CA correctly semantic model infer content effectively model generate meanwhile PICNet multiple diverse realistic quantitative comparison imagenet mask completion evaluate model various datasets irregular propose dataset generate category mask image ratio irregular mask approach qualitatively quantitatively GL CA obtain release model regular random mask EC generate release model image mask PConv partial convolutional operation reproduce model mask quantitative comparison mask comparison qualitative paris validation mask PConv image masked input PM PConv EC multiple diverse image qualitative celeba HQ mask PConv image masked input PM CA EC GC multiple diverse image qualitative various mask masked input PM CA PConv EC GC multiple diverse image quantitative report fid imagenet sample generate image evaluation automatically vote discriminator multiple slight EC mask improve fid significantly mask ratio relative improvement fid mask ratio suggests mask ratio sufficient predict visible pixel reasonable mask ratio latter approach generate multiple diverse distribution traditional pixel patch comparison report metric image evaluation sample multiple balance quantitative comparison without  instantiation model outperform exist model random sample image prior strongly enforce generate image image via reconstruction loss image training qualitative qualitative comparison visualize PICNet achieve multiple challenge paris dataset PM PConv fail synthesize semantic structure EC obvious structure utilize auxiliary explicitly information visible visual repetitive structure furthermore model multiple diverse masked image celeba HQ dataset non PM unable generate reasonable semantic content image CA generate novel content suitable GC improves gate convolution EC reasonable semantic structure blurry inconsistent image approach explicitly variable strongly enforce image hence PICNet multiple plausible expression online demo project footnote challenge dataset non PM reasonable pixel scene copying patch visible CA regular mask release model random regular mask EC GC generate content semantically reasonable realistic due detail instead plausible image PICNet multiple sample furthermore identify image patch attention non local information visible correctly predict content visual turing additionally perceive visual fidelity model exist approach perceptual metric propose conduct user survey alternative choice  visual fidelity perceive quality   randomly generate image undisclosed participant image fake quality insert image avoid negative  participant masked input correspond blind participant image visually realistic participant vote multiple image simultaneously image equally realistic participant randomly consist   valid survey additional PICNet celeba HQ image edit image masked input image output PICNet erase eyeglass wrinkle facial remove finally freely expression due provision multiple diverse user easily favorite refer reader online demo image alternative choice  celeba HQ visual fidelity perceive quality  additional PICNet image edit image input masked image multiple diverse output PICNet reshape ridge removal unlike conventional inpainting multiple diverse choice resolution image image facs evaluation participant correctly identify image evaluation conscientious discern judgement model achieve realism exist  evaluation participant strongly mask ratio challenge mask ratio suggests visible impose constraint multiple diverse naturally varied mostly realistic reasonable  model image masked input multiple diverse PICNet style user image additional additional propose PICNet approach suitable application edit scene  removal  edit image edit image model conventional removal remove eyeglass smooth remove wrinkle facial finally expression multiple diverse resolution image edit PICNet handle resolution HR image completion generation random vector fix feature however stage image completion approach another encoder decoder framework refine fix resolution output PICNet focus HR image refinement network directly  PICNet framework refinement stage without sample multiple diverse content generation stage approach diverse visually realistic appearance HR image edit reshape ridge generate various demonstrates model HR image  dual pipeline framework masked image correspond complement image easily swap therefore randomly reverse input mask training celeba HQ information image border  challenge task uncertainty significantly varied completion model applicable style edit structure extend related task spherical image generation failure PICNet image masked input failure PICNet semantic information heavily masked visible image limitation although model achieve exist various datasets image diverse sample model cope heavily structure important information semantic image completion immature task upon conventional image inpainting understand semantic image content remains challenge although visible model cannot generate multiple sample image content correctly generate attention model fails quality visual conclusion novel image completion task unlike exist probabilistically principled framework generate multiple diverse plausible content masked image PICNet prior conditional bound couple significant conditional image generation reasonable training deterministic structure introduce enhance patch attention layer improves realism automatically attend quality visible feature semantically generate feature variety datasets demonstrate multiple diverse quality feature metric traditional pixel patch metric demonstrate PICNet outperform approach mask ratio uncertainty user strongly exist approach additionally demonstrate PICNet suitable image edit removal expression scene  multiple diverse easily extend HR image edit