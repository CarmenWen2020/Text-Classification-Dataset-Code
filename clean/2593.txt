pervasive data healthcare device posse significant medical data professional healthcare service provider however health data security issue access privacy leakage critical challenge obtain efficient data analysis service article propose efficient privacy preserve fog assist health data PFHDS scheme healthcare specifically integrate fog node classify data category accord disease risk efficient health data analysis meanwhile enhance attribute encryption combination personal access policy patient professional access policy fog node effective medical service provision furthermore achieve significant encryption consumption reduction patient offload portion computation storage burden patient fog node security discussion PFHDS realizes data confidentiality grain access collusion resistance performance evaluation demonstrate efficient encryption computation storage consumption CCS concept security privacy access compute ubiquitous compute apply compute health information additional fog compute access data healthcare privacy preservation introduction healthcare emerge promising healthcare paradigm health data collection health monitoring development information communication technology various category health data heterogenous healthcare device smart health glucose meter  critical data management issue compute manage volume data powerful storage resource compute service assist ehealthcare  widely developed  patient pervasive healthcare device health data data remote server data user professional healthcare service provider access analyze data healthcare service infection analysis personal treatment clinical diagnosis privacy leakage security threat data assist ehealthcare personal privacy disclose data employee obtain health information illegal unauthorized user access data patient  pharmaceutical analyze health data obtain patient health status advertisement drug promotion health data tamper data transmission data collection storage instance glucose patient alter deliver healthcare incorrect healthcare treatment data privacy leakage unauthorized data access data tamper  attribute encryption CP abe widely propose health data multiple data access paradigm data confidentiality preservation patient define access policy encrypt data ciphertext server data user access data decrypt ciphertext attribute satisfy access policy however exist data scheme challenge healthcare specifically hardly enable effective healthcare service provision efficient medical analysis incur severe resource consumption encryption resource limited ehealthcare device exist access policy definition health data scheme cannot guarantee effective healthcare service provision privacy preservation simultaneously patient generally coarse preference define access policy accord nonetheless health data professional medical knowledge understand patient without sufficient healthcare background hardly define appropriate access policy guarantee privacy preservation obtain healthcare service simultaneously unfortunately privacy preservation appropriate healthcare service contradict access policy define strict attribute privacy preservation data accessible appropriate healthcare service provider access policy define loose attribute data accessible healthcare service provider increase privacy disclosure risk strict access policy define access policy relatively attribute satisfy loose access policy alice intend health data healthcare service access policy hospital  alice suffers cardiovascular disease risk cardiovascular professional effective healthcare service provider however non cardiovascular service provider satisfy access policy access data incur potential privacy leakage meanwhile acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme health data scheme impair service provider efficiently analyze various raw data heterogenous device clinical data highly target specific disease diagnosis data healthcare aggregate mixed category service provider hardly seek specific healthcare data correspond disease risk analysis medical benefit healthcare data hardly  ciphertext mixed portion ECG signal muscle signal calorie data glucose server access healthcare service provider ciphertext decrypt portion ECG signal analyze cardiovascular related service provision indeed cardiovascular professional resource unnecessarily consume decryption medical analysis efficiency severely affected additionally encryption computation ciphertext storage CP abe resource demand increase attribute access policy brings severe resource consumption resource limited healthcare device amount computation storage resource occupy encryption healthcare device sufficient resource accurate health data monitoring consumption shortens operation lifespan healthcare device release enormous impact patient address challenge novel privacy preserve health data framework effective service provision data utilization efficient resource consumption fog compute promising assist data fusion filter analysis healthcare extends data compute network intelligent powerful healthcare device previous fog assist data scheme fog node integrate encrypt data efficient medical analysis specifically scheme inherits advantage fog compute efficient data pre processing CP abe privacy preservation however issue remain unaddressed pre health data fog node efficient data utilization patient retrieve decrypt health data fog node encrypts guarantee patient privacy data encrypt semi trust fog node prevent unauthorized data access fog node colludes entity plaintext article propose privacy preserve fog assist health data PFHDS scheme enhance data utilization efficiency effective medical service provision  patient encrypt data personal access policy accord ciphertext fog node efficient data utilization fog node classifies health data category disease risk naive bayes classification regard category disease risk fog node defines specific attribute encrypt correspond health item accord healthcare background finally ciphertext transmit storage service provider decrypt ciphertext effective healthcare service provision knowledge PFHDS health data scheme integrate fog compute  assist health data classification data encryption healthcare specifically contribution PFHDS construct secure fog assist health data framework personalize access policy definition patient patient retrieve health data data disclosure data processing fog node acm transaction intelligent technology vol article publication date october guarantee grain access effective medical service provision encryption specific attribute intelligent fog node medical background data originally encrypt patient access authorize service provider effective medical service provision achieve efficient data utilization various healthcare service provider raw data classify category disease risk correspond health item regard disease risk encrypt attribute professional healthcare service provider health data efficiently access utilized hierarchical diagnosis treatment achieve efficient data security analysis propose scheme preserve privacy patient health data guarantee authorize data access health data resists collusion fog node unauthorized entity furthermore conduct extensive simulation demonstrate PFHDS achieve effective healthcare service provision efficient data analysis acceptable computational overhead remainder article organize review related data healthcare introduces preliminary notation model goal PFHDS detail security discussion performance evaluation respectively conclusion related WORKS exist health data scheme widely propose focus aspect privacy preservation efficiency health data privacy sensitive privacy preservation critically research exist data scheme propose cloudlet health data utilized theory research  encrypt user data wearable device trust model patient communicate disease integrate attribute encryption threshold signing role access  prevent potential misbehavior healthcare propose medical scheme compute classification attribute medical vertical partition medical dataset medical data achieve privacy propose grain electronic health scheme via similarity recommendation accelerate locality sensitive hash assist healthcare propose data scheme multimedia achieve privacy preservation computation challenge secure data propose eliminate majority computation task public parameter besides partial encryption computation offline addition public ciphertext phase perform decryption phase eliminates computation overhead due illegitimate ciphertexts sake data security chameleon hash function generate immediate ciphertext blind offline ciphertexts obtain online ciphertexts preserve location privacy data propose enhance privacy preserve data scheme cache spatial anonymity  continuous LBSs adopt multi cache reduce risk exposure user information untrusted  propose traceable data scheme leverage agreement acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme signature anonymous multiple user public member communicate anonymously respect signature identity member trace however conference derive agreement enable member data securely propose privacy enhance data scheme data user generate random query trapdoor leverage bloom filter bilinear operation construct secure index data file propose scheme enable perform data without obtain useful information exploit consortium blockchain smart contract technology achieve authorize data vehicular network efficiently propose reputation data scheme ensure quality data vehicle efficiency health data widely concerned resource limited healthcare device propose public crypto constant ciphertexts secure data realize efficient delegation decryption ciphertexts aggregate secret propose efficient hierarchy attribute encryption scheme compute integrate access security various health file user  multiple security domain reduce management complexity owner user achieve grain scalable data access propose online offline attribute encryption health data scheme reduce encryption mobile healthcare perform majority computation task offline phase online phase rapidly assemble ciphertext electronic health approach propose hybrid offload encryption workload private propose private hybrid scheme reference propose sensitive data private sensitive data public achieve storage elasticity enterprise data reference introduce private interface user public manage private user privilege private summary exist data scheme neglect effective healthcare service provision efficient data analysis critical issue valuable data utilization health data healthcare benefit fog compute  apply healthcare propose novel efficient privacy preserve fog assist data scheme healthcare PRELIMINARIES  briefly introduce preliminary shamir secret bilinear naive bayes classifier important notation frequently throughout article shamir secret shamir secret scheme secret satisfies secret easily computable completely undetermined equally likely acm transaction intelligent technology vol article publication date october notation abnormal health dataset  node xth access index unique associate node node polynomial node ith disease risk  ith health item index related idi ith health item probability disease risk happens pji probability abnormal health item idi happens disease happens atree personal access node btree professional access node dri ith node dec decryption node shamir secret scheme consists secret suppose user secret user chooses polynomial  randomly chosen user  transmits secret retrieval secret retrieve secret index lagrange coefficient compute lagrange interpolation calculate bilinear bilinear pairing namely   par algebraic curve define GT cyclic additive generate prime GT cyclic multiplicative discrete logarithm DLP GT bilinear pairing bilinearity non degeneracy parameter GT computability efficient algorithm compute naive bayes classification naive bayes classification classify instance classifier joint probability classifier instance acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme fog assist health data model feature compute probability happens happens correspond classifier maximum predict classifier accord bayes theorem feature effectively constant equivalent MODELS  model security model goal model consists entity trust authority patient fog node storage service provider trust authority initializes registration service generates public secret entity patient health data rate pressure healthcare device manually input patient encrypt data ciphertext fog node fog node health gateway router physical proximity patient fog node healthcare background powerful computation capability pre encrypts ciphertext transmits ciphertext storage storage remote server powerful storage capability manages ciphertext transmit fog node service provider researcher insurance drug manufacturer service provider attribute access ciphertext health data healthcare service security model trust authority fully trust entity transmission channel patient fog node storage secure patient trust aim prevent unauthorized entity obtain plaintext fog node storage honest curious fog node data pre processing service performs data storage curious plaintext categorize acm transaction intelligent technology vol article publication date october security threat unauthorized data access collusion attack unauthorized data access unauthorized service provider obtain health data advertisement drug promotion collusion attack fog node storage unauthorized service provider cannot plaintext separately collude intend plaintext goal article PFHDS achieve security goal performance goal security goal data confidentiality PFHDS aim preserve data confidentiality patient dataflows patient fog node storage service provider data confidential unauthorized entity patient centric access PFHDS aim enable patient centric access effective medical service provision meanwhile PFHDS aim enable data retrieve decrypt patient although encrypt fog node storage collusion attack resistance PFHDS aim resist collusion unauthorized entity obtain plaintext fog node storage service provider without attribute cooperate cannot obtain data performance goal effective medical service provision PFHDS aim enable data access service provider specific medical knowledge analyze patient obtain effective medical service data data classification PFHDS aim classify data heterogenous device category disease risk data utilized service provider efficiently medical  adequately efficient encryption PFHDS aim reduce encryption burden computation storage consumption patient resource limited ehealthcare device fog  health data  scheme scheme overview efficiently data healthcare effective medical service provision efficient data analysis privacy preservation PFHDS scheme illustrates overview propose scheme data healthcare device wearable device bio sensor patient manual input patient encrypts data transmits ciphertext fog node fog node pre health data classifies health data category disease risk analysis naive bayes classification index health item disease risk fog node encrypts data access policy accord disease risk transmits ciphertext storage finally service provider authorize attribute access ciphertext decrypts PFHDS consists algorithm setup keygen encrypt pre encrypt decrypt acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme scheme overview PFHDS setup PK msk trust authority input universal attribute security parameter output public PK msk keygen PK msk   SK  skf trust authority input public PK msk attribute service provider geographical location information  service provider  fog node output secret SK service provider public  secret skf fog node encrypt CT patient encrypts data symmetric encryption content meanwhile patient defines personal access policy accord encrypt content attribute encryption output ciphertext CT pre CT sid fog node input ciphertext computes probability disease risk accord data output disease risk correspond health item sid encrypt CT CT fog node defines access policy professional access policy accord disease risk encrypts data access policy meanwhile fog node encrypts index related health item attribute disease risk fog node output ciphertext CT transmits storage DecryptNode CT PK SK service provider attribute satisfy access policy define fog node patient public PK secret SK decrypt ciphertext CT plaintext acm transaction intelligent technology vol article publication date october scheme detail subsection construct phase PFHDS algorithm phase initiation initiation phase algorithm setup keygen phase trust authority generates fog node service provider trust authority input  chooses multiplicative GT prime bilinear GT generator random associate universal attribute attribute provider secret trust authority associate universal attribute public addition trust authority chooses random exponent trust authority output public PK msk PK msk trust authority keygen algorithm generate secret service provider service provider sends attribute private attribute professional attribute trust authority trust authority msk input selects random computes secret SK public correspond attribute service provider SK   trust authority generates public secret fog node geographical location information  fog node trust authority output public  randomly chooses secret skf fog node geographical location information  patient trust authority sends public  fog node patient  skf phase data encryption personal access policy patient encrypt algorithm consists operation enc enc patient encrypts data content enc patient defines personal access policy accord integrates attribute encryption encrypt content data enc data valuable data patient detects abnormal health data patient standard health item  data standard abnormal health item generate ID ID idm patient encrypts health data perform symmetric encryption DES aes enc content computes ciphertext CM enc encrypt data profile specific data grain data encrypt enc PK public PK content develop access input patient selects random secret encryption patient computes Cˆ equation Cˆ acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme access construction integrate personal access policy professional access policy access patient construct develop access node access policy node node personal access policy atree professional access policy btree respectively atree specifically construct patient access construct node polynomial node node xth node  node xth construct structure polynomial  node access node corresponds secret non leaf node corresponds threshold leaf node corresponds attribute hide secret leaf node access corresponds secret shamir secret node node accord shamir secret access hide node node patient chooses polynomial define completely non node  index index return unique associate node node traversal node secret node specifically secret distribute hidden leaf node access description secret atree secret btree  leaf node atree patient computes CA node  equation CA  securely construct btree fog node patient selects random encrypts public fog node public equation   finally patient sends encrypt data CM Cˆ CA fog node phase data pre  fog node pre algorithm ciphertext transmit patient input output pre processing disease risk correspond health item index sid acm transaction intelligent technology vol article publication date october disease risk related health item index disease risk analyze related ID ID idm health item related ID idm health item related ID ID idm health item health data standard health probability disease health item systolic pressure diastolic pressure rate  classification model computes relation disease risk health item accord reference pji idi probability abnormal health item idi happens disease fog node computes probability disease risk naive bayes classification equation sort probability obtain health disease risk index related health item disease risk pre processing health data fog node detailed algorithm health item index  correspond disease risk ID idm idi pji phase encryption pro  access policy enable effective medical service provision patient accord disease risk fog node encrypt algorithm encrypt health data professional access policy meanwhile efficient data analysis fog node encrypts related health item index disease risk disease risk analyze fog node storage correspond attribute related disease risk fog feature constant eliminate acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme algorithm pre processing algorithm input CH output sid sid sid sid  correspond  health item index related null sid null compute probability disease risk happens accord equation sort accord probability correspond disease risk probability  related disease risk health item   output sid node professional attribute professional access policy otherwise fog node storage disease storage return attribute effective health service specific disease risk fog node professional attribute compute disease risk diabetes disease professional diabetes related service   fog node professional attribute diabetes hospital hospital access policy diabetes disease risk fog node construct btree complement access develop access btree node node node disease risk analyze pre processing attribute correspond healthcare service leaf node btree professional attribute threshold node service provider attribute disease risk satisfy btree developed access secret node seal btree fog node decrypts ciphertext   obtain secret decryption computation   node btree fog node chooses polynomial define completely node btree fog node  index traversal btree node secret node acm transaction intelligent technology vol article publication date october node node node denotes disease risk ith node ith disease risk node dri specifically node DR drk  equation  index dri efficiently related health item category service provider fog node encrypts index health item fog node computes Cˆ  equation     leaf node btree fog node computes CB node  equation CB  secret node seal CB btree simplicity   structure  meanwhile  structure secret encryption content seal encryption fog node computes ciphertext CT CM Cˆ Cˆ sends CT storage phase data access phase service provider  algorithm access ciphertext service provider decrypt ciphertext attribute satisfy personal professional access policy meanwhile service provider attribute satisfy access policy disease risk decrypt Cˆ obtain correspond related health item index  service provider posse attribute corresponds leaf node access service provider decrypt leaf node secret non leaf node access sufficient threshold node node decrypt node decrypt accord retrieval shamir secret service provider attribute public PK secret SK decrypt CT DecryptNode CT SK PK operation decryption node decrypt ciphertext seal access service provider DecryptNode CT SK PK manner decrypt node access leaf node attribute att node DecryptNode CT SK PK null otherwise operation DecryptNode CT SK PK perform equation DecryptNode CT SK PK    acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme non leaf node service provider DecryptNode CT SK PK recursively node DecryptNode CT SK PK output  arbitrary node node threshold node decryption manner  node compute compute dec node index index accord polynomial structure  equation compute lagrange interpolation equation dec node compute equation    dec    operation service provider attribute satisfy personal access policy atree service provider compute  equation   specifically service provider attribute satisfy access policy disease risk service provider compute  equation related health item index  decrypt equation    Cˆ       service provider attribute satisfy professional access policy btree service provider compute  equation   index node index node accord lagrange interpolation compute encryption acm transaction intelligent technology vol article publication date october secret equation access decryption node decryption node node service provider attribute satisfy personal access policy atree professional access policy btree service provider compute  equation content decrypt secret equation    dec dec    finally ciphertext CM decrypt symmetric reveal health plaintext specifically patient selects secret randomly retrieve data public directly equation Cˆ decryption service provider attribute satisfy access policy define patient fog node obtain plaintext specifically service provider attribute satisfy access policy disease risk obtain related health item healthcare analysis service efficiently security DISCUSSIONS discus security PFHDS specifically demonstrate PFHDS achieve data confidentiality patient centric access collusion attack resistance data confidentiality data encrypt content symmetric encryption meanwhile patient encrypts content personal access policy secure data fog node storage unauthorized service provider cannot decrypt ciphertext without decryption sufficient attribute PFHDS data confidential honest curious fog node storage furthermore encrypt data transmit secure channel patient storage fog node PFHDS resists data tamper unauthorized entity acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme patient centric access discus patient centric access health data aspect patient data access health  provider accord personal customization content data encrypt access access atree personal access policy construct patient accord service provider attribute satisfy atree probability satisfy access obtain content patient data access service provider satisfies specific requirement patient retrieve decrypt data data encryption fog node PFHDS secret content randomly patient patient directly public decrypt Cˆ obtain content accord equation although data encrypt fog node patient retrieve health data flexibly collusion attack resistance PFHDS resist collusion obtain plaintext collusion fog node storage data confidential fog node storage separately fog node ability decrypt secret btree cannot secret without attribute satisfy personal access policy construct atree storage learns ciphertext CT fog node storage collude cannot plaintext collusion fog node service provider service provider attribute satisfy personal access policy atree cannot compute  accord equation access combination atree btree service provider compute   decrypt  accord equation significant compute content accord equation fog node ability decrypt secret btree service provider cannot compute  absolutely demonstrate collusion fog node service provider cannot plaintext service provider attribute satisfy personal access policy atree compute  accord equation fog node decrypt secret btree accord equation private however random chosen exponent random chosen  specific service provider authority service provider fog node service provider cannot compute secret atree  compute accord equation compute content accord equation meanwhile fog node cannot compute   compute  accord equation compute content accord equation collusion fog node service provider cannot obtain data plaintext collusion service provider collusion collude service provider collude service provider simplicity attribute service provider attribute service provider random secret ofu ist keygen algorithm trust authority random secret acm transaction intelligent technology vol article publication date october ofu ist keygen algorithm trust authority analyze collusion union satisfy access policy obvious collusion cannot decrypt ciphertext data plaintext union satisfies access policy neither satisfies access policy node attribute attribute compute dec node correspond attribute similarly node correspond attribute simplicity illustration node node respectively decryption node deci  decryption node   index node index node accord equation decryption dec node compute dec     accord lagrange interpolation compute generally randomly generate trust authority collude service provider analyze dec  dec  collude service provider cannot compute accord equation   performance evaluation evaluate performance PFHDS computation storage compute   curve version relic library various healthcare device equip patient evaluate PFHDS typical healthcare platform mobile phone sensor respectively mobile phone cortex cpu GB ram sensor mhz cortex KB flash KB ram fog node intel core cpu ram GB millisecond average iteration respectively denote exponentiation respectively multiplication bilinear operation dominate ignore minor factor arithmetic  denotes denotes universal attribute denotes par attribute access policy decrypt data attribute personal access policy attribute professional access policy percentage personal access attribute access attribute denotes health data category fog node attribute performance evaluation electronic health database reference professional personal information healthcare service provider patient hospital department gender attribute representative healthcare attribute mapped public expensive computation evaluation performance encryption related specific attribute attribute involve instance data encryption exceed evaluate performance attribute analyze acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme comparison CP abe PFHDS CP abe PFHDS encryption patient ET MT ET MT encryption fog node ket MT encryption ET MT ET MT storage patient  LG  LG storage fog node  LG theoretical PFHDS CP abe encryption storage demonstrate performance computation storage consumption computation computation mobile phone sensor CP abe PFHDS respectively attribute percentage fog node integrate CP abe encryption fog node CP abe encryption PFHDS increase attribute professional access policy btree category data classify category fog node encryption fog node attribute access policy encryption fog node encryption mobile phone sensor increase  attribute percentage decrease encryption consume encrypt health data PFHDS decrease successively meanwhile encryption PFHDS approximately encryption CP abe attribute specifically demonstrate encryption sensor consume mobile phone data encryption sensor CP abe approach attribute define access policy PFHDS consumes attribute improves significantly reduce latency encryption fog node increase attribute increase decrease appropriately encryption offload patient fog node demonstrate encryption fog node increase category disease risk disease risk category classify fog node fog node computational resource reasonable acceptable efficient data utilization obtain healthcare service provider storage evaluate storage patient fog node respectively illustrate relation attribute storage CP abe PFHDS acm transaction intelligent technology vol article publication date october encryption CP abe PFHDS ciphertext storage CP abe PFHDS patient storage fog node ciphertext storage CP abe due disengagement fog node illustrate relation attribute storage CP abe PFHDS illustrate relation category disease risk storage acm transaction intelligent technology vol article publication date october efficient privacy preserve fog assist health data scheme consumption CP abe PFHDS storage patient increase attribute encryption PFHDS approximately encryption CP abe attribute meanwhile attribute percentage decrease storage encrypt health data consume PFHDS decrease successively demonstrate storage fog node storage CP abe increase attribute fog node storage disease risk category classify PFHDS storage CP abe stable category disease risk increase storage fog node  storage CP abe classify ciphertext extra storage resource reasonable acceptable efficient data utilization obtain healthcare service provider health data classification consumption consumption concern encryption patient equip resource limited healthcare device evaluate consumption employ  monitor consumption PFHDS built battery voltage sensor knowledge battery discharge behavior various encryption application attribute evaluate mobile phone cortex cpu GB ram consumption data  illustrate relation attribute coordinate consumption coordinate CP abe PFHDS mobile phone demonstrate  PFHDS approximately consumption CP abe attribute meanwhile attribute percentage decrease consumption consume PFHDS decrease successively encryption offload patient fog node conclusion article propose PFHDS achieve effective medical service provision efficient data utilization efficient resource consumption PFHDS efficient health service provision patient due professional access policy fog node PFHDS enhances data analysis efficiency service provider classify health data category index related health item PFHDS preserve health data privacy access patient health data collusion fog acm transaction intelligent technology vol article publication date october node entity finally PFHDS reduces resource consumption patient encryption computation ciphertext storage consumption future emergency data efficient access policy update revocation