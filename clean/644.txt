development blockchain digital currency security digital wallet becomes important lightweight wallet hyperledger fabric propose trustzone secure lightweight wallet hyperledger fabric hereafter refer TSLWHF firstly unspent transaction output utxo transaction blockchain signature verification mechanism transaction implement lightweight wallet hyperledger fabric implement reliable protection mechanism private wallet address user information steal replace meanwhile transaction verification guaranteed tamper hacker verify transaction trust execution environment tee encrypt local header finally demonstrate utility deployed hyperledger fabric trustzone wallet reduces locally data security user asset spent TSLWHF execute transaction improves transaction performance bitcoin wallet previous keywords hyperledger fabric trustzone payment verification lightweight wallet introduction birth bitcoin blockchain blockchain widely utilized cyber security combine iot novel blockchain application blockchain handle unnecessary authentication handover heterogeneous 5G network decentralize authentication distribute hospital network vehicle network smart nowadays bitcoin improve alternative currency propose initial bitcoin achieve goal zerocash anonymous service user litecoin hash algorithm proof handle transaction concurrency faster processing bitcoin ethereum extends transaction semantics bitcoin enable advanced transaction smart contract however public chain cannot widely apply business scenario due performance lack regulation contrast permissioned blockchain meanwhile electronic payment becomes popular permissioned blockchain equip wallet significant role diverse smart permissioned chain performance public chain vital numerous device smart moreover wallet robustness device smart safer currently wallet online wallet hardware wallet online wallet private locally operation perform locally client user transaction signature compromise hacker hardware wallet secure environment management transaction signing illustrate user sends transaction request wallet api creates correspond transaction sends hardware private hardware transaction return wallet api correspond public transaction broadcast network sensitive information security environment hardware wallet actually online wallet security issue harmful user asset hardware wallet additional equipment around extension processor architecture trustzone allows trust untrusted environment trustzone software wallet achieve security hardware wallet due information chain mobile device cannot information chain participate bitcoin nakamoto propose payment verification SPV mechanism enables development blockchain lightweight wallet prefer lightweight wallet manage asset due convenience however exist SPV wallet cryptographically protects private target address transaction tamper replace attacker asset transaction directly attacker wallet meanwhile header local database tamper attacker tamper cannot guarantee verification summary important secure lightweight wallet alliance chain performance public chain user private wallet address information transaction payment verification secure lightweight wallet hyperledger fabric implement cryptocurrency improves transaction performance trustzone implement protection mechanism user public private wallet address local smart contract execution header information transaction verification contribution hyperledger fabric implement digital currency utxo model payment verification SPV mechanism without affect function blockchain secure trustzone lightweight wallet hyperledger fabric protects generate private public address protects header information synchronization transaction payment verification local header information hyperledger fabric tee implement analyze related security issue overall overhead ordinary wallet brings overhead related wallet performance improve transaction efficiency digital wallet  trust execution environment decentralize tee network blockchain reduces transaction chain improves transaction throughput another smart contract blockchain leverage proof stake POS consensus lite mobile wallet proposal simplifies header implement wallet performance due performance advantage POS pow transaction  chain TSLWHF hyperledger fabric improves performance access mechanism performance consensus algorithm wallet security response attack extensive strengthen security wallet hardware wallet wallet encrypt hash function wallet trustzone wallet social network manage private besides wallet focus verify workflow portability TSLWHF trustzone core mobile device another proposal trustzone isolate trust execution environment normal execution environment implement flexible reliable bitcoin wallet effectively defend attack channel attack enhance security trustzone research trustzone practical security becomes trend enhancement security trustzone secret secure channel trust execution environment normal execution environment enhance access resource tee trustzone implementation trust runtime TLR mobile application protects net mobile application confidentiality integrity operating security vulnerability TLR allows application security sensitive logic application isolated operating component trustzone kernel protection TZ  protection trustzone trust execution environment protection kernel effectively attack modify inject kernel binary aim node wallet safer portable wallet satisfied ordinary wallet payment verification public chain wallet performance unsatisfactory although wallet user private cannot header information transaction payment verification background hyperledger fabric fabric permissioned blockchain executes distribute application purpose program cryptocurrency built important difference fabric blockchain platform consensus protocol pluggable enable platform respond effectively situation distribute application fabric consists smart contract code implement application logic execution phase smart contract standard program access ledger usually within container environment isolation endorsement policy evaluate validation phase untrusted application developer cannot modify endorsement policy endorsement policy performs static library transaction validation fabric merely parameterized chaincode merkle merkle commonly refer hash hash merkle leaf node hash data collection file non leaf node hash correspond node concatenate file network firstly obtain merkle trust source obtain merkle source identify accepted merkle trust merkle obtain corrupt fake another source merkle trust source application merkle digital signature originally merkle handle lamport signature efficiently lamport message combine merkle multiple message become efficient digital signature framework merkle signature scheme PP network PP network merkle ensure data accepted node corrupt replace node publish fake trust compute trust compute introduces trust platform tpm hardware layer compute platform actually hardware trust rot compute platform tpm trust chain delivery mechanism perform layer layer integrity verification local platform hardware software trust verification platform configuration register pcr tpm simplify payment verification SPV payment verification blockchain verification payment node bitcoin network pack verifies transaction transaction confirmation ensure completion transaction payment verification transaction chain transaction verify SPV belongs blockchain payment verification transaction verification judge transaction verify node blockchain determines confirm payment verification storage ordinary mobile device ability header information network locally utxo exist blockchain transaction mode popular namely utxo model account balance model account balance model transaction occurs user balance transaction balance transaction normally utxo model transaction structure input output trustzone introduce trustzone architecture armv secure operating environment mobile device trustzone central processor normal tee normal ree execution environment application isolated implement tee application trust application TA enhance trustzone security isolation armv armv architecture wallet implement armv brief introduction trustzone armv armv cpu privilege runtime namely usr   sys ABT SVC  mon hyp armv architecture extends mon mode hyp mode mode determines source request target transmission correspond scr register monitor mode associate register modify threat model assumption ensure implementation TSLWHF wallet assumption trustzone ensures program safely execute already improvement significantly enhance security trustzone hyperledger fabric ensures information obtain node trust attack network layer threat model contains something malicious OS environment application execution environment ree security environment guarantee TSLWHF attack hacker steal private user memory intercept data generates private replace code generates private hacker replace tamper code generates wallet address user fund hacker wallet hacker modify local header information related smart contract execution interfere transaction verification implementation overview introduces technology TSLWHF trustzone wallet hyperledger fabric architecture blockchain server implement cryptographic currency utxo model unspent transaction output utxo transaction transaction verification mechanism wallet client architecture diagram wallet client wallet ability user access digital currency manage user wallet address user balance transaction verify transaction module secure address module secure synchronization module secure verification module utxo user unspent transaction output utxo model transaction data compress transaction hash obtain verification correspond transaction node fetch hash transaction verify utxo decrease utxo generate inevitably influence performance execute verify transaction simply action utxo user token transaction chain transaction generate account establish update data consolidation strategy firstly detect user utxo user generate transaction combine utxo user specific cryptographic currency hyperledger fabric receipt transaction endorsement node chaincode implementation function local transaction simulator transaction database consensus verify local locally file location information associate another database retrieve transaction information blockchain storage module implement chaincode layer user information local storage hash user information chain verification subsequent transaction local transaction merkle generate merkle timestamp version hash precede succeed header information transaction verification mechanism trading fabric carrier transaction verification transaction ordinary cryptographic currency firstly wallet creates transaction sends endorsement node secondly endorsement node receives transaction proposal client public verify signature wallet transaction chaincode verify validity transaction endorsement node generates signature return client finally client receives transaction response sends transaction signature node node sort information client creates broadcast node channel secure address module user function wallet user identity blockchain wallet address public private wallet digital wallet user private steal hacker generate wallet address hacker steal data tamper generate wallet address user digital asset hacker wallet situation loss user wallet wallet address threaten wallet client mnemonic library secure storage tee client generates random mnemonic mnemonic generation secure storage mnemonic password mnemonic calculation hmac sha random algorithm generate byte random secure storage intercept byte random private generate public accord private elliptic hyperbolic algorithm hash public twice obtain public hash version public hash obtain public hash version hash digit digit public hash version encode wallet address  application contains implementation  random generation algorithm propose bip specification secpk algorithm sha algorithm  cryptographic algorithm tee sha algorithm aes algorithm rsa algorithm cod algorithm mnemonic generation generation wallet address entire tee  generate auxiliary public private wallet address secure storage tee meanwhile temporary data generate execution  application operates secure storage file implement TA  interface tee correspond implement CA client application   wallet remotely   trust application generate public private wallet address secure storage tee TA trust application trust application implement submodules private generator public generator wallet address generator user private generator receives request private generator mnemonic algorithm TA generate private private public generator public generator secpk algorithm sha algorithm generate public generator hash algorithm generate public hash public compile user private public wallet address generation program tee image file tee ensure completely isolated normal meanwhile private public wallet address involve secure storage secure subsequent private trust execution environment secure synchronization module wallet client blockchain information related user secure synchronization blockchain information wallet extremely critical wallet client relies heavily related information blockchain node client hacker modifies user related information locally wallet affect verification subsequent wallet transaction user transaction invalid loss user implement network synchronization module synchronization blockchain information synchronize information ensure attacker cannot intercept synchronization information data transmission reduce overhead operating secure storage synchronize information secure storage tee synchronize information normal storage normal environment encryption ensure attacker cannot tamper locally information interferes transaction verification outline detail wallet receives synchronization command switch tee decrypt header non secure storage obtain height local header local merkel wallet client secure environment obtains information header preset node correspond smart contract local merkel local merkel merkle locally information blockchain information synchronization encrypt header information obtain tee switch ree data non secure storage delete temporary data switch implement digital currency fabric bifurcation therefore synchronize blockchain information ensure information chain date basis synchronization module implement socket related operation tee implement  tee correspond CA interface module image KB image synchronize blockchain information  application socket file tee reading define data structure CA context file descriptor application client initiate network connection request client parameter  address data buffer data address sock handle sock handle trust application  cast data obtain socket correspond information secure verification module user advantage wallet user participate blockchain transaction network without maintain node user initiate transaction wallet client wallet transaction valid wallet information user transaction already chain issue user transaction verify implement wallet alliance chain smart contract smart contract execution fail transaction chain hacker exploit vulnerability compromise user asset therefore blockchain digital currency smart contract verify execution smart contract verify transaction transaction payment verification simplify wallet sends relevant information address public transaction hash transaction node fabric blockchain node transaction verification transaction merkle standard merkel wallet calculates correspond merkel accord transaction verification tee decrypt local header information secure environment obtain standard merkel calculate merkel indicates transaction already chain otherwise transaction exist chain security analysis performs security analysis TSLWHF wallet client objective ensure security private security wallet address security network synchronization transaction payment verification security private wallet client chain verification signature startup startup signature image verify image load image load bootloader image file tee image file linux kernel image file recover image file therefore mobile device module wallet client user public generation module network synchronization module transaction payment verification module load normal operating transaction private tee malicious operation normal execution environment cannot affect related private execute related private related structure release temporary data private TSLWHF security address generate address bound generate private therefore attacker tamper generate wallet address intercept data wallet initiate transaction wallet address hacker deceive user replace wallet address transaction user loss implement wallet client tee sends transaction blockchain server assign wallet address transaction tee hacker attack wallet address intercept socket package situation belongs network layer attack scope security network synchronization transaction payment verification hacker steal user asset tamper locally header information destroy transaction payment verification action execution transaction wallet client ensure locally header information transaction hash information associate user authentic verification transaction paid tee information synchronize blockchain remote node secure storage overhead entire wallet therefore synchronizes encrypts information tee information non secure storage evaluation firstly analyze storage overhead module TSLWHF wallet client user public private byte byte wallet address byte secure storage OP tee trust execution environment bitcoin chain storage consume GB TSLWHF payment verification mechanism mechanism allows wallet locally header information blockchain verify transaction paid header byte grows bitcoin storage MB ordinary mobile device storage feasible deploy wallet user mobile phone secondly analyze increase overhead exist client demonstrate efficiency TSLWHF linux workstation ghz intel core cpu GB memory built node hyperledger fabric network docker version hyperledger fabric version docker version OP tee client tee related operation generate overhead secure address module involve encryption operation operation generate information secure storage generate overhead secure synchronization module establishes secure connection tee creates overhead transaction payment verification module ensures wallet obtains transaction hash remote node merkle calculation execute tee contribute overhead increase overhead mainly trust application implement performance trust application    finally trading performance information wallet synchronizes KB input data  examine operation perform series data packet efficiency TSLWHF operation storage ideal simulator stable storage reading operation equipment efficiency reading local file normal environment operation MB operation MB reading secure storage overhead relatively information user secure storage byte data image KB image trend overhead secure encryption algorithm average reading secure storage transmit data byte  due overhead encryption operation input data growth overhead cannot displayed input data overhead execute encryption algorithm tee normal execution environment trend increase overhead linear amount data increase increase overhead millisecond  minimize impact network latency transmission delay directly establish socket connection locally overhead transmit data file transmit mostly transmit header amount data input MB header byte focus assess secure transmission data useful hence data byte byte data span byte normal execution environment overhead establish secure tcp connection tee increase header byte overhead millisecond image KB image trend overhead due secure transmission transaction performance overhead introduce trust application TSLWHF overhead OP tee startup TSLWHF finally trading performance wallet directly construct transaction transaction ordinary wallet TSLWHF overhead  encryption operation OP tee negligible overhead  operation security storage overhead  establish secure transmission connection meanwhile overhead synchronization increase overhead secure storage within user acceptable finally TSLWHF execution transaction increase overhead normal wallet fabric nowadays min bitcoin wallet perform transaction transaction verification bitcoin TSLWHF improve transaction performance factor therefore aspect TSLWHF user performance overhead comparison regular  average transaction execution average transaction payment verification conclusion future trustzone secure lightweight wallet hyperledger fabric specifically hyperledger fabric implement digital currency payment verification smart contract wallet client implement reliable protection private public wallet address protection information synchronization protection transaction payment verification ordinary wallet hyperledger fabric TSLWHF creates secure tcp connection operates secure storage overhead meanwhile TSLWHF execute transaction increase overhead affect user transaction execution TSLWHF bitcoin however shortcoming transaction dump chaincode layer actually increase overhead modify source code hyperledger fabric directly convert transaction utxo model greatly improve transaction performance digital currency client implement emulator performance emulator stable client hardware environment raspberry