development assist electronic health effectively address drawback traditional medical management however challenge security privacy data storage cannot ignore ensure integrity electronic health EHRs data outsource guarantee privacy traceability EHRs data blockchain ehealth BCES propose ensure manipulation EHRs audit BCES legitimate query manipulation data consumer legitimate outsource manipulation hospital blockchain transaction permanent storage ensures traceability attribute proxy encryption adopt achieve grain access medical data behavior threatens integrity EHRs discover auditor due traceable tamper resistant characteristic blockchain entity illegal manipulation EHRs accountable evidence construct proof chain finally security analysis performance evaluation demonstrate scheme secure efficient previous keywords blockchain compute electronic health data outsource introduction apply compute internet technology medical diagnostic service already advantage improve quality service numerous exist scheme assist electronic health ehealth prominent manifestation traditional ehealth flexible efficient convenient platform processing electronic health EHRs medical institution doubt implementation assist electronic health greatly medical application specifically ehealth medical institution outsource patient EHRs server establish flexible access mechanism without incur significant storage maintenance although superiority assist  obvious emerge application inevitably security privacy issue medical institution hospital usually maintain primary stewardship ehealth therefore pre processing outsource EHRs usually hospital authorize patient patient access EHRs interaction hospital patient EHRs therefore improve quality medical service user monitor data important issue resolve stage research meanwhile service provider unwilling invest equipment privacy patient EHRs service agreement SLA simply commit data privacy failure server reality failure occurs integrity EHRs bound endanger therefore excessive trust cannot service provider strategy service provider EHRs becomes focus exist scheme assume server collude authorize hospital tamper patient EHRs however assumption conform situation commercial organization service provider tend compromise therefore without introduce fully trust regulator another concern assist electronic health domain flexible data EHRs dissemination EHRs breakthrough discovery technique therapy cure disease however service provider achieve satisfactory data mechanism data stage highly likely risk privacy leakage address attribute cryptosystem embed data scheme realize data individual satisfies attribute access source data however assist electronic health patient data owner usually visitor attribute arbitrarily access valuable EHRs authorize therefore challenge implement grain access ensure data transaction legal traceable blockchain decentralize distribute database creates completely trust environment unfamiliar individual without trust endorsement furthermore blockchain combine cryptography technology ensure transaction traceability  modification non repudiation data security collaborative compute privacy protection user identity data develop potential blockchain emerge technology apply blockchain compute blockchain combine multiple technology achieve scalability security efficiency due characteristic hash function data blockchain consensus mechanism modify forge data therefore blockchain technology powerful address assist electronic health attractive feature however blockchain medical simply focus storage data blockchain regard distribute database potential furthermore incomplete secure data amount data redundancy scheme unable apply verification scheme usually involve complex calculation patient compute struggle computational accuracy data forego overview progress challenge research blockchain ehealth BCES propose achieve integrity EHRs data confidential EHRs BCES inherits advantage traditional electronic medical overcomes defect mention exist blockchain scheme scheme abandon blockchain medical data index thereby ensure data integrity extent innovation information outsource query operation regard transaction transaction bill eventually blockchain permanent storage entity illegal manipulation responsible evidence blockchain specifically contribution aim drawback exist medical novel efficient blockchain ehealth BCES scheme characteristic blockchain fully utilized ensure user manipulation EHRs traceable transparent moreover structure proof chain retains reasonable channel accountability vulnerable patient flexible access strategy secure EHRs introduction attribute allows user customize authorization introduction proxy node allows patient successfully data authorization without compute benefit security characteristic blockchain scheme resist variety attack substitution attack migration attack collusion attack replay attack etc meanwhile performance evaluation conduct feasibility efficiency scheme organize review related preliminary described statement clarify goal specific construction scheme propose simulation discussion concludes related due explosive growth medical data traditional isolated medical data management scheme obvious flaw overcome shortcoming improve quality medical service interactive medical implement focus realize interaction medical institution attention security privacy threat EHRs medical data security privacy issue towards outsource EHRs gradually attract researcher concern  introduce detail drawback storage technology establish data medical propose blockchain medical data data security issue however article propose specific practical scheme challenge effective management protection medical blockchain ensure data storage security verify identity encryption however risk data leakage data  application reality cao  secure assist ehealth prevent outsource EHRs modification ethereum however symmetric encryption algorithm without difficulty medical data encounter computation complexity zheng propose medical data scheme combine blockchain compute machine scheme easily realize medical data various institution however cannot verify integrity medical data data consumer unable medical data similarly propose  blockchain distribute monitoring infrastructure distribute access  data security really effective data data security blockchain achieve effective access data exchange concern worth regard novel patient centric framework semi trust server mechanism data access EHRs abe attribute encryption technology encrypt EHR file patient however abe disadvantage user modifies access strategy additional computational overhead perform attribute revocation encrypt data disaster computationally disadvantage patient xia blockchain electronic medical scheme scheme tamper resistant characteristic blockchain access medical data however patient data owner cannot monitor EHRs patient actual benefit particularly yang propose architecture implement blockchain technology EHR compatible exist however health provider alone responsibility maintain blockchain verify append inevitably threaten efficiency entire analyze exist research scheme combination blockchain medical facilitate enhancement service quality however cannot ignore medical blockchain storage flaw grain access privacy protection data patient grasp detail data urgent unsatisfactory efficiency security become obstacle implementation scheme issue exactly concern propose BCES scheme proof chain user manipulation attribute proxy encryption component embed BCES realize secure data computationally friendly patient scheme gap mention research preliminary bilinear additive cycle multiplicative generator bilinear bilinearity  exists computability exists efficiently computable algorithm compute bilinear mapping important cryptographic cryptographic algorithm keygen verify mention content attribute proxy encryption attribute proxy encryption  combine characteristic attribute encryption abe proxy encryption pre effectively ensure data security implement grain access encrypt data compute environment  scheme tuple algorithm algorithm input parameter attribute generates public parameter secret algorithm input attribute generates secret associate algorithm input message access structure generates ciphertext algorithm input access generates encryption algorithm input encryption ciphertext attribute satisfies access structure specify generates encrypt ciphertext otherwise return false algorithm input secret encrypt ciphertext algorithm attribute satisfies access structure return false otherwise return blockchain blockchain chain data structure consist data hash function implement function data verification calculation storage consensus mechanism blockchain distribute trust ledger participant node user maintains exactly ledger ensures user node correspond blockchain completely consistent application scenario blockchain data typical blockchain structure attribute signature ABS blockchain network anonymity ABS scheme identity feature perfectly apply distribute network ABS scheme propose consists algorithm algorithm input parameter generates public secret algorithm input attribute generates secret verification associate algorithm input secret message access structure return signature verify algorithm input signature access structure attribute signature valid statement analysis exist assist ehealth typical model generally entity model hospital patient service provider csp research institution server trust authority server responsible distribute participate user csp data hospital EHRs platform research institution sends query request accord obtains query interact patient generate EHRs model hypothesis patient data owner lack sufficient computation communication storage resource medical data hospital authorize organization advanced equipment patient EHRs therefore patient participate manipulation medical data diagnose authorize hospital upload EHRs patient EHRs outsource patient loses EHRs manipulation medical data transparent patient typical scheme advantage cryptography defend external attack internal attack tamper EHRs obvious security flaw blockchain ehealth BCES specifically user BCES optimize basis traditional assist electronic health blockchain operational information data generation storage model consists entity patient hospital server research institution service provider csp auditor blockchain respective function described patient actual owner EHRs responsible medical data manage EHRs remotely hospital hospital delegate patient pre EHRs upload server server duty generate distribute entity research institution research institution typical data consumer query request server access structure service provider csp multi intermediary responsible transmit EHRs auditor auditor responsible audit data security manipulation security blockchain blockchain core model manipulation phase EHRs tamper resistant traceable characteristic blockchain data blockchain evidence illegal manipulation checked subsequent verification entity responsibility investigate accord evidence blockchain security model server auditor BCES fully trust service provider hospital semi trust trustworthy situation involve execute illegal manipulation meanwhile assume encryption algorithm EHRs sufficiently secure neither internal adversary external adversary crack ciphertext without obtain decryption modify encrypt EHRs however adversary illegal manipulation ciphertext delete ciphertext issue query request without restriction substitute ciphertext forge goal aforementioned security model aim blockchain ehealth accountability data owner patient detect entity illegally manipulate EHRs achieve accountability protection particularly ensure security data outsource execute hospital hospital trust diagnose judged security model however hospital forge EHRs later fault diagnose due semi trust characteristic ensure security data storage patient EHRs usually unused csp benefit migrate EHRs frequency server service quality service response undoubtedly seriously  integrity EHRs ensure security data prevent data abuse theft EHRs multiple unauthorized research institution valid authorization data owner EHRs research institution without authorization propose scheme BCES introduce construction workflow BCES detail roughly scheme data outsource data simplify description meaning notation description  participate user user blockchain account address generator cyclic ciphertext outsource transaction formal outsource transaction query transaction formal query transaction setup setup perform server fully trust authority server initialize keygen algorithm user finally release private user detailed description algorithm server initializes setup scheme generates public parameter secret server initializes keygen scheme generates private verification legitimate participate user sends user secure channel worth generation private verify user attribute requirement image KB image  strict admission mechanism implement application participant user globally identify server performs verification operation validity information verification application discard otherwise user user accord attribute information meanwhile blockchain account address user specific algorithm suppose applicant algorithm detects applicant attribute contains attribute patient blockchain account address applicant address information patient subsequent code functionality aim entity image KB image data outsource patient usually massive data storage management capability therefore patient tend authorize hospital outsource EHRs treatment patient generates authorization information denotes generation authorization information denotes access structure embed ciphertext denotes blockchain account address specific patient unique identifier EHR patient computes trust authorization information denotes private user patient attribute identity immediately patient transmits authorization information hospital secure channel submits blockchain data pool authorization information patient hospital extract access structure executes algorithm due consideration security patient EHRs EHRs logical information encryption algorithm generate ciphertext ciphertext logical information image KB image outsource transaction hospital generates outsource transaction bill image KB image transaction bill consists blockchain account information client transaction information indicates transaction data information contains information submit hospital manipulation worth bill transaction bill eventually lack critical information generation denotes generation outsource information calculation subsequently hospital submit outsource transaction blockchain data pool submit server EHRs submit hospital verifies EHRs legitimate user specific verification algorithm verifies attribute information conforms access structure generate signature information obtain verification allocates storage ciphertext immediately feedback submit blockchain data pool image KB image formal outsource transaction bill generate blockchain network outsource transaction bill bookkeeping node specific generation formal outsource transaction bill algorithm algorithm detects initiator receiver transaction determines transaction initiator hospital receiver transaction outsource transaction bookkeeping node integrates relevant information data pool formal outsource transaction bill formal outsource transaction broadcast blockchain network formal outsource transaction via PBFT consensus mechanism data medical data economically valuable access medical data approve data owner therefore scheme data transaction request research institution initiate data query request initiate query transaction bill client composition transaction bill basically difference data information worth bill transaction bill eventually lack critical information generation transaction bill query transaction bill submit data pool deliver client specify patient patient agrees query request extract applicant attribute information transaction request research institution encryption subsequently generate patient submit server secure channel generate evidence information query request specific submit blockchain data pool encryption information patient attribute patient access structure embed ciphertext ciphertext encrypt otherwise query request research institution image KB image query transaction finalize manipulation data transfer certificate generate subsequently submit  data pool formal query transaction bill generate blockchain network query transaction bill bookkeeping node specific generation formal query transaction bill algorithm algorithm detects initiator receiver transaction determines transaction initiator research institution receiver patient transaction query transaction bookkeeping node integrates relevant information data pool formal query transaction bill formal query transaction broadcast blockchain network formal outsource transaction via PBFT consensus mechanism image KB image series outsource query manipulation blockchain define proof chain security analysis analyze security BCES aspect substitution attack scheme effectively resist substitution attack security model assume hospital semi trust remain absolutely honest interaction patient diagnose substitute EHRs compensate fault diagnose assume semi trust substitute EHRs diagnostic error ciphertext data ciphertext substitute due weak collision hash function ciphertexts equation auditor calculates accord calculation obviously due weak collision hash function inference transaction inevitably merkle therefore situation due blockchain tamper resist mechanism migration attack scheme effectively resist migration attack security model semi trust occasion honest sometimes benefit migrate EHRs frequency server service quality service response assume server migrate ciphertext worn server auditor regularly audit actual server address correspond transaction content blockchain obviously situation due  tamper resist mechanism collusion attack scheme effectively resist migration attack collusion scheme collusion hospital service provider collusion research institution service provider regard situation hash location information EHRs blockchain malicious behavior deletion modification migration auditor detect correspond responsibility due blockchain tamper resist mechanism regard situation EHRs encrypt specific access policy data  attribute requirement cannot directly access EHRs suppose research institution directly obtain EHRs bypassing data owner attribute information private satisfy access policy embed ciphertext cannot decrypt ciphertext service provider encrypt ciphertext unauthorized entity behavior service provider cannot obtain plaintext encryption responsible encryption encrypt EHRs decrypt authorize entity replay attack scheme effectively resist replay attack transaction timestamp entity operation accompany digital signature transaction blockchain transparent user extract generation transaction malicious user attempt transaction blockchain transaction request transaction verification phase relevant verification node detect transaction discard transaction mechanism effectively prevents replay attack accountability scheme approach accountability due characteristic blockchain transaction bill blockchain actual contract transaction successfully blockchain entity consensus transaction entity illegal operation subsequent accountable performance evaluation conduct ubuntu intel core TM cpu ghz 4G memory cryptographic algorithm involve BCES cpabe library scheme prime bilinear worth parameter serf reference security requirement actual computation overhead operation ghz cpu GB ram environment decompose interaction user operation user interaction consists sub multiplication mention PRELIMINARIES operation etc accord relationship computation patient outsource relationship computation research institution operation  multiplication hash exponent operation hash computation overhead hospital service provider patient increase increase amount medical data assumes patient generates amount medical data computational overhead hospital CSPs linear increase however worth data patient calculation delay entity equip powerful computation device completely acceptable computation delay image KB image computation outsource query situation multiple research institution access EHR relevant conduct obtain data analyze computation patient increase linearly increase query request assumes research institution equivalent amount EHR access access specific EHRs compute delay server powerful compute performance relatively overhead patient weak compute calculation access request obviously feasible patient handle concurrent access request computation device mobile phone personal computer advantage BCES intuitive computation requirement entity involve scheme scheme comparison computation requirement scheme lack detailed performance evaluation achieve qualitatively approximate comparison scheme description EHRs outsource storage scheme patient client generate authorization information negotiate hospital treatment computation slightly patient client however consensus node computation verification authorization information signature verify EHRs undoubtedly computation BCES consensus node verify information participate voting comparison computation requirement client   node BCES scheme scheme scheme discus quantitative comparison computation outsource scheme scheme propose comparison respectively clearly data outsource hospital computation slightly BCES patient computation scheme interaction hospital patient negotiate treatment hospital therefore calculation overhead reduce patient obviously BCES achieves satisfactory patient perspective communication overhead communication overhead patient hospital interaction scheme propose outsource phase patient communication overhead consists delegate hospital submit crucial information data pool hospital communication overhead consists submit outsource transaction bill upload EHRs communication patient hospital scheme respectively patient communication overhead EHRs communication achieves performance patient perspective hospital BCES communication overhead increase increase amount data unavoidable upload EHRs communication patient hospital therefore reduce communication patient valuable reduce communication hospital consensus overhead overhead blockchain mainly consume consensus consumption entire consensus scheme consensus algorithm respectively simulation consensus node environment independently consensus algorithm PBFT algorithm scheme multiple average clearly transaction increase efficiency advantage consensus algorithm scheme becomes obvious PBFT algorithm avoids excessive demand pow compute solves weak centralization POS suitable application scenario mention image KB image consensus scheme conclusion assist electronic medical combine blockchain unresolved issue user inability actually medical data hidden safety hazard EHRs data unreasonable protection integrity EHRs gap novel blockchain ehealth BCES propose scheme proof chain various user manipulation  establish characteristic blockchain data manipulation trace cannot tamper proof chain future evidence protection attribute cryptosystem embed proxy encryption mechanism realize security EHRs ensure patient compute successfully EHRs transaction security analysis demonstrate BCES defend attack grain access tamper resist feature meanwhile performance evaluation conduct scheme efficient feasible future improve framework AI technology combine EHRs enhance accuracy disease diagnosis treatment without reveal data information