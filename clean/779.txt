proposes 5GReasoner framework formal verification protocol span across multiple layer 5G protocol stack underlie analysis 5GReasoner instance model respect adversarial environment due effective behavior specific abstraction manually extract 5G protocol 5GReasoner analysis generalizes prior analysis cellular protocol regard packet payload multi layer protocol interaction instantiate 5GReasoner model checker cryptographic protocol verifier lazily combine abstraction refinement principle analysis extract 5G protocol model layer protocol span across layer 5G protocol stack 5GReasoner identify weakness attack security privacy implication analysis discover previous weakness 5G inherits 4G exploit violate security privacy guarantee CCS CONCEPTS security privacy formal security model security protocol denial service attack mobile wireless security keywords cellular network 5G model vulnerability attack introduction imminent deployment fifth generation 5G cellular network enthusiasm academia particularly due promise enable application smart vehicle remote robotic surgery 5G envision replacement broadband internet impact military battlefield emergency management improve situational awareness potential novel critical application 5G attribute enhancement 4G lte improvement physical layer technology enable device substantially improve bandwidth robust security posture due introduction security upper layer 5G protocol stack 5G standard however array security challenge stem security policy formally verify adversarial assumption retain security mechanism 4G evolution lte predecessor aim develop highly automate approach enable formal verification protocol 5G protocol stack scope 5G consists critical procedure initial registration deregistration leveraged fundamental cellular service SMS data billing vulnerability initial registration procedure serious consequence service attack spurious mobile billing therefore address concrete research formally verify 5G NAS layer procedure initial registration deregistration configuration update handover service request procedure correspond rrc layer procedure span across layer relevant security privacy challenge achieve goal however address challenge specification 5G protocol lack formal specification hence prone ambiguity underspecification protocol complexity 5G comprises multiple sub protocol across multiple layer inter dependent stateful multiple protocol participant message data domain contribute complexity obtain requirement standard security privacy requirement abstract careful consideration complex assumption formulate formal implicit requirement particularly conformance suite prescribed session 3D formal analysis CCS november london united kingdom 3GPP standard encompass primitive security requirement lack completeness consideration adversarial environment finally 5G suite conformance requirement core network component exist effort 5G formal verification previous effort formally analyze 5G protocol analysis however focus protocol authentication agreement aka protocol initial registration procedure analysis perform isolation without interaction procedure approach relevant approach effort propose framework  adversarially 4G lte protocol  lazily combine symbolic model checker cryptographic protocol verifier abstract refinement principle instantiation  framework however suffers limitation layer protocol stack isolation  critical interaction protocol layer sake scalability model packet model critical data packet payload data payload dependent protocol behavior adversary instantiation cannot handle protocol span across layer stack coverage issue  instantiation attribute coarse grain abstraction protocol model 5GReasoner alternative instantiation  framework protocol model discipline 5G protocol model 5G procedure initial registration deregistration configuration update handover service request bearer establishment procedure protocol layer network access stratum NAS resource rrc contributes machine NAS layer rrc layer machine entity communicate private channel rrc layer machine reside entity cellular device however communicate public adversary channel adversary model machine adversary machine sits communicate rrc layer machine mimic dolev yao adversary non deterministically modify inject message payload respect formedness adversary machine perturb message payload avoid parse error 5G protocol model transition 5G protocol model NAS layer protocol packet payload rrc layer protocol packet essential model packet payload directly capture packet payload model however impedes scalability analysis address model capture packet payload impact security privacy specific behavior NAS rrc layer protocol mention address explosion model due payload behavior specific predicate abstraction approach directly model data model predicate data sufficient protocol behavior addition packet payload data wrap link counter model faithfully counter protocol packet perform formedness model timer  framework instantiate 5GReasoner infinite model checker  cryptographic protocol verifier proverif model checker model checker effective temporal safety liveness gathering conformance suite standard augment implicit standard evaluation verify 5G protocol model counterexample model checker verify confirm feasibility proverif reporting weakness finding significant finding expose device TMSI occasion attack enables adversary victim device location hijack channel TMSI enables attack another significant instal null cipher null integrity attack UE limited service mode expose SUPI critical security requirement contribution summary technical contribution propose 5GReasoner framework formal verification 5G protocol construct formal model 5G protocol 5G NAS layer procedure rrc layer procedure model contains sufficient information temporal refer packet payload data timer behavior 5G protocol model independent 5G enable device evaluation 5G protocol model 5GReasoner reveal exploitable protocol weakness discover prior attack 5G inherits 4G lte finding severe security privacy implication downgrade SUPI background discus 5G NR discus 5G network architecture component relevant 5G procedure 5G architecture 5G architecture partition component user equipment UE 5G access network 5G 5G core network 5G CN UE user equipment device smartphone equip USIM universal subscriber identity module USIM uniquely identify SUPI subscription permanent identifier similarly previous generation 3G 4G  identify IMSI international mobile subscriber identity significant difference 4G 5G  5G  capable generate random nonce session 3D formal analysis CCS november london united kingdom simplify 5G architecture 5G 5G geographical partition hexagonal service gnb 5G difference 4G 5G latter geographical extremely coverage latency  network UE gnb communicate gNBs 5G CN 5G core network 5G CN mesh interconnect service access mobility management function amf manages registration detach procedure service related registration connection mobility authentication agreement registration procedure  authentication server function UE identity subscription data  unified data management responsible generate authentication agreement aka credential node 5G CN relevant discussion NAS layer procedure briefly discus NAS layer procedure relevant context initial registration reboot UE performs setup procedure assign RNTI network temporary identifier setup UE establishes communication rrc layer rrc setup procedure rrc setup UE NAS registration procedure reg request message reg request message SUCI subscription conceal identifier encryption identifier SUPI random nonce amf completes authentication procedure  successful authentication amf initiate negotiation cipher integrity algorithm security mode procedure NAS security context establish UE amf encryption integrity protection algorithm apply subsequent NAS message amf concludes registration procedure reg accept message UE TMSI UE responds reg message deregistration disconnect network UE initiate procedure  request message network respond  accept message configuration update due update successful service request procedure invoked response request network initiate configuration update procedure update UE configuration assign TMSI initiate procedure amf sends config update command message UE acknowledges config update message important UE procedure service request UE invokes procedure receives request network UE pending uplink data idle mode UE initiate procedure service request message amf network responds service accept completion procedure rrc layer procedure discus relevant rrc procedure sake easy exposition finding rrc setup rrc setup procedure backdrop NAS registration purpose procedure establish rrc connection transfer initial NAS dedicate information message UE network rrc security activation purpose procedure activate security upon rrc connection establishment rrc release procedure network release establish bearer resource suspend rrc connection suspension establish bearer suspends bearer assigns RNTI inactive network temporary identifier UE rrc connection reconfiguration purpose procedure modify rrc connection establish modify release bearer RBS procedure NAS dedicate information transfer network UE rrc procedure UE completes initial registration procedure network sends rrc reconfiguration message UE rrc reconfiguration acknowledge reconfiguration rrc connection resume significant difference rrc layer 4G lte 5G NR apart rrc rrc idle 5G NR introduce rrc rrc inactive UE disconnect idle session 3D formal analysis CCS november london united kingdom rrc initial rrc setup connection establishment activity UE suspend session rrc inactive motivation reduce access optimize mobility UE transition rrc inactive rrc procedure rrc resume setup UE initiate procedure respond NG UE rrc inactive request resume suspend rrc connection procedure rrc setup rrc resume request rrc resume rrc resume rrc connection establishment UE rrc idle procedure transition rrc idle rrc however UE rrc security activate initiate procedure rrc connection connection establishment succeed network verify valid UE context procedure whenever register UE data idle mode wake periodically accord define occasion massage earlier 5G extra rrc idle active inactive initiate rrc inactive mode initiate 5G RNTI inactive network temporary identifier unique identifier UE trigger gnb UE successfully attempt resume rrc inactive rrc rrc connection resume procedure CN initiate rrc idle mode initiate 5G CN TMSI unique identifier UE trigger CN rrc setup procedure invoked UE idle overview  architecture 5GReasoner component verification workflow 5GReasoner delve detail threat model threat model analysis communication channel private adversarial influence channel NAS rrc layer UE channel core network communication channel UE UE core network adversarial influence dolev yao style network adversary impersonate legitimate protocol participant inject modify packet adhere cryptographic assumption decrypt encrypt message posse decryption cryptographic construct perfectly secure core network component target user UE USIM trust compute adversarial influence adversary however posse  network operator adversary compromise secret symmetric session USIM along network operator public approach approach approach counterexample abstraction refinement principle CEGAR subtle difference difference brief introduction CEGAR CEGAR framework verification input concrete model program verify aim satisfies verification abstract concrete model obtain abstract model verify verification satisfies due abstraction execution subset entail satisfies verification however counterexample generate possibility violates violates due abstraction actually violate realizable execution counterexample return evidence verification failure however realizable modify obtain possibly generalization cycle verification realizable counterexample program statement interested verify machine integer resp addition resp multiplication suppose operation precise manner automate reasoner satisfiability modulo theory smt solver analysis amenable automate reasoner smt solver assume abstract  binary function int int int int int int respectively roughly  function function signature semantics  function satisfy congruence smt solver  function apply  abstraction abstract becomes  furthermore abstract counterpart program becomes session 3D formal analysis CCS november london united kingdom 5GReasoner architecture expand abstract program expression warrant  discharge verification obligation potential CEGAR approach multiplication addition machine integer sake argument suppose verify abstract  function commutative hence verification fail program entail suppose refinement model replace occurrence actual multiplication function verification pas commutative addition advantage CEGAR approach 5GReasoner context verification abstraction achieve replace cryptographically message plaintext counterpart 5G protocol model fix infeasible counterexample due abstraction cryptographically message refine instead model refine signifies logical entailment formula infeasible counterexample focus verification considers trace satisfy concretely 5G protocol model replace encrypt integrity message plaintext counterpart model enhance model dolev yao style adversary purpose model checker MCheck cryptography abstract model satisfies  satisfied model however counterexample generate possibility 5G model violates due abstraction cryptographic construct spurious counterexample generate consult symbolic cryptographic protocol verifier   confirms conform cryptographic assumption counterexample alternatively attack report 5GReasoner  however  adversary infeasible refine ensure adversary offend action future iteration verification verification loop satisfied model realizable counterexample component framework component 5GReasoner protocol model model protocol abstractly communicate machine SM machine communicate another machine unidirectional private public channel message towards another machine tuple init finite input variable finite output variable finite variable init initial finite assignment variable assignment define variable update define transition relation adversarial model  adversarial model  input protocol model return another model  extension explicit adversarial influence public channel  introduces machine capture behavior adversary replaces channel channel data machine whereas channel data mimic dolev yao style adversary input message non deterministically decides message operation message message payload non deterministic behavior adversary arbitrary strategy attack protocol model checker MCheck MCheck input adversary protocol model temporal trace safety liveness execution model violates violation output model satisfies violate execution model counterexample evidence due abstraction counterexample spurious hence validate cryptographic protocol verifier cryptographic protocol verifier  adversary action MCheck counterexample query  feasibility adversarial action session 3D formal analysis CCS november london united kingdom simplify 5G model NAS layer proven feasible counterexample feasible attack otherwise manually generate invariant ruling infeasible adversarial action refine reader approach exposition rely overly simplify model 5G NAS ecosystem model  UE amf SMs communicate unidirectional  public channel UE amf amf UE transition label action logical formula specify transition trigger whereas action component refers action sequence perform appearance SM transition empty action component denote initial UE amf SMs UE  amf  respectively SMs environmental variable enable enable 5G connectivity cmd mac failure improper mac sec mode command message cmp mac failure improper mac sec mode message desire whenever UE SM  UE authenticate amf UE sec mode amf sec mode command message signifies whenever UE initiate registration procedure authenticates core network eventually stage registration procedure UE successfully negotiates security algorithm core network sec mode command sec mode message passing sanity valid mac security capability desire violation signify privacy service disruption attack verification MCheck  generates counterexample adversary sends sec mode command UE UE receives UE sends sec mode verification  ensure validity 5GReasoner  verifies adversary inject fake sec mode command message verify injective correspondence infinite parallel session asserts sec mode command message cellular device precede unique sec mode command message amf  counterexample attack trace adversary replay sec mode command message capture previous session UE upon message UE responds sec mode message invariant generation 5GReasoner refining additional invariant cmd mac failure adversary inject sec mode command previous sec mode command message amf iteration iteration 5GReasoner  MCheck generates another counterexample adversary replay sec mode command message earlier core network UE UE receives UE sends sec mode feasible attack demonstrates effectiveness 5GReasoner modeling  explain extract security requirement formal discus protocol model discipline finally behavior aware predicate abstraction technique employ extract formal 5GReasoner aim authenticity disallow impersonation availability prevent service denial integrity restrict unauthorized message secrecy user sensitive information prevent location data activity profile replay protection restrict reception message therefore identify extract precise formal security goal informal description conformance suite technical specification TS technical requirement TR document 3GPP translate formal conformance suite UE behavior procedure 3GPP standard defines conformance UE however define session 3D formal analysis CCS november london united kingdom UE    ensure SS sends EAP request aka challenge within authentication request UE sends EAP response aka challenge message within authentication response conformance authentication procedure instance conformance considers UE register initiate posse valid credential receives authentication request message however UE already fail verify integrity previous authentication request message fails sequence authentication request message address challenge grain sub enumerate translate formal TS clause replay protection assures NAS message accepted twice receiver replay protection requirement technical specification requirement conformance suite technical specification technical requirement document define security requirement albeit abstract instance replay protection requirement extract technical specification interpret translate formal NAS layer message integrity protection activate threat layer model protocol model discipline model 5G protocol communicate machine SM 5G model considers communicate machine participant  UE MRRC UE UE MRRC BS  amf amf model communication channel FSMs instance MRRC UE MRRC BS uni directional channel MRRC UE MRRC BS another MRRC BS MRRC UE choice unidirectional channel instead bidirectional channel flexibility direction public channel adversary whereas reliable specific scenario filter spurious counterexample communication channel  UE MRRC UE MRRC BS  amf private threat model assumes neither cellular device firmware secure communication channel sctp connection amf adversary model public communication channel MRRC UE MRRC BS NAS rrc layer message transmit dolev yao adversary capture data packet payload challenge aspect precisely capture 5G protocol behavior model protocol packet payload directly packet payload due domain payload model unlikely amenable automate initial attempt directly capture packet payload model amenable analysis model checker address issue explosion employ notion  predicate abstraction intuitively capture data directly model predicate data predicate directly inspire protocol behavior representative predicate 5G model employ validity predicate 5G protocol behavior relies validity message authentication code mac instead precise mac predicate mac valid mac truth signifies validity mac presence predicate procedure 5G behavior device relies identity TMSI RNTI message instead capture identity mutually exclusive predicate   resp predicate identity TMSI resp RNTI predicate core network denies device connection sends device reject message contains payload signify rejection rejection device reacts differently rejection inspection standard reveal device behavior mutually exclusive capture membership rejection mutually exclusive predicate    predicate   rejection belongs addition payload faithfully model counter finite domain counter link counter payload counter model without employ sort predicate abstraction session 3D formal analysis CCS november london united kingdom model timer 5G model transition dependent various timer protocol behaves differently various timer model timer counting timer model tick severely impede analysis scalability timer model maintain boolean variable timer timer expire variable timer signifies timer whereas environmental variable timer expire signifies expiration timer timer behavior timer ongoing capture timer timer expire capture multi layer adversary behavior model multiple layer protocol stack handle packet generate protocol layer conceptually NAS layer protocol packet payload rrc layer packet moreover rrc layer packet NAS layer packet adversary arbitrary data packet generate packet compliant protocol packet parse error ensure packet adversarial modification compliant protocol packet additional formedness instance whenever NAS layer packet UE amf embed payload rrc packet info transfer packet encounter adversary modify NAS layer packet rrc layer packet relevant protocol packet implementation discus realization 5GReasoner formal gathering conformance requirement document carefully review conformance requirement document extract conformance NAS layer within scope formalize model adheres liveness safety extract conformance rrc layer formalize liveness safety exclude conformance category performance related refers procedure model mobile initiate connection wifi technical requirement specification extract formalize verify implicit technical specification requirement document NAS rrc layer within scope liveness safety protocol abstraction developed model generator input machine protocol  output lustre SMV description model model compliance concretize suite crucial establish model correctness concern specification UE machine NAS layer transition whereas amf machine transition rrc layer UE machine consists transition machine comprise transition model respective available http github com   5GReasoner git MCheck component instantiation model machine representation  complement overcome weakness   allows liveness essential requirement however capable handle data infinite domain  model consists code NAS isolation rrc isolation layer handle data infinite domain however unable liveness model consists code NAS isolation rrc isolation layer  implementation proverif cryptographic protocol verifier verify secrecy confidentiality injective correspondence authentication correspondence weak authentication observational equivalence linkability formal protocol analysis isolation reduce array spurious counterexample generate due environment variable span across protocol layer layer isolation 5GReasoner NAS layer instantiate analysis  UE  amf correspond NAS layer  relevant NAS layer procedure analyze NAS layer suite procedure registration configuration update service request handover isolation aspect protocol model abstraction UE reliably perform relevant rrc layer procedure rrc connection setup resume reestablish reconfiguration negotiation security algorithm prerequisite initiate respective NAS layer procedure instance NAS layer registration procedure 5GReasoner assumes UE rrc layer connection security context correspond rrc layer procedure incoming rrc NAS layer boolean environment variable illustration UE rrc layer release connection rrc layer notifies NAS layer UE idle abstract inter layer communication boolean environment variable analyze isolation rrc layer analyze rrc layer procedure isolation similarly instantiate 5GReasoner MRRC UE MRRC BS  instantiation abstract incoming outgo rrc layer abstract invocation rrc layer procedure NAS layer boolean session 3D formal analysis CCS november london united kingdom counter maintain UE amf environment variable model rrc layer consume outgo generate NAS layer rrc layer  packet data convergence protocol layer ensure encryption integrity protection rrc layer  message incorporate functionality encryption integrity protection rrc layer minimize explosion formal layer protocol analysis unexpected interaction cannot realize procedure isolation model procedure layer layer analysis model channel message participant avoid non determinism however additional challenge participant occasionally NAS rrc layer message participant transition becomes instance amf receives  request message UE sends  accept message UE NAS sends context release request BS rrc release rrc layer connection address challenge 5GReasoner amf NAS  accept message UE boolean variable context release trigger amf NAS context release request message FINDINGS highlight vulnerability attack uncovered 5GReasoner discus uncovered vulnerability exploit along domain knowledge perform detrimental attack summarize finding attack NAS layer finding 5G NAS layer NAS counter reset attack adversary exploit potential vulnerability lurk handle NAS counter typically generate verify message authentication code mac replay protection NAS layer message adversary replay message reset desynchronize counter device network enable adversary billing user adversary assumption adversary RNTI layer identity victim device eavesdrop victim downlink message amf adversary capable fake relay additionally replay sec mode command sec mode message vulnerability UE amf independently maintain NAS counter   UE   amf prevent replay uplink UE amf downlink UE amf transmission NAS counter cnt unsigned integer comprise overflow counter concatenate sequence seq sender locally NAS counter  UE  amf input integrity protection algorithm generate message authentication code whereas receiver sequence message estimate overflow counter compute correspond counter input integrity verification algorithm verification downlink transmission receiver update  estimate  estimate sequence wrap around overflow counter incremented accord TS clause detect wrap around amf   primarily vulnerability stem lack specification currently message sequence  accepted message  due underspecified policy wrap around receiver handle overflow counter ocr increment overflow counter ocr estimate  neither sequence locally increment ocr assume   message sequence  receiver sequence  lose interpretation entail potential vulnerability enables adversary replay integrity sec mode command sec mode message cipher suite  uplink NAS counter UE amf allows adversary stealthily packet without network operator device manufacturer interpret wrap around policy differently inter operability issue disrupt regular service discus potential attack detail briefly outline potential adversarial impact detection model  UE  amf  adv implicitly mention TS replay protection assures NAS message accepted twice receiver specifically 5G NAS security context NAS accepted message integrity verifies correctly violate counterexample adversary sends sec mode command receives sec mode message sec mode command message integrity protection resort proverif correspondence UE sec mode message amf previously sec mode command message proverif attack strategy allows adversary replay sec mode command message proverif attack strategy replay sec mode message core network session 3D formal analysis CCS november london united kingdom counter reset attack attack description adversary fake mitm relay transmits unauthenticated initial broadcast   message signal strength victim UE adversary capture sec mode command sec mode message  seque respectively initial registration procedure whenever UE completes registration legitimate amf adversary sec mode command sec mode massage amf UE respectively amf sends sec mode command message refresh rrc layer  adversary selectively message encrypt message packet context  replay previously capture sec mode command sec mode message replayed command message successfully verify overflow counter   legitimate UE amf seque  successful verification amf UE update locally maintain  seque respectively seque seque respectively therefore adversary replay sec mode command sec mode reset  seque attack adversary however cannot reset seque  locally maintain UE amf respectively impact attack adversary desynchronize uplink counter victim UE legitimate amf counter crucial parameter UE amf generate  later rrc  layer security attack  seque   generate UE amf induce victim UE establish connection network neutralize TMSI  another registration procedure adversary replay attack numerous victim UE establish connection dos battery depletion replay user packet  billing client attack adversary mitm relay arbitrary packet without detect receiver accepts packet sequence sequence receiver uplink NAS counter desynchronization attack adversary exploit lack rate limit fail security mode procedure desynchronize UE uplink NAS counter impact attack prolong desynchronization dos UE amf adversary assumption unlike counter reset attack assume adversary victim UE  eavesdrop capture sec mode command message previous session vulnerability vulnerability attack lack attempt counter security mode command procedure neither UE amf fails verify sec mode command sec mode message allows adversary inject arbitrary invalid sec mode command message victim device induces UE sec mode reject message response incrementing seque  detection model  adv amf correctly verify legitimate sec mode message UE response sec mode command message amf trivially violate counterexample adversary sends receives arbitrary sec mode command message target UE trigger increment uplink overflow counter seque uplink message violate sanity uplink counter attack description adversary fake mitm relay connects victim UE sends sec mode command message arbitrary mac UE fails verify mac sends sec mode reject fake increment seque consistent behavior respect reception uplink message attacker observer seque wrap around signifies seque UE ues locally  incremented  session 3D formal analysis CCS november london united kingdom uplink NAS counter   UE legitimate amf impact desynchronization victim UE correctly verify downlink message amf legitimate amf discard uplink message data victim UE legitimate amf  uplink NAS counter sec mode command message amf cannot verify sec mode message mismatch uplink overflow counter allows adversary prolong dos service disruption user victim UE connection authenticate legitimate amf amf initiate update procedure default timer min synchronize UE expose NAS sequence attack adversary passively monitor uplink downlink transmission victim UE reveals   adversary monitor victim UE cellular activity adversary assumption adversary victim UE RNTI  uplink downlink NAS message victim UE however assume adversary session decrypt message vulnerability NAS sequence   exchange plaintext UE amf NAS signal message sender encrypts NAS message computes mac correspond NAS counter mac NAS sequence plaintext message detection observational equivalence prior linkability coarse grain location attack migrate 4G lte secrecy NAS sequence NAS message proverif return violation secrecy NAS sequence UE amf expose sec mode command  sec mode  message attack adversary learns NAS sequence relate information infer aka session cipher suite due handover 4G 5G wrap around NAS counter adversary NAS counter loosely infer engagement service consumption interval impact attack enable adversary profile service usage monitoring activity target UE neutralize TMSI  amf configuration update procedure assign TMSI user upon completion service phone SMS attack adversary prevents network victim device TMSI enables adversary correlate victim phone TMSI useful  location adversary assumption assume adversary victim UE RNTI eavesdrop selectively victim UE downlink message mitm relay consist fake UE fake assume adversary victim TMSI another attack uncovered layer analysis attack vulnerability amf sends encrypt integrity config update command message initiate configuration update procedure message TMSI acknowledgment config update UE request indication adversary exploit disrupt TMSI refresh mechanism detection checked MCheck amf initiate configuration update procedure eventually assign TMSI device obtain counterexample adversary config update command message amf attack attack adversary knowledge victim device  mitm relay monitor downlink message amf config update command message indication UE acknowledgment destine victim device victim TMSI network  device  network incoming service phone SMS device network TMSI retries TMSI adversary TMSI victim UE compute victim occasion hijack channel prevent legitimate message victim UE attempt network abort configuration update procedure adversary cease victim TMSI impact attack enable adversary network TMSI victim target user vulnerable location attack device goal adversary exploit lack integrity protection initial reg request  request message stealthily disconnect victim device network adversary RNTI TMSI attack victim device impersonate victim reg request  request message amf amf discard initial request message integrity protection induces amf implicitly release exist connection victim device  device network  attack rrc layer finding 5GReasoner analyze rrc layer isolation denial service rrc setup request attack adversary exploit lack integrity protection rrc layer message stealthily disconnect target UE network adversary assumption assume adversary already TMSI attack device capable fake UE impersonate victim device session 3D formal analysis CCS november london united kingdom dos rrc setup request vulnerability rrc setup request message integrity protection UE rrc layer connection lack integrity protection enables adversary spoof message potential denial service attack detection attack description MRRC adv implicitly mention TS gnb rrc security context exist forever unless rrc setup request UE trivially violate counterexample adversary impersonate victim UE sends rrc setup request victim TMSI message victim already induces delete victim UE rrc security context implicitly release connection victim device malicious UE confirm proverif correspondence attack trace model checker attack variant adversary perform attack rrc reestablish request rrc resume request message victim TMSI initial signal channel signal bearer message integrity protection impact adversary stealthily disconnect victim UE network instal null cipher null integrity instal null cipher null integrity goal attack trick victim UE limited service mode null cipher null integrity protection  mitm relay relay message attacker eavesdrop inject legitimate message adversary assumption assume adversary already victim RNTI mitm relay device core network vulnerability rrc layer security mode procedure typically initiate refresh rrc  layer security context attack adversary exploit lack integrity protection rrc sec mode failure message UE sends UE cannot verify rrc sec mode command message detection attack description model MRRC adv implicitly mention TS access stratum rrc layer security context eventually establish security context MCheck yield counterexample adversary impersonate victim UE sends rrc sec mode failure message response rrc sec mode command message attack trace confirm proverif correspondence confirms adversary capability inject rrc sec mode failure message accord TS clause UE security configuration prior reception rrc sec mode command message neither apply integrity protection  cipher  null integrity protection algorithm  message UE limited service mode UE limited service mode establish emergency session emergency phone emergency registration request message TS clause null integrity protection algorithm null cipher algorithm impact adversary victim null cipher null integrity rrc  layer allows adversary inject message limited service mode UE expose SUPI plaintext fake sends identity request message  attack attack adversary intermittently victim device release exist connection legitimate network trap device idle device reconnect network  switch idle UE interaction cryptographic operation device deplete battery faster adversary assumption assume adversary already RNTI victim device victim device assume fake mitm relay vulnerability sends encrypt integrity rrc reconfiguration message UE reconfigure rrc layer connection UE UE cannot verify integrity protection rrc reconfiguration message release connection idle attack adversary exploit response behavior perform denial  attack detection attack description model MRRC adv UE rrc sends rrc reconfiguration message remain rrc reconfiguration procedure MCheck counterexample adversary impersonate sends rrc reconfiguration message arbitrary mac upon message victim UE cannot verify integrity rrc idle locally implicitly release rrc connection session 3D formal analysis CCS november london united kingdom attack variant adversary philosophy rrc resume rrc reestablish request message arbitrary invalid mac achieve impact victim UE impact attack enables adversary coerce device rrc idle delete security context TS clause later UE outgo incoming message UE establish connection rrc layer security context adversary perform attack frequently quickly drain battery victim UE  rrc reject rrc release overarch goal adversary attack victim device connection initiation loop adversary victim device legitimate network adversary assumption assume adversary already victim device RNTI TMSI attack capable fake vulnerability UE rrc idle accepts rrc reject message without integrity protection attack description fake lure victim device rrc setup request message response fake non integrity rrc reject message UE idle mode accepts non integrity reject message fake mobility backoff timer reject message victim idle maximum  victim UE connection establishment loop reject message victim UE however maintains connection establishment fail counter selection criterion counter limit trial prevent counter maximum limit fake sends rrc release message interleave rrc reject message adversary redirect carrier information rrc release message persuade victim fake operating redirect frequency impact fake adversary victim device malicious connection establishment loop layer attack 5GReasoner layer analysis uncovered attack discus attack expose device TMSI occasion attack adversary exploit vulnerability rrc NAS layer victim device TMSI occasion instance frame network sends message UE location user adversary assumption attack assume adversary victim RNTI phone assume adversary selectively message mitm relay eavesdrop broadcast channel legitimate vulnerability adversary exploit specification weakness acknowledgment rrc release message rrc layer retransmission request TMSI NAS layer detection attack description model  layer adv extract TS TMSI incoming service notification MCheck yield counterexample adversary equip mitm relay rrc release message victim legitimate victim UE release rrc connection rrc network assumes victim device idle mode adversary multiple phone service notification victim phone network request broadcast message victim TMSI idle mode occasion UE mode occasion victim UE message adversary however channel sniffer TMSI message trigger multiple phone infer victim TMSI 5G proposes compute idle mode occasion TMSI instead IMSI 4G adversary victim occasion TMSI impact adversary victim TMSI occasion location device infrequent TMSI update policy network operator operator implementation standard hijack channel broadcast fake emergency alert pre requisite attack expose device RNTI adversary attack philosophy exploit vulnerability layer attack learns victim RNTI occasion user attack description attack adversary rrc release message indication rrc suspend victim legitimate victim rrc instead inactive adversary multiple phone victim phone broadcast message victim RNTI adversary victim RNTI occasion victim RNTI adversary hijack channel perform stealthy denial service attack prior attack detect 5GReasoner addition newly discover attack 5GReasoner identify attack underlie vulnerability detect prior inherit 4G lte summarizes attack detect 5GReasoner 5G session 3D formal analysis CCS november london united kingdom attack vulnerability assumption validation attack notable implication NAS layer counter reset generate verify integrity mac sec mode command sec mode message RNTI mitm relay dos billing uplink NAS counter desynchronization lack attempt counter security mode command procedure generate verify integrity uplink counter sec mode command sec mode reject message RNTI mitm relay prolong dos expose NAS    transmit text RNTI session  service profile neutralize TMSI  configuration update command acknowledgment RNTI TMSI attack mitm relay location device reg request amf accepts registration request without integrity RNTI dos device  request amf accepts registration request without integrity RNTI dos downgrade reject message integrity reject message RNTI TMSI attack inspire downgrade 5G linkability authentication failure response mac failure TMSI attack inspire 3G 5G channel hijack integrity message TMSI attack RNTI inspire stealthy dos panic attack integrity message malicious gnb inspire  chaos victimization linkability sec mode command generate verify integrity mac sec mode command message RNTI mitm relay inspire rrc layer denial service rrc setup request integrity rrc setup request RNTI dos instal null cipher integrity lack integrity protection rrc sec mode failure RNTI mitm relay SUPI  attack rrc reconfiguration UE response invalid integrity protection rrc reconfiguration RNTI fake battery drain  attack rrc reestablish request UE reaction invalid integrity protection rrc reestablish request RNTI fake battery drain  attack rrc resume UE response rrc resume RNTI fake battery drain  rrc reject rrc release rrc reject integrity RNTI TMSI attack dos  rrc reestablish reject rrc reestablish reject integrity RNTI TMSI attack dos layer attack expose device TMSI occasion lack acknowledgment rrc release retransmissions RNTI mitm location stealthy dos downgrade 5G artificial chaos victimization expose device RNTI lack acknowledgment rrc release retransmissions RNTI mitm stealthy dos summary 5GReasoner finding related discus exist effort formally analyze cellular network security protocol finding threat respect security privacy availability cellular network formal verification cellular network previous effort formally analyze 5G protocol focus aka initial registration procedure oppose formal verification stateless dynamic framework 4G rrc NAS layer propose framework combine MCheck  formally analyze multiple stateful procedure span across 5G NAS rrc layer enhance model abstraction formal verification security protocol develop formal analysis framework TLS OAuth approach however implementation specific model abstraction TLS proof computational model therefore apply cellular network  traceability attack previous uncover mapping link TMSI IMSI RNTI TMSI 3G 4G network devise mapping user phone TMSI network operator TMSI frequently randomly exploit layer information launch website fingerprint whereas demonstrate device fingerprint expose device capability expose device TMSI RNTI occasion attack leverage layer interaction IMSI IMSI attack issue 2G network recently demonstrate brute IMSI crack attack retrieve target UE SUPI 5G instal null cipher null integrity attack employ brute technique exploit session 3D formal analysis CCS november london united kingdom unprotected rrc sec mode failure retrieve SUPI UE limited service mode relay devise mitm impersonation attack exploit implementation bug lte dongle operational network respectively mitm relay leveraged manipulate encrypt payload redirect dns traffic counter reset attack mitm flavor however exploit vulnerability processing counter generate verify mac denial service author explore conduct dos attack 3G 4G subscriber dos attack specific user entire exploit vulnerability 4G network dos attack rrc setup request rrc resume request reg request  request message however uncover vulnerability initial message NAS rrc layer 5G protocol stack discussion LIMITATIONS experimentation testbed currently access 5G commercial network cellular device addition source 5G protocol stack prevents attack testbed defense defense unclear defense without alter protocol investigation defense hence future threat validity manually extract FSMs 3GPP standard faithful interpretation inaccuracy induce false positive commercial source 5G testbed network available verify attack responsible disclosure report finding  cvd program response conclusion future 5GReasoner framework formally desire 5G protocol possibly span across multiple layer stack due careful behavior specific abstraction 5G model NAS rrc layer protocol amenable highly automate analysis 5GReasoner evaluation 5GReasoner respect desire obtain specification reveal 5G weakness 5G protocol model inherits weakness 4G lte protocol advantage finding devise exploitable attack version 5G future future improve 5G protocol model layer protocol 5G model amenable automate explore abstraction achieves balance behavioral accuracy analysis scalability