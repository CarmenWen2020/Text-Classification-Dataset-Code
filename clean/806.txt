secure message become mainstream billion active user encryption protocol signal signal protocol compromise security user however implementation without notification weaker message adversary compromise member inject message indefinitely compromise security achieve realistic asynchronous message asynchronous ratchet diffie hellman exchange user derive symmetric online member provable security guarantee significant basis draft ietf RFCs charter security guarantee message practically achievable CCS CONCEPTS security privacy security protocol cryptography formal theory security formal security model mobile wireless security keywords encryption message diffie hellman security protocol computational proof verification attack scenario secrecy PCS communication attack marked bold secrecy protects later compromise PCS protects earlier compromise introduction security secure message improve substantially recent whatsapp encryption billion active user whisper signal protocol guardian publishes signal contact detail investigative journalism signal protocol variant security compromise security PCS sometimes refer future secrecy heal PCS alice device entirely compromise adversary automatically establish secure communication others  exchange aware compromise PCS limit scope compromise adversary permanent active exploit knowledge powerful impediment surveillance technique PCS style proven protocol achievable stateful illustrates difference secrecy PCS surveillance PCS important secure message protocol whatsapp signal usable anyone expert functionality exist insecure message application within constraint important asynchronicity alice message bob bob currently offline typically encrypt message temporarily possibly untrusted server deliver bob online asynchronicity standard technique secrecy DH exchange apply directly driven development novel technique achieve secrecy without interaction session crypto CCS october toronto canada precomputed DH  bob uploads server puncturable encryption multi device message important user various implementers protocol however conversation asynchronous straightforward adapt exist exchange  protocol usually interactive communication context alternative protocol member become inefficient bandwidth computational message grows linearly scenario inefficiency bandwidth restrict expensive 2G network develop message protocol PCS communication generally guarantee message implementation without notify user whatsapp facebook messenger google  mechanism achieve PCS communication conversation device simpler transport mechanism sender achieve PCS indeed adversary fully compromise member indefinitely passively future communication remove device generation apps communication security communication decrease without inform user arises secure message allows participant communicate asynchronously   security guarantee PCS address devise protocol achieves contribution fully asynchronous  protocol security asynchronous ratchet derives agent without online requirement message protocol notably PCS message secret compromise agent significant basis ietf MLS draft RFCs computational security model protocol building multi stage model capture update allows encode PCS hop computational proof unauthenticated core protocol explicit reduction prf ODH  symbolic verification authentication tamarin prover hybrid argument evaluate proof concept java implementation core algorithm increase confidence practicality feasibility approach independent beyond specific construction construction insight exist literature synchronous protocol apply asynchronous dynamic proof concept implementation evaluation data background related research message protocol decade aim survey entire literature discus previous approach distinguishes research focus asynchronicity PCS derive PCS participant online message protocol otr style define multi message  generalisation classic otr protocol aim security deniability online message  interactive protocol sec conduct interactive communication derive communicate online perform additional cryptographic operation finally closing phase instance ass transcript consistency participant protocol intrinsically synchronous online initial exchange context XMPP style message mobile unreliable network assume authentic network discus asynchronous  distribute rely centralise interactive communication PCS physical approach physical constraint restrict malicious member  participant neighbour interact allows derive security however assume physical location sender participant secure pairwise channel encrypt broadcast member separately broadcast message encrypt implement  sender variant signal protocol however sacrifice security achieve ratchet adversary learns sender subsequently eavesdrop message impersonate owner cannot pairwise signal channel continuously update variant PCS regularly broadcasting sender secure pairwise channel prevents attack however sender separately member linearly rotation frequency DH generalisation DH update primitive allows session crypto CCS october toronto canada  DH node secret public recall denote leaf denotes mapping integer marked solid boxed node copath agent public copath compute  DH operation derive  compute without achieve traditional DH  construction however construction primitive essentially generalise  protocol construction non degenerate linear integer construct DH literature agreement scheme audio  seminal academic later others protocol assign private DH leaf binary define secret node secret public blind recursively compute secret leaf yield compute knowledge secret leaf depict generic DH compute secret assign non leaf node agent secret public compute agent secret leaf public node  along copath copath node sibling node along compute alternately  public secret apply mapping integer online exchange protocol due requirement agent public copath node cannot compute boxed public agent chosen message compute broadcast public intermediate node subtree sponsor broadcast public however none PCS update construction ternary underlie concept deployed implementation widely mobile apps deploy encrypt message protocol survey popular asymptotic efficiency concurrent examine message protocol whatsapp signal  vulnerability related operation whatsapp implement encryption message sender variant signal exist signal pairwise channel sender rotate whenever participant remove otherwise adversary learns sender therefore impersonate eavesdrop owner whatsapp multiple device user defines mobile phone device allows secondary device scan QR code alice sends message secondary device whatsapp sends message mobile phone pairwise signal channel intend peer multiple device functionality suffers downside alice cannot whatsapp device phone offline facebook messenger secret conversation similarly sender variant signal conversation involve device whatsapp implementation sender rotate device remove conversation  pairwise channel message encrypt member pairwise encrypt channel remark indicates perform asymmetric operation per message practical iphone  signal signal mobile application pairwise signal channel message additional device signal account implement participant  secure message app goal usable privacy preserve secure credential exchange aim message secrecy adversary model allows malicious participant difference  security goal synchronicity explicitly achieve PCS message  source code inspection session crypto CCS october toronto canada asymptotic efficiency message function pairwise signal denotes message repeatedly individual signal channel setup phase refer user setup sender refers creator phase refers recipient message concrete measurement exponentiation symmetric encryption bandwidth PCS sender per sender per sender per sender setup ongoing pairwise signal setup ongoing setup ongoing instead aim non secrecy derives necessity therefore stateful iterate derivation  unbalanced DH update reduce computational load initiator linear versus logarithmic  synchronous protocol commitment verification secret member online concurrently asynchronous protocol message offline member  security ake protocol extremely threat model security goal secrecy authentication fundamental goal confidentiality authenticity active adversary alice bob compromise security PCS traditional security model guarantee participant compromise attack bob identity impersonate alice cohn define PCS scenario achievable persistent protocol aim explicitly achieve PCS message protocol member compromise longterm derive conversation without interference secret absent goal simpler sender variant signal criterion weakness sender enables computation future message PCS distinguish feature message protocol significant protection adversary resource actively interfere communication manage temporarily compromise device randomness security model extend  generalisation reveal random generate uncompromised however widely protocol TLS signal achieve aim security reveal randomness security informally message protocol implicit authentication message secrecy various adversary security network adversary adversary message delivery intercept modify message network secrecy agent derive session reveal random subsequent operation compromise security PCS stage derives previous stage uncompromised derive secret equivalently secret compromise intermediate stage completes uncorrupted subsequent stage secure PCS goal previous aim earlier without PCS adversary compromise participant intercept message indefinitely signal communication scope goal provably secure asynchronous message transparency therefore discus important  refer reader research scope unimportant unnecessary merely indeed practical deployment later DH thereby enable reuse exist component sender specific authentication authentication becomes subtle alice bob charlie symmetric alice receives message encrypt session crypto CCS october toronto canada conclude bob charlie context desirable message otr feature deniability signal protocol sender explicit signature simpler option signature topic centralise unencrypted message usually individual authentication via service provider account facebook messenger chat bob impersonate charlie bob facebook account message assume trust analysis encrypt message authentication malicious member traditional security generally assume peer session honest intermediate member honest  protocol enables subset derive aim security subset another member malicious although useful orthogonal core research moreover standard construction synchronous literature anticipate extend handle membership relatively straightforward discus dynamic trust initiator malicious insider creator malicious initial malicious creator secretly eavesdropper without reveal presence honest member publish message regardless protocol member attack scope asynchronicity constraint alice message none participant online allows alice corrupt initial phase stage insecure member perform update capture increase requirement freshness predicate remove participant online perform update approach related zero rtt mode TLS agent achieve asynchronicity weaker security message  implementation message  bob attempt update without realise alice already perform update lose alice bob update consistently apply violate secrecy availability update message remark technique avoid trivial denial service perfect research scope technique decouple update message bob derive valid protocol accept message duration bob perform update allows bob message immediately background perform recovery return weaken security guarantee due extend lifetime transport layer enforce message delivery refuse accept update instead deliver transport layer server receives update bob generate date refuse accept instead instruct bob update retry enforcement message metadata malicious transport server violate availability message confidentiality integrity server performance bottleneck transcript agreement scenario valuable participant message although useful subtlety orthogonal research notation denote assign variable denote sample random distribution assign variable output distribution randomise function DH DH generator admit mapping integer interpret secret correspond public convention lowercase DH secret uppercase associate public public setup suk define suk denote  randomise algorithm return private DH initial exchange subsequent operation define distinct generation algorithm  return private DH assume prf ODH tuple uniformly randomly chosen advantage ppt distinguisher output negligible signature MACs explicit authenticator signature authenticate initial setup message mac authenticate subsequent update denotes signature message private sigverify verifies signature public return boolean verification succeed mac mac message symmetric  verifies return boolean define binary combination node nest leaf along associate data node leaf session crypto CCS october toronto canada node leaf binary notation refer leaf label node index node node exclude node index node index data index node node sibling node directly refer copath node comprise sibling sibling node copath finally usually associate secret correspond public node denote label node derive contains various leaf secret DH assign leaf node secret DH assign non leaf node secret derive stage derive combine previous hash chain stage role signal protocol avoid prevent confusion DH core DH protocol related unlike protocol fully asynchronous member creator conduct exchange protocol derive without member respond message ake protocol practical deployment member offline due unreliable mobile network connection define efficient protocol member update personal establish underlie structure update protocol enables compromise security member local compromise later perform update without adversarial interference derive update secret authentic ake protocol PCS informal explanation algorithm formal definition pseudocode appendix construction cannot directly deploy DH protocol initiator online member indeed alice public leaf cannot compute public node marked   insight initiator directly public leaf node cannot derive public instead propose derive secret leaf node member initiator member asynchronously derive secret assign leaf node actor member adversary derive secret creator knowledge secret compute intermediate public subsequently delete leaf secret additional trust assumption initiator assumption mitigate update protocol define later derive leaf secret core insight session ake protocol denote keyexchange keyexchange private public EK IK return bitstring keyexchange     keyexchange     protocol leverage exist  introduce setup  introduce  asynchronicity  message app DH ephemeral public cached untrusted intermediate server fetch demand message client  client public infrastructure identity initial message ake protocol enable compute initial introduce DH setup generate locally creator creation session perform initial exchange  allows initiator generate secret leaf member offline asynchronous construction suppose initiator alice peer generate DH suk setup request public infrastructure public identity IK ephemeral  EK intend peer bob charlie secret identity ika setup suk public peer executes exchange protocol derive leaf generate leaf leaf DH becomes initial instantiation keyexchange instantiate unauthenticated DH ake protocol algorithm initiator responder  role argument session crypto CCS october toronto canada alice generates keyexchange ika  suk  keyexchange ika  suk  keyexchange ika  suk  broadcast public keyexchange  ake protocol specific requirement structure alice creates member alice update leaf compute update node broadcasting update public alice update leaf broadcasting update public update node boxed charlie update leaf compute update node broadcasting update public charlie update creation update secret correspond public node leaf denote correspond identity counter denotes mapping integer secret leaf public copath agent compute exponentiation exchange alice setup bob  unauthenticated structure analyse practical instantiation ake protocol authentication inherit authentication alice broadcast public   identity  public setup suk public signature identity upon message verify signature member reproduce computation compute leaf keyexchange  ika  suk extract copath public finally iteratively  public copath construction secret recall secret derive stage pseudocode definition algorithm algorithm update achieve PCS update stage depends previous stage newly exchange message PCS explicit goal therefore efficient mechanism member update alice leaf member compute intermediate update update public DH node along alice leaf node update efficient asynchronous alice compute logarithmic broadcast leaf specifically alice leaf computes public node along leaf broadcast public leaf public authenticates message mac derive previous stage member receives message session crypto CCS october toronto canada KDF KDF derivation stage compute DH combine stage derive stage etc chain important ingredient achieve PCS KDF IDs per algorithm update copath node intersection compute induced yield update purely locally pseudocode definition algorithm algorithm stage chain achieve PCS stage cannot independent instead stage recent message exchange previous stage source secret data unknown adversary stage cohn impossibility stateless protocol achieve PCS generic attack stage hash chain depict security analysis perform security analysis detailed computational security model multistage  protocol instantiate unauthenticated version construction initial leaf derive directly setup  allows capture core security update PCS without focus authenticate exchange initial construction unauthenticated model  random hop authentication derive initial leaf non interactive exchange security applies construction  protocol extend static static DH resilience randomness  attack described verify authentication tamarin prover security protocol verification falsification unbounded verification symbolic model model construction function leaf remark choice model adopt approach complexity beyond scope computational proof technique freshness already fairly complex interaction ake model identity corruption explosion proof valuable future increase model accuracy develop systematic approach distinct adopt  style definition explicitly capture signature MACs computational model multi stage definition   session admit multiple stage distinct adversary stage extend definition message multiple peer session model defines security played challenger probabilistic polynomial adversary adversary query interact challenger ability relay modify message compromise secret adversary eventually chooses session stage uniformly random random distribution protocol secure model enjoys adversary cannot random exchange security model generally activate query adversary interact protocol algorithm query however instruct agent multiple action clarify distinction split traditional algorithm  protocol message  protocol instruction message apart split standard query precise detail query comprise   adversary interact honest participant   model corruption protocol security unauthenticated model  query session stage agent multiple parallel conversation various peer refer session local  communication agent alice session peer bob charlie session  uniquely zero indexed creation refer uniquely alice fourth session alice session update stage message exchange update stage session zero indexed denote initial stage session alice session identifier sid alice later stage alice denote alice alice definition session agent session counter stage counter session comprises identity agent identity agent ephemeral  agent leaf stage stage stage stage vii node public node idx agent IDs agent identifier leaf index entry index correspond leaf copath agent session crypto CCS october toronto canada multiple distinct session refer stage agent session roughly correspond variable protocol implementation however security definition additional bookkeeping security correspond variable protocol implementation definition bookkeeping agent session counter stage  bookkeeping collection variable index session session agent index stage session initialise incremented stage compute status execution status stage active stage later accept reject stage compute  ephemeral honestly generate stage leaf node idx leaf generate definition sid sid triple agent unique session counter monotonically increase session without stage therefore tuple uniquely identifies exist definition multi stage exchange protocol multi stage exchange protocol define  security parameter dictate DH probabilistic algorithm  generate DH activate peer challenger  protocol agent accept secret role peer peer assign integer return  agent receives message update protocol  agent receives instruction sends message update protocol maximum agent willing application specific analysis unauthenticated protocol analyse protocol model analysis instead stage freshness criterion adversary corrupt random stage trivial attack corruption define keyexchange IDs suk  initial leaf node construct unauthenticated initial ephemeral MACs define protocol algorithm assumption security define  validate update abort session reject execute initiator setup algorithm update execute initiator update algorithm algorithm formally   define  session validate  format extract relevant data execute responder setup algorithm define session validate execute responder update algorithm define algorithm formally   definition stage respective sids derive status accept definition freshness copath copath leaf copath induced precisely DH induced sibling node induced copath induced copath copath induced exists stage sid sid   query issue intuitively copath built honestly generate  leaf copath owner leaf  definition freshness stage stage sid derive status accept adversary issue  query exist stage sid adversary issue query  return criterion copath stage sid intuitively stage leaf honestly generate  previous stage latter disjunct capture PCS adversary allows stage accept subsequent stage remark freshness creator stage freshness predicate encodes trust assumption initiator stage subsequent update indeed criterion creator stage copath copath induced initial  creator stage session crypto CCS october toronto canada criterion adversary issue  query stage longer initial stage replace criterion fulfil stage replace capture security notion stage freshness capture security adversary stage compromise scenario authentication ephemeral stage uncorrupted stage agent generate derive indeed stage ancestor copath built honest stage secrecy capture clause definition  query indeed suppose alice accepts stage update stage adversary query  randomness stage therefore remains model stage indistinguishable random adversary PCS capture clause indeed suppose adversary issue  query alice session stage stage absent query stage therefore hence clause stage model indistinguishable random definition security challenger generates public private sends public info identity public adversary adversary asks series query eventually issue query stage session user equivalently adversary query oracle machine session user notion security stage indistinguishable random query challenger flip coin uniform probability reveals actual stage user  session stage adversary probability reveals uniformly randomly chosen instead adversary query eventually adversary query terminate satisfies adversary otherwise adversary loses multi stage exchange protocol secure probability probabilistic polynomial adversary security bound negl negl tends zero faster polynomial security parameter theorem sketch proof remark partner freshness  partner security style  restriction  query cannot output session authentication session derive session derive context unauthenticated model upon participant argument session KDF partner correspond security bound mostly consist administrative bookkeeping appendix theorem denote bound session stage security respectively prf ODH assumption  model random oracle probability ppt adversary security protocol bound    ODH negl  ODH bound advantage ppt adversary prf ODH bound depends  ODH keyexchange unauthenticated proof sketch proof appendix proof standard hop technique security hop bound probability adversary hop adversary clearly cannot probability non negligibly probability related another bound probability adversary modification protocol technical specify agent authenticate creation message signature identity update message mac derive stage exchange protocol cannot achieve  notion security computational proof therefore explicit authenticator protocol enforce authentication freshness instead overall structure proof perform administrative hop avoid DH collision index sid session stage adversary loses perform distinction clause freshness predicate satisfies copath previous stage latter  induction former definition leaf generate stage honestly generate  secret node public define hardness prf ODH  replace uniformly randomly chosen perform replacement non leaf node bound probability difference hop prf ODH advantage  replace hence stage replace random probability adversary therefore sum probability throughout various derive overall probability bound tightness security reduction limitation conventional hop proof ake protocol tight reduction underlie reduction specific session crypto CCS october toronto canada session attack protocol potentially amount session user extremely non tight reduction develops protocol tight reduction protocol non standard setup assumption currently technique construct tight reduction applicable protocol nevertheless loose bound generally useful increase confidence security mechanism analysis authenticate protocol derive leaf authenticate exchange protocol allows authentication initial agent public setup derive construction analyse authentication tamarin  extend static static DH exchange protocol agent ephemeral derive sufficient impersonate adversary model authentication abstract construction replace symbolic oracle assign public induce anyone query oracle correspond secret tamarin  verification roughly model protocol role alice accepts initial exchange message member derive accept member derive via abstract oracle remark although advanced authenticate exchange protocol leaf relatively security trivially earlier protocol without authentication initial message analyse earlier tamarin attack alice correctly fetch  computes sends abstract copath bob adversary modifies message malicious leaf leaf bob derive accepted bob tamarin analysis authenticate copath public authenticate improve accordingly release tamarin model shortly model verifies initial agent derives secret none agent compromise verification unbounded arbitrary instance member verification security proceeds automatically helper lemma desktop implementation implement protocol described java source code available url goal demonstrate practical efficient realistic implementation detail appendix directly DH ratchet pairwise connection hash ratchet comparison signal ratchet benchmark sender achieve PCS benchmark construct protocol phase around approach setup phase construct conclusion member message encryption phase performs asymmetric update encrypts random message entire instantiation encryption phase comprises update message encryption  instantiation ratchet algorithm update channel message direction encrypt message message channel byte message aes data encapsulation network bandwidth consumption various scenario primary metric per bandwidth message directly repeatedly visible user setup important incur incur user sends message data macbook pro ghz intel core GB ram evaluation demonstrate practical reasonably setup millisecond performance favourably pairwise DH ratchet due server fanout allows broadcasting logarithmic quantity data peer pairwise channel constant data everyone broadcast implement yield slightly benefit message context broadcast typically offload server fanout byte transmit actually pairwise connection recipient perform logarithmic instead constant computation however message context amount data important message latency directly proportional amount data agent allows server fanout distribute across allows significantly latency pairwise setup pairwise channel comparable former consistently slightly latter asymptotic trend however remark pairwise channel quadratic computational effort evenly across member creator perform linear amount responder perform logarithmic amount although overhead minimal normally message application message recipient receives logarithmic quantity data pairwise channel constant message session crypto CCS october toronto canada participant byte implementation pairwise DH ratchet outgo byte byte message participant initiator setup implementation pairwise DH ratchet setup graph metric implementation pairwise DH ratchet average conjecture variance due java jit compiler quadratic effort significant performance constraint EXTENSIONS remark various extension standard DH technique exist literature directly applicable directly apply technique interactive communication sender specific authentication issue sender specific authentication derives member cryptographic proof member message various proof assign member signature message remark easy extend rotate chain signature conjecture achieve authentication compromise dynamic refer reader summary previous dynamic operation standard technique remark operation asynchronously setup specifically alice ted sibling node perform operation initial setup generate ephemeral perform update replaces alice leaf intermediate node alice ted cooperation user alice ted anywhere balance multiple device important motivation message enable user communicate device treat device member however structure optimise scenario alice device subtree leaf device specific subtrees allows user publish public subtree ephemeral  enable device moreover user reveal device subtree trigger update improve privacy guarantee chain signal introduce concept chain message receipt grain secrecy instead secret encrypt message directly signal derives encryption message hash chain secret derive  directly benefit conclusion combine technique synchronous message security guarantee asynchronous message asynchronous ratchet combine bandwidth benefit message security guarantee protocol compromise security efficiently achievable message pairwise pave message application security currently offering communication widespread basis draft RFCs ietf MLS adopt secure message improve guarantee user everywhere construction independent blueprint generically apply insight synchronous message asynchronous alternative future acknowledgement author richard barnes error previous version algorithm MLS contributor helpful discussion insight session crypto CCS october toronto canada pseudocode protocol DEFINITIONS precise pseudocode algorithm correspond data memory implementation bookkeeping definition security QUERIES computational model formal definition adversary query computational model computational security proof remark DDH assumption randomly sample computationally distinguish uniformly random prf ODH assumption without oracle commonly satisfied assume random oracle identity function DDH assumption remark instead encode authentication restriction session valid issue  query another security  simply prohibits  query reveal session session derive session partner definition definition partner define partner challenger  security adversary asks series   query eventually terminates additional model query permit adversary session status accept disagreement member exists another stage derive IDs IDs incorrect peer exists stage derive IDs session exists another session derive peer peer identity IDs exist stage derive theorem KDF model random oracle probability ppt adversary partner negligible security parameter proof sketch directly IDs argument KDF derive stage KDF random oracle output collide output imply input partner security suppose exists adversary partner security definition occurs suppose exist stage derive IDs IDs stage derive KDF IDs equality stage implies equality IDs negligible probability collision random oracle impossible suppose exists stage derive IDs IDs IDs IDs however contradicts agent impossible suppose exist session derive recall stage derives ephemeral stage ephemeral local derivation derive therefore ephemeral generate agent DH collision happens negligible probability formally hop abort DH collision bound difference argument proof sketch hence impossible unless fourth finally suppose exist stage derive IDs IDs idx index IDs stage collide idx disagreement implies IDs IDs hence derive distinct contradiction uniqueness ephemeral collide stage derive distinct ephemeral IDs hence stage derive distinct theorem denote bound session stage security respectively prf ODH assumption  model random oracle probability ppt adversary security protocol bound    ODH negl  ODH bound advantage ppt adversary prf ODH bound depends  ODH keyexchange unauthenticated proof security efficient adversary  protocol suppose contradiction adversary definition security issue query stage session agent session crypto CCS october toronto canada algorithm asynchronous setup procedure    identity ephemeral peer  suk  generate leaf agent keyexchange  suk  sid       IDs IK   EK  IDs  suk  idx idx copath  return algorithm helper function function  height subtree return function  leaf return leaf   subtree  subtree return node function  node return return node   function copath index leaf leaf  subtree return copath possibly incomplete subtree return copath function  leaf copath public nks   return nks nks nks function  KDF IDs return algorithm setup message agent index procedure  assert sigverify IDs IDs IDs agent copath ephemeral  correspond EK keyexchange IDs suk nks  nks initial idx  return algorithm agent update procedure   idx idx sid  nks  idx nks nks nks mac KDF mac  return algorithm processing another agent update procedure  assert  KDF mac nks  idx index copath update message nks  nks  return function  subtree return  subtree return  return otherwise return index pseudocode description algorithm informal explanation procedure denotes subroutine protocol algorithm   function denotes procedure mutate agent optional input message adversary return optional output message tuple implicitly uniquely encode bitstring avoid confusion error uniquely decode keyexchange derives secret public identity ephemeral keyexchange ika    keyexchange ika    session crypto CCS october toronto canada adversary query define model denote agent target query denote index session agent denote stage session identifies fourth stage alice session message intend peer challenger executes activate prepares bookkeeping already  role oracle agent  message session execute  session valid agent identifier query model message session  session execute  update session return message query model role oracle perform protocol action  return stage sid exists query model leak adversary capture authentication  reveal random coin stage session query model corruption agent initial generation afterwards denote compute user stage session denote uniformly randomly sample challenger challenger flip coin uniform return adversary immediately terminates execution query subsequently issue query non negligible advantage definition freshness definition precisely status accept adversary issue  query exist adversary issue query  return criterion session copath proof distinction adversarial behaviour construct sequence related per hop proof technique denote security  denote maximum adversary advantage goal bound adv advantage adversary security recall due technical limitation  model unable faithfully model explicit MACs creation update message instead remainder proof omit protocol specify authentication fiat freshness predicate attack authentication message violate construction tuple uniquely identifies correspond exist definition simplify notation therefore convenient refer session bookkeeping directly identifier ake security probability adversary bound adv challenger abort adversary loses collision honestly generate DH maximum  ephemeral DH generate per therefore maximum  DH collide generate DH  probability collide therefore bound adv  adv challenger uniformly random independently random sample user session stage adversary issue query challenger immediately abort adversary loses additionally challenger correspond counter abort idx challenger attempt DH challenger independent adversary choice session derive bound adv  adv challenger advance peer session associate leaf exist abort met unique non unique session contribute leaf precisely challenger leaf triple index nnp abort exists session idx idx leaf session challenger advance agent agent session stage session DH session memory content session session crypto CCS october toronto canada leaf leaf peer longer setup abort unique exist ensures exist uniquely define advance challenger recall denotes maximum derive peer associate leaf stage therefore leaf assume uniqueness tuples ensure advance honestly generate DH unique challenger session possibly internal structure session without loss generality bob leaf charlie leaf etc uniqueness session internal structure session internal leaf session actor identity abort uniqueness actor generate DH leaf cannot additionally leaf challenger correspond counter abort challenger attempt DH node leaf uniformly randomly therefore bound adv  adv distinction proof distinction adversary behaviour define copath perform distinction false hop sequence split proceed assume definition copath freshness therefore copath copath induced output honest stage  query issue without loss generality define leaf recall leaf node define derive define define local stage computation actor session stage unique previous replace uniformly randomly chosen DH exponent subsequent computation upwards along instead hop  hybrid distinguisher interpolates distinguisher distinguishes distribution drawn distribution input output probability adv drawn distribution output probability adv  assumption implies difference negligible indistinguishable prf ODH assumption precisely aim distinguisher efficiently distinguish prf ODH assumption implies adv adv  probability ppt distinguisher correctly distinguishes remains bound reduction prf ODH specifically suppose distinguisher construct adversary prf ODH prf ODH challenge challenge simulates hybrid challenger fully honest insert construct prf ODH adversary construction node alice bob leaf node therefore replace node secret compute public DH intermediate hybrid probability simulator query honest query insert DH leaf honestly challenger agent session stage generate advance generate DH challenger associate counter DH generate idx correctly agent session stage without abort instead honestly  query  DH due session query initial DH protocol generate ephemeral challenger instead insert prf ODH challenge unique per query challenger insert precisely challenger protocol honestly generate DH instead prf ODH earlier hop simulator inject replace simulation freshness predicate honest similarly freshness predicate  query honestly simulate reveal query therefore simulation ensure DH collide probability prf ODH challenger challenge simulator abort fortunately happens negligible probability bound adv adv  ODH iteratively hop DH previous hop insert prf ODH challenge DH therefore conclude node indistinguishable random session crypto CCS october toronto canada eventual conclusion secret indistinguishable random replacement perform previous sibling node detect replacement violate prf ODH longer function leaf instead depends node leaf replace random unknown adversary iteratively replace DH prf ODH assumption along eventually DH independent trivially impossible adversary hop due structure   ODH proceed restart hop sequence assume copath session stage stage disjunct clause freshness predicate stage sid proceed induction stage session inductive hypothesis adversary non negligible advantage session stage argument cannot apply freshness predicate assume inductive hypothesis stage fort adversary query stage RO adversary query random oracle stage RO adversary reveal freshness predicate option replication attack perform hop replace stage random random oracle response construction random replacement indistinguishable advantage adversary zero conclude RO random oracle collision negligible probability adversary query KDF input stage computation stage sid query random oracle stage input adversary therefore distinguish advantage previous stage definition contradicts induction hypothesis specifically adversary construct adversary non negligible probability stage simply simulates without random oracle query simulation trivially faithful issue query issue query random oracle query random oracle query output otherwise output construction stage sid stage argument random oracle advantage non negligible contradicts inductive hypothesis adversary stage non negligible probability induction measurement DETAILS prototype implementation available algorithm implement file java file primarily container utility diffie hellman operation java implementation curve encryption decryption message java native aes gcm without java runtime patch  sha derivation  exchange algorithm initial authenticate exchange algorithm extend static static DH encryption message message stage implementation instead chain approach ratchet algorithm choice hash ratchet raw although construct ratchet pas message session byte array memory relative network without actually transmit network device apache thrift library toolchain  message mimic closely actual format rpc