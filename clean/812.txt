motivate bitcoin cryptocurrencies majority implement smart contract ethereum token regulate interaction token user wallet exchange etc standard propose implementation token contract although exist token involve behavior consistent standard inconsistent behavior user confusion financial loss user interact token contract invoke standard interface standard investigate inconsistent token behavior regard erc popular token standard propose novel approach automatically detect inconsistency contrast behavior derive source manipulation core data structure token holder action standard interface behavior standard implement approach tokenscope inspect transaction deployed token detect transaction trigger inconsistent behavior behavior token manually examine source token inconsistent behavior precision tokenscope moreover reveal inconsistency flaw token standard lack standard etc discover unreported flaw token CCS CONCEPTS security privacy software security engineering http acm org cfm generate actual concept keywords ethereum token erc inconsistent behavior introduction motivate bitcoin cryptocurrencies cryptocurrencies native asset bitcoin blockchains majority token implement smart contract ethereum ethereum blockchain smart contract token token contract interchangeably token usually involve token ethereum worth billion USD regulate interaction token contract user wallet exchange blockchain explorer standard propose implementation token contract standard usually specify standard interface functionality implement token contract standard emit token contract notify application erc popular token standard defines standard interface session blockchain CCS november london united kingdom optional standard interface standard user usually employ manipulate token wallet transfer token leverage exchange purchase token employ blockchain explorer transaction interact token standard interface standard define token standard investigate source code popular recognize token behavior monitoring standard interface standard specifically blockchain explorer  toy explorer  wallet  monitor standard ethereum ETL data collection recognizes token detect standard interface capture token transfer behavior monitoring standard moreover blockchain explorer  wallet   exchange   monitor standard standard however implementation token contract consistent standard neither interact token properly recognize token unfortunately behavior deployed token consistent standard inconsistent behavior user confusion financial loss instance token  KYC casper token emit standard inform others token transfer however really transfer token cheat user another token  fake deposit invoke standard interface transfer token exchange mistakenly token deposit detect token transfer monitoring invocation standard interface investigate inconsistent token behavior regard erc popular token standard although formal verification technique propose smart contract challenge conduct automate inspection developer manually define specify code responsible smart contract unfortunately deployed smart contract source analyst code relevant define knowledge none exist smart contract examines inconsistent token contract closest  propose recognize token contract analyze ethereum virtual machine EVM bytecode relies IDs standard interface however acknowledge prone false positive false negative false positive generate constant smart contract ID standard interface moreover false negative token implement standard multiple contract applies symbolic execution taint analysis detect token transfer detect token contract recognize precisely applies taint analysis storage operation input symbolic execution constraint symbolic expression unfortunately approach suffers limitation symbolic execution definition false negative moreover cannot detect token transfer behavior realize cooperation multiple contract worth aim recognize token focus detect inconsistent behavior propose novel approach automatically detect inconsistent behavior contrast information source manipulation core data structure token holder action standard interface behavior standard inconsistent behavior detect inconsistency happens token balance token holder decrease whereas standard transfer suggests amount nontrivial realize approach challenge automatically identify core data structure token holder identifier balance recognize token transfer trigger inter contract invocation user transfer token user token contract realize functionality smart contract decrease balance user invoke another smart contract increase balance user contract interaction hinders exist static analysis approach recognize token behavior contract invoked without runtime information address challenge trace approach leverage salient feature blockchain execution smart contract restore blockchain recover execution trace token contract node instrumentation investigate contract interaction core data structure maintains token holder identifier balance recognize token behavior manipulate core data structure exploit EVM access data structure token behavior standard interface behavior standard parse trace detect inconsistent behavior contrast information source implement approach tokenscope inspect transaction deployed token tokenscope detects transaction trigger inconsistent behavior inconsistent token manually examine source token expose inconsistent behavior false positive precision tokenscope besides obtain observation experimental inconsistent token deployed finalization erc standard token inconsistent token inconsistent token exchange moreover conduct thorough investigation reveal inconsistent behavior flaw token standard lack standard etc discover unreported flaw token summary contribution session blockchain CCS november london united kingdom knowledge detect inconsistent token behavior regard token standard novel approach automatically detects inconsistent behavior contrast information obtain source implement approach tokenscope tackle challenge issue tokenscope inspect transaction deployed token contract inconsistent behavior token obtain observation manually examine source token expose inconsistent behavior discover inconsistency tokenscope precision background account account ethereum external account EOA smart contract smart contract account executable code EOA another smart contract smart contract developed solidity compile EVM bytecode smart contract deployed blockchain execute EVM accord predefined program logic deployment smart contract cannot modify smart contract invoked others emit inform application execute smart contract EVM maintains runtime stack memory transient storage permanent data prevent abuse resource deployment invocation smart contract transaction sender transaction transaction message account invoke smart contract account sends transaction contract specifies invoked parameter transaction sender transaction namely external transaction sender  internal transaction sender smart contract external transaction blockchain although smart contract another smart contract chain invoked EOA token token smart contract information token holder token activity query balance token holder transfer token another holder token contract implement standard interface standard application interact semantics standard interface standard  token standard user standard invoked accomplish task execution monitoring standard token contract non standard interface nonstandard semantics specify token standard fiat token amount circulation token mint burning increase decrease amount respectively erc standard various token standard popular standard erc defines standard interface standard standard transferFrom declare function transferFrom address address uint public return bool transfer token address address besides transferFrom standard transfer declare transfer address address uint denote address transfer token address moreover erc transfer emit whenever token transfer standard non standard focus standard interface transfer transferFrom standard transfer related token balance node synchronization underlie structure blockchain PP overlay consists multiple node node implement functionality ethereum ethereum node EVM maintains blockchain synchronization consensus node besides node node replay historical transaction hence transaction contract contract execute node EVM synchronization node  EXAMPLES inconsistent token legitimate token  malicious token motivate  code function  code solidity popular develop ethereum smart contract  mapping variable balance information token holder address token holder amount holder token function inconsistent behavior token holder sufficient token execution smart contract halt however contains integer overflow bug bypass  feeUgt unsigned integer integer overflow happens token recipient msg sender token amount token sender therefore inconsistency happens behavior standard reflect token behavior specifically token however sends token due integer overflow function transfer incur inconsistent behavior executes transfer standard interface account msg sender token token transfer inconsistency fake deposit cheat exchange function  inconsistency increase balance owner transfer emit announce token mint behavior lack standard confuse wallet exchange blockchain explorer inform token transfer replace respectively remove inconsistency revise token contract complies erc fix integer overflow import SafeMath library halt execution integer overflow happens fix transfer exception halt execution token transfer session blockchain CCS november london united kingdom function  address address uint uint feeUgt balance feeUgt balance SafeMath safeAdd feeUgt balance balance SafeMath safeAdd balance transfer balance msg sender feeUgt balance msg sender SafeMath safeAdd balance msg sender feeUgt transfer msg sender feeUgt balance feeUgt balance SafeMath  balance SafeMath safeAdd feeUgt function transfer address uint return bool return false function  balance owner balance owner SafeMath safeAdd balance owner transfer owner inconsistent token  execute smart contract cancel execution halt abnormally hence revise function  transfer inconsistent behavior fix  SafeMath library prevent potential integer overflow emit transfer announce token mint transfer owner meaning owner receives token nobody balance decrease due limit demonstrate tokenscope detects inconsistent behavior incur integer overflow locates core data structure balance information token holder monitor modification balance token behavior balance increase balance msg sender increase feeUgt balance decrease  due integer overflow moreover monitor standard emission obtain token behavior transfer balance increase balance msg sender increase feeUgt balance decrease  token behavior behavior transfer detect inconsistency malicious token craft token implementation violates erc illustrate token steal token token holder without token contract mapping variable balance information token holder balance address token holder amount token possess holder declares standard transfer implement standard interface transfer transfer interface transfer transaction sender msg sender transfer token however contract steal fee token msg sender sends hacker defines another mapping variable victim amount token steal token holder standard balanceOf return amount token possess query account however deliberately return fake summation amount steal token hide activity steal token hence user cannot invoke balanceOf inconsistent behavior invoke transfer balanceOf standard interface standard reflect token behavior contract  mapping address uint public balance transfer address address uint function balanceOf address owner constant return uint return balance owner function transfer address uint return bool balance msg sender balance transfer msg sender contract  mapping address uint public balance mapping address uint public victim transfer address address uint uint public fee address hacker  function transfer address uint return bool balance msg sender fee balance msg sender fee balance balance hacker fee victim msg sender fee transfer msg sender function balanceOf address owner constant return uint return balance owner victim owner inconsistent token steal token contract mislead ethereum wallet  explorer etherscan  return fake compute instead token balance therefore user cannot token steal  examine source code  invokes balanceOf query token balance etherscan discloses neither source code technical detail return fake token balance moreover user cannot detect token steal transaction displayed etherscan etherscan user etherscan learns token transfer activity transfer hence mislead approach detects inconsistent behavior approach pinpoint token steal behavior locates core data structure balance information token holder monitor manipulation balance token behavior precisely balance msg sender decrease fee balance hacker increase fee respectively monitoring invocation emission approach obtains token behavior transfer transfer precisely balance msg sender decrease fee balance hacker increase fee respectively monitoring invocation emission approach obtains token behavior transfer transfer balance msg sender decrease balance increase token behavior behavior transfer transfer detect inconsistency tokenscope overview inconsistency core data structure token contract information token holder session blockchain CCS november london united kingdom token balance token holder denotes asset focus token behavior token balance denote token behavior consists series tuples holder tuple balance token holder holder denote token behavior standard interface standard respectively denote token behavior modify external transaction invokes nonstandard semantics non standard unknown execution token contract emit standard execution token contract modify external transaction invokes standard inconsistency happens external transaction invokes non standard detect inconsistency without due unknown semantics inconsistent token inconsistent behavior detect smart contract trace trace execution smart contract trigger external transaction contract invoked standard emit standard modify regard inconsistent token definition individual inconsistent contract contract interact realize token behavior stage trace mapping recognition recognition token behavior recognition comparison stage stage trace blockchain inconsistent token mapping parse parse architecture tokenscope workflow tokenscope consists stage data ethereum output inconsistent token behavior correspond token stage recovers execution trace deployed smart contract node stage trace recognize monitoring invocation standard emission standard respectively identifies trace stage output input stage trace stage recognizes monitoring modification detect inconsistency implementation tokenscope focus token balance tokenscope detects modification monitor emission transfer invocation transfer transferFrom extend tokenscope recognize token behavior allowable amount token withdrawn another account future stage trace trace contains execution smart contract external transaction trigger execution smart contract internal transaction invoke smart contract trace external transaction contract execution internal transaction contract invokes others trace namely hash correspond external transaction address transaction receiver invoked smart contract data transaction specifies invoked parameter execute EVM operation invoked smart contract tokenscope ethereum node trace node replay transaction synchronization approach obtain trace invoke api debug  ethereum node hash transaction output trace trigger transaction however easy obtain transaction hash moreover api slowly execute query transaction initialize runtime environment construct execution query transaction replay precede transaction query transaction besides apis remote procedure communicate ethereum node introduces delay trace tokenscope debug  axis synchronize genesis trace therefore trace consumption invoke debug  consumption tokenscope difference consumption becomes api debug  tokenscope trace trace tokenscope api trace consumption trace instead debug  tokenscope ethereum node trace node replay transaction synchronization trace external transaction internal transaction precisely external transaction execution smart contract insert code function  responsible execute external transaction ethereum node handler interpret EVM operation internal transaction invokes smart contract insert code handler callcode delegatecall  operation generate internal transaction invoke smart contract execute EVM operation trace insert code interpretation handler EVM operation operation operation session blockchain CCS november london united kingdom variable operation addition operation operation addend addition contract interaction identify address execute smart contract trace achieve goal maintain stack specifically handler callcode delegatecall  invoked obtain address execute smart contract item EVM stack address stack handler return tokenscope pop item stack therefore smart contract execute EVM operation belongs item stack stage core data structure core data structure token information algorithm stage trace output core data structure token behavior standard standard respectively mapping data structure choice information token holder identifier token holder amount token possess token holder stage consists tokenscope locates mapping variable contract recognizes token behavior standard standard trace analysis contract mapping variable information exclude irrelevant mapping variable correlate precisely regard mapping variable mapping item token holder specify standard standard modify standard standard reflect token transfer behavior algorithm recognition input trace output core data structure maintain token information token behavior standard token behavior standard     return algorithm inconsistency detection input trace core  maintain token information token behavior standard token behavior standard output inconsistency happens bin  null bin bin return bin mapping variable without source code mapping variable challenge explicit mapping structure EVM bytecode tackle challenge exploit mapping variable EVM bytecode mapping variable manipulate EVM operation mapping variable storage variable storage unique byte identity EVM operation sload sstore data storage respectively access mapping item sha operation identity compute location execute sha operation identity specify stack item identity identify mapping variable manually inspect source token deployed ethereum emit transfer although deployed token automatically identify mapping variable bytecode smart contract deserves another discus approach future mapping variable access addr amount mapping associate address account amount token amount mapping variable source code amount balance addr correspond EVM operation location amount sha operation identity balance addr amount storage sload location addr sha sload amount identity amount balance addr amount addr amount II addr struct mapping associate address account struct amount token possess account illustrates amount mapping source code amount balance addr amount correspond EVM operation location struct sha operation identity balance addr discover struct contiguously storage hence operation compute location amount location struct plus offset finally amount sload amount item struct operation offset data structure becomes sha sload amount offset location amount balance addr amount addr identity amount addr struct addr struct mapping associate array struct token holder historical balance item token balance data structure checkpoint item checkpoint struct checkpoint array checkpoint global variable identity storage inspect EVM array reveal identity refers storage location array array item contiguously location array item sha operation array identity EVM operation source code amount balance addr balance addr amount reading token balance presentation subscript differentiate multiple operation opcode identity array checkpoint sha operation identity balance address token holder array identity suggests location array checkpoint sload array item contiguously item offset struct checkpoint sizeof checkpoint session blockchain CCS november london united kingdom checkpoint constant pre compute compilation smart contract item offset location struct sha array identity location struct offset pinpoint location token balance sload approach handle access struct checkpoint sload sub mul item offset balance token holder modify struct token balance array sub item offset struct sizeof checkpoint amount item struct offset amount balance addr balance addr amount sha sload addr identity sha sub mul item offset offset sload amount loc item struct loc array array amount addr struct IV smart contract manage multiple token simultaneously token associate struct asset contract usually mapping variable associate address token holder index variable  asset contains mapping variable associate index struct token balance mapping variable wallet struct wallet demonstrates access balance source code amount asset wallet  addr amount location index sha operation identity  identity address token holder index sload similarly location wallet sha operation identity wallet identity index previous operation location amount compute offset location wallet finally amount sload approach handle amount item struct offset sha sload index location amount asset wallet  addr amount addr identity sha sload amount offset location index identity amount identity mapping mapping variable identity conduct def analysis leverage access mapping variable instead trace sha operation sha scenario algorithm mapping identity detail algorithm locates mapping variable EVM bytecode trace output identity mapping variable trace access algorithm mapping variable recognition input trace output identity mapping variable switch sha dep isPara manipulate dep sha getRes remove  identity wallet IV dep isPara sha dep sha getRes reset sha getRes  identity sload sstore dep isPara dep append IV dep isPara sha dep append IV dep isPara dep false  dep isPara dep  dep isPara dep append II dep isPara sha dep append remove manipulate getRes dep isPara dep getRes dep isPara sha dep dep isPara mul dep getRes array item getRes array item dep isPara sha dep getRes dep isPara sha dep getRes sub dep isPara manipulate dep sub getRes mul dep isPara sub dep mul getRes item dep isPara manipulate dep mul getRes array item return  isPara parameter null function return false  identity sha operation reset delete temporary variable dep involves EVM operation explain algorithm EVM operation trace operation sha executes function isPara applies def analysis parameter trace null isPara return false hence skip manipulate sha null function reset deletes temporary variable dep mapping variable detect another mapping variable execute reset sha denote sha obtain function getRes identity mapping variable denote obtain function  identity checked getRes  parse trace parameter execution EVM operation already trace session blockchain CCS november london united kingdom sload execute algorithm conduct skip sha null sha parameter sload return mapping variable sload manipulate obtain sub execute algorithm parameter manipulate sub sub mul execute algorithm sub parameter mul mul obtain mul actually offset item array sha execute algorithm parameter another sha sha sha location item array execute conduct skip null algorithm parameter sha mul location array item execute algorithm parameter location token balance finally sload execute token balance algorithm parameter sload access sub hence algorithm identifies inside parse standard analyze transfer transferFrom transfer token accord semantics define erc token standard detail monitor invocation transfer omit processing transferFrom transfer define function transfer address uint public return bool allows transaction sender transfer token token holder therefore tuples sender external internal transaction invoke smart contract handle separately handle external transaction insert code function   execute smart contract obtain transaction sender parameter  parameter handle internal transaction interpretation handler callcode delegatecall  instrumentation  interpretation handler handler  invokes env execute smart contract obtain transaction sender parameter env acquire parameter parse standard tokenscope interprets transfer accord semantics define erc operation trace operation responsible emit operation byte operation ID unique ID hash signature transfer accord ID recognize transfer tuples operation respectively recognize core data structure token contract multiple mapping variable distinguish information token holder irrelevant mapping variable correlate modification mapping variable standard interface transfer precisely exists trace modification mapping variable accordant standard interface transfer regard mapping variable detail correlate transfer omit correlation standard interface transfer address sender receiver token mapping variable item correspond address modify mapping variable token contract illustrate tokenscope distinguishes balance irrelevant mapping variable victim transfer address msg sender mapping variable balance victim balance mapping msg sender respectively update transfer execute therefore regard balance contrast victim mapping correspond msg sender update victim algorithm recognition input trace output core data structure maintain token information token behavior standard token behavior standard     return algorithm inconsistency detection input trace core  maintain token information token behavior standard token behavior standard output inconsistency happens bin  null bin bin return bin stage detect inconsistent behavior algorithm trace output stage stage detects inconsistency namely recognize token behavior monitoring modification token behavior recognition tuples holder trace stage mapping variable exploit access presentation execution transfer tokenscope tuples msg sender fee hacker fee detect balance token holder sha operation identity address token holder trace sha sstore session blockchain CCS november london united kingdom def analysis tuple     sstore respectively balance account modify trace sha tuples     trace modification account balance comparison external transaction invokes standard inconsistency external transaction invokes non standard semantics non standard unknown inconsistency reconsider assume external transaction invokes standard transfer msg sender however msg sender fee hacker fee therefore tokenscope detects inconsistent behavior token inconsistent token address handle transfer address token behavior address address token contract address account creates token contract token creator transfer transfer address address uint token contract address token mint similarly token contract address token burning modify balance possess address avoid false positive detect inconsistent behavior mismatch balance address mismatch inconsistency EXPERIMENTS evaluate tokenscope launch ethereum jul aug obtain deployed smart contract external transaction trace transaction smart contract token inconsistent token adopt transaction trigger inconsistent behavior denote opensource token source inconsistent token transaction trigger inconsistent behavior source inconsistent token tokenscope detects token token inconsistent inconsistent behavior trigger transaction inconsistent token source code etherscan token adopt token token inconsistency execute standard token inconsistency execute nonstandard moreover token inconsistency standard non standard token  coin token  ethereum  token  token   token  token inconsistent token transaction II IV sum deployment deployment inconsistent token indicates inconsistent token deployed deployment inconsistent token inconsistent token deployed nov nearly debut ethereum erc propose nov formally adopt sep revision inconsistent token deployed finalization erc moreover inconsistent token increase steadily remark inconsistent token finalize erc gap description erc understand token developer  token nov sep aug deployment inconsistent token exchange token centralize exchange decentralize exchange display token aggregate centralize decentralize separately aggregate denote token inconsistent token respectively obtain token centralize website centralize usually maintain token inconsistent token centralize website address inconsistent token adopt decentralize exchange DEXs DEXs maintain token precisely crawl webpage decentralize exchange tracker transaction DEXs parse transaction address token decentralize exchange inconsistent token decentralize exchange address token address inconsistent token token inconsistent inconsistent token exchange token centralize decentralize session blockchain CCS november london united kingdom remark inconsistent token incur severe financial consequence inconsistent token token exchange centralize exchange decentralize exchange       etherdelta token  network standard token inconsistency source inconsistency source standard realize token token transfer via multiple contract classify token source token inconsistent token source inconsistent token accord standard implement erc implement standard interface token implement standard token implement standard investigate source code bytecode trace transfer token via multiple contract developer deploy token contract implement standard token interface library lib developer token contract customize functionality load lib invokes standard interface implement lib transfer token tokenscope recognize token transfer token multiple contract handle contract interaction trace analysis moreover token standard inconsistent token develop token consist multiple contract inconsistent token detect tokenscope contract  load another contract library implement standard interface  executes code manipulate tokenscope detects inconsistency emit transfer transfer token tokenscope considers contract inconsistent token former latter modifies besides load library token transfer inter contract invocation inconsistent token trace execution smart contract EOA invokes withdrawToken contract etherdelta withdrawToken invokes transfer contract  emits transfer besides invokes transfer contract controller   standard lib   standard load lib   standard interact inconsistent token transfer contract ledger latter transfer manipulates execution contract ledger controller  contract  emits transfer recent online discussion disclose  version  version emits transfer token withdrawn etherdelta approach discovers inconsistency transfer emit twice etherdelta withdrawToken  transfer transfer controller transfer ledger transfer   transfer inconsistency contract analysis precision tokenscope define precision ratio inconsistent token inconsistent token discover tokenscope false positive refers token contract complies erc regard inconsistent tokenscope mistakenly due incorrect computation evaluate precision tokenscope manually source inconsistent token detect tokenscope false positive  hence precision manual inspection reveals   address contract address access location mapping hardcoded address pre compute compilation optimization consequently sha contract bytecode compute location tokenscope  access balance token holder hardcoded mistakenly report inconsistency balance hardcoded address modify due lack sha screen  whitepaper inconsistent token describes inconsistency inconsistency severe consequence user aware inconsistency reading whitepaper evaluate inconsistent token detect tokenscope filter  without false positive mention  opensource inconsistent token internet official website token whitepaper collection website forum successfully  reading  token behavior detail token fee token session blockchain CCS november london united kingdom  whitepaper mention inconsistency authority notify generate blockchain notify central authority instead transfer tokenscope considers  inconsistent token analysis exist  attention inconsistency screen standard tokenscope detect inconsistency token contract emits standard define token standard non standard semantics define erc inconsistency introduce serious user aware inconsistency reading token standard source inconsistent token tokenscope detects inconsistent behavior token token emit erc transfer transfer define erc standard prototype transfer address address uint byte data erc transfer erc transfer prototype tokenscope identifies token emit erc transfer detects inconsistent behavior token emit erc transfer token extend tokenscope token standard future inconsistent token due define erc token token address  ethereum     club     token     coin token  ethereum  token    another standard erc standard hardcoded optimize bytecode token token address  ethereum     club     token     coin token  ethereum  token  token   token  token inconsistent token transaction II IV sum vet token deployment although tokenscope focus detect inconsistent behavior ethereum easily extend discover inconsistent token deployment equip exploration technique symbolic execution fuzzing generate trace demonstrate feasibility develop  integrates tokenscope contractfuzzer source fuzzing discover security vulnerability smart contract detect inconsistent token contractfuzzer EVM security vulnerability trigger target smart contract generate input transaction private chain equip customize EVM  reuses code generate transaction contractfuzzer replaces EVM contractfuzzer EVM tokenscope trace reuses code detect inconsistent behavior tokenscope evaluate  manually identify inconsistent token source token expose inconsistent behavior tokenscope discover inconsistent behavior worth mention inconsistent token  due contractfuzzer private chain consume purpose demonstrate tokenscope extend vet token contract deployment enhance  capability boost performance future experimental  discovers inconsistent token token integer overflow bug token emit standard modify detailed manually inspect undiscovered inconsistent token issue code trigger account code trigger another already execute contractfuzzer randomly generates input trigger integer overflow evaluate  discover inconsistent token issue account invoke token contract properly modify input generation strategy contractfuzzer desire  successfully discover inconsistent token remark tokenscope easily extend discover inconsistent token token deployment inconsistent behavior trigger equip exploration component investigate future inconsistency description flaw token incorrect implementation standard emission manipulation incorrect invocation unnamed standard invoked lack modification token contract emit standard modify fee code fee implement standard nonstandard without implementation standard token mint code token mint implement standard non standard without implementation standard token burning code token burning implement standard non standard without implementation standard token purchase account token eth invoke standard nonstandard without implementation standard token account token eth invoke standard nonstandard without implementation standard conversion convert token code conversion implement standard non standard without implementation standard account balance specify account account standard interface standard modify amount specify amount token amount standard interface standard transfer http  ethereum org  eip http github com ethereum  issue http github com ethereum  issue http github com ethereum  issue http github com ethereum  issue http github com ethereum  issue http github com ethereum  issue http github com ethereum  standard erc standard interface optional standard interface standard standard  inconsistent  manually investigate source inconsistent token reveal inconsistency sub category explain inconsistent token inconsistency inconsistent token inconsistent token denote token correspond category inconsistent token deployed ethereum invoked purchase transfer account session blockchain CCS november london united kingdom flaw token flaw token implement standard emission manipulation incorrectly flaw token classify knowledge flaw token unreported flaw token http tokenscope due limit incorrect implementation transfer various error implement transfer incorrect account duplicate consequence confusion user cannot token behavior transfer flaw token incorrect account transfer semantics transferFrom modification token sender therefore implementation transfer transfer instead another token emits transfer twice invocation transfer token holder confuse transfer token transfer invoke transfer function transfer address uint public  balanceOf msg sender balanceOf msg sender sub balanceOf msg sender balanceOf balanceOf transfer msg sender return return false function transferFrom address address uint return bool balanceOf balanceOf  msg sender transfer msg sender function transfer address uint return bool transfer msg sender balance msg sender balance msg sender balance transfer msg sender return return false function transferFrom address address uint balanceOf SafeMath sub balanceOf balanceOf SafeMath balanceOf  return function transfer address receiver uint amount  msg sender receiver amount UserBalances msg sender sub UserBalances msg sender amount UserBalances receiver UserBalances msg sender amount transfer msg sender receiver amount return function transfer address  uint    SafeMath sub    transferFrom    incorrect implementation transfer function transfer address uint public  balanceOf msg sender balanceOf msg sender sub balanceOf msg sender balanceOf balanceOf transfer msg sender return return false transferFrom address address uint return bool balanceOf balanceOf  msg sender transfer msg sender function transfer address uint return bool transfer msg sender balance msg sender balance msg sender balance transfer msg sender return return false flaw token emits transfer twice inform eth transfer instead token transfer transfer inform token transfer token contract inform eth transfer account transfer eth another account user confuse token transfer transfer incorrect implementation manipulation flaw token incur serious consequence financial loss flaw manipulation incorrect balance unexpected account flaw token token contract balance receiver incorrect balance receiver msg sender hence UserBalances receiver UserBalances receiver amount token contract reduces balance token sender twice invocation standard transfer specifically balance reduce standard transferFrom invoked reduces balance token subtle flaw variable  token balance token balance subtraction  balance however token balance decrease due subtle implementation error return return false function transferFrom address address uint balanceOf SafeMath sub balanceOf balanceOf SafeMath balanceOf  return function transfer address receiver uint amount  msg sender receiver amount UserBalances msg sender sub UserBalances msg sender amount UserBalances receiver UserBalances msg sender amount transfer msg sender receiver amount return flaw token incorrect balance return return false function transferFrom address address uint balanceOf SafeMath sub balanceOf balanceOf SafeMath balanceOf  return function transfer address receiver uint amount  msg sender receiver amount UserBalances msg sender sub UserBalances msg sender amount UserBalances receiver UserBalances msg sender amount transfer msg sender receiver amount return function transfer address  uint    SafeMath sub    transferFrom    flaw token reduces token balance twice function transferFrom address address uint uint  balance balance safeAdd balance balance   flaw token subtle error function transferFrom address address uint uint  balance balance safeAdd balance balance   function transfer address uint public return bool token balance balance token balance owner balance owner token emit transfer owner token flaw token integer overflow bug integer overflow EVM integer maximum integer overflow happens operation maximum wraparound token contract uint unsigned integer EVM token balance incorrect integer overflow happens integer overflow become threat security smart contract severe consequence price token exchange suspend token deposit  inconsistent token integer overflow bug invoke transfer balance owner token overflow consequently token balance owner increase subtraction incorrect invocation inconsistent token user attempt invoke standard interface however unnamed invoked standard implement EVM unnamed invoked transaction specify invoked invoked implement contract consequently user confuse intend standard unnamed inconsistency incur serious security token steal token frozen detailed lack transfer modification tokenscope detects inconsistent token otherwise lack inconsistency inconsistent token lack standard emission hinders token behavior session blockchain CCS november london united kingdom user token balanceOf token balance lack manipulation indicates token transfer consequently user confuse transfer informs token transfer KYC casper token report recent news belongs category inconsistent token neither manipulate emit transfer execute standard exchange detect token behavior monitoring invocation standard interface incorrectly token transfer happens issue fake deposit detect tokenscope execute comparison return false standard transfer executes without modify emit standard function transfer address uint public  balanceOf msg sender balanceOf msg sender sub balanceOf msg sender balanceOf balanceOf transfer msg sender return return false inconsistency fee token contract fee token holder fee token contract token creator account specify token creator inconsistent behavior happens code fee standard non standard without implementation standard inconsistent token due token holder msg sender intend transfer token token holder invoke transfer balance msg sender decrease however fee token transfer remain token fee another token holder feeWallet token emits transfer faithfully reflect token behavior approach detects inconsistency account invokes transfer intend transfer feeWallet function transfer address uint public return bool address balance msg sender balance msg sender sub balance balance sub fee balance feeWallet balance feeWallet fee transfer msg sender sub fee transfer msg sender feeWallet fee return inconsistency incur fee token mint token mint increase amount token circulation code token mint standard non standard without implementation standard inconsistency happens detect token mint accord precisely trace sum token token holder balance increase similarly sum absolute token token holder balance decrease summation token mint happens reconsider contract balance hacker increase fee respectively summation fee balance msg sender decrease fee hence summation token mint happens contract inconsistent token due token mint classify token minor category inconsistent token belonging sub category reward token contract implement various strategy reward user amount token token reward account token contract subsidy ethereum transaction sender transaction fee eth prevent resource abuse attract user invoke token contract token contract user amount token subsidy transaction fee donation token contract donate amount token specify account invocation token contract token migration token developer deploy version token contract blockchain substitute version fix bug deployment contract contract migrate data contract address token holder amount token possess token holder without migration user token lose unlock founder token contract lock proportion token increase confidence user lock token cannot circulate neither transfer user lock token unlocked met lock expire token unlock token mint unlocked token deployed inconsistent token due subsidy donation token holder intend transfer token token holder invoke transfer transfer accordant transfer token contract sends token msg sender subsidy  token account donation contract emits non standard donation however semantics donation unclear consequently transaction sender occurrence token donation leverage wallet sender balance msg sender decrease token hence transaction sender confuse sender intend token token invoke transfer function transfer address uint public return bool address balance msg sender balance msg sender sub balance balance sub fee balance feeWallet balance feeWallet fee transfer msg sender sub fee transfer msg sender feeWallet fee return function transfer address uint token public return bool address donation  msg sender balance msg sender balance msg sender sub token balance balance token balance donation balance donation emit transfer msg sender token emit donation donation return inconsistency due subsidy donation session blockchain CCS november london united kingdom token burning token burning decrease amount token circulation detect inconsistency code token burning standard non standard without implementation standard detect token burning approach detect token mint token burning happens summation inconsistent token due token burning classify sub category token contract fee fee account fee disappears token transfer reclaim token contract token token address address token contract address token creator account specify token creator token contract intend reclaim token deployed inconsistent token due reclaim token contract super transferFrom transfer token account account token contract token token contract transfer token although token contract emits non standard destruction semantics unclear transaction sender token burning function transfer address uint public return bool address balance msg sender balance msg sender sub balance balance sub fee balance feeWallet balance feeWallet fee transfer msg sender sub fee transfer msg sender feeWallet fee return function transferFrom address address uint assert super transferFrom address balanceOf  destruction return inconsistency incur reclaim token purchase token contract automatic token purchase without interference exchange token contract amount token account eth token contract accord exchange rate implement token contract inconsistent behavior occurs code token purchase standard non standard without implementation standard inconsistent token due token purchase inconsistent token due token purchase transaction sender msg eth purchase qiuAmount token token contract sends qiuAmount token msg sender emits non standard consequence inconsistency although user token balance invoke standard balanceOf balance increase semantics non standard unclear token token contract eth possess account threshold token contract amount token account amount eth account accord exchange rate implement function transferFrom address address uint assert super transferFrom address balanceOf  destruction return function  payable public return bool uint qiuAmount msg  qiuAmount balance balance balance sub qiuAmount balance msg sender balance msg sender qiuAmount  msg sender qiuAmount msg return inconsistency incur token purchase token contract token incur inconsistency code token standard nonstandard without implementation standard inconsistent token due token deployed inconsistent token due token eth possess token receiver threshold  amount token  compute accord exchange rate   token transfer account specify token creator account receives   eth token behavior troublesome account convert token another account eth transfer token function transfer address uint public return bool address balance msg sender balance msg sender sub balance balance sub fee balance feeWallet balance feeWallet fee transfer msg sender sub fee transfer msg sender feeWallet fee return function transferFrom address address uint assert super transferFrom address balanceOf  destruction return function  payable public return bool uint qiuAmount msg  qiuAmount balance balance balance sub qiuAmount balance msg sender balance msg sender qiuAmount  msg sender qiuAmount msg return function transfer address address uint internal balance  uint   balance  transfer owner  transfer   transfer inconsistency incur token conversion token contract specify token token conversion inconsistency code conversion standard non standard without implementation standard detect inconsistent token due transfer informs user   receives token token however token convert token transfer token consequently user confuse user token balance significantly amount inform transfer balance invoke balanceOf category address invoked description USD involve function callback byte  balance owner token balance   token transfer owner   token function balanceOf address sender constant return uint balance return balance sender inconsistency incur conversion account token contract account token instead account specify standard interface standard due transaction sender intend transfer token session blockchain CCS november london united kingdom account invoke transfer another account satisfied consequently transaction sender upset token account intend category address invoked description USD involve function callback byte  balance owner token balance   token transfer owner   token function balanceOf address sender constant return uint balance return balance sender function transfer address uint  deposit address   uint  transfer msg sender inconsistency incur account specify amount token contract amount transfer token amount standard interface standard token transfer however user cannot monitoring invocation standard interface inconsistent token due amount specify transaction sender intend transfer token however transfer amount restrict  satisfied consequently transaction sender confuse transfer amount intend amount category address invoked description USD involve function callback byte  balance owner token balance   token transfer owner   token function balanceOf address sender constant return uint balance return balance sender function transfer address uint  deposit address   uint  transfer msg sender function transferFrom address address uint startTime   safeAdd    transfer return inconsistency incur amount specify cumulative distribution function plot opensource inconsistent token flaw token indicates inconsistent flaw token external transaction trigger exploit inconsistency flaw inconsistent token flaw token external transaction trigger exploit inconsistency flaw inconsistent token execute inconsistent behavior frequently flaw token exploit frequently inconsistent behavior  trigger external transaction hydro token flaw token exploit external transaction detailed STUDIES inconsistent token hydro smt ZXBT GTN  club  hydro implementation flaw transferFrom smt contains integer overflow bug inconsistent token due incorrect invocation attack transaction inconsistent token flaw token inconsistency flaw CDFs source inconsistent flaw token accord trace analysis serious consequence incorrect token balance token frozen token steal GTN external transaction hydro token contract account posse hydro token attacker steal hydro token exchange standard transferFrom contains bug inconsistency token behavior standard transfer token however token behavior account invokes transferFrom msg sender transfer token function transferFrom address address uint uint  balance balance safeAdd balance balance   function transfer address uint public return bool token balance balance token balance owner balance owner token emit transfer owner token function  address address uint uint feeSmt balance feeSmt revert balance transfer balance msg sender feeSmt transfer msg sender feeSmt balance feeSmt function transferFrom address address uint transfer msg sender transfer msg sender return function transfer address address uint internal balance balance code snippet hydro token function  address token uint amount token token token transferFrom msg sender amount token token msg sender safeAdd token token msg sender amount deposit token msg sender amount token token msg sender function withdrawToken address token uint amount token token token msg sender amount token token msg sender  token token msg sender amount token token transfer msg sender amount withdraw token msg sender amount token token msg sender code snippet etherdelta invocation transferFrom another smart contract etherdelta belongs etherdelta etherdelta popular exchange external transaction etherdelta user deposit withdraw various token invoke  withdrawToken etherdelta  token deposit withdrawn specify address amount specify amount  invokes transferFrom hydro token contract transfer amount token account invokes  msg sender etherdelta contract due flaw implementation hydro token contract token behavior etherdelta contract account deposit hydro token transfer amount token etherdelta contract account transaction invoke  etherdelta contract transferFrom hydro token contract transaction deposit billion hydro token withdraw token user invokes withdrawToken transfer amount token etherdelta contract user session blockchain CCS november london united kingdom etherdelta hydro etherdelta storage hydro attacker storage etherdelta storage hydro attacker etherdelta attacker token transfer token steal attacker attack  hydro attacker withdrawToken hydro steal hydro attacker steal hydro token etherdelta contract etherdelta exchange invoke  invoke withdrawToken hydro token steal external transaction account attack assume attacker hydro token etherdelta hydro token attack hydro contains item correspond etherdelta attacker invokes  parameter hydro transfer hydro token attacker etherdelta etherdelta token deposit behavior storage due implementation flaw transferFrom etherdelta instead attacker transfer hydro token etherdelta token transfer happens attacker invokes withdrawToken withdraw hydro token etherdelta etherdelta update correspond hydro contract transfer token etherdelta attacker consequently attacker steal hydro token etherdelta smt smt integer overflow bug deployed blockchain dec attack exploit bug apr report attack publish apr  contains integer overflow bug token balance decrease feeSmt posse sufficient token however summation feeSmt overflow feeSmt consequently summation due integer overflow account msg sender amount token function transferFrom address address uint uint  balance balance safeAdd balance balance   function transfer address uint public return bool token balance balance token balance owner balance owner token emit transfer owner token function  address address uint uint feeSmt balance feeSmt revert balance transfer balance msg sender feeSmt transfer msg sender feeSmt balance feeSmt code snippet smt token tokenscope detects transaction transaction hash   exploit vulnerability attack account msg sender account balance account attack attack transaction feeSmt integer respectively hence summation feeSmt due integer overflow attack balance becomes balance msg sender ZXBT token contract implement standard transfer consequently user attempt invoke transfer unnamed invoked instead ZXBT etherdelta deploys etherdelta manage token due implementation issue ZXBT user token frozen user neither withdraw ZXBT code etherdelta user invokes  deposit ZXBT etherdelta invokes withdrawToken withdraw ZXBT etherdelta implementation transferFrom token contract user successfully deposit ZXBT etherdelta however user cannot withdraw ZXBT etherdelta invokes unnamed transfer token transfer ZXBT frozen worth USD ZXBT deposit GTN contract implement standard transferFrom therefore user attempt invoke transferFrom unnamed invoked GTN token etherdelta consequently  transfer GTN etherdelta invokes unnamed transferFrom however etherdelta aware implementation issue token contract GTN hence mistakenly user deposit GTN etherdelta invoke withdrawToken user withdraw GTN although user deposit GTN hence attacker exploit implementation flaw steal GTN etherdelta account successfully exploit issue steal GTN etherdelta besides GTN attacker   club  etherdelta due discussion discus limitation tokenscope potential token standard focus standard interface transfer transferFrom standard transfer define erc fortunately compatible erc avoid conflict erc standard typically transfer transferFrom transfer define erc extend tokenscope standard erc token standard future deliberate evasion smart contract deliberately evade detection tokenscope data structure instead recognize tokenscope however deliberately craft data structure complicate implementation token contract increase deploy invoke token investigate automatically infer data structure access future automatic inference storage location balance derive address token sender token receiver token transfer monitoring access storage location access infer data structure conduct program slice extract operation related storage session blockchain CCS november london united kingdom modification identify access slice another evasion approach disperse typical token behavior token transfer perform token behavior external transaction invoke external transaction trigger typical token behavior tokenscope false positive detects inconsistency per trace correspond external transaction improve tokenscope conduct transaction analysis future related token analysis identify token transfer parse transfer necessarily reflect token behavior difference  described  maintains collection buggy erc token mainly focus token weak access inconsistency inconsistent token detect tokenscope disclose vulnerability discovery  detects bug solidity source code bug cannot easily extend detect inconsistency EVM bytecode source code smart contract detection inconsistency understand program semantics  detects security bug formal semantics EVM bytecode vandal  EVM bytecode semantic logic relation detects security express logic specification madmax detects security vandal bytecode decompilation  taint analysis EVM smart contract reentrancy attack  transaction symbolic execution SE exploit vulnerability smart contract  combine SE taint analysis discover integer overflow bug EVM bytecode  integrates fuzzing sequence SE contract output sequence  applies SE critical involve transfer leaf unexplored huang detects security EVM bytecode via capability discover security bug  achieves accuracy contractfuzzer applies fuzzing discover security detect reentrancy bug focus callback smart contract summary technique focus vulnerability discovery security vulnerability inconsistent token behavior violate erc analysis platform framework formal semantic  detect inconsistency standard semantics standard interface however framework fully automate apply inconsistency user identity specification differently approach locates automatically framework developer token contract specification analyze non standard semantics unknown differently approach automatically detect inconsistency non standard propose infer bound upper bound variable propose contract incorrect interval bound upper bound however suffer false negative incorrect interval moreover inference non trivial understand analyze contract semantics EVM operation propose formal semantics EVM EVM bytecode facilitate correctness verification automate verifier securify  EVM bytecode domainspecific DSL express security analyzes smart contract security securify recover variable decompilation hence cannot token contract besides DSL express inconsistency unknown zeus security verifier source code smart contract convert specification  code insert code source code smart contract zeus translates modify source code intermediate applies abstract interpretation symbolic model security applicability zeus restrict source smart contract account contract contrast approach directly EVM bytecode moreover  express inconsistency unknown conclusion inconsistent behavior mislead user severe financial loss frozen steal propose novel approach develop tokenscope automatically detect inconsistent behavior token deployed ethereum information source manipulation core data structure action standard interface behavior standard apply tokenscope inspect transaction deployed token transaction trigger inconsistent behavior inconsistent token precision investigation source inconsistent token reveals inconsistency unreported flaw token