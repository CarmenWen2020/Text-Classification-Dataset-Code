correlation core technique multitude  attack tor despite importance correlation attack tor exist correlation technique  unreliable link tor ows apply impose rate false positive error rate impractically observation reliable correlation unfortunately correlation attack conduct tor trac drastically accuracy leverage emerge mechanism particularly DeepCorr outperforms signi cant margin correlate tor connection DeepCorr leverage advanced architecture correlation function tailor tor complex network contrast previous generic statistical correlation metric correlate tor ows moderate DeepCorr correlate tor connection therefore anonymity accuracy signicantly exist algorithm substantially shorter observation instance packet target tor roughly KB tor data DeepCorr correlation accuracy raptor demonstrates escalate threat correlation attack tor recent advance algorithm timely deployment eective countermeasure tor community CCS CONCEPTS information trac analysis security privacy pseudonymity anonymity untraceability privacy preserve protocol network network privacy anonymity keywords trac analysis tor correlation attack anonymous communication introduction tor widely anonymity daily user anonymity relay client trac cascade relay onion circuit therefore conceal association IP address communicate tor network comprises around public relay terabyte trac tor widely  journalist  business ordinary citizen achieve anonymity resistance usable everyday internet activity web browsing tor aim latency communication tor relay refrain obfuscate trac feature packet timing connection consequently tor susceptible correlation attack adversary link egress ingres tor connection trac characteristic packet timing packet correlation attack tor correlation core technique spectrum attack tor anonymity instance predecessor attack adversary  multiple tor relay attempt  tor connection apply correlation technique tor project adopt guard relay limit adversary target tor connection demonstrate active denial service attack increase adversary target user tor connection performs correlation alternatively various rout attack tor aim increase adversary odds intercept ows correlate manipulate rout decision despite critical role correlation multitude tor attack correlate tor connection  anymore tor relay actively manipulate packet timing resist correlation tor network naturally perturbs tor packet signicant amount render correlation tor bridge public relay obfuscate trac characteristic tor ows censor client various tor pluggable transport session tor CCS october toronto canada dicult tor specically tor connection network jitter signicantly normal internet connection perturbation congestion tor relay due imbalance tor capacity bandwidth demand client consequently exist correlation technique  rate false positive accuracy unless apply observation impractically target ows instance correlation raptor achieves correlation performance distinguish target connection collection MB trac intercept ows correlation attack tor reality develop correlate tor ows accuracy signicantly apply anonymity observation tor connection argue exist correlation technique  correlate tor trac generic statistical correlation algorithm capture dynamic complex tor oppose purpose statistical correlation algorithm correlation function tailor tor ecosystem correlation DeepCorr correlation function correlate tor ows contrary website ngerprinting attack DeepCorr target destination target circuit instead DeepCorr learns correlation function link ows arbitrary circuit arbitrary destination DeepCorr correlate tor connection connection destination DeepCorr correlate ows tor circuit dierent circuit DeepCorr neural network learns generic feature tor regardless specic circuit host training demonstrate DeepCorr performance tor network browse alexa website tor evaluate DeepCorr positive false positive rate correlate ingres egress tor connection knowledge dataset dataset correlate tor ows available public DeepCorr correlate tor ows accuracy signicantly superior exist correlation technique instance correlation algorithm raptor DeepCorr oers correlation accuracy raptor accuracy packet trac intercept ows highlight DeepCorr performance http uma edu amir  html comparison raptor derive accuracy metric raptor evaluate ows declare correlate arbitrary intercept ows realistic challenge DeepCorr tor ows generate training DeepCorr titan gpu however adversary DeepCorr roughly preserve correlation performance DeepCorr generic correlation function DeepCorr performance consistent various datasets dierent ows rout dierent circuit DeepCorr outperforms prior correlation algorithm margin importantly DeepCorr enables correlation tor ows observation shorter previous instance packet DeepCorr achieves positive rate prior xed false positive rate DeepCorr performance rapidly improves longer observation training DeepCorr correlation signicantly faster previous target accuracy instance DeepCorr correlation raptor target accuracy identical dataset concern community escalate risk trac analysis tor communication emerge algorithm countermeasure DeepCorr deploy trac obfuscation technique employ tor pluggable transport tor trac evaluate performance DeepCorr tor currently deployed pluggable transport  obfs iat protection DeepCorr correlation obfs iat protection DeepCorr none obfuscation mechanism currently deployed public tor relay obfs iat deployed tor bridge eective trac obfuscation mechanism deployed tor relay impose bandwidth performance overhead tor communication finally DeepCorr correlation attack tor correlate ows correlation application demonstrate apply DeepCorr detection DeepCorr signicantly outperforms previous detection algorithm unreliable network setting organization organize overview preliminary correlation motivate introduce correlation DeepCorr experimental setup discus experimental discus evaluate countermeasure DeepCorr conclude PRELIMINARIES motivation correlation attack refer  attack link network ows presence encryption content obfuscation mechanism session tor CCS october toronto canada correlation technique anonymity anonymous communication tor network link egress ingres anonymous connection correlate trac feature alternatively correlation technique identify cybercriminals network proxy obfuscate identity attacker threat model correlation scenario consists computer network tor network ingres ows egress ows egress ows obfuscate version ingres ows however relation ows detect packet content due encryption content obfuscation technique onion encryption instance tor entry exit tor connection however association detect inspect packet content due onion encryption associate ows goal adversary identify associate  characteristic packet timing across ingres egress ows link associate trac characteristic correlation correlation adversary intercept network ows various network location tor adversary intercept tor ows malicious tor relay wiretapping internet ASes IXPs elaborate passive correlation attack therefore active correlation technique watermark introduce scope correlation dierent website ngerprinting attack exist correlation technique mention correlation technique trac feature particularly packet timing packet variant rate inter packet delay etc correlate link network ows recall packet content link ows due content obfuscation onion encryption instance  zhang model packet arrival series correlate network ows correlate aggregate network packet exist correlation technique mainly standard statistical correlation metric correlate vector timing across ows overview statistical correlation metric previous correlation algorithm mutual information mutual information metric dependency random variable therefore quantify correlation feature across ows trac feature egress tor depends feature correspond ingres mutual information technique link ows metric however vector feature ows reliable decision reconstruct empirical distribution trac feature target ows pearson correlation pearson correlation coecient classic statistical metric linear correlation random variable unlike mutual information metric pearson correlation metric empirical distribution variable correlate therefore apply shorter data pearson correlation metric correlation cosine similarity cosine similarity metric angular similarity random variable pearson coecient directly apply sample vector random variable metric dierent timing correlation link network ows spearman correlation spearman rank correlation metric statistical dependence ranking variable metric dened pearson correlation ranked variable recent raptor metric correlate tor ows correlation attack tor correlation core technique attack tor anonymity perform correlation adversary intercept ows exit tor network adversary deanonymize specic tor connection intercept ingres egress tor connection perform correlation algorithm therefore adversary increase  tor connection intercept tor ingres egress ows approach attacker increase tor connection intercept tor relay trac feature tor connection relay various adversary access malicious relay increase intercept tor connection dierent instance demonstrate active denial service attack increase intercept ingres egress target client tor trac tor project adopt concept tor guard relay reduce perform correlation adversary malicious relay attack predecessor attack alternatively adversary increase opportunity perform correlation wiretapping autonomous ASes internet exchange IXPs trac feature tor connection transit demonstrate specic ASes IXPs intercept signicant tor trac therefore capable perform correlation tor others adversary increase correlation perform various session tor CCS october toronto canada correlation attack tor adversary intercept tor ows malicious tor relay wiretapping internet ASes IXPs rout manipulation reroute tor connection adversarial ASes IXPs instance recently approximately tor circuit vulnerable correlation attack malicious churn bgp active manipulation bgp update amplify adversarial visibility tor connection various proposal deploy aware selection mechanism tor contribution correlation core multitude attack tor exist correlation algorithm assume  link tor connection reliably due tor extremely noisy network applies perturbation tor ows therefore render trac feature across associate ingres egress tor ows reliably correlate tor network applies network jitter tor ows due congestion tor relay tor packet fragment  due unreliable network consequently exist correlation technique oer correlation performance unless apply observation unrealistically target ows instance correlation technique MB trac target around perform reliable correlation observation impractical due typical tor connection web browsing session impose  storage requirement apply malicious tor relay likely  concurrent ows moreover exist technique  active attack scope attack easily detectable therefore deployed adversary without detect rate false positive correlation unless apply unrealistically suspect ows correlate target ows approach  exist correlation technique intensity unpredictability network perturbation tor argue previous correlation technique  correlate tor trac purpose statistical correlation algorithm capture dynamic complex tor oppose generic statistical correlation metric correlation function tailor tor ecosystem correlation DeepCorr learns correlation function tor function correlate tor connection contrary website ngerprinting attack DeepCorr target destination target circuit instead DeepCorr learns correlation function link ows arbitrary circuit arbitrary destination DeepCorr correlate tor connection connection destination DeepCorr correlate ows tor circuit dierent circuit training demonstrate DeepCorr correlation performance tor network previous correlation technique concern community increase risk trac analysis tor emerge algorithm discus potential countermeasure evaluate DeepCorr performance exist countermeasure related topic scope active correlation watermarking network watermarking active variant correlation technique introduce passive correlation scheme watermarking aim link network ows trac feature session tor CCS october toronto canada persist content obfuscation packet timing contrast watermarking manipulate trac feature ows intercept perform correlation watermarking perturb packet timing intercept ows slightly delay network packet modulate  ows watermark instance rainbow manipulates inter packet delay network packet embed watermark signal proposal interval watermark delay packet secret interval passive correlation attack information theoretically undetectable watermarking adversary reveal apply trac perturbation  normal trac active correlation technique aim invisibility therefore trivially detect disabled unsuitable correlation additionally passive correlation algorithm compute oine watermark perform resourceful adversary apply trac manipulation tor connection focus passive correlation technique website fingerprint website ngerprinting attack dierent threat model correlation technique website ngerprinting adversary intercept target client ingres tor trac wiretapping link tor client guard relay intercept ingres tor connection trac   usually target website unlike correlation attack adversary intercept anonymous connection enable attacker deanonymize arbitrary sender receiver exist website ngerprinting leverage standard machine algorithm svm knn classify identify target website recent investigate website ngerprinting contrary  prior passive correlation technique statistical correlation metric link trac characteristic across network ows website ngerprinting orthogonal dierent threat model technique  DeepCorr introduce correlation DeepCorr algorithm correlation function feature representation exist correlation technique  earlier correlation timing network ows correlate advantage algorithm conventional technique model raw data feature oppose engineer trac feature svm knn website ngerprinting technique extract complex eective feature raw input feature therefore DeepCorr raw feature input derive complex feature correlation function bidirectional network array vector inter packet delay IPD vector packet superscript upstream downstream bidirectional vector upstream  rst vector rst upstream  vector pad append zero representation suppose aim correlate ows intercept malicious tor guard relay intercept  exit relay ows dimensional array compose array representation network architecture convolutional neural network cnn correlation function tor noisy network cnn network feature model series cnns performance series cnns invariant data ideal possibly shift trac structure DeepCorr cnn network network input DeepCorr architecture compose layer convolution layer fully neural network rst convolution layer kernel hyperparameters stride intuition rst convolution layer capture correlation adjacent input matrix suppose correlate associate tor ows DeepCorr convolution layer aim capture trac feature combination timing feature layer DeepCorr kernel hyperparameters stride output convolution layer  fed fully network layer DeepCorr max pool layer convolution ensure permutation invariance avoid overtting finally output network rst mechanism correlation eective mechanism correlation various algorithm fully neural network recurrent neural network rnn vector machine svm however cnn correlation performance algorithm investigate intuitively cnns longer data instance achieve accuracy neural network signicantly performance cnns session tor CCS october toronto canada network architecture DeepCorr input ows correlate normalize output network apply sigmoid function output zero therefore probability ows associate correlate entry exit tor connection DeepCorr declares ows correlate detection threshold parameter hyperparameters tune training network tor associate non associate associate consists tor connection ingres egress tor connection label associate non associate negative sample consists arbitrary tor ows belong tor connection label non associate capture tor entry  negative sample exit arbitrary tor connection  hyperparameter obtain finally dene DeepCorr loss function entropy function training dataset compose associate non associate adam optimizer minimize loss function rate adam optimizer another hyperparameter experimental setup discus data collection ethic choice hyperparameters evaluation metric datasets collection experimental setup tor tor client inside vms generate tor trac tor client browse alexa website tor capture ows exit tor network connection connection training therefore ows tor format ows exit tor regular http HTTPS format arbitrary tor circuit browsing website tor circuit browse roughly website dierent guard node tor circuit alternate guard node disable vanilla tor option enforces guard relay reuse regular firefox browser instead tor browser enforce circuit selection tor version automate python script tor relay purpose merely public tor relay capture ingres tor ows tcpdump tor client capture egress tor trac trac exit relay website exit tor trac tunnel  proxy server exit tor trac  proxy server tcpdump data collection proxy additional latency ows performance DeepCorr report website tor pluggable transport evaluate countermeasure DeepCorr tor trac rst trac gap tor trac impact training dataset available publicly knowledge dataset session tor CCS october toronto canada experimental setup tor correlate tor ows useful research community web trac constraint DeepCorr correlate arbitrary tor trac ethic data collection overload tor network concurrent tor connection data collection alternate guard node circuit evade overload specic circuit relay browse illegal content tor idle connection client explain ingres egress tor ows tor client  proxy server therefore trac tor user tor pluggable transport ows bare tor tor bridge scarce expensive therefore avoid overload bridge hyperparameters  implement neural network DeepCorr various dierent hyperparameters optimize correlation performance optimize parameter network converge nvidia titan gpu rate performance rate negative sample  convolution layer max pool max pool performance finally kernel performance parameter parameter evaluation metric previous positive TP false positive FP error rate metric evaluate performance correlation technique TP rate associate correctly declare DeepCorr hyperparameters optimize correlate tor trac layer detail convolution layer kernel num kernel stride activation relu max pool stride convolution layer kernel  kernel stride activation relu max pool stride fully activation relu fully activation relu fully activation relu correlate DeepCorr tor connection FP rate non associate mistakenly identied correlate DeepCorr unrelated tor connection evaluate FP DeepCorr correlate entry exit therefore perform false correlation tor connection dataset detection threshold FP TP rate therefore roc curve DeepCorr algorithm finally comparison raptor additionally accuracy metric sum positive negative correlation correlation raptor comparison derive accuracy metric raptor declare associate evaluate ows maximum correlation metric declare correlate arbitrary intercept ows realistic challenge session tor CCS october toronto canada RESULTS discus experimental performance described experimental setup browse alexa website tor ingres egress trace DeepCorr described earlier ows DeepCorr therefore DeepCorr associate non associate training rst packet shorter ows pad packet zero positive false positive error rate DeepCorr dierent threshold TP FP error rate gure promising performance DeepCorr correlate tor ows packet instance FP DeepCorr achieves TP drastically performance previous practicality false positive error rate FP malicious  intercept tor connection tor ows packet demonstrate DeepCorr unique performance ows previous tor ows acceptable accuracy later increase rapidly improves DeepCorr correlation performance packet improves FP magnitude packet xed TP evident correlation adversary deploy multi stage attack optimize accuracy trac collection instance apply DeepCorr rst packet intercept tor ows packet detect rst stage attack applies DeepCorr longer observation adversary perform standard pre ltering mechanism reduce fps ignore substantially dierent ows DeepCorr correlate arbitrary circuit destination earlier DeepCorr learns correlation function tor correlate tor ows circuit destination regardless circuit destination training demonstrate DeepCorr performance consist tor connection therefore associate non associate rst ows correlation DeepCorr circuit destination ows DeepCorr training ows correlation DeepCorr circuit totally dierent circuit training target web destination dierent TP threshold FP positive false positive error rate DeepCorr detect correlate ingres egress tor ows dierent detection threshold packet false positive positive circuit destination circuit destination gap data gap random DeepCorr performance circuit destination training phase training ows DeepCorr roc curve DeepCorr performs similarly demonstrate DeepCorr correlation function correlate tor ows arbitrary circuit arbitrary destination gure training degrade performance session tor CCS october toronto canada correlation correlate non correlate DeepCorr correlation associate non associate ows consecutive without retrain performance DeepCorr frequently characteristic tor trac algorithm occasionally preserve correlation performance perform evaluate frequently DeepCorr retrain rst evaluate pre model tor ows consecutive output correlation function associate non associate correlation non associate ows substantially however correlation associate ows slightly degrade suggests adversary retrain DeepCorr extreme evaluate DeepCorr performance model earlier gap training gap training gap DeepCorr accuracy signicantly degrades gap training interestingly signicantly degrade performance DeepCorr due lack retrain superior previous technique DeepCorr performance degrade DeepCorr correlation performance ows correlate dataset TP FP specic threshold datasets dierent ows consistent dierent ows correlate suggests DeepCorr correlation performance derive DeepCorr apply signicantly datasets intercept ows ows malicious  TP FP DeepCorr performance consistent regardless dataset xed arbitrary DeepCorr performance rapidly improves previous packet increase ows training improve performance DeepCorr DeepCorr performance dierent ows DeepCorr performance improves signicantly longer observation instance target FP DeepCorr achieves packet ows achieves ows packet intercept ows  DeepCorr performance adversary computation overhead improves DeepCorr correlation performance longer ows impose storage computation overhead trac correlation adversary increase adversary detect correlate ows DeepCorr performance improves training intuitively DeepCorr performance improves tor ows training phase DeepCorr learns correlation function tor training sample DeepCorr roc curve dierent ows xed ows gure  increase training improves performance DeepCorr instance target FP training ows ows training DeepCorr resourceful adversary improve accuracy correlation classier tor ows training session tor CCS october toronto canada false positive positive random DeepCorr performance rapidly improves longer ows training false positive positive  data training data training data random DeepCorr correlation performance improves training data training increase training however frequently evaluate DeepCorr signicantly outperforms  correlation technique introduce prior perform DeepCorr performance prior correlate tor ows roc curve DeepCorr tor ows packet DeepCorr signicantly outperforms correlation algorithm correlation comparison previous technique correlation raptor cosine mutual information pearson DeepCorr prior gap roc curve DeepCorr instance target FP DeepCorr achieves TP previous TP rate improvement DeepCorr learns correlation function tailor tor whereas previous generic statistical correlation metric introduce link tor connection needle correlation algorithm improve performance increase ows intercept correlation equivalently trac volume DeepCorr oer reasonable accuracy previous perform ows signicantly packet data instance evaluate ofthe raptor ows MB data packet equivalent KB tor trac contrast raptor MB ensure comparison evaluate DeepCorr raptor setup ows MB accuracy metric described demonstrates DeepCorr drastically superior performance performance gap DeepCorr raptor signicantly wider shorter observation DeepCorr raptor volume trac intercept demonstrate DeepCorr outperforms signicantly shorter observation instance raptor achieves accuracy MB whereas DeepCorr achieves accuracy MB trac DeepCorr particularly powerful shorter observation zoom raptor DeepCorr packet DeepCorr achieves accuracy packet contrast raptor accuracy DeepCorr computational complexity perform DeepCorr correlation comparison previous technique correlate ows packet DeepCorr noticeably previous technique roughly raptor however ows DeepCorr oers drastically correlation performance overhead instance session tor CCS october toronto canada false positive positive DeepCorr mutual information raptor cosine correlation pearson correlation random DeepCorr roc curve previous overwhelm improvement dataset ows packet false positive positive DeepCorr raptor random DeepCorr raptor raptor DeepCorr oers TP previous oer TP therefore oer accuracy various input ows DeepCorr faster accuracy raptor correlation longer observation achieve accuracy DeepCorr DeepCorr faster accuracy previous correlation technique DeepCorr training phase DeepCorr standard nvidia titan gpu 5GHz 2GB memory associate estimate mbytes accuracy DeepCorr raptor accuracy DeepCorr raptor various volume data intercept raptor comparable raptor packet accuracy DeepCorr raptor DeepCorr raptor correlate ows non associate consists packet DeepCorr roughly recall demonstrate DeepCorr frequently resourceful adversary gpu resource training DeepCorr non tor application DeepCorr correlation attack tor correlate ows correlation application demonstrate apply DeepCorr attack  proxy trac compromise machine session tor CCS october toronto canada network architecture DeepCorr detect attack DeepCorr parameter optimize attack application layer detail convolution layer kernel num kernel stride activation relu max pool stride fully activation relu fully activation relu hide identity therefore network administrator correlation ingres egress relayed connection therefore trace  previous devise various correlation technique application detection caida anonymized data trace previous simulated network jitter laplace distribution model packet bernoulli distribution dierent rate apply DeepCorr DeepCorr model simpler scenario tor simpler neural network model DeepCorr application direction bidirectional connection comparison previous ows tailor neural network choice parameter respectively evaluation DeepCorr performance comparable optimal correlation technique network stable however network becomes noisy DeepCorr oers signicantly performance detect attack communication network network jitter standard deviation network randomly packet  previous dierent countermeasure correlation trac analysis attack remain mostly non deployed presumably due performance exist correlation technique discus countermeasure false positive positive DeepCorr cosine optimal random DeepCorr outperforms detector noisy network packet rate obfuscate trac intuitive countermeasure correlation trac analysis attack website ngerprinting obfuscate trac characteristic algorithm therefore various countermeasure modify packet timing packet defeat correlation pad splitting packet modify packet delay packet perturb timing characteristic tor project deployed various pluggable transport defeat censorship tor trac pluggable transport obfuscate packet content obfuscate IP address tor relay obfuscate trac tor pluggable transport merely purpose censorship resistance obfuscate trac censor client rst tor relay tor bridge therefore tor pluggable transport deployed tor public relay countermeasure DeepCorr deploy trac obfuscation technique tor relay guard relay evaluate impact tor pluggable transport DeepCorr performance currently tor project deployed plug  obfs evaluate DeepCorr  obfs obfs version obfs evaluate mode obfs iat mode obfuscates trac feature iat mode obfuscate trac feature DeepCorr correlate trac plug however due ethical ows previous tor bridge scarce expensive therefore avoid overload bridge consequently correlation alternatively tor bridge bridge incorporate impact actual trac load session tor CCS october toronto canada DeepCorr performance tor pluggable transport deployed relay optimistic due training ethical plug TP FP obfs iat  obfs iat optimistic due training datasets realworld adversary achieve correlation accuracy adequate training browse website obfs without iat mode  DeepCorr ows packet transport contrast ows previous another ows summarizes  obfs iat protection DeepCorr TP comparable bare tor ows therefore correlation bare tor training intuitive  merely obfuscates bridge IP deploy trac obfuscation network obfs iat solely obfuscates packet content trac feature DeepCorr signicantly performance presence obfs iat DeepCorr accuracy adversary training ows public tor relay deploy  obfuscation mechanism obfs iat resist advanced correlation technique DeepCorr however trivial due increase increase overhead bandwidth cpu reduce qos impose obfuscation mechanism majority  tor bridge obfs without trac obfuscation iat therefore obfuscation mechanism tailor tor balance performance anonymity remains challenge future reduce adversary perform correlation another countermeasure correlation tor reduce adversary intercept tor connection therefore reduce perform correlation earlier recent various ASes IXPs intercept signicant tor trac ideal perform correlation attack counter proposal relay selection mechanism tor reduce interception malicious ASes none alternative deployed tor due negative impact performance privacy argue practical aware relay selection mechanism tor promising avenue defend correlation attack tor CONCLUSIONS correlation DeepCorr drastically outperforms correlate tor connection DeepCorr leverage advanced architecture correlation function tailor tor complex network oppose previous purpose statistical correlation metric adequate DeepCorr correlate tor connection therefore anonymity accuracy signicantly exist algorithm substantially shorter observation demonstrates escalate threat correlation attack tor advanced algorithm deployment eective countermeasure tor community