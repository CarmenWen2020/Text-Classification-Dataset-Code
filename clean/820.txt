explore task android malware detection dynamic analysis application activity sequence technique analyze sequence activity informative detect malware analyze longer sequence necessarily accurate model scenario malware harmless application dataset sample malware dataset significantly datasets previous mimic randomly sample portion malware sample model bert achieve desire malware detection performance extremely unbalanced dataset bert model achieves malware significantly outperforms approach validate effectiveness propose highly imbalanced datasets CCS CONCEPTS security privacy malware mitigation keywords malware detection sequence model imbalanced data introduction malicious application malware plague personal machine inception internet malware application instal potentially  sensitive data switch camera consume device resource activity bitcoin mining severe malware application perform advanced persistent threat apt attack link election disruption murder advent internet remotely instal software potential avenue infect grown increase threat malware billion security pressure consumer malware detection service traditional malware detection mechanism explore detection monitor activity software classify benign malicious shortcoming approach tends false positive rate due behavior significant amount domain knowledge construct heuristic attacker disguise malware benign application apart harmful action sequence harmless normal shortcoming detriment malware detection service recent advance machine increasingly impressive variety classification task image classification processing processing model architecture memory lstm recent model bidirectional encoder representation transformer bert lstm network neural network excel historical sequence data input prediction bert attempt bidirectional representation pre training unlabeled text masked pre model finetuned output layer variety downstream task minimum amount additional training model empirically powerful various text classification task significantly lstm already effective file analysis anomaly detection file activity sequence model consist sequence token hypothesis therefore apply model malware detection perform validate initial finding hypothesize bert perform session malware detection aisec november london united kingdom task performs model task hypothesis validate entire dataset intentionally balance dataset harmless harmful simulate unbalanced malware datasets significant traditional machine model data prediction majority dataset   network wildfire extract label action sequence android application action dataset specific function description application behavior action apk file http apk file hidden file activity application monitor chronological sequence activity behavior application summarize contribution propose implement supervise lstm approach malware classification validate assumption sequence information classification achieve perfect almost dataset sample malware highly imbalanced datasets borrow knowledge domain model bert achieve dataset malware sample systematically benefit bert pretraining detection model initialization randomly initialize pretrained android data android datasets pretrained model particularly useful label training dataset pre model available malware detection effort extensively effectiveness apply bert model android malware detection multiple setting activity sequence depth various statistic understand validity utilize data shed future regard security sequence data analysis organize introduces preliminary lstm network bert sequence model approach illustrates data approach towards malware classification task evaluation propose along multiple baseline finally review previous conclude PRELIMINARIES overview android malware detection wildfire android source linux operating mobile device structure software stack comprise component linux kernel operating android environment middleware library application malware detection approach static dynamic analysis static analysis application analyze without execute detection usually signature program structure similarity ast utility dynamic analysis inspect program sandbox detection application actual activity api internet domain contact service wildfire   network perform analysis dynamic analysis wildfire generates sequence activity application sandbox activity apk file leak phone device possibly indicates privacy leakage issue detect apk android package kit android application examine lstm memory lstm recurrent neural network rnn sequence data rnn lstm contains feedback connection previous output input lstm model analyze entire sequence instead broadly apply series data analysis lstm contains gate input gate input forget gate determines information feedback connection discard output gate assume input denotes output lstm calculate    tanh  tanh lstm network parameter matrix optimization internal information input previous lstm input output recurrent input lstm output dimension lstm lstm input input input unroll lstm network lstm input output recurrent input lstm output dimension lstm lstm input input input unroll unrolled version lstm architecture bert bidirectional encoder representation transformer bert recently propose model obtain ofthe task processing nlp bert transformer contrast recurrent neural network lstms transformer rely entirely attention mechanism sequence model session malware detection aisec november london united kingdom bert utilizes pre training objective masked model MLM MLM input text randomly masked model predict masked context previous model generate unidirectional representation bert direction generate bidirectional representation innovation bert context token respect token pre bert representation tune additional output layer custom classification task bert establish classification task sst  pretrained bert model  english wikipedia training epoch finetuning obtain desire methodology data source focus android malware detection analyze activity sequence application describes application chronological behavior installation activity refer android operating apis application internal function various identify monitoring service wildfire activity activity finite activity meaning across application android operating finer granularity activity detection android application investigate wildfire generates sequence activity snippet activity sequence aspect activity analyze contact domain detect malware orthogonal investigate approach considers aspect activity malware detection future apk file ssl apk file alarm apk file apk file file sdc apk file host apk file alarm apk file request BT access snippet activity sequence wildfire data pre processing previously mention activity description android application behaviour apk file file device activity machine model parse digital representation model input recall activity exist finite therefore integer distinct activity requirement downstream machine application integer regard encode accordingly simply numerical input correspond model analyze android activity review identify android malware analyze activity sequence propose methodology representation alternative naive approach detect malware analyze activity application individually approach available information activity information entire sequence malicious sequence normal activity combine achieve malicious sequence interleave activity mask intend purpose potential analyzes multiple activity gram gram analysis continuous sequence activity continuous sequence adjust accord malicious sequence however technique shortcoming gram exponential respect gram alphabet gram gram tend redundant indication sequence longer gram sub sequence predictive sub sequence significantly lastly locality guaranteed evade detection malicious actor deliberately delay activity inject dummy activity representation detection sequence harder validate shortcoming gram gram analysis data mutual information thankfully recent development neural network malware detection automatic intelligent model fed entire activity sequence extract relevant feature malicious activity ignore dummy activity model construct accurate classification application lstm bert employ approach utilize advanced model malware sample extremely ratio malicious android application somewhere model imbalanced dataset highly desirable unfortunately challenge exist machine lstm evaluate sequence information greatly malware detection eliminates effort manual feature engineering observation inspires advanced model surpass lstm highly imbalanced datasets session malware detection aisec november london united kingdom bert model task predecessor bert transformer contrast recurrent neural network sequence prediction transformer utilizes attention mechanism model relationship bert bidirectional training transformer bert pre training mechanism effectively parameter supervise unlabeled datasets core innovation bert masked model sequence bert sequence replace mask token model attempt predict masked context sequence important context masked predict model pre task effectively model relationship token context bert bidirectional architecture attention transformer model powerful approach extract feature input sequence bert model scratch machine task sequence data input correspond label output pre training mechanism summarize capture contextual encoding essential sequence relation nlp domain training datasets wikipedia data pre model tune label domain specific sequence downstream machine task pre bert model nlp data performs surprisingly android malware detection tune android activity sequence data intuition directional training attention mechanism bert effectively learns non continuous sequence relevant android  moreover pre training data although contextual encoding android activity data identify parameter important sequence model deactivate others extensively validates assumption tune android sequence data bert essentially directional training multi layer transformer model bert encoder sequence hidden classification task reduce sequence token hidden correspond token activity model directional  mechanism token encodes sequence information utilize architecture softmax layer classification tune model specific malware detection task label android activity sequence data tune pre model parameter adjust classification layer optimize task pre model available suitable bert architecture scratch domain specific task label datasets android malware classification CLS softmax benign malware tune bert malware classification intermediate output activity sequence training model procedure without pre training evaluation explore effectiveness android malware detection bert model pre nlp datasets bert model scratch bert model architecture pre training nlp data important achieve EXPERIMENTS systematically evaluate effectiveness bert android malware detection unbalanced label multiple baseline model explore setting source code bert approach pretrained model available http github com  android malware detection imbalanced previous contribute datasets drebin  foster research related android malware however datasets sequence information regard activity dataset android malware dataset release   network contains wildfire report consist activity sequence information obtain apk file wildfire service malware analysis   network wildfire customer service various suspicious file firewall endpoint service security analysis suspicious file wildfire applies machine combine static analysis dynamic analysis threat intelligence identify novel threat dynamic analysis wildfire dynamic activity sequence file investigate dataset contains benign malware file android application data various information contact domain request permission sequence dynamic activity application certificate apk explain session malware detection aisec november london united kingdom focus analysis dynamic activity sequence therefore application extract application sequence wildfire report ignore others data pre processing illustrates wildfire report sequence activity fed machine model malware classification analysis report generate wildfire xml format obtain action sequence application extract action description chronological action  tag xml file unique integer token assign distinct action generate lookup vocabulary machine model contains distinct action activity finally lookup obtain sequence integer dynamic action sequence application sequence distribution negligible activity sequence action ignore illustration activity sequence probability density benign malware distribution activity sequence benign malware sample pre processing sequence malware benign token sequence integer activity characteristic sequence therefore excellent performance bert demonstrates remarkable versatility architecture pre model evaluation metric evaluate model metric accuracy precision recall calculate positive TP negative TN positive negative accuracy prediction sample calculate precision indicates correctness prediction malware recall percentage malware detect model finally precision recall precision recall informative overall evaluation model sequence analysis malware detection explore sequence analysis performs bag analysis analyze activity bag baseline evaluation analyze sequence dataset utilize available data sample randomly split training dataset dataset training data consists sample dataset remain sample data split stratify training data ratio malware benign application malware detection without sequence analysis activity application analogous bag approach model text bag multi contains specifically activity sequence activity vector token activity index activity sequence eliminate influence background activity equivalent nlp domain ubiquitous vector activity vector replace frequency inverse document frequency tfidf classification activity vector multi layer perceptron approach neural network hidden layer neuron optimal hyperparameter combination accuracy precision recall disadvantage approach suitable offline detection dataset available model TF idf vector construction consistent across activity vector training datasets dataset TF idf approach split TF idf activity vector training datasets malware detection sequence analysis TF idf approach analyze activity sequence directly classification malware detection easy moreover potential boost malware detection performance sequence analysis simply activity sequence data pre without processing lstm described sequence classification sequence varies truncate sequence fix specifically sequence token classification sequence shorter pad activity malware detection performance measurement improve increase activity sequence malware sequence session malware detection aisec november london united kingdom capture information sequence however increase memorability lstm specifically longer input sequence harder lstm network token sequence nevertheless performance lstm almost perfect outperforms TF idf approach related proposal detail lstm sequence network slowly perform sequence accuracy precision recall lstm performance sequence highly imbalanced dataset explain malware sample rare estimate positive rate ratio malware android application utilize autofocus   network autofocus service combine machine analysis intelligence sample wildfire utilizes trillion data deliver improve contextual threat intelligence analysis allows drill dataset respect data accord autofocus analysis positive rate varies definition scope sample instance program popular application google dominant ratio malicious instance negligible application counting instance google application positive rate malicious application around  popular file define creation exposure security vendor file positive rate increase executable file android executable file dataset sub sample focus highly imbalanced datasets purpose dataset described deliberately construct datasets positive ratio specifically utilize benign application sequence randomly malware sequence accord positive ratio positive ratio analyze ratio extremely positive estimation prone error attempt outlier detection percentage anomaly extremely dataset unsupervised outlier detection popular direction pursue unsupervised detection aim model distribution majority sample dataset label outlier unsupervised outlier detection pervasively cluster autoencoder recently propose  semi supervise anomaly detection DeepLog approach sequence anomaly detection baseline difficulty highly imbalanced datasets datasets positive ratio respectively detail cluster implement cluster cosine distance distance metric attempt malware benign application encode activity sequence embed vector cosine distance calculate sequence representation encode approach various aforementioned TF idf vector average wordvec embed approach treat sequence encode integer token wordvec approach calculate average embed token sequence embed data sample however understand malware sample easily separable benign sample visualize embed vector sample dimensional principal component analysis pca reduce dimension sample embed representation plot dot benign sample  malware sample malware sample embeddings mixed benign easily separable indicates difficulty highly imbalanced data autoencoder autoencoder commonly neural network anomaly detection contains encoder reduces dimension input decoder aim reconstruct input data  reduction inevitably information loss  learns information input sample outlier sample detect error input correspond output refer reconstruction error error suppose outlier network autoencoder outlier detection activity sequence data lstm encoder decoder specifically sequence sequence model training objective minimize error input sequence output sequence dataset malware data obtain positive ratio decision boundary reconstruction error malware benign activity sequence moreover session malware detection aisec november london united kingdom residual component residual component benign malware visualization dimensional embed vector benign malware sequence easily separable kmeans cluster average reconstruction error malware sample benign sequence   autoencoder gaussian mixture model recently propose model achieve anomaly detection dimensional data  contains autoencoder gaussian mixture model specifically data sample fed autoencoder dimensionality reduction vector construct concatenate output embed encoder input decoder distance error input output vector gaussian mixture model autoencoder gaussian mixture model parameter optimize detail  boost public benchmark datasets kddcup thyroid datasets lstm autoencoder sequence sequence model described autoencoder network gaussian mixture model mixture component obtain autoencoder superiority  reveal input dimension DeepLog DeepLog recently propose anomaly detection remains approach goal android malware detection DeepLog analyzes sequence directly message transaction activity described inspire utilize analyze android activity sequence malware detection specifically training data normal benign sequence sequence lstm sequence prediction model predict activity fix activity activity sequence generate input label lstm model training model detection activity sequence apply slide fix slide input DeepLog model output probability distribution activity input actual activity predict classify anomalous difference android malware detection activity sequence malware activity detect anomalous benign otherwise DeepLog positive ratio dataset although baseline android malware detection output training sample construction sequence data DeepLog model positive ratio accuracy precision recall cluster autoencoder  DeepLog performance baseline detection apply bert android malware detection bert model surprisingly effective highly imbalanced datasets effectiveness bert highly imbalanced datasets adopt pre bert model bert uncased model model around parameter pre masked model session malware detection aisec november london united kingdom task google news wikipedia corpus hyper parameter guarantee decent specifically adam optimizer rate batch dropout probability pre model tune epoch android activity sequence datasets positive ratio split training evenly approximately surprisingly bert model pre exceptional highly imbalanced android sequence datasets epoch tune dataset positive ratio training datasets extremely positive ratio bert model supervise classification task unsupervised semi supervise baseline superiority bert model apply supervise lstm model described imbalanced training dataset positive ratio lstm model achieve somewhat balance dataset benign malware sequence however application model imbalanced dataset dataset positive ratio datasets positive ratio lstm imbalanced datasets supervise classification commonly adopt approach loss function specifically training sample positive label training objective function label label emphasize minority assign approach improve supervise lstm lstm performance improves significantly lstm approach without weigh loss positive ratio however bert achieve positive ratio loss function bert model tune due exist bert model already powerful extract hidden information highly imbalanced datasets positive rate accuracy precision recall bert performance model pre nlp data tune epoch validate effectiveness pre training bert model architecture conduct positive rate lstm lstm bert comparison bert lstm bert model scratch epoch epoch respectively effectiveness pre training understand pretraining nlp data helpful android sequence model bert model scratch epoch dataset tune pre bert model previous datasets positive ratio model scratch contains pre bert model indicates pre training nlp data indeed android malware detection explanation pre model easy optimize random initialization model randomly initialize moreover closely related reference neural machine translation model pre resource french tune resource  tune  mapped random french embeddings pre training resource domain boost performance resource domain understand android activity sequence english advanced model bert pre training english text sequence model android activity sequence potentially apply sequence data positive rate accuracy precision recall bert performance model scratch epoch effectiveness bert architecture bert model scratch epoch evaluate effectiveness bert model architecture positive ratio training datasets obtain training bert model epoch comparable tune pre bert session malware detection aisec november london united kingdom model epoch effectiveness bert architecture model security sequence data positive rate accuracy precision recall bert performance model scratch epoch pre training bert android dataset abundant android data intrigue explore benefit pre training pre training data domain training data detection task setting suppose android malware detection model dataset unbalanced label unlabeled android sequence dataset interested explore pre training unlabeled dataset improve performance model unbalanced dataset pre training android data improve detection performance pre training data dataset benign execution sequence dataset contains available data malware execution sequence pre training beneficial training dataset datasets  datasets dataset pretraining label dataset training dataset android malware detection task dataset evaluate model performance described benign malware execution sequence exploit dataset construct datasets explain split dataset portion refer datasets respectively construct datasets pre training contains data benign contains benign sequence downsample positive ratio simulate highly imbalanced dataset evaluate benefit pre model available training data insufficient extract portion data respectively dataset construction procedure along construct datasets summarize datasets conduct aforementioned malware detection model variant model performance difference initial model exploit choice bert model randomly initialize parameter dataset benign malware sequence sample positive ratio benign benign sequence sample data pre dataset construction bert model pre bert model pre benign pre training epoch roughly pre benign nvidia geforce gtx gpu correspondence randomly initialize bert model pre training android sequence data achieves benign variant training dataset pre training benign sequence slightly pre training android data malware sequence explanation malicious token training data treat vocabulary pre training benign another clue classify malicious nevertheless malware ratio particularly positive ratio extremely pretraining significant improvement pre model available unlabeled sequence finally training dataset evident benefit pre training training dataset contains data pre training improves improvement improvement dataset indicates pre model useful training dataset aligns observation previous activity analysis analysis apply sequence data examine specific dataset behavior explain usefulness sequence data simplest examine predictive activity alone activity correlation malware accord mutual information metric insight activity strongly infer malicious behavior remove launcher icon evasion benign application perform activity socket due harmless harmful threat intelligence prior analysis socket session malware detection aisec november london united kingdom initial bert model training dataset accuracy precision recall randomly initialize pre pre benign bert performance comparison pretrained model training datasets activity mutual information rate precision apk file alarm apk file remove launcher icon apk file fetch information apps instal device apk file fetch device specific information apk file delete file apk file socket apk file fetch task device apk file malicious socket apk file url apk file command activity mutual information malicious identify malicious socket connection activity rate precision however information singular activity nearly informative sequence activity completely benign suspicious link activity mutual information bag representation analysis account activity critical capture malware detection activity oftentimes important activity apk file delete SMS database apk file SMS message premium deletion message suspicious malware evade detection SMS delete imply something completely hence informative indication activity existence discussion apply bert security sequence data valuable effectiveness bert model highly imbalanced android activity sequence datasets particularly security domain security data sequential binary code sequence sequence sequence syscall sequence command sequence etc another malicious data security domain attacker successfully therefore finding shed security data analysis binary analysis  analysis DeepLog demonstrate pre training nlp domain helpful training effort security data validate decent epoch tune bert model scratch threat validity imbalanced dataset construction goal conduct sufficiently dataset although dataset significantly previous positive rate cannot arbitrarily goal fully simulate dataset positive rate dataset sample positive sample compromise model perform  slightly positive ratio another threat validity likely violation independent identical distribution assumption malicious actor attempt avoid detection upload malware software multiple variant malware exist training datasets boost severe sample malware software due scope variant identification address issue future addition limitation lack  dataset without specific timestamp sample analysis feasible data training dataset posterior item possibly bias analysis  split available explore  dataset future related malware detection broadly classify category signature behavior signature technique application signature malware signature behavioral evaluate application program structure monitor deviation normal program machine malware detection  khan permission graph abstract representation program vertex atomic non instruction session malware detection aisec november london united kingdom program feature vector machine svm classify guideline choice kernel svm performance kernel function svm malware classification along decision  zhu sequential mining application program opcodes effective detect malware internet iot perform extensive dynamic feature malware detection reveal api library usage operation sequence important feature malware detection api application feature malware classification recent approach sequence api instead api obtain android website ranked api malicious benign application feature malware classification perform random classifier although author guideline effectively subset api exclude others completely loss valuable information feature closely related  framework malware classification  api sequence input important contribution attribution malware specific binary malware classification embeddings mapped fix vector application series embeddings although obtain  significant accurately mimic  malware around dataset technique evaluate positive rate setting framework  effectively leverage android malware classification  dimensional multi feature construct variety information static information permission api deployment component characterize behavioral android apps  neural network feature extraction svm perform actual classification feature notable contribution  remarkable efficiency scalability achieves varies almost linearly application conclusion explore malware classification task machine technique focus activity sequence feature classification sequence non sequence data locality activity classification lstm network performance positive rate training necessarily performance classification finally bert model simulation bert model achieves malware classification positive rate research deserves attention evaluate technique attribute malware addition worthwhile research direction evaluate recent model XLNet perform malware detection task due versatility model apply cyber sequence datasets finally exploit robustness propose technique adversarial manipulation activity sequence intrigue direction explore