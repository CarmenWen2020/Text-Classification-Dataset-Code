bitcoin  transaction transparently blockchain global public ledger remove trust unfortunately transaction blockchain privacy latency scalability issue building recent proposal micropayment channel association ledger dispute resolution introduce technique construct anonymous payment channel proposal secure instantaneous private payment substantially reduce storage burden payment network specifically introduce channel proposal technique allows payment via untrusted intermediary concrete implementation scheme deployed via fork exist anonymous currency zcash introduction bitcoin become increasingly popular decentralize electronic currency bitcoin transaction blockchain public transaction ledger maintain decentralize peer proven successful transaction volume reliance globally ledger serious issue bitcoin MB blockchain average bitcoin transaction rate limited transaction per across entire bitcoin user proposal increase blockchain bandwidth debate bitcoin community none likely transaction rate competes centralize service payment network promising approach address bulk bitcoin transaction chain preserve decentralize structure integrity guarantee proposal chain payment payment channel exemplify lightning network duplex micropayment channel individual payment transaction blockchain channel employ blockchain establish deposit interact directly payment adjust respective ownership deposit communicate blockchain split  fund payment channel exists proposal participant route transaction via intermediate peer benefit payment channel paradigm dramatically reduces transaction volume blockchain without trust centralize payment channel inherit privacy weakness bitcoin although payment conduct chain pseudonymous identity initial resp channel balance participant critically payment channel privacy protection transaction  establish channel tor bandwidth web content user implicitly link payment channel payment channel particularly problematic likely payment rout via intermediate peer currency exchange intermediary trust private payment proposal lightning network propose around rout payment via multiple intermediary node however discus approach substantially increase complexity establish payment channel reveals payment information subset intermediary collude academic recently propose address privacy bitcoin currency publicly deployed notably zcash implementation zerocash protocol monero unfortunately privacy mechanism apply privacy transaction blockchain address payment channel indeed privacy payment channel fundamentally challenge due channel pairwise structure channel fund anonymous currency payment within channel inherently linkable concern propose application channel web micropayments described private alternative online behavioral advertising stress concern privacy theoretical commercial venture around task analyze trace blockchain transaction reasonable surveillance apply payment channel become widely deployed contribution propose blind chain lightweight transaction bolt bolt consists technique session blockchains CCS october november dallas TX usa construct privacy preserve payment channel decentralize currency technique ensure multiple payment channel unlinkable channel fund anonymized anonymous construction enhance earlier privacy preserve decentralize payment address private chain transaction unlike earlier proposal simply obfuscate participant identity intermediary proposal anonymous channel merchant identity practical prototype construction deploy bolt fork bitcoin cryptocurrency construction channel unidirectional payment channel customer merchant fix coin repeatedly without link payment approach compact cash paradigm introduce novel mechanism achieve succinct channel closure ensure blockchain usage constant regardless transaction volume bidirectional channel exchange arbitrary payment direction without link payment challenge prevent malicious counterparty obsolete information earlier balance maintain scheme unlinkability multiple payment channel unlinkable avoid link aborted payment payer identity construction underlie payment channel fund anonymously indirect channel finally extend bidirectional payment channel construction enable payment untrusted intermediary bridge otherwise unconnected exchange critically intermediary learns neither identity amount transact background payment channel payment channel relationship establish participant privacy preserve decentralize ledger currency network payment direction establish channel symmetric payment channel initiate connection simplicity exposition refer initiate customer respond merchant assume payment network validate publish transaction resolve dispute accord public principle requirement satisfied script consensus network monero zcash minimal script extension discus stress proposal focus privacy payment channel assume privacy underlie funding network underlie cryptocurrency anonymous zcash exists anonymizing sufficient anonymity non anonymous cryptocurrency channel respective balance channel non negative integer merch cust establish channel payment network transaction correctly structure network submit fund escrow subsequent closure transaction customer conduct payment interact chain merchant positive negative integer payment amount payment request update cust cust merch merch sole restriction merch cust request channel channel closure message ledger closure message disagree channel ledger executes dispute resolution algorithm channel balance delay sufficient ensure opportunity contribute closure message recover channel balance chain payment transaction payment channel specific requirement refer universal arbitration succinctness universal arbitration disagree channel payment network reliably arbitrate dispute without private information succinctness payment scalable information ledger compact data linearly balance channel transaction amount exchange latter essential requirement payment channel degenerate transaction offline payment chain payment interaction ledger customer merchant limit anonymity payment channel informally construction payment channel privacy guarantee upon payment customer merchant learns information beyond valid payment positive negative channel network learns channel balance however privacy protection channel participant slightly weaker inherent limitation payment channel moreover limitation payment channel indirect channel consist series channel customer intermediary merchant explain limitation channel channel limitation privacy channel asymmetric session blockchains CCS october november dallas TX usa initiate payment anonymous unlinkable payment target payment pseudonymous payment channel payment channel recipient payment someone channel fundamental channel establish counter requirement suggests recipient wellknown channel parameter channel maximize anonymity customer recipient unique channel parameter potential payer behaves payer payer receives privacy channel parameter anonymity situation payment target merchant website accepts payment anonymous customer remainder target merchant refer customer terminology setting payment amount negative reverse payment terminology merchant refund customer previous purchase stress anyone payment channel privacy absolute indirect channel indirect channel involve intermediate channel privacy guarantee surprisingly configuration facilitates anonymity encompasses channel entry intermediary initiator anyone channel exit intermediary target additionally channel intermediary configure merchant remains anonymous customer specifically although underlie wise channel asymmetric privacy indirect channel customer merchant private channel instead intermediary discus arrangement advantage intermediary fully generalize chain intermediary specifically channel intermediary configure hide payment amount intermediary however channel involve intermediary cannot hide payment intermediary regardless cryptographic underpinnings endpoint channel channel balance channel cannot chain channel multiple intermediary channel intermediary endpoint inevitably payment limitation technique simply consequence payment channel neither endpoint balance instead cooperate alter overview construction investigate paradigm construct anonymous payment channel construction electronic cash cash paradigm introduce  extend subsequent unidirectional construction allows succinct payment  token customer merchant preserve anonymity functionality traditional payment channel construction extends variable payment traverse channel direction payment positive negative complex abort finally extend construction payment user anonymously via untrusted intermediate chain intermediary intuition construction unidirectional payment channel cash cash scheme specialized protocol trust issue token coin customer redeem exactly offline cash protocol candidate implement payment channel purpose exposition strawman proposal ideal offline cash scheme allows detection doubly spent coin proposal merchant role confirm customer fund channel issue wallet anonymous coin customer spends merchant channel customer spends remain coin evidence payment network merchant dispute customer statement evidence doubly spent coin strawman protocol suffers weakness obviously succinct closure customer unspent coin secondly issue timing merchant cannot issue wallet customer customer fund  network customer assure recover fund merchant fails issue wallet abort wallet activation finally avoid customer frame attack merchant issue coin  customer spending cash scheme specific  namely payment network distinguish spends cheat customer false spends merchant intuition unidirectional construction address concern compact cash scheme introduce cash coin generate constant wallet customer polynomial wallet compact cash reduces wallet storage immediately succinct closure mechanism channel innovation construction mechanism reduces channel closure fix message increase chain interaction merchant customer session blockchains CCS october november dallas TX usa redeem customer escrow fund blockchain merchant wallet payment iou chain channel establishment merchant token closing channel balance  customer revoke previous wallet refund token redeem payment blockchain channel closure redeem merchant issue wallet  fund customer prof unsigned wallet merchant exist iou customer refund token blockchain split  fund description bidirectional channel protocol customer anonymous merchant identity channel establishment closure blockchain payment channel construction customer commits secret formulate wallet embed within succinct wallet commitment customer transmits payment network along customer escrow fund ephemeral public signature verification pkc customer merchant engage interactive channel establishment protocol operates customer generates coin transaction attache non interactive zero knowledge proof coin wallet commitment individually encrypts transaction symmetric encryption scheme ciphertext embeds transaction along decryption ciphertext individually signing ciphertexts secret customer transmits merchant  critical aspect scheme merchant perspective ciphertexts opaque customer merchant ciphertext customer active channel remain balance computes message channel ID network decryption ciphertext merchant tuple decrypt ciphertexts CN detect spending channel customer cheat reveal invalid decryption ciphertext decrypts invalid coin transaction spent coin merchant  evidence cheat network punish customer grant channel balance merchant bidirectional payment channel restriction previous construction unidirectional payment customer merchant sufficient useful application micropayments web browsing application payment channel payment merchant customer discus notable application payment fund via intermediary increase channel decrease application propose construction combine technique exist non anonymous payment channel blind signature efficient zero knowledge proof exist payment channel customer merchant initial channel customer cust  fund merchant signature balance customer merchant arbitrary positive negative amount conduct interactive protocol knowledge previous signature balance cust demonstrate posse sufficient balance payment blindly extract refund token merchant update balance cust cust customer recent refund token blockchain redeem available fund challenge approach prevent dishonest customer retain earlier version refund token channel closure prevent payment customer interacts merchant revocation token previous customer behaves honestly revocation token link channel previous transaction however customer misbehaves obsolete refund token merchant instantly detect revocation token network proof customer  network award balance channel merchant unlike  approach proposal suffers possibility abort protocol address network enforce fairness session blockchains CCS october november dallas TX usa payment conclude bidirectional payment channel construct payment via untrusted intermediary previously establish channel capability eliminates maintain channel peer advantage proposal intermediary cannot link transaction individual user surprisingly amount paid transaction similarly compromise cannot transaction passing technique anonymous payment channel usable exists highly available untrusted intermediary route connection detail construction extend multiple intermediary abort unidirectional protocol privacy guarantee underlie cash protocol obvious limitation channel balance reveal closure payment customer merchant noninteractive completely anonymous bidirectional payment construction slightly weaker guarantee abort protocol execution merchant customer unable conduct future transaction prevent customer resort network channel concern anonymity merchant arbitrarily reduce anonymity temporarily evict user induced abort merchant link user sequence transaction abort user sequence traditional commerce setting consequence abort minimal payment mechanism merchant fail deliver promise customer almost certainly abort setting micropayments possibility setting customer scan network premature closure abort channel channel merchant minimal anonymity comparison related concurrent propose elegant tumblebit tumblebit compatible classical bitcoin operates mode allows user anonymize aka  coin mode allows payment channel distinct user overcome limited choice cryptographic primitive bitcoin compatibility serious achievement tumblebit limited feature performance privacy comparison bolt payment channel significantly payment alice bob bob  collude identity alice alice identifies  payment  traceable bitcoins contrast scheme provable privacy alice corrupt collude tumblebit hide payment functionality tumblebit payment fix payment channel unidirectional contrast bidirectional payment channel variable payment tumblebit payment succinct channel payment blockchain invocation protocol performance per channel payment tumblebit prototype implementation bolt bidirectional channel stress due flaw tumblebit within confines bitcoin compatibility extremely challenge finally tumblebit unidirectional protocol protection abort bidirectional protocol underlie anonymous currency safety variable payment multiple interaction risk abort terminate invalid intermediate outline remainder proceeds definition anonymous payment channel building scheme protocol payment channel construction concrete instantiation protocol finally discus related DEFINITIONS notation security parameter protocol input output input output define negligible function  denote maximum balance payment channel denote integer   valid payment amount anonymous payment channel anonymous payment channel APC construct establish interact via payment network anonymous payment channel scheme collection algorithm protocol establish channel explain scheme construct channel payment network formal definition APC scheme definition APC scheme anonymous payment channel scheme consists tuple possibly probabilistic algorithm keygen   refund refute resolve interactive protocol establish define completeness define optional function setup trust generate parameter reference likely fundamental discussion although mitigation attack acknowledge  bob correlate alice interaction cannot alice provable privacy bob session blockchains CCS october november dallas TX usa instantiation CRS anonymous payment channel anonymous payment channel scheme combination payment network capable conditionally  fund binding escrow transaction fund data payment network construct blockchain although built technology assume existence payment network capability detail payment network implementation model blockchain algorithm protocol establish channel payment network instantiate anonymous payment channel merchant generates keypair pkm skm keygen identify customer merchant initializes customer generates ephemeral keypair pkc skc channel customer merchant respective initial channel balance cust merch perform executes  algorithm initial channel balance derive channel token TC TM transmit token payment network along transaction escrow appropriate fund fund verifiably  establish protocol activate payment channel disagree initial channel balance protocol return channel channel establishment succeed customer initiate protocol desire channel customer channel refund transmits rcc along channel identifier payment network merchant refute customer closure token obtain merchant closure token rcm conclusion network resolve algorithm channel balance allows  fund correctness security described correctness security anonymous payment channel scheme intuition formal definition appendix correctness informally APC scheme  parameter opening balance cust merch  honest interaction paradigm described outcome namely valid execution protocol recommend instantiation propose CRS public randomness assume channel closure initiate customer merchant initiate channel closure transmit message network request customer channel outcome refute correctly reflect channel balance security security anonymous payment channel scheme define refer payment anonymity balance informal description refer reader appendix formal definition payment anonymity intuitively merchant collaboration malicious customer learns customer spending beyond information available outside protocol anonymity definition extends definition merchant interacts series oracle implement protocol customer CN simulator performs customer protocol latter assume simulator access information normally available participant protocol simulation trapdoor random oracle simulator ability simulate customer without access customer wallet without identity customer simulated definition adversary stress definition implies anonymity simulator information simulate balance balance consists merchant customer assume honest execution resolve protocol ensures collude adversarial  extract channel justified initial channel funding combine legitimate payment adversary merchant customer interface define slightly adversarial customer resp merchant access oracle role merchant resp customer allows establish arbitrary channel chosen initial balance adversary initiate resp initiate protocol repeatedly adversarially chosen payment amount finally adversary initiate channel closure counterparty obtain channel closure message rcc rcm adversary output resolve protocol inconsistent fund paid technical PRELIMINARIES recall building construction commitment scheme   commit decommit commitment scheme  generates public parameter input parameter message random coin commit output commitment decommit input parameter tuple output valid commitment message otherwise instantiation recommend pedersen commitment scheme discrete logarithm assumption cyclic session blockchains CCS october november dallas TX usa generation channel initialization algorithm keygen algorithm generates keypair customer merchant  cust merch algorithm prior opening channel input initial channel balance public parameter keypair  algorithm output channel token TP correspond secret  protocol customer merchant establish TM  TC  input public parameter initial channel token establish protocol activates channel previously  fund successful merchant receives establish customer receives wallet distinguish failure  input parameter payment amount wallet  customer merchant merchant customer receives payment RC wallet wnew interaction succeed merchant receives payment RM update snew interaction succeed channel closure dispute algorithm customer merchant respectively refund TM  input wallet output customer channel closure message rcc refute TC rcc input merchant customer channel closure message output merchant channel closure message rcm update merchant snew dispute resolution algorithm network resolve TC TM rcc rcm input customer merchant channel token TC TM along closure message rcc rcm message null algorithm output channel balance merch cust definition anonymous payment channel scheme symmetric encryption scheme construction efficient symmetric encryption scheme symmetric encryption scheme define symmetric encryption scheme      output encryption scheme     encryption scheme implement encode plaintext cyclic random construction scheme ind cpa security pseudorandom function unidirectional construction pseudorandom function prf efficient proof knowledge purpose sufficient prf secure poly input addition standard pseudorandomness  prf posse refer pre image resistance access oracle implement function random adversary input domain function negligible probability propose instantiate   prf public parameter prime generator random function compute polynomially version   prf satisfies pre image resistance signature efficient protocol scheme signature scheme   verify efficient protocol propose camenisch  scheme feature protocol user obtain signature commitment without signer anything message protocol non interactively knowledge signature instantiation signature propose literature construction rsa assumption various assumption bilinear security assume signature satisfy existential unforgeability chosen message attack EU cma non interactive zero knowledge proof standard non interactively statement commit proof knowledge commit proof commit refer proof notation camenisch  instance  denotes zero knowledge proof knowledge integer enclose assume verifier protocol proof simulation extractability implies exists efficient proof extractor specific circumstance simulation CRS extract witness adversary construct proof adversary simulated proof conduct proof non interactively variety efficient proof technique  contribution consists protocol implement anonymous payment channel protocol unidirectional payment channel cash technique construction allows bidirectional payment complex protocol handle abort finally propose approach payment transmit payment via intermediary unidirectional payment channel construction modifies compact cash construction achieve efficient succinct unidirectional payment channel brief overview construction session blockchains CCS october november dallas TX usa compact cash compact cash scheme customer  fix wallet capable generate coin customer wallet tuple interactively generate pseudorandom function customer private coin wallet merchant wallet generate coin coin consists tuple serial compute tag compute coin spent twice tag combine reveal customer non interactive zero knowledge proof statement prover prover signature wallet correctly structure respect wallet construction ensures spending immediately detect verifier transaction serial verifier recover spender public combine tag individual coin spends cannot link user construct proof efficiently signature proof technique secure rsa bilinear assumption random oracle model subsequent efficient proof standard model achieve succinct closure recall intuition compact cash unidirectional payment channel proposal merchant role issue customer wallet coin anonymously merchant channel customer simply spends unused coin merchant retains spending capability channel subsequent attempt coin recognize merchant unfortunately compact cash succinct wallet immediately succinct protocol closing channel customer cannot simply reveal wallet secret without compromise anonymity previous coin spent channel mechanism succinctly reveal coin wallet without reveal avoid complex proof approach merchant information verify channel closure compact cash scheme analysis scheme compact cash construction generate interactive protocol customer honest behavior ensure uniformly random revise protocol chosen customer enable spending prf deterministic proof indeed alternative proposal construct coin serial chain construction compute hash previous transaction customer revoke channel secret transaction unfortunately correctness standard zero knowledge technique moreover easy accomplish efficient zero knowledge proof technique recommend customer  algorithm prf generate solely customer interactively customer merchant customer commits wallet secret wCom embeds customer channel token TC wCom pkc pkc signature verification establish protocol obtain merchant signature wCom customer merchant series ciphertexts CB contains coin tuple identical normal compact cash proof simply prof respect wCom merchant ciphertexts structure reveal ciphertext subsequent ciphertext feature approach merchant ciphertexts truly valid proof channel reveal remain coin channel customer reveals ciphertext allows merchant unlock remain coin spends verify respect commitment wCom embed customer channel token ciphertext fails enclose proof valid merchant easily  customer obtain balance channel symmetric encryption chain symmetric encryption easily construct standard building scheme additionally encryption algorithm   algorithm pseudorandom function scheme setup input optionally generate CRS parameter secure commitment scheme non interactive zero knowledge proof output keygen compute    cust merch pkc skc input keypair pkc skc uniformly sample distinct prf random coin commitment scheme compute wCom commit skc cust sample cki  vector output TC wCom pkc  skc cust  cust merch pkm skm output TM pkm  skm cust refund TM   generate establish protocol obtain coin index compute skc refund cid cki cid uniquely identifies channel  cid cki refute TC rcc parse customer channel closure message rcc cid cki verify cid signature signature verifies obtain ciphertexts CB establish protocol compute ckj   ckj verify signature  proof signature  proof fail achieve secure commitment scheme secure symmetric encryption mechanism simplicity exposition assume derive session blockchains CCS october november dallas TX usa verify ciphertext fails decrypt correctly decrypt valid  pkc invalid rcm along cid skm verify network otherwise rcm accept skm finally  output merchant resolve TC TM rcc rcm parse customer merchant closure message verify signature fail verify grant balance channel oppose rcc skn rcm accept cust cust otherwise evaluate merchant closure message customer misbehave assign merchant balance channel establish protocol security analysis theorem unidirectional channel scheme satisfies anonymity balance assumption pseudorandom pre image resistance commitment scheme secure zero knowledge zero knowledge signature scheme existentially unforgeable chosen message attack signature extraction blind symmetric encryption encryption scheme ind cpa secure proof theorem version bidirectional payment channel limitation construction unidirectional payment customer merchant additionally fix coin construction enables bidirectional payment channel feature compact closure compact wallet protocol transfer arbitrary constrain maximum payment amount construction customer wallet structure similarly previous construction consists cust random wallet public signature wpk customer commits sends commitment payment network wallet activate customer merchant interact customer blind signature content difference protocol instead conduct payment series individual coin payment customer valid wallet balance cust currency request blind signature wallet amount cust embed wallet public  construction positive negative customer zero knowledge proof signature efficient protocol content request wallet construct properly balance wallet differs balance cust conclusion transaction customer reveals  assure merchant wallet cannot spent wallet invalidate customer signing revoke message wsk correspond private closing channel consists customer valid wallet merchant blockchain challenge construction simultaneously invalidate exist wallet merchant wallet wallet invalidate customer retain fund wallet merchant invalidate wallet signing customer channel merchant refuse wallet wallet interactive payment perform channel closure phase protocol obtain instead reveal recent wallet channel refund token specifies cust wallet public signature merchant phase customer obtains signature refund token blindly phase customer invalidates wallet merchant wallet merchant refuse wallet customer safely channel revise scheme protocol establish setup  algorithm identical previous construction keygen compute    cid cust merch pkc skc customer generates wallet commitment sample random coin compute ephemeral keypair wpk wsk keygen commitment wCom commit cid wpk cust output token TC pkc wCom retains secret  wCom skc cid wpk wsk cust  cust merch pkm skm output TM pkm  skm cust refund TM  customer invoked protocol   cid wpk otherwise  cid wpk  compute skc output rcc refute TC rcc merchant channel closure message par TC obtain pkc par rcc verifies signature pkc signature verifies par obtain cid wpk verifies cid channel finally previously wpk output rcm revoke valid signature message revoke skm otherwise wpk resolve TC TM rcc rcm verify rcc rcm correctly customer merchant pkc pkm respectively verify token cid channel identifier TC TM token fails replace  cust merch rcc simply output fund merchant customer obtain signature wallet merchant merchant accepted channel opening simply opening wallet commitment session blockchains CCS october november dallas TX usa customer TM  establish merchant TC  parse  pkc skc sample generate proof PK skc wCom commit skc pkc skc keygen compute PK skc wCom commit skc pkc skc keygen compute internal signature  skc ckj compute  ckj  ckj external signature skc coin wCom CB verify signature TC cust verify verify signature fails abort output otherwise interact customer blind signature content wCom return skc return establish customer  merchant parse  skc abort compute  pkc proof PK pkc skc  pkc verify pkm skc pkc skc keygen verify RM RM return wnew skc return RM establishment payment protocol unidirectional payment channel scheme parse TC obtain pkc wCom parse cid wpk token parse revoke wpk verify wpk revoke cid wpk fails terminate output cust  merch perform refund validity  wCom commit cid wpk token merchant token contains otherwise  token valid refund token cid wpk fails terminate output cust merch  refutation validity verify wpk revoke wpk terminate output cust merch  otherwise return cust merch  claimed remainder security analysis limitation bidirectional protocol namely possibility malicious merchant abort protocol limited advantage adversary within context security proof address simpler simply prevent adversarial merchant abort protocol theorem bidirectional channel scheme satisfies anonymity balance restriction adversary abort protocol assumption commitment scheme secure zero knowledge simulation extractable zero knowledge blind signature scheme existentially unforgeable chosen message attack signature scheme existentially unforgeable chosen message attack sketch proof theorem version bidirectional payment application bidirectional construction enable payment payment payment positive via intermediary channel assume customer channel establishment role merchant goal identity participant amount transfer outside information channel trust safeguard participant fund construction contrast exist session blockchains CCS october november dallas TX usa customer TM  establish merchant TC  parse  obtain cid wCom wpk wsk cust generate proof statement PK wpk wsk wCom commit cid wpk cust wpk wsk keygen parse TC obtain cust wCom verify proof valid output proof valid interact customer blind signature skm content wCom return cust wpk wsk return establish customer  merchant parse  cid wpk wsk sample wpk wsk keygen sample random coin generate wCom commit cid wpk formulate proof PK wpk wCom commit cid wpk verify pkm wpk  wCom wpk verify ensure wpk   abort output otherwise snew wpk RM otherwise RM interact customer partially blind signature skm message refund wpk wpk content wCom compute verify pkm refund wpk verification fails message abort output compute wsk revoke cid wpk ensure verify wpk revoke wpk snew wpk RM generate blind signature content wCom skm completes RM return wnew wpk wsk return snew RM establishment payment protocol bidirectional payment channel scheme non anonymous payment channel scheme chain intermediary learns amount participant challenge chain payment channel payment atomic payer intermediary paid recipient intermediary risk fails payment similarly payer risk lose fund dishonest intermediary purely cryptographic essence exchange extensively multi protocol however technique blockchains mediate abort approach recall protocol occurs phase portion exchange refund token reclaim  fund phase generates anonymous wallet subsequent payment chain transaction secure ensure phase completes fails atomically accomplish refund token statement network evaluate examine token resolve protocol specifically prevent recipient fund payer deliver correspond payment introduce refund token revocation message signature wsk previous wallet revocation token wsk ledger payment cannot reverse revocation token already reverse cannot payment wpk already ledger hiding payment amount payment construction additional useful feature passive participant transaction maintain channel amount paid amount sufficient fund channel neither reveal merely assure balance fund conserve hide payment amount modify proof statement construct protocol session blockchains CCS october november dallas TX usa commitment wallet proof update balance commitment wallet commitment proof refund token conditional refund token revocation token conditional refund token revocation token wallet signature wallet signature wallet outline payment protocol route message reveal merchant customer commits secret input compute payment simultaneously payment protocol conduct adjust wallet prof wallet adjust proof protocol bind commitment reveal PK wpk wCom commit wpk verify pkm wpk  commit  payment cancel non zero extra fund via proof PK    commit   commit    protocol combine update wallet protocol outline detail commits conduct variable payment protocol modify  proof described sends commitment wallet wCom proof correctness wallet commitment randomness completes generate wCom additionally computes attest wallet wallet commitment sends wallet commitment validate proof issue refund token wallet  conditional refund token  wallet token embeds revocation token wallet channel already completes variable payment protocol generate revocation token wallet sends  completes generate revocation token wallet validate valid refund token verify sends completes remain variable payment protocol individually blind signature wallet security abort proof sketch balance preservation version anonymity execution protocol information reveal parallel payment payment anonymity definition already allows attack challenge realize construction possibility malicious selectively abort protocol transaction steal fund transmit message network recover fund potentially link payment attempt channel unfortunately fundamentally avoid interactive protocol anonymity threat limited channel fund anonymous currency link channel reveal participant identifier importantly intermediary abort technique lifetime channel possibility merchant link payment channel finally intermediary performs abort technique public evidence network allows participant avoid malicious intermediary session blockchains CCS october november dallas TX usa payment payment network extend protocol payment via technique non anonymous payment channel network hide channel balance approach hash lock enforce refund revocation token valid none specifically attach fund revocation token reveals picked release channel entire sequence payment lightning timeouts channel carefully chosen detail approach future hiding channel balance construction privacy limitation balance payment channel reveal channel individual identity initial channel balance anonymous currency mechanism fund channel information channel balance leak useful information network however non dispute channel closure information hidden public channel closure customer commitment channel balance along zero knowledge proof posse valid channel closure token signature channel balance bidirectional construction zerocash payment redeem coin merchant customer modify additional statement amount paid transaction consistent commitment exceed initial funding transaction channel precise detail construction future implementation bidirectional scheme detail integration bolt cryptocurrency performance cryptographic detail concrete instantiation integration currency integrate bidirectional bolt protocol bitcoin cryptocurrency fork protocol backward compatibility exist node recall bidirectional scheme channel fund anonymously abort link aborted payment channel opening merely prevent multiple payment channel link anonymity payment channel anonymity underlie cryptocurrency bitcoin derive currency zerocash zcash underlie anonymity layer anonymity bitcoin coinjoin sufficient circumstance future improvement bitcoin increase achievable anonymity mechanism deployment compatible currency bitcoin zcash transaction consists input output input reference previous transaction output  authorize fund output specify amount output  specify output spent evaluate transaction  previous transaction  transaction combine evaluate stack script simplest  signature specify public fund  contains signature however complex script statement lock enforce elapse transaction threshold signature combine script evaluates spending authorize fork approach involves opcode OP bolt script opcode validate commitment opening blind signature commitment refund token inspect output transaction enforce restriction opcodes inspect transaction output notable exception signature opcodes hash entire transaction input output verify signature however entirely modify zcash bitcoin codebase enable opcodes access transaction output specifically opcode enforce constraint output transaction closing channel verify output merchant balance customer verify customer payout lock claimed merchant refund token invalidate customer channel accomplish implement protocol revocation token private correspond bitcoin resp transparent zcash address channel merchant channel balance paid transaction  immediately however customer fund immediately  customer merchant dispute closure merchant signing transaction revocation token merchant customer fund elapse script OP  OP rev    OP OP  OP refer  transaction zcash shield transaction function differently derive bitcoin core source code modification architecture abstraction script evaluation callback transaction hash access transaction however protocol limitation indeed version codebase expose access expose access affect consensus session blockchains CCS october november dallas TX usa customer merchant primitive establish setup establish bilinear CL  algebraic MACs performance comparison implementation bolt bidirectional payment protocol iteration core intel xeon cpu 0GHz customer setup establish OP csv  OP   OP  OP endif approach greatly simplifies implementation channel opening consists transaction previously anonymized input fund escrow output output  contains opcode OP bolt channel parameter argument channel customer appropriate transaction spending output  contains satisfy OP bolt refund token output output merchant channel  immediately customer  lock script finally appropriate transaction output merchant dispute channel closure fund immediately OP false sig revocation  sig merchant  customer OP sig customer  simplify resolution extra protocol eliminate validate blind signature resolution phase instead opt verify commitment opening standard ECDSA signature commitment refund token consist standard signature wallet commitment standard signature refund token issuance link usage token handle abort protocol issuance security model assumes attacker link transaction channel closure however cannot safely protocol  signature link execution protocol previous protocol request refund token wallet reveal anything content refund token commitment deterministically provably generate exist wallet issue multiple however eliminates refund token consequence additional refresh refund token publish implementation construction bolt signature efficient protocol algebraic MACs defer discussion primitive selection usage appendix directly performance related anonymity bitcoin propose additional privacy protection bitcoin zerocoin zerocash anonymity complex zero knowledge proof seek increase anonymity bitcoin transaction coinjoin   bitcoin construction transaction blockchain finally recent propose probabilistic payment alternative payment mechanism privacy payment channel detail introduction construct chain payment privacy lightning anonymity limitation lightning network payment anonymity channel participant merchant channel identity customer initiate payment however protocol limited anonymity protection payment principle onion rout network multiple non collude intermediary obscure origin destination unfortunately proposal suffers collusion chain collude recover identity transaction hash  contract ID moreover security mechanism assumes exist network sufficient diversity protection viable