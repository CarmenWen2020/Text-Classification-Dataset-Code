homomorphic encryption powerful cryptographic primitive address privacy security issue outsource computation sensitive data untrusted computation environment secure multi computation mpc advantage non interactive operation communication however optimal framework partially due lack efficient matrix computation mechanism practical encrypt matrix homomorphically perform arithmetic operation encrypt matrix novel matrix encode efficient evaluation strategy matrix operation addition multiplication transposition explain encrypt matrix ciphertext yield amortize performance generic apply exist scheme achieves reasonable performance practical implementation encrypt matrix transpose matrix secure matrix computation mechanism applicability framework E2DM encrypt data encrypt model knowledge secure evaluation prediction phase encrypt data encrypt model whereas previous apply model encrypt data benchmark report experimental classify handwritten image convolutional neural network cnn implementation mnist dataset compute likelihood input image simultaneously yield amortize rate per image CCS CONCEPTS security privacy cryptography keywords homomorphic encryption matrix computation machine neural network introduction homomorphic encryption encryption scheme allows operation encrypt input decrypt outcome correspond operation plaintext attractive secure outsource task financial model evaluation genetic ensure privacy security data communication storage computation  extremely attractive due privacy concern patient sensitive data recently neural network model demonstrate achieve health application outsource model evaluate sample secure manner scenario data model assume role data owner hospital institution individual compute service provider amazon google microsoft machine model provider researcher situation data owner model available compute service provider prediction encrypt input data owner model provider encrypt classifier model upload service provider prediction encrypt input various data owner service provider model encrypt data data owner encrypt model prediction encrypt input scenario previously CryptoNets subsequent followup scenario multi computation mpc polynomial kernel vector machine classification however scenario session crypto CCS october toronto canada matrix multiplication algorithm classification task scenario rely heavily efficiency secure matrix computation encrypt input contribution introduce generic perform arithmetic operation encrypt matrix  homomorphic operation compute encrypt matrix previous extend matrix arithmetic advanced operation transposition rectangular matrix multiplication encrypt multiple matrix ciphertext yield amortize performance per matrix apply matrix computation mechanism framework E2DM encrypt data encrypt machine model prediction securely  apply prediction phase scenario described benchmark framework implement evaluation convolutional neural network cnn model mnist dataset compute likelihood handwritten image technical detail gentry construction fully scheme attempt improve efficiency flexibility ciphertext pack technique allows multiple encrypt ciphertext thereby perform parallel computation encrypt vector instruction multiple data simd manner literature practical scheme pack achieve amortize complexity homomorphic operation besides component wise addition multiplication plaintext vector scheme additional functionality scalar multiplication slot rotation permutation plaintext slot enable interact plaintext slot naive secure multiplication matrix distinct ciphertexts input matrix ciphertext per matrix entry apply pure simd operation addition multiplication encrypt vector consumes homomorphic multiplication multiplication another approach matrix multiplication series matrix vector multiplication  shoup introduce matrix encode diagonal decomposition matrix diagonal mapping ciphertext ciphertexts matrix matrix vector multiplication compute rotation multiplication therefore matrix multiplication complexity depth multiplication propose efficient perform matrix operation combine friendly operation packed ciphertexts simd arithmetic scalar multiplication slot rotation define encode identifies arbitrary matrix vector dimension entry denote component wise matrix matrix multiplication express matrix resp obtain resp specific permutation describes equality remark initial matrix resp compute rotation permute matrix resp obtain rotation initial matrix computational complexity bound rotation multiplication refer comparison prior input ciphertexts matrix complexity depth implementation denote homomorphic multiplication constant multiplication mult CMult respectively methodology complexity depth ciphertexts naive mult  shoup mult mult CMult comparison secure dimensional matrix multiplication algorithm assumption ciphertext encrypt plaintext slot extend matrix computation arbitrary ciphertext plaintext slot encrypt multiple matrix ciphertext matrix operation parallel matrix encode ciphertext partition sub matrix encrypt individually arithmetic operation matrix express wise operation computation sub matrix securely matrix algorithm approach evaluate encrypt neural network model encrypt data implementation publicly available http github com   scheme optimize computation securely compute matrix transpose matrix evaluation encrypt cnn model adapt network topology CryptoNets convolution layer fully FC layer session crypto CCS october toronto canada activation function model obtain kera library training image mnist dataset classification handwrite image compute likelihood encrypt input image encrypt cnn model yield amortize rate per image model achieves prediction accuracy PRELIMINARIES binary logarithm simply denote denote vector bold vector vector matrix matrix denotes matrix obtain concatenate matrix vertical direction matrix denotes matrix horizontal concatenation denote security parameter throughout valid attack cryptographic scheme scope operation homomorphic encryption cryptographic primitive allows compute encrypt data without decryption generate encrypt operation plaintext enables securely outsource computation public technology potential application statistical machine neural network denote plaintexts ciphertexts respectively scheme keygen enc dec eval quadruple algorithm proceeds keygen security parameter algorithm output public public evaluation  secret encpk public encryption algorithm encrypts message ciphertext  secret ciphertext decryption algorithm return message   evaluation  circuit tuple ciphertexts  evaluation algorithm output ciphertext scheme statement satisfied overwhelm probability  encpk  overwhelm probability   arithmetic circuit ciphertexts   cti securely evaluate arithmetic circuit consist addition multiplication gate throughout denote  homomorphic addition multiplication ciphertexts respectively addition  denote multiplication scalar simplicity omit subscript algorithm context ciphertext pack technique ciphertext pack technique allows encrypt multiple ciphertext perform computation simd manner smart  introduce pack technique polynomial crt important feature native plaintext dimensional vector appropriate encode decode factor plaintext slot encode encrypt ciphertext perform component wise arithmetic operation plaintext slot enables reduce expansion rate parallelize computation achieve performance amortize complexity however ciphertext pack technique limitation easy handle circuit input plaintext slot overcome propose data slot encryption scheme error RLWE assumption exploit structure galois implement rotation operation plaintext slot scheme rotation algorithm denote rot transforms encryption encryption positive negative rotation rotation linear transformation  shoup introduce evaluate arbitrary linear transformation encrypt vector arbitrary linear transformation plaintext vector matrix express matrix vector multiplication combine rotation constant multiplication operation specifically define diagonal vector denotes component wise multiplication vector  encryption vector algorithm describes compute ciphertext desire vector algorithm homomorphic linear transformation procedure  CMult CMult rot return algorithm computational  multiplication addition constant multiplication rotation rotation operation perform session crypto CCS october toronto canada switch operation comparably expensive operation complexity asymptotically rotation reduce nonzero diagonal vector relatively secure matrix multiplication via homomorphic encryption propose encode convert matrix plaintext vector simd environment encode devise efficient algorithm matrix operation encryption permutation matrix multiplication propose friendly expression matrix multiplication operation matrix define useful permutation simplicity identify representative denote reduction integer modulo interval index integer modulo shift function respectively matrix express matrix AB denotes component wise multiplication matrix correctness equality compute matrix component index equation consists permutation matrix entry hadamard multiplication operation efficiently evaluate ciphertext pack matrix encode propose encode transform vector dimension matrix vector define encode concatenation vector isomorphism additive implies matrix addition securely compute homomorphic addition simd manner addition perform multiplication scalar adapt constant multiplication scheme throughout identify respect ciphertext encryption encrypts plaintext vector matrix multiplication packed ciphertexts arbitrary permutation operation understood linear transformation matrix representation nonzero diagonal vector directly evaluate permutation homomorphic operation complexity efficient algorithm perform matrix multiplication packed ciphertexts combine equation matrix encode tweak permutation focus permutation described denote matrix representation correspond permutation respectively firstly matrix representation express otherwise otherwise similarly matrix representation compute otherwise otherwise described equation employ diagonal decomposition matrix representation multiplication encrypt vector diagonal vector estimate complexity notation diagonal vector  simplicity identify matrix exactly nonzero diagonal vector denote diagonal vector nonzero divisible integer nonzero diagonal vector matrix nonzero diagonal vector similarly matrix nonzero diagonal vector therefore homomorphic evaluation permutation rotation rotation compute session crypto CCS october toronto canada homomorphic matrix multiplication suppose ciphertexts encrypt matrix respectively efficient evaluation strategy homomorphic matrix multiplication performs linear transformation input ciphertext mention  sparse matrix nonzero diagonal vector linear transformation vector representation diagonal vector compute otherwise denotes component compute otherwise equation securely compute CMult rot encryption plaintext vector denote computational addition constant multiplication rotation evaluate linear transformation input ciphertext described matrix nonzero diagonal vector express matrix vector multiplication diagonal vector  vector contains component zero entry equation securely compute CMult rot encryption plaintext vector denote complexity procedure roughly addition constant multiplication rotation securely computes shift operation respectively shift matrix nonzero diagonal vector compute otherwise otherwise encryption matrix ciphertexts CMult rot CMult rot shift permutation correspond  exactly nonzero diagonal vector entry obtain encryption matrix compute rot computational procedure addition constant multiplication rotation computes hadamard multiplication ciphertexts finally aggregate ciphertexts encryption AB matrix AB homomorphic multiplication addition summary perform homomorphic matrix multiplication operation described algorithm algorithm homomorphic matrix multiplication procedure      AB mult AB AB mult return AB improvement implementation matrix multiplication addition constant multiplication rotation multiplication complexity reduce apply giant algorithm integer equation express compute encryption rotation session crypto CCS october toronto canada compute ciphertexts constant multiplication perform addition constant multiplication rotation homomorphically evaluate addition constant multiplication rotation compute addition constant multiplication rotation reduce constant multiplication leverage input multiplexer sum generates plaintext vector slot implies CMult rot rot CMult rot CMult compute CMult CMult rot rot CMult obtain desire ciphertext addition rotation operation summarizes complexity depth algorithm propose optimization technique CMult rot mult depth CMult CMult mult mult CMult complexity depth algorithm advanced homomorphic matrix  introduce transpose matrix faster rectangular matrix multiplication employ algorithm extend algorithm parallel matrix computation without additional matrix transposition packed ciphertexts matrix representation transpose entry otherwise diagonal vector ofu nonzero matrix sparse matrix nonzero diagonal vector linear transformation denotes nonzero diagonal vector component vector compute otherwise otherwise computational rotation giant approach reduce complexity automorphism reduce rectangular matrix multiplication efficient algorithm rectangular matrix multiplication convenience former naive generate matrix pad zero matrix perform homomorphic matrix multiplication algorithm rotation multiplication however optimize complexity manipulate matrix multiplication representation permutation described refinement rectangular matrix multiplication suppose matrix matrix define wise operation restriction rectangular matrix define permutation abuse notation denote restriction denote submatrix extract matrix AB express observation lemma faster rectangular matrix multiplication algorithm lemma permutation commutative similarly obtain session crypto CCS october toronto canada define matrix vertical direction lemma implies similarly commutative therefore matrix AB homomorphic rectangular matrix multiplication suppose ciphertexts encrypt matrix respectively apply giant algorithm generate encryption securely compute algorithm output AB finally perform aggregation rotation operation rot AB evaluate approach yield addition rotation algorithm explicit description homomorphic rectangular matrix multiplication algorithm homomorphic rectangular matrix multiplication procedure      AB mult AB AB mult AB AB AB AB rot AB return AB summarizes complexity algorithm additional computation reduce complexity rotation multiplication respectively output AB encrypts matrix desire matrix AB vertical direction CMult rot mult complexity algorithm ciphertext rectangular input matrix algorithm reusable matrix computation without additional parallel matrix computation throughout identify message matrix assumption however scheme plaintext slot matrix dimension application ciphertext encrypt matrix plaintext slot waste subsection introduces allows multiple matrix encrypt ciphertext thereby perform parallel matrix computation simd manner simplicity assume divisible modify encode correspondence transforms dimensional vector tuple matrix specifically input vector define component index congruent modulo correspond matrix integer rotation operation matrix wise rotation naturally extend matrix wise operation scalar linear transformation matrix multiplication encrypt matrix ciphertext perform matrix multiplication operation matrix apply matrix multiplication algorithm ciphertexts complexity remains algorithm amortize computational complexity per matrix implementation homomorphic matrix  report performance homomorphic matrix operation analyze performance implementation simplicity assume integer pad zero session crypto CCS october toronto canada dim throughput message expansion encode decode amortize per matrix KB rate encryption decryption    benchmark homomorphic matrix operation implementation employ encryption scheme approximate computation encrypt data  unique scheme rescale procedure truncate ciphertext modulus plaintext important role magnitude message thereby achieve efficiency approximate computation detail refer perform macbook pro laptop intel core core rat ghz implementation  library shoup NTL library parameter parameter underlie scheme homomorphic matrix operation described underlie scheme RLWE assumption cyclotomic integer denote reduction modulo interval integer residue modulo integer native plaintext dimensional complex vector suppose factor integer convert integer quantization ciphertext plaintext vector assume constant vector factor integer maintain precision rescale procedure homomorphic multiplication reduces ciphertext modulus rescale procedure constant multiplication reduces modulus algorithm depth constant multiplication additional depth homomorphic multiplication implies input ciphertext modulus reduce  logp matrix multiplication algorithm obtain bound ciphertext modulus denote logq logq logq   logp logq   logq  output ciphertext modulus ciphertext desire vector factor logq logp implementation logp  logq discrete gaussian distribution standard deviation sample error polynomial secret polynomial sample discrete ternary uniform distribution cyclotomic dimension chosen achieve security attack lwe estimator parameter correspond ciphertexts KB  KB  KB  performance matrix operation timing matrix addition multiplication transposition various matrix throughput matrix parallel distinct implementation variant  sparsely packed fully packed packed implementation ciphertext matrix implementation encode matrix sparsely fully packed plaintext slot parameter variant ciphertext plaintext matrix operation distinct matrix simultaneously dimension ciphertext distinct matrix ciphertext mention ciphertext plaintext slot encrypt matrix fully packed ciphertext assume input logp precision input matrix bound KB ciphertext KB evaluation matrix multiplication encrypt version unencrypted version input matrix fourth expansion ratio generate ciphertext input matrix session crypto CCS october toronto canada timing conduct average operation parameter generation fifth timing encode input matrix encrypt plaintext slot matrix multiplication ciphertext modulus others report encryption timing sixth timing decrypt output ciphertext decode matrix encryption decryption timing encode decode timing throughput amortize per matrix homomorphic matrix computation entire execution latency variant implementation parallel matrix computation roughly speedup factor throughput performance rectangular matrix multiplication performance algorithm described concrete rectangular matrix multiplication described optimize performance exploit algorithm multiplication matrix precise algorithm generates ciphertexts apply linear transformation approach almost computational complexity algorithm apply operation ciphertexts algorithm approximately operation algorithm consume algorithm whereas dominant procedure algorithm finally algorithm additional operation automorphisms summarizes experimental parameter algorithm respectively therefore algorithm achieves speedup algorithm algorithm   performance comparison homomorphic rectangular matrix multiplication E2DM  prediction BASED  data model propose novel framework E2DM encrypt convolutional neural network model encrypt data service paradigm model provider encrypt classifier model public server prediction service data owner uploaded encrypt data inference private data data owner model model provider neural network architecture viable cnn image classification alexnet dramatically improve consists stack linear non linear layer linear layer convolution layer FC layer non linear layer max pool compute maximal component layer pool compute average component layer relu function sigmoid function specifically convolution operator fundamental basis convolutional layer convolution kernel stride  image kernel compute convolve image conv conv return integer input extend multiple kernel conv conv conv FC layer connects node node equivalently specify matrix vector multiplication matrix output convolution layer tensor flatten FC layer throughout concatenate tensor output vector denote FL homomorphic evaluation cnn efficient strategy evaluate cnn prediction model mnist dataset image pixel array pixel arbitrary hidden layer image label digit training image image assume neural network plaintext dataset adapt network topology CryptoNets convolution layer FC layer activation function describes neural network mnist dataset summarizes hyperparameters neural network usually apply softmax activation function purpose probabilistic classification obtain index maximum output prediction phase explain securely encrypt model encrypt multiple data implementation cyclotomic dimension plaintext vector dimension predict image simultaneously simd manner parameter selection detail session crypto CCS october toronto canada layer description convolution input image kernel stride output channel input FC fully input output input FC fully input output description cnn mnist dataset encryption image encryption phase data owner encrypts data public scheme suppose data owner dimensional image define extract image feature image image feature extend multiple image dataset encode matrix consist component feature image encrypt enc ciphertexts public encrypt encryption model model provider encrypts prediction model multiple convolution kernel matrix FC layer provider procedure encrypt convolution kernel separately component kernel matrix plaintext slot model provider encrypts plaintext vector ciphertext denote FC layer specify matrix sub matrix denote sub matrix matrix encrypt ciphertext matrix encode output ciphertext FC layer express matrix model provider pad zero obtain matrix generates matrix vertically output ciphertext finally model provider transmits distinct ciphertexts homomorphic evaluation neural network prediction phase public ciphertexts image data owner neural network prediction model model provider data owner simd technique batch image FC layer specify matrix multiplication similarly FC layer matrix multiplication homomorphic convolution layer public ciphertexts apply pure simd operation efficiently compute dot kernel matrix extract image feature performs computation ciphertexts mult definition convolution ciphertext  matrix FL conv FL conv encryption matrix flatten convolve image kernel layer applies activation function encrypt output image convolution simd manner computes sqr sqr denotes operation scheme encryption matrix FC layer procedure matrix multiplication matrix input matrix matrix combine performs computation  layer applies activation function output node FC layer sqr FC layer performs rectangular multiplication algorithm ciphertext output ciphertext layer  session crypto CCS october toronto canada threat model suppose ensure ind cpa security underlie scheme ciphertexts message computationally indistinguishable computation public perform encryption learns encrypt data ensure confidentiality data semi honest server performance evaluation E2DM evaluate E2DM framework classify encrypt handwritten image mnist dataset library kera tensorflow cnn model image dataset apply adadelta optimization algorithm optimization technique suppose encryption matrix recall apply homomorphic liner transformation generate encryption matrix sometimes pre compute generate correspond ciphertexts approach tradeoff although ciphertexts ciphertext reduces overhead rotation operation achieve performance another advantage input ciphertext modulus reduce logp  matrix multiplication logp  encryption ciphertexts additional depth generate encryption apply FC layer model provider generates ciphertext matrix FC layer FC layer provider generates encryption matrix parameter convolution layer activation layer depth homomorphic multiplication FC layer depth homomorphic multiplication constant multiplication apply precomputation optimization technique therefore bound ciphertext modulus logp  logq implementation assume input logp precision output ciphertext modulus logq logp addition  precision constant actually obtain ciphertext modulus around dimension ensure security security chosen consistent performance report CryptoNets ciphertext MB parameter ciphertext image pixel array pixel data owner chooses image mnist dataset normalizes data maximum generates ciphertexts ciphertexts MB ciphertext contains information image therefore ciphertext per image MB KB image approximately encrypt meanwhile model provider generates distinct ciphertexts ciphertexts MB homomorphic evaluation E2DM sends ciphertext authority legitimate owner secret scheme ciphertext around MB per image MB KB summarizes ciphertext per instance data owner MB KB model provider MB authority MB KB ciphertext E2DM implementation detail generation parameter data owner encrypt image meanwhile model provider generate encrypt prediction model procedure naive data outsource negligible overhead report timing evaluation E2DM timing fourth relative per image applicable dominant evaluate framework perform FC layer matrix multiplication operation encrypt matrix advantage pre computation described thereby evaluate layer faster similarly apply approach FC layer evaluation classify encrypt image encrypt training model yield amortize rate per image evaluation return packed ciphertext transmit authority output decrypt secret authority computes argmax image obtain prediction procedure around yield amortize millisecond per image data owner authority model achieves accuracy accuracy obtain evaluation model implies precision loss approximate homomorphic encryption session crypto CCS october toronto canada stage latency amortize per image data encode encryption owner model encode encryption provider convolution FC FC authority decode decryption performance E2DM mnist comparison previous benchmark mnist dataset framework CryptoNets MiniONN  indicates framework denotes preserve privacy communication image classification framework network topology CryptoNets node hidden layer scenario underlie cryptographic primitive CryptoNets perform prediction yield amortize rate data matrix apply evaluation neural network homomorphic matrix operation E2DM achieves fold reduction latency fold reduction message CryptoNets allows simd parallelism amortize however implies CryptoNets prediction yield amortize complexity framework competitive mixed protocol framework MiniONN framework privacy preserve neural network employ ciphertext pack technique pre processing recently  deploys automorphism structure underlie scheme perform matrix vector multiplication thereby improve performance significantly millisecond classify image mnist dataset online bandwidth MB mixed protocol achieve relatively interaction protocol participant bandwidth usage related WORKS secure outsource matrix computation matrix multiplication perform series inner secure inner simd environment approach encrypt matrix encrypt vector obtain component wise input vector perform homomorphic multiplication however aggregate plaintext slot desire procedure logd automorphisms apply complexity secure matrix multiplication multiplication logd automorphisms recently approach apply encode RLWE scheme propose encode matrix constant polynomial native plaintext secure matrix multiplication homomorphic multiplication packed ciphertexts later improve however serious drawback practical ciphertext non meaningful coefficient computation decrypt encode remove plaintext polynomial related focus verifiable secure outsource matrix computation protocol client delegate task untrusted server server return computation proof correctness computation verifiable secure computation outsource apply fully scheme yao garble circuit pseudo random function however practical apply theoretical approach application privacy preserve neural network prediction privacy preserve prediction model firstly  author private evaluation protocol CryptoNets cnn subsequent improve normalize sum prior apply approximate activation function employ fully apply evaluation arbitrary neural network approach privacy preserve prediction mpc combination additively hybrid protocol evaluate scalar compute activation function threshold sigmoid mpc technique  zhang apply mixed protocol framework implement neural network training evaluation computation MiniONN transform exist neural network oblivious neural network apply simd batching technique chameleon relies trust framework later improve leverage effective packed ciphertexts hybrid protocol improve efficiency bandwidth network latency session crypto CCS october toronto canada framework methodology runtime communication MB offline online amortize offline online per instance CryptoNets MiniONN mpc  mpc E2DM mnist benchmark privacy preserve neural network framework conclusion practical secure outsource matrix computation demonstrate applicability novel framework E2DM secure evaluation encrypt neural network encrypt data benchmark E2DM achieves message latency CryptoNets secure matrix computation primitive apply various compute application genetic machine investigate financial model evaluation E2DM framework another future extend matrix computation mechanism advanced operation