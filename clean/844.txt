network middleboxes perform packet inspection dpi detect anomaly suspicious activity network traffic however increasingly traffic encrypt middleboxes longer recent proposal blindbox enables middlebox perform inspection privacy preserve manner blindbox deploys garble circuit generate encrypt purpose inspect encrypt traffic directly however setup latency ruleset report overhead incur garble circuit communication commenced encrypt generate delay intolerable application PrivDPI reduces setup delay retain privacy guarantee blindbox ruleset encrypt generation faster overhead session faster overhead consecutive session performance gain technique generate encrypt reuse intermediate generate previous session across subsequent session contrast blindbox performs encrypt generation scratch session nevertheless PrivDPI generate encrypt traffic token implementation token encryption rate PrivDPI per sufficient application moreover intermediate generate session reuse across subsequent session token speedup token encryption overall PrivDPI practical suitable connection CCS CONCEPTS security privacy security protocol web protocol security cryptography keywords network privacy encrypt traffic inspection middlebox privacy introduction packet inspection dpi deployed functionality intrusion detection network monitoring prevent data leakage network traffic web encrypt ssl TLS exist dpi technique inspect packet limited usage inspect encrypt traffic technique widely enterprise split TLS mitm attack middlebox serf mitm establish session client destination server behalf client middlebox decrypt inspect encrypt encrypt traffic originate client practical modification underlie security protocol TLS technique secure certificate mitm approach securely TLS protocol implement date unfortunately deployment insecure due weakness implementation deprecate cipher suite    network heterogeneous network device experienced administrator administer another privacy concern mitm approach device access decrypt data addition mitm violates encryption data privacy guarantee supposedly secure communication various security issue prompt cert issue alert TA interception encrypt traffic session privacy preserve technique CCS november london united kingdom approach propose address issue recent approach blindbox propose blindbox performs packet inspection directly encrypt traffic without client middlebox middlebox gain information underlie content encrypt payload content introduce technique obfuscate encryption achieve garble circuit specifically client server generate garble circuit function perform oblivious transfer OT middlebox respectively encrypt client  payload encrypts payload obtain correspond encrypt token encrypt middlebox encrypt encrypt token traffic however garble circuit approach incurs significant computation communication overhead roughly encrypt report furthermore session operation perform blindbox practical independent contribution address limitation blindbox PrivDPI secure practical whereby encrypt generation relatively efficient blindbox retains security privacy guarantee introduce reusable technique client middlebox perform preparation generation obfuscate session obfuscate reuse generate encrypt session effectively reduce computation communication overhead preparation blindbox realize objective developed technique obfuscate generation technique garble circuit achieves performance encrypt generation introduce reusable obfuscate generation technique session obfuscate generate session reuse subsequent session minimizes computation communication overhead encrypt traffic inspection capability reuse improves performance proposal demonstrate extensive improve performance due propose technique blindbox session ruleset encrypt generation PrivDPI faster bandwidth blindbox consecutive session ruleset encrypt generation faster blindbox bandwidth token encryption phase PrivDPI however roughly blindbox aes NI hardware reduce computation overhead encrypt token generate reuse subsequent session token performance token encryption phase reuse mechanism token session already previous session TLS connection ruleset blindbox token client server around demonstrates PrivDPI practical suitable setting connection objective PrivDPI enable middlebox enterprise internet service provider isp inspect encrypt traffic preserve privacy underlie payload user deploy PrivDPI assure middlebox access encrypt information transmit session compromise encrypt malware traffic subscriber isp service install PrivDPI assure email facebook personnel  middlebox  guarantee employee scenario personal data privacy becomes increasingly prevalent data protection regulation GDPR inspection encrypt payload perform administrator ability exploit exist middlebox enterprise usually installs subscribes security service secure enterprise network furthermore enterprise deploy PrivDPI detect potential data exfiltration keyword maintain privacy user overview PrivDPI architecture blindbox consists entity generator RG middlebox MB client server described RG issue tuples network tuples MB detect malicious network traffic contains keywords malicious behaviour network communication RG organization network security service MB network appliance monitor encrypt traffic malicious data payload traffic issue RG user web browser sends receives network traffic focus encrypt network traffic TLS connection service provider content client threat model adversary adversary involves assume malicious objective adversary escape detection malicious behaviour generate encrypt token correspond session privacy preserve technique CCS november london united kingdom traffic threat standard intrusion detection IDS malicious secret encrypt traffic throughout entire session assumption malicious standard data exfiltration parental filter application adversary involves MB adversary exploit content encrypt traffic assume adversary semi honest honest curious protocol content encrypt payload goal PrivDPI enable MB perform packet inspection without expose content traffic PrivDPI consists phase setup phase MB receives tuples RG meanwhile establish session TLS handshake protocol session randomness source preprocessing phase MB interacts establish reusable obfuscate MB session preparation phase reusable obfuscate generate preprocessing phase establish session TLS session session generate encrypt traffic detection token detection phase token encryption  data transmit TLS session token encrypt token detection phase token detection MB generates encrypt session generate session preparation phase performs token detection encrypt token encrypt generate characteristic MB reuse obfuscate prepared session subsequent session token validation phase malicious data TLS session tokenization session resp session resp perform tokenization encryption algorithm data receives generate token token resp  version PrivDPI version bilinear ensure generate token guard malicious generate token TLS payload evade detection MB minimal involvement reduces computation communication requirement preparation obfuscate however bilinear incurs computation variant PrivDPI efficiency interaction preliminary PrivDPI preliminary notation ppt probabilistic polynomial denote define notation bilinear GT multiplicative cyclic prime generator GT bilinear bilinearity non degeneracy operation bilinear GT efficiently computable computational diffie hellman CDH assumption compute decisional diffie hellman DDH assumption random setup setup phase domain RG chooses random secret random  RG private obtain signature sig finally RG sends sig MB tuples keywords formulate attack enable MB perform privacy preserve packet inspection later stage RG involve protocol update RG offline perform independently install PrivDPI HTTPS configuration public signature scheme RG hash function RS blindbox implement aes RS parameter reduce ciphertext reduce bandwidth overhead session establish TLS handshake protocol blindbox derive via pseudorandom generator generate randomness randomness later generate generate reusable obfuscate session without loss generality assume LS regular TLS encrypt traffic preprocessing phase preprocessing protocol execute TLS session completion handshake protocol protocol described aim protocol establish intermediary reusable obfuscate MB reuse generate session subsequent security requirement computationally infeasible recover session privacy preserve technique CCS november london united kingdom         encrypt TLS detect tokenize encrypt   validate token TLS PrivDPI architecture data TLS session another tokenized data RG prepares tuples generates signature tuples MB interacts reusable obfuscate MB inspects tokenized data TLS session server server verify data identical session encrypt TLS traffic tokenized data notation notation meaning description sig tuple generate RG input MB generate reusable obfuscate reusable obfuscate generate MB preprocessing phase session source generate session session session generate MB session preparation phase generate encrypt session token generate token token encryption phase generate encrypt token cri encrypt generate MB token detection phase cti encrypt token generate token token encryption phase session reusable obfuscate  define explain rationale protocol enable MB detect encrypt traffic MB obtain function jointly generate however MB obtain MB MB arbitrarily generate encrypt content encrypt payload due proprietary knowledge MB RG suppose address issue introduce technique oblivious reusable obfuscate generation inspire recent protocol oblivious transfer intuition obfuscate RG MB obfuscate obfuscate derive without reveal enables obfuscate  detail generator calculates sends MB symmetrically MB sends  observation derive  ksi MB calculate assume CDH assumption ensures MB obtain correspond generate reusable obfuscate component inspect encrypt traffic however MB cannot inject additional  RG forge  rdi rdi MB ability information encrypt traffic subtle issue address explain following prevent MB gain information encrypt traffic rdi obtain  rdi MB signature along verify signature MB cannot forge signature rdi additional rdi detect ensure generate identical calculate sends MB honest MB compute MB equation efficient mechanism correctness without bilinear interaction prevent blind chosen RG receives  domain blind cannot obtain launch brute attack computational unbounded session privacy preserve technique CCS november london united kingdom preprocessing protocol input MB input sig RG  input protocol computes sends MB similarly computes sends MB MB halt output otherwise sends sig sig valid signature public signature scheme RG halt output compute  ksi finally MB MB verifies equation halt output otherwise calculates reusable obfuscate  future preprocessing protocol session preparation phase session preparation protocol execute generate session session derive reusable obfuscate generate preprocessing protocol protocol described objective subsequent session protocol compute obfuscate improves computation communication blindbox demonstrate preprocessing protocol previous establish session derive LS TLS session session denote session establish    LS derive  session reusable obfuscate generate preprocessing protocol directly session subsequent session KDc specific session MB MB generates session specific session calculate KDc reusable obfuscate generate preprocessing protocol prevent KDc kds MB KD MB message remark session increase consume prevent brute attack preprocessing protocol session depends chosen session preprocessing perform treat session session preparation protocol input MB input preprocessing protocol input session subsequent session protocol session MB session subsequent session protocol operates sends KDc MB similarly sends kds MB MB KDc kds halt output otherwise calculates KDc session session preparation protocol token encryption slide tokenization blindbox approach protocol token consists byte keyword confidential consists byte generate token byte      reduce storage exists overlay token keyword byte MB generate token prefix   sufficient detect keyword optimization propose blindbox namely delimiter tokenization applicable http realm keywords protocol structure suppose payload submit php keyword secret keywords submit submit php keyword keyword secret  submit generate token keywords delimiter offset tokenization token token encryption perform algorithm described intuition MB session session KDc session perform equality encrypt token derive kαt session kαt  session hence compute kαt session KDc kαt subsequent session session token token security requirement MB token MB otherwise information reveal achieve efficiency approach encrypt deterministic encryption scheme however simply encrypt deterministic encryption scheme leak information frequency analysis attack identical token encrypt packet session token identical ciphertexts adopt session privacy preserve technique CCS november london united kingdom approach blindbox random prevent frequency analysis attack however naively random token per encrypt token MB perform equality avoid independent encrypt token initializes counter CTc tuple ctt token session token correspond ctt per session addition derives initial sends MB MB token session exist tuple correspond calculate  tuple ctt CTc compute encrypt token ctt otherwise exists tuple ctt CTc ctt ctt compute encrypt token ctt session compute KDc exist tuple correspond CTc ctt tuple ctt CTc compute encrypt token ctt exists tuple ctt CTc ctt compute encrypt token ctt exists tuple ctt CTc thatt   ctt encrypt token ctt token encryption algorithm input counter CTc token session KDc subsequent session algorithm session algorithm operates token exist tuple correspond CTc compute kαt ctt ctt insert tuple ctt CTc exists tuple ctt CTc satisfy ctt ctt ctt compute encryption session session algorithm operates compute KDc kαt token exists tuple correspond CTc ctt ctt insert tuple ctt CTc exists tuple ctt CTc satisfy ctt ctt exists tuple ctt CTc satisfy ctt ctt ctt compute encryption token encryption algorithm blindbox prevent CTc reset CTc sends MB  token detection perform equality MB compute encrypt cri ctri cri encrypt token token generate ctt kαt session kαt session MB session session KDc session reduce bandwidth detection overhead counter blindbox specifically session MB initializes  contains tuple ctri cri ctri cri ctri MB initializes contains cri token detection algorithm described token detection algorithm input counter  scheme encrypt token traffic exists cri correspond action dictate security policy delete node correspond insert cri ctri ctri ctri token detection algorithm token validation tokenization token encryption algorithm decrypt traffic TLS encrypt token encrypt token MB concludes malicious variant  improve efficiency PrivDPI introduce modify token encryption algorithm preprocessing protocol respectively enhance token encryption algorithm introduce approach reduce computational overhead token encryption algorithm observation token task algorithm compute session KDc subsequent session observation described session subsequent token within session privacy preserve technique CCS november london united kingdom session session detection token compute reuse subsequent token computation reduce exponentiation per token similarly token within session subsequent session reuse compute exponentiation per token observation addition token within session token subsequent session hence reuse session token generate previous session reduce computation overhead token encryption algorithm observation modify token encryption algorithm prior operation session compute reuse generate token within session subsequent session observation modify token encryption algorithm encryption token initializes counter CT tuple ctt token session token correspond session token generate session ctt  per session index session addition derives initial sends MB MB token modify token encryption algorithm described remark CT grows increase accordingly hence CT reset session token enhance preprocessing protocol fourth preprocessing protocol operation elliptic curve efficient normal elliptic curve hence remove efficient elliptic curve reduce computation overhead addition hence pre compute reuse compute computational reduce exponentiation ing per token fori observation modify preprocessing protocol security introduce syntax protocol security definition finally protocol secure define security definition syntax introduce syntax encryption scheme middlebox searchable encryption scheme MBSE introduce blindbox define syntax preprocessing protocol enhance token encryption algorithm input counter CT token session session algorithm session algorithm operates compute token exist tuple correspond CT compute kαt ctt ctt insert tuple ctt CT exists tuple ctt CT ctt ctt ctt compute encryption session algorithm operates token exists tuple correspond CT compute kαt KDc kαt ctt ctt insert tuple ctt CT exists tuple ctt CT compute KDc ctt ctt exists tuple ctt CT  ctt ctt ctt compute encryption enhance token encryption algorithm definition MBSE syntax MBSE define definition MBSE scheme message consists ppt algorithm setup   setup setup algorithm input security parameter output public parameter  token encryption algorithm input token public parameter output ciphertexts ctn  encryption algorithm input public parameter output encrypt ctr ctn ctr algorithm input ciphertexts ctn encrypt ctr correspond output index idm idi correctness MBSE scheme ensures token probability token detect negligibly probability specifically sufficiently session privacy preserve technique CCS november london united kingdom enhance preprocessing protocol input MB input sig RG input protocol computes sends MB similarly computes sends MB MB halt output otherwise sends sig respectively sig valid signature public signature scheme RG halt output compute resp reuse   ksi fori finally MB MB verifies halt output otherwise calculates reusable obfuscate  future enhance preprocessing protocol security parameter polynomial index tid tid setup ctn  ctr  ctn ctr setup ctn  ctr  ctn ctr negl definition preprocessing protocol preprocessing protocol computation input output refer computation functionality input output preprocessing protocol input MB input actual protocol output MB security definition MBSE security security definition blindbox security definition blindbox security definition  specifically token ppt adversary distinguish encryption token addition MBSE scheme encrypt middlebox encrypt token hence security definition adversary token restriction token token MBSE scheme define security define challenger adversary setup setup algorithm sends public parameter challenge phase chooses token flip random coin  algorithm input obtain ciphertexts finally sends query phase randomly chooses sends fori  algorithm obtain encrypt ctri finally sends ctr ctrl output index respectively adversary definition MBSE scheme secure ppt adversary negligible advantage security advantage adversary define  preprocessing security PrivDPI employ preprocessing protocol MB obtains reusable obfuscate subsequent session security requirement preprocessing protocol MB compute reusable obfuscate preprocessing protocol cannot obtain intuitively execution protocol MB cannot obtain information conclude security requirement satisfied similarly cannot obtain information security requirement satisfied threat model described MB semi honest protocol preprocessing protocol described malicious behavior detect MB message hence treat semi honest computation MB definition security static semi honest adversary  protocol compute functionality define  ith execution protocol input security parameter consists input internal random coin message  joint output execution definition functionality securely computes presence session privacy preserve technique CCS november london united kingdom static semi honest adversary exist ppt algorithm     definition considers joint distribution output probability functionality deterministic functionality correctness privacy requirement security definition deterministic functionality definition deterministic functionality securely computes presence static semi honest adversary  exist ppt algorithm   construction construction MBSE scheme construction outline structure security context blindbox treatment underlie data structure affect security preprocessing protocol generates reusable obfuscate session preparation phase security preprocessing protocol independently addition session reuse affect security scenario session setup generate compute  random sequence compute tti cti tti output cti  output  preprocessing protocol malicious behavior verify message hence simplify version preprocessing protocol remove message aim verification assume semi honest introduce MB semi honest malicious within semi honest model additional however detect verify signature MB trivially hence signature simplify preprocessing protocol computation presence static semi honest adversary protocol described security proof security MBSE scheme simplify preprocessing protocol input MB  domain protocol computes sends MB MB sends computes  ksi sends MB MB calculates reusable obfuscate  future simplify preprocessing protocol theorem assume programmable random oracle construction MBSE scheme secure MBSE scheme proof theorem appendix security preprocessing protocol lemma computationally unbounded algorithm engage role execution simplify preprocessing protocol probability input proof lemma appendix theorem assume DDH preprocessing protocol securely computes functionality presence static semi honest adversary proof theorem appendix EXTENSIONS  protocol propose keyword inspection simplest discus briefly protocol extend blindbox limited IDS IDS retrieval session suspicious keyword privacy blindbox reflect flexibility protocol PrivDPI sacrifice practical useful feature achieve marked improvement efficiency reusability refer reader interested detail blindbox limited IDS PrivDPI extend multiple keywords absolute relative offset information within encrypt packet keywords keywords industrial offset information trigger content contains keywords offset tokenization approach deployed generates token offset hence feature session privacy preserve technique CCS november london united kingdom IDS extension enables IDS functionality MB decrypt TLS traffic token keyword allows inspection regular expression cannot achieve solely token insight token replace encrypt token PrivDPI  LS manner retrieve session simply xoring encrypt token encrypt however cannot lookup contrast linear scan perform xor operation construction maintain efficiency detection blindbox token encrypt token  generate additional parameter LS lookup compute compute obtain LS performance evaluation perform implement variant PrivDPI intel core TM cpu core 0GHz linux OS cpu aes NI instruction PrivDPI built charm crypto python library prototype cryptosystems utilize  library establish TLS connection construct  curve nist curve widely adopt application nowadays snort emerge threat around tokenized byte evaluation instance eventually average performance PrivDPI blindbox reconstruct blindbox   simulate MB perform preprocessing protocol preparation encrypt middlebox computation communication overhead middlebox execution pre processing protocol token detection discus following performance session bandwidth session establish client middlebox server pre processing phase preparation encrypt PrivDPI efficient computation wise blindbox PrivDPI blindbox PrivDPI efficient blindbox garble circuit per PrivDPI exponentiation per bandwidth blindbox 6GB generate encrypt PrivDPI achieves MB bandwidth session byte bandwidth blindbox PrivDPI blindbox PrivDPI MB GB KB MB token detection detection blindbox PrivDPI token token MB bandwidth subsequent session session bandwidth blindbox PrivDPI blindbox PrivDPI GB GB MB GB MB GB MB KB blindbox sends message garble circuit per PrivDPI per incurs bandwidth token detection token detection mechanism deployed identical blindbox PrivDPI hence performance subsequent session bandwidth subsequent session consecutive session generation comparison consecutive session PrivDPI blindbox hence PrivDPI faster blindbox due blindbox evaluate garble circuit session contrast PrivDPI reuse reusable obfuscate generate preprocessing protocol session eliminate generate session scratch bandwidth bandwidth consecutive session setting consecutive session bandwidth PrivDPI MB bandwidth blindbox GB meaning PrivDPI bandwidth blindbox previous blindbox sends garble garble circuit session contrast PrivDPI reuse reusable obfuscate preprocessing protocol session subsequent session PrivDPI per session token detection token detection comparable blindbox due mechanism client server computation communication overhead execution token encryption protocol session privacy preserve technique CCS november london united kingdom bandwidth byte blindbox PrivDPI performance session bandwidth token encryption session client server blindbox performs garble aes circuit middlebox described however perform operation lesser perform operation middlebox sender middlebox evaluate garble circuit PrivDPI although workload without perform circuit garble significantly improves performance comparison blindbox PrivDPI load middlebox PrivDPI performance faster previous setup network operator incentivized invest middleboxes powerful hardware client computer shift load middleboxes highly desirable bandwidth discernible difference bandwidth usage middlebox protocol  requirement whatever middlebox token encryption token session PrivDPI around blindbox mainly due mechanism blindbox aes encryption PrivDPI exponentiation multiplication aes encryption actual client server communication token likely content access token increase encryption performance PrivDPI computation lookup exponentiation multiplication eliminate future lookup token aes encryption improve performance token increase likewise token PrivDPI improvement correspond exponentiation multiplication computation token increase encrypt token proportionally likely scenario keywords article document tend  frequency english something important performance subsequent session building philosophy previous subsequent session consist similarity traffic token blindbox PrivDPI token encryption percentage token blindbox PrivDPI token encryption token encryption token blindbox  technique evaluate token encryption percentage token argue scenario applicable source information content remain multiple session recipe tutorial specification online evaluation percentage token previous session performance comparable blindbox despite relatively due token multiplication aes encryption performance TLS session perform evaluate pre processing token encryption setup session privacy preserve technique CCS november london united kingdom percentage token blindbox PrivDPI token encryption token session reuse occurs client server perform pre processing protocol byte token message pre processing token encryption detection byte token setup token encryption token detection realize bearing usually client server request response bandwidth ratio generally heavier server chose setup reflect extreme client server architecture namely echo server scenario PrivDPI advantageous blindbox analysis blindbox surpass PrivDPI transmission token graph roughly token perspective transfer bandwidth google roughly KB browser youtube com roughly MB per session transfer bandwidth perform query lookup load twice PrivDPI inbound outbound PrivDPI jeopardize performance network traffic client quickly establish session middlebox server related discussion introduction introduce blindbox privacy preserve packet inspection scheme inspects encrypt traffic directly client establishes encrypt session server session establish token session route MB MB host encrypt rulesets derive session TLS session session client  encrypts payload identical tokenized traffic route session MB MB tokenized traffic token blindbox PrivDPI encrypt rulesets traffic malicious blindbox preserve privacy secret derive session MB garble circuit oblivious transfer session computationally expensive tokenization mechanism blindbox extend scheme embark focus outsource MB proposes token technique prefix caters middlebox service IP firewall nat http proxy data exfiltration intrusion detection address performance bottleneck blindbox propose  proposes token protocol public operation compatible exist TLS protocol another scheme public operation  scheme oblivious pseudo random function encrypt preparation regular expression scheme deploys variant garble circuit propose scheme efficient blindbox server register administration service enterprise host client another scheme  propose xor random split various MBs reside collaboratively compute perform traffic inspection proposal client server accountable model client server aware authenticate MBs deployed introduce scheme  modifies exist TLS protocol client MBs server establish authenticate secure channel exchange secret addition session issue  protocol adoption exist TLS protocol widely replace  acknowledge issue propose another scheme  underlie TLS protocol introduce extension readily adopt exist protocol recently session privacy preserve technique CCS november london united kingdom demonstrate attack  propose formal model analyze protocol related proposal analyse encrypt traffic machine without inspect encrypt payload propose technique malware detection various header information metadata trust hardware deployed privacy preserve packet inspection proposal utilizes secure enclave intel sgx trust hardware reside MB session decryption inspection  perform enclave propose scheme sgx technique proposal secure network function virtualization NFV trust hardware packet inspection    conclusion propose privacy preserve packet inspection PrivDPI directly inspects encrypt traffic detection mechanism blindbox blindbox incurs performance overhead preparation encrypt due garble circuit contribution minimize computation communication overhead preserve security privacy requirement blindbox demonstrate encrypt generation ruleset faster introduce notion reusable obfuscate enables client middlebox reuse subsequent session reusable obfuscate generate session greatly reduce performance overhead demonstrate encrypt generation consecutive session ruleset faster limitation token encryption payload blindbox reuse encrypt token generate previously token encryption ideal token session overall computation session faster blindbox ruleset roughly token