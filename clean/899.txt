recently compete smart program framework app development emerge framework tangible benefit user expose user significant security risk depth empirical security analysis emerge smart program platform analyze samsung smartthings apps currently available smart platform device sensor alarm lock smartthings host application runtime proprietary source backend scrutiny challenge overcame challenge static source code analysis smartthings apps smartapps device handler carefully craft reveal undocumented feature platform finding twofold although smartthings implement privilege separation model discover intrinsic flaw significant overprivilege smartapps analysis reveals smartapps overprivileged due capability coarse grain moreover instal smartapp grant access device specifies limited access device smartthings subsystem device communicate asynchronously smartapps via sufficiently sensitive information lock code exploit framework flaw construct proof concept attack secretly lock code  exist lock code disabled vacation mode induced fake alarm conclude security lesson emerge smart program framework smart technology evolve beyond convenience functionality automatically  tangible benefit instance sensor smart meter efficiency IP enable camera sensor lock security however attacker manipulate smart device physical financial psychological harm  target lock hidden access code  target smart oven victim smart steep curve complicate device setup procedure limited enthusiast recently introduce newer easy user setup program framework developer apps realize smart benefit samsung smartthings HomeKit vera vera google weave   alliance  emerge programmable smart vulnerable attack attack entail crucial address initiate research defense programmable smart become commonplace vulnerability discover individual profile smart device protocol device ZWave zigbee however prior research investigate security program framework smart apps apps perform knowledge security analysis program framework smart specifically empirically evaluate security popular programmable framework smart samsung smartthings focus program framework substrate unifies application protocol device realize smart benefit attacker remotely covertly target flaw framework realize emergent threat outline earlier chose smartthings smartthings apps apps smartapps vera  apps  compete framework HomeKit weave   formative stage apps smartthings native device manufacturer smartthings security principle framework authorization authentication device access essential secure smart app platform smartthings built mechanism device operation apps capability driven processing smart application smartthings apps register callback generate device platform driven processing instance  bus signal HomeKit characteristic notification api therefore lesson analysis smartthings framework inform security critical component programmable smart framework stage smartthings framework recognizes potential security vulnerability incorporates security smartthings privilege separation mechanism capability specify operation smart app issue compatible smart device smartapps secure storage accessible app developer smartapps security orient subset groovy groovy apps sandbox denies operation reflection external  apis OAuth protocol protects integration smartapps smartthings capability subsystem smartapps device handler communicate asynchronously security analysis explores security orient aspect smartthings program framework perform security analysis challenge smartthings platform source furthermore smartapps execute proprietary smartthings host environment instrumentation dynamic analysis publicly available api obtain smartapp binary binary analysis technique inapplicable overcome challenge combination static analysis built runtime manual analysis dataset smartapps device handler source analysis available http  eec  edu contribution discover security critical flaw smartthings capability model subsystem smartapps significantly overprivileged smartapps device operation request capability imply smartapps grant capability explicitly request overprivilege unavoidable due device authorization capability model fault developer IV  exist smartapps already advantage overprivilege extra feature without request relevant capability smartthings subsystem discover app privilege device generates app grant capability device unprivileged apps device leak device identifier spoofed IV exploit combination flaw framework induced developer bug various security  weaken security construct proof concept attack remotely exploit exist smartapp available app program backdoor pin code lock VI attack  capability smartapp request smartapp automatically overprivileged due smartthings capability model eavesdrop subsystem snoop lock pin code  smart lock pin code programmed user leak unrestricted smartthings SMS api attack smartapp advertises battery monitor request battery monitoring capability disabled exist vacation mode smartapp available app spoofed vacation mode simulation VI capability attack fake alarm spoofed physical device VI attack unprivileged smartapp escalate privilege device authorize access misuse logic benign smartapps attack expose household significant harm theft misinformation vandalism attack vector specific device broadly applicable finally analysis distil lesson construct secure programmable smart framework couple lesson exploration pro con offs building framework analysis suggests although readily solvable others balance technique risk capability identity mechanism vii smart security outline emergent threat smart due swift steady introduction smart device threat eavesdropping compromise various smart device structure attack data destruction illegal physical entry privacy violation others risk concrete demonstrates remote attacker weaken security although recognize security risk security emerge smart application associate program interface smart security analysis around theme device protocol device  garage surveillance informs  possibly empty wink relay controller microphone switch eavesdrop conversation   controller authentication bypass bug site request forgery flaw compact  rapidly cycle possibly induce seizure epileptic user access philip hue  lock others siloed access fails enable essential smart device user temporary worker contrast emerge application associate attack vector smart program platform largely independent specific device protocol researcher demonstrate flaw zigbee ZWave protocol implementation smart device exploit bug proximity target demonstrate flaw program framework attack physical access furthermore remote attack independent specific protocol  perform security analysis smart hub smartthings security analysis focus infrastructure protection ssl TLS replay attack protection password  smartthings hub correctly deployed infrastructural security mechanism exception telnet debug interface hub fix contrast perform empirical analysis smartthings platform application discover framework flaw overprivilege privilege principle privilege program framework easy achieve however achieve evidence recently research smartphones conduct overprivilege analysis android apps apps overprivileged cite developer confusion prime factor overprivileged android apps along analyze relatively apps proprietary backend device via proprietary protocol hub ssl session overprivilege due developer confusion due framework  static analysis framework android source code permission specification android version static analysis smartapp source code compute overprivilege however unlike  static analysis capability documentation smartthings runtime source instead rely analyze protocol operating smartthings backend client web ide permission capability model introduce user driven access user loop app sensitive resource instance remote lock app lock response user action however device apps install permission introduce guideline permission evaluates effectiveness smartthings capability model sensitive device operation malicious benign buggy smartapps grant modality capability future smartthings background threat model smartthings platform architecture discus threat model architectural detail smartthings besides developer documentation therefore discus analysis technique uncover architectural aspect smartthings appropriate smartthings background smartthings ecosystem consists component hub smartthings backend smart phone companion app hub purchase user multiple protocol ZWave zigbee wifi interact physical device around user user manage hub associate device hub install smartapps app smartphone companion app smartthings mobile backend smartapps backend smartdevices software wrapper physical device user companion app hub backend communicate proprietary ssl protocol although publicly available statistic smartthings user rough adoption installation android version companion app march google smartapps smartdevices communicate smartapps invoke operation smartdevices via lock lock smartapps subscribe smartdevices smartapps generate smartapp SMSs network smartthings apis smartdevices communicate hub proprietary protocol smartapps smartdevices program frame enables smartapps smartdevices restrict subset groovy compiles java bytecode smartapps smartdevices execute source backend smartthings web environment host backend software development smartapps smartdevices publish smart app accessible via smartthings companion app addition app secondary developer software available source code hood smartapp directly communicate physical device instead communicates instance smartdevice encapsulates physical device smartdevice manages physical device protocol ZWave zigbee expose physical device smartthings ecosystem smartthings architecture overview explain concept program framework listing smartapp lock unlocks physical lock switch smartapp definition specifies meta data smartapp namespace author detail category capability authorization smartthings security architecture governs device smartapp access smartthings capability model capability compose command attribute command device actuate attribute information device capability capability smartthings framework smartapp listing preference input statement specify capability capability lock capability switch user installs smartapp capability trigger device enumeration scan physical device currently user hub input statement user device specify capability user device per input statement authorize smartapp device installation user interface smartapp listing user chooses device per input statement smartthings compiler bind variable lock input statement lock device switch device respectively smartapp authorize access device via smartdevice instance capability multiple device smartdevice ZWave lock smartdevice sensor smartdevice capability capability lock capability battery capability refresh smartdevice slightly capability capability capability battery capability refresh instal battery monitoring smartapp request capability battery user device consist ZWave lock sensor option available input statement variable bound device binding battery monitoring smartapp monitor battery status device subscription smartapp instal predefined instal invoked smartapp listing instal creates subscription switch status update switch switch smartdevice function  execute function unlocks physical lock correspond lock similarly switch function  invoked lock physical lock correspond lock installation user interface device enumeration app asks device capability lock capability switch screen user tap input screen smartthings enumerates lock device user device app access webservice smartapps smartapps expose web service endpoint respond http delete request external application http request trigger endpoint handler specify smartapp execute developer groovy code secure web service endpoint backend OAuth authentication service smartapp web service register backend issue random client ID client secret smartapp developer typically writes external app access web service endpoint smartapp external app access smartapp posse obtain client ID client secret smartapp redirect user HTTPS webpage smartthings website authenticate user specific user ID password multi exchange HTTPS external app acquires scoped OAuth bearer token grant access specific smartapp client ID client secret issue detail entire smartthings authentication protocol access web service http doc smartthings com smartapp web service developer overview html sandboxing smartthings backend isolates smartapps smartdevices  sandbox technique manual fuzzing built smartapps unauthorized operation exception trace  sandboxing implementation groovy source code transformer whitelisted succeed groovy program app issue thread security monitor denies security exception thread smartthings whitelist apps cannot load external  perform reflection thread smartapp smartdevice private data smartapps smartdevices physical device user installs smartapp smartthings lock sensor correspond device handler smartdevice smartdevice expose request capability summary program perspective smartapps smartdevices capability building capability define command attribute device smartapps capability user bind smartdevices smartapps threat model focus systematically discover exploit smartthings program framework vulnerability attack involve framework flaw within scope attack attempt circumvent groovy runtime environment hub operating backend infrastructure bug patch contrast attack focus flaw impact program framework without significant disruption application framework IV security analysis smartthings framework investigate security smartthings framework respect theme methodology involve potential security issue smartthings architecture extensively potential security issue prototype smartapps survey investigation expound later privilege principle adherence capability model sensitive operation device untrusted benign buggy smartapps important ensure smartapps request privilege grant privilege request however exist smartapps overprivileged sensitive data protection access sensitive data generate device untrusted benign buggy smartapps unauthorized smartapps eavesdrop sensitive external integration safety   counterpart apps interact secure manner insecure interaction increase attack smart opening channel remote attacker smart framework smartthings limit damage security breach developer bug external platform weaken security smartthings external input sanitization webservice smartapp untrusted external input database web apps smart apps sanitize untrusted input however smartapp endpoint vulnerable command injection attack access external communication apis smartthings backend restrict external communication ability untrusted benign buggy smartapps internet access SMS access smartapps without occurrence overprivilege smartapps significant issue overprivilege smartthings framework artifact capability enforce capability smartthings framework coarse grain access multiple command attribute device smartapp acquire invoke command device smartapp obtain capability request smartthings framework bind smartapp device detail issue coarse grain capability smartthings frame capability defines command attribute capability lock associate command lock unlock associate attribute lock lock attribute command attribute refers lock unlocked device status investigation exist capability define smartthings architecture capability coarse grain auto lock smartapp available smartthings app lock command capability lock access unlock command increase attack smartapp exploit lock command misuse smartapp lock authorize household member inconvenience whereas unlock command misuse smartapp vulnerable asymmetry risk device command oven dangerous relatively appropriate automatically grant smartapp access unsafe command access command overprivilege due capability coarse grain compute evaluate smartapp static analysis manual inspection request command attribute command attribute ideally empty apps explain exist smartapps overprivileged due capability coarse grain coarse smartapp smartdevice binding user installs smartapp smartthings platform enumerates physical device capability declare app preference user chooses device authorize smartapp unfortunately user capability request device compatible request capability moreover user selects device authorize smartapp smartapp gain access command attribute capability implement device handler device developer avoid overprivilege consequence smartthings framework concretely smartdevices access correspond physical device besides manage physical device understand protocol smartdevice expose capability appropriate device manages default ZWave lock smartdevice capability capability actuator capability lock capability polling capability refresh capability sensor capability  capability battery capability reflect various facet lock device operation smartapp request capability battery monitor lock battery smartthings framework user authorize access ZWave lock device request capability unfortunately user grant authorization request smartapp gain access request capability capability define ZWave lock smartapp lock unlock ZWave lock status lock code overprivilege due unnecessary capability grant compute evaluate smartapp static analysis manual inspection grant capability capability ideally empty explain exist smartapps privileged due additional capability grant discus conservatively compute insufficient sensitive data protection smartthings callback smartdevice arbitrary data smartapps register inside user smartdevice assign device identifier hub device identifier stable remove hub device identifier unique user possession device identifier useful another nevertheless significant vulnerability access smartapp approve access  vice capability request smartapp monitor data publish smartdevice smartthings framework mechanism smartdevices selectively data subset smartapps user limit smartapp access subset smartapp acquires identifier smartdevice monitor smartdevice without gain capability device spoofed smartapp smartdevice spoof location related device specific leakage via capability access user approves smartapp request access smartdevice capability smart framework permit smartapp subscribe smartdevice smartdevices extensively communicate sensitive data instance smartthings ZWave lock smartdevice transmits  lock pin code smartapp access ZWave lock smartdevice monitoring device battery status automatically ability monitor access remote server steal lock pin code smartapp lock code exit premise therefore movement household member possibly privacy violation leakage via smartdevice identifier smartdevice user assign random identifier identifier however hidden smartapps smartapp authorize communicate smartdevice device retrieve  vice identifier smartapp normally register subscribe   handler  reference device smartthings groovy compiler injects input statement executes  specifies attribute subscribed handler invoked attribute occurs smartapp learns smartdevice device identifier substitute  device identifier register related smartdevice authorize smartdevice possession device identifier authorizes bearer device handler irrespective grant capability unfortunately device identifier easy exchange smartapps opaque handle specific smartapp smartapps currently exist smartthings app retrieval device identifier user remotely OAuth protocol discus attack exploit weakness VI spoof smartthings framework neither enforces access around trigger smartapps verify integrity origin discover unprivileged smartapp spoof physical device spoof location related smartdevice detects physical device appropriate smoke detector smartdevice smoke detects smoke vicinity contains various information plus location identifier hub identifier device identifier source attacker legitimate identifier arbitrary information smartthings propagates subscribed smartapps smartdevice trigger obtain identifier easy hub location ID automatically available smartapps obtain device identifier relatively straightforward VI discus attack unprivileged smart app escalates privilege alarm device VI smartthings framework location geo location smartapps location subscribe instance occupancy detector monitor array sensor update mode location accordingly vacation mode app mode occupancy simulation location accessible smartapps smartdevices smartthings enables flexibility however smartapp spoofed location falsely trigger smartapps rely location WI discus attack location spoof vacation mode arbitrarily summarize smartthings subsystem insecure smartdevices extensively status sensitive data device handler dataset II insecurity integration smartapps http endpoint apps interface smartthings webservice smartapps respond http delete request smartthings user setup trigger action android iOS phone apps simplify management setup interface endpoint via OAuth protocol remote attach OAuth bearer token request invoke webservice smartapp http endpoint prior research demonstrate mobile apps incorrectly implement OAuth protocol due developer misunderstand confuse OAuth documentation limitation mobile operating OAuth insecure furthermore smartthings OAuth protocol smartphone app developer introduce another layer authentication smartthings client ID client secret securely android apps interface smartapps instance android app google smartthings recommendation chooses shorter insecure approach embed client ID secret bytecode incorrect smartthings OAuth protocol implementation steal OAuth token exploit related smartapp remotely VI attack verify unsafe groovy dynamic invocation webservice smartapps expose http endpoint via OAuth OAuth token scoped smartapp however developer endpoint data input endpoint handler groovy dynamic invocation invoked parameter def foo groovy def str foo foo invoked issue str jvm reflection internally therefore dynamic lend conveniently develop handler web service endpoint representation command http execute directly dynamic invocation apps feature vulnerable attack exploit overprivilege trick apps perform unintended action discus attack trick webservice smartapp perform unsupported action VI unsafe prone command injection attack sql injection attack api access unrestricted communication ability although smartthings framework OAuth authenticate incoming internet request smartapps external framework restriction outbound internet communication smartapps furthermore smartapps SMSs arbitrary via smartthings service choice allows malicious smartapps abuse ability leak sensitive information victim VI discus attack empirical security analysis smartapps understand security issue IV manifest smartapps smartthings app perform analysis apps potentially vulnerable drill extent apps overprivileged due flaw IV overall statistic dataset smartapps execute proprietary backend smartapp binary hub local execution therefore without circumvent security mechanism backend cannot obtain smartapps binary precludes possibility binary analysis smartphone application analysis however smartthings web ide developer apps groovy program web ide allows programmer source code source programmer browse smartapp developer code source code marked source user access source install apps source accessible web ide without option apps automatically network protocol analysis discover unpublished URLs interact backend retrieve source code smartapps display smartapps available july unpublished URLs another URLs intercept via ssl proxy companion app apps apps binary url similarly unique smartdevices device handler source code smartapps smartdevices manually source code opt automate approach described convenience purpose II breakdown dataset apps vulnerable upperbound VI subset apps actual vulnerability instance examine capability request apps overprivilege smartapps deployed II breakdown smartapp smartdevice dataset command attribute smartthings capability overprivilege measurement discus obtain capability constituent command attribute discus static analysis built compute overprivilege groovy smartapps capability july capability define smartapps however command attribute capability document overprivilege analysis capability definition prior binary instrumentation couple automate runtime behavior apps infer operation associate capability however option runtime inside proprietary backend overcome challenge analyze smartthings compilation information capability discover query compilation unpublished endpoint device handler ID return json capability implement device handler along constituent command attribute therefore simply auto skeleton device handler via python script implement capability auto device handler query smartthings backend command attribute summarizes dataset static analysis groovy code smartapps compile java bytecode analysis framework soot static analysis compute overprivilege however groovy extremely dynamic binary analysis challenge groovy compiler convert reflective reflection render exist binary analysis soot largely ineffective purpose instead abstract syntax ast representation smartapp compute overprivilege source code app groovy compilation  modify compilation llvm proceeds phase programmer execute phase compilation  execute stage compilation approach compiler  executes semantic analysis phase compilation  access site access smartapp filter capability documentation obtain command attribute program correctness randomly picked smartapps manually investigate source code potential source analysis error dynamic invocation identically modify analysis accommodate shortcoming flag smartapp manual analysis detects dynamic invocation smartapps flag actually overprivileged investigate smartapps dynamic invocation within webservice handler remote specifies command invoke device possibly command injection attack source error custom define smartapps identical smartthings command attribute cannot distinguish actual command attribute custom define manual analysis flag detects smartapps flag examination correctly marked overprivileged summary due source false positive apps marked overprivileged false positive rate software available http  eec  edu coarse grain capability smartapp compute difference request command attribute command attribute difference command attribute smartapp access IV summarizes smartapps smartapps overprivileged due coarse grain capability analysis conservative elect smartapps overprivileged cannot reliably overprivilege exists coarse smartapp smartdevice binding recall coarse smartapp smartdevice binding overprivilege smartapp obtains capability completely unused smartapp lock unlocks lock device handler expose capability lock capability  therefore lock unlock smartapp gain access lock code feature lock capability aim compute smartapps exhibit overprivilege IV overprivilege analysis summary however device handler associate physical device statically device handler smartapp specific capability precisely capability gain associate device handler therefore approach dataset device handler combination association lock lock smartapp assume asks capability  capability combination device handler implement capability combination obtain overprivilege combination hence limit combination analysis conservative bound overprivilege limit combination device handler implement capability combination smartapps exhibit overprivilege IV smartapps gain access additional command attribute capability smartapp explicitly request overprivilege usage prevalence smartapps command attribute capability explicitly preference desirable lock smartthings overprivilege feature overprivilege smartapps fix overprivilege become harder ideally another smartapps extra operation device explicitly operation user loop member smartapps exhibit overprivilege due coarse smartapp smartdevice binding however happens affect smartapp actually extra capability smartapps overprivilege wake smartapp slowly increase  wake determines dynamically smartapp command capability request welcome notification smartapp  player smartapp  player  smart device capability  capability switch developer relies smart access switch capability smartapp explicitly request developer separately request switch capability identical device selection screen installation VI proof concept attack concrete combine various security flaw developer bug IV weaken security attack exploit exist webservice smartapp steal OAuth token backdoor pin code lock attack steal lock pin code disable security setting vacation mode fake carbon monoxide CO alarm craft smartapps attack summary finally discus survey conduct smartthings user regard lock pin code snoop attack survey suggests participant limited understand security privacy risk smartthings platform participant respond interested instal battery monitoring app access lock participant report battery monitor smartapp perform lock pin code snoop attack pin code snoop attack disguise battery monitor smartapp unrealistic backdoor pin code injection attack demonstrate possibility command injection attack exist webservice smartapp OAuth access token steal smartapp android counterpart command injection involves command remotely OAuth induce smartapp perform action natively UI attack unsafe groovy dynamic invocation overprivilege insecure implementation OAuth integration smartthings proof concept attack popular android app google smartthings simplifies remote device interaction management refer app app app request user authenticate smartthings authorizes webservice smartapp access various device webservice smartapp developer app screenshot app app allows user remotely lock unlock ZWave lock smart outlet android app OAuth interact smartthings enables household member remotely manage device intentionally app proof concept attack smartthings attack obtain OAuth token victim smartthings deployment webservice smartapp unsafe groovy dynamic invocation inject appropriately format command OAuth steal OAuth token conduct investigate disassemble binary android app client ID client secret obtain OAuth token embed inside app bytecode client ID secret attacker replace redirect uri OAuth authorization url attacker domain intercept redirection broadly attack involves victim click link authentic smartthings domain redirect uri portion link replace attacker domain victim suspect anything url indeed victim genuine HTTPS login smartthings victim smartthings web smartthings automatically redirects specify redirect uri codeword attacker OAuth codeword client ID secret obtain app bytecode independently OAuth protocol smart document smartthings OAuth bearer token imply anyone token access correspond smartthings deployment stress steal OAuth token pre requisite attack perform completeness appendix additional detail inject command exploit overprivilege attack involves web service smartapp associate android app groovy dynamic invocation format command activate smartapp endpoint disassemble android app information reconstruct format command webservice smartapp smartapp unsafe groovy harder source code manually variation command  operation http return code command successful confirm command related lock accepted therefore transmit payload lock code webservice smartapp OAuth verify backdoor pin code lock command inject pertain exploit overprivilege  member capability  capability vulnerable smartapp automatically gain due smart capability model IV listing portion logitech harmony webservice smartapp available source mapping endpoint unsafe groovy dynamic invocation app vulnerable command injection attack return http command execute proof concept exploit webservice smartapp although attack exploit binary smart app listing portion logitech harmony webservice smartapp illustrative purpose vulnerable command injection command directly http sanitize summary attack creates arbitrary lock code essentially backdoor victim exist vulnerable smartapp lock unlock attack leverage overprivilege due smartapp smartdevice coarse binding  groovy dynamic invocation insecure implementation OAuth protocol smartphone app vulnerable smartapp attacker compromise android app directly unlock lock backdoor enables sustain access attacker android app patch user hub offline lock pin code snoop attack attack battery monitor smartapp disguise malicious intent source code battery monitor smartapp battery various battery device smartthings hub later VI user instal smartapp useful service smartapp asks capability battery snoop  lock pin code  FE lock attack app infrastructure consist  lock FE battery smart outlet smartthings hub infrastructure smartapp instal app performs lock code management smartapp user lock installation attack smartapp user authorize smartapp access battery device lock attack victim pin code lock manager app issue  command ZWave lock device handler handler issue sequence ZWave command hub generate appropriate ZWave layer signal device handler obtains successful acknowledgement hub creates  various data item plaintext pin code therefore battery monitor smartapp register  device authorize access upon battery monitor item data identifies lock code listing creation extract plaintext pin code disguise battery monitor smartapp unrestricted communication ability smartthings leak pin code attacker via SMS fundamental issue overprivilege due coarse smartapp smartdevice binding battery monitor smartapp benign asks battery capability gain authorization capability correspond ZWave lock device handler capability lock  refresh fundamental issue smartthings device handler plaintext pin code data accessible smartapp authorize communicate handler listing sample  code programmed ZWave lock groovy dynamic invocation disguise malicious code smartapp smartapp battery remote service functionality upon attacker web service battery monitor app battery remote service snoop lock pin code transmit via SMS attacker attack stealthy attacker appendix detail leak device enhance lock pin code snoop attack leakage IV unprivileged app learns device identifier device without acquire associate capability modify disguise battery monitor app device identifier ZWave lock verify  without battery capability attacker retrieve device identifier device identifier constant across apps device remove smartthings fix incrementing predictable hash item device identifier discus option collude smartapp attacker deploy benign collude smartapp device identifier various device leak unrestricted communication ability smartapps exploit another smartapp remotely earlier webservice smartapps exploit remotely attacker exploit webservice smartapp output device identifier device webservice smartapp authorize technique leak device identifier target physical device attacker transmit identifier instal malicious app stress intent smartapp device identifier escalate privilege disable vacation mode attack vacation mode popular automation simulates device occupy empty  potential vandal  picked smartapp dataset depends mode location mode desire smartapp activates occupancy simulation mode reset smartapp occupancy simulation recall IV smartthings security around  api attack smartapp false mode attack smartapp interferes occupancy simulation smartapp therefore disable protection vacation mode attack attack code launch smartapp without specific capability fake alarm attack unprivileged smartapp spoofed physical device escalate privilege device authorize access alarm panel smartapp app alarm panel app request user authorize carbon monoxide CO detector siren alarm device sensor sensor alarm panel smartapp siren alarm CO detector trigger attack smartapp fake physical device CO detector alarm panel app siren alarm therefore unprivileged attack smartapp misuse logic benign alarm panel app spoofed physical device siren alarm survey smartthings user attack user convince install attack smartapp pin code snoop disable vacation mode fake alarm although user limited understand security privacy risk instal android apps available user smart application ass attack scenario realistic conduct survey smartthings user focus smartthings user install apps battery monitor app request access battery device security critical household device lock security alarm user battery monitor app access user understand risk authorize security critical household device battery monitor app user reaction battery monitor app snoop pin code lock october november recruit participant workplace mail automation enthusiast smartthings discussion forum web participant smart enthusiast inclusion sample bias however affect attack trick experienced participant thesis attack realistic participant report smartthings hub device participant report hub almost average participant report smartapps instal upon survey checked response compensate participant  din workplace restaurant capture participant unbiased response app installation request mention security advertised survey smartthings app installation survey conduct researcher institution review approval restrict access survey response private data email address gift email address delete gift survey introduce battery monitor smartapp participant battery device already smartthings hub option instal battery monitor smartapp survey screenshots smartapp installation stage device selection UI survey device smartthings sensor smartthings presence sensor  lock  siren strobe alarm participant interested instal battery monitor smartapp response likert choice interested interested device participant battery monitor smartapp monitor survey participant understand lack thereof security privacy risk instal battery monitor smartapp survey risk derive smartthings capability participant action battery monitor app without besides monitoring battery  alarm beep occasionally disable  alarm spam email smartthings hub illegal smartthings hub battery remote server smartthings presence sensor remote server access code  lock remote server none battery monitor app action permit access relevant sensitive device survey participant upset risk response likert choice indifferent upset finally survey participant smartthings deployment VI survey response smartthings user VI summarizes response participant participant interested instal battery monitor app access lock suggests attack scenario VI unrealistic appendix contains survey response participant aware battery monitor app spy lock code leak pin code attacker participant concerned lock snoop attack although online survey safeguard smartthings framework desirable however limitation improve ecological validity actually install disguise battery monitor app hub access lock future vii challenge opportunity discus lesson analysis smartthings platform IV broadly applicable smart program framework highlight defense research direction lesson asymmetric device operation risk capability oven capability expose operation functionally similarly lock capability expose lock unlock functional however switch oven random switch oven  therefore functionally operation sometimes dissimilar associate security risk device operation inherently asymmetric risk wise capability model split operation equivalence secure functionally device operation risk however estimate risk challenge operation lightbulb risky operation alarm adapt user methodology smartphone apis input multiple stakeholder user device manufacturer framework provider splitting capability risk affect granularity furthermore granularity user comprehend effectively survey access model compete smart  HomeKit vera addition smartthings granularity none risk spectrum HomeKit authorizes apps device app gain access related device none vera granularity model spectrum  setup ACLs per interface  device  app however standard interface user configure ACLs upon app installation usability barrier regular user envision user establish granularity usability security lesson arbitrary identity mechanism smartthings subsystem smartapps cannot verify identity source smartthings selectively disseminate sensitive data app access device ID monitor device furthermore apps susceptible spoofed basis fundamental trigger action program paradigm therefore secure subsystem crucial smart platform notion app identity couple access around basis secure architecture mechanism enable apps verify origin data enable producer selectively disseminate sensitive however mechanism fundamental  HomeKit construct notion identity android intent cousin smartthings android apps intent ipc mechanism notification mechanism instance android OS trigger broadcast intent whenever battery however differently smartthings intent kernel enforce  basis identity enables intent receiver provenance information allows sender selectively disseminate intent however bug intent usage circumvent access permit spoof secure mechanism smartthings benefit exist research defend intent attack android operating vet app smart phone app research validate apps smart groovy security benefit feature misuse input execute technique validate smart apps code injection attack overprivilege subtle security vulnerability disguise source code unfortunately program framework provider smartthings app validation challenge remain security vulnerability due flaw smartthings apps vulnerability report due secret related android app smartapp android app clearly google vet unlikely google discover vulnerability ass risk smart user groovy app available google research multiple operator smartthings app google cooperate validate entire ecosystem pertains functionality smart app smart device associate program platform proliferate remain attractive consumer powerful functionality however finding caution warrant adopter framework designer risk significant unlikely easily address via security patch alone perform empirical security evaluation popular smartthings framework programmable smart analyze smartthings challenge apps proprietary platform framework protects communication component hub backend smartphone companion app perform overprivilege analysis exist apps smartthings capability model protects physical device associate data discover exist smartapps device operation request capability imply largely due coarse grain capability smartthings smartthings grant smartapp access device specifies limited access device smartthings subsystem inadequate security combine flaw vulnerability discover smartapps steal lock pin code disable vacation mode smartapp fake alarm without smartapps capability operation without physical access empirical analysis couple security lesson distil serf critical effort towards secure smart disclosure response disclose vulnerability identify smartthings december response january internal strengthen OAuth token april backdoor pin code injection attack attack vector consideration future release contact developer android app OAuth client ID secret bytecode developer communication smartthings address approach developer whitelist redirect uri possibility OAuth prevent arbitrary redirection smartthings security followup response april appendix detail  anonymous reviewer stephen  insightful feedback user participant kevin border kevin   fernandes mala fernandes sai  xiu guo alex     mao bryan  amir  david  feedback earlier draft  fernandes thanks microsoft research  stimulate environment initiate upon national foundation grant opinion finding conclusion recommendation express author necessarily reflect national foundation listing battery monitor smartapp source code app monitor battery request capability steal lock pin code behavior smartapp depends command web service battery service attack perform   upon configuration remote service attacker smartapp intercept leak pin code appendix OAuth token steal detail detail OAuth token steal disassemble android counterpart app webservice smartapp  smali android app developer cod client ID secret app bytecode client ID secret attacker OAuth independently android app specific attack involves craft attack url redirect uri portion replace attacker domain attack url http graph api smartthings com OAuth authorize response code client  scope app redirect uri http   com redact client ID android counterpart app url HTTPS url clicked user authentic smartthings login lock icon displayed redirect uri attacker domain craft smartthings url fairly redirect uri portion url encode decrease readability smartthings documentation recommends client ID secret server outside smartphone app authentication user android app prevents attacker compromise layer authentication incorrectly implement OAuth steal attack user authentic smartthings HTTPS login listing proof concept battery monitor app benign source code snoop lock pin code appendix survey response evaluate user instal smartthings apps app survey battery monitor app screenshot battery monitor app appendix vendor followup response april smartthings security initial response request message smartthings explores automate defensive capability address vulnerability already effective mention reduce business risk smart dedicate responsible review exist smartapps immediate mitigation analyze already publish application alike detect behavior expose http endpoint ensure  http request invoked dynamically member examine web service endpoint ensure benign operation smartthings effort enhance principle privilege limit scope valid access explicitly perform authorize action moreover intention update internal publicly available documentation formalize enforce administrative