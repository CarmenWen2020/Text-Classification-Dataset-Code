EMV chip pin payment worldwide throughout europe asia introduce america payment chip execute authentication protocol protocol sale POS terminal ATMs generate nonce unpredictable transaction ensure discover serious widespread implementation flaw deeper fix flaw EMV protocol flaw EMV implementers merely counter timestamps grown algorithm nonce expose pre attack indistinguishable clone standpoint available issue impossible clone physically clone fraud EMV suppose prevent detect vulnerability survey methodology developed scope weakness evidence atm terminal implementation proof concept attack flaw widely ATMs manufacturer explain increase fraud victim refuse refund EMV cannot clone customer involve dispute therefore mistaken  expose independent random quality protocol failure actual random generate terminal simply replace attacker earlier capture authentication code variant pre attack malware atm POS terminal terminal acquirer explore implementation mistake enable flaw evade detection shortcoming EMV specification EMV kernel certification implementation formal analysis monitoring customer complaint finally discus countermeasure initial responsible disclosure flaw action mitigate likely atm POS malware threat smoking EMV scheme worldwide debit credit payment cash withdrawal ATMs billion worldwide adopter issue EMV customer EMV smart chip clone magnetic strip precede EMV europe UK adopter deployed aggressive towards customer complain fraud cycle establish victim deny compensation google technical information fraud academic research researcher vulnerability discover kick research report   customer  refuse refund series transaction bill  claimed pin atm   june advise fraud victim demand transaction refuse delete dispute customer argue generality court recently criticise  detailed data file unpredictable UN increase steadily UN consist fix simply counter incremented millisecond cycling unpredictable generate atm predictable opportunity attack criminal temporary access  compute authentication code cash atm future UN predict scenario pre attack discover ATMs generate random attack indeed attack atm generates cryptographically random due flaw protocol responsible disclosure policy inform organisation atm software patch publishing research customer refund wrongly deny evidence pursue crypto security regulation community lesson considerable engineer fascinate unravel failure introduce persist undiscovered assurance scientific lesson revocation cryptographic protocol limit formal verification interplay protocol security economics organise II background EMV fraud overall technical background EMV transaction pre attack describes experimental developed data capture harvest UN sequence ATMs examine ATMs ebay VI describes protocol flaw vii discus defence scientific analysis crypto security community away EMV robust failure likely future employ cryptography authentication authorisation finally IX conclusion II background EMV developer   visa developed mid tackle develop threat magnetic strip counterfeit organise crime gang access manufacturing equipment clone data discard receipt skim surreptitiously legitimate sale POS later automate  machine ATMs payment terminal executes EMV protocol chip exchange transaction data seal cryptographic message authentication code mac calculate symmetric issue issuer detect counterfeit physical tamper resistance chip prevent attacker extract fraud UK issue payment fraud UK issue payment UK authenticate cardholder pin signature POS atm previously PINs ATMs goal harder steal simultaneous introduction chip pin commonly english refer EMV layman chip protects counterfeit pin steal abuse EMV fraud proponent predict counterfeit steal become criminal adapt transaction internet mail phone payment remain beyond scope EMV magnetic strip clone EMV atm skim crook device atm throat capture data PINs PINs demand everywhere ATMs opportunity skim increase hugely simultaneous deployment EMV magnetic strip fallback backwards compatibility feature EMV exploit ATMs accept mag strip phase UK locally issue mag strip clone UK ATMs usa completion UK EMV rollout counterfeit fraud instead PINs ATMs customer pin POS terminal easy tamper fraud improvement fraud detection mechanism aggressive tactic towards customer dispute transaction reduce UK ATMs accept fallback magnetic strip transaction EMV issue fallback fraud criminal community sophisticated smart attack prior research steal EMV POS device without pin suitable device crook trick terminal pin authorise chip signature transaction criminal trial france exploit pin vulnerability however pin vulnerability explain contact author refuse refund atm POS transaction  deny  sue refund lose judge conclude customer probably clone destroyed file despite dispute underway contrary visa guideline judge warn court tolerant behaviour future unknown UK fraud quote loss merchant customer blame introduction EMV liability shift transaction dispute pin customer liable pin transaction merchant dispute transaction pin fraud customer attempt fraud customer  customer regardless pin attack category ideal viewpoint customer british crime survey fraud victim despite guideline european payment service directive customer   refund fully refund loss lose lose gap statistic crime survey vulnerability expose explain  attack compelling explanation overview atm transaction EMV transaction consists phase authentication detail authenticate atm POS terminal cardholder verification verify pin signature transaction authorization issue decides transaction proceed principal atm issuer illustrate description somewhat simplify typical UK transaction slightly substantially authentication data atm expiry date protocol option static rsa digital signature aim prevent crook fabricate account dynamic signature generation capability dynamic data authentication DDA authentication cardholder verification proceeds signature pin atm transaction involve customer enters pin pin pad encrypt return issuer verification atm network finally transaction authorization atm sends various transaction amount currency date terminal verification  various perform atm nonce EMV terminology unpredictable UN responds authorization request  ARQC cryptographic mac calculate data data application transaction counter ATC incremented transaction issuer application data  proprietary data information issuer ARQC atm issuer along encrypt pin issuer verifies pin ARQC recalculate mac data additional sufficient fund available report steal risk analysis software flag transaction suspicious issuer return atm authorization response code arc authorization response   destine arc  atm dispense cash arc  verifies  typically mac ARQC exclusive arc return authenticate settlement transaction certificate TC issuer immediately later settlement outline EMV transaction atm message atm verify message issuer atm scheme outline EMV transaction atm message atm verify message issuer atm scheme POS transaction proceed similarly cardholder verification usually perform pin pin verify locally online difference attack POS device generates unpredictable predict vulnerable pre attack IV variant pre attack normal EMV transaction sends ARQC atm alive engage transaction atm relies issuer verify authorise transaction simply replay ARQC competent issuer prevents replay reject transaction application transaction counter ATC already ATC prevents replay attack cannot assure issuer ARQC compute yesterday ensure freshness nonce unpredictable UN generate atm however discover flaw UN almost redundant specification engineering flaw predictable UNs exploit deeper fix protocol flaw allows attacker arbitrary UN pre attack flaw additional classical protocol mistake entire EMV vulnerable pre attack specification flaw enables pre attack EMV identity terminal classic protocol mistake strikingly reminiscent notorious  lam protocol EMV framework designation  ARQC  standard format developed visa version  format terminal code attacker skim data trivial predict advance specification flaw atm POS terminal generates predictable random pre attack authentication data played verify later already data harvest practical implementation tamper terminal detail ARQCs pin victim later ATMs indeed attacker predict UNs atm harvest ARQCs atm date future discus variant detail deeper protocol flaw terminal generates random issue relies device terminal attack random generation attacker ARQC response nonce terminal actually generate nonce terminal sends ARQC along transaction data mitm transaction accepted terminal  malware debit multiple arbitrary amount discus variant detail VI pre attack weak rng EMV protocol designer carefully UN unpredictable specification conformance procedure simply consecutive transaction perform terminal unique unpredictable CM rational  consequence probably prefer counter cryptographic random generator rng latter probability fail conformance birthday paradox version EMV specification guidance generate unpredictable previous version algorithm entirely implementers construction hash exclusive previous ARQCs transaction counter adequate generate truly unpredictable ARQCs zero atm reboot transaction counter predictable attacker predict unpredictable ahead harvest ARQCs atm atm  research counter attacker ARQCs counter cycle atm attack calibrate atm counter initiate transaction counter capture ARQC theory viable experimental pre attack EMV theoretically attack practical challenge approach survey exploitable vulnerability skim data deploy attack stage criminal reasonable yield acceptably probability identify vulnerable ATMs identify vulnerable ATMs approach analysis file collection UNs reverse engineering ATMs analysis file regularly investigate atm withdrawal behalf customer dispute detail minority detailed  research suspicious UNs responsible disclosure vulnerability brand deliver random analysis toolkit feedback finding anyone dispute atm transaction vulnerability explanation  analysis vulnerability online service firm retain UN particularly interested UN data italy aware UNs routinely customer receipt active probe ATMs atm available timestamps accuracy millisecond grossly  UN generation algorithm identify researcher crook data collection approach moderately covert public aware atm skim primitive analysis repeatedly atm arrest therefore construct passive monitoring atm protocol analyser circuitry consist additional microcontroller data storage memory standard debit plastic rear chip remove knife expose chip package cheap  cutter carefully mill away plastic chip slot carefully remove plastic avoid chip encapsulate epoxy relatively mechanical damage surgery    package glue protection resistor plastic chip terminal pin microcontroller operates directly terminal memory chip data storage additional interfacing circuitry package memory chip standard  package slim carefully mill  remove glue inside finally component magnify component pin interface built program microcontroller atm transaction data PC via RS connection initial laboratory circuitry epoxy caliper ensure profile stuck atm epoxy pot circuitry brittle careful handle harvest attempt conflict desire maintain profile behaving normal atm user normal become transfer storage wallet approach atm guard lose UNs harvest ATMs insert dummy transaction logger perform transaction terminal emulator laptop passive monitoring EMV chip monitoring microcontroller flash storage passive monitoring EMV chip monitoring microcontroller flash storage modify remains valid payment transaction proceeds normal accepted however insert variety ATMs POS device without arouse suspicion primitive approach laptop trail slot ATMs internally reading monitoring equipment wireless relay transfer data outside adapt compatible atm slot overlaid shim glue exist ultra shim consist simply antenna suitably data tempest technique POS terminal sale assistant briefed away pin entry avoid handle customer exist monitoring smart detective proven suitable surreptitious hidden experimenter  detective analyze unpredictable POS terminal agreement POS owner atm investigate harvest fifty unpredictable perform balance enquiry cash withdrawal balance enquiry minimises withdrawal withdrawal trigger fraud detection retain component labour desirable avoid capture ATMs reverse engineering atm code understand generation unpredictable inside ATMs acquire machine analysis EMV enable NCR   ATMs acquire via ebay recent service service development  jack described ATMs service easily simply phone  perform analysis hardware software ATMs although analysis complicate obsolete architecture atm OS another primitive hardware  cpu identify manufacturer EMV kernel information inside atm documentation website indicates EMV kernel external source randomness hardware analysis reveal presence dedicate crypto chip implement DES theorise hardware random pseudo random source currently confident byte unpredictable independently generate cpu resource DES chip realtime chip possibly smart  access via serial interface ATMs acquire reverse engineering ATMs acquire reverse engineering outset primitive platform likely source randomness platform however broader research across atm POS indicates subtly conclusion entirely platform likely typical OS resource random generation nowadays relatively meanwhile legacy platform weak randomness issue designer curiously legacy platform environment likely weak randomness random generate custom legacy platform simply mapped across easy standard library rand function summary important lineage atm POS software platform estimate likelihood vulnerability analyse rng described approach data collection approach data analyse RNGs EMV device local perform transaction across ATMs POS terminal successful ATMs weak RNGs attacker identify specific UNs likely predictable future ineffective rng obviously weak rng algorithm counter directly UN  algorithm combine obvious transaction data severe program error algorithm limited cast integer submit bcd cod random byte truly random byte rng flavour linear  generator encryption messy scheme fix cycle machine random tight loop cycling embed standpoint typical option standard library rand neither unpredictable output cryptographic rng predictable simplest failure mode rng fed weak source randomness restart attacker outage replenishment crew propose rng algorithm untrustworthy source rng data previous transaction attacker insert rng temporarily spoof authorisation response rng predictable detail hardware reverse engineering detail hardware reverse engineering II selection data various ATMs broadly category ineffective algorithm atm atm typical characteristic denote characteristic nibble UN zero alone reduces entropy unpredictable ATMs exhibit characteristic non uniform hypothesis data ATMs significance transaction sequence atm characteristic proven however analysis beyond confirm characteristic yield statistically significant ATMs wildly operating exhibit characteristic artifact EMV kernel processing rng source rng source atm POS device simply standard library rand function weak source analyse data technique spectral analysis complicate unknown processing rng EMV library byte unpredictable sample separately rng hence modulo cast almost certainly postprocessing output multiple rng UN available detect per sample consecutive UN reduces potential interference service within atm transaction sequence atm category possibly empirical analysis detect reverse engineering II consecutive unpredictable retrieve local POS terminal remain integer UN generation adequately understood attacker UNs maximise yield subsequent cash phase target atm profile intend withdrawal amount code date gang tasked harvest ARQCs vulnerable atm rng identify attack proceed harvest data temporary access EMV holder prepared pin unpredictable harvest crook program evil terminal static data generate AC obtain ARQC TC UN perform dedicate device tamper sale terminal  machine atm programmed perform operation instead legitimate transaction criminal already ability tamper equipment industrial sophistication ARQCs harvest dozen limitation legitimately sabotage POS customer machine authorisation thirty standard authorisation limit transaction skim II categorise unpredictable cash deploy attack rng counter attacker atm transaction precisely counter tick impractical synchronise merely insertion machine smart built counter onboard initiate relevant protocol smart delay processing response almost indefinitely request signal byte timely insertion delay millisecond specialise smart rtc absence external capacitor rtc synchronise internal resolution timer amount atm arrives EMV protocol unpredictable sample feasibility attack depends timer atm sample timer synchronisation resolution however straightforward relax timing requirement attacker harvest transaction consecutive unpredictable attack attempt synchronisation unpredictable return atm internal lookup UN  failure transaction harvest skim timing requirement relaxed factor modify chip pin terminal tetri modify chip pin terminal tetri ATMs employ stateful predictable pseudo random RNGs implementation detail attacker sample unpredictable predict subsequent synchronisation technology developed entirely offline  ATMs without interact payment network illustration attack implementation evaluation construct proof concept implementation stage attack modify smart data collection identify ATMs UN generation data implement python EMV terminal implementation modify EMV terminal data attack implement clone   platform ARQC generation  viability attack protocol proof consists  load ARQC generation initialise ATC handle identically skim trace harvest data program pre trace pre version identical protocol impossible atm distinguish pre detail transaction perform transaction perform trace transaction generate AC response confirm cryptographic generate  identical ARQCs skim pre programmed data data transaction perform transaction perform pre trace transaction identical confirm pre indistinguishable VI deeper pre attack due protocol flaw UN generation algorithm patch protocol attack variant pre attack viable malware infection already numerous malware infect ATMs operating eastern europe internal architecture atm easy malware sabotage choice UN atm kick research project infect malware chain attack attack already POS terminal harvest magnetic strip data feasible criminal adversary sabotage rng deliberately predictably predictable mode trigger via covert channel suitably sabotage rng probably detect via reverse engineering observation attack collusive merchant merchant maliciously modify EMV stack vulnerable inject replayed data authorisation settlement crook clone pre transaction directly UK clone attack  gang bribed manager pin pad tamper monitoring device insert network connection exactly deploy pre attack recently transaction dispute customer purchase merchant terminal variant terminal bypass transaction merchant terminal acquirer hack  unpredictable trigger signal account ARQC transaction data normally sensitive within threat model alter merchant software attacker perform replay UN ARQC random UN terminal provision currently deployed EMV terminal confirm choice UN correctly cryptographic mac terminal  implement malware evidence botnets POS device merchant evidence merchant already tamper transaction data transaction pin verify shift liability UN modification network device POS device acquire network switch deploy attack attractive attack merchant transaction  investment firm guard premise POS equipment target attack pre attack harder detect fashion attack convert deny authorisation message approve message overview pre attack weak rng tamper UN atm version pre attack longer profile atm POS terminal attacker simply arbitrary UN obtain related transaction data ARQC victim replay transaction data terminal replace terminal UN chosen via described shortcoming EMV protocol upon freshness protocol responsible generate issuer depends merchant transaction freshness merchant incentive deliver correctly due lack authentication issuer collusive directly indirectly recently formal analysis EMV flaw discover UN model nonce EMV omission understandable actual specification UN bury annex EMV specification issuer terminal model individual whereas reality rely issuer limited terminal behaviour terminal communicates acquirer sends transaction switch finally relay transaction issuer approximation abstract away acquirer switch EMV protocol ideal protocol  atm issuer algorithm analysis ban logic  communicate concludes infer epoch however nonce NG terminal nonce NT infer anything formalise carefully cannot rely communication merchant issue encryption authentication atm networking mac compute link acquirer switch issuer necessitates hardware security module node direction mac verify inbound recalculate outbound dozen extra HSM greatly increase network latency HSM fleet institution absence significant network attack  business decision optimise MACs away  actually implement protocol rely anything assumption pioneer authentication undermined later progress   protocol famously bug protocol stall extend fourth message session compromise cannot revoke   defend openly assume principal execute protocol faithfully therefore behaviour priori exclude model equipment fails spice occasional malicious insider careful revocation exactly deployment EMV across ecosystem vendor merchant billion careful principal incentive execute task  indeed reality EMV merchant hostile payment thanks  payment transaction   retailer payment network aware merchant deliberately falsify data transaction pin verify fraud reduce  issue cannot trust merchant terminal vendor implement decent random generator vii limitation defence limitation pre attack attack chosen advance date attack chosen advance amount chosen advance pin chip pin transaction ATC limit attack defence random attack variant attack unpredictable ahead attacker terminal ID atm transaction rarely request generation ARQC clone vulnerable atm code simplest fix cryptographically secure random generator UN attacker approximately ARQCs decent probability transaction atm realistic concern EMV disable transaction transaction atm rapidly propel machine  fix random generator acquire atm vendor merchant POS terminal supplier fraud issue customer hopefully article reduce likelihood risk dumped unfairly customer issue attacker request ARQCs issuer gap ATC sequence issuer probably reject online transaction ATC ATC limit attack genuine offline transaction however cannot  defence protocol attack defence protocol attack medium almost certainly issuer  verify transaction certificate TC TC verify   compute issue verify ARQC presence pre attack TC verify  issuer authentication successfully detail external authenticate happens transaction authorization cannot  cannot generate without issuer involvement impair ability generate ARQC happens external authenticate attack detect issuer examines TC  TC EMV specification additional standard define visa commonly implement detail  indicates external authenticate perform succeed although prevent attack TC issuer terminal transaction normally detection later genuine transaction dispute terminal immediate alarm suspicious TC prevent fraudulent transaction significantly reduce criminal income visa transaction acceptance device device operating message host capture environment ensure TC generate approve transaction although clearing generate TC ensures request unnecessary online approval subsequent transaction liability protection acquirer mitigate acquirer liability processing concern liability cardholder victim pre attack court series dispute transaction terminal cardholder collusion protocol pre attack forensic therefore examine TC valid TC generate  generate ARQC active  generate totally exclude possibility fraud relay attack pre attack unlikely another approach increase difficulty attack commit ATC atm UN without modify mandatory feature EMV data command retrieves ATC pre exactly predict UN transaction ATC affect difficulty however prevent available ARQCs however technique available terminal supplier usually acquirer issuer risk loss risk court realise pre attack non defence public authentication feature EMV static digital signature data trivially pre however examine transaction discover terminal verification  transaction authorization indicates digital signature verify decision digital signature atm manufacturer verify signature CPUs ATMs maintenance update certificate counterfeit detect transaction authorization public challenge response protocol EMV dynamic data authentication DDA adequately terminal attack DDA commonly ATMs attack sale terminal signature response internal authenticate command replayed ARQC POS terminal unpredictable terminal internal authenticate command generate AC command protocol specialist randomness generate relies terminal request nonce issue commence transaction weaker cheaper option terminal authenticate message convey nonce issue however latency processing authentication commonly optimise away payment message alone extra message practical alternative arbitrator shift burden proof transaction dispute acquire demonstrate unpredictable properly generate terminal equipment audit various generator encrypt underlie sequence reveal lock transaction establish limit pre tamper however entirely trivial secure storage audit data terminal creates opportunity attack discussion potential vulnerability EMV random generator abstract   moore additionally explore otherwise secure random generator manipulate deterministic output random generator exist implicate fraud exploit EMV specification adequately random exploit scenario described variant relay attack explore context EMV   relay attack realtime directional communication genuine genuine attacker attack deploy attack false terminal parking meter attract cardholder communicate crook false atm deployed rumour another variant relay attack pin attack device trick terminal accept transaction pin deployed crook  loss euro incident random pre attack clone already fake magnetic strip magnetic strip genuine magnetic strip data chip EMV another approach static data chip clone chip transaction offline limit cannot valid ARQC TC prevent transaction responsible verify pin programmed accept pin pre attack powerful respect online transaction others transaction parameter advance crucially pre attack ATMs typical attack involves buying cigarette resale convenient steal cash directly fraud commit fully clone ARQC generation pre data however clone ATC diverge due detectable clone attack powerful pre attack protocol pre attack  version described terminal compromise duplicate transaction clearly variant terminal data harvest remote terminal cash gang succeed compromise terminal UK physically gang mid compromise communication ARQCs harvest location another takeaway message attacker subvert merchant premise access terminal equipment purchase network connection transaction indistinguishable clone issue EMV clone impossible EMV attack crook manipulate protocol evidential issue dispute viability pre attack significant legal ramification longer grant data transaction harvest claimed undermines reliability evidence civil criminal transaction random generator atm POS issue dispute customer attack greatly complicates cannot rely data data atm operator atm infect malware random generator vulnerable due failure chain attack acquirer terminal mere certification EMV kernel discharge burden practical  acquire cooperate issuer international exist visa guideline retain dispute recent dealt routinely destroyed regardless dispute progress already cannot cope dispute resolution issuer dispute already scrutiny acquirer atm operator dispute resolution harder feasible liability destroy evidence become automatically liable sum dispute burden proof customer payment service directive already dispute resolution UK financial ombudsman service routinely ignore destroy evidence discus issue evidence response disclose flaw scheme payment switch emphasis random variant realise powerful protocol variant acknowledge receipt contact scheme chose circulate contact circulate report vulnerability disclosure report downloads vast majority contact refuse april  publish specification update partially tackle random generator bulletin unpredictable truly unpredictable access previous infeasible attacker unpredictable terminal generates  approval procedure terminal random generator strengthen almost disclosure protocol flaw fleet EMV terminal remain vulnerable attack involve terminal malware manipulation communication particularly shock insider  probably involve atm malware beyond impact influence specification informal response extent whereas others report already suspicious strength unpredictable others explicitly aware assertion evidence systematically suppress information vulnerability fraud victim deny refund IX conclusion EMV protocol worldwide payment universal europe adoption asia stage america deployed billion issue scrutiny academic medium alike customer complain fraud EMV secure mistaken dispute transaction vulnerability another discover exploit criminal mostly independent security researcher  report shock ATMs sale terminal seriously defective random generator counter EMV specification encourages successive terminal unpredictable pas crook transient access payment programmer terminal  harvest authentication code enable clone ATMs elsewhere disclose pre attack limited terminal defective random generator lack transaction authentication modify transaction precomputed authentication code route terminal acquire edit unpredictable pre computation insert device payment terminal attacker insert terminal acquirer malware terminal attack EMV protocol protocol implement tamper resistant module malware cannot penetrate ignore attack involves access specific physical installation malware wiretap specific terminal disagree target compromise criminal deploy malware merchant terminal widely exploit earn serious terminal mobile phone expose flaw industrial exploitation malware mobile phone population easily terminal fleet recent announcement payment via phone longer rely cryptography sim secure tee malware flaw challenge authentication exist model verification easily apply complex multi stakeholder environment indeed EMV already verify secure explain verification sort analysis instead ultimately robust mutually  occasionally hostile involve theoretic analysis protocol theoretic model addition mechanism fix across network instal terminal externality incentive pain deserve technical mechanism prospect remedial action  meantime structural governance failure systemic risk regulator  accept banking assurance credit risk management regulator  accept assurance operational risk management multi issue acquirer scheme operator fix unilaterally cannot rely complex negotiation merchant vendor regulator welcome federal reserve attention european regulator