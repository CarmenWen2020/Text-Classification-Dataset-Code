mobile device worldwide rely trust execution environment TEEs built trustzone protection security critical application drm operating OS component android keystore TEEs assume highly secure however TEEs successfully attack multiple highly damage impact across various platform unfortunately attack presence security flaw tee aim understand vulnerability limitation affect exist trustzone assist tee challenge correctly contribution borrow research community overcome security analysis popular trustzone assist tee target cortex processor developed qualcomm trustonic huawei nvidia linaro publicly document exploit vulnerability reverse engineering tee firmware identify critical vulnerability across exist legitimate reasonable concern security commercial tee implementation introduction trust execution environment tee security mechanism integrity confidentiality application leverage dedicate hardware TEEs enable execution security sensitive application inside domain isolated platform operating OS trustzone become facto hardware technology implement TEEs mobile environment employ industrial server device future trillion trustzone enable iot device worldwide TEEs secure environment data processing trustzone assist TEEs generally assume secure OSes due hardware separation enforce trustzone technology trust compute TCB magnitude standard OSes TEEs become widely adopt secure mobile device malware instance android platform incorporate trustzone assist TEEs secure application specific operation involve user authentication online banking drm unfortunately exploit cast doubt security guarantee exist commercial TEEs effectively perform systematic publicly disclose vulnerability commercial trustzone assist TEEs cortex device despite existence multiple security report affect information tends scatter unverified obtain comprehensive understand prevail vulnerability overall security gap analyze tee bug report span nearly mid focus widely deployed tee developed device vendor qualcomm trustonic huawei nvidia linaro examine categorize numerous vulnerability leveraged successful attack analysis along manual inspection tee firmware gain multiple insight extent exist vulnerability potential mitigate observation tee critical implementation bug numerous bug inside tee application trust application TAs inside trust kernel responsible manage tee runtime bug involve classic input validation error buffer overflow multiple attack bug leveraged hijack android linux kernel entirely compromise tee kernel device feature TEEs qualcomm trustonic huawei exploit vulnerable TAs facilitate numerous architectural deficiency trustzone assist tee instance memory protection mechanism commonly OSes ASLR guard almost absent ill implement analyze tee tend expose attack dangerous tee kernel invoked TAs qualcomm tee TA memory host OS hijack vulnerable TA leverage buffer overflow attacker easily android important hardware overlook trustzone architectural microarchitectural compromise security tee vulnerability unexpected behavior trust hardware component due microarchitectural channel cache others component leveraged exfiltrate sensitive data tee restrict memory instance via reconfigurable hardware FPGAs embed socs although remain software defense mechanism currently implement TEEs lag considerably defense incorporate commodity mainstream OSes propose research community argue adopt date defense commercial trustzone assist TEEs significantly secure capable counter prevail vulnerability collection relevant defense technique accord suitability address specific issue architectural implementation hardware issue summary contribution systematic vulnerability widely trustzone assist tee analyzes architectural flaw tee perspective OSes IV introduces taxonomy classify implementation bug likely exploit tee awareness hardware leveraged attack TEEs VI analyzes defense technique propose research community vii trustzone assist TEEs perspective alternative tee enable technology II background motivation context trustzone assist TEEs motivates impact tee vulnerability security widely mobile device trust execution environment trustzone tee isolated environment secure processing sensitive data without rely integrity OS TEEs aim guarantee secure execution program TAs  tee rely trust hardware trustzone application processor cortex recently engineer generation microcontrollers cortex focus primarily cortex trustzone implementation widely mobile device trustzone around concept protection domain secure SW normal NW physical processor core virtual core secure SW non secure NW mechanism securely switch identify NS processor identifies execute hardware logic trustzone enable  bus extends security processor component ensure SW resource cannot access NW component software architecture trustzone assist tee typical software architecture trustzone assist tee untrusted OS inside NW execution environment ree tee software component SW inside SW trust OS supervisor mode protection EL runtime sustain lifecycle TAs user mode protection EL core trust OS trust kernel OS primitive schedule manage TAs trust OS additionally implement device driver access trust peripheral handle request switch smc instruction memory implement library cryptographic tee primitive namely remote attestation trust secure storage software architecture trustzone assist tee beyond trust OS tee comprises fundamental software component secure monitor implement mechanism secure context switch privilege protection EL tee bootloader bootstrap tee secure critical implement trust boot primitive split EL EL trust OS secure monitor tee bootloader constitute software TCB typical tee tee designer aim bug implementation attack tee enable device critical security vulnerability identify tee widely deployed mobile device vulnerability exploit acquire privileged access target device sensitive information therein explain achieve representative exploit hijack critical component tee enable device tee kernel ree kernel linux altogether exploit demonstrate escalate privilege user NW application platform qualcomm tee methodology successfully employ attack device feature popular tee compromise tee kernel target qualcomm tee  tee developed qualcomm gal  hijack tee kernel unprivileged user NW application escalate privilege linux kernel exploit android  privileged access tee driver elevate privilege linux trustzone driver access smc interface exploit advantage bug tee kernel achieves arbitrary code execution EL privilege SW tee kernel attacker launch attack hijack guest TA extract secret android disk encryption unblock device bootloader compromise tee kernel access interface vulnerable TA attacker hijack  TA drm service android OS vulnerability interface attacker elevate privilege tee kernel representative vulnerability exploit  qualcomm tee diversity affected component security impact representative vulnerability exploit  qualcomm tee diversity affected component security impact compromise ree kernel additionally compromise linux without gain tee kernel achieve vulnerable TA trampoline privilege elevation linux kernel instance exploit allows attacker linux kernel craft input user NW application  TA vulnerability TA along  TAs NW physical memory enable attacker modify memory allocate linux kernel extent exploit developed qualcomm tee beyond mobile device shipping qualcomm chip platform attack namely device trustonic tee rename   huawei proprietary tee trust core exploit adopt conquer strategy trustonic tee estimate billion device mostly samsung huawei mobile device widely adopt tee flaw impact worldwide overview overview security vulnerability commercial trustzone assist tee methodology perform comprehensive security assessment commercial tee entail challenge source code available binary tend inaccessible analyze due lack documentation employment code obfuscation technique additional complexity existence legacy tee software version vendor diversity heterogeneity trustzone hardware cope challenge adopt methodology adversary model attacker pursues objective obtain secret tee obtain secret ree escalate privilege ree kernel escalate privilege tee access smc interface exclusively NW directly obtain code execution privilege supervisor mode EL craft arbitrary smc indirectly unprivileged user application EL issue command target TA NW component assume untrusted analyze tee analyze tee qualcomm trustonic huawei nvidia linaro nvidia maintains proprietary tee mostly nvidia chip linaro maintains OP tee source tee software popular trustzone development actively maintain widely adopt commercial purpose amount information obtain exclude research prototype  commercial currently deployed  relevant vulnerability hardware channel sake readability henceforth refer analyze tee software qualcomm tee  II source report cve cve database sve sve database SP scientific publication MR miscellaneous report SC source code data source resort multiple source grouped II analyze bug report cve database relative tee retrieve cve report publish officially qualcomm nvidia huawei document respective security bulletin additional cve report relevant keywords tee trustzone etc bug report samsung vulnerability exposure sve database assign specific cve IDs analyze scientific publication SP security conference miscellaneous report MR available online inspect source code SC TEEs public source code namely linaro OP tee OP tee analyze  identify security fix interviewed designer classification disclose security vulnerability vulnerability report manually analyze categorize vulnerability assign CVSS adopt classification metric attribute rating comprises category critical CVSS severe CVSS medium CVSS CVSS severity specific vulnerability security implication critical vulnerability normally compromise confidentiality integrity tee ree binary analysis obtain accurate detail tee reverse engineer subset quantify TCB specific software architecture huawei trust firmware  secure monitor software qualcomm implementation analyze memory protection feature implement tee trustonic tee analyze firmware samsung galaxy exynos version  qualcomm tee pixel XL firmware version  huawei tee lite image  LCB threat validity vulnerability proof concept exploit cve description detail identification classification vulnerability imprecision lack information regard vulnerability exist proprietary inaccurate classification risk representation tee particularly publicly report vulnerability largely  extra conclusion lastly analyze vulnerability previously report unknown vulnerability exist reveal additional fundamental security issue tee disclose CVEs per summary observation analyze vulnerability report commercial TEEs namely tee qualcomm trustonic huawei nvidia report obtain cve database classify severity manually identify tee vulnerability quantifies disclose vulnerability associate accord severity almost bug report rat critical severe report disclose security vulnerability critical surprising tee analyze non severity vulnerability trustonic critical vulnerability nvidia huawei respectively classify severe collectively widely deployed user worldwide seriously affected vulnerability although qualcomm tee account disclose vulnerability caution cannot conclude data secure tee similarly individual TEEs due disparity methodology regard cve reporting simply consequence reporting diligence qualcomm developer user however useful establish bound vulnerability aggregate trend tee trend trend instance entire linux operating magnitude TEEs CVEs TEEs linux OSes complexity   OSes account relative percentage critical severe vulnerability observation development methodology popular TEEs robust development methodology benefit adoption methodology detailed architecture tee relevant feature communication NW application SW mediate privileged OS daemon trustzone driver issue smc SW monitor  consists reference implementation secure bootloader monitor software source vulnerability trustzone assist TEEs overall identify source security vulnerability exist tee architectural implementation hardware architectural issue involve deficiency overall tee architecture absence memory protection ASLR implementation issue correspond flaw tee software buffer overflow hardware issue concern hardware behavior abuse undermine security tee channel extent persist apart incremental improvement tee preserve architectural feature retain serious weakness critical severe vulnerability trustonic tee suffer important architectural limitation vulnerability report abound reveal presence critical implementation bug bug exploit attack described identify bug exploit concurrency bug hardware issue prevalent trustzone enable socs potentially leveraged launch highly damage attack future finding detail issue IV architectural issue architectural security issue exist tee issue category refer reader diagram specific internal detail tee attack tee expose attack potentially exploit compromise overall security SW driver tee kernel tee existence driver SW mediate access security sensitive device fingerprint sensor user authentication purpose display  secure output drm content driver tend complex traditional source bug tee kernel EL mode trustonic nvidia approach adopt microkernel architecture driver SW user EL contrast qualcomm huawei linaro tee driver EL mode qualcomm linaro adopt monolithic architecture privileged code kernel huawei delegate trust OS functionality user namely lifecycle TAs assign privileged TA  interface tee subcomponents interface become  tee android OS daemon privileged access trustzone driver smc interface expose tee kernel NW software access considerable TAs trustonic tee TAs command handle TAs tends fairly instance  TA implement command manipulate complex medium data structure tee kernel expose TAs syscalls qualcomm tee moreover access permission tee frequently coarse grain qualcomm tee TAs promiscuous access interface secure driver trustonic tee TA access fingerprint device driver access virtually TA deployed TA issue instrumental development exploit excessively tee  philosophy tee rely TCB verify principle tee analyze TCB firmware available source code TAs implement security sensitive ree function TCB trust OS TAs IV reference OSes  tee substantial MB qualcomm tee conservative additional TAs firmware package dynamically load strikingly TAs individually considerable confidence correctness TAs weaken TAs accept input NW via  potential vulnerability expose easy exploitation TCB perspective IV although exist tee kernel significantly linux kernel magnitude considerably microkernel comparable complexity sel IV TCB tee reference OSes respectively obtain tee binary loadable TAs firmware image file source software compile enable optimization code  isolation normal secure tee enforce isolation NW SW enable efficient communication across tee isolation undermined exposure dangerous tee kernel TAs physical memory NW application drm video render efficient memory mechanism allows exchange volume data across latency however tee mechanism easily abuse privilege escalation qualcomm tee expose trust OS allows TA physical memory belonging NW ree OS kernel compromise TA attacker automatically takeover android OS scan physical address linux kernel patch introduce backdoor contrast trustonic tee prevents TAs mapping modify physical memory instead operation restrict specific driver TAs hence TAs willing exchange data volume via memory issue request dedicate driver TA samsung approach split functionality trustzone integrity measurement architecture  TA driver ability physical memory another TA service integrity image prevent access TA driver arbitrary TAs however cod TA driver TAs fairly compromise TAs attacker hijack android information leak NW debug channel another source isolation breach leakage information SW NW via tee debug mechanism exploit described facilitate feature privilege escalation attack leverage huawei tee allows TA application dump stack trace memory NW mechanism attacker physical address  information craft exploit debug expose NW trustonic tee disclose sensitive information internals TAs memory protection mechanism tee exploit facilitate poorly memory protection mechanism summarizes finding respect mechanism implement analyze tee highlight issue absent weak ASLR implementation analyze tee ASLR absent poorly implement trustonic tee TAs load fix address virtual address TA library mapped constant address TA  vulnerability TA exploit without extra effort TA load address furthermore library  contains substantial amount code source gadget function invoke trust OS etc memory protection mechanism user supervisor mode fully implement empty partially implement implement dash implementation related information likewise huawei nvidia linaro TEEs ASLR mechanism qualcomm tee ASLR TAs physical memory TA code load TAs load relatively continuously allocate physical memory span around MB consequently amount entropy ASLR limited theoretically implement entropy ASLR virtual address ASLR implement qualcomm tee limited approximately greatly reduce attacker TA address none tee feature KASLR ASLR tee kernel stack cooky guard execution protection addition ASLR OSes employ additional memory protection mechanism stack cooky SC unique detect stack smash instance abort program execution guard GP delimit mutable data namely stack heap global data prevent attacker overflow corrupt another trigger fault illegal access execution protection XP prevents program execute within memory achieve various   register whereby writable memory implicitly marked execute XN another option memory attribute XN unprivileged XN  privileged  however tee partially implement mechanism facilitate exploitation trustonic tee spite security driven goal lack stack cooky relatively easy exploit stack overflow vulnerable TAs allocates globals stack TA data without guard moreover memory layout stack data globals perfect configuration overflow qualcomm tee implement randomize pointer stack cooky guard globals heap stack huawei tee stack canary data execution protection text possibly huawei tee  OS RTOS leaf aside memory protection mechanism deliver maximum performance secure boot implement chain trust execution trust component trust boot soc rom load component verifies authenticity integrity subsequent module module load anomaly detect vendor digitally SW image private respective public digest flash programmable memory typically  public verify binary modify vendor secure boot implement chain trust execution trust component trust boot soc rom load component verifies authenticity integrity subsequent module module load anomaly detect vendor digitally SW image private respective public digest flash programmable memory typically  public verify binary modify vendor trust bootstrapping report architectural issue undermine trust bootstrapping client application local remote trustzone assist tee platform lack software independent tee integrity reporting secure boot ensures authenticity software device illustrates secure boot booting TAs however trustzone lack hardware mechanism securely reporting software integrity measurement remote absence hardware remote attestation implement software tee component weakens security remote attestation correctness SW software trust chain EL mode ill TA revocation identify android OEMs TA revocation TA revocation prevent patch TAs downgrade update vulnerability error increase overall security device easy update TAs usually load ree filesystem authenticity digitally however tee revoke TAs prevent attacker ree intentionally load vulnerable TA exploit gain code execution within tee successful downgrade  TA previous vulnerable version qualcomm trustonic TEEs VI bug report involve implementation issue implementation issue addition architectural weakness tee vulnerability implementation bug characterize prevalence issue primary source consist bug report retrieve public cve database vendor bulletin report VI classify analyze bug meaningful category validation bug software bug tee involves improper handle input output refer validation bug buffer overflow incorrect parameter validation  integer overflow etc bug prevalent frequently entry privilege escalation component exist tee validation bug within secure monitor exploit bug secure monitor attacker automatically gain device instance vulnerability abuse exploit hijack qualcomm tee kernel attacker zero anywhere SW memory craft input smc reduce critical bug tee qualcomm tee reference monitor  implementation unfortunately critical validation bug report within  ironically bug macro goal detect arithmetic overflow cve listing aarch code rely macro detect integer overflow multiple monitor entry macro vulnerable validation bug within TAs besides secure monitor TAs mostly expose attack NW smc interface vulnerability report tee corresponds validation bug within TAs instance critical vulnerability   leveraged compromise client application samsung trustonic tee validation bug exploit systematically respective bug fix TA validation bug cve privilege escalation linux kernel boomerang attack vulnerable TA properly validate input memory address attacker access NW memory memory allocate ree apps OS validation bug within trust kernel hijack TA attacker successfully elevate privilege exploit vulnerability tee kernel interface instance attack huawei tee rely vulnerable input entirely unchecked bypassing security within trust kernel listing worrisome qualcomm tee kernel lack code validate input pointer vulnerable validation bug secure boot loader boot loader prone attack exploit validation bug upon bootstrap document cve vulnerability due stack buffer overflow certificate parser allows attacker potentially install load craft certificate image verification legitimate tee software image replace attain arbitrary code execution functional bug functional bug refer program error flaw validate input output inconsistency implementation program specification intend programmer incorrectly program cryptographic algorithm identify functional bug security breach TEEs bug memory protection functional bug introduce security vulnerability memory protection mechanism tee instance vulnerability report  involves configuration error memory translation allows memory executable context EL OP tee identify bug report memory protection vulnerability instance error OP tee secure monitor code responsible restore  register armv ree escalate privilege obtain code execution tee bug configuration peripheral misconfiguration peripheral security critical qualcomm tee flaw disclose cve allows TA data spi interface previously another TA due non exclusive access spi bus OP tee patch aim fix misconfiguration pseudo random generator insufficient source entropy cryptographic library within OP tee bug security mechanism another potential source vulnerability existence bug implementation security protocol cryptography primitive  attacker bypass  soc secure boot due deficiency authentication integrity boot image checked signature OP tee  attack vulnerability  compromise private rsa cve hardcoded security  leakage fix jan extrinsic bug lastly extrinsic bug refer program defect related validation functional correctness code handle external factor introduce security vulnerability identify bug category concurrency bug interference multiple concurrent program concurrency bug extrinsic manifestation depends factor external program thread interleave concurrency bug introduce security vulnerability within tee instance OP tee bug due concurrent access file TAs TA delete directory trust storage another TA samsung report vulnerability  driver deployed trustonic tee sve sve specific instance  vulnerability aspect longer valid  vulnerability report drm TA nvidia tee privilege escalation cve software channel another instance bug extrinsic software channel specific implementation artifact foreign program logic reveal undesired information program execution timing channel cryptographic library  OP tee trust kernel cve vulnerability optimization modular exponentiation leak information exponent fix ensure constant exponentiation hardware architecture trustzone assist tee programmable logic FPGAs fully shade trust component exclusively allocate tee software SW spi UART communication soc peripheral biometric authentication smartcard interaction partially component partially totally restrict SW dram storage secure storage TAs hardware architecture trustzone assist tee programmable logic FPGAs fully shade trust component exclusively allocate tee software SW spi UART communication soc peripheral biometric authentication smartcard interaction partially component partially totally restrict SW dram storage secure storage TAs listing vulnerability  macro header file lib utils def macro aim detect arithmetic overflow compute sum pointer offset however sum input pointer offset wrap around unpredictable behavior aarch image fails detect overflow sum parameter listing vulnerability  macro header file lib utils def macro aim detect arithmetic overflow compute sum pointer offset however sum input pointer offset wrap around unpredictable behavior aarch image fails detect overflow sum parameter listing reverse engineer syscall huawei tee  without input attacker overwrite memory anywhere NW SW listing reverse engineer syscall huawei tee  without input attacker overwrite memory anywhere NW SW VI hardware issue TEEs rely correctness software architecture implementation correctness trust hardware component overview typical hardware architecture trustzone assist tee component axi bus hardware component TCB tee tee developer correctly configure interface component carefully consideration implication microarchitecture architectural implication tee developer aware architectural hardware component FPGAs architectural detail inside outside soc boundary attack reconfigurable hardware component reconfigurable platform fpga socs combine conventional cpu architecture programmable hardware logic although evidence massive adoption reconfigurable platform context mobile device OP tee xilinx zynq zynq ultrascale platform mainline unfortunately addition hardware increase attack configurable hardware within fpga socs typically bus hardware access memory manage software cpu trustzone enable  axi interface additional NS   channel interconnect hardware component become aware security cpu nevertheless unusual exploit advantage reconfigurable hardware logic security trustzone attack explores malicious hardware deployed fpga secure boot NS propagation fpga attack expose malicious modification hardware logic vii microarchitectural issue exploit attack trustzone assist TEEs vii microarchitectural issue exploit attack trustzone assist TEEs attack management mechanism software expose management mechanism significant challenge security possibly subtle instance clkscrew relies malicious non secure kernel driver frequency voltage regulator beyond vendor recommend limit induce faulty computation influence computation SW operation trustzone hardware enforce boundary extract secret cryptographic bypass code signing operation microarchitectural channel addition architectural detail security TEEs depends microarchitectural detail cache discus microarchitectural aspect affect security trustzone assist TEEs leak information cache trustzone enable processor cache memory secure normal although secure cache accessible NW guaranteed compete cache cache coherence improves performance cache contention contention source exploitation extraction information SW monitoring cache NW implement cache storage channel successfully extract aes encryption service  prime probe technique infer activity SW distinguish valid  leverage prime probe recover aes encryption prime employ enable covert channel trustzone leak information predictor predictor leveraged attack trustzone processor target buffer BTB compute target address instruction fetch correspond instruction predict BTB NW SW prime probe perform leak secure information NW encompasses prim BTB execute later victim execute evict attacker BTB entry attacker execution attacker executes detect mispredictions internal hardware structure BTB byte granularity instead cache granularity attack vector increase considerably spatial resolution probe mechanism private fully recover qualcomm hardware keystore leak information rowhammer rowhammer software induced hardware fault affect dram memory enables attacker flip physical memory solely perform memory operation attack explore subvert trustzone malicious linux kernel module generate fault specific NW target address rowhammer secure signature service  tee instance secure private rsa specific message private allocate secure memory adjacent secure non secure memory boundary rowhammer generate rate memory operation  memory border induces fault secure corrupt private generate faulty rsa signature retrieve faulty generate signature linux deduce private microarchitectural issue attack harder conduct generally environment plus relatively easy mitigate vii defense trustzone assist TEEs compilation defense technique overcome architectural implementation hardware issue prevalent commercial tee representative introduce defense chronologically bullet indicates respective implement defense technique address issue correspond caption reading interpret defense numbered  relevant tee issue representative contribute relevant defense technique  overcome report trustzone assist tee issue architectural issue attack isolation memory protection trust bootstrapping proposes respectively implementation issue validation bug proposes functional bug proposes extrinsic bug hardware issue architectural implication microarchitectural channel respectively proposes representative contribute relevant defense technique  overcome report trustzone assist tee issue architectural issue attack isolation memory protection trust bootstrapping proposes respectively implementation issue validation bug proposes functional bug proposes extrinsic bug hardware issue architectural implication microarchitectural channel respectively proposes architectural defense highlight relevant technique mitigate architectural issue identify exist commercial trustzone assist TEEs technique address subclass issue IV multi isolated environment technique employ reduce excessively attack commercial tee multiple isolated environment standard TA sandbox SW reduce exposure tee attack increase isolation granularity tee component extent potential damage security breach limit amount code SW thereby reduce highly damage SW privilege escalation attack variant propose aim strongly isolated compartment within NW TAs allocate TAs  sanctuary leverage feature  osp   instead explore hardware virtualization extension available NW NS EL implement isolated environment research retains TAs within SW aim strengthen isolation   implement minimalist hypervisor SW TAs multiple isolated secure guest OSes due lack hardware virtualization SW privilege isolation secure hypervisor secure guest OSes secure channel isolation threaten vulnerability SW trigger NW report tee deficiency undermine isolation extraction sensitive data SW although specific issue address fix vulnerable tee kernel isolation strengthen secure NW SW channel propose author mechanism overcome exist limitation mainstream TEEs absent weak authentication access tee resource NW potentially insecure memory data exchange within channel secret session ree application utilized encrypt message session untrusted ree kernel secret  mode switch kernel remove memory kernel mode execution  remove kernel dependency partially privileged shield portion ree application directly communicate tee  sanctuary implement exclusive memory  enables communication without memory data pointer sanitization prevent boomerang attack encrypt memory exist deficiency tee memory protection mostly address mechanism mainstream OSes ASLR stack cooky nevertheless commercial TEEs security defense boot attack implement encrypt memory capability contrast intel sgx trustzone built chip memory encryption bridge gap  allows TAs entirely cache ensures encrypt memory along vein  protects variable tag application programmer sensitive allocate cpu register encrypt runtime memory trust compute primitive commercial TEEs rely secure boot guarantee integrity tee image however mechanism per insufficient enable TA client local remote verify integrity identity tee TA binary overcome limitation commercial TEEs implement additional trust compute primitive guarantee namely remote attestation seal storage instance TLR seal storage primitive allows data cryptographically bind specific hash tee TA software stack komodo demonstrates implement trustzone assist TEEs security protocol seal storage remote attestation originally specify enclave intel sgx secure environment TAs trust primitive aim secure access peripheral identify relatively vulnerability involve access peripheral mitigate standard hardware feature mediation  bus bridge omits reference implementation defense respect defense leveraged improve implementation correctness tee component TAs underline technique technique apply prevent bug validation functional extrinsic bug manage code runtimes commercial tee mostly program allows compile highly efficient code memory safety however validation bug memory violation error introduce programmer alternative tee TLR TAs compile native code net manage code interpret manage code runtime akin jvm expense performance overhead manage runtime prevent validation bug implement memory garbage collection program researcher explore program implement specific component trustzone assist tee software notably  extension OP tee TAs implement rust program rust memory thread safety  prevent validation bug concurrency bug responsible cripple TA software rust program  implement software monitor mode  software verification implementation bug tend exist due mismatch requirement software actual implementation software verification comprises technique model symbolic execution formal aim prevent mismatch ensure implementation fully satisfies envision requirement potential prevent prevalent tee implementation bug however technique challenge apply considerable effort complex program despite obstacle important advance achieve formal verification specific tee component tee monitor komodo implement specification intel sgx enclave memory manager  hardware defense relevant countermeasure date address hardware issue affect trustzone assist TEEs architectural countermeasure hardware manufacturer tend increasingly pack component soc chip become tee designer fully understand implication security tee prevent abuse reconfigurable hardware technology researcher propose inclusion hardware wrapper IP core endow axi interface restrict operation boot implementation dedicate axi interconnect secure device inclusion non secure non sensitive memorymapped IP core restrict operation memory protection mechanism  prevent misuse hardware voltage regulator approach specific operation limit software driver hardware microarchitectural countermeasure prevent cache channel careful implementation cryptographic algorithm software dedicate hardware specific ISA instruction   armv prevent information leakage cryptographic related operation another leverage cache maintenance technique prevent information leakage cache trustzone assist TEEs cache approach flush cache SW exit cache although cache flush selective cache normalization operation perform SW entry exit sufficient prevent cache storage attack flush prevent prime probe attack multicore aforementioned cache partition prevent attacker leverage contention victim carefully implement cryptographic algorithm effective prevent breach BTB highlight version algorithm render  ineffective prevent rowhammer attack TEEs avoid memory NW SW boundary IX dedicate ram allocation security sensitive isolation potentially insecure ram isolation implement memory management component MMU PMP combination HW specific feature trustzone  dedicate soc chip achieve isolation physical separation encrypt memory indicates hardware enforce memory encryption protection classify user kernel hypervisor monitor chip attestation tee runtime perform local attestation secure boot remote attestation previously exploit indicates publicly exploit tee enable technology communication mechanism ree memory data copying communication bus USB spi IX dedicate ram allocation security sensitive isolation potentially insecure ram isolation implement memory management component MMU PMP combination HW specific feature trustzone  dedicate soc chip achieve isolation physical separation encrypt memory indicates hardware enforce memory encryption protection classify user kernel hypervisor monitor chip attestation tee runtime perform local attestation secure boot remote attestation previously exploit indicates publicly exploit tee enable technology communication mechanism ree memory data copying communication bus USB spi beyond trustzone assist TEEs although focus TEEs specifically assist trustzone alternative tee enabler hardware technology briefly related technology highlight feature IX hardware technology cpu extension processor augment circuitry implement specific tee enable security functionality trustzone category technology intel software guard extension sgx intel management mode SMM sanctum instance processor soc secure enclave processor sep qualcomm secure processing SPU dedicate non volatile storage ram allows reduce hardware resource prevent channel attack dedicate security chip runtime environment comprises processor memory persistent storage instance intel management firmware  OS processor intel almost fully independent access peripheral secure boot functionality security chip equip tamper detection titan others trust platform module tpm implement specific function trust boot remote attestation primitive hardware virtualization implement TEEs virtual secure mode vsm hypervisor establishes hierarchical privilege mode  analogous normal  analogous secure amd secure encrypt virtualization  ability encrypt virtual machine memory hardware accelerate memory encryption lastly RISC instruction architecture although widely deployed implement TEEs IX conclusion vulnerability trustzone assist TEEs despite belief TEEs secure due hardware enforce isolation capability TCB report numerous evidence assumption tee serious limitation implementation architecture hardware potentially introduce exploitable vulnerability affect device analysis highlight multiple defense propose research community commercial tee substantially secure