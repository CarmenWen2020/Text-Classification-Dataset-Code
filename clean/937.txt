within billion iot device densely threat adjacent iot device infect worm rapidly density compatible iot device exceeds critical developed verify infection popular philip hue smart lamp platform worm jumping directly lamp built zigbee wireless connectivity physical proximity attack plug infect bulb anywhere  everywhere within enables attacker permanently brick exploit massive DDOS attack demonstrate risk involve percolation theory estimate critical instal device typical paris kilometer chain reaction  randomly smart lamp everywhere exceeds critical almost certainly surpass already attack remotely  already instal lamp network perform firmware update overcame discover exploit bug implementation touchlink zigbee link protocol suppose attempt proximity developed version channel attack extract global aes CCM device philip encrypt authenticate firmware readily available equipment manage without actual update demonstrates security standard cryptographic technique introduction internet  currently exponential growth expert estimate within fifty billion internet cheaply sensor actuator likely insecure potential proliferation vulnerable  device demonstrate massive distribute denial service DDoS attack dyn dns exploit attack vector default password outdated telnet service web camera chinese manufacturer worry situation without neighborhood dense network billion transmitter receiver hoc networking capability  device directly unintended communication medium completely bypass traditional communication telephony internet demonstrate  device knowledge security standard cryptographic technique misuse hacker attack communication medium infectious malware  device physically adjacent hacker rapidly disruption investigate focus popular philip hue smart lamp european communication lamp controller zigbee protocol link choice  device due simplicity availability consumption robustness disadvantage wifi communication limited bandwidth  application hue lamp zigbee chip atmel multiple layer cryptographic non cryptographic protection prevent hacker misuse lamp securely controller ignore request reset affiliation unless zigbee transmitter centimeter away lamp attacker spoof proximity transmitter decrease quadratically distance brute attack meter dedicate equipment cannot standard zigbee shelf equipment initial discovery atmel stack bug proximity enables standard zigbee transmitter evaluation initiate factory reset procedure dissociate lamp controller meter achieve transmitter issue additional instruction lamp demonstrate drove around campus hue smart lamp instal building along due minimal consumption equipment attack automate manage fully autonomous attack kit standard drone perform flew meter away building hue lamp instal disconnect controller blink SOS morse code drone   attacker disable philip hue smart lamp within attack unpleasant consequence temporary reverse tedious lamp within centimeter legitimate controller  attacker permanent damage combination novel technique reverse engineer chosen philip lamp firmware update update model reference without actual firmware update issue philip atmel chip discover accepted lamp firmware update encrypt authenticate aes CCM aes encrypt counter cbc mac however lamp global manage deduce secret cryptographic philip IV within novel channel attack cheap easily obtain equipment without physically extract secure memory obtain secret firmware upload philip hue lamp demonstrate really devastate budget attack  infect lamp modify firmware plug anywhere explosive chain reaction lamp infect replace firmware within meter worm scenario accidentally trigger robert morris internet  within avoid accidental outcome due actually firmware instal infect lamp firmware version  possibly harm however attacker permanently brick infect lamp simply disable firmware update lamp cannot rescue thrown away attack differs previous attack  crucial previous attack tcp IP packet scan internet vulnerable  device participate internet activity massive DDOS attack internet communication heavily monitor variety security attack discover stage principle attack internet communication infection directly lamp lamp unmonitored unprotected zigbee communication consequently detect attack source disabled another difference attack via physical proximity alone disregard establish networking structure lamp controller attack cannot isolate various subnetworks administrator attack attack borne biological infection influenza almost exclusively via physical proximity finally previously report attack via linear scan infection structure centrally attacker whereas chain reaction attack faster infect lamp source infection adjacent lamp attacker initiate infect lamp retire automatically organize summarizes related security smart lamp overview attack analyzes smart lamp widespread infection typical background attack zigbee link zll standard philip hue bulb feature target attack commission upgrade addition summarize cryptographic primitive channel attack describes physical hardware setup along preliminary analysis attack hardware technical detail attack detail upgrade relates worm assume encryption disseminate valid encrypt firmware file describes novel analysis recover encryption associate secret information aes CCM encryption scheme twice effort simpler aes ECB scheme encryption device allows device update firmware image encrypt recover worm accomplish conclude attack smart lamp related recent numerous security  device protocol publish regard lamp vulnerability discover alex chapman manage extract cod encryption encrypt data LIFX brand bulb recover password local network bulb  dos denial service attack philip hue  shamir philip hue  covert channel exfiltrate data gapped network strobe epileptic seizure  weakness osram  app unencrypted password lack authentication gateway vulnerable usage zigbee automation profile however vulnerability related zll zigbee link protocol specific zll protocol related propose formal security model  demonstrate weakness zll lamp however lamp distance custom hardware transmission  reverse engineer philip hue security choice possibility lightbulb worm bypass firmware security protection mechanism worm bluetooth enable cellular phone described cellular phone temporarily pas without exploit novel vulnerability attack stationary  device exploit previously unknown weakness implementation zigbee protocol analysis attack atmel aes hardware accelerator  atmel  aes ECB mode  chen leakage model attack atmel  hardware attack zigbee CCM mode operation assumption nonce jaffe attack counter mode encryption unknown nonce sequential operation hardware nonce firmware trace moreover modify counter update linear feedback shift register serious challenge attack overview attack attack previously described attack creates native autonomously zigbee worm target philip hue combination novel attack correlation analysis cpa attack CCM mode encrypt verify firmware update encrypt upload malicious ota update infect lamp takeover attack lamp distance without custom hardware novel takeover attack bug atmel implementation zll touchlink protocol machine philip hue lamp lamp distance zigbee wireless meter indoors meter outdoors standard philip hue lamp attack assume prior knowledge attack lamp knowledge zll secret attack simultaneously lamp within demonstrate attack   scenario novel cpa attack target verification phase CCM mode attack advantage previous analysis attack aes CCM assume knowledge nonce IV counter implementation valid encryption sample verification message twice trace ECB mode novel attack recover philip hue ota update verification encryption malicious software update load philip hue widespread infection assume roughly circular fiat convex elongate without smart lamp random location within define infection graph lamp distance component graph define infection plug infect component likely consist vertex increase graph phase giant component contains vertex critical infection likely everywhere instead remain isolated neighborhood 2D continuum percolation disk mathematical percolation theory critical percolation threshold survey variant version interested threshold 2D continuum model connectivity via overlap dimensional disk radius described within distance disk radius around intersect directly model critical model randomly disk  typical paris fairly circular  available kilometer accord official zigbee link website zigbee communication meter indoors meter outdoors probably situation estimate reasonable assume lamp infect lamp within distance meter disk around lamp radius meter plug formula critical instal lamp paris philip hue smart lamp popular europe affluent paris threshold exceed already vulnerable massive infection via zigbee chain reaction described zll architecture philip hue bridge gateway lamp wireless switch zll zigbee link smart smart user wireless lamp remote smart phone application gateway gateway bridge IP zll zll standard intend interoperable easy consumer allows consumer gain wireless fixture bulb timer remote switch developed manufacturer philip GE osram philip hue personal wireless philip sale billion EUR consumer oppose industrial consumer sale smart translate alone although reliable philip hue popular smart release variety hue introduce model lamp bridge switch philip api bridge develop application lamp zll touchlink commission protocol zll official website   security zll standard authentication secures network network interoperability vendor basis zll touchlink commission protocol define zll standard protocol establish  personal network instruct device remote etc pan encryption pan unique encryption encrypt authenticate message pan philip hue starter kit lightbulb bridge router internet access controller lightbulb preconfigured pan secret lightbulb bridge touchlink protocol lightbulb exist pan zll protocol message encrypt encryption encrypt unique encryption device network encryption secret zll zll certify specify standard zigbee alliance member develop zll certify unsurprisingly leak touchlink protocol instance transaction transaction involves initiator bridge target initiator transaction broadcast message scan request transaction identify unique random nonzero ID scan request message transaction transaction ID upon scan request target sends scan response message random nonzero response ID combination transaction response ID identifies unique transaction initiator specific target message lightbulb reset factory request message valid transaction ID target device reset factory delete pan information network request message instruct target initiator pan pan unique encryption encrypt zll derive transaction response ID touchlink proximity protection mechanism touchlink protocol allows initiator zll lightbulb reset factory pan bridge lightbulb prevent zll enforces proximity mechanism initiator physical proximity target philip hue scan request nominal output dbm upon scan request target device rssi signal strength indication manufacturer specific threshold otherwise ignore request gen philip hue bridge model lightbulb hue LCT respond meter distance newer model lux  respond centimeter however gen bridge philip increase transmission significantly lux model increase centimeter zigbee ota update zigbee alliance standard ota update standard goal upgrade cluster interoperable device manufacturer upgrade others image standard defines client server protocol transfer update image client lightbulb although standard suggests asymmetric verification authenticity integrity mandatory zigbee application zll philip hue hardware software although version philip hue texas CC soc chip discontinue lamp afterwards atmel  soc soc component atmel avr microprocessor KB flash bootloader firmware code KB SRAM program data aes hardware accelerator transceiver anti debug fuse firmware internal data access outside philip firmware sensitive operation inside soc access outside soc philip hue external mbit spi serial peripheral interface flash chip flash encrypt ota image extract philip hue lux model assume philip atmel source zll stack code assumption verify soc serial interface message reference  zll stack experimental setup overview experimental setup research experimental setup zll protocol implementation hardware attack setup reverse engineer attack philip hue ota update zll attack setup demonstrate takeover attack zll experimental setup experimental setup allows zll message complex machine research implement attack although previously wright setup suitable available hardware specific implement relevant zll standard previously available hardware setup RF transceiver capable zigbee message chosen texas  evaluation USB dongle PC  chip zll stack philip hue lamp difference USB default software allows sniff raw zigbee message compile code raw zigbee message software framework python implementation zll stack generate parse zigbee zll message implement machine implement attack analysis setup philip hue generation philip hue BR generation philip hue lux bulb disassemble later generation lux bulb atmel  device analysis modify hue later custom pcb  along circuitry spi flash chip built load chip remove production hue lamp load blank chip measurement chip  hardware platform photo measurement setup  lite custom pcb  pcb bus pirate pcb reprogram spi flash chip load hue chip actual bootloader encryption whereas blank chip investigate signature  perform task rough amount trace hardware aes peripheral detail appendix zll attack setup attack demonstration slightly setup transceiver TI CC chip  evaluation slightly RF characteristic easy drone  mission attack kit fully autonomous implement attack logic code texas zigbee  model philip hue lamp attack lightbulb worm attack scenario goal worm automatically physically adjacent lamp chain reaction standard zigbee wireless interface worm lightbulb lightbulb zll network another ability persistence code execution lightbulb lateral movement lightbulb infect another lightbulb persistence code execution philip hue explore achieve persistence code execution exploit software vulnerability zigbee ota feature philip hue lightbulb target exploit software vulnerability processor harvard architecture code execution memory rop return orient program attack knowledge code customization model instead possibility exploit zigbee upgrade cluster standard standard allows customization vendor analyze philip hue software update unfortunately software update available model possession python script zll framework impersonate lightbulb version mac address online hue model software update recording model translation readable software version hex code ota standard lux model software version api instruct bridge ota impersonation code firmware image dependent impersonate lightbulb mac address conclusion software lamp specific model implement asymmetric cryptography currently uncommon ota implementation atmel  texas crypto bootloader assume symmetric cryptography recover encryption authentication philip hue lightbulb software update lightbulb model load malicious code understand philip ota image structure software update available model ota image impersonation code retrieve available ota image file model model reject firmware reverse engineer philip ota image structure trial error manipulate firmware image compatible hardware image atmel model external spi flash update image spi sniffer understand communication processor flash ota ota image verification flag flash image specific offset flash processor flag verify ota image extract encryption signature valid malicious software update understand cryptographic primitive encrypt update firmware extract mention philip  anti debug fuse disable external reading program internally philip bootloader channel analysis lateral movement worm software update lightbulb network sniff touchlink protocol lamp lightbulb network zll secret leak touchlink commission protocol lamp however limited protocol proximity mechanism attack previous exchange network network physical proximity customize hardware transmission standard infect another implement worm distance normal accomplish philip hue lamp philip cryptographic bootloader correlation analysis counter cbc mac encryption mode CCM authenticate encryption mode encrypt data  TLS upon zigbee input CCM mode nonce data authenticate encrypt data encrypt authenticate cbc mac data authenticate encrypt data nonce combine incrementing counter input ECB mode aes encryption ctr counter  cbc mac tag encrypt important cbc mac ctr encryption differential analysis DPA channel analysis consume digital device performs operation attack infer something data device demonstrate cryptographic algorithm channel analysis ability secret intermediate input output  operation enables recover DPA refer specific technique DPA refer difference partition trace difference relies splitting trace assume intermediate another assume intermediate intermediate recovery byte aes ctr output xor operation specific around sample threshold difference positive negative difference pronounce reliably recover simply byte difference spike manipulation noticeable difference sample onward recover device unknown timing accomplish correlation analysis cpa subsequently publish cpa attack complex leakage assumption data bus linear relationship consumption data manipulate attack cpa attack rapidly entire byte cpa attack effective target output non linear function output operation aes bitwise DPA attack aes ctr pad recover CCM encryption mode CCM encryption mode bitwise difference DPA attack xor operation aes ctr byte wise cpa attack aes hardware accelerator understand philip ota image cryptographic primitive initial assumption philip CCM encryption mode ota image enables reuse CCM code zigbee encryption TI cryptographic bootloader implementation reference implementation TI model newer bulb atmel  ota update release instead image CC bulb reference perform  encrypt image programmed spi flash boot bulb flag ota update pending entire image verify signature image actually perform flash program modify image invalidate signature bulb perform contains gap align flash memory erase actually program leakage mode  aes hardware target newer hardware CC ota upgrade file modify hardware image file requirement bootloader hardware bootloader  attempt verification actual verification fail valid ota image platform meaning perform attack without access valid firmware image hardware aes  unique signature detect location aes straightforward trace verification aes operation byte CCM assumption portion addition perform DPA attack leakage assumption simply input data load location input data manipulate linear data xor operation input data manipulate aes operation aes operation consistent aes operation ctr mode output ctr mode pad  input data decrypt decrypt data fed cbc  input data generate difference spike input data effectively  constant aes ctr output ctr input cbc output cpa attack CCM cbc mac verification CCM assumption mode operation limitation knowledge knowledge encryption nonce knowledge signature IV associate data sample valid encrypt message target accept message around encryption summarize exist related aes CCM previous aes ctr aes CCM perform analysis aes ctr mode complicate majority byte constant nonce counter byte standard cpa attack recover byte associate input byte meaning byte counter recover jaffe jaffe performs attack multiple aes jaffe technique perform attack multiple allows recovery combination aes  constant text output previous allows ignore unknown constant eventually remove aes ctr attack encryption ensure trace counter jaffe report attack succeed subset trace subset trace throughout trace sufficient capture consecutive trace data leakage hardware aes peripheral leakage occurs operation reliably perform attack output output leak recover associate toggle  input data due non linear aes CCM specifically broken  chen modify version jaffe attack successive encryption aes ctr  mapping input data aes ctr nonce perform measurement byte nonce varied aes ctr counter constant jaffe  perform multiple cpa attack progressively recover recover validate error compound correlation spike various candidate  aes cbc portion aes CCM instead aes ctr portion unknown counter input template attack perform completely unknown input aes attack downside performance trace plaintext ciphertext attack target accepted byte limited ability exist aes ctr attack unaware nonce format mapping input data aes ctr none attack analysis processing byte cryptographic bootloader analysis processing byte cryptographic bootloader unknown plaintext chosen differential cpa attack aes attack introduce novel efficiently convert chosen plaintext cpa attack ECB mode unknown plaintext chosen differential attack assumption chosen plaintext cpa attack ECB mode encryption implementation input ECB mode encryption encryption unknown input XORed chosen differential differential trace aes previous notion modify notation ith byte unknown plaintext input aes encryption ith byte chosen differential ith byte jth aes aes encryption plaintext byte calculation output  output  byte  chosen plaintext cpa attack retrieve byte trace input constant  denote modify rewrite  cpa attack retrieve byte calculate input aes aes identical cpa attack input retrieve cpa attack input random trace attack chosen plaintext invertible structure aes calculate differential invertible aes expansion algorithm byte normal random plaintext cpa attack ECB mode unknown plaintext chosen differential trace ECB chosen plaintext aes CCM efficiently CCM mode attack cbc mac calculation consecutive summarize notation aes CCM aes ECB function ctr cbc portion CCM mode input byte index ctr mode IV counter input aes ECB assume input IV IV byte constant concatenate counter mode generates counter IV CTRm IV source  plaintext ciphertext encryption decryption respectively decrypt ptm ptm CTM CTRm source addition decryption CCM authentication tag output cbc mode encryption across ptm possibly internal cbc mode   ptm  CTM CTRm  source target CTRm BCM constant CTM ciphertext input firmware file device CTM unknown plaintext CTRm  ciphertext chosen differential cpa attack recover cbc mac CTRm  CCM mode reuses encryption verification encryption attack attack calculate BCM attack retrieve CTRm  CTRm nonce decrypt CTRm aes ctr DPA recovery optimization attack CCM twice trace ECB mode attack   retrieve ctr output optimize attack bitwise difference DPA attack recover output aes ctr encryption directly DPA attack attack CTRm CTM operation actual bootloader measurement byte recover multiple location difference output location linear operation CTM data spike xor target data load aes ctr output aes cbc input addition positive negative spike internal bus switch precharge precharge location difference across entire trace output aes ctr trace cpa attack retrieve cpa attack decrypt simply chose decrypt counter byte aes ctr xor operation around sample meaning additional extend CCM attack cipher combine cpa attack DPA optimization spn substitution permutation network cipher algorithm regardless expansion algorithm assumption cpa attack chosen plaintext trace DPA attack output ctr cpa attack retrieve cbc mac  DPA attack retrieve ctr output CT cbc mac encryption CTM CTRm  chosen  attack retrieve attack bypassing proximity mechanism proximity ensures device approx reset device proximity logic zll compliant stack atmel  touchlink implementation mel customer software implementation touchlink protocol  stack zll platform implement  handle  layer determines message sanity  implement touchlink protocol machine code security message checked reference location proximity mechanism implement  function  rssi threshold define stack user specific threshold message parameter touchlink protocol machine upon valid scan request message machine random jitter lamp respond exactly function     function sends scan response message transaction response ID  structure listing multiple instance touchlink protocol stack array structure upon protocol message transaction ID parameter message checked array transaction ID array message bypassing proximity response parameter structure listing dedicate valid flag variable boot protocol session structure zero zero invalid transaction listing response parameter structure algorithm listing definition function  transaction valid reader programmer transaction nonzero zero already reject  however review code sanity upon scan request message message protocol message assume zero transaction response valid message bulb discover bug exploit lamp distance approach simply network router request transaction ID zero message instruct network however reset code function security  impl decrypt network encryption performs sanity transaction response nonzero reset network network zll touchlink protocol directly lamp however mention zll standard mandate compatibility non zll zigbee network zll standard ensure interoperability zigbee device zll device implement compatible startup attribute sas specify sub clause zll device non zll zigbee network non zll device zll network application  commission protocol described restriction proximity mechanism upon network network encrypt trust centre link default specify zll standard normal philip hue zigbee network actively network factory attack proceeds unicast reset factory request command target philip hue command transaction ID zero upon message undergo factory reset scan network zigbee beacon request message respond zigbee beacon message association permit flag zigbee association network simultaneously multiple lightbulb improve attack simultaneously efficiently lamp zll standard clearly reset factory request command format destination address address destination source pan ID precede scan request inter pan command frame however verify anywhere code allows reset factory request command broadcast message simultaneously lamp within zigbee factory reset lamp respond beacon message association network lamp factory request command outside resend message lamp already associate network reset zll channel available ghz zll standard zll device channel available 4GHz numbered within channel define primary zll channel consist channel preference commission normal operation secondary zll channel consist channel backup zll device non zll network factory reset philip hue cycle available channel channel sends beacon request message response chose relevant beacon message switch channel association communication repeatedly factory reset message primary zll channel switch secondary channel beacon message association allows repeatedly reset lamp lamp already network secondary channel affected worm attack consists interconnect perform ota software update bulb knowledge secret bulb distance standard detail discovery respectively detail ota update attack discus attack worm firmware update attack attack verify attack philip hue model lab experimental setup implement autonomous attack kit texas zll stack  evaluation mAh USB  stack convenient api channel switch hardware rewrite code replace source library stack simplify development chose attack via zigbee channel evaluation factory reset attack channel another association takeover channel evaluation factory reset attack program repeatedly reset factory request command transmission dbm lamp ample switch channel association reset factory request command  instal philip hue lamp faculty building successfully attack park across  distance meter factory reset attack meter successfully attack     demo target building beer  israel concentration cyber security building host  cert instal philip hue lamp building attack kit dji inspire pro drone  attach drone evaluation hang meter USB cable beneath avoid RF interference drone motor powerful ghz video transmitter zigbee  scenario zigbee  scenario attack attack attack distance meter takeoff distance factory reset attack drone closer building takeover demonstrate successful code lamp repeatedly signal SOS morse code drone hover building firmware update attack perform actual firmware update standard compliant firmware binary detail binary specify standard attack convert arbitrary firmware image built format accepted bulb device analysis aes CCM encryption verification firmware binary bulb model meaning recover cryptographic device update model detailed aes CCM aes cbc aes ctr portion aes ctr nonce format cbc mac XORed encryption IV associate data initial cbc mac calculation screenshot hue app modify bulb version bulb modify firmware image screenshot hue app modify bulb version bulb modify firmware image DPA attack byte header manipulate data bootloader assume byte mac authentication tag calculate decrypt CC update image encrypt file newly calculate mac firmware accepted confirm generate code screenshot official philip hue app modify unmodified bulb version modify bulb  load program flash memory CC bootloader typically resides flash allows recover bootloader along information LV etc  option prevents application code reading bootloader feature enable hue bulb  investigate meaning perform style attack newer lamp building worm combine ability encrypt arbitrary binary knowledge takeover attack vulnerability ethical consideration disclosure ethical disclosure takeover vulnerability philip atmel july relevant technical detail suggestion fix confirmation finding philip attack affect deployed hue lamp fix version update release philip october reduce infection standard zll touchlink message notify philip recovery firmware encryption confirm concerned building fully functional worm combine attack functionality isolation lightbulb worm countermeasure worm capable directly wireless device due choice software bug implementation symmetric encryption across device firmware update hardware vulnerable channel analysis error implementation protocol prevent attack unique per bulb prevent worm bulb encrypt firmware another bulb zigbee ota standard backend server another asymmetric cryptography software verification efficient hash signature resource device channel analysis prevent recovery encryption usually costly consumer devise prevent leak instead ensure leak damage entire ecosystem error discover protocol implementation zigbee certification negative extremely important cryptographic security protocol zll standard transaction ID non zero negative message protocol bug worm application  worm application briefly discus issue demonstrate  security correctly  attack worm  attack unlike regular dos attack attack irreversible worm blackout constant flicker etc permanent previously mention worm worm ota update worm entirely replace exist firmware worm designer ota update protocol ota update reprogramming device besides pcb connection reprogramming  pcb connection lamp disassemble pot compound around pcb along glue secure dome fix issue substantial recall warranty replacement stock recall device vulnerable firmware  apply consumer unlikely perform legitimate ota update worm infect bulb wireless network jamming standard zigbee ghz license widely standard channel bandwidth meaning channel overlap channel soc device mode transmits continuous signal without channel FCC CE signal tune overlap ghz channel sweep signal device jammer easily disrupt wifi ghz traffic dedicate attacker platform attack specific ghz     LoWPAN nest weave  thread perform specific dos attack  device protocol data infiltration exfiltration  shamir philip hue exfiltrate data rate KB per data message bridge infect lamp covert channel rate reading user chosen data message flicker rate api infect lamp infiltrate data network user readable data model version epileptic seizure  shamir philip hue trigger epileptic seizure attack execute remote location infect lamp LEDs frequency increase longterm discomfort attempt overtly trigger seizure conclusion described attack potential moreover fix malicious software update physical replacement affected lightbulb software patch available restore scenario alarm security  device attack exploit specific implementation bug touchlink commission protocol specific ota update security  atmel code review document extremely implement complex machine protocol without bug insecure zll standard bug attack zll commission vendor goal understandable usability security security community academia contrast inclusive manner TLS standard  zigbee specification public manner leak zll ota update leak reuse symmetric encryption signing lightbulb security risk enables attacker chain reaction infection security obscurity fail security community academia probably alternative zll commission ota update symmetric computer smart phone software update usually asymmetric signature validate origin software connection update server asymmetric cryptography hash signature moreover manner chip manufacturer aes hardware accelerator requirement standard zigbee encourage hardware asymmetric cryptography  device become affect importance security protocol implement knowledge gain  device future attack affect correlation analysis attack byte byte incorrect cyan positive negative peak exploit correlation analysis attack byte byte incorrect cyan positive negative peak exploit