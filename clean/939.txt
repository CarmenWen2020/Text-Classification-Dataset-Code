holmes implement approach detection advanced persistent threat APTs holmes inspire APTs highlight goal apt actor nutshell holmes aim detection signal indicates presence coordinate activity apt campaign challenge address approach involves develop suite technique detection signal robust reliable technique develop effectively leverage correlation suspicious information arise attacker campaign addition detection capability holmes generate graph summarizes attacker action graph analyst effective cyber response evaluation approach APTs indicates holmes detect apt campaign precision false alarm rate compact graph holmes effectively summarizes ongoing attack campaign assist cyber response operation introduction detailed report advanced persistent threat entitle  security firm  disclose goal activity global apt actor activity steal terabyte sensitive data business technology blueprint organization across diverse estimate average duration persistence malware target organization document APTs involve powerful actor actor global scene understand motivation operation apt actor vital role challenge address threat understand  report apt lifecycle model chain allows gain perspective apt collectively achieve actor goal typical apt attack consists successful penetration spear phishing attack reconnaissance command communication sometimes remote access trojan RATs privilege escalation exploit vulnerability lateral movement network exfiltration confidential information chain reference understand motivation target action apt actor apt lifecycle apt lifecycle APTs grown sophistication publication  report detail various exploit varied remain mostly survey apt report goal apt actor obtain exfiltrate highly confidential information source code specific proprietary technology damage victim compromise integrity resource PLCs compromise stuxnet worm goal accomplish primarily conform chain exist IDS IPS enterprise detect alert suspicious host however combine alert derive ongoing apt campaign remains challenge alert correlation typically perform security information management SIEM splunk  ibm  alert multiple source correlate correlation readily available indicator timestamps instance correlation useful lack understand complex relationship exist alert actual intrusion instance precision attack host statement tackle detect ongoing apt campaign consists disparate across host explanation attack scenario analyst host IPS alert enterprise aspect alert generation trace host generate alert efficient manner generate alert attempt factor significant attacker additionally ensure generate volume noisy alert alert correlation challenge combine alert multiple activity attacker reliable signal indicates presence ongoing apt campaign attack scenario presentation indicator ongoing apt campaign communicate cyber analyst effective communication intuitive summarize attack analyst quickly realizes scope magnitude campaign approach contribution holmes address aspect holmes host audit data linux   data detection signal stage ongoing apt campaign holmes novel apt chain pivotal reference address technical challenge involve aspect apt detection significance detailed technical description holmes aim activity host alert enterprise directly chain choice allows holmes generate alert semantically activity tactic technique procedure ttps apt actor holmes  alert generation attack campaign manifest audit important challenge generate alert significance collection audit contains around holmes extract suspicious activity important holmes information entity file etc basis alert correlation internal reconnaissance chain depends successful initial compromise establishment  reconnaissance typically launch command agent instal attacker  establishment exhibit involve phase moreover reconnaissance involves malware file  establishment phase illustrate file similarly successful lateral movement phase exfiltration phase data reconnaissance phase detect associate apt link information construct emerge chain apt actor contribution holmes development scenario graph HSG node HSG correspond ttps information entity involve ttps HSG basis detect APTs confidence purpose develop concept ancestral HSG concept ass strength dependency HSG node weak dependency prune away eliminate false alarm develop reduction technique emphasize dependency associate benign activity develop rank prioritization technique prune away node unrelated apt campaign described detail IV IV IV technique demonstrate holmes distinction attack benign scenario finally HSG compact visual summary campaign important contribution attack comprehension instance dataset audit summarize attack campaign graph node cyber analyst HSG quickly infer attack scope magnitude relative evaluation evaluate holmes data generate darpa transparent compute program involve professional simulate multiple cyber attack network consist platform implement appropriate audit data parser linux freebsd convert audit data data representation analysis format advantage audit data reliable source information unauthorized tamper threat model non compromise kernel evaluation holmes apt attack scenario intrusion detection span holmes clearly distinguish attack benign scenario discover cyber attack precision recall sec VI II illustrate approach attack research program organize government agency specifically darpa attack vulnerable nginx web server freebsd operation capture audit audit data construct provenance graph fragment node graph entity rectangle file oval network connection diamond memory  user correspond orient direction information causality provenance graph render acyclic optimize node versioning technique described reference goal attacker exfiltrate sensitive information attacker activity depict consist initial compromise attacker sends malicious payload socket nginx memory executable attacker gain nginx reflective load exploit communication compromise nginx connection server command attacker privilege escalation attacker exploit exist vulnerability escalate privilege nginx internal reconnaissance attacker issue command  hostname command simulate access confidential proprietary data attacker usernames password hash writes information temporary file exfiltration attacker transfer file information machine cleanup attack attacker remove temporary file attack  provenance graph illustrates challenge described stealthy attack attack leaf minimal footprint attack initial compromise nginx server execute memory visible trace file moreover payload within exist nginx challenge detect stealthy attack attacker activity blend seamlessly normal operation needle haystack host generate per typically correspond benign activity portion subset benign activity audit detect rare without rate false alarm importantly challenge filter benign attack summary analyst detection envision holmes conjunction cyber response detect summarize ongoing campaign detection additional challenge constraint technique holmes overcome challenge despite blending seamlessly benign background activity factor regard attack attack achieve capability correspond apt stage attack activity via information holmes approach observation approach overview central insight approach concrete attack widely APTs apt behavior conforms chain introduce analysis apt report suggests APTs consist subset importantly observation causally connectedness indication attack unfold concrete manifestation apt initial compromise execute spear phishing attack malicious file execute user regardless apt abstraction attacker intention hence manifest operational tactic attacker across APTs moreover information causal relation necessarily exist apt logically dependent exfiltration dependent internal reconnaissance sensitive data research therefore detection apt essential behavioral information dependency challenge semantic gap audit data chain attacker goal intention capability bridging semantic gap bridge semantic gap chain intermediate layer mapping intermediate layer mitre att CK framework describes behavioral define tactic technique procedure ttps holmes approach audit apt stage TTP defines realize capability instance capability persistence compromise linux achieve distinct ttps sequence action att CK framework installation rootkit modification boot script action closer abstraction audit ttps node provenance graph technical challenge technical challenge realize approach summarize efficient ttps detect correlation attack reduce false positive challenge innovation efficient representation audit provenance graph IV memory allows efficient graph encodes information dependency exist entity file ttps specify leverage dependency instance maintain persistence TTP information dependency exist initial compromise TTP maintain persistence TTP detect correlation attack scenario graph HSG abstraction provenance graph node HSG TTP information causality dependency ttps HSG illustrate layer node boldface refer reader HSG node HSG prerequisite consequence ttps apt stage reduce false positive HSGs attack combination benign false positive ttps heuristic assign node graph severity HSGs ranked ranked HSGs analyst summary phase apt operationalized suite tactic audit data observation evidence malicious activity unfold holmes evidence infer correlation correlation overall attack campaign IV previous rely OS audit data OS kernel audit trust compute TCB attack OS kernel audit outside scope threat model assume benign outset initial attack originate external enterprise remote network access removable storage etc data collection representation relies audit  multiple host operating OSes linux source audit data  dtrace bsd  raw audit data OS neutral format input format accepted holmes input capture relate principal user file operation file creation ownership permission memory mprotect mmap creation privilege network connection although default audit incurs nontrivial overhead recent research overhead data graph provenance graph structure graph previous forensic analysis node graph file pipe socket denote dependency entity annotate important difference versioned version node incoming exist dependency ancestor node node versioning enables optimization prune away audit without forensic analysis moreover versioned graph acyclic simplify graph algorithm ttps severity moderate critical entity file socket memory user another significant provenance graph memory developed highly compact provenance graph representation previous average byte memory per audit representation enables consumption graph construction prolong provenance graph analysis query behavior TTP specification TTP specification TTP specification mapping audit apt therefore central component approach subsection choice TTP enable efficient precise attack detection recall ttps layer intermediate abstraction concrete audit apt specifically rely technique audit data intermediate layer OS neutral representation security relevant provenance graph information dependency entity involve ttps technique enable specification malicious behavior largely independent TTP detail specific malware intermediate file program etc regard information TTP specification approach misuse specification IDS literature information dependency crucial detection stealthy APTs hide activity benign goal addition specify TTP capture prerequisite prerequisite reduce false positive understand role TTP context apt campaign TTP specification prerequisite causal relationship information apt stage finally TTP efficient expensive technique backtracking ttps model framework additional precondition involve TTP specification additional apt stage associate TTP entity involve TTP specifies associate TTP illustration specific fourth TTP define reuse across TTP fifth severity associate TTP severity rank alarm prioritize severe alarm assignment severity attack enumeration classification  define cert  collaboration mitre tailor enterprise another customization mechanism whereby severity mapped analyst specify reflect relative importance apt stage deployment context specifies prerequisite TTP prerequisite specify parameter TTP socket parameter untrusted TTP prerequisite previously ttps parameter instance prerequisite mem exec TTP contains exists untrusted prerequisite satisfied untrusted TTP earlier involve ttps factor define specify threshold prerequisite capture relation entity involve ttps relation information file capture ttps prerequisite prune false positive benign activity resemble TTP HSG construction illustrates HSG node graph ttps depict oval inside oval provenance graph entity grey illustration purpose TTP apt stage TTP belongs severity medium TTP graph prerequisite ttps dot entity prerequisite instance mem exec TTP prerequisite untrusted TTP node construction HSG primarily driven prerequisite TTP HSG prerequisite satisfied factor reduces ttps HSG sophisticated analysis without impact performance scenario graph avoid spurious dependency spurious dependency refer uninteresting irrelevant dependency attacker activity instance nginx writes file usr nginx error later file however dependency file unrelated attack invoked independently ssh generally consumes secondary artifact attack activity rotation file entry attacker although benign background activity flag provenance graph dependence attacker spurious dependency promptly prune dependence explosion enormously increase HSGs analyst benign activity analyst attack embed graph prioritize dependency weaker prune away latter intuitively dependency descendant similarly file socket dependency descendant file socket generally entity provenance graph indicates information weak information equivalent entity compromise ancestor compromise ancestor attacker activity dependency prioritize otherwise dependency weak  analysis generalize discussion multiple compromise introduce notion ancestral AC information AC ancestor source non node affect definition minimum ancestral  ancestral minimum intuitively  minimum ancestor attacker compromise exploit information instance nginx attacker ancestor minimum ancestral therefore attacker develop additional exploit attacker vulnerability correspond exploit finally exploit file prefer ancestral capture attack involve likely attack activity execute nginx descendant define notion factor mention earlier discussion ttps intuitively capture extent attacker discussion minimum ancestral dependency strength define factor information minimum ancestral factor simply minimum minimum ancestral ancestor contrast sole nginx minimum ancestral factor nginx efficient computation factor factor greatly mitigate dependency explosion prioritize attacker influence reduction challenge analysis audit attack detection forensics presence benign TTP living browser web server ssh daemon trigger TTP false positive incorporate reduction training data leverage notion benign prerequisite benign data quantity reduction benign prerequisite learns prerequisite frequently benign context runtime prerequisite trigger TTP prerequisite encounter training ignore holmes architecture reduction data quantity filter benign prerequisite false negative malicious unnoticed behavior phase instance without attack nginx etc passwd startup phase however whitelist nginx access etc passwd subsequent compromise nginx server unnoticed tackle enhance incorporate quantity information byte transfer instance amount information file etc passwd nginx file nginx file therefore significantly byte etc passwd nginx attack information quantity file socket benign signal correlation detection HSGs distinguish constitute attack confidence address challenge assign severity HSG assignment proceeds described threat tuples attacker progress campaign abstract threat tuple associate correspond HSG HSG threat tuple tuple corresponds severity apt stage index HSG chose tuples extensive survey APTs choice ttps belonging apt stage severity usually multiple candidate severity candidate instance threat tuple associate HSG tuple contains entry ttps belong apt stage entry accord apt stage chain instance entry tuple severe TTP belonging initial reconnaissance graph severity HSG rank prioritization rank HSGs transform threat tuple numeric threat tuple numerical conversion vulnerability CVSS vendor neutral standard collaboration security professional across commercial non commercial academic sector alternative choice enterprise context perceive threat threat nist severity rating combine numeric apt stage overall formula compute criterion flexibility customization correlation apt reflect magnification unfold address criterion associate entry convert threat tuple calculate threat tuple configurable administrator prioritize detection specific stage stage training perform scheme sum exponential sum geometric sum equation average margin benign subgraph attack subgraph normalization hence criterion flag apt attack SourceRight click MathML additional feature apt stage denote respectively severity stage detection threshold TTP occurs stage implementation consumption provenance graph construction architecture holmes achieve platform independence audit OSs normalize data representation cdr abstraction various entity streamline audit data processing cdr audit publish processing server kafka analysis detection proceeds consume server  consumption causality provenance graph construction detail policy HSG construction policy TTP specification input operates provenance graph representative TTP specification implementation holmes TTP provenance graph built policy iterates prerequisite particularly challenge task TTP prerequisite previously ttps factor previously ttps graph factor traverse prior attack forensics backward TTP initial compromise unfortunately computationally expensive strategy provenance graph representative ttps denotes correspond linux freebsd severity moderate critical entity file socket memory user challenge without backtracking incremental approach previous computation propagates pointer along graph specific TTP prerequisite ttps correspond node HSG pointer node pointer propagate entity dependency entity TTP factor similarly compute TTP node HSG factor incrementally compute node provenance graph dependency entity TTP assume generate TTP factor assign subsequently provenance graph factor non node ancestor otherwise factor increase information happens already dependency version construct factor minimum factor calculate acyclic provenance graph built versioning factor finally correspond TTP encounter reuse pointer prerequisite ttps precomputed factor immediately available bottleneck pointer correlation layer provenance graph HSG overhead complexity provenance graph grows operational observation typically entity ttps phenomenon random actually propagation pointer descendant rare pointer analysis proceeds implementation insight maintain intermediate entity provenance graph ttps HSG therefore entity provenance graph pointer intermediate mapper mapper contains pointer filter detection filter identifies benign TTP exclude HSG input normal behavior model benign model contains ttps benign threshold byte policy TTP entity prerequisite TTP model entry exists model contains prerequisite entity amount transfer byte checked benign threshold amount byte transfer benign threshold node correspond TTP filter otherwise node correspond HSG finally detection computes sum HSGs alarm surpasses detection threshold publish trace duration topic MB trace duration VI experimental evaluation experimental evaluation adversarial engagement organize government agency specifically darpa evaluate holmes dataset available beforehand VI VI VI VI evaluation calculate optimal threshold holmes VI performance VI finally VI explore applicability holmes detection prior knowledge conduct attack dataset release public domain stimulate research datasets independent attack vector host datasets attack datasets evaluation summarize apt scenario host across OS platform scenario platform collectively worth audit  dtrace  ubuntu freebsd microsoft respectively contains kernel audit routine activity attack activity attack constitute audit data volume independent apt attack remain apt attack nutshell adversarial goal activity attack scenario profile apt campaign typical apt activity browser induced initial compromise backdoor injection privilege escalation internal reconnaissance exfiltration sensitive asset cleanup attack footprint attack sophisticated attack vector reflective load web capability memory module load evaluate robustness holmes apt attack benign data reduction model worth benign audit data target host program browser firefox web server nginx various daemon   setup engagement machine vulnerable software later exploit normal attack perform benign activity target host parallel attack routine activity limited web browsing email software upgrade administrative task  program administrative privilege holmes subscribed kafka topic topic per host consume audit perform analysis detection publish regard percentage growth audit trace duration holmes consumes publishing rate kafka server incremental growth publish kafka topic configure holmes ttps mention  prerequisite ttps apt stage account slightly later apt stage assign attack scenario moderate critical scenario benign dataset threat assign benign background activity audit collection host pre attack parallel attack attack nutshell summarizes detection attack scenario threat tuple HSG detection correspond threat fourth benign scenario machine attack scenario benign scenario program correspond attack scenario assign benign HSGs scenario assign attack HSGs scenario related incomplete attack harm holmes attack benign scenario disjoint cluster distinction reduction factor plot threat benign attack HSGs construct analyze setting default factor calculation enable without without factor obvious factor considerable margin attack HSGs benign without factor increase false positive false negative percentile quartile median default collide threat HSGs severity untrusted TTP factor reduction quartile indicates median whisker extend percentile HSG scenario notation untrusted external address firefox malicious file net rat     secret txt attack scenario additional attack scenario detect holmes detail scenario related appendix scenario II portion provenance graph HSG respectively scenario attack scenario user malicious website vulnerable firefox browser file net execute victim host file execution connects server reverse attacker attacker launch prompt executes command hostname     finally malicious executable  information IP address server attacker remove malicious file initial compromise apt stage untrusted file execute TTP critical severity threat tuple graph apt stage consequently convert quantitative threat precision recall attack detection threshold provenance graph growth consume HSG growth consume memory footprint MB consume  respect memory consumption optimal threshold optimal threshold precision recall threshold harmonic precision recall maximum interval maximum benign subgraphs minimum attack subgraphs therefore threshold holmes distinction attack benign subgraphs datasets accuracy recall optimal transform threat linear nth transform average contribution apt overall threat datasets belong host exclude lateral movement nth interval maximum finally average severity apt contribute overall threat benign performance graph comparison growth trend provenance graph HSG graph ratio fold reduction achieve mapping provenance graph HSG memory holmes core cpu 5GHz 0GB ram memory consumption holmes audit nearly linear growth memory consumption operates audit memory extrapolation host holmes regard memory consumption scalability enterprise host evident host increase duration provenance graph memory decrease runtime holmes consumes analyzes audit kafka server become available stress performance assume audit available cpu consume building provenance graph construct HSG detect APTs define cpu utilization ratio cpu duration scenario cpu utilization scenario extrapolation host comparable audit trace duration scenario holmes cpu limit factor cpu enterprise host explore holmes respond attack embed within predominantly benign evaluate detection span audit multiple linux bsd analyze holmes enterprise simulated security critical service web server mail server ssh server SMB server access file previous datasets extensive normal activity conduct series attack however configure parameter beforehand prior knowledge attack moreover host internal connectivity apt stage laterally attacker detection threshold cumulative distribution function attack benign HSGs holmes construct threat benign HSGs bypass threshold explain false positive discus potential false negative scenario false positive false alarm ssh connection administrator connection untrusted IP address subsequently holmes aggregate severity action issue administrator via ssh connection threat bypass threshold define custom tag policy server ssh perform authentication server marked untrusted evaluate false alarm evaluate another benign activity diverse normal activity conduct software update upgrade package manager holmes generate false alarm false positive holmes acceptable rate benefit enterprise security analyst manually alarm neutralize HSGs falsely construct false negative although false negative discus potential scenario holmes implicit causality ttps information avoids holmes visibility causal relation entity however attack unfolds visibility holmes partially reconstruct attack cpu utilization extrapolate host handle holmes respect cpu cumulative distribution function attack benign HSGs multiple entry active evasion technique attacker exploit multiple entry detach subgraphs holmes entry detection threshold satisfied correlate ttps disjoint subgraphs information nevertheless additional analysis completely correlate attack entry information vii related holmes contribution alarm generation alert correlation scenario reconstruction central holmes construction attack scenario graph underlie basis discus related alarm generation host intrusion detection approach misuse detect behavior associate attack anomaly model benign behavior detect deviation specification detect attack policy specify expert technique cannot unknown attack false positive specification technique reduce false positive application specific policy consume develop rely expert knowledge superficial ttps holmes instance misuse detection however approach beyond classic misuse detection prerequisite consequence exist information dependency entity involve TTP alarm correlation historically IDSs tend alert numerous operator technique developed summarize alert greatly reduce volume approach alarm correlation perform detection cluster alarm identify causal relationship alarm instance  employ anomaly approach correlate dialog internal external host network  community discovery technique correlate attack disperse across multiple moreover approach building  alert correlation enforcement disparate data source approach rely generate application user moreover alert correlation statistical feature alert timestamps precise detection multi stage apt attack usually span duration contrast approach holmes information exist various attack purpose alert correlation kernel audit data context pursue however differently holmes purely misuse focus correlation detect attack IDS holmes kernel audit data pursues approach building memory dependency graph memory footprint derivation HSG specification ttps alert finally correlate alert information additional alert correlation relies proximity alert holmes contrast relies information causality connection correlate alert therefore capable detect attack execute slowly scenario reconstruction research effort focus generation forensic analysis investigation recovery forensic analysis approach trace compromise compromise beep  mpi training code instrumentation annotation execution address dependency explosion forensic analysis  performs timely causality analysis quantify notion  prioritize investigation abnormal causal dependency contrast holmes trace perform detection integrate forensics capability detection framework attack without instrumentation recent analytics  tag technique attack detection situ forensics holmes significant advance  address dependence explosion concept minimum ancestral develop efficient algorithm incremental computation  scenario graph abstraction provenance graph analyst moreover lack actionable information HSGs  graph become attack whereas holmes generates compact HSGs reduction prioritization technique attack granularity sometimes coarse granularity audit limit information previously load sensitive file compromise attacker sensitive content inside memory without however information  holmes correlate exfiltration action sensitive file eventually exception furthermore holmes adapt advantage additional information finer granularity additional instruction decouple taint grain information precise provenance information performance overhead conclusion holmes apt detection correlate tactic technique procedure apt stage holmes generates graph summarizes attacker evaluate holmes apt threat deploy intrusion detection holmes successfully detects apt campaign precision false alarm rate