data asset data driven economy fuel emergence data trading however limitation conventional data trading platform due existence dishonest buyer data broker mitigate limitation posit importance data processing service model complement conventional data host exchange service model specifically introduce secure data trading ecosystem blockchain data trading ecosystem hereafter refer SDTE ecosystem data broker buyer obtain access seller raw data access analysis finding reduce challenge secure dataset challenge secure data processing security model analyze data trading trading protocol entire data trading demonstrate utility implement propose secure data trading platform SDTP ethereum intel software guard extension sgx perform depth analysis introduction capability handle amount data efficiently crucial data analysis inform decision public private sector societal benefit increase productivity reduce  facilitate exchange datasets data trading platform data exchange proliferate recent platform bridge seller buyer     conventional data trading ecosystem simplify version typically comprises namely seller data exchange buyer specifically seller sends dataset trust data exchange platform appropriate price buyer data online commerce transaction upon buyer payment data exchange platform transmit purchase data buyer seller deduct management fee commission however raw dataset cannot directly buyer buyer dataset obtain satisfy buyer simplify conventional data trading processing simplify conventional data trading processing however concern lack accountability transparency centralize trading model explain dishonest data exchange covertly cache resell seller dataset without latter knowledge approval due opaque data exchange transaction challenge detect tamper resell trading information dishonest buyer resell purchase raw dataset without seller knowledge approval somewhat analogous copyright infringement piracy impact profit seller addition dishonest buyer attempt transform purchase raw dataset perform arbitrary operation insert remove data dataset circumvent exist detection mechanism centralize data exchange model failure attack attacker target compromise data exchange platform instead multiple data owner related incident  federal commission however regulation viable realistic police buyer online behavior addition introduce regulation stifle innovation hence attempt research community approach mitigate limitation blockchain data trading    facilitates buyer seller seller transmit data buyer without dataset platform addition data via  uniquely tag investigate suspect unauthorized resale activity request seller however dishonest buyer  purchase dataset offline via platform clearly  investigate another  comprises accountable protocol mitigate risk due dishonest buyer specifically author described data exchange perform rigorous measurement data uniqueness uniqueness index detect punish dishonest behavior approach however uniqueness index similarity comparison mechanism somewhat  software publishing detect plagiarism data exchange algorithm limitation  unauthorized resell activity offline platform deploy  protocol detect limitation journal conference  software submit accepted manuscript focus smart contract data transaction participant private information  TC goal address data issue smart contract TC mainly sgx data collection ensure data tamper data pdfs improvement TC pdfs data blockchain ensures reliability source data  allows multiple node collectively submit input data selects nth node submits data node reward approach encourages node data however intellectual seller personal identity information data seller propose blockchain data trading protocol integrates signature authentication prevent signature similarity privacy data seller although data seller private information cannot prevent data buyer resell raw data propose remote data integrity audit scheme realizes data sensitive information hiding sanitizer sanitize sensitive information transform sensitive information signature valid allows verify integrity sanitize file however scheme prevent resale data contribution layout posit importance analyze address meal exist data trading ecosystem buyer generally obtains entire dataset seller however access dataset buyer finding data analysis inform data driven decision instead access seller entire sale data quarter buyer aggregate statistic quarter sale data therefore data trading ecosystem finding directly seller transmit entire dataset buyer therefore data trading ecosystem complement exist trading ecosystem data host exchange service data processing service buyer analysis seller dataset challenge secure dataset reduce challenge secure data processing specifically intel software guard extension sgx secure execution environment data processing source data analysis construct secure data trading ecosystem SDTE blockchain prevent failure blockchain allows ensure transaction SDTE transparent facilitates detection modification transactional information execution SDTE buyer deploys data processing algorithm smart contract secure data trading platform SDTP implement ethereum buyer identifies data locates prospective seller trust node execute data analysis contract broadcast contract buyer demand broadcast contract BDBC SDTP remark trust node SDTP ethereum virtual machine  EVM sgx conventional EVM without sgx protection traditional contract execute conventional EVM normal node trust node data analysis contract execute sgx EVM trust node information BDBC seller trust node obtain buyer respond accordingly via IP address buyer buyer filter seller trust node information contract information storage contract CISC sgx remote attestation executes smart contract respectively buyer encrypt data analysis trust node enclave successful execution sgx remote attestation buyer sends information relate trust node information seller latter decryption raw data node enclave buyer encryption seller decryption seal sgx seal later buyer pre sum management contract data trading management contract DTMC payment amount seller trust node upon successful execution data analysis contract seller node reward contract respectively DTMC CISC finding DTMC CISC align expectation seller encrypt raw data trust node buyer node decrypt seller data execute data analysis contract analyze raw data enclave buyer node execute analysis contract sgx latter hardware secure execution environment ensures confidentiality data processing source data data analysis trust node proceed encrypt finding data analysis buyer enclave resultant information hash exclude unencrypted DTMC trust node achieve consensus blockchain DTMC calculation outcome identical DTMC reward seller trust node accord outcome finally trust node encrypt data analysis buyer buyer retrieves balance DTMC feedback seller DTMC DTMC buyer comment resultant information hash exclude unencrypted CISC future buyer prevents seller source data leak without affect buyer ability obtain data analysis simplify secure data trading data processing summary contribution novel blockchain data trading ecosystem SDTE complement exist data host exchange model protocol propose data trading ecosystem ensure security data transaction background relevant platform architecture security model data trading overview SDTE IV prior SDTE protocol evaluate security propose SDTE VI vii implement secure data trading platform SDTP ethereum evaluate execution efficiency knn algorithm SDTP trust execution environment conventional EVM environment conclude II background briefly discus component SDTE namely smart contract EVM sgx smart contract compute protocol intend digitally facilitate verify enforce negotiation performance contract smart contract achieve non repudiation execution transaction without involve ethereum smart contract contains contract account address runtime bytecode related transaction deploy contract developer writes compiles contract code bytecode developer externally account  transaction contract bytecode prior broadcasting signing private pack node network execute generate contract account interact contract address packed ethereum node execute contract code EVM blockchain consensus achieve EVM stack environment smart contract contract EVM contract runtime bytecode continuously performs operation bytecodes sgx extension intel architecture IA protects execution application hardware sgx compute environment buyer data VC core sgx technology memory epc program enclave within epc code data enclave cpu application access code data enclave sgx inter platform enclave attestation verify software enclave attestation challenge response protocol asymmetric cryptography challenge enclave internal private execution software challenger proof verify challenger public challenger establish secure channel enclave sgx seal operation encrypts secret outside enclave seal policy useful accessibility sensitive data future version enclave architecture security model overview SDTE entity namely buyer seller SDTP blockchain node buyer deploys data analysis contract SDTP analyze seller raw data obtains data analysis seller data source profit access data analysis whilst conventional model seller access dataset SDTP secure blockchain contract deployment requirement contract execution consists trust node sgx normal node overview SDTE typical workflow SDTE buyer deploys data analysis contract SDTP seller data SDTP trust node seller sends data trust node buyer data analysis perform trust node achieve consensus SDTP contract execution buyer security model summary risk potential attack vector  denotes information leakage occurs execution data analysis contract blockchain node RF denotes repudiation fraud fraudulent activity buyer DF denotes data seller raw data unauthorized indicates malicious actor collusion actor role typical transaction seller data buyer deploys smart contract obtains node responsible execute smart contract malicious role perform attack denial service dos attack malicious role potential attack malicious role potential attack risk potential attack vector seller seller attempt maximize profit redundant irrelevant data RF buyer dishonest buyer seek maximize profit deliberate contract crash steal seller data contract deploy contract cannot EVM DF avoid smart contract RF trust node trust node node sgx hardware trust node SDTP attempt steal source data analysis node super user access physical hardware delete modify insert arbitrary stack  trust node cheat contract node reward RF collusion buyer seller collude trust node RF seller trust node collude steal buyer cheat contract node RF DF attribute buyer trust node collude steal seller data via EVM badly contract avoid smart contract  RF DF sgx assume enclave sgx sufficiently secure execute smart contract secure channel establish remote attestation reliable assume sgx seal data sgx decrypt seal data sgx synchronization bug privacy leak however sgx channel attack refer interested reader understand channel attack sgx potential exist SDTE prevent sgx channel attack dos attack attacker invoke contract repeatedly exhaust network communication resource SDTP network communication entity network internet service provider attacker tamper delay transmission session seller buyer node ethereum integrity contract transaction ensure confidentiality SDTE IV SDTE overview security feature SDTE security feature resist data theft node SDTP execute smart contract source data data analysis specifically smart contract generate intermediate data seller source data steal entire transmission execution data analysis ideal scenario calculation obtain buyer prevent repudiation fraud SDTP seller node cheat buyer previously deceive buyer ensure buyer reward honest seller node paid buyer cannot escape execute smart contract malicious node cannot cheat buyer obtain reward ensure buyer legal buyer seller malicious seller attempt redundant data extra profit irrelevant data trick buyer therefore SDTE allows user seller seller limit maximum profit prevent seller additional data seller prevent malicious contract ethereum callcode external address arbitrary argument malicious smart contract attempt illegally transmit input data external address contract obtain seller raw data without without authorization buyer contract output source data directly therefore contract callcode invocation EVM enclave limited prevent raw data contract prevent output source data principle SDTE around security feature explain core resist data theft node previously SDTE contains data namely intermediate data generate smart contract source data data analysis prior execute data analysis contract raw data seller buyer trust node raw data seller data encrypt transfer trust node decrypt sgx security environment trust node raw data cannot leak smart contract ethereum environment smart contract EVM limit access inside outside however EVM limit access outside inside node steal intermediate data source data analysis decryption execution therefore decryption raw data EVM enclave sgx prevent malicious node obtain raw data intermediate data analysis analysis available sgx trust node encrypt buyer prevent leakage analysis leak prior buyer obtain seller decrypt raw data buyer encrypt analysis secure transmission node related sgx environment therefore establish secure channel sgx remote attestation transfer respective seller buyer directly enclave outside enclave sgx seal related encrypt data seller decrypt enclave buyer encrypt enclave rely secure encryption sgx ensure security critical data non repudiation fraud prevention although critical data malicious buyer refuse seller node malicious node falsify collude node obtain buyer reward malicious seller attempt additional reward additional irrelevant data smart contract ensure seller buyer trust node honestly fulfill obligation introduce data trading manager contract DTMC guardian DTMC traditional ethereum smart contract honestly incoming information execute data analysis contract buyer deploy contract SDTP buyer price seller trust node public DTMC buyer pre amount ether DTMC  seller sends data data analysis contract query DTMC price satisfied buyer reward seller seller notify DTMC node transaction DTMC reward execute smart contract execute contract private data leak underpin sgx protection execute contract node execution information DTMC consensus DTMC calculate identical DTMC reward seller trust node accord ensures honest node reward buyer rate seller later ensure calculate enclave tamper node transmission enclave generate internal execution verify signature DTMC obtain related buyer sgx attestation worth generate within enclave trust node private generate enclave sgx seal trust node cannot private public directly seller node public public seller DTMC DTMC verifies signature trust node enclave fails consequently trust node reward seller redundant data obtain extra reward clearly buyer therefore SDTE buyer cap maximum reward DTMC user rate seller exist approach specifically user honest evaluation seller dedicate smart contract CISC SDTE buyer comment contract acquire service data seller exist restaurant review site yelp approach opinion spam  opinion review brand non review detect supervise manually label training comment author duplicate spam review positive training review negative model approach fuse genre identification psycholinguistic deception detection text categorization opinion spam encourage buyer honest comment context combine exist comment approach blockchain malicious dishonest behavior reveal reputation unlikely seller chosen future buyer addition transaction SDTP transparent buyer query transaction blockchain accurate determination conjunction smart contract buyer review therefore mitigates limitation exist review user paid fictitious review minimize risk centralize exchange collude data owner influence rating prevent malicious contract contract transmit data contract invocation buyer backdoor data analysis contract prevent EVM encapsulate enclave forbids contract SDTE moreover malicious buyer contract directly output seller raw data therefore contract node enclave additionally buyer output output buyer directly output relevant source data significant equivalent obtain copyright seller source data improve security source data exist   incoming data specifically seller output relevant source data within enclave decrypt source data tracked prevent relevant source data output exist data focus implement data future currently implement output module SDTP SDTE protocol achieve security feature precede module SDTE interaction module stage namely contract deployment requirement execution preparation contract execution module SDTE contains important function requirement namely contract register requirement financial management trust environment contract information storage contract CISC buyer demand broadcast contract BDBC data trading management contract DTMC trust node separately discus function module CISC CISC seller information contract information module DTMC buyer comment seller data transaction execution information hash unencrypted exist approach contract information query module CISC prospective buyer appropriate seller contract information CISC BDBC requirement broadcast module receives broadcast buyer demand ethereum node enables seller trust node buyer requirement module BDBC buyer ether prevent denial service dos attack DTMC DTMC seller dataset specification bid price seller trust node buyer information module pre deposit management module buyer deposit ether seller trust node execution DTMC query interface information query module trust node seller reward statistical analysis module analyzes execution numerous identical reward module responsible ether related address seller trust node trust node sgx remote attestation module authenticate node sgx environment remotely establish secure channel data transmission enclave trust node data seal unseal module securely secret data outside seal data enclave cryptographic operation module decrypt input data seller encrypts buyer data analysis EVM seller data buyer data analysis contract output module EVM output signature module enclave prevent node falsify smart contract deployment SDTP BDBC implement DTMC buyer pre deposit ether DTMC negotiation buyer seller agreement buyer lock DTMC summary notation summary notation proposal II II summary role notation contract deployment deploy data analysis smart contract traditional deploy ethereum address obtain deploy data analysis contract  requirement buyer appropriate data analysis contract data source SDTP buyer trust node execute data analysis contract define requirement detail buyer demand dataset specification II bid price     trust node execute    denote reward processing data seller node   maximum reward seller node buyer broadcast    transmit node enclave sgx seal ID    encrypt data analysis seal data IV ID   generate enclave sgx seal ID   buyer query seller information CISC judge seller buyer directly query specific transaction blockchain verify authenticity information CISC trust node buyer  worth seller trust node response BDBC simultaneously convenience expression display separately buyer seller information comment CISC malicious seller buyer requirement SDTP requirement SDTP execution preparation execute  trust node preparation transmission seller decryption confirmation reward trust node seller execution contract execution preparation buyer ID          DTMC ID unique identifier execution contract pre ether execute  node reward seller reward reward transfer correspond address     specify price processing data upper limit reward prevents seller trust node processing additional useless data additional reward  verify information trust node generate within enclave prevent trust node forge information obtain reward finally  trust node accept specific data seller thereby prevent everyone perform seller trust node DTMC response expectation query information trust node perform sgx remote authentication   performs limited transaction prevent attacker malicious seller perform multiple dos attack information enclave node secure channel establish sgx remote attestation information seller node generate enclave ID   later outside enclave via sgx seal execution preparation SDTP contract execution execution preparation trust node execute  entire contract execution execute contract enclave trust node unseal ID   ID correspond   contract enclave accord  encrypt raw data seller enclave decrypt  EVM contract seller raw data obtain additional consume smart contract amount related output data signature enclave  ID input data hash output sum contract collapse generate signature output ID input data hash output sum information DTMC consensus DTMC perform signature verification sender belongs node buyer DTMC data vote regard node vote regard honest reward buyer reward   calculate accord processing data combine   malicious seller amount redundant data reward DTMC   upper bound data calculates seller trust node reward finally consume EVM deduct buyer retrieves balance evaluation smart contract data seller DTMC execution successful fail buyer comment buyer deposit ether EVM input data output data CISC evaluate seller encourage buyer honest comment exist research mention IV focus research CISC exist research opinion spam contract execution SDTP VI security analysis combine security analysis analyze dos attack role launch attack constantly transaction related smart contract BDBC DTMC consume network resource analyze attack malicious role attack collusion malicious role worth multiple role collude additional attack addition attack role initiate analyze collusion attack additional attack dos attack attacker role SDTP consume SDTP network resource construct multiple transaction invoke BDBC attacker broadcast demand BDBC continuously perform subsequent operation additional fee BDBC broadcast attacker consume network resource deposit extremely amount DTMC exception  due insufficient execution illustrate communication transmission perform smart contract execute fee communication immediately therefore attacker construct dos attack waste network resource SDTP defend attack minimum pre deposit DTMC buyer impose restriction seller ability transmit decrypt raw data seller perform remote authentication remote authentication perform transaction limited malicious buyer malicious buyer SDTE malicious smart contract steal resell data data analysis deny execution expense seller trust node malicious contract malicious buyer evil smart contract smart contract leak seller raw data restriction EVM enclave forbid contract ability smart contract buyer output seller raw data directly output smart contract buyer directly output secondly buyer spends amount obtain source data equivalent buyer obtain copyright seller raw data acceptable seller future source data enclave enhance security seller raw data buyer deny execution expense buyer expense trust node reward seller reward EVM smart contract buyer cheat trust node reward tamper address reward node DTMC sends trust node address DTMC buyer node execute contract writes node address DTMC buyer modify  DTMC reduce reward rate trust node SDTP trust node query DTMC perform designate smart contract execute address reward DTMC  expectation trust node execute contract buyer cheat seller reward modify   DTMC seller query   expectation data trust node DTMC  expense EVM execution execution smart contract data buyer cannot deny expense EVM malicious seller obtain reward seller cheat source data transmit redundant data trust node buyer data obtain additional reward seller data trust node buyer   precisely maximum price data seller extra revenue sends extra data addition seller data buyer  profit buyer obtain seller relevant comment CISC purchasing data comment credible exist research program encourage buyer previously seller honest evaluation buyer seller seller information CISC malicious node malicious node evil mainly purpose obtain data reward data obtain malicious node aspect data analysis source data data transmit trust node ciphertext encrypt   encryption enclave secure channel establish remote authentication decryption processing data perform within enclave therefore malicious node obtain plaintext data reward unselected node execution ID input data hash output sum node pretend node DTMC execution information reward prevent situation buyer node address DTMC advance DTMC judge sender information node specify buyer malicious node collaborate report execution DTMC contract obtain reward ensure execution DTMC receives tamper  execution information enclave  within enclave sgx seal technology ensure  enclave  verify signature   buyer secure channel sgx remote attestation ensures buyer  correctly buyer  DTMC verify signature  DTMC receives information node node falsify execution collusion malicious role buyer seller collude compute resource SDTP trust node EVM execute smart contract mention trust node DTMC execute smart contract buyer seller collude impossible deny malicious contract node buyer collude malicious buyer designate malicious node node execute smart contract seller data malicious node data node seller pas enclave sgx remote authentication node cannot steal tamper private data chapter malicious node seller raw data leak addition seller query DTMC reward expectation smart contract therefore malicious node buyer steal tamper data deny node seller collude node buyer malicious steal buyer analysis extra reward useless data however buyer maximum reward seller node enclave prohibits contract enclave execution information ensure execution tamper buyer guaranteed vii implementation evaluation knn algorithm classic machine algorithm implement knn algorithm smart contract performance sgx EVM knn algorithm calculate input input moreover manually implement integer operation library sgx sdk cannot library EVM  contract deployment requirement execution preparation contract execution extra execution preparation contract execution sgx remote attestation establishes secure channel transmits secret execution smart contract secure environment traditional EVM machine simulate SDTE user seller buyer   denote trust node    ordinary machine without sgx hardware environment installs sgx sdk sdk library   trading remote attestation   equip 0GHz intel xeon cpu processor core GB ram network interface  network  dell precision tower intel cpu 0GB memory node  analyze extra item secure transmission enclave  node execute data analysis contract SDTP sgx remote attestation secure channel establishment transmission average average increase mathbf role trust average increase  secure transmission remote attestation secure channel establishment transmission  increase increase linearly trust node collusion decrease passing worthwhile user ensure secret cannot acquire malicious node SDTP contract execution sgx overall incur execute knn sgx conventional EVM contract execution performance comparison SDTP conventional EVM knn sgx comprises namely reading smart contract bytecode enclave reading buyer data enclave decrypt contract bytecode EVM encrypt buyer calculate average overhead execute entire contract execution dell precision tower machine input data aes symmetric encryption algorithm  perform enclave encryption decryption knn item data item integer convenience denote item data item data knn handle data therefore additional contract execution sgx increase linearly data conventional EVM additional overhead sgx EVM spent copying data within enclave untrusted memory decrypt source data encrypt data analysis within enclave input source data increase proportion additional performance overhead becomes sgx EVM analyze data data analysis contract sgx EVM complex data analysis contract difference sgx EVM conventional EVM decrease input source data increase contract execution sgx increase security execution significantly without unrealistic overhead runtime ethereum private chain ubuntu exclude spent role decision buyer obtains seller information CISC data graph realistic generate public chain modify difficulty genesis file private chain trust node execute data analysis contract data obtain contract execution node transaction DTMC assume transaction increase linearly datasets SDTP buyer deploys data analysis contract buyer broadcast demand BDBC etc contract SDTP approximately consensus combine due contract DTMC transaction SDTP contract runtime SDTP conclusion SDTE blockchain ecosystem complement mitigate limitation exist data trading specifically introduce paradigm shift buyer obtains data analysis actual dataset blockchain trace unauthorized transactional modification built sgx secure contract execution environment source data analysis demonstrate security SDTE capability withstand attack conduct collude arbitrary SDTP implement ethereum sgx performance evaluate currently SDTP implement sgx sdk client client popular ethereum client hence future research implementation client extend environment llvm jvm cater broader application previously future source data enclave enhance security seller raw data