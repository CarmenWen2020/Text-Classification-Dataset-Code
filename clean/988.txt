increasingly powerful extensive deployment device fog compute enables customer manage analyze data locally extends compute data analysis application network meanwhile generation grid smart grid achieve goal efficiency economy security reliability safety environmental friendliness grid however privacy secure issue fog smart grid communication challenge without protection customer privacy readily violate article smart practical privacy preserve data aggregation PDA scheme smart pricing pack fog smart grid achieves diversified tariff multifunctional statistic efficiency propose smart PDA scheme smart pricing PDA SP PDA SP CC compute complex aggregation statistic various service  pricing strategy strategy subsequently practical PDA scheme pack PDA PM reduce encrypt data improve performance perform various secure computation moreover extend pack useful pack handle vector entry security analysis propose scheme secure threat performance evaluation reveals computation communication overhead propose scheme effectively reduce employ somewhat homomorphic encryption pack significantly reduce overhead introduction fog compute extends compute boom recent fog compute enables customer realize computation communication storage locally extends function compute network data era user expectation service quality network performance traditional compute significant shortage storage capacity compute handle user query report therefore beneficial transfer functionality fog node fog compute advantage response delay fog volatility perception enhance safety reliability comparison compute fascinate advantage contribute spatial crowdsourcing fog smart grid industrial internet generation grid smart grid achieve goal efficiency economy security reliability safety environmental friendliness grid fog node enables utility various service service query command customer CC adjust price electricity obtain overall consumption customer electricity additional accord customer requirement however challenge privacy security fog smart grid communication electricity usage data involve customer usage closely related private improper handle data disclosure customer privacy addition diversified tariff multifunctional statistic efficiency careful consideration traditional tariff usually fix pricing calculate customer electricity bill limited pricing strategy development fog smart grid grid traditional tariff insufficient requirement pricing intelligent electronic device therefore  PDA scheme achieve diversified tariff urgent increase demand consumer various service CC calculate complex statistic function however previous depth homomorphic multiplication powerful therefore multifunctional PDA scheme CC calculate statistic function critical propose CC fog node customer computation communication however bilinear technology employ previous burden CC fog node urgent efficient PDA scheme fog smart grid achieve diversified tariff multifunctional statistic efficiency article propose smart practical PDA scheme fog smart grid smart pricing pack conclude contribution almost previous fix pricing consideration alternative pricing strategy limited traditional tariff insufficient requirement pricing response introduce smart pricing fog smart grid thanks peculiar feature CC  pricing strategy indirectly customer dynamically adjust usage electricity price addition propose scheme perform analysis variance anova evaluate pricing strategy impact customer electricity usage behavior strategy CC compute complex statistic function various service introduce multifunctional PDA scheme multifunctional additive non additive aggregation CC calculate statistic function addition min aggregation protocol fog smart grid computation communication overhead reduce encrypt data improve performance perform various secure computation pack PDA scheme pack packed ciphertexts vector message encode technique   vaikuntanathan propose scheme efficient ciphertext performance addition useful pack handle vector entry introduce fog smart grid previous utilize bilinear homomorphic encryption computation communication overhead effectively reduce furthermore performance evaluation reveals pack significantly reduce overhead scheme lightweight efficient structure overview related II describes formalization propose model threat model goal preliminary IV propose PDA scheme fog smart grid security analysis finally concludes II related scheme achieve multifunctional efficient PDA related publish recent literature generally PDA scheme statistic orient PDA perform various statistical analysis remote data efficiency orient PDA focus efficiency concern statistic orient PDA PDA scheme data slice max min additive aggregation subsequently efficient sum min aggregation ciphertexts employ additive homomorphic encryption management ensure data integrity user privacy verify PDA achieves multifunctional additive non additive aggregation sum variance max min median percentile histogram PDA scheme  statistical function addition average aggregation scheme realizes differential privacy anova variance aggregation achieve non additive aggregation differential privacy propose scheme realizes multifunctional additive non additive aggregation simultaneously scheme  enables privacy preserve communication efficient distribute monitoring thresholded percentile aggregate privacy aware data aggregation task allocation scheme scheme achieves statistic sum variance min efficient data update privacy preserve concern efficiency orient PDA traditional scheme mostly homomorphic encryption technology traditional homomorphic encryption scheme allows meaningful calculation ciphertexts improves computational efficiency categorize paillier PDA scheme employ paillier encryption encrypt ciphertexts operation  PDA scheme  encryption construct scheme perform addition multiplication simultaneously scheme handle addition multiplication PDA scheme utilize bilinear homomorphic encryption achieve efficient PDA however scheme perform arbitrarily addition depth homomorphic multiplication really expand gentry important breakthrough fully homomorphic encryption FHE scheme lattice handle addition multiplication enables calculate arbitrary statistic securely unfortunately scheme complicate interestingly FHE scheme associate practical scheme addition limited multiplication article achieve privacy preserve encryption decryption importantly research crucial flaw statistic orient PDA scheme utilize bilinear homomorphic encryption realize multifunctional addition non addition aggregation however depth homomorphic multiplication ciphertexts aggregator aggregate user data privacy preserve statistic function efficiency orient PDA scheme bilinear technology inevitably burden aggregator server efficiently adapt fog smart grid scenario formalization model fog smart grid consists trust authority TA utility CC substation fog node community community contains customer equip smart meter describes model trust authority TA entity registration powerful booting utility CC analyzes smart meter data issue grid command smart meter substation customer reliable grid service utility responsible electrical generation storage distribution fog node substation information customer smart meter CC smart meter reading request command preserve fog node substation utility command electricity transmits electricity customer customer customer smart meter electricity usage data relay data request grid service CC model fog smart grid model fog smart grid threat model article assume TA CC trust entity adversary threat model specifically attack model consideration chosen plaintext attack cpa model plaintexts obtain correspond ciphertexts plaintext attack kpa model obtain plaintexts correspond ciphertexts ciphertext attack COA model ciphertexts addition participant honest curious adversary model participant perform protocol honestly curious customer privacy data independently attack eavesdrop communication compromise customer directly intrude database CC fog node steal data article primarily focus privacy electricity usage data attack privacy disclosure beyond scope article goal goal multifunctional  efficient PDA scheme fog smart grid specifically realize goal propose scheme guarantee diversified tariff meeting requirement pricing  pricing strategy propose scheme guarantee diversified tariff CC customer dynamically adjust usage electricity price propose scheme multifunctional statistic although previous realize multifunctional addition non addition aggregation depth homomorphic multiplication increase demand consumer propose scheme CC aggregate customer electricity usage data privacy preserve statistic function CC compute complex statistic function various service specially propose scheme  statistical function customer electricity usage data sum inner anova max min propose scheme achieve efficiency although previous employ bilinear homomorphic encryption realize efficient PDA involve bilinear operation burden CC fog node propose scheme achieve PDA efficient preliminary somewhat homomorphic encryption briefly recall parameter construction correctness scheme literature slightly modify literature security scheme polynomial error PLWE assumption simplify version error RLWE assumption parameter parameter refer lattice dimension define cyclotomic polynomial integer satisfies mod ciphertext define prime determines plaintext integer denotes discrete gaussian error distribution  standard deviation integer sample construction briefly construction scheme security parameter generation KG sample error random compute private public encryption enc plaintext calculate enc ciphertext enc homomorphic operation define ciphertexts compute homomorphic addition cmax max rmax calculate component wise addition ciphertexts pad zero  similarly compute homomorphic multiplication symbolic variable embed compute  therefore calculate ixi  ixi ciphertext longer homomorphic multiplication previous encryption ciphertext decryption dec private ciphertext compute  dec  denotes private vector dec  correctness correctness upon homomorphic operation ciphertexts decryption restore plaintexts homomorphic operation ciphertexts correspond structure refer proof lemma plaintexts correspond ciphertexts respectively dec   described instead FHE scheme scheme correctness satisfy lemma lemma decryption regard ciphertext mod decryption dec output namely decryption restore satisfies norm coefficient representation define max  IV PDA SP privacy preserve data aggregation scheme smart pricing propose smart PDA scheme smart pricing phase initialization SI customer report generation  privacy preserve report aggregation pra secure report reading SRR initialization bootstrapped TA generates private public CC TA chooses random error assume private compute public aggregation protocol sum fog smart grid temporal aggregation CC aggregate customer electricity usage data calculate customer electricity bill mainly focus privacy preserve temporal aggregation easily extend achieve privacy preserve spacial aggregation customer report generation assume temporal aggregation cycle    etc simplicity temporal aggregation cycle smart meter report electricity usage fog node temporal aggregation cycle specifically customer electricity usage data  performs chooses computes  enc  report  fog node privacy preserve report aggregation basis CC requirement fog node aggregate customer electricity usage data privacy encrypt electricity usage data  specially fog node calculates aggregation fog node utilizes  compute     source calculation fog node sends aggregation  CC secure report reading correspond aggregation CC compute sum statistic easily without expose individual customer privacy CC computation sum electricity usage  dec  source aggregation protocol electricity bill inner smart pricing scheme tariff define amount electricity per kilo watt consumer advancement smart grid distribute generation introduce grid traditional tariff longer requirement pricing intelligent electronic device response requirement smart pricing scheme recent efficient pricing scheme consist tou pricing critical peak pricing cpp pricing  customer electricity price accord information price electricity customer naturally reduce amount electricity usage thereby reduce electricity demand peak scheme indirectly customer dynamically adjust usage basis electricity price instead directly load smart pricing scheme beyond scope article focus  PDA scheme suitable  pricing strategy specially smart pricing scheme generate electricity price  customer fog node obtain ciphertext electricity bill simply ciphertexts electricity price  electricity usage sum calculate electricity bill compute inner aggregation inner aggregation protocol fog smart grid information inner aggregation CC electricity bill inner aggregation customer electricity bill request fog node customer generates smart meter report sends report fog node ciphertexts smart meter reading customer fog node employ smart pricing correspond electricity price encrypt public calculation furthermore fog node privacy preserve aggregation ciphertexts accord CC requirement aggregation CC obtain aggregation fog node CC recovers electricity bill customer information inner aggregation CC calculate electricity bill temporal aggregation cycle electricity bill request fog node customer report generation phase inner aggregation sum aggregation subsequently fog node employ smart pricing scheme obtain correspond electricity price  utilizes public ciphertexts specially fog node computes enc   sourcein phase privacy preserve report aggregation ciphertexts smart meter reading correspond electricity price encrypt aggregation calculate fog node fog node  calculate    source fog node sends  CC secure report reading phase CC receives correspond encrypt aggregation calculation obtain electricity bill  dec   source aggregation protocol anova CC anova request fog node calculate anova customer electricity usage assume utility pricing strategy CC perform anova customer electricity usage data usage significant impact strategy anova null hypothesis pricing strategy significant impact customer electricity usage variance ssb sourceand within variance  SourceRight click MathML additional feature electricity usage data pricing strategy  encryption ctj enc customer report generation phase anova aggregation sum aggregation phase privacy preserve report aggregation fog node receives customer electricity usage data calculate aggregation fog node utilizes ctj CT CT CT CT CT CT ctj ctj ctj ctj ctj ctj source eventually calculation fog node sends aggregation CT CT CT CC secure report reading phase CC calculation obtain anova dec CT dec CT dec CT SourceRight click MathML additional feature therefore equation simply described ssb   SourceRight click MathML additional feature CC calculate ssb  denominator numerator freedom null hypothesis accepted CC critical customer electricity usage significant impact pricing strategy otherwise null hypothesis refuse customer electricity usage significant impact pricing strategy aggregation protocol max min max min sake simplicity illustrate min define min aggregation minimum electricity usage data temporal aggregation cycle subsection protocol employ sum aggregation ham distance computation min aggregation integer plaintext generally assume sum min aggregation protocol sum min aggregation protocol subsection protocol sum derivative data derivative data electricity usage data assign otherwise plaintext derivative data denotes electricity usage data fog node employ sum aggregation protocol propose IV sum aggregation return positive sum desire min protocol derivative data involve fog node perform sum aggregation protocol sum aggregation protocol employ encrypt derivative data inefficient therefore employ efficient technique concatenate multiple derivative data encrypt derivative data independent extend protocol sum append efficient technique expands derivative data obtain concatenate expand derivative data sum concatenate employ sum aggregation protocol sum regard split substring moreover substring regard integer sum denotes sum derivative data derivative data sum substring affect display instance extend protocol clearly extend protocol concatenate data split concatenate data utilize efficient technique parallel therefore fog node perform sum aggregation protocol parallel fog node perform sum aggregation protocol parallel correctness assume source extend protocol ham distance min aggregation protocol subsection combine prefix membership verification scheme binary realize extend ham distance min aggregation HDB HDB respectively HDB HDB protocol security enhance version min aggregation protocol protocol server decrypt encrypt data algorithm acquire mmin however HDB HDB protocol CC slightly modify algorithm mmin ciphertexts protocol safer customer addition ham distance define correspond employ protocol ham distance computation employ private equality integer ham distance calculate  SourceHere equality integer ham distance integer comparison algorithm ham distance min aggregation    mmin bot mid bot  assume bot mid enc bot mid ctr  ctri enc therefore ctr ctr   ctr      mid mid bot bot mid mid bot bot mid mmin bot mid return mmin procedure accord assume customer electricity usage data vector  prefix   CC compute minimum electricity usage sends min aggregation request fog node customer report generation phase generate compute enc     enc  report enc fog node CC secure report reading phase upon encrypt data enc CC modify algorithm algorithm algorithm obtain mmin min algorithm ham distance comparison    ctr ctr  version   ctri  return return procedure extend version eta underline FM gamma return return procedure algorithm secure ham distance computation FM gamma overrightarrow FM gamma FM gamma ldots FM gamma FM gamma enc overrightarrow FM gamma FM gamma ldots FM gamma FM gamma enc FM gamma leq leq overrightarrow ldots enc leq leq enc overrightarrow ldots CT HM  limit FM gamma oplus  limit oplus  limit FM gamma otimes dec CT HM sum limit FM gamma sum limit sum limit FM gamma cdot dec CT HM return return procedure algorithm refer version encrypt vector  prefix overrightarrow CT FM gamma overrightarrow CT CC verify FM gamma return otherwise return return CT cmp return gamma gamma cap gamma bot mid neq emptyset extend version leq leq leq leq eta CC directly FM gamma return return procedure average computation overhead extend version version PDA PM privacy preserve data aggregation scheme pack employ achieve PDA protocol sum inner anova max min IV however protocol computation encryption inefficient vii detailed comparison pack alternative encode polynomial homomorphically calculate polynomial perform meaningful secure computation reduce ciphertext improve performance effectively calculate sum integer simply encode integer ciphertext specially integer pack partition binary vector ldots polynomial equation overrightarrow sum tag equation sourcefor integer correspond binary vector overrightarrow encode overrightarrow pack encrypts integer pack enc overrightarrow overrightarrow polynomial overrightarrow substitute overrightarrow moreover integer pack oplus pack polynomial addition overrightarrow overrightarrow encrypt data correctness described overrightarrow overrightarrow obtain integer addition however polynomial multiplication overrightarrow cdot overrightarrow therefore perform homomorphic multiplication beta generate integer beta acceptable calculate multiplication sum variance definition pack pack secure sum variance computation integer however propose pack enables efficient secure computation inner anova max min vector extension pack pack advantage plaintext structure richer computation packed ciphertexts packed ciphertexts define pack definition packed ciphertexts towards integer vector overrightarrow ldots leq leq another integer vector overrightarrow ldots ldots ldots define polynomial mathbb geq parameter align overrightarrow sum limit overrightarrow sum limit overrightarrow sum limit sum limit overrightarrow sum limit sum limit tag align  polynomial sufficiently define align pack overrightarrow enc overrightarrow pack overrightarrow enc overrightarrow align SourceRight click MathML additional feature packed ciphertexts polynomial definition pack vector overrightarrow overrightarrow frac beta ciphertexts pack overrightarrow pack overrightarrow perform homomorphic multiplication beta therefore packaging significantly reduce encrypt data component wise encryption addition packed ciphertexts freely combine various efficient secure computation secure computation packed ciphertexts subsection effectively secure computation packed ciphertexts pack secure computation IV exhibition calculate packed ciphertexts perform mathbb secure sum computation efficient secure computation sum theorem secure sum overrightarrow ldots overrightarrow ldots integer vector assume pack overrightarrow otimes pack overrightarrow constant dec denote con con equiv sum mod satisfies lemma namely sufficiently decryption constant corresponds sum proof pack overrightarrow otimes pack overrightarrow corresponds overrightarrow cdot overrightarrow homomorphic operation ciphertexts correspond structure polynomial homomorphic multiplication overrightarrow cdot overrightarrow align sum cdot sum sum sum non constant align SourceRight click MathML additional feature previous equation constant polynomial overrightarrow cdot overrightarrow sum theorem theorem reveals homomorphic multiplication packed ciphertexts compute sum pack theorem pack definition secure inner computation efficient secure computation inner theorem secure inner assume integral vector overrightarrow ldots overrightarrow price ldots price packed ciphertexts pack overrightarrow pack overrightarrow theorem sufficiently constant decryption inner langle overrightarrow overrightarrow rangle proof discussion proof theorem polynomial homomorphic multiplication overrightarrow cdot overrightarrow align sum cdot sum price sum cdot price langle overrightarrow overrightarrow rangle non constant align sourcethe previous equation constant polynomial overrightarrow cdot overrightarrow inner langle overrightarrow overrightarrow rangle theorem theorem homomorphic multiplication packed ciphertexts calculate inner overrightarrow overrightarrow pack theorem pack definition secure anova computation efficient secure computation anova theorem secure anova assume integer vector overrightarrow ldots overrightarrow ldots leq leq overrightarrow ldots ldots ldots overrightarrow ldots integer vector couple packed ciphertexts pack overrightarrow pack overrightarrow pack overrightarrow pack overrightarrow pack overrightarrow pack overrightarrow theorem sufficiently constant decryption sum sum sum sum sum derive SS SS equation plaintexts compute frac SS SS proof discussion proof theorem overrightarrow cdot overrightarrow align sum sum cdot sum sum sum sum sum sum non constant align sourcethe polynomial overrightarrow cdot overrightarrow align sum sum cdot sum sum sum sum sum sum non constant align sourcethe previous equation constant polynomial overrightarrow cdot overrightarrow overrightarrow cdot overrightarrow sum sum sum sum respectively accord theorem constant polynomial overrightarrow cdot overrightarrow sum sum sum plaintexts derive SS SS compute equation plaintexts compute frac SS SS theorem theorem homomorphic multiplication packed ciphertexts compute anova pack theorem pack definition secure min computation IV min aggregation sum aggregation accord theorem calculate sum aggregation homomorphic multiplication packed ciphertexts pack pack sum min aggregation protocol efficient ham distance min aggregation protocol efficient secure ham distance computation theorem secure ham distance computation assume vector overrightarrow ldots overrightarrow FM FM ldots FM overrightarrow ldots couple packed ciphertexts pack overrightarrow FM pack overrightarrow pack overrightarrow pack overrightarrow pack overrightarrow FM pack overrightarrow theorem sufficiently constant decryption sum FM sum sum FM cdot derive overrightarrow FM overrightarrow equation plaintexts proof discussion proof theorem constant polynomial overrightarrow FM cdot overrightarrow overrightarrow cdot overrightarrow sum FM sum accord theorem constant polynomial overrightarrow FM cdot overrightarrow sum FM cdot derive overrightarrow FM overrightarrow compute equation plaintexts theorem theorem homomorphic multiplication packed ciphertexts compute ham distance pack theorem pack definition therefore ham distance min aggregation protocol efficient pack improve pack definition pack applicable vector entry entry vector parameter considerably pack performance encryption scheme enforce parameter considerably security correctness secure inner theorem equation langle overrightarrow overrightarrow rangle sum cdot price leq tag equation sourceas price integer parameter cdot cdot improve pack vector entry practical secure anova vector entry definition improve pack improve pack define definition improve packed ciphertexts overrightarrow ldots integer vector integer entry representation geq chosen integer equation sum tag equation SourceRight click MathML additional feature lceil rceil integer vector transform overrightarrow ldots ldots ldots definition mathbb polynomial define geq parameter align overrightarrow sum limit sum limit cdot overrightarrow sum limit sum limit cdot tag align  polynomial sufficiently define equation pack overrightarrow enc overrightarrow equation sourceas improve packed ciphertexts equation substitute sum integer definition polynomial correspond equation sum cdot sum cdot equation  definition polynomial definition trick efficiency secure inner computation improve pack similarly secure inner computation achieve improve pack overrightarrow ldots overrightarrow price ldots price integer vector entry price sum price sum price geq overrightarrow cdot overrightarrow align sum cdot cdot sum price cdot sum cdot price mathop sum cdot price langle overrightarrow overrightarrow rangle non constant align  substitute polynomial sum cdot price correspond align sum cdot price sum sum cdot sum price sum cdot price langle overrightarrow overrightarrow rangle align SourceRight click MathML additional feature equation representation therefore homomorphic multiplication overrightarrow overrightarrow compute inner langle overrightarrow overrightarrow rangle improve pack efficiency improve pack acquire desire secure inner computation equation sum sum cdot price leq cdot cdot leq tag equation SourceRight click MathML additional feature lceil rceil price strength improve pack regardless entry parameter parameter inner langle overrightarrow overrightarrow rangle obtain equation parameter considerably parameter geq specially geq cdot therefore improve pack suitable vector entry VI security analysis described propose PDA scheme PLWE assumption define PLWE assumption propose PDA scheme secure attack model theorem analyze security issue involve propose scheme definition PLWE assumption parameter kappa sigma PLWE assumption PLWE kappa chi  normal distribution infeasible distinguish uniformly sample leftarrow chi mathbb sigma uniformly leftarrow uniformly leftarrow mathbb relatively prime leftarrow chi calculate cdot cdot theorem defense cpa parameter kappa sigma propose PDA scheme semantic secure cpa PLWE assumption proof parameter kappa sigma tilde tilde uniformly tilde sample leftarrow chi mathbb sigma uniformly leftarrow uniformly leftarrow mathbb leftarrow chi calculate cdot cdot therefore kappa sigma PLWE tilde assume semantic security enc propose PDA scheme broken polynomial adversary mathscr non negligible advantage epsilon moreover another adversary mathscr structure PLWE non negligible advantage access mathscr parameter kappa sigma tilde mathscr leftarrow chi chooses leftarrow random leftarrow chi error private compute cdot cdot public tilde mathscr uniformly mathscr simulated indistinguishable secondly mathscr chooses plaintexts return mathscr subsequently mathscr chooses leftarrow chi sends ciphertext leftarrow enc mathscr finally upon mathscr sends mathscr mathscr tilde obviously tilde becomes valid ciphertext mathscr probability frac epsilon correctly mathscr tilde frac epsilon tilde independent due public uniformly therefore mathscr tilde frac combine situation obtain equation mathscr frac cdot frac frac cdot frac epsilon frac frac epsilon equation sourcethe conflict assumption PLWE epsilon non negligible consequence propose PDA scheme semantic secure cpa PLWE assumption define useful formally specific proof later article entity define message obtain entity internal randomness input parameter chi denote chi mathbb inf mathbb SI mathbb  mathbb pra mathbb SRR mathbb inf information access mathbb customer mathbb subseteq mathbb denote customer plaintexts correspond ciphertexts kpa model theorem theorem defense kpa parameter chi mathbb subseteq mathbb polynomial simulator sim output indistinguishable output align sim chi mathbb SI mathbb  mathbb pra mathbb SRR approx chi mathbb SI mathbb  mathbb pra mathbb SRR align SourceRight click MathML additional feature proof kpa model sim access plaintexts customer electricity usage data correspond ciphertexts public sim recover encryption algorithm customer plaintexts mathbb mathbb private random factor theorem propose PDA scheme semantically secure PLWE assumption moreover chosen discrete gaussian error distribution chi recover random factor equivalent PLWE without random factor sim unable expose customer plaintexts customer privacy data propose PDA scheme therefore kpa model sim infeasible extract additional information simulated sim indistinguishable output theorem defense COA parameter chi mathbb simulator sim output indistinguishable output align sim chi mathbb SI mathbb  mathbb pra mathbb SRR approx chi mathbb SI mathbb  mathbb pra mathbb SRR align SourceRight click MathML additional feature proof cpa kpa model sim access ciphertexts public COA model sim recover encryption algorithm customer plaintexts mathbb private random factor theorem propose PDA scheme defense cpa kpa therefore defense COA satisfied proof theorem detailed proof omit analyze security issue involve propose scheme preserve customer private electricity usage data leak mathscr mathscr cannot disclose electricity usage data customer eavesdrop communication mathscr eavesdrop communication customer fog node particularly mathscr wiretap ciphertext gamma customer gamma correspond public cannot obtain private electricity usage data gamma propose PDA scheme secure cpa COA accord theorem theorem respectively therefore mathscr eavesdrop communication customer fog node cannot disclose electricity usage data customer mathscr cannot deduce electricity usage data uncompromised customer compromise customer illegal threat model mathscr compromise customer directly breach privacy however customer fog smart grid unlikely mathscr addition acquire privacy private electricity usage data compromise customer mathscr deduce privacy uncompromised customer nevertheless attempt succeed propose PDA scheme secure kpa accord theorem customer private electricity usage data generate independently customer privacy reveal others specially customer mathscr obtain customer privacy customer privacy cannot breach sum customer private electricity usage data transparent mathscr therefore mathscr compromise customer directly electricity usage data uncompromised customer deduce mathscr cannot expose customer electricity usage data intrude database CC fog node steal data fog node ciphertexts customer privacy preserve report aggregation phase aggregate directly instead decrypts report aggregate ciphertext CC calculation mathscr intrude database fog node steal data obtain customer ciphertexts aggregate ciphertext customer private electricity usage data reveal propose PDA scheme secure cpa COA accord theorem theorem respectively similarly mathscr intrude database CC aggregation customer electricity usage data expose individual customer electricity usage data mathscr intrude database CC fog node steal data cannot expose customer electricity usage data vii performance evaluation analyze performance propose scheme computation communication storage overhead sum inner anova aggregation protocol ppm HDA ppma computation overhead min aggregation protocol ppm HDA   communication storage overhead computation overhead comparison computation overhead propose scheme intuitively ppm HDA ppma individual customer therefore subsection focus computation overhead sum inner anova aggregation protocol ppm HDA ppma fog node computation overhead min aggregation protocol fog node bilinear operation mul homomorphic multiplication operation homomorphic addition operation computation overhead sum aggregation protocol PDA SP privacy preserve report aggregation phase fog node calculate encrypt sum aggregation PDA PM pack fog node mul accord theorem ppm HDA ppma fog node mul computation overhead inner aggregation protocol PDA SP privacy preserve report aggregation phase fog node calculate encrypt inner aggregation mul PDA PM fog node mul accord theorem ppm HDA ppma fog node mul computation overhead anova aggregation protocol PDA SP privacy preserve report aggregation phase fog node calculate equation mul compute equation mul calculate equation  mul therefore fog node mul PDA PM fog node mul accord theorem ppm HDA ppma fog node mul computation overhead min aggregation protocol IV propose min aggregation protocol sum min aggregation protocol sum extend sum min aggregation protocol sum ham distance min aggregation protocol HDB extend ham distance min aggregation protocol HDB sum fog node sum aggregation protocol PDA SP mul PDA PM sum fog node sum aggregation protocol lceil rceil lceil rceil PDA SP lceil rceil mul PDA PM HDB HDB algorithm mul PDA SP mul PDA PM accord theorem accord algorithm fog node calculate algorithm eta average loop HDB frac eta average loop HDB loop algorithm furthermore average eta frac accord algorithm therefore HDB fog node eta eta mul mul average PDA SP mul average PDA PM HDB fog node frac frac mul average PDA SP frac mul average PDA PM computation overhead PDA SP PDA PM ppm HDA ppma depict computation overhead min aggregation protocol II furthermore  encryption library environment eclipse macOS sierra OS ghz intel core processor 8G ram mhz ddr evaluate operation implement framework java experimental mul comparison computation overhead PDA SP PDA PM ppm HDA ppma comparison computation overhead PDA SP PDA PM ppm HDA ppma II computation overhead min aggregation II computation overhead min aggregation obtain computation overhead mul assume PDA SP computation overhead PDA SP PDA PM computation overhead PDA PM RR frac PDA SP PDA PM PDA SP reduction rate computation overhead sum inner anova aggregation protocol PDA SP PDA PM ppm HDA ppma addition reduction rate RR sum RR inner RR anova reveal computation overhead sum inner anova aggregation protocol PDA SP significantly reduce pack variation computation overhead ppm HDA ppma PDA SP PDA PM variation computation overhead ppm HDA ppma PDA SP PDA PM demonstrates computation overhead sum min aggregation protocol ham distance min aggregation protocol sum min aggregation protocol efficient variation computation overhead min aggregation protocol variation computation overhead min aggregation protocol implies reduction rate inner aggregation protocol others moreover reduction rate sum inner anova sum sum increase increase increase HDB HDB invariable therefore pack efficient computation sum inner anova min aggregation protocol inner anova aggregation protocol variation reduction rate sum inner anova min aggregation protocol communication storage overhead comparison communication storage overhead sum inner anova aggregation protocol ppm HDA   therefore subsection focus communication storage overhead min aggregation protocol ppm HDA   assume customer report gamma enc gamma tau KB gamma comparison communication storage overhead communication storage overhead communication storage overhead communication storage overhead sum customer report generation phase report encrypt ciphertexts fog node plaintext therefore PDA SP PDA PM communication overhead tau tau respectively storage overhead sum report lceil rceil encrypt ciphertexts fog node plaintext frac lceil rceil lceil rceil therefore PDA SP PDA PM communication overhead lceil rceil tau lceil rceil tau respectively storage overhead lceil rceil HDB HDB PDA SP ppm HDA  report encrypt ciphertexts fog node plaintext HDB HDB PDA PM report packed ciphertext fog node therefore HDB HDB PDA SP ppm HDA  communication overhead tau storage overhead HDB HDB PDA PM communication overhead tau lastly  report encrypt ciphertexts fog node plaintext therefore communication overhead tau storage overhead tau KB depict communication overhead PDA SP ppm HDA  depict communication overhead PDA PM  obvious communication overhead sum PDA SP sum PDA SP ppm HDA  sum PDA SP implies communication overhead sum PDA PM sum HDB HDB PDA PM  comparison PDA SP ppm HDA  comparison PDA SP ppm HDA  comparison PDA PM  comparison PDA PM  assume depict storage overhead sum sum HDB HDB ppm HDA   conclude storage overhead sum sum HDB HDB ppm HDA   sum sum reduce computation communication overhead increase storage overhead trading storage overhead computation communication overhead comparison storage overhead comparison storage overhead conclusion article propose smart practical PDA scheme smart pricing pack fog smart grid achieve multifunctional statistic diversified tariff efficiency scheme PDA SP PDA SP CC  pricing strategy strategy compute complex statistic function various service scheme PDA PM reduce encrypt data improve performance perform various secure computation moreover improve version handle vector entry security analysis propose scheme secure threat performance evaluation reveal propose scheme lightweight efficient future employ multiple ham distance batch comparison reduce computation overhead min aggregation protocol addition explore pack perform secure computation