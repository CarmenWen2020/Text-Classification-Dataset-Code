Abstract
In a marketplace where a number of firms produce and sell a homogeneous product, an innovator develops cost-cutting manufacturing technology and decides to sell it to various firms in the form of a license for profit. Given the innovator's license pricing policy, each firm independently decides whether to purchase the innovation license and how many products to produce. To put it simply, the firms are then in a Cournot market in which the product price is a decreasing function of the total amount of the product on the market. Both the innovator and the firms are acting out of self-interest and look to maximize their utilities. We consider the problem of designing optimal pricing policies for the innovator.

A pricing policy could be in the form of a one-off upfront fee, a per-unit royalty fee, or a hybrid of both. Building upon the results of Segal [1], we first show that in a properly designed pricing policy, it is a strictly dominant strategy for the firms to accept the pricing policy, and that this constitutes the unique Nash equilibrium of the game. For the hybrid-fee policy, we devise an algorithm that computes the optimal price in time O(n3), where n is the number of firms. For the royalty-fee policy, we show that the problem is captured by convex quadratic programming and can be solved in time O(n6L2), where L is the number of input bits. For the upfront-fee policy, we show the optimal policy problem is NP-complete and we devise an FPTAS algorithm. Moreover, we compare the revenue achievable through the above three pricing policies when all firms are identical.


Keywords
Cournot markets
Optimal pricing policy
Patent licensing
Nash equilibrium
Dominant strategy

1. Introduction
A patent license agreement grants a licensee exclusive rights to manufacture, sell, and use a patented invention. It is an effective way to disseminate innovations and create a huge market. A group of six companies, including Apple and Microsoft, outbid Google and paid $4.5 billion for 6000 Nortel wireless patents, about $750,000 per patent [2]. AOL licensed its 800 patents to Microsoft for $1.1 billion in 2012 [3]. Kodak sold about 1100 digital imaging patents for $525 million [4]. The five largest intellectual property offices in the world granted 1.25 million patents and received 2.7 million patent applications in 2019 [5]. The high patent licensing fee and the huge amount of patents issued indicate the critical role of patents in business.

In this paper, we follow the model introduced by Arrow [6] and consider the problem of designing optimal pricing policies for the innovator owner. The innovator is someone who develops cost-cutting manufacturing technology and decides to sell it to the firms in a license for profit. They can be regarded as an outsider, for example an independent institution. In the first stage, the innovator as license owner announces a patent license agreement to the firms that produce a homogeneous product. In the second stage, each firm may sign a patent license agreement with the innovator, manufacture the item at a reduced cost, or ignore it and produce the item at its standard cost. In the third stage, the firms decide how many products to produce. Thus, they compete with each other in a Cournot market game [7], [8], in which the market price of the product is a decreasing function of the total quantity of the product available on the market. We consider a complete information setting in which the innovator knows firms' pre-innovation costs, as it can be inferred through the equilibrium in a standard Cournot game. Also, the innovator knows by how much its innovative technology can save unit-production costs. The firms are self-interested and, therefore, will choose the strategy that maximizes their utilities.

Typically, there are two types of payment that an innovator offers in a cost-cutting patent contract. Bousquet et al. [9] concluded that 78% of the contracts adopt per-unit royalty fee, using a French firm's data. Based on a survey that includes 62 research universities, Thursby et al. [10] showed that the one-off upfront fee is used in 66% contracts while 81% respondents used royalty fees. For a comprehensive study, we consider all of these three typical pricing policies as per-unit royalty fee, one-off upfront fee, or a hybrid of both.

When innovation technology is sold as a commodity to firms through patent licensing, the critical feature is that there exist identity-dependent externalities. When firms compete with each other in a Cournot game, these firms with an innovation license can reduce their manufacturing costs. They stand in a better position in the market and can influence the balance between supply and demand. Therefore, other firms suffer from negative externalities and need to take this into account when deciding whether to buy a license. Note, though, when multiple firms purchase the innovation licensing, the resultant externalities are not necessarily additive.

The contribution of the paper is the following:

•
We design a pricing policy framework for patent licensing. First, the firms choose whether to accept the pricing policy. Then they are in a Cournot competition, and their utilities are determined by the unique Nash equilibrium of the game. We show that in a properly designed pricing policy, each firm's dominant strategy is to purchase the license.

•
We formulate an optimization problem whose objective is to maximize the sum of revenues generated by the upfront and royalty fees, respectively. We locate the optimal hybrid-fee policy and propose an efficient algorithm that solves it in run-time 
 where n is the number of firms. For the royalty-fee policy, we show an algorithm that can compute it optimally in running time 
, where L is the length of the input. For the upfront-fee policy, we prove that the problem is NP-hard, and we devise an FPTAS algorithm with run-time 
 which achieves  approximation.

•
We observe an interesting phenomenon whereby an innovator without any cost-reducing innovation may gain revenue by selling subsidy policy. In particular, by setting negative royalties (giving a positive money transfer to the firms) and a positive upfront fee, the upfront fee will outweigh the royalties.

•
We compare the revenue achieved in different pricing policies. In the symmetric case where all firms are identical, the ratio between the revenue of the optimal hybrid-fee policy and the revenue of the optimal royalty-fee policy is at most 3, the ratio between the revenue of the optimal hybrid-fee policy and the revenue of the optimal upfront-fee policy is at most 1.62 (Table 1).


Table 1. Ratios between optimal hybrid-fee policy and different pricing policies in the symmetric case.

Pricing Policy	Royalty-Fee	Upfront-Fee
Ratio	3	1.62
1.1. Related work
Our work contributes to the growing body of literature on the patent licensing [11], [12], [13], [14], [15], [16]. Arrow [6] first realized that the value of cost-reducing innovation could be converted to profit by patent licensing, which motivates the monopoly to innovate. Kamien et al. [17], and Kamien and Tauman [18], [19] showed that the upfront-fee policy dominates the royalty-fee policy in terms of innovator's revenue. Kamien et al. [19], and Sen [16] compared the auction method with the upfront-fee policy and royalty-fee policy. Sen and Tauman [20] considered the hybrid-fee and its influence on the price in Cournot games. Sen and Tauman [21] considered the optimal licensing policy in cases of both drastic innovation and non-drastic innovation. Beggs [22] and Gallini and Wright [23] considered the asymmetric information model where the innovator has privileged information about the innovation. Bousquet et al. [9] studied the ad valorem royalty, which results in a firm paying a fraction of its revenue to the innovator. Bimpikis et al. [24] considered the best way to sell accurate information about the parameters to firms in Cournot games. To the best of our knowledge, these works have only examined the patent licensing problem when firms have the same cost per product unit. Due to firms' symmetry, the critical step of solving the pricing policy problem is essentially reduced to deciding the number of licenses to be sold. In this paper, we consider a more general setting in which firms have different manufacturing costs, which is more consistent with actual practice. The main difficulty is that firms that do not purchase innovation licenses may drop out of the markets due to high post-innovation costs. As a result, there is no closed formula for computing the innovator's revenue in terms of the pricing policy.

The externality effects have been studied in a Cournot competition [11], [18]. Hart et al. [25], and Rey and Tirole [26] considered the problem that arises when a company sells intermediate goods to firms who then process them to produce homogeneous consumer goods in the Bertrand-Edgeworth game. Segal [1] showed how to implement an efficient outcome in the presence of multilateral externalities, which can be adopted in designing the pricing policy. Externalities in auctions have been extensively studied [27], [28], [29]. Jehiel, Moldovanu, and Stacchetti [30], [31] considered selling an indivisible item. Leme et al. [32] considered the setting where bidders have combinatorial valuations, and innovators hold item auctions sequentially. Haghpanah et al. [33], and Rohlfs [34] considered positive externalities in a social network where a person's valuation of an item may increase if his friends buy it as well. Brânzei et al. [35] studied the problem of a fair division of divisible heterogeneous resources in the presence of externalities.

2. Preliminaries
There is an innovator whose pioneering technology can help the manufacturing firms to reduce their unit-cost of producing a homogeneous product. There are n such firms interested in purchasing the innovation license to become more competitive on the market. In the model, the innovator publicizes the pricing policy for all firms. Each firm can either keep producing its products at a higher cost without the innovation technology or purchase the license as per the pricing policy and produce its products at a lower cost. In either case, each firm finally decides how many quantities of their products they are producing. Both the innovator and the firms are utility-maximizers. Upon knowing the pricing policy, the firms first decide whether or not to purchase the license and then decide their production quantity. Hence, the second stage of the model is a Cournot competition. We are interested in devising a pricing policy to maximize the innovator's revenue.

Denote  the set of all firms. Let 
 
 denote Firm i's cost for producing each unit of product, where 
 is Firm i's cost without the cost-cutting technology, and  
 
 is Firm i's cost with the cost-cutting technology. W.l.o.g., we assume 
 is sorted in an non-decreasing order, i.e., 
. Let 
 be the quantity of the products produced by Firm i. Let 
 and 
 denote the per-unit royalty fee and the one-off upfront fee, respectively. In an upfront-fee plus royalty-fee (hybrid-fee) pricing policy, Firm i pays the innovator an upfront fee 
, and its per unit production cost 
 
. In an upfront-fee pricing policy, Firm i pays the innovator an upfront fee 
, and its per unit production cost 
 
, regardless of the production quantity. In a royalty-fee pricing policy, Firm i's per unit production cost 
 
. If Firm i does not purchase the cost-cutting technology license, its per unit production cost 
 (Table I.5, Table I.6).

We consider the classical version of the Cournot competition [7], [8], in which all firms produce a homogeneous product and the price p of each unit of product is linearly decreasing in the total quantity. That is,(1)
 
 where 
 is the quantity profile of all firms, and θ is a pay-off relevant parameter. We consider the complete information setting where all parameters ( 
 
, 
 for all i, and θ) are publicly known.

Therefore, the utility 
 of Firm i is
 

After deciding whether or not to purchase the innovation license, each firm's strategy is the quantity of the product they are going to produce. In this Cournot game, their strategies constitute an equilibrium in which no firm would change its production quantity if other firms are not changing. The following theorem asserts the uniqueness of Nash equilibrium in Cournot games.

Theorem 1

Szidarovszky and Yakowitz [36]
For any given pricing policy and the firms' decision on purchasing the innovation license or not, the corresponding Cournot game has a unique equilibrium.

We use the following example to illustrate that, by adequately offering a hybrid-fee policy, the innovator can incentivize the firms to accept its pricing policy and consequently increase its revenue in equilibrium. Similar examples can be constructed for the upfront-fee policy and the royalty-fee policy as well.

Example 1

There are two firms in the market. The unit cost for each firm, without the cost-cutting technology, is 
 and 
, respectively. The costs reduce to  
 
 and  
 
 if they purchase the license. The market price of the product is 
, where 
 is the quantity produced by Firm i, .

When neither of the two firms purchases the licenses, the unique pure Nash equilibrium of the Cournot game is 
 and 
. The market price is , and the utility of the two firms under equilibrium is 1225 and 400, respectively. The revenue of the innovator is 0 in this scenario.

Now that if Firm 2 accepts a hybrid-fee pricing policy that charges an upfront fee 
 and per-unit royalty fee 
, then in the unique Nash equilibrium of the Cournot game, the production quantity of the firms becomes that 
 and 
. Hence, the market price is 60, and the two firms' utilities are 900 and 800, respectively. Since Firm 2's utility is larger than its utility before accepting the hybrid-fee policy, it will purchase the license. The revenue of the innovator is 
 in this scenario.

2.1. Nash equilibrium in Cournot games
Theorem 1 implies that given each firm's cost 
, both their production quantities and the product's final price are uniquely determined in the Cournot competition. Therefore, effectively, a firm's strategy is to decide whether to accept the pricing policy for the cost-cutting manufacturing technology.

Let 
⁎
 and 
⁎
 be the price and Firm i's production quantity at the equilibrium of the Cournot game. Denote 
⁎
⁎
. That is, 
⁎
 is the set of firms whose manufacturing cost is lower than the market price at equilibrium. Hence, production is beneficial to them. Denote 
⁎
 Firm i's utility at the equilibrium of the Cournot game. We use 
⁎
⁎
⁎
⁎
 when there is no ambiguity for abbreviation. In the Cournot equilibrium, firms 
⁎
 will exit the market, and firms 
⁎
 will converge to an equilibrium with production quantity 
⁎
. The first order condition 
⁎
 implies 
⁎
 
⁎
⁎
 Combining the equations for all firms 
⁎
, and solving a linear equation system, we get that
⁎
⁎
⁎
 
⁎
⁎
⁎
 
⁎
⁎
 This way, we can compute the production quantity and the product price at equilibrium, given the set 
⁎
. The following lemma shows that active firms are precisely those who have the lowest per-unit manufacturing costs. Therefore, we can reduce the search space of 
⁎
. Essentially, we can enumerate the size of 
⁎
 and find the equilibrium in linear time.

Lemma 1

p is the equilibrium price if and only if
 
 where 
 is a binary variable indicating whether 
 or not.

Proof

For the if direction, since p is the product price in the Cournot game equilibrium, we have that 
⁎
⁎
 
. The statement is clearly true since 
⁎
. For the only if direction, we define
  It is easy to check that Firm i producing 
 units of the product will constitute a Nash equilibrium. □

2.2. The optimal policy framework
Denote 
 Firm i's lowest utility that it may obtain in the Cournot game.

Before we present the pricing policy framework, we characterize the lower bound of 
. The following lemma states that Firm i has the lowest utility when it does not have the cost-cutting technology while all other firms get the innovation without a royalty fee.

Lemma 2

In a Cournot game, Firm i obtains the lowest utility 
 when Firm i produces the product at the highest possible unit cost 
 while all other firms produce the product at their lowest possible unit costs  
 
. That is, 
⁎
 
.

Proof

Define 
⁎
 the active firms in the equilibrium when Firm i achieves the lowest utility. Define 
⁎
 
 the active firms in the equilibrium when all firms except i have licenses free of charge. We define prices in these two equilibriums as 
 and 
 respectively. We consider two cases depending on whether Firm i remains active in the first equilibrium.

•
Firm i does not remain active in the worst case, i.e., 
. We claim that Firm i also drops out of the market when all firms except i are licensed for free, i.e., 
. Suppose not, we have 
. By Lemma 1, we have 
 and 
 and it implies 
.

By Lemma 1, for any firm 
, we have  
 
 which implies Firm j remains active in the second equilibrium, i.e., 
. As a result, 
 is a subset of 
. Recall the price formula, for 
﹨
, we have 
 
 
﹨
 
 
 Based on these inequalities together we can get
 
 
 
﹨
 
 
 Note that we have higher unit cost in the first equilibrium for firms in 
. We have
 
 
﹨
 
 
 which is 
, it is a contradiction.

•
Firm i remains active in the worst case, i.e., 
. It implies 
. Firm i's utility in two equilibriums are 
 and 
 respectively. It suffices to prove that(2)

For any firm 
﹨
, Firm j with innovation still drops out of the market in the second equilibrium. By Lemma 1, we have 
 
. Plug these inequalities into the formula of 
, we have
﹨
 
﹨
 
 Combined with equation (2), it suffices to prove(3)
﹨
 
﹨
 

For firm 
﹨
, by Lemma 1, we have
﹨
 
 
 These inequalities together imply that
 
 

Plug it into equation (3), it is suffice to prove that
﹨
 
﹨
 
 This is correct since 
.

These two cases together prove the theorem. □
Next, we present the innovation licensing policy 
. It transforms the policy design problem into an optimization problem. By solving the optimization problem, the corresponding optimal policy can be implemented in dominant strategies.

Definition 1

The policy 
 proceeds as follows. The innovator first publicizes a hybrid-fee policy, which charges the firms an one-off upfront fee and a per-unit royalty fee. Each firm independently decides whether or not to accept the policy. Denote A the set of firms that accept the policy with which they can utilize the cost-cutting technology. Firm  would not be charged by the innovator.

•
If , firms 
⁎
 buy the license and the cost becomes 
. Firm 
⁎
 pays an upfront fee 
⁎
 and a royalty fee 
⁎
. Note that if firm 
⁎
, we have 
⁎
 which means Firm i gets ϵ subsidy from the innovator.

•
If , the innovator will exempt the royalty fee and only charge firms in A an upfront-fee. In this case, each firm  produces the product at the lowest unit cost of  
 
 and decides how many quantities to produce. The innovator charges firm  the upfront fee 
⁎
 
⁎
 
﹨
﹨
.

We note that our framework is an adaption of the model introduced by Segal [1]. Particularly, we regard the royalty payment 
⁎
 
 in our model as the principal net profit function  in [1] and 
 as variable 
. Firm i's lowest utility 
 is regarded as the term 
. Therefore, we have the following theorem.

Theorem 2

Proposition 10, Segal [1]
For each firm, accepting the policy is a strictly dominant strategy in procedure Γ. The strategy profile that all firms accept is the unique Nash equilibrium of Γ. The innovator's revenue at the equilibrium is(4) 
 
⁎
 
⁎
 
 If 
 maximizes the above function, then procedure 
 achieves the optimal revenue.

Thus, we transform the pricing policy design problem into an optimization problem in formula (4). Since the second term, 
, is fixed, we only need to maximize the first term. Note that for Firm i who drops out (i.e., the cost is equal or higher than the price), 
⁎
⁎
. So the objective of the optimization problem is(5) 
  
⁎
 
⁎
 
⁎

3. Optimal hybrid-fee policy
In this section, we first solve our optimization problem whose objective is presented as equation (5). Then, we generalize the setting to the case that the innovator is an incumbent firm (who also produces products and competes with other firms in the Cournot game). Sen and Tauman [21] and Sen and Stamatopoulos [37] show that the result is usually different for these two cases. However, we show that these two cases are equivalent when the innovator uses the hybrid-fee policy.

3.1. Optimal solution
To solve the optimization problem, we need to determine the set 
⁎
 of firms whose manufacturing cost is lower than the market price at equilibrium. For this purpose, we depict a structure-property of set 
⁎
. We consider the possible values of price. By definition 
⁎
. Suppose the price p lies in the interval 
, . Here we define 
 and 
 for simplicity. Define , firms in B have cost lower than price, by Lemma 1, 
⁎
. The next lemma shows firms in 
⁎
﹨ have lower post-innovation cost than firms in ﹨
⁎
.

Lemma 3

In the optimal solution, for two firms 
, if 
⁎
 and 
⁎
, we have  
 
 
.

Proof

Since 
, if 
 does not get the innovation, it can not remain active in the competition. Hence,  
 
. We prove by contradiction. If  
 
 
, we can improve the revenue by licensing the patent to 
 rather than 
. In detail, instead of licensing the innovation to 
, we can license the innovation to 
 and let its unit cost be 
. To be specific, we define 
 for 
, 
 and 
. In such a way, 
⁎
⁎
﹨
 and price does not change, 
⁎
⁎
. We can keep the same revenue from the upfront fees but gain more from the royalty fees since  
 
 
. This is a contradiction. □

Based on Lemma 3, firms in 
⁎
﹨ can be determined uniquely given the size 
⁎
﹨. Thus, to find the potential optimal 
⁎
, we only need to search k and 
⁎
. The following lemma states that all firms in 
⁎
 except one either have their unit costs unchanged or obtain the innovation without royalty fee. It implies an efficient algorithm to compute the optimal 
 for 
⁎
.

Lemma 4

There is an optimal solution where there is at most one firm has 
 
. For the other firms, we have 
 
 if  
 
 
 and 
 if  
 
 
.

Proof

We first define the innovation owner's operation 
 as decreasing the cost of Firm 
 by η and increasing the cost of Firm 
 by η. We call operation 
 feasible if 
 
⁎
 
⁎
.

For 
⁎
, we claim that if  
 
 
 and operation 
 is feasible, then the revenue will increase by operation 
. If  
 
 
, then the revenue will not change. Actually, after the operation, we have 
 for 
, 
. There are two cases depending on the value of η.

•
If 
⁎
 
⁎
. The same set of firms will remain active in the Cournot game. In addition the price will not change.

•
If 
⁎
 
⁎
. Firm 
 drops out of the market. Then firms in 
⁎
﹨
 remain active in the competition. The price is actually the same:
⁎
⁎
﹨
⁎
 
⁎
⁎
⁎
⁎
 
⁎

In both cases, other active firms still remain active in the equilibrium and the price would not change. This operation will only affect the product quantity of Firm 
 and Firm 
. We have 
⁎
⁎
 and 
⁎
⁎
. The total change of seller's revenue is
 
⁎
 
⁎
 
 
If  
 
 
, the seller's revenue increases by this operation. If  
 
 
, the seller's revenue stays the same.

In the optimal solution, if there are two firms 
 and 
 that have 
 
 and 
 
, respectively. W.l.o.g., we can assume that  
 
 
. We conduct action 
 on 
 where
 
⁎
 
⁎
 
 The revenue will weakly increase after the operation. At the same time, the number of firms such that 
 
 decreases by one.

Also, for an optimal solution, assume Firm i is the one who has 
 
 and there is a firm j who gets the full innovation and has  
 
 
. Then we can increase the revenue by the operation , which is a contradiction. Thus, the lemma is proved. □

Based on Lemma 4, there must exist a critical firm l such that if  
 
 
 we have 
 
, if  
 
 
 we have 
 and 
 
. Note that if there exists Firm i that  
 
 
 and 
, then we can always construct an optimal solution where 
 
 or 
 and 
 
. To find optimal parameters 
, we only need to enumerate 
⁎
 and then compute the optimal 
 in each instance. The objective function 
⁎
⁎
 
⁎
 is a quadratic function of 
, it is easy to find the optimal 
. The procedure to solve the optimal licensing strategy through the hybrid-fee policy is summarized in Algorithm 1.

ALGORITHM 1
Download : Download high-res image (157KB)
Download : Download full-size image
ALGORITHM 1. Algorithm for optimal hybrid-fee policy.

Theorem 3

The optimization problem in (5) can be solved in 
 time.

3.2. When the innovator produces products (incumbent firm)
In this subsection, we consider the problem where the innovator is one of the competing firms. The innovator wants to maximize the sum of revenue generated from selling innovation license and the revenue in selling the product in the Cournot game. Suppose the seller is Firm d and has a unit cost  
 
. Since the seller's utility constitutes the revenue generated from two parts, they may obtain a higher utility even though the revenue generated from the Cournot game is suboptimal.

Suppose the seller pretends her unit cost is 
 in the Cournot game where 
 could be any number larger than or equal to  
 
. Using the same argument, the payment collected from other firms is 
⁎
﹨
⁎
 
⁎
﹨
. Seller's utility in Cournot game is 
⁎
⁎
 
⁎
⁎
 
. So the sum of seller's revenue and utility in Cournot game is 
⁎
﹨
 
⁎
 
⁎
﹨
 
⁎
⁎
 
⁎
 
⁎
 
⁎
﹨
 
 There is only a constant difference 
 compared to equation (5). Hence we have the following theorem.

Theorem 4

Designing optimal hybrid-fee policy is the same in the case that the seller is an outsider and the seller is an incumbent firm.

3.3. Innovator without cost-reducing innovation
In this subsection, we show that the innovator increases its revenue by offering subsidies to the firms while charging them an upfront fee instead of chagrining them a per-unit royalty fee. For example, an economic coalition (correspondingly, the innovator) provides a tax relief (negative royalty fee) to the firms who join in the coalition but charges them an entry fee (upfront payment). Consequently, we observe that an innovator without real innovation can still make a profit by offering a negative royalty fee. We illustrate this phenomenon using the same setting as in Example 1.

Example 2

We consider a setting similar to Example 1. The difference is that the “innovator” has no real innovation and so  
 
 and  
 
. For simplicity, suppose the “innovator” commits to the following pricing policy: Firm 1 can get a subsidy of 15 for each unit of a product if Firm 1 pays 600 upfront fee, Firm 2 can get a subsidy of 30 for each unit of a product if Firm 2 pays 1000 upfront fee. It is easy to check that both firms will pay to get subsidies under this policy. The upfront fees for the two firms are 600 and 1000 respectively. After two firms get subsidies, each firm will produce 35 products. Thus the “innovator” will subsidize ⁎⁎ in total. Since the total upfront fee is larger than the total subsidy amount, the “innovator” gains a revenue of 25.

The following theorem asserts that a company that can convince the firms to agree on its pricing policies can always make a profit, even without innovation. We prove it by construction.

Theorem 5

When there are multiple firms producing a homogeneous product in the market, a company without innovation can make a positive profit. However, when there is only one firm in the market, a company without innovation cannot make a positive profit.

4. Optimal royalty-fee policy
In this section, we consider the degenerated case where only royalty payment is allowed. When we only allow royalty fee, we choose a royalty profile 
. For firms that do not buy licenses, we can set 
 
 and these firms will buy licenses. In such a way, the equilibrium in Cournot game does not change but the innovator's revenue weakly increases. Thus, w.l.o.g., we can assume all firms buy licenses and the unit cost 
 is restricted to  
 
. According to equation (5), the total royalty payment is 
⁎
 
⁎
 
⁎
 
 

We adopt the same method in solving the optimal hybrid-fee policy. We first consider the possible price. We assume the price lies in 
 for . Therefore, the firms in  must be active since their unit costs are definitely lower than price. In addition, Lemma 3 still holds here. Thus, the set of active firms 
⁎
 can be uniquely determined by k and 
⁎
. We will enumerate all possible combinations of k and 
⁎
. For each case, we compute the optimal parameters 
 and the problem is indeed a quadratic programming. Based on the fact that the objective function is convex and the constraints are linear, we get the following result.

Theorem 6

The optimal royalty-fee policy problem can be solved in 
 time where L is the number of input bits.

Proof

The optimal policy problem can be transformed into the following quadratic optimization problem. 
⁎
 
⁎
 
⁎
 
 
⁎
 
⁎
 
⁎
⁎
 
⁎
 
⁎
⁎
 
⁎
 
⁎
 
⁎
 
 
⁎
 The first two constraints describe the relations between the product price and the cost per unit product of the firms. Two next two constraints refers to the price assumption. Let c and  
  denote the vectors with ith elements 
 and  
 
, respectively. We can rewrite the objective function of as
⁎
 
⁎
 
 
⁎
 
  where  is the identity matrix,  is a 
⁎
⁎
 matrix of ones, and e is a vector of ones in size 
⁎
. The Hessian matrix of objective function is 
⁎
 
, whose eigenvalues are 
⁎
 
 and 2. It implies 
⁎
 
 is a positive semi-definite matrix. Thus, the objective function is convex. Since all the constraints are linear it is a convex quadratic programming. Ye and Tse [38] provide an efficient algorithm for solving convex quadratic programming with running time 
, where L is the number of input bits.

Back to our problem, there will be 
 possibilities when we enumerate k and 
⁎
. So the total running time will be 
. □

After showing the optimal royalty-fee policy, we then compare the revenue achieved by the optimal royalty-fee policy with the revenue achieved by the optimal hybrid-fee policy in the symmetric case. Symmetric case refers to the market where all firms are identical. For illustration, we provide a formal definition below.

Definition 2

Firms in a set  are identical if we have 
 
 
 for .

Theorem 7

In the symmetric case, the ratio between revenue of the optimal hybrid-fee policy and revenue of the optimal royalty-fee policy is 3.

To prove the theorem, we give the closed form of the optimal royalty-fee policy and compare it to the optimal hybrid-fee policy directly.

5. Optimal upfront-fee policy
In this section, we characterize the optimal upfront-fee policy. Since there is no royalty payment, the revenue formula (5) becomes 
⁎
⁎
. We first show that finding the best upfront-fee policy is NP-Hard. The proof is done by a reduction from a variant of Subset Sum Problem (SSP). Then we devise an FPTAS algorithm to solve the problem.

5.1. NP-hardness
In this part, we focus on proving that finding the best upfront-fee policy is NP-Hard. The proof is done by a reduction from a variant of SSP to our problem. To facilitate the presentation, we describe the variant first and then show the reduction step by step.

Recall that an original subset sum instance usually consist of a target sum T and a multiset 
 of n elements where the elements may be duplicated. To solve the problem, we need to decide whether there exists a set of coefficients 
 such that 
. If the coefficients exist, we return “Yes”; otherwise, we return “No”. Here, we consider a variant of SSP (
) which requires the coefficient 
 to be either −1 or 1, rather than 0 or 1. By a straightforward reduction from SSP, we can show that 
 is NPC readily.

Definition 3

: Given a multiset 
 and a target sum T, decide whether there exists a set of coefficients 
's such that 
, where 
's are either −1 or 1.

Lemma 5

 is an NPC problem.

Proof

Given an instance 
 of SSP containing a multiset S and a target sum T. Let  denote the sum of all elements in S, i.e., 
. We can construct an instance 
 of 
 with 
 
 
 
 and 
 
. Then we show that if the result of 
 is “Yes”, the result of 
 is “Yes”, and vice versa.

Assume we can find a set of 
's such that 
. Then we have
 
 
 
 

With 
 belonging to , 
 
 can be either 
 
 or 
 
. Thus, there exists a satisfactory coefficient set for 
.

We then prove the correctness of the opposite direction. If we can decide 
 for 
 
 such that 
 
. We have
 
 
 
 
 
 

Since 
 
 
, 
 can be satisfied as well. As a result, we prove the lemma. □

Given that the sign of elements in 
 and target sum will not affect the satisfactory result of the instance of 
. We assume all elements in 
 and 
 are non-negative without specific mention. In addition, we assume that 
. This assumption does not affect the hardness of the problem. Since for any instance of 
, we can always modify it by adding two elements of value 
 to the multiset 
 and changing 
 to 
 to satisfy the constraint. We can check the two problems are equivalent.

After introducing the variant 
, we are now ready to prove the NP-Hardness of our problem.

Theorem 8

Finding the optimal upfront-fee policy is NP-Hard.

Proof

Given an instance of 
 with multiset 
 and target sum T, we can reduce it to an instance of our problem as following. Consider a market of n firms producing the same product, we can find two constant numbers θ and c satisfying 
 
. Then we set the payoff-relevant parameter to be θ. For Firm i, we set  
 
 
 and 
 
. For ease of expression, we introduce an indicator variable 
 for each firm. 
 means the Firm i gets the innovation; otherwise, it does not. The cost of Firm i after innovation licensing stage can then be expressed as 
 
. We then show that if we can solve our problem optimally, we can decide the result of 
 exactly.

Proposition 1

For the instance of our problem constructed according to the instance of 
, all firms will remain in the market under any innovation assignment.

Proof

Without loss of generality, we can assume 
 is the largest element in S. To prove this claim, we only need to show the product price under any innovation assignment is not less than the largest cost, i.e., 
 
. Given an arbitrary innovation assignment, assume a set E of firms remain in the market. Recall the formula of the price at equilibrium, we have
 
 
 

Given 
 
, we then have
 
 
 Thus, the claim is true. □

As all firms will remain in the market, we can calculate the utility of Firm i as
 
 
 

Combine the utilities of all firms together, we have the total utility as following
 
 
 
 
 
 
 When 
 
, we can achieve the largest possible utility. Thus, if the 
 is satisfied,1 we can have the highest possible total utility, and vice versa. □

5.2. FPTAS algorithm
Given the NP-Hardness of the problem, we turn to devise an FPTAS algorithm. First, we round up the cost of each firm to the power of  and show that we can derive a good approximation solution of the original problem from the approximation solution of the problem with modified parameters. Here, δ is a constant number whose value will be determined later. Second, we reduce the problem with the modified parameters to a variant of the knapsack problem and devise an algorithm for solving it.

5.2.1. Rounding method
W.l.o.g., we can assume  
 
. It is easy to find out that the problem does not change if we subtract  
 
 from all parameters  
 
. To facilitate the expression, we define some notations first.

Definition 4

If 
, we define 
. If 
, we define 
 the unique integer power of  in 
. Define 
 and 
 the set of active firms and the prices in the Cournot game equilibrium with parameters θ and 
. We will use 
 and 
 if there is no ambiguity for abbreviation.

The rounding is done by setting 
 to be 
 and setting  
 
 to be  
 
. After the rounding procedure, if 
 and 
 (or  
 
 and  
 
) are not equal, we have 
 (or  
 
 
). The motivation of the rounding is from Section 5.2.2 where we solve a knapsack problem variant. In that problem, we do not want any two parameters too close if they are different.

The following lemma says that the equilibrium price will not change too much after the rounding.

Lemma 6

There is an inclusion relationship between 
 and 
⁎
, either 
⁎
 or 
⁎
. The price in equilibrium is close, 
 
.

Next lemma bounds the difference between the objectives, i.e., the sum of utilities, in two equilibriums is small.
Lemma 7

⁎
⁎
.

Armed with the two properties, we are ready to show the following lemma.

Lemma 8

If 
 is a 
 
-approximation solution for the problem with modified parameters, 
 is a -approximation solution for the original problem.

Proof

Let 
 denote the optimal value of the problem with original parameters, i.e., 
⁎
⁎
. Let 
 denote the optimal value of the problem with modified parameters, i.e., 
. Suppose we find a solution 
 such that 
. By using Lemma 7, we have 
. Then for utility of the corresponding solution 
 of the original problem, denoted by 
, we have 
 according to Lemma 7. To sum up, 
. By setting 
 
, we get 
. □

5.2.2. Knapsack problem variant
In this section, we present an approximation algorithm for the problem after rounding. Rewrite the objective function as following: 
⁎
 
⁎
⁎
 
⁎
⁎
 
⁎
 
⁎
⁎
 
⁎
⁎
⁎
⁎
 
 Let 
 and 
 denote the first term and the second term, respectively. We will use X and Y if there is no ambiguity for abbreviation. Denote 
⁎
 the optimal solution which achieves the maximum total utility 
⁎
⁎
. In the following lemma, we present that a solution 
 that has 
 and 
 approximate 
⁎
 and 
⁎
 well is enough to be a good approximation solution for 
⁎
.

Lemma 9

Suppose we find 
 such that 
⁎
 and 
⁎
 where 
 
, we have 
⁎
⁎
.

To get the solution 
 satisfying the condition in Lemma 9, we conduct a numerical enumeration over 
⁎
, i.e., the number of active firms after licensing the innovation. Fix 
⁎
, we then enumerate all intervals that the 
⁎
 might lie in. There are n candidate intervals, i.e., 
⁎
⁎
. For each candidate interval 
⁎
⁎
, we further divide it into sub-intervals 
⁎
⁎
 
 such that 
 
 for each sub-interval 
 except the last one. In the following lemma, we present that we can approximate 
⁎
 well by this enumeration method.

Lemma 10

Suppose 
⁎
 is found correctly, if 
⁎
 is within 
 
 approximation of 
⁎
⁎
, then 
 is no more than 
⁎
.

Fix 
⁎
 and the sub-interval 
 where 
⁎
 lies in, we then maximize 
 subject to these two constraints. Suppose that 
 is a subset of 
⁎
⁎
, we then have the equilibrium price locates in the interval 
 according to the price formula. Given that 
⁎
⁎
 
 is fixed, we focus on maximizing 
⁎
. The optimization problem is as following:(6) 
 	 
 
 
⁎
 
 
 
 

Variable 
 indicates Firm i is active in the post-innovation competition. Variable 
 
 indicates Firm i gets innovation. We have 
 for all firms  because their pre-innovation costs are smaller than the equilibrium price. Then we introduce another variable 
 to rewrite the optimization problem. For firm , we use variable 
 to represent it gets innovation and 
 otherwise. For firm , we use 
 to represent it remains active and 
 otherwise. Rewrite the objective function in terms of 
, we have 
 
 
 
. Since the third term is a positive constant given k, it suffices to give a good approximation of the first two summations. The optimization problem becomes (7).(7) 
 	 
 
 
  
 
 
⁎
 
 
  
 
  
 
  
 
  This is indeed a knapsack problem. We can regard the coefficients of 
's in the objective as values and the coefficients of 
's in the constraint as weights. The total weight has a lower bound constraint besides an upper bound constraint. In addition, we must select exact 
⁎
 items in the set . This is a knapsack problem variant with a minimum filling constraint and a cardinal constraint, reformulated as follows:(8) 
  
 
 
 

Theorem 9

There is an approximation scheme for problem (8). If there is no feasible solution, it outputs impossible. Otherwise, it returns a feasible solution with value not less than  times the optimal value for any . The running time is 
 
 
.

At last, we compute the total running time. Theorem 9 requires a small  in order to give a good running time. Note that in our problem f and g are the endpoints of sub-intervals in 
⁎
⁎
. In fact, the price interval is large enough after the rounding method,
⁎
⁎
 
 
 Recall that  are defined in Lemma 9. Hence we can choose sub-intervals with overlap and guarantee the ratio  in each sub-interval. Thus we can solve knapsack problem (8) in 
 time.

Theorem 10

The Algorithm 2 gives a solution with value at least 
⁎
⁎
 and the running time is 
.

In some traditional industries, the current pricing policy is restricted to the upfront-fee policy due to the lack of monitoring the production level of firms. Suppose the innovator is able to use remote control over the manufacturing machines, then the royalty fee is applicable. A natural question is how much additional revenue the innovator can gain by using remote control. We compare the revenue of the optimal hybrid-fee Policy to that of the upfront-fee policy. There is a case where the ratio is 1.75 and we conjecture this is a tight bound.

Observation 1

Consider a market consisting of two firms, where we have 
 
, 
 
 and 
. Here 
 are small positive numbers. It is easy to check that the optimal hybrid-fee policy is to sell the license to Firm 2 and keep 
, and the revenue is 
 
. As for the optimal upfront-fee policy, the total revenue is 
 
. And the ratio is 

We also consider a symmetric case where all firms are identical and we show an upper bound of 1.62.

Theorem 11

In the symmetric case, the ratio between revenue of the optimal hybrid-fee Policy and revenue of the optimal upfront-fee policy is upper bounded by 1.62.

Appendix A. Proof of Theorem 5
Theorem 5

When there are multiple firms producing a homogeneous product in the market, a company without innovation can make a positive profit. However, when there is only one firm in the market, a company without innovation cannot make a positive profit.

Proof

We prove by constructing a strategy to gain positive revenue. The seller makes a commitment that it holds an innovation which can help each firm reduce its cost to 
, where σ is a constant to be defined later. The upfront fee from Firm i is
⁎
 
 
 
 where 
⁎
 is i's utility at the equilibrium when all firms reduce their cost by σ.

And for Firm i, the seller needs to pay a subsidy 
 
 
 to help Firm i reduce its cost. Let the upfront fee subtract the subsidy, then the actual revenue getting from Firm i is
 
 
 
 Since 
 
 is the amount of Firm j's initial production which is always larger than 0, we can choose 
 
 
 to get positive revenue from each firm in .

When the market is monopolized by a firm i, this situation is different. Without loss of generality, assume the firm's original cost is 
. Then if the seller announces that it can help the firm reduce its cost to 
 where σ is arbitrary number in the interval 
. Then the revenue the seller can get is 
 
 
 
 
. Thus, the seller cannot make a positive profit without real innovation. □

Appendix B. Proof of Theorem 7
Theorem 7

In the symmetric case, the ratio between revenue of the optimal hybrid-fee policy and revenue of the optimal royalty-fee policy is 3.

We provide the close-form solutions of optimal royalty-fee policy and optimal hybrid-fee policy, and then calculate the gap between the two policies by comparing them case by case. To calculate the revenue of the optimal royalty-fee policy, we first characterize the optimal royalty-fee policy in the symmetric case in the following lemma.
Denote 
,  
  and ξ the pre-innovation unit-cost, the unit-cost after employing the innovative technology and 
 , respectively.

Lemma 11

In the symmetric case, all firms who get the innovation will pay the same amount of fees under the optimal royalty-fee policy.

Proof

According to Theorem 6, the optimal revenue under the royalty-fee policy is a solution of a quadratic optimization problem, which can always be achieved. Denote 
 the royalty fee paid by Firm i under the optimal royalty-fee policy. Assume there are k firms remain in the market in the equilibrium after the assignment of innovation. We prove by contradiction. The total revenue of innovator R under this policy is
 
 
 
 where  
  is the cost of the firm after getting the innovation. Without loss of generality, assume 
. If we modify the royalty fees of both Firm 1 and Firm 2 to 
 
, the equilibrium price will not change. Thus, all firms stay in the market in the equilibrium as well. As a result, the innovator's revenue after modification 
 is
 
 
 
 
 
 
 Because 
, we get a contradiction. □

Lemma 11 helps us to reduce variables when computing the revenue under the optimal royalty-fee policy, and we present how to get the closed-form solution by employing it in the following lemma.

Lemma 12

The revenue under the optimal royalty-fee policy is as Table B.2


Table B.2. The optimal royalty-fee policy revenue in the symmetric case.

ξ	Royalty-Fee Policy
 
 
 
 
 
 
 
 
 
 
 
Proof

From Section 2, we have known that some firms would exit the market under a pricing policy. But if a firm has extremely low 
, he does never drop out. With this observation, we discuss two cases (1) all firms are active regardless of what policy is used and (2) there exists possibility in kicking out firms when computing the optimal policies. In the first case, the revenue of a policy has a unique expression where the size of survival set is n. In the latter case, we must consider two possible expressions of policy revenue which are distinguished by the size of survival set, and take the one with lager value as the optimal solution. Besides this lemma, Lemma 13 and Lemma 14 are all proved with this sketch.

According to Lemma 11, we only need to determine the number of firms getting the innovation and the royalty fee to charge for each firm. Denote  the number of firms getting the innovation and  the royalty fee.

Case 1. No firm will be kicked out from the market under any policy. To guarantee this condition, we consider the extreme policy where  firms get the full innovation without any charging fees and the remaining firm does not get the innovation. If the remaining firm is active under the extreme policy, then this firm would be active under any other policies. The survival condition is that the price in equilibrium cannot less than the cost without innovation, i.e., 
 
 
, thus we have 
 
.

The revenue of royalty-fee policy can be expressed as
 

With the derivative with respect to k being 
 
, which is always larger than 0 when 
 
, we have k equals to n to maximize the revenue. Plug  back, we find the revenue is an increasing function with respect to r. Thus, we have . The optimal revenue is 
 
.

Case 2. The possibility that some firms will be kicked out exists. In this case, we have 
 
. We consider the following two scenarios and choose the maximum between the two as the optimal revenue.

1.
Some firms have been kicked out under the royalty-fee policy. To guarantee the condition, the price in the equilibrium should be greater than or equal to the cost without innovation i.e., 
. According to Lemma 11, we have all firms remaining get the innovation and pay the same royalty fees. The revenue then can be written as
 
 Further, the derivative with respect to k is 
 
, which is larger than 0. As a result, k should be  to maximize the revenue. Plug  back, we calculate the derivative with respect to r as 
 
. The value of r is as follows(B.1) 
 
 
 
 
  and the corresponding revenue is(B.2)
 
 
 
 
 
 
 

2.
No firm has been kicked out under the royalty-fee policy. To guarantee this condition, we have 
. Note that k cannot be greater than  in this case since there is at least one firm kicked out. Then we can write the revenue as
 
 The derivative with respect to k is 
 
, which is larger than 
 
 
. Thus, we have . Then the value of r is as follows(B.3)
 
 
 
 
  and the revenue is(B.4)
 
 
 
 
 
 
 
 

Combine all the results, we can get the optimal revenue of royalty-fee policy and construct Table B.2 □
To finish the proof of Theorem 7, we compute the revenue of the optimal hybrid-fee policy as well in the following lemma.

Lemma 13

The revenue under the optimal hybrid-fee policy is as Table B.3.


Table B.3. The optimal hybrid-fee policy revenue in the symmetric case.

ξ	Hybrid-Fee Policy
 
 
 
 
 
 
 
 
 
Proof

Case 1. No firm will be kicked out from the market in any case. According to the discussion of Case 1 in Lemma 12, we must have 
 
. For the optimal hybrid-fee policy, according to Lemma 4, only one firm will get partial innovation and the other firms will either get full innovation or no innovation. According to Eq. (4), we can write the revenue as:
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 where 
 is the lowest utility of i, k  is the number of firms getting full innovation and  is the royalty fee paid by the firm getting partial innovation. The first term is total utilities of k firms who get the full innovation; the second term refers to the utility and the royalty fee of the single firm who get the partial innovation; the third term is the total royalty fees we get from the remaining firms. The derivative with respect to k can then be calculated as
 
 which is less than 0 when 
 
. Thus, we set k as 0. Plug  back, we find the revenue increases with respect to r. Thus, we set r as ξ and calculate the revenue of optimal hybrid-fee policy as
 
 
 
 
 Case 2. The possibility that some firms will be kicked out exists. Then we have 
 
. In this case, we have 
. We consider two subcases first and then choose the maximum revenue between these two as the optimal revenue.

Subcase 1. No firm will be kicked out. For hybrid-fee policy, the revenue formula is the same as Case 1. When 
 
 
, the function does not increase with respect to k, thus we have . Plug  back we find the revenue increases with respect to r. Thus, we have .

When 
 
, we will confront two scenarios if no firm will drop out: (1) all firms get the innovation (2) a part of firms get the innovation and 
 
. Thus, the value of k can only be 0, 1 and .

•
. Through calculus, r will be set as 
 
 when 
 
.

•
. The revenue formula can be written as
 

Then we can calculate its derivative with respect to r as
 
 which is larger than 0. So r will be set as ξ.

•
. The revenue formula can be written as
 
 
 
 
 
 
 Then we can calculate its derivative with respect to r as
 
 The revenue decreases with respect to r. As no firm will drop out, r should not be less than 
 
. So r will be set as 
 
.

Subcase 2. Some firms have been kicked out. To guarantee this condition, we have 
 
. For the symmetric case we are considering, all firms without innovation will drop out. Thus, for hybrid-fee policy, we can write the revenue formula as
 
 
 
 
 
 
 Then we can calculate the derivative with respect to k as
 
 And the derivative with respect to r is
 
 The revenue decreases with respect to k when 
 
 and increase with respect to r when . Thus, we need to set  and 
 
.
When , it is easy to check that both the optimal hybrid-fee policy and the upfront-fee policy are providing full innovation to only one firm.

Combining all the results above, we can calculate the optimal revenue and construct Table B.3. □

Proof of Theorem 7

Through Lemma 12 and Lemma 13, the ratio can be calculated as:

•
 
.
 
 
 
 
 
 

•
 
.
 
 
 
 
 

•
 
.(B.5)
 

•
 
 
.
 
 
 
 
 

•
 
.
 
 
 

The proof is done. □

Appendix C. Proof of Lemma 6
Lemma 6

There is an inclusion relationship between 
 and 
⁎
, either 
⁎
 or 
⁎
. The price in equilibrium is close, 
 
.

Proof

By definition of 
, two parameter profiles 
 and 
 have the same order sequence, i.e., 
. By Lemma 1, firms in a active set have lower unit cost than obsolete firms, i.e., 
⁎
 and 
. So we have either 
⁎
 or 
⁎
.

We define 
⁎
⁎
 
. Since 
, we have 
. We consider three cases.

•
If 
⁎
 and 
⁎
. By Lemma 1, 
 is the price and firms in 
⁎
 remain active in the equilibrium. We have 
⁎
, 
.

•
If 
⁎
 such that 
. The value of 
 must be very close to the price. To be specific we have 
. Assume 
, we have 
. Let H denote the set of firms with high costs, 
.

We will prove that 
⁎
﹨ and 
⁎
﹨
﹨
 
. In the equilibrium with cost 
, we have 
. Gather these equations, we have
⁎
 
⁎
﹨
 
 
 
⁎
﹨
⁎
﹨
 
 
⁎
﹨
⁎
﹨
 
⁎
﹨
⁎
﹨
 
⁎
﹨
⁎
﹨
 
⁎
﹨ By assumption 
, we have
⁎
﹨
⁎
 
⁎
﹨
⁎
﹨
 
⁎
﹨
⁎
﹨
 
﹨
⁎
 So firms in 
⁎
﹨ remaining active constitute an equilibrium and the price is 
. Furthermore, we have 
 
 
.

•
If 
⁎
 such that 
. The proof of this case is very similar to the above case and omitted. □

Appendix D. Proof of Lemma 7
Lemma 7

⁎
⁎
.

Proof

We provide the proof for the case 
⁎
. The proof on the other case is similar.
⁎
 
⁎
 
⁎
 
 
⁎
 
﹨
⁎
 
 For 
﹨
⁎
, we have 
 which implies 
. For 
⁎
, we have 
. Plug them into the equations, the sum of utilities is 
⁎
 
﹨
⁎
 
⁎
 
﹨
⁎
 
⁎
 
 
 □

Appendix E. Proof of Lemma 9
Lemma 9

Suppose we find 
 such that 
⁎
 and 
⁎
 where 
 
, we have 
⁎
⁎
.

Proof

It suffices to prove 
⁎
⁎
⁎
⁎
. Note that 
⁎
⁎
⁎
⁎
, it is equivalent to prove(E.1)
⁎
⁎
⁎
 We first give a lower bound of 
⁎
⁎
. Suppose  
 
, we consider the case that only Firm t is licensed the innovation, i.e., 
 
. We first give a lower bound on the sum of utilities of active firms except t using Cauchy–Schwarz inequality. 
⁎
 
⁎
⁎
 
⁎
﹨
 
⁎
 
⁎
⁎
﹨
 
⁎
 
⁎
 
⁎
 
⁎
 
 
 We then give an upper bound of 
⁎
. Note that 
 for all 
⁎
. We have
⁎
⁎
 
⁎
 
⁎
 
⁎
 
⁎
⁎
 
⁎
⁎
⁎
 
⁎
 On the left-hand side of equation (E.1), we have 
⁎
⁎
 
. On the right-hand side, we have 
⁎
. It suffices to prove
 
 It holds when 
 
. □

Appendix F. Proof of Lemma 10
Lemma 10

Suppose 
⁎
 is found correctly, if 
⁎
 is within 
 
 approximation of 
⁎
⁎
, then 
 is no more than 
⁎
.

Proof

Given 
⁎
⁎
 
, we need to prove
⁎
 
⁎
⁎
 
⁎
⁎
⁎
 
⁎
⁎
 
⁎
 
 It is easy to check the ratio is larger than 1. We prove it is smaller than . It suffices to prove 
 which is true when . □

Appendix G. Proof of Theorem 9
Theorem 9

There is an approximation scheme for this problem. If there is no feasible solution, it outputs impossible. Otherwise, it returns a feasible solution with value not less than  times the optimal value for any . The running time is 
 
 
.

Proof

It is easy to solve the case  when all items are selected. In the following We only consider the case .

We first resolve the cardinality constraint. Define 
 for  and 
 for .(G.1)
 
 
 These two problems above are equivalent in the sense that any feasible solution of (8) corresponds a solution of (G.1). This is because if there are not exact m items are selected among  then the weight constraint cannot be satisfied.

For this knapsack problem with a minimum filling constraint, we can use the algorithm introduced in [39]. If there is no feasible solution of (G.1), it outputs impossible. Otherwise, it returns a feasible solution with value not less than  times the optimal value for any . The running time is 
 time where . Note that , we have running time 
 
 
. □

Appendix H. Proof of Theorem 11
Theorem 11

In the symmetric case, the ratio between revenue of the optimal hybrid-fee policy and revenue of the optimal upfront-fee policy is 1.62.

Given that we have already know the revenue of optimal hybrid-fee policy in Lemma 13, we only need to calculate the revenue of the optimal upfront-fee policy to finish the proof.

Lemma 14

The revenue of the optimal upfront-fee policy is as Table H.4.


Table H.4. The optimal upfront-fee policy revenue in the symmetric case.

ξ	Upfront-Fee Policy
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Proof

,  
  and ξ are denoted as Lemma 12. We consider two cases in terms of ξ.

Case 1. No firm will be kicked out from the market in any case. According to the proof of Lemma 12, we have 
 
. Then the revenue can be written as
 
 
 
 
 
 where k is the number of firms getting the innovation.

Calculate its derivative with respect to k as
 
 
 Then the value of k to achieve the optimal revenue through upfront-fee policy is set as
 
 
 
 
 
  Case 2. The possibility that some firms will be kicked out exists. Then we have 
 
. In this case, we have 
. We consider two subcases first and then choose the maximum revenue between these two as the optimal revenue.

Subcase 1. No firm will be kicked out. The revenue formula is the same as Case 1. In addition, we can find the revenue increases with respect to k when 
 
 
 and decreases when 
 
 
. With k being either less than 
 
 or n, we have 
 
 
, when 
 
 
, and 
 
, when 
 
.

Subcase 2. Some firms have been kicked out. To guarantee this condition, we have 
 
. Then we can write the revenue formula as
 
 Calculate its derivative as
 
 
 Thus, the revenue decreases with respect to k when 
 
 and we have 
 
 when 
 
.

When , it is easy to check that both the optimal hybrid-fee policy and upfront-fee policy are providing full innovation to only one firm.

Combining all the results above, we can calculate the optimal revenue and construct Table H.4. □

Proof of Theorem 11

Through Lemma 13 and Lemma 14, we can compute the ratio directly as following:

•
 
. The ratio can be written as
 
 
 
 
 

•
 
 
. The ratio can be written as
 
 
 
 
 
 
 
 
 
 
 
 
 
 

•
 
 
. The ratio is written as
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 The second inequality is based on routine calculations.

•
 
. The ratio can be written as
 
 
 
 

•
. The ratio is 1.  □

Appendix I. Notation tables

Table I.5. Global notations.

Notations	Meanings
the set of all firms
n	the number of firms
θ	the pay-off relevant parameter in the Cournot game
p	the price of each unit
ci	Firm i's per unit cost
Firm i's per unit cost without the innovation
 
Firm i's per unit cost with the innovation
qi	the quantity of the products produced by Firm i
ri	the per-unit royalty fee of Firm i
bi	the one-off upfront fee of Firm i
ui	the utility of Firm i
q = (q1,q2,…,qn)	the quantity profile of all firms
{ci}	the cost profile of all firms
p⁎, 
⁎
, 
⁎
the price, Firm i's production quantity and utility at the equilibrium of the Cournot game
E⁎	the set of firms that ci < p⁎
Firm i's lowest utility that it may obtain in the Cournot game
Γ	the pricing policy
A	the set of firms that accept the pricing policy
L	the number of input bits
ϵ	a sufficiently small positive number

Table I.6. Local notations.

Notations	Meanings
Icond.	binary variable indicating that Icond. = 1 if cond. is true, 0 otherwise, used in Lemma 1
B	the set of firms that 
⁎
, used in Section 3
l	the critical firm in the hybrid-fee policy, used in Section 3
Φ(j1,j2,η)	the operation of decreasing the cost of Firm j1 by η and increasing the cost of Firm j2 by η, used in Lemma 4
e	the size of E⁎, i.e., |E⁎|, used in Algorithm 1
ei	the i-th firm in E⁎ in the increasing order of  
 
, used in Algorithm 1
d	the innovator when it is an incumbent firm, used in Section 3.2
the identity matrix, used in Theorem 6
a |E⁎| × |E⁎| all-ones matrix, used in Theorem 6
e	a |E⁎| all-ones vector, used in Theorem 6
c,  
 	the vectors with i-th elements ci and  
 
, used in Theorem 6
S, T, yi, si	the multiset, the target number, coefficients and elements in Subset Sum Problem, used in Section 5.1
I{0,1}, I{−1,1}	an instance of SSP{0,1} and SSP{−1,1} respectively, used in Lemma 5
E	the set of firms remain in the market, used in Proposition 1
δ	a constant number in the FPTAS algorithm, used in Section 5.2
the unique integer power of (1 + δ) in [ci,(1 + δ)ci) if ci > 0 and 
 if ci = 0, used in Section 5.2.1
E′, p′	the set of active firms and the prices in the Cournot game equilibrium with θ and 
, used in Section 5.2.1
μ	the optimal value of royalty policy, used in Lemma 8
X, Y	the first and the second terms of the objective function of upfront fee policy, used in Section 5.2.2
α, β	
 
, coefficients used in Section 5.2.2
a, h, f, g	interval labels, used in Lemma 9, Lemma 10 and Theorem 9
zi, wi, m, vi	item variable, item weight, item value and total quantity of the knapsack problem, used in Theorem 9
⁎
⁎
 
, used in Lemma 6
H	
, the set of firms with high costs, used in Lemma 6
σ	a constant number, used in Theorem 5
,  
 	the pre-innovation unit-cost, the unit-cost after employing the innovative technology in the symmetric case, used in Theorem 7 and Theorem 11
ξ	
 , used in Theorem 7 and Theorem 11
k	the number of firms that satisfying different conditions in different situations, used in Lemma 11, Lemma 12, Lemma 13, Lemma 14, Section 3 and Section 5.2.2
r	the royalty fee under different policies in the symmetric case, used Lemma 12 and Lemma 13
