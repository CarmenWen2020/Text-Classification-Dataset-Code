Abstract
Multivariate public key cryptography is a candidate for post-quantum cryptography, and it allows generating particularly short signatures and fast verification. The Rainbow signature scheme proposed by Ding and Schmidt is such a multivariate cryptosystem, and it is considered secure against all known attacks. The Rainbow-Band-Separation attack recovers a secret key of Rainbow by solving certain systems of quadratic equations, and its complexity is estimated by the well-known theoretical value called the degree of regularity. However, the degree of regularity is generally larger than the solving degree in experiments, and an accurate estimation cannot be obtained. In this article, we propose a new theoretical value for the complexity of the Rainbow-Band-Separation attack using a Gröbner basis algorithm, which provides a more precise estimation compared to that using the degree of regularity. This theoretical value is deduced by the two-variable power series
∏i=1m(1−t1di1t2di2)(1−t1)n1(1−t2)n2.
Since the two-variable power series coincides with the one-variable power series at t1=t2 deriving the degree of regularity, the theoretical value is less than or equal to the degree of regularity under a certain condition. Moreover, we show a relation between the Rainbow-Band-Separation attack using the hybrid approach and the HighRank attack. By considering this relation and our theoretical value, we obtain a new complexity estimation for the Rainbow-Band-Separation attack. Furthermore, applying our theoretical value to the complexity formula used in the NIST PQC 2nd round, we show that a slight modification of the proposed Rainbow parameter sets is required. Consequently, we provide a new theoretical value for generally estimating the solving degree of a bi-graded polynomial system, which can influence the parameter selection of Rainbow in the NIST PQC standardization project.

Keywords
Multivariate public key cryptography
Rainbow
Rainbow-Band-Separation attack
Gröbner basis algorithm
Degree of regularity

1. Introduction
Standard RSA and EC cryptosystems are designed based on difficult mathematical problems such as prime factorization and discrete logarithm problems. However, these mathematical problems are known to be solved in polynomial time using a large-scale quantum computer [32]. It is therefore necessary to construct cryptography based on new mathematical problems resistant to quantum computers. Such cryptography is referred to as post-quantum cryptography. In 2015, the National Security Agency announced a plan for a transition to post-quantum cryptography, and the National Institute of Standards and Technology (NIST) started public recruitment of such cryptography candidates in 2016 [23].

Multivariate public key cryptography [11] is based on an NP-hard problem of solving a system of quadratic equations, called the MQ problem [20], which is expected to have a particularly high potential for building post-quantum signature schemes. Rainbow is a multivariate signature scheme proposed by J. Ding and D. Schmidt in 2005 [10]. This signature scheme can be simply and efficiently implemented using linear algebra methods over a small finite field, and in particular, it produces shorter signatures than those of RSA and other post-quantum signature schemes [14]. In the NIST post-quantum cryptography (PQC) 2nd round, secure Rainbow parameter sets are proposed, and several attacks against them have been analyzed [14]. The Rainbow-Band-Separation (RBS) attack [13], in particular, is important as the best among the known attacks against Rainbow with a certain parameter set.

Previous methods [14], [33] for estimating the complexity of an RBS attack use the degree of regularity [1], [2] as its theoretical value, under the assumption that the system of quadratic equations solved in the attack is semi-regular (see [1] for the definition). For a semi-regular system, the degree of regularity is given as the degree 
 of the first term whose coefficient is non-positive in the power series(1)
 
 where m and n are the number of equations and variables, respectively. Because a public quadratic system solved in the direct attack is often semi-regular, the complexity estimation of the direct attack uses the degree of regularity [2], [14]. However, in our experiments, the quadratic system solved in the RBS attack is non-semi-regular. Therefore, it is important to find an optimal theoretical value for estimating the complexity of an RBS attack.

1.1. Our contributions
The purpose of this article is to give a more precise complexity estimation for the RBS attack. Because the attack solves a certain quadratic system whose solving complexity dominates the overall attack, which we call an RBS dominant system, we need to estimate the complexity of a Gröbner basis algorithm to solve this system. In particular, for estimating the complexity, this article considers theoretical values approximating its solving degree, that is the maximal degree of steps that add a new non-zero polynomial during a Gröbner basis algorithm. As mentioned above, previous estimation methods have used the degree of regularity as its theoretical value. However, an RBS dominant system is solved faster than a semi-regular system, and its solving degree is lower than the degree of regularity. This is probably caused by the fact that an RBS dominant system has a relation between its variables, which is said to be bi-graded.

In this article, we consider a polynomial h in 
 graded by 
 which is called a bi-graded polynomial, such as a bilinear polynomial graded by . Then, for a bi-graded polynomial system 
, we introduce a new theoretical value 
, which is defined as the minimum total degree of the terms whose coefficients are negative in the two-variable power series(2)
 
 Since the one-variable power series (1) deriving the previous theoretical value 
 is the same as the two-variable power series (2) at 
, we have the relation 
 when the coefficient of 
 in (1) is negative. Moreover, for a bi-graded polynomial system satisfying the condition 
, we can prove that the theoretical value 
 is an upper bound for its first fall degree [16], which was introduced to approximate the solving degree of a non-semi-regular system, such as HFE [26] or its variants.

For a Rainbow parameter set 
, the top homogeneous component of an RBS dominant system consists of 
 bilinear polynomials and 
 quadratic polynomials in 
 variables, which are partitioned into 
 variables and 
 variables. In other words, the RBS dominant systems are bi-graded. Through our experiments on RBS dominant systems with 
 and 
 , we show that our theoretical value 
 tightly approximates the solving degree of the system than the degree of regularity 
.

We also show a relation between the RBS attack and the HighRank attack, which recovers a lower-rank quadratic polynomial by using a brute-force search. Since an RBS dominant system has many bilinear polynomials, the hybrid approach [2], [34] on the RBS attack provides an overdetermined linear system by fixing one of the two sets of variables. In this case, the RBS attack becomes similar to the HighRank attack (see Subsection 5 for details). This fact has not been mentioned in previous research [14], [28], [29], [33].

By using our theoretical value and reconsidering the hybrid approach on the RBS attack, we can obtain a new complexity estimation for the RBS attack. Moreover, by applying our theoretical value to the complexity formula used in the NIST PQC 2nd round, we show that a slight modification on the proposed Rainbow parameter sets is required. Consequently, we provide a new theoretical value for generally estimating the solving degree of a bi-graded polynomial system, which can influence the parameter selection of Rainbow in the NIST PQC standardization project.

Our work is independent of the study [27], which was submitted on the Cryptology ePrint Archive (https://eprint.iacr.org) one day prior to the preprint version [24] of this article (see also Remark 4.6). The estimation using the first fall degree in [27] requires a certain assumption, and they performed experiments on scaled-down Rainbow parameter sets in order to verify whether this assumption holds. On the other hand, we can obtain an estimation only by theoretical discussion. In particular, our estimation is applicable not only to an RBS system, but generically to a bi-graded polynomial system that satisfies 
.

1.2. Organization
This article is organized as follows. In Section 2, we describe Rainbow and the RBS attack. In Section 3, we explain the previous complexity estimation of the RBS attack using the degree of regularity and present experiments for scaled-down Rainbow parameter sets in the NIST PQC 2nd round. In Section 4, we introduce a new theoretical value for estimating the complexity of an RBS attack and demonstrate that this theoretical value more tightly approximates the solving degree of the quadratic system solved in the attack. In Section 5, by using our theoretical value and reconsidering the hybrid approach on the RBS attack, we give a new complexity estimation for the RBS attack and investigate the security of the parameter sets proposed in the NIST PQC 2nd round. In Section 6, we conclude the results.

2. The Rainbow signature scheme
In this section, we briefly describe the Rainbow signature scheme and several attacks against it. We detail Rainbow in Subsection 2.1 and its parameter set in Subsection 2.2. In Subsection 2.3, we describe the Rainbow-Band-Separation (RBS) attack in detail.

2.1. Rainbow
Let n and m be positive integers. We denote by  the finite field of order q. An element 
 of 
 is called a polynomial system and gives a map 
 by 
, which is called a polynomial map.

A multivariate public key signature scheme consists of the following three algorithms:

Key generation: We construct two invertible linear maps 
 and 
 randomly and an easily invertible quadratic map 
, which is called a central map, and then compute the composition . The public key is given as P. The tuple  is a secret key.

Signature generation: For a message 
, we compute 
. Next, we can compute an element 
 of 
 since F is easily invertible. Consequently, we obtain a signature 
.

Verification: We verify whether  holds.

Rainbow is a multivariable signature scheme proposed by Ding and Schmidt in 2005 [10]. For positive integers v, 
 and 
, let 
 and 
 be three sets of variables, and put 
 and 
. The central map 
 of Rainbow is defined by(3)
  where 
 and 
 are randomly chosen quadratic and linear polynomials, respectively. Then, in the signature generation algorithm above, we can easily compute an element 
 in the pre-image of any element 
 in 
 under F as follows:

1.
Randomly choose 
 as x.

2.
Solve a system of linear equations
 Let 
 be one of its solutions if it exists. Otherwise, return to the step 1.

3.
Solve a system of linear equations
 Let 
 be one of its solutions if it exists. Otherwise, return to the step 1.

4.
Obtain an element 
 in the pre-image of 
.

2.2. Parameters of Rainbow
In this subsection, we briefly describe several attacks against Rainbow.

The central map of Rainbow with a parameter set 
 can be regarded as a UOV [22] instance with the parameter set 
. Hence the UOV attack [21] is available as an attack against Rainbow, and we have to take the Rainbow parameter set such that
 We can also consider attacks using the special structure of the Rainbow central map (3). The HighRank attack [8] and the MinRank attack [4] are such attacks. Due to the influence of the UOV attack and the HighRank attack, we set 
. Moreover, for a public key P and a given message b, the direct attack [2] forges a signature by solving  directly. Complexity estimations for the direct attack and the RBS attack [13], which also solves a quadratic system to recover a secret key (see Subsection 2.3 for details), are important in deciding the concrete parameters 
 and 
. In this article, we implicitly assume 
 and consider a parameter set with 
 or 
 .

The NIST PQC standardization project [23] provides six security categories (see Table 1). Here, due to the NIST specification, the number of gates is given by 
.


Table 1. NIST security categories (Table 10 in [14]).

Category	log2 classical gates	log2 quantum gates
I	143	130/106/74
II	146	
III	207	193/169/137
IV	210	
V	272	258/234/202
VI	274	
Table 2 and Table 3 show the Rainbow parameter sets Ia, IIIc and Vc [14] proposed in the NIST PQC 2nd round and the complexities of the above attacks. Here, the bold numbers in Table 2 and Table 3 indicate the best complexity of attacks in each parameter set. Table 2 shows that the direct attack is the best among attacks against parameter sets IIIc and Vc in classical gates, and Table 3 shows that the HighRank attack is the best among attacks against all parameter sets in quantum gates. The parameter sets Ia, IIIc and Vc are designed to satisfy the NIST security categories I, III/IV and V/VI in Table 1, respectively [14].


Table 2. (Classical attacks) Complexities (
) of known attacks against Rainbow (from Tables in Section 7.2 in [14]).

Parameter set	(q,v,o1,o2)	Direct	MinRank	HighRank	UOV	RBS
Ia	(16,32,32,32)	164.5	161.3	150.3	149.2	145.0
IIIc	(256,68,36,36)	215.2	585.1	313.9	563.8	217.4
Vc	(256,92,48,48)	275.4	778.8	411.2	747.4	278.6

Table 3. (Quantum attacks) Complexities (
) of known attacks against Rainbow (from Tables in Section 7.2 in [14]).

Parameter set	(q,v,o1,o2)	Direct	MinRank	HighRank	UOV	RBS
Ia	(16,32,32,32)	146.5	95.3	86.3	87.2	145.0
IIIc	(256,68,36,36)	183.5	309.1	169.9	295.8	217.4
Vc	(256,92,48,48)	235.5	406.8	219.2	393.4	278.6
2.3. RBS attack
In this subsection, we describe the RBS attack [13] and a certain quadratic system solved in the attack, which are the subjects of our research. For simplicity, we assume in this subsection that the characteristic of  is odd. We then use the symmetric matrix representation of a quadratic homogeneous polynomial.

Let 
 be a Rainbow parameter set, and put 
 and 
. For a Rainbow public key 
, the RBS attack recovers its secret key  as follows. By the definition (3) of the central map 
, each matrix corresponding to 
 has the following form:(4)
⁎
⁎
⁎
 
⁎
⁎
⁎
⁎
⁎
⁎
⁎
⁎
 
  Here, ⁎
 mean k-by-l matrices over . Similarly, the matrices corresponding to S and T can be written as follows:(5)
⁎
⁎
⁎
 
⁎
  If S and T are taken as random invertible linear maps, then 
 and 
 cannot be written in the form (5). However, it is known that the security of Rainbow does not decrease, even if S and T are taken in the form (5). Therefore, S and T in [13] are set to be in the form (5), which induces a reduction in the secret key size. The matrices 
 corresponding to the public polynomials 
 are given as(6)
 
 

By the form (5), there exists an n-by-1 vector 
 such that 
. Then, for , we have
 
 Since each 
 is a linear combination of 
 
 
, we obtain(7)
 By the form (5), there exists an m-by-1 vector 
 such that 
. Then, multiplying the equation (6) by  
 , we obtain
 
 
 Moreover, multiplying this equation by s, we have
 
 
 Thus, we have the following equations(8)
 
 where 
 is the n-by-1 vector 
. Here, we remove the case , because the equation (8) for  follows from the equation (7).

Since 
, it is clear that the system of the equations (7) and (8) consists of  quadratic equations in n variables 
, which is constructed from the public key 
. By solving the quadratic system, an attacker can recover a part of the secret key S and T, namely, s and t. The RBS attack can recover S and T by repeating a similar approach as above (see [13] for details). Because the complexity of solving the quadratic system dominates that of the RBS attack, it suffices to treat only the system. We refer to the quadratic system consisting of the equations (7) and (8) as the RBS dominant system.

3. Revisiting the previous complexity estimation for the RBS attack
In this section, we describe the previous complexity estimation for the RBS attack. In Subsection 3.1, by using a certain experimental degree called the solving degree, we describe the complexity of a Gröbner basis algorithm for solving a quadratic system. In Subsection 3.2, we recall the degree of regularity to approximate the solving degree for such a quadratic system. In Subsection 3.3, we show that RBS dominant systems have a gap between the solving degree and the degree of regularity. In Subsection 3.4, we show the state of the step degrees in the Gröbner basis algorithm with the RBS dominant system for a concrete Rainbow parameter set.

3.1. Complexity of attacks using a Gröbner basis algorithm
In the RBS attack, Gröbner basis algorithms are used to solve the RBS dominant system.

A Gröbner basis algorithm, which computes a Gröbner basis for the ideal generated by a given polynomial system, was discovered by Buchberger [6], and improved as faster algorithms, such as XL [35], 
 [17] and 
 [18]. In this article, we use the following complexity of the 
 algorithm to solve a polynomial system in n variables: 
 
 where  is a linear algebra constant and 
 is the maximal degree in steps that add a new non-zero polynomial during the Gröbner basis algorithm, called the solving degree.

Although the solving degree is important for obtaining the complexity, it is an experimental value. In order to estimate the complexity of solving a large-scale polynomial system, we need to find a theoretical value that approximates the solving degree (see Subsection 3.2).

Using the solving degree 
, we describe the complexity of the RBS attack against Rainbow with a parameter set 
 as follows. Put 
 and 
. Since the RBS dominant system (7) and (8) then has  quadratic equations in n variables, the complexity of the attack is given by 
 
 Furthermore, by using the hybrid approach [2], [34] of the brute-force search and Gröbner basis algorithm which solves the RBS dominant system in  variables after fixing k variables, the complexity is improved as(9) 
 
 
 In quantum gates, by using Grover's algorithm, the complexity is given by(10) 
 
 

3.2. Degree of regularity
In this subsection, we describe the degree of regularity as a theoretical value approximating the solving degree.

Denoting by 
 the vector space generated by the monomials of the total degree d over  in 
, we have the following decomposition:
 We denote by 
 the ideal generated by 
, and by 
 its component of degree d in the decomposition if 
 are homogeneous. For a polynomial system 
, the quotient 
 has a decomposition 
 such that
 where 
. Moreover, the Hilbert series 
 of such a ring R is defined as 
. For a polynomial system 
, Bardet et al. [1] considered the degree of regularity 
 as the minimal value of the set 
 if it exists. When 
 is semi-regular [1], its Hilbert series coincides with the sum of terms whose coefficient is non-negative in(11)
 

Thus the degree of regularity 
 is equal to the degree 
 of the first term whose coefficient is non-positive in the power series (11). Because it is hard to compute the degree of regularity 
 for any polynomial system, the cryptanalysis in multivariate public key cryptography often uses the degree 
 as the degree of regularity 
 by assuming that the polynomial system is semi-regular.

For the same reason, the RBS dominant system is also assumed to be semi-regular. Under the assumption, the previous estimation [14], [33] for the complexity of the RBS attack is given as follows. For a Rainbow parameter set 
, the RBS dominant system (7) and (8) has  quadratic polynomials in n variables where 
 and 
. Then, by the formula (9), the complexity in classical gates of the RBS attack is given by(12) 
 
 
 where  is a linear algebra constant, k is the number of variables fixed by the hybrid approach, and 
 is given by the degree of the first term whose coefficient is non-positive in the power series(13)
 
 In quantum gates, by using Grover's algorithm, the complexity is given by(14) 
 
 

In the next subsection, by our experiments, we show that an RBS dominant system is non-semi-regular.

3.3. Experiments on the degree of regularity
In this subsection, through our experiments on Rainbow parameter sets with 
, we show that RBS dominant systems have a gap between the solving degree 
 and the degree of regularity 
. The experiments in this article were performed by using the Gröbner basis algorithm 
 with respect to the graded reverse lexicographic monomial order in Magma V2.24-4 [5] on a 3.2 GHz Intel Core i7 CPU.

For small Rainbow parameter sets 
 with 
, Table 4 demonstrates the fundamental assertion that the degree of regularity 
 tightly approximates the solving degree 
 for a semi-regular system of 
 quadratic equations in 
 variables, which are of the same size as the RBS dominant system (7) and (8). Under the assumption that an RBS dominant system is semi-regular, the previous estimation method [14], [33] for an RBS attack uses the degree of regularity 
 (see Subsection 3.2) as the solving degree 
. Table 4 shows that this assumption does not hold for small Rainbow parameter sets 
 with 
.


Table 4. (Gap between Dreg and dslv for an RBS dominant system) For the parameter relation v≲2oi (i = 1,2), the degree of regularity Dreg (see the series (13)) and experimental values dslv (see Subsection 3.1), dtim and dmem (see Subsection 3.4) in the Gröbner basis algorithm F4 for RBS dominant systems and semi-regular systems of the same size. Each RBS dominant system is solved faster than a semi-regular system of the same size, and there is a gap between the degree of regularity Dreg and the solving degree dslv.

q = 256	# eq.	# var.	Dreg	Semi-regular system	RBS dominant system
(v,oi)	Time (sec)	dslv	dtim	dmem	Time (sec)	dslv	dtim	dmem
(4,3)	15	10	4	0.03	4	4	4	0.01	4	4	4
(5,3)	16	11	5	0.09	5	5	5	0.01	4	4	4
(6,3)	17	12	5	0.24	5	5	5	0.03	4	4	4
(6,4)	21	14	5	1.57	5	5	5	0.12	4	4	4
(7,4)	22	15	6	9.86	6	6	6	0.25	4	4	4
(8,4)	23	16	6	31.56	6	6	6	0.58	4	4	4
(8,5)	27	18	6	213.57	6	6	6	7.50	5	5	5
(9,5)	28	19	6	796.80	6	6	6	35.08	5	5	5
(10,5)	29	20	7	7818.25	7	7	7	71.54	5	5	5
(10,6)	33	22	7	47311.77	7	7	7	954.82	6	6	6
(11,6)	34	23	7	≥ 2 days	-	-	-	3265.14	6	6	6
(12,6)	35	24	7	≥ 2 days	-	-	-	6609.50	6	6	6
In Table 4, we see that each RBS dominant system is solved faster than a semi-regular system of the same size and has a gap between the degree of regularity and the solving degree. Since the degree of regularity does not closely approximate the solving degree of an RBS dominant system, it is important to find an optimal theoretical value for estimating the complexity of an RBS attack. Note that an experiment on the RBS attack was also carried out in [33], and Table 2 in [33] shows that an RBS dominant system is solved faster than a semi-regular system of the same size. However, [33] does not mention the relation between the degree of regularity and the solving degree.

3.4. State of the step degrees
In this subsection, we show the state of the step degrees in the Gröbner basis algorithm with the RBS dominant system for a concrete Rainbow parameter set.

We denote by 
 the degree of the most memory-consuming step and by 
 the degree of the most time-consuming step during the Gröbner basis algorithm. A number of experiments in Subsection 3.3 show that the relation(15)
 holds on an RBS dominant system for small parameter sets with 
. Fig. 1 shows the state of the step degrees in the Gröbner basis algorithm with the RBS dominant system for the Rainbow parameter set 
 as input. Then, in the Gröbner basis algorithm, steps after the 8th step do not find new polynomials. Hence, 
. We can verify the relation (15). Here, to obtain the Gröbner basis, it suffices to compute up to the 7th step for the RBS attack.

Fig. 1
Download : Download high-res image (45KB)
Download : Download full-size image
Fig. 1. The state of the step degrees in the Gröbner basis algorithm F4 with the RBS dominant system for the parameter set (q,v,o1,o2)=(256,11,6,6). A step marked with the square black box adds a new polynomial. A step marked with the square white box does not add a new polynomial. The relation dslv ≤ dtim = dmem holds. (dslv: Subsection 3.1, dtim and dmem: Subsection 3.4). (For interpretation of the colors in the figure(s), the reader is referred to the web version of this article.)

As shown in Subsection 3.3, the RBS dominant system has a gap between the solving degree 
 and the degree of regularity 
 since it is non-semi-regular. In order to approximate the solving degree 
 of a non-semi-regular system, Dubois and Gama [16] investigate the step degree of the first step where a (step) degree fall occurs. The work [12] experimentally shows that such a step degree approximates the solving degree 
 of a non-semi-regular system given as a public key of HFE [26].

In Fig. 1, a degree fall occurs at the 6th step, whose step degree is the solving degree 
. However, an insignificant degree fall occurs at the 2nd step. We can remove this degree fall at the 2nd step as follows. For simplicity, we assume the characteristic of  is odd. Let 
 be m quadratic polynomials (7) and 
 be  bilinear polynomials (8) (see Subsection 2.3). Using the notations in the equations (7) and (8), we consider the matrix
 
 The top homogeneous components of 
 are given as the components of 
, and those of 
 are given as the first  components of . Thus, there is a non-trivial syzygy obtained from the top homogeneous components of the relation 
. By the reduction with this syzygy, we can construct the bilinear polynomial
 This is the reason that the degree fall at the 2nd step occurs. Hence, adding the constructed bilinear polynomial to the 2nd step, we can remove this degree fall.

We call the step degree of the first step where a degree fall can not be removed by the first fall degree 
. For a quadratic system given as the public key of HFE [26], the degree 
 coincides with the solving degree 
. Similarly, for the RBS dominant system with the parameter set 
, Fig. 1 shows
 In Subsection 4.2, we show this equality holds for many Rainbow parameter sets with 
 and 
.

4. New theoretical value for the complexity of the RBS attack
In this section, we propose a theoretical value for estimating the complexity of the RBS attack. We first introduce the bi-graded polynomial and a new theoretical value for it. We then show that an RBS dominant system is bi-graded and that the introduced theoretical value tightly approximates its solving degree than the degree of regularity by experiments (see Remark 4.7).

4.1. New theoretical value for a bi-graded polynomial system
In this subsection, we describe the bi-graded polynomial and introduce a new theoretical value for it. Moreover, we show that, under the reasonable condition, this theoretical value is an upper bound for the first fall degree which has been used to approximate the solving degree of a non-semi-regular system.

When a polynomial system is semi-regular, the theoretical value 
 deduced from (11) coincides with the degree of regularity 
. However, as shown in Subsection 3.3, an RBS dominant system which we investigate is not semi-regular. It is necessary to consider another theoretical value different from the degree of regularity. In order to approximate the solving degree of a non-semi-regular system, such as HFE [26] and its variant (e.g. GeMSS [7]), the first fall degree [16] was introduced as a theoretical formulation for the degree 
 defined in Subsection 3.4, and it is defined as follows.

Definition 4.1

Let 
 with the standard graded decomposition 
. Let 
 be a positive integer and 
 be homogeneous polynomials of degree 
 in 
. Put 
 where 
 is an image in B of 
. For 
, the first fall degree 
 is the minimum value of the following set if it exists:
 where 
, 
, and 
. Moreover, for any polynomial system 
, the first fall degree is defined as 
.

In the remainder of this subsection, we consider the bi-graded polynomial system which is not necessary to be semi-regular, and show that the theoretical value deduced from the corresponding two-variable series is an upper bound for its first fall degree.

Definition 4.2

A commutative ring R is said to be bi-graded if it has a decomposition 
 such that
 Moreover, an element in a bi-graded commutative ring R is said to be bi-graded if it is contained in 
 for some 
. Then, for a bi-graded element 
, we define 
 as 
. In this article, an element of R whose top homogeneous component is bi-graded is also said to be bi-graded.

For example, by setting 
 and 
, the polynomial ring 
 is bi-graded. In the following definition, we define a two-variable power series decided by the bi-degrees of a bi-graded polynomial system and the theoretical value 
.
Definition 4.3

Let 
 be bi-graded polynomials in the bi-graded polynomial ring 
 where 
. Put integers 
 as(16) 
 
 
 We define 
 as the minimal value of 
 if it exists.

For bi-graded polynomials 
, the quotient 
, 
 is also bi-graded. Then we define the bi-graded Hilbert series 
. Under the assumption of Lemma A in Appendix, the two-variable power series (16) in Definition 4.3 can compute the bi-graded Hilbert series (see Lemma A and Lemma B in Appendix).
By the definition, we have the following theorem:

Theorem 4.4

Let 
 be bi-graded polynomials in the bi-graded polynomial ring 
. If the coefficient of 
 in (11) decided by these bi-degrees is negative, then we have

Proof

Put 
. If we set 
, then the series (16) coincides with the one-variable power series (11). Hence, comparing the coefficients of both power series, we have(17) 
 
 By the assumption, the coefficient of 
 in (11) is negative, i.e. 
. Thus, in the left hand side of the equality (17), there exists a pair 
 such that 
 and 
, and it follows that 
. □

By the following theorem, under the condition 
, we see that the theoretical value 
 in Definition 4.3 is an upper bound for the first fall degree of a bi-graded polynomial system.
Theorem 4.5

Let 
 be bi-graded polynomials in the bi-graded polynomial ring 
. If 
, then we have
 where 
 is the first fall degree in Definition 4.1.

Proof

See Appendix. □

In the next section, we show that an RBS dominant system is bi-graded. Moreover, for almost parameter sets performed on our experiments in the next section, the degree 
 attains the bound 
 in Theorem 4.5. Note that, for the proposed Rainbow parameter sets Ia, IIIc and Vc, the RBS dominant system that gives the best complexity satisfies the assumptions in Theorem 4.4 and Theorem 4.5 (see Remark 5.2).
Remark 4.6

Note that Theorem 4.5 is not proved in [27]. Perlner and Smith-Tone's value approximating the solving degree is determined by the lowest term whose coefficient is non-positive in the power series (16). Due to this setting, their estimation using the first fall degree requires a certain assumption (see Corollary 2 in [27]). In order to verify whether this assumption holds, they performed experiments on scaled-down Rainbow parameter sets. On the other hand, our theoretical value 
 is determined by the lowest term whose coefficient is negative (see Definition 4.3). It is possible to show the existence non-trivial syzygies by the homology of the Koszul complex (see Appendix), and we can obtain an estimation only by theoretical discussion as Theorem 4.5. In particular, our estimation is applicable not only to an RBS system, but generically to a bi-graded polynomial system that satisfies 
.

4.2. Experimental estimation for the solving degree of an RBS dominant system
In this section, we confirm that an RBS dominant system is bi-graded, and experimentally show that the introduced theoretical value tightly approximates the solving degree of an RBS dominant system than the degree of regularity.

For a Rainbow parameter set 
, the RBS dominant system consists of m quadratic polynomials (7) in a set 
 of variables and  bilinear polynomials (8) in two sets 
 and 
 of variables where 
 and 
 (see Subsection 2.3). The polynomial ring 
 can be graded by

The top homogeneous components 
 of quadratic polynomials (7) are contained in 
, and 
 of quadratic polynomials (8) are in 
. Namely,(18) 
  Hence, the RBS dominant system is a bi-graded polynomial system.

By Definition 4.3 and the equation (18), the theoretical value 
 for an RBS dominant system with a parameter set 
 is given by the minimal total degree of the terms whose coefficients are negative in the two-variable power series(19)
 
 Table 5 compares the theoretical value 
 and the degree of regularity 
 for RBS dominant systems with 
 and 
.


Table 5. (Dbgd vs Dreg for an RBS dominant system) Experimental values dslv (see Subsection 3.1), dff and dtim (see Subsection 3.4) in the F4 algorithm and theoretical values Dbgd (from the series (19)) and Dreg (from the series (13) at k = 0) for an RBS dominant system with v≲2oi or v = oi (i = 1,2). The proposed theoretical value Dbgd coincides with dslv in all cases except for (q,v,oi)=(256,8,4). The degree of regularity Dreg is always larger than dslv, except for (q,v,oi)=(256,4,4).

q = 256	Exper.	Theor.
(v,oi)	dslv	dff	dtim	Dbgd	Dreg
(4,3)	4	4	4	4	4
(5,3)	4	4	4	4	5
(6,3)	4	4	4	4	5
(6,4)	4	4	4	4	5
(7,4)	4	4	4	4	6
(8,4)	4	4	4	5	6
(8,5)	5	5	5	5	6
(9,5)	5	5	5	5	6
(10,5)	5	5	5	5	7
(10,6)	6	6	6	6	7
(11,6)	6	6	6	6	7
(12,6)	6	6	6	6	7

q = 16	Exper.	Theor.
(v,oi)	dslv	dff	dtim	Dbgd	Dreg
(3,3)	3	3	3	3	4
(4,4)	4	4	4	4	5
(5,5)	4	4	4	4	5
(6,6)	5	5	5	5	6
(7,7)	5	5	5	5	6
(8,8)	6	6	6	6	7
(9,9)	6	6	6	6	7
Furthermore, Table 6 compares the theoretical value 
 and the degree of regularity 
 for the hybrid approach on the RBS attack against Rainbow parameter sets 
 and . Here, 
 and 
 are the number of variables fixed by the hybrid approach in 
 and 
, respectively, where 
 are the variables of an RBS dominant system (7) and (8). Then the theoretical value 
 is given by the minimal total degree of the terms whose coefficients are negative in the two-variable power series(20)
 


Table 6. (Dbgd vs Dreg for the hybrid approach on an RBS dominant system) Experimental values dslv (see Subsection 3.1), dff and dtim (see Subsection 3.4) in the F4 algorithm and theoretical values Dbgd (from the series (20)) and Dreg (from the series (13)) of the hybrid approach on RBS dominant systems in variables 
 for (q,v,o1,o2)=(256,10,5,5) and (16,8,8,8). The integers k1 and k2 are the numbers of variables fixed by the hybrid approach in 
 and 
, respectively. The degree of regularity Dreg is always larger than the solving degree dslv. The proposed theoretical value Dbgd tightly approximates dslv than Dreg and is an upper bound of dslv.

Exper.	Theor.
k1 + k2	(k1,k2)	dslv	dff	dtim	Dbgd	Dreg
0	(0,0)	5	5	5	5	7
1	(1,0)	5	5	5	5	6
(0,1)	4	4	4	5	6
2	(2,0)	5	5	5	5	6
(1,1)	4	4	4	4	6
(0,2)	4	4	4	4	6
3	(3,0)	4	4	4	4	6
(2,1)	4	4	4	4	6
(1,2)	4	4	4	4	6
(0,3)	3	3	3	3	6
4	(4,0)	4	4	4	4	5
(3,1)	4	4	4	4	5
(2,2)	3	3	3	3	5
(1,3)	3	3	3	3	5
(0,4)	2	2	2	2	5

Exper.	Theor.
k1 + k2	(k1,k2)	dslv	dff	dtim	Dbgd	Dreg
0	(0,0)	6	6	6	6	7
1	(1,0)	5	5	5	5	6
(0,1)	5	5	5	5	6
2	(2,0)	5	5	5	5	6
(1,1)	5	5	5	5	6
(0,2)	5	5	5	5	6
3	(3,0)	5	5	5	5	6
(2,1)	5	5	5	5	6
(1,2)	5	5	5	5	6
(0,3)	4	4	4	5	6
4	(4,0)	4	4	4	4	6
(3,1)	4	4	4	5	6
(2,2)	4	4	4	4	6
(1,3)	4	4	4	4	6
(0,4)	4	4	4	4	6
Remark 4.7

In our experiments using the 
 algorithm [17] in Section 4, we see that the Gröbner basis of the ideal generated by an RBS dominant system is computed within the introduced theoretical value 
, and its solution can be obtained. Although our experiments were performed using the 
 algorithm, this fact is independent of such Gröbner basis algorithms. Indeed, we can confirm the same fact for an XL algorithm that generates a Gröbner basis.

5. Our complexity estimation for the RBS attack
In this section, we give a new complexity estimation of the RBS attack by using our theoretical value introduced in Subsection 4.2 and reconsidering the hybrid approach. In Subsection 5.2, applying our theoretical value to the complexity formula [14] used in the NIST PQC 2nd round, we show that a slight modification of the Rainbow parameter sets is required.

5.1. Complexity estimation based on the bi-graded polynomial system
In this section, we give a new complexity estimation of the RBS attack under the assumption that the theoretical value 
 is an upper bound of the solving degree 
 (see Subsection 4.2). Moreover, we investigate the relation between the RBS attack using the hybrid approach and the HighRank attack.

For simplicity, we explain only the complexity estimation in classical gates for the RBS attack against a Rainbow parameter set 
. Put 
 and 
. Let 
 and 
 be the number of variables fixed by the hybrid approach in 
 and 
, respectively, where 
 are the variables of the RBS dominant system (7) and (8). When 
 and 
, the complexity is given by
 
 where  is a linear algebra constant and 
 is given by the minimal total degree in terms whose coefficients are negative in the two-variable power series (20) in Subsection 4.2. When 
 and 
, we obtain a system of 
 linear equations in 
 variables from the RBS dominant system fixed 
 variables. Then, the complexity is given by
 Similarly, when 
 and 
, we obtain a system consisting of 
 quadratic equations and 
 linear equations in 
 variables. Then, since it suffices to solve a system of linear equations in 
 variables, the complexity is given by
 When 
 and 
, the complexity of a brute-force search is given by 
.

In summary, the complexity in classical gates of the RBS attack against Rainbow with a parameter set 
 is given as the minimal value of(21)
 
  where  is a linear algebra constant and 
 is given by the minimal total degree in terms whose coefficients are negative in the two-variable power series (20), i.e.
 
 Moreover, using Grover's algorithm, the complexity in quantum gates is given as the minimal value of(22)
 
 

We explain that the RBS attack using the hybrid approach at 
 becomes similar to the HighRank attack [8]. Since a Rainbow central map has low rank matrices 
 (see the form (4)), we can obtain a lower-rank quadratic polynomial by finding a linear combination of 
. For 
 matrices from 
, the HighRank attack recovers such a quadratic polynomial by finding a linear combination of matrices whose kernel subspace is of dimension one. On the other hand, the RBS attack using the hybrid approach at 
 fixes 
 values 
 to obtain a linear combination
 
 of 
 matrices 
 and solves a system of linear equations (8) in 
 variables. Then the attack has a lower-rank quadratic polynomial and becomes a HighRank attack. Although this attack with 
 corresponds a HighRank attack with the hybrid approach, we set 
 to compare the HighRank attack [8]. Note that, in the next subsection, we will show this case is the best in quantum gates for the proposed Rainbow parameter sets. Then, by the formula (21), the complexity in classical gates is given by(23)
 where  is a linear algebra constant. On the other hand, in [13], the complexity of the HighRank attack [8] is given by(24)
 For parameter sets such that 
 and 
 with a constant ε, the substituting part dominates this complexity when . Then the complexities (23) and (24) are 
 and 
, respectively, and the HighRank attack [8] is better than that from the RBS attack when . However, their difference is only a constant multiple. In quantum gates, the same can be seen from the above discussion replaced 
 by 
. Note that, since the complexity 
 dropped the substituting part from (24) is used in Table 8, the complexity for the Rainbow parameter set Ia (i.e. ) is better than that for the RBS attack.

5.2. Updated complexity estimation for the NIST PQC 2nd round
In this subsection, applying our theoretical value to the complexity formula [14] used in the NIST PQC 2nd round, we obtain new complexities of the RBS attack against the proposed Rainbow parameter sets. Moreover, we investigate whether the used formula is suitable for the RBS attack.

In the NIST PQC standardization project, the Rainbow designer applies the degree of regularity 
 to the following complexity formula [14], [36] of the Wiedemann XL algorithm, which is better than the formula (9), and it estimates the complexity of the RBS attack.(25) 
 
 
  In Table 7 and Table 8, applying our theoretical value 
 to the complexity formula (25), we deduce the complexities of the RBS attack against the Rainbow parameter sets proposed in the NIST PQC 2nd round (see Remark 5.2 for details).


Table 7. (Classical attacks) In the RBS attack, the old complexity 
 using Dreg and the new complexity using Dbgd.

Parameter set	Direct	MinRank	HighRank	UOV	RBS
old	new
Ia	164.5	161.3	150.3	149.2	145.0	142.9
IIIc	215.2	585.1	313.9	563.8	217.4	206.4
Vc	275.4	778.8	411.2	747.4	278.6	267.4

Table 8. (Quantum attacks) The new complexity 
 of the RBS attack using Dbgd and the complexity of the HighRank attack in Table 3.

Parameter set	Direct	MinRank	HighRank	UOV	RBS
new
Ia	146.5	95.3	86.3	87.2	87.3
IIIc	183.5	309.1	169.9	295.8	170.8
Vc	235.5	406.8	219.2	393.4	220.0
In classical gates, Table 7 shows that the RBS attack is the best among known attacks. Furthermore, although the Rainbow parameter sets Ia, IIIc and Vc are designed for NIST security categories I (
), III/IV (
) and V/VI (
) in Table 1, respectively, Table 7 also shows that they do not satisfy these conditions. In quantum gates, Table 8 shows that the complexities of the RBS attack against the parameter sets Ia, IIIc and Vc are almost similar to those of the HighRank attack [8] in Table 3 (see Section 5.1 and Remark 5.2). Here, we took a linear algebra constant as  [19]. Consequently, for the complexity estimation [14] using the formula (25), a slight modification of the proposed parameter sets is required [15]. In fact, Perlner and Smith-Tone (NIST team) [27] also propose a similar theoretical value to our work and suggest the small parameter changes (see Remark 5.1), and the Rainbow designer proposes the new parameters in the NIST PQC 3rd round [15], [30]. The next paragraph shows that the actual complexity of the Wiedemann XL algorithm with an RBS dominant system may be worse than the complexity estimation using the formula (25) with 
 or 
.

The extended linearization (XL) method extends a given polynomial system by multiplying all monomials up to a target degree and generates its corresponding extended Macaulay matrix. By using this matrix, an XL algorithm solves the given system through a technique such as generating a Gröbner basis. The Wiedemann XL algorithm solves a given system by finding a specific kernel vector of an extended Macaulay matrix and uses the Wiedemann algorithm to find this vector. If the extended Macaulay matrix up to a degree is full rank,1 its kernel vector derives a unique solution to this system (see Remark 5.1). Note that this unique solution provides the Gröbner basis of degree one. However, in our experiment on scaled-down Rainbow parameters in the NIST PQC 2nd round, an extended Macaulay matrix up to 
 or 
 has a big kernel space, and the XL algorithm requires an iteration of the Wiedemann algorithm. Hence, although the complexity estimation using the formula (25) ignoring such iterations is available for estimating the minimum required complexity of the RBS attack, we further need to estimate the number of iterations to a more precise estimation for the Wiedemann XL algorithm with an RBS dominant system.

Remark 5.1

Perlner and Smith-Tone [27] introduce an XL algorithm that arranges polynomials extended from an RBS dominant system according to its bi-degree. They claim that this XL algorithm terminates within the bi-degree of the lowest term whose coefficient is non-positive in the two-variable power series (16). Since the XL algorithm generates a smaller Macaulay matrix up to the bi-degree, they improve the formula (25) and conclude that the parameter sets Ia, IIIc and Vc fall short of the claimed security levels in [14] by at least 3, 6 and 10 bits, respectively. In [3], Beullens proposes two new attacks, i.e. the Intersection attack and the Rectangular MinRank attack. The latter shows that the cost of key recovery against the parameter sets I, III and V proposed in the NIST PQC 3rd round is reduced by a factor of 
 and 255, respectively. Although quadratic systems solved in his attacks are different from the RBS dominant system, they are bi-graded. Hence we can apply our analysis to these systems and obtain an estimation for the attacks. However, for his attacks, our estimation is worse than the estimation in [3]. This is because our analysis uses only information of the bi-degree of a bi-graded system, and his analysis further utilizes a feature of bi-graded systems solved in his attacks.

Remark 5.2

We describe calculating the complexities of Table 7 and Table 8 for the RBS attack. In Table 7, for a fixed Rainbow parameter set 
, the best complexity of the RBS attack is given as the minimal value of (21) replaced (9) by (25) in the two parameters 
 of the hybrid approach. For the Rainbow parameter set Ia 
, the best complexity occurs at 
 and is given by
 
  
 
 
 where 
, 
 and 
 deduced from (20). Similarly, for the Rainbow parameter set IIIc and Vc, the complexity (25) is the minimum at 
, and 
 and 30, respectively. Note that, since 
 and the coefficient of 
 in (11) are negative, the assumptions of Theorem 4.4 and Theorem 4.5 hold. Moreover, in Table 8, we use the following formula as (25) using Grover's algorithm:(26) 
 
 
  Then the best complexity of the RBS attack in quantum gates is given as the minimal value of (22) replaced (10) by (26) in two parameters 
 of the hybrid approach. For the Rainbow parameter set Ia 
, the best complexity (22) occurs at 
 and is given by 
  Moreover, for the Rainbow parameter set IIIc and Vc, the complexity (22) is also the minimum at 
. Then the RBS attack becomes similar to the HighRank attack (see the last paragraph of Subsection 5.1).

6. Conclusion
In this article, we introduced the theoretical value 
 for estimating the complexity of Gröbner basis algorithms with bi-graded polynomial systems. Since the RBS attack recovers a secret key of Rainbow by solving a certain bi-graded polynomial system, we can utilize 
 to estimate the complexity of this attack.

According to our experiments on scaled-down Rainbow parameter sets in the NIST PQC 2nd round, the theoretical value 
 tightly approximates its solving degree than the degree of regularity 
, which has been used previously. Moreover, we proved that the relation 
 holds when the coefficient of the term of degree 
 in the one-variable power series deriving 
 is negative. We also proved that the value 
 is an upper bound for the first fall degree of a bi-graded polynomial system satisfying the condition 
 where q is the order of a field.

Furthermore, the RBS attack can reduce the bi-graded polynomial system to a linear system by using a hybrid approach with a special setting. Then this attack becomes similar to the HighRank attack. Thus, we can obtain a new complexity estimation of the RBS attack.

Applying our theoretical value to the complexity formula used in the NIST PQC 2nd round, the proposed parameter sets Ia, IIIc and Vc are solved in 2142.9, 2206.4 and 2267.4 in classical gates, respectively. Therefore, a slight modification of the parameter sets is required. However, it is not clear whether the used complexity formula is suitable for the Wiedemann XL algorithm with an RBS dominant system, and future investigations on the security of the parameter sets are needed.

The two-variable power series used for deducing the theoretical value 
 is widely available and can be extended more generally. In fact, Beullens's recent work [3] using an estimation with such a power series shows that the cost of key recovery against the new Rainbow parameter sets I, III and V in the NIST PQC 3rd round is reduced by a factor of 
 and 255, respectively. Therefore, as future work, we need to investigate such an influence on the security of several other schemes.

Appendix.
In this appendix, we provide the proofs of Theorem 4.4 and Theorem 4.5 (see [25] for details).

Let R be a commutative ring. For 
, we define an R-module homomorphism
 
 Then we denote by 
, or simply 
, the kernel of this homomorphism and its element is called a syzygy of 
. For example,
  
  where , is such an element. Here, we denote by 
 the submodule generated by the elements 
 and its element is called a Koszul syzygy.

We assume that R be a bi-graded commutative ring. For bi-graded elements 
 with 
 and the free module 
 with the standard basis 
, we denote by 
 the i-th exterior power 
 and give the Koszul complex
 by 
. Then we denote by 
 the i-th homology group of the complex. Moreover, since 
 are homogeneous, we denote by 
 the complex consisting of degree d components in 
. Then we have 
. Note that
 Define 
 as 
 for any 
. Since 
 is the mapping cone of
 we can obtain the following long exact sequence (see [9], [31]):(27) 
 

Definition A

Let ⪯ be a well-ordering on 
.

1.
For a bi-graded commutative ring 
 and two variables 
 and 
, the Hilbert series 
 of R is defined as 
 where 
 and 
.

2.
For two elements  of the formal power series ring 
, we denote 
 if the coefficients of these monomials of degree less than or equal to d with respect to ⪯ are the same.

3.
For a 
-graded module M over a 
-graded commutative ring R, i.e. it has 
 such that 
 for any 
, we put 
.

Lemma A

Let S be a graded polynomial ring and ⪯ be a well-ordering on 
 compatible with < on 
 such that  if  for 
. Let 
 be bi-graded elements such that 
. If 
, then we have 
.

Proof

It is sufficient to prove that if 
, then(28)
 Indeed, if the assertion (28) holds, the long exact sequence (27) gives the injection
 Then we have
 where 
. Thus, it follows Lemma A.

In (28), we first prove the case . Suppose that there exists the minimum 
 such that 
. Then, by 
 and 
, we obtain
 Hence we have 
 by the short exact sequence
 in the long exact sequence (27). Since 
, we have 
. Therefore 
. Similarly, we can prove the cases . □

The polynomial ring 
 is a bi-graded commutative ring with 
. Then its Hilbert series is the following:

Lemma B

For the bi-graded polynomial ring 
 with 
, we have 
.

Thus, for bi-graded polynomials 
 in S, under the assumption of Lemma A, the Hilbert series 
 is computed by(⁎)
 
 that is (16) in Definition 4.3. Note that this power series deduces the theoretical value 
.

Proposition A

For bi-graded polynomials 
, we have 
.

Proof

Consider the two-variable power series ⁎. Then, by Lemma B, there exists 
 such that 
 and 
. Thus, by Lemma A, it follows that 
. □

Now, we can prove Theorem 4.5 as follows.
Proof of Theorem 4.5

Let 
 and 
. We use the notation in Definition 4.1. Put
 Since 
, there exists
 In particular, 
 
 
. Although an element 
 for 
 is contained in 
 as generators, they do not appear since 
 by 
 and . Thus, if there exists 
, then 
 for some 
 where 
 as a representative. Namely, 
 
 Since 
 by Proposition A, we have 
. Thus, we obtain a contradiction 
. Therefore, 
, and it follows that
 □