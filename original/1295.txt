Abstract
The block reversal of a word is a generalization of the concept of reversal of a word where in place of reversing individual letters, we take the blocks of the word in the reverse order. Since there can be multiple ways in which a word can be divided into blocks, the block reversal of a word forms a set. We study some properties of the block reversal of a word. We characterize words that have the same block reversal set. We find a relation between the block reversal and the non-overlapping inversion defined by Schöniger and Waterman in the year 1992. We characterize words with the minimum and the maximum number of elements in the block reversal. We then study the distribution of palindromes in the block reversal of a word.

Keywords
Block reversal
Combinatorics of words
Palindromes
Conjugates
Non-overlapping inversion

1. Introduction
The reversal and the conjugate of a word are very basic and important concepts in combinatorics of words. A word is a reversal of another word if it is the mirror image of the other. Two words are said to be conjugates of each other if one is a cyclic shift of the other. Several authors have studied the conjugacy class of a given word or a language (see [13], [21], [22], [23]). In this paper, we extend these two concepts and define the concept of the block reversal of a given word. Here, a word is decomposed into blocks or factors instead of letters and to obtain the block reversal, the blocks are written in the reverse order.

Given two strings 
 and 
 and a reversal operation, one of an interesting problem is to take contiguous substrings of 
, reverse them and incorporate them back in the same position in 
. The substring thus chosen is called a block. The combinatorial problem is to perform a series of such block reversal operations on 
 and reach 
. The minimum number of such reversals is called the reversal distance. This is known as SBR (sorting by block reversal problem) and is an NP-hard problem [4]. Unlike the SBR problem, we look in for the segmentation of a string 
 into blocks and form a new set of strings, say S, by reversing the order of the blocks. We do this on two perspectives. First is to identify a method that picks the strings of desired nature. The data in the set S are to be analysed for this purpose. Second is to look in for some sub problem to SBR so that in special cases, SBR is tractable. For this one has to look for several mathematical/combinatorial manipulations of the set S. In this paper, we try to explore the mathematical/combinatorial properties that may help in understanding SBR. We are interested in the rearrangement of a string by the means of a ‘block reversal’. The block reversal of a word is a new operation introduced in the literature of combinatorics of words. Here, a given word is segmented into blocks or contiguous factors, and then, the segmented blocks are written in the reverse order. When the number of blocks is two, one obtains a conjugate of the given word. The block reversal operation of a word w, denoted by , is represented in Fig. 1.

Fig. 1
Download : Download high-res image (14KB)
Download : Download full-size image
Fig. 1. For w ∈ Σ⁎, w′ ∈ BR(w).

Another concept of rearrangement of a string happens through inversions (or reversals), in particular a non-overlapping inversion. A non-overlapping inversion of a word is a set of strings, where a given string is segmented into contiguous blocks, and then, each block is either replaced with itself or its reverse in the same position. A simplest form of a non-overlapping inversion is represented in Fig. 2 where 
 represents substrings of w and 
 represents the reverse of the substring 
.

Fig. 2
Download : Download high-res image (9KB)
Download : Download full-size image
Fig. 2. For w ∈ Σ⁎, w′ is a non-overlapping inversion of w.

In 1992, Schöniger and Waterman proposed the simplification hypothesis that the inversions do not overlap ([25]). They presented an (
) exact solution for the alignment with the non-overlapping inversion problem. Instances of problems considering non-overlapping inversions include the string alignment problem, the edit distance problem, the approximate matching problem, etc. ([2], [3], [15], [29]). The shared characteristics of biological sequences can be revealed by aligning the sequences ([5], [6], [29]). In [1], the authors presented an algorithm for the approximate string matching problem that allow for the non-overlapping inversions with worst-case time complexity (nm) for a sequence of size n and a pattern of size m. The authors in [28] investigated the minimum number of non-overlapping inversions and transposition operations used to transform one string into the other. They presented an (
) time and (
) space algorithm to compute the mutation distance of two strings of length n. Recently, using techniques of genetic algorithms and local search, heuristics has been given in [27] to study the reversal distance between genomes with duplicated genes.

The authors in [16] studied the non-overlapping inversion on strings from a formal language theoretic approach. They defined the non-overlapping inversion operation to be the computation of all possible non-overlapping inversions and constructed an Non deterministic Finite state automaton recognizing the set. They also considered iterative non-overlapping inversions operation on a language. We show in this paper that the block reversal of a string is closely related to the non-overlapping inversions of a string.

In this paper, we study some combinatorial aspects of this operation. We show that the set of all conjugates of a word is a proper subset of this set. We find a relation between the block reversal and the non-overlapping inversion of a given word w. We characterize words u and v such that their block reversals are the same. We also characterize words that give the maximum and the minimum number of elements in the block reversal. We finally find the maximum number of palindromes in the block reversal of any given word.

The paper is organised as follows. Section 3 contains the definition of the block reversal and the strict block reversal of a word. We also investigate some properties of the block reversal of a word. We find the relation between the block reversal and the non-overlapping inversion operation in Section 4. The upper and lower bounds on the number of elements in the block reversal are studied in Section 5. Finally, in Section 6, we study the distribution of palindromes in the block reversal of a word. We end the paper with a few concluding remarks.

2. Basic definitions and notations
Let Σ be a finite alphabet. A word 
 over Σ is a finite sequence of letters from Σ where 
 is the i-th letter of w. We denote the empty word by λ. By 
⁎
, we denote the set of all words over Σ and 
⁎
. The length of a word w, denoted by , is the number of letters in w. 
 denotes the set of all words over Σ of length n. For , 
 denotes the number of occurrences of a in w. The word u is a factor of w if there are words α and β such that . If the word α (resp. β) is empty, then u is also called a prefix (resp. suffix) of w. Let  denote the set of all factors of the word w.  is set of all letters in w. For a word 
 such that 
, the reversal of w, denoted by 
, is the word 
. A word w is a palindrome if 
. Two words u and v are called conjugates of each other if there exists 
⁎
 such that  and  and  denotes the set of all conjugates of w. A word 
⁎
 is called primitive if it is not a power of another word, i.e., w is primitive if and only if 
 with  and 
⁎
 implies . Every word w over Σ has a unique encoding of the form 
, where 
, 
 and 
 for all i. This encoding is called run-length encoding of w ([9]). The word 
 is called the trace of w. The sequence 
 is called the run sequence of w and the length of the run sequence of w is k. For a positive integer n, the partition  of 
 is an expression of n as the sum of one or more positive integers. The partition is said to be palindromic if the sequence 
 forms a palindrome.

A language L over Σ is a subset of 
⁎
. The conjugate of a language L, denoted by , is defined as  
  and the reverse of a language L, denoted by 
, is defined as 
 
.

For more information on words and languages, the reader is referred to [18], [26].

3. Block reversal of a word
It can be observed that the elements in the conjugacy class are formed by taking the blocks x and y of  in the reverse order. The concepts of the conjugacy class of words have been extensively studied in [8], [10], [17]. The reverse of a word of length n is the word formed by partitioning the word into n non-empty blocks and writing them in the reverse order. In this section, we consider the partition of w into t non-empty blocks, where , and define the terms block reversal and strict block reversal of a word. We later discuss some properties of the block reversal of a given word. The block reversal of a word is a generalisation of the concept of the reversal of a word where in place of reversing individual letters, we consider the blocks of the word in the reverse order. It is formally defined as follows:

Definition 3.1

Let 
 for all i. The block reversal of w, denoted by , is the set

For 
, let 
 for 
, then the partition  corresponding to 
 is 
, and we say that 
 corresponds to the partition . Note that a word w can be divided into a maximum of  blocks.
A subset of the set  where we consider the words having the reversal of at least two non-empty blocks is called strict block reversal. We have the following definition.

Definition 3.2

Let 
 for all i. The strict block reversal of w, denoted by , is the set

The following are two simple examples that illustrate the above definitions.

Example 3.3

Let . Consider  over Σ. Then, and

Example 3.4

Let . Consider  over Σ. Then,

Note that in Example 3.3,  but the word u in Example 3.4 is present in its strict block reversal. Hence, a word may or may not belong to its strict block reversal.
The definition of the block reversal of a word can be naturally extended to a language. We now define the block reversal of a language.

Definition 3.5

For 
⁎
, the block reversal of L, denoted by , is defined as 
 

The iterated block reversal of a word and a language are defined below.

Definition 3.6

For a word w and a language L, we define 
 recursively as:
 and 
 recursively as
 
 Then, we define 
⁎
 
 and 
⁎
 
.

We illustrate Definition 3.5, Definition 3.6 with the help of an example.
Example 3.7

Let . Then, and
 Note that 
, for , and
⁎

We now discuss some properties of the block reversal of a given word. A word u is a scattered palindrome of w if it is a subsequence of w as well as a palindrome. Several authors have studied reconstruction of words by the set of its scattered factors or palindromes (see [12], [14], [24]). Since the conjugacy relation is an equivalence relation, if , we have,  for 
⁎
. We provide an iterated relation for the block reversal of a word and use it to find a characterization of words that have the same block reversal.

We recall some results from [19].

Lemma 3.8

[19] Let 
.

•
If , then u and v are the powers of a common primitive word.

•
If , then for , 
 and 
⁎
, , 
, .

A word  is a non-trivial conjugate of a word  if both 
. Let 
 denote the set of all non-trivial conjugates of the word w. Note that 
. For a word w, 
 if and only if  for 
⁎
. Then, by Lemma 3.8, 
 for some primitive word z and . We find a necessary and sufficient condition such that  for a word w, i.e., .
We recall the definition of a block palindrome from [7].

Definition 3.9

[7] Let w be a word over a finite alphabet Σ. If w is of the form
 where 
 and 
, for , and 
⁎
 is the center block, then w is called a block palindrome.

Note that the block 
 in Definition 3.9 may not be a palindrome and the representation of a word as a block palindrome may not be unique. Also, a palindrome is a block palindrome where each block is a letter but the converse is not true. For example, the word  is a block palindrome but not a palindrome.

It is clear from Definition 3.9 that w is a block palindrome if there exists a  such that . Hence, for a given word 
, we prove that , i.e.,  if and only if w is a block palindrome.

Theorem 3.10

For 
,  if and only if w is a block palindrome.

Proof

Let . Then, there exists 
 for  such that 
 where . Without loss of generality (WLOG), let 
. Thus, 
 for some 
⁎
. We have, 
 where 
. Hence, w is a block palindrome.

Conversely, let w be a block palindrome, then
 where 
 such that 
 for . Since, 
, then . □

Thus, for a word 
,  if and only if w is a block palindrome. We now find a relation between  and  for words u and v that will be used later in the paper.
Lemma 3.11

 for 
⁎
.

Proof

Let . Then, 
 where 
 and 
 which implies 
, i.e., . Hence, . □

We have an immediate result to Lemma 3.11.
Corollary 3.12

For 
 where 
 and , we have,

We show that  may not be a subset of . Consider, for example,  and . Here,  but . Note that for a different decomposition of  into 
 and 
, we have 
.

Thus, we give an iterative relation for the block reversal of a word using Lemma 3.11.

Lemma 3.13

Let 
⁎
 and 
. Then,

1.
  
 .

2.
  
 .

3.
  
 .

Proof

We prove that  
  and the other statements can be similarly proved. Let  
 , and let 
 where 
 for 
 and integer k. We have the following cases:

•
If , then 
. So, 
.

•
If , let 
 and 
. Then, . Now, 
 and 
. Thus, 
, i.e., 
 which implies 
.

Hence, .
Consider  for 
. Note that  and from Lemma 3.11, we have, . Thus, , and hence, the result follows. □

It is easy to verify that 
. We now prove that the reverse of the block reversal of a word is equal to the block reversal of the reverse of the word.

Lemma 3.14

Let 
, 
.

Proof

If , then 
 where 
 for 
. Now, 
 and 
. Thus, 
 and 
.

Conversely, let 
. Then, 
 where 
. Now, 
 which implies 
, i.e., 
. Thus, 
.

Hence, 
. □

It can be observed that if  for 
⁎
, then . The following are some simple facts about the block reversal of a word.

Observation 3.15

For 
⁎
, if , then 
 for all .

We now show that if  for , then  for words u and v.

Lemma 3.16

If  for , then  for words u and v.

Proof

Let  for 
⁎
. Then, by Observation 3.15, we get, 
 for all . Assume to the contrary that . WLOG, let 
. Consider the word 
. Since, 
, we get, 
. We have the following cases:

•
If 
, then 
 implies 
 which is a contradiction.

•
If 
, then since, 
, we get, 
 where 
 for 
 and some k. This implies a is a prefix and suffix of 
. If 
, then 
 which is a contradiction. Thus, 
 where 
⁎
. Consider 
 where 
, 
, 
. We get, 
 which implies 
, i.e., 
, which is a contradiction.

Hence, . □
Similarly, if , then . Note that Lemma 3.16 do not hold for the conjugacy relation. For example, consider  and . Then,  but . We now characterize words that have the same block reversal. It was proved in [12] that if the set of the scattered palindromes of two binary words u and v is the same, then either  or 
. We have the following result for words with the same block reversal.

Theorem 3.17

Let 
⁎
. Then,  if and only if one of the following holds:

•
;

•
 and ;

•
 and  for  and .

Proof

We prove the result by induction on . The proof is trivial when . For , one can easily verify that if , then 
 or  and . For , one can show that either  or 
 or  and . Also, for , one can verify that if , then either  or ,  or 
,  where . We assume that the result holds for . Let 
 and 
 be such that  and  where 
, . Note that by Lemma 3.13 and for 
, we have, 
  Then, for 
, 
 and for 
  and
  we have,  and 
. We have the following cases:

Case 1:
If 
 then
 and by Lemma 3.16, we have,
 and the proof follows by induction.

Case 2:
If 
, then 
 and 
. Thus, 
 for all  and 
 for all . Since, 
, 
 which implies that 
 for at least one i and one j such that  and . Thus, 
 for some .

The converse is straightforward and can be verified directly. □
4. Relation between block reversal and non-overlapping inversion
The non-overlapping inversion, defined in [25], of a word is a set of inversions that do not overlap with each other. In this section, we give a relation between the non-overlapping inversion operation and the block reversal of a finite word. We recall the definition of the non-overlapping inversion operation of a finite word from [16].

For 
⁎
, the non-overlapping inversion of w, denoted by , is defined as:
⁎
 We observe that for the word  over ,

We give a relation between the non-overlapping inversion and the block reversal of a word.

Theorem 4.1

For a word w, 
.

Proof

For 
 where 
⁎
, 
 is equal to
⁎
 Let 
. Then, for some t, 
 where 
, i.e., 
. From Definition 3.1, 
 for a word u, where 
 is either 
 or u. For 
, from Corollary 3.12, we have,(1)
 Let 
 be either 
 or 
. Since, 
, from Eq. (1), we have, 
, i.e., . Thus, 
.

Conversely, let . Then, 
 for 
 where 
. Now, 
, and 
. Thus, 
.

Hence, for a word w, 
. □

From Lemma 3.14 and Theorem 4.1, we have the following:

Lemma 4.2

For 
, 
.

We have the following result, which gives a characterization of words w such that . We use the fact (Theorem 4.1) that 
.

Theorem 4.3

For a given 
,  if and only if one of the following holds:

•
w is a palindrome;

•
,  and .

In [16], it was proved that  is closed under regular and context-sensitive languages but not under context-free. By Theorem 4.1, we conclude the following:

•
If L is regular, then  is regular.

•
If L is context-sensitive, then  is context-sensitive.

•
Context-free languages are not closed under the block reversal.

We have the following result, the proof of which follows from Lemma 3.14 and Theorem 4.1.

Lemma 4.4

For 
⁎
, the following are true.

1.
.

2.
.

Using Lemma 3.11, we deduce the following:

Lemma 4.5

Let 
 and 
 be languages such that 
. Then, 
.

Given a word w, let  denote the set of all permutations of w, i.e., 
⁎
. We observe the following.

Remark 4.6

For a word w and all , we have, 
.

We prove that the iterated block reversal operation is equivalent to the permutation operation. We prove the following using Lemma 3.11, Lemma 4.5.
Theorem 4.7

Let 
. Then, 
 where  denotes the set of all permutations of w.

Proof

We first prove that 
 by induction on n. For , 
. Let this be true for all words 
 of length less than n. We prove the result for 
 of length n where 
. Consider 
 to be an arbitrary element of  where 
. Then, 
 for 
⁎
. Let 
 and 
. Then, both . Since, , by induction 
. So, 
. Then,
 Thus, we get, 
 for all even values of j. Since, 
, we have, 
. Also,
 Thus, we get, 
 for all odd values of k. Since, 
, we have, 
. We have two cases:

•
For n even, 
. Here, , and thus, we get, 
. This implies, 
 for n even.

•
For n odd, 
. Here, , and thus, we get, 
. This implies, 
 for n odd.

Thus, 
. Now, by Remark 4.6, we have, 
. Therefore, 
. □
We illustrate that the smallest i such that 
 or 
 may or may not be equal to  with the help of the following example.

Example 4.8

For , consider 
 and 
. We have,
 and

By Theorem 4.7, we conclude the following:

Corollary 4.9

If L is a finite language, then 
⁎
 where .

It can also be observed from Corollary 4.9 that if L is finite, then 
, for , is finite. Also, as 
, then if 
 is finite, then L is finite. This implies L is finite if and only if 
 is finite for .
Using Lemma 4.4, the following can be deduced by induction on k, and the proof is omitted.

Lemma 4.10

For a word w, 
 for .

Using Lemma 3.14, Lemma 4.4, Lemma 4.10 and Theorem 4.1, we have the following result.

Proposition 4.11

Let w be a word, then for ,

1.

2.

Proof

We prove the result by strong induction on k. We first discuss the case . Consider
 Similarly, we have, 
. Thus, the result is true for . Let 
 and 
 for . We have, 
. Then, by induction, we get, 
. Now, from Lemma 4.4, we have,
 Then, by Lemma 4.10, 
. Similarly, 
. Thus, by induction, we are done. □

The authors in [16] proved that 
 where . From Theorem 4.7 and Proposition 4.11, we have the following:
Proposition 4.12

Let 
, then 
 where  denotes the set of all permutations of w.

It is also clear from Example 4.8 that the smallest i such that 
 may or may not be equal to .

We now show that regular and context-free languages are not closed under the iterated block reversal. Consider the following example.

Example 4.13

Consider a regular language 
⁎
. Since, 
⁎
,
⁎
⁎
 Then, 
⁎
⁎
⁎
⁎
, which is not context-free.

Since the regular languages and the context free languages are closed under intersection with regular languages, we conclude the following:
Lemma 4.14

Regular and context-free languages are not closed under 
⁎
.

5. Bounds on the number of elements in the block reversal
It is well known that the minimum number of elements in the conjugacy class occurs when the word is unary and the maximum number of elements in the conjugacy class occurs when the word is primitive [26]. In this section, we count the minimum and the maximum number of elements in the block reversal of a word and we also give a characterization of such words for which the bounds are achieved.

It is clear from Definition 3.1 that , so, . The minimum number of elements in  for 
 is 1 and the bound is achieved when . Also, a word w can be divided into i non-empty blocks, where , in  
  distinct ways. Thus, 
  
  
 

Therefore, we conclude the following:

Proposition 5.1

Let 
, then 
.

We now give a characterization of words that achieve the bounds in Proposition 5.1, i.e., words w that have 
 elements in the block reversal. We first prove the following:
Proposition 5.2

Let 
 and . Then, 
 if and only if .

Proof

Let 
 and  such that 
. Let  and 
. Then,  for some 
⁎
. For 
, 
 and 
, we get, 
. Also, for 
, 
, 
, 
, 
, we get, 
. Since, 
, then 
, which is a contradiction. Thus, for each , 
, i.e, . For the converse, consider a word w such that for each , 
. Such a word w can be divided into i non-empty blocks for  in  
  distinct ways. Since all letters in w are distinct, the block reversal of such a word contains 
 
 elements. Hence, the proof. □

We now characterize words that achieve the lower bound in Proposition 5.1. For 
 such that , one can easily observe that  and 
. We know that if 
, then 
. Thus, 
 for , where 
, which implies that x and y are two non-empty palindromes. Hence, we have the following result.
Remark 5.3

If 
, then w is the product of two non-empty palindromes.

Thus, we conclude from Remark 5.3 that if 
, then w is the product of two non-empty palindromes. The converse of Remark 5.3 is not true. The word  is the product of two non-empty palindromes. But 
 as 
. We give a necessary and sufficient condition for 
. We first prove the following:
Lemma 5.4

If 
, where 
, and 
 for  such that w is the product of two non-empty palindromes, then 
.

Proof

Let 
, where 
, and 
 for , such that w is the product of two non-empty palindromes. Thus,  where u and v are two non-empty palindromes. Since, , the length of run sequence of either u or v is greater than 1. WLOG, assume that the length of the run sequence of the palindrome u is greater than 1 which implies there exists an index  such that 
. We have the following cases:

1.
: Let 
 be the maximum among all powers of 
 in w. Then,
 We show that 
. Assume to the contrary that 
 for . Then, we have the following cases:

•
If 
 for 
, then 
. We get,
 which is a contradiction as 
.

•
If 
, then 
 where 
. We get,
 which is a contradiction to the fact that 
 is the maximum power of 
 in w.

Thus, 
.
2.
: If there exists a l such that  such that 
, then let 
 be the maximum among all powers of 
 in w. Then, 
. Let 
 and 
. Then,
 We show that 
. Assume to the contrary that 
 for 
. Note that w starts with 
 and ends with 
. Since 
 starts with 
 and ends with 
 where 
 and 
, we have, 
 and 
 where 
. Note that the maximum power of 
 in 
 is 
, but 
 is the maximum power of 
 in 
. Thus, 
.

Otherwise, there is no such index l such that 
 for . Since, 
, w is a block palindrome. Then, by Theorem 3.10, . If 
, then by Lemma 3.8, 
 and 
⁎
 which is a contradiction to the fact that the length of the run sequence of u is greater than 1 and 
 for . So, 
.

Thus, 
. Hence, the proof. □
We now prove that 
 if and only if w is of the form 
 or 
.

Proposition 5.5

For 
, 
 if and only if w is of the form 
 or 
 where , .

Proof

We first prove that if w is not of the form 
 and 
, then 
. Assume w is not of the form 
 and 
, then w is either of the form 
 for 
,  or 
 where 
, 
 for . We have the following cases:

•
If 
 for 
, and , then
 Since, 
, we have, 
. So, 
.

•
If 
, where 
, and 
 for , then we have the following cases:

–
If 
, then 
.

–
If 
, then by Remark 5.3, w is the product of two non-empty palindromes. By Lemma 5.4, 
.

To prove the converse, we use the fact that 
. Let 
. The case when  is trivial, hence, we assume . Consider 
 where 
 and . Then, 
 and 
 for 
 such that 
. Note that 
. Hence, 
. The case when 
 is similar. Hence, done. □

We now have the following results similar to that of Remark 5.3 and Proposition 5.5 for the set . If 
, then 
 is either equal to w or equal to a non-trivial conjugate of w. This implies that w is either a palindrome or by Remark 5.3, a product of two non-empty palindromes. We conclude the following:

Remark 5.6

If 
, then w is either a palindrome or a product of two non-empty palindromes.

We know that if , then 
. Thus, we conclude from Remark 5.6 that if , then w is either a palindrome or a product of two non-empty palindromes. However, the converse is not true. For example, consider the palindrome . Then,  as . Also, for 
, which is the product of two non-empty palindromes,  as 
.
We now recall the following result from [26].

Lemma 5.7

[26] Let 
 for a primitive word z over Σ. Then, the conjugacy class of u contains exactly  words.

The word w where 
 for all  is primitive and has 
 elements in . We show by example that a primitive word w may not have 
 elements in .
Example 5.8

Consider a primitive word . Then,  and .

We infer by Proposition 5.1 that a primitive word w may or may not have the maximum number of elements, i.e., 
 elements in the block reversal.
For a word w, we now give a necessary and sufficient condition such that . We first prove the following.

Lemma 5.9

If 
, where 
, and 
 for  such that w is the product of two non-empty palindromes, then .

Proof

Let 
, where 
, and 
 for , such that w is the product of two non-empty palindromes. Thus,  where u and v are two non-empty palindromes. Since, , the length of run sequence of either u or v is greater than 1. WLOG, assume that the length of the run sequence of the palindrome u is greater than 1 which implies there exists an index  such that 
. We have the following cases:

1.
.

2.
 and there is an index l for  such that 
.

3.
 and there is no index l for  such that 
.

We only discuss the case when 
 and there is no index l for  such that 
. The other two cases are similar to that of the proof given in Lemma 5.4.
Let 
 and let there be no index l such that 
 for . We show that 
. Because, the length of the run sequence of the palindrome u is greater than 1, 
 for 
⁎
. Since, 
 for  and 
, we get, 
 and 
. Since, , we get, 
 where 
 is a palindrome. Also,  implies there exists a letter 
 such that 
. Let

We show that 
. Assume to the contrary that 
 for . As 
, 
. Since w ends with 
 and 
, we have, 
 for 
. Also, 
 for 
⁎
. Now,  implies 
, which is a contradiction to the fact that 
 is the maximum power of 
 in w. Thus, 
. Hence, . □

We now characterize words w such that .

Theorem 5.10

For 
⁎
,  if and only if 
 where  and .

Proof

Suppose, 
 for . We prove that . Let 
 for each i. We have the following forms of w in its run-length encoding:

1.
If 
, for 
, then by Proposition 5.5, 
. Since 
, w is not a block palindrome and by Theorem 3.10, , and thus, .

2.
If 
, 
, then 
, where 
, and hence, .

3.
If 
, where , then if 
, then . If 
, then by Remark 5.6, we have the following cases:

(a)
If w is a product of two non-empty palindromes, then by Lemma 5.9, .

(b)
If w is a palindrome, then 
 and 
 for all j such that . Let 
 be the maximum among all powers of 
 in w. Then 
.

•
: Then . Let 
 and 
. Then,
 We show that 
. Assume to the contrary that 
 for . Note that w starts and ends with 
. Since 
 starts with 
 and ends with 
 where 
 and 
, we have, 
 and 
 where 
. Then the maximum power of 
 in yx is 
, but, 
 is the maximum power of 
 in 
. Thus, 
.

•
: Since  and w is a palindrome, we have 
 where 
 and 
 such that 
. Then,

We show that 
. Assume to the contrary that 
 for 
. Since 
, both 
 and 
.

–
If 
, then 
 for 
. So, 
 implies 
, which is a contradiction to the fact that 
 is the maximum power of 
 in w.

–
If 
 for 
, then 
 where 
. So, 
, which is a contradiction to the fact that 
 is the maximum power of 
 in w. Thus, 
.

Thus, in both the cases, .

We now prove the converse. Given that 
 for  and . For , it is clear that . Let . We know that  for a word 
. We now prove that . Note that any element in  is of the form 
 where . So,  contains  distinct elements. Note that w is primitive and by Lemma 5.7,  contains  distinct elements. As , we have, . Thus, .
Hence, done. □

Hence, the words that achieve the lower bound in Proposition 5.1 are of the form 
 where  and . We also conclude the following:
Corollary 5.11

For a word w such that , .

6. Palindromes in a block reversal set
In [8], the authors have proved that the maximum number of palindromes in the conjugacy class of a word 
, where z is primitive and , is either 0 or 1, if  is odd and 0 or 2, if  is even. In [20], the authors discussed the distribution of θ-palindromes (where θ is an antimorphic involution) in the conjugacy class and the set of θ-conjugates of the word. In this section, we discuss the distribution of palindromes in the block reversal of a word. We first find a characterization of words such that all elements in its block reversal are palindromes. We then find the maximum number of palindromes in the block reversal of a word. We give an upper bound on the number of palindromes in the block reversal of a word that is not a palindrome and a tight bound on the number of palindromes in the block reversal of a word that is a palindrome.

We first observe that if w is a palindrome, then all elements of  may not be palindromes. Consider for example, . Then, , is not a palindrome. We now provide a necessary and sufficient condition under which all elements in  for a word w are palindromes.

Proposition 6.1

All elements of the block reversal of a word w are palindromes if and only if 
 for .

Proof

Let 
 be a word where 
,  and all elements of  be palindromes. Since, , all elements of  are also palindromes. Note that
 where 
. As each 
 is a palindrome, this implies 
 for . We get, 
 for . Thus, 
 for some . The converse is straight forward. □

We now find the maximum number of palindromes in the block reversal of a word w. We observe the following for a non-palindromic word.
Proposition 6.2

If w is not a palindrome, then there does not exist any palindrome in  corresponding to a palindromic partition of .

Proof

Let w be non-palindromic word. Assume to the contrary that there is a palindrome 
 corresponding to a palindromic partition 
 of . We have, 
 where 
 and 
. Also, 
 for . Since 
 is a palindrome, 
 for . This implies that w is a palindrome which is a contradiction. □

Let 
⁎
 such that w is not a palindrome. We now illustrate with an example that there exists an  such that x is a palindrome and x corresponds to a non palindromic partition of w.
Example 6.3

Let . Then, .

There are only two palindromes  and  in  corresponding to non-palindromic partitions  and , respectively.

We know that the total number of partitions of an integer n is 
. Also, from [11], we have the following:
Theorem 6.4

[11]

•
The number of palindromic partitions of n is 
 
.

•
The number of palindromic partitions of n with

–
 parts equals  
 
 .

–
2k parts equals  
 
 .

It can be observed from Proposition 6.2 that if w is not a palindrome, then there does not exist any palindrome in  corresponding to a palindromic partition of . Then, we have the following result that follows from Theorem 6.4.
Theorem 6.5

Let w be a non-palindrome of length n. Then, the maximum number of palindromes in  is 
 
.

We now count the maximum number of palindromes in the block reversal of a palindrome. From the definition of the block reversal of a word, one can observe the following:
Remark 6.6

For a palindrome w, all elements of  corresponding to palindromic partitions of  are palindromes.

Let w be such that  is even. If 
 
, then  cannot contain any palindrome. There are also words with 
 
 such that the set  does not contain any palindrome. Consider for example, . One can easily verify that  does not contain any palindrome. So, 
 
 is not sufficient but a necessary condition for the occurrence of palindromes in . We have the following result for a palindrome.

Lemma 6.7

Let w be a palindrome of length n.

•
For n even and 
 
, if  such that u corresponds to a non-palindromic partition of n, then u is not a palindrome.

•
For n odd and 
 
, if  such that u corresponds to a non-palindromic partition of n, then u is not a palindrome.

Proof

Let 
 be a palindrome of length n such that 
⁎
 and n is even with 
 
. This implies that  and all factors of y are distinct. Assume to the contrary that 
 is a non-palindromic partition of n such that 
 is a palindrome where 
, 
 and 
 for each j. Let i be the least index such that 
. Since, 
 is a non-palindromic partition such an index i always exists. WLOG, assume that 
. Now, as 
 is a palindrome, 
 for some 
. Then, 
. As w is also a palindrome, 
 for some 
. Thus, 
. We have the following cases:

•
Let 
, then 
. This implies 
 is not a prefix and suffix of 
 which is a contradiction.

•
Let 
. Then, 
 and for some 
, we have, 
 where , 
. Since u is a palindrome, we get, 
 is a palindrome and, 
. Then, 
. Now, 
 and 
 is a prefix and suffix of 
, we have the following cases:

–
If 
, then 
 for some 
⁎
. Thus, 
 and 
 both occur in 
, which contradicts the fact that .

–
If 
, then 
 for some 
. This implies 
. Since, 
, β and 
 both occur in 
 which contradicts the fact that .

Hence, the result holds. The case when n is odd is similar, and the proof is omitted. □
We observe the following:
Observation 6.8

Consider 
 and 
 to be palindromic partitions n and  times) of n. Let w be a palindrome of length n. Then, corresponding to both 
 and 
, we get .

Let w be a palindrome of even length. From Remark 6.6, we conclude that corresponding to a palindromic partition of , we get a palindrome in . Also, by Lemma 6.7, we conclude that if 
 
, then every palindrome in the block reversal of w corresponds to a palindromic partition of . Therefore, from Remark 6.6, Lemma 6.7, and Theorem 6.4, we have the following lemma.
Proposition 6.9

Let w be a palindrome of length n.

•
For n even and 
 
, the total number of palindromes in  is 
 
.

•
For n odd and 
 
, the total number of palindromes in  is 
 
.

Proof

We have two cases:

•
Let w be a palindrome of length n such that n is even with 
 
. Then, by Lemma 6.7, every palindrome in the block reversal of w corresponds to a palindromic partition of n. Let  be a palindrome corresponding to a palindromic partition 
 of n with odd number of parts where 
 
. Since n is even, 
 is also even. Then, by Observation 6.8, u also corresponds to the palindromic partition 
 of n. This implies that u corresponds to a palindromic partition of n with even number of parts. Thus, every palindrome in the block reversal of  corresponds to a palindromic partition of  with even number of parts. Then, by Remark 6.6 and Theorem 6.4, the total number of palindromes in  is 
 
 
 
 
.

•
Let w be a palindrome of odd length n with 
 
 and  be a palindrome. Then, by Lemma 6.7, u corresponds to a palindromic partition of n. Since, 
 
, there is a letter that occurs exactly once in u and occurs at the middle position of u. This implies u corresponds to a palindromic partition of the form 
 of n where 
 
. As the total number of partitions of 
 
 is 
 
, by Remark 6.6, the total number of palindromes in  is 
 
. □

We now prove that for a palindrome w of length n and a palindrome 
, there exists a palindromic partition  of n such that 
 corresponds to . We first illustrate this with the help of an example.

Example 6.10

Let  be a palindrome of length 12. Then, corresponding to the non-palindromic partition  of , we get, 
 which is a palindrome. Note that 
 also corresponds to the palindromic partition  of 12.

Let w be a palindrome of length n. We prove that for each palindrome 
, there exists a palindromic partition  of n such that 
 corresponds to  in the following.
Lemma 6.11

Let w be an palindrome of length n and 
 be a palindrome in  corresponding to a non-palindromic partition  of n, then there exists a palindromic partition 
 of n which gives 
.

Proof

We prove this by induction on n. One can easily verify the base case for . Let the statement be true for all words of length less than n. Let  and 
 be a palindrome in  corresponding to a non-palindromic partition 
 of n. Then, 
 where 
 and 
. Since w and 
 are palindromes, we have,(2)
 and(3)
 As 
 is a non-palindromic partition of n, there exists an index t such that 
. Let i be the least index such that 
. Then, we have the following cases:

•
: Then, 
. WLOG, assume that 
. Then, from Eqs. (2) and (3), we have, 
 and 
 for 
⁎
. Thus, 
. Then, by Lemma 3.8, 
 for 
⁎
,  and . Now, 
 and 
 implies 
. Note that 
 is a palindrome, since 
 is a palindrome. Similarly, 
 is a palindrome since, 
 is a palindrome. Note that 
, i.e., . Since, , by induction, there exists a palindromic partition 
 of  that gives v. Let 
 be the palindromic partition 
. Thus, 
 corresponds to the palindromic partition 
 of n.

•
: Let 
 and 
. Then,
 and
 Here, 
. Since, 
, by induction, there exists a palindromic partition 
 of 
 which gives 
. Let 
 be the palindromic partition 
. Thus, 
 corresponding to the palindromic partition 
 of n.

Hence, in both cases, we are done. □
We have the following result.

Lemma 6.12

Let w be a word of length n such that . Then, there exists a word 
 of length n with 
 such that 
.

Proof

Let w be a word of length n with . Then, there exists at least one letter a such that 
. Let  for 
⁎
 such that 
. Take 
 for  such that 
. Now, 
. Let 
 and 
 be two distinct elements of  such that 
 and 
 correspond to the partitions 
 and 
 respectively. Since, 
 and 
, then corresponding to 
 and 
, we will get two distinct elements in 
. As 
 are arbitrary, we have, 
. Now, corresponding to the partitions  and  of n, we get the same element  in , but we get two distinct elements  and , respectively, in 
. Thus, 
. □

Let 
 denote the total number of palindromes in . We have the following:

Lemma 6.13

Let w be a palindrome of length n.

•
For n even and 
 
, there exists a palindrome 
 of length n with 
 such that 
.

•
For n odd, 
, where  and 
⁎
, , there exists a palindrome 
 with 
 such that 
.

Proof

Let w be a palindrome of length n. We consider the case when n is even. The case when n is odd is similar, and the proof is omitted. Then, 
 for some 
⁎
. As 
 
, there exists a letter b such that 
. Let  such that 
. Assume, 
 where 
 and 
. Then, 
 and from Lemma 6.12, 
. Since, 
, for any partition of , we get a palindromic partition of 
. Also, from Lemma 6.11, we know that each palindrome in  corresponds to a palindromic partition of n. Therefore, 
. □

We conclude the following from Proposition 6.9 and Lemma 6.13 for a palindrome.

Theorem 6.14

Let w be a palindrome of length n. Then,

•
For n even, 
 
. The bound is achieved only if 
 
.

•
For n odd, 
, where  and 
⁎
, 
 
. The bound is achieved only if .

7. Conclusions
In this paper, we have considered the block reversal operation on finite words. We have shown that the non-overlapping inversion of a string can be obtained using the block reversal operation. Hence, the block reversal operation is an important operation for bio-sequences as the number of operations performed to obtain  is comparatively less than . We have witnessed some properties of the block reversal of a word and characterized words having the same block reversal. We also have provided the minimum and the maximum number of elements in the block reversal set. We have characterized the words that achieve the minimum and the maximum bounds. Finally, we have investigated the maximum number of palindromes in the block reversal of a word. It was shown that the iterated block reversal of a word gives the set of all permutations of the word. However, it would be interesting to characterize words w such that 
 but 
 for . From the formal language theoretic point of view, it would also be interesting if we impose restrictions on either the length of the blocks or the number of blocks.