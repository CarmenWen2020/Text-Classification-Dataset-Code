Motivated by the connectivity problem in wireless networks with directional antennas, we study bounded-angle spanning trees. Let P be a set of points in the plane and let ğ›¼ be an angle. An ğ›¼-ST of P is a spanning tree of the complete Euclidean graph on P with the property that all edges incident to each point ğ‘âˆˆğ‘ƒ lie in a wedge of angle ğ›¼ centered at p. We study the following closely related problems for ğ›¼=2ğœ‹/3 (however, our approximation ratios hold for any ğ›¼â©¾2ğœ‹/3).

1.
The ğ›¼-minimum spanning tree problem asks for an ğ›¼-ST of minimum sum of edge lengths. Among many interesting results, Aschner and Katz (ICALP 2014) proved the NP-hardness of this problem and presented a 6-approximation algorithm. Their algorithm finds an ğ›¼-ST of length at most 6 times the length of the minimum spanning tree (MST). By adapting a somewhat similar approach and using different proof techniques we improve this ratio to 16/3.

2.
To examine what is possible with non-uniform wedge angles, we define an ğ›¼â¯â¯â¯-ST to be a spanning tree with the property that incident edges to all points lie in wedges of average angle ğ›¼. We present an algorithm to find an ğ›¼â¯â¯â¯-ST whose largest edge-length and sum of edge lengths are at most 2 and 1.5 times (respectively) those of the MST. These ratios are better than any achievable when all wedges have angle ğ›¼. Our algorithm runs in linear time after computing the MST.

Access provided by University of Auckland Library

Introduction
A wireless network can be represented by disks in the plane, where a wireless node at point p with transmission range r is represented by a disk of radius r centered at point p. An edge of the network connects two nodes if each one is inside the disk centered at the other one. The question of assigning transmission ranges to the nodes to ensure a well-connected network of low interference has been widely studied [5, 8, 14, 17, 19, 20, 24, 27]. If different nodes may have different transmission ranges then we obtain â€œpower assignmentâ€ problems, which have also been heavily studied, see e.g. [6, 12, 13, 28, 31, 33]. The minimum transmission range to ensure network connectivity is the bottleneck of the minimum Bottleneck Spanning Tree (BST)â€”equivalently, the maximum edge-length in a Minimum Spanning Tree (MST).

In recent years, the idea of replacing omni-directional antennas with directional antennas has received considerable attention (see, e.g., [1, 4, 10, 15, 16, 18, 19, 29]). In this model, the full disk at each point p is restricted to a circular wedge with apex p that has some angle ğ›¼ and is oriented in some direction. Directional antennas are desirable in many ways, for example, they require lower transmission power, cause less interference, and provide more secure communication (see [5, 29] and references therein). The symmetric communication network [5] has an edge between two nodes if each one is inside the otherâ€™s wedge.

When every node has the same transmission range r and angle ğ›¼, there is still freedom to orient the directional antennas. The question of whether r and ğ›¼ permit a connected network is NP-hard (see Sect. 1.2 for details). Most previous work has concentrated on the case where ğ›¼ is some fixed value. Aschner and Katz [4] formulated this in terms of an ğ›¼-Spanning Tree (ğ›¼-ST): a spanning tree of the complete Euclidean graph on a point set P in the plane such that for each point ğ‘âˆˆğ‘ƒ all the edges incident to p lie in a wedge of angle ğ›¼ centered at p (see Fig. 1-left). For any ğ›¼<ğœ‹/3, an ğ›¼-ST may not exist, for example, if P is the set of vertices of an equilateral triangle. However, for any ğ›¼â©¾ğœ‹/3, an ğ›¼-ST always exists (see [1, 2], and [16] for three different proofs). There is a relationship between ğ›¼-STs and the well-studied concept of restricted degree spanning trees, since d edges at a vertex always lie in some wedge of angle at most 2ğœ‹(1âˆ’1/ğ‘‘).

To evaluate edge lengths of ğ›¼-STs two concepts are useful. An ğ›¼-Bottleneck Spanning Tree (ğ›¼-BST) is an ğ›¼-ST that minimizes the maximum edge length, and an ğ›¼-Minimum Spanning Tree (ğ›¼-MST) is an ğ›¼-ST that minimizes the sum of the edge lengths. Both are NP-hard to compute. Although any MST is also a BST [14], this is not necessarily true for ğ›¼-MST and ğ›¼-BSTâ€”we give an example in the proof of Proposition 3. For ğ›¼â©¾2ğœ‹/3 Aschner and Katz [4, 26] gave a simple polynomial time 5-approximation algorithm for the ğ›¼-BST.

The main result of Aschner and Katz [4] is a 6-approximation algorithm for the ğ›¼-MST for ğ›¼â©¾2ğœ‹/3. In particular, they construct an ğ›¼-ST of length at most 6 times the length of an MST of the points. Our main technical result is to improve this approximation factor to 16/3. An interesting aspect of their proof is that they orient the wedges at small subsets of the points so that the network on these points is connected and the wedges cover the whole plane. The problem of orienting wedges at fixed points to cover (or â€œlight upâ€) the plane is called the â€œFloodlight Problemâ€. Bose et al. [11] showed that for any n points and any set {ğ›¼1,â€¦,ğ›¼ğ‘›} of angles that are at most ğœ‹ and sum to 2ğœ‹, there is a way to assign angles to points and orient the wedges to light up the plane. To obtain our main result, we prove a strengthened version of the Floodlight result for ğ‘›=3 where we obtain a connected symmetric communication network even if the angles are pre-assigned to the points.

The new problem we study in this paper is the directional antenna problem when different nodes are allowed to have different wedge angles. The goal is to minimize the sum of the angles. For consistency with previous notation, we define an ğ›¼â¯â¯â¯-ST to be a spanning tree of the point set P such that for each point ğ‘âˆˆğ‘ƒ all the edges incident to p lie in a wedge of angle ğ›¼ğ‘ centered at p and the average of the ğ›¼ğ‘â€™s is ğ›¼, or in other words, âˆ‘ğ‘ğ›¼ğ‘=ğ‘›ğ›¼. One might hope that, as with the Floodlight Problem, a constant angle sum would suffice to construct a good network. Indeed, taking a star as a spanning tree achieves constant angle sum (with ğœ‹ at an extreme point taken as the center, and 0 at the leaves of the star)â€”but this uses a large transmission range. We show that it is not possible in general to achieve constant angle sum and transmission ranges bounded by a constant times the BST bottleneck.

Fig. 1
figure 1
Left: A 2ğœ‹/3-ST. Right: a degree-5 minimum spanning tree which is a 8ğœ‹/5-ST

Full size image
In the positive direction, we show that allocating an angle sum of ğ‘›â‹…2ğœ‹/3 non-uniformly does help, in particular, we can achieve smaller maximum edge-length and sum of edge lengths (compared to the MST) than is possible with uniform angles. Now we give more details about our results and techniques, and more details on background.

Our Results
We obtain the following results for angle ğ›¼=2ğœ‹/3, however, our approximation ratios hold for any angle ğ›¼â©¾2ğœ‹/3.

(1) Aschner and Katz [4] gave an elegant algorithm that finds a 2ğœ‹/3-ST of length at most 6 times the MST length, thus providing a 6-approximation algorithm for the 2ğœ‹/3-MST. Our main technical result (Theorem 1 in Sect. 3) is to improve the approximation ratio to 16/3.

Aschner and Katz prove their result using (in their words) a â€œsurprising theoremâ€, proved via a long case-analysis, that there is a way to assign 2ğœ‹/3 wedges to any 3 points (a â€œtripletâ€) such that: the union of the 3 wedges covers the plane; the resulting graph on the triplet is connected; and the resulting graph on any pair of triplets (whose wedges are assigned independently) is also connected. After that, their approach is to take an MST of the points, double its edges and take short-cuts to obtain a Hamiltonian path of length at most 2 times the MST length (as in the standard TSP approximation), and then apply their result to successive triplets of points on the path. Their theorem guarantees that successive pairs of triplets are connected. Finally, they get an approximation factor of 6 using the triangle inequality, and a judicious choice of whether to start the partition into triplets at the first, second, or third point of the path. One limitation of their approach is that the two edges used in each triplet may be the longest and second longest edges of the triplet.

We follow the same approach. We take a non-crossing Hamiltonian path and consider successive triplets of points along the path. The fact that edges of the Hamiltonian path are non-crossing ensures that the triplets are also â€œnon-crossingâ€ in some sense. This allows us to assign wedges to the triplets in a different way leading to a shorter proof of the â€œsurprising theoremâ€ for non-crossing triplets, as well as a better length guarantee within each triplet.

Our algorithm is slower than that of Aschner and Katz because of the extra work of uncrossing the edges of the Hamiltonian path.

Note. After the initial submission of this paper, there has been further improvement on the approximation ratio. In WADS 2021, Ashur and Katz [7] showed how to construct a 2ğœ‹/3-ST of length at most 4 times the MST length. The general approach is to partition the vertices of the Hamiltonian path into pairs and then orient the pairs (not independently of each other) in such a way that there is a connection between consecutive pairs.

(2) We give an algorithm to find a 2ğœ‹/3â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯-ST whose largest edge-length is at most 2 times the largest edge-length of the MST, and whose sum of edge lengths is at most 1.5 times the length of the MST (Theorem 6 in Sect. 4). The idea of our algorithm is to start with an MST that has maximum degree 5 (which is known to exist) and then re-assign parts of the wedge angles from leaves to inner vertices. Our algorithm runs in linear time after computation of the MST. The ratios 2 and 1.5 improve the best known ratios for 2ğœ‹/3-BST and 2ğœ‹/3-MST (5 and 16/3, respectively). In fact, our ratios for non-uniform angles are better than any possible with uniform angles, as we prove by designing an infinite class of point sets such that every 2ğœ‹/3-ST has maximum edge length at least 3 times the largest edge-length of the MST, and sum of edge lengths at least 2 times the length of the MST.

(3) We present the following lower bounds for approximating the above problems with respect to the MST. These bounds are proved in Sect. 2. Although the lower bounds of 2 and 3 (in Proposition 1) for the 2ğœ‹/3-MST and the 2ğœ‹/3-BST seem to be common knowledge [4, 26], for the sake of completeness we give a proof of them. Proposition 1 gives the lower bound 4/3 for the 2ğœ‹/3â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯-ST.

Proposition 1
Let ğ›¼ and ğ›¼â¯â¯â¯ be two angles in the open interval (0,ğœ‹). The ğ›¼-MST, the ğ›¼â¯â¯â¯-MST, and the ğ›¼-BST problems cannot be approximated by ratios smaller than 2, 2âˆ’ğ›¼â¯â¯â¯/ğœ‹, and 3, respectively, given the length of the MST and the largest edge-length of the MST as lower bounds.

Proposition 2
Let A(n) be the smallest value that suffices to construct, for any set of n points in the plane, a connected symmetric network with angle sum A(n) and with transmission ranges bounded by a constant times the largest edge-length of the BST. Then ğ´(ğ‘›)âˆˆğ›º(ğ‘›âˆš).

Proposition 3
For any ğ›¼<ğœ‹ there exists a point set for which no ğ›¼-MST is an ğ›¼-BST.

Further Background
As mentioned above, there is a connection between ğ›¼-STs and restricted degree spanning trees, due to the fact that d edges at a vertex always lie in some wedge of angle at most 2ğœ‹(1âˆ’1/ğ‘‘). The Minimum degree-k spanning tree (degree-k MST) problem has been well-studied (see, e.g., [3, 17, 25, 27]). It is easy to compute a degree-2 spanning tree (a Hamiltonian path) of length at most twice the length of the Euclidean MST by doubling the MST edges, taking an Euler tour, short-cutting repeated vertices, and then removing an edge. It is also possible to compute in polynomial time degree-3, degree-4, and degree-5 spanning trees of lengths at most 1.402 [17], 1.1381 [17, 25], and 1 [30] times the MST length, respectively. This immediately implies the existence of ğœ‹-ST, 4ğœ‹/3-ST, 3ğœ‹/2-ST, and 8ğœ‹/5-ST of lengths at most 2, 1.402, 1.1381, and 1 times the MST length, respectively. See Fig. 1-right for an illustration of a degree-5 MST which is a 8ğœ‹/5-ST.

The ğ›¼-MST problem is also related to the problem of computing angle-restricted Hamiltonian paths and cycles on points in the plane. One can compute a Hamiltonian path with angles of at most ğœ‹/2 by starting from an arbitrary point and iteratively connecting the current point to its farthest among the remaining points (see [23]); the angle ğœ‹/2 is tight in the sense that there are point sets for which every Hamiltonian path has an angle larger than ğœ‹/2âˆ’ğœ€ for any ğœ€>0 (see [16, 21]). Fekete and Woeginger [23] conjectured that for any even-size point set of at least 8 elements there exists a Hamiltonian cycle with angles at most ğœ‹/2. Dumitrescu et al. [21] gave a partial solution by constructing a cycle with angles of at most 2ğœ‹/3. The conjecture remains open.

Aschner and Katz [4] studied the ğ›¼-MST problem for ğ›¼âˆˆ{ğœ‹/2,2ğœ‹/3,ğœ‹}. They proved the NP-hardness of this problem for ğ›¼=2ğœ‹/3 and ğ›¼=ğœ‹ by reductions from the problem of finding a Hamiltonian path in hexagonal grid graphs and in square grid graphs of degree at most three, respectively. In addition to the result mentioned above for a 2ğœ‹/3-ST of length at most 6 times the MST length, they also presented an algorithm for computing a ğœ‹/2-ST of length at most 16 times the MST length.

The problem of constructing bounded-angle networks with no long edges (the ğ›¼-BST problem) has been studied extensively. The NP-hardness reduction of Aschner and Katz for the 2ğœ‹/3-MST problem also implies the NP-hardness of the 2ğœ‹/3-BST problem and its inapproximability by a factor smaller than 3â€¾âˆš. Carmi et al. [16] construct ğœ‹/2-Hamiltonian paths with edges that are shorter than that of the construction by Fekete and Woeginger [23]. Aschner and Katz [4] construct 2ğœ‹/3-hop-spanners with hop-ratio 6 and edge lengths at most 7 for unit disk graphs. Dobrev et al. [19, 20] and Caragiannis et al. [15] construct strongly connected directed networks with short edges and nodes of bounded out-degree.

Fig. 2
figure 2
The point p sees q but q does not see p

Full size image
Notation and Preliminaries
Let ğ‘¤ğ‘ be a wedge in the plane with apex p. We denote by ğ‘¤ğ‘âˆ’â†’ the clockwise (right) boundary ray of ğ‘¤ğ‘, and by ğ‘¤ğ‘â†âˆ’ the counterclockwise (left) boundary ray of ğ‘¤ğ‘. Let ğ‘¤ğ‘ be another convex wedge in the plane with apex q. If q lies in ğ‘¤ğ‘ then we say that p sees q and denote this by ğ‘â†’ğ‘. We use ğ‘â†”ğ‘ to denote that p and q are mutually visible, that is, p and q see each other. In other words, ğ‘â†”ğ‘ denotes ğ‘â†’ğ‘ and ğ‘â†’ğ‘. In Fig. 2 the point p sees q but q does not see p, and thus they are not mutually visible. Let P be a set of points in the plane and assume that wedges, possibly of different angles, are placed at every point of P. Then the induced mutual-visibility graph on P is a geometric graph with vertex set P that has a straight-line edge between two points p and q if and only if p and q are mutually visible. The underlying non-geometric graph is the symmetric communication network on P.

We denote the sum of edge lengths of a geometric graph G by w(G). We need the following basic fact about triangles in the plane.

Lemma 1
Let a, b, and c be three points in the plane. The total length of the shortest and the longest sides of the triangle â–³(ğ‘,ğ‘,ğ‘) is at most 1.5 times the total length of the two shortest sides.

Proof
After a suitable relabeling we may assume that |ğ‘ğ‘|â©½|ğ‘ğ‘|â©½|ğ‘ğ‘|. By the triangle inequality we have |ğ‘ğ‘|â©½(|ğ‘ğ‘|+|ğ‘ğ‘|), and by our assumption that |ğ‘ğ‘|â©½|ğ‘ğ‘| we have |ğ‘ğ‘|â©½0.5(|ğ‘ğ‘|+|ğ‘ğ‘|). The sum of these two new inequalities yields |ğ‘ğ‘|+|ğ‘ğ‘|â©½1.5(|ğ‘ğ‘|+|ğ‘ğ‘|), which proves the lemma. â—»

Lower Bounds
In this section we prove Propositions 1, 2, and 3.

Proposition 1Let ğ›¼ and ğ›¼â¯â¯â¯ be two angles in the open interval (0,ğœ‹). The ğ›¼-MST, the ğ›¼â¯â¯â¯-MST, and the ğ›¼-BST problems cannot be approximated by ratios smaller than 2, 2âˆ’ğ›¼â¯â¯â¯/ğœ‹, and 3, respectively, given the length of the MST and the largest edge-length of the MST as lower bounds.

Fig. 3
figure 3
a An ğ›¼-ST of length 2ğ‘›âˆ’3 for ğ›¼<ğœ‹. b An ğ›¼â¯â¯â¯-ST of length 4ğ‘›/3âˆ’3 for ğ›¼â¯â¯â¯=2ğœ‹/3

Full size image
Proof
Consider a sequence ğ‘‹=(ğ‘¥1,ğ‘¥2,â€¦,ğ‘¥ğ‘›) of n points on the x-axis with coordinates 1,2,â€¦,ğ‘›, respectively, as in Fig. 3. We show that X satisfies the statement of the proposition for the three problems. The MST of X is a path with edges of length 1 and total length ğ‘›âˆ’1.

First we prove the lower bound 2 for the 2ğœ‹/3-MST problem (this lower bound is also mentioned in [4]). We show by induction that any 2ğœ‹/3-minimum spanning tree T on X has length at least 2ğ‘›âˆ’3. This is trivial if ğ‘›âˆˆ{1,2}, thus assume that ğ‘›â©¾3. There are ğ‘›âˆ’1 intervals on the x-axis between consecutive points of X. If every interval is covered by two edges of T then ğ‘¤(ğ‘‡)â©¾2ğ‘›âˆ’2. Assume that some interval [ğ‘–,ğ‘–+1] is covered by only one edge of T, say edge e. By removing e we obtain two subtrees ğ‘‡1 and ğ‘‡2 where ğ‘‡1 spans the points ğ‘¥1,â€¦,ğ‘¥ğ‘– while ğ‘‡2 spans ğ‘¥ğ‘–+1,â€¦,ğ‘¥ğ‘›. Let ğ‘›1 and ğ‘›2 be the number vertices of ğ‘‡1 and ğ‘‡2, respectively. Assume that both ğ‘›1 and ğ‘›2 are at least 2. Since ğ‘‡1 spans ğ‘¥1,â€¦,ğ‘¥ğ‘–, the vertex ğ‘¥ğ‘– is oriented to the left (and does not see any point to its right). Analogously, ğ‘¥ğ‘–+1 is oriented to the right. Therefore e is not incident to ğ‘¥ğ‘– or ğ‘¥ğ‘–+1, and thus its length is at least 3. By the induction hypothesis we get ğ‘¤(ğ‘‡)=ğ‘¤(ğ‘‡1)+ğ‘¤(ğ‘‡2)+ğ‘¤(ğ‘’)â©¾(2ğ‘›1âˆ’3)+(2ğ‘›2âˆ’3)+3=2(ğ‘›1+ğ‘›2)âˆ’3=2ğ‘›âˆ’3. Now assume that ğ‘›1=1, and thus ğ‘›2â©¾2. Then ğ‘‡1 has only vertex ğ‘¥ğ‘–=ğ‘¥1 which is an endpoint of e. Since ğ‘‡2 spans ğ‘¥2,â€¦,ğ‘¥ğ‘›, the vertex ğ‘¥2 is oriented to the right. Therefore e is not incident to ğ‘¥2, and thus its length is at least 2. Thus ğ‘¤(ğ‘‡)=ğ‘¤(ğ‘‡1)+ğ‘¤(ğ‘‡2)+ğ‘¤(ğ‘’)â©¾0+(2ğ‘›2âˆ’3)+2=2ğ‘›âˆ’3. The case where ğ‘›2=1 is handled similarly.

To verify the lower bound of 3 for the 2ğœ‹/3-BST problem, assume that ğ‘›=5. Consider the edge-maximal graph on X that has edges of length at most 2. In any spanning tree in this graph, at least one of ğ‘¥2,ğ‘¥3,ğ‘¥4 has incident edges in both directions (left and right). Thus, no matter how we place wedges of angle 2ğœ‹/3 on vertices of X, we cannot get a 2ğœ‹/3-ST of edge lengths at most 2. Therefore, any 2ğœ‹/3-ST on X has an edge of length at least 3, as in Fig. 3a. This argument can be generalized for any n larger than 5.

Now consider any 2ğœ‹/3â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯-minimum spanning tree ğ‘‡â¯â¯â¯â¯ on X. We show that ğ‘¤(ğ‘‡â¯â¯â¯â¯)â©¾4ğ‘›/3âˆ’3. Partition the vertices of ğ‘‡â¯â¯â¯â¯ into ğ‘‹1 and ğ‘‹2 where ğ‘‹1 is the set of vertices with wedges of angle strictly less than ğœ‹ and ğ‘‹2 is the set of vertices with wedges of angle at least ğœ‹. Since the total available angle is ğ‘›â‹…2ğœ‹/3 radians, |ğ‘‹2|â©½(ğ‘›â‹…2ğœ‹/3)/ğœ‹=2ğ‘›/3. Thus |ğ‘‹1|=ğ‘›âˆ’|ğ‘‹2|â©¾ğ‘›/3. Observe that every interval (between consecutive vertices of X) is covered by an edge of ğ‘‡â¯â¯â¯â¯. Every vertex ğ‘¥ğ‘–âˆˆğ‘‹1 sees the vertices that are either to its left or to its right. We denote ğ‘¥ğ‘– by ğ‘¥ğ‘–â† if it sees the vertices to its left, and by ğ‘¥ğ‘–â†’ otherwise (see Fig. 3b). For every ğ‘¥ğ‘–â† the interval [ğ‘–âˆ’1,ğ‘–] is covered by at least two edges otherwise connectivity is lost: one edge is incident to ğ‘¥ğ‘–â† and another edge connects a point to the left of ğ‘¥ğ‘–â† with a point to the right (assuming ğ‘–â‰ ğ‘›). Similarly for every ğ‘¥ğ‘–â†’ the interval [ğ‘–,ğ‘–+1] is covered by an edge that is incident to ğ‘¥ğ‘–â†’ and by an edge that connects a point to the right of ğ‘¥ğ‘–â†’ with a point to the left (assuming ğ‘–â‰ 1), as in Fig. 3b. Thus, for every ğ‘¥ğ‘–â† (except possibly ğ‘¥ğ‘›â†âˆ’) there exists a unique interval that is covered by two edges of ğ‘‡â¯â¯â¯â¯. Similarly, for every ğ‘¥ğ‘–â†’ (except possibly ğ‘¥1âˆ’â†’) there exists a unique interval that is covered by two edges of ğ‘‡â¯â¯â¯â¯. (If ğ‘¥ğ‘– is oriented to the left and ğ‘¥ğ‘–+1 is oriented to the right thenâ€”by the minimality of the treeâ€”(ğ‘¥ğ‘–,ğ‘¥ğ‘–+1) is an edge of ğ‘‡â¯â¯â¯â¯ and the interval [ğ‘–,ğ‘–+1] is covered by three edges.) Therefore the length of ğ‘‡â¯â¯â¯â¯ is at least (ğ‘›âˆ’1)+(|ğ‘‹1|âˆ’2)â©¾4ğ‘›/3âˆ’3. â—»

Proposition 2Let A(n) be the smallest value that suffices to construct, for any set of n points in the plane, a connected symmetric network with angle sum A(n) and with transmission ranges bounded by a constant times the largest edge-length of the BST. Then ğ´(ğ‘›)âˆˆğ›º(ğ‘›âˆš).

Proof
Consider a set of n points on the vertices of a regular ğ‘›âˆšÃ—ğ‘›âˆš grid of side length ğ‘›âˆšâˆ’1. The largest edge-length of any BST for this point set is 1. Now consider any connected symmetric network T for this point set that satisfies the statement of the proposition, and let the constant c be the largest transmission range (edge-length) in T. Let L denote the set of supporting lines for all edges of T. Since any line in the plane contains at most ğ‘›âˆš points of the grid, the cardinality of L is at least ğ‘›âˆš. This and the connectivity of T imply that T has at least one vertex, say v, where the neighbors of v lie on more than one line of L. Let V be the set of all such vertices of T. Observe that every line in L passes through a vertex in V. For every ğ‘£âˆˆğ‘‰ the neighbors of v lie in a square of side-length 2c that is centered at v. This square contains at most (2ğ‘+1)2 grid points, and thus v has at most (2ğ‘+1)2 neighbors (that can lie on at most (2ğ‘+1)2 lines in L). Therefore |ğ‘‰|â©¾|ğ¿|/(2ğ‘+1)2â©¾ğ‘›âˆš/(2ğ‘+1)2.

Now consider any ğ‘£âˆˆğ‘‰. Let ğ‘£1 and ğ‘£2 be two neighbors of v such that edges (ğ‘£,ğ‘£1)âˆˆğ‘‡ and (ğ‘£,ğ‘£2)âˆˆğ‘‡ lie on two different lines of L. Since v, ğ‘£1, and ğ‘£2 are grid points and lie on a square of constant side-length 2c, the angle between ğ‘£1 and ğ‘£2 at v is a constant. Let ğ›¼ be the smallest such constant over all vertices in V. Then, the total angle at vertices in V is at least ğ›¼â‹…|ğ‘‰|â©¾ğ›¼ğ‘›âˆš/(2ğ‘+1)2âˆˆğ›º(ğ‘›âˆš). â—»

Proposition 3For any ğ›¼<ğœ‹ there exists a point set for which no ğ›¼-MST is an ğ›¼-BST.

Proof
Consider the point set P in Fig. 4 consisting of ğ‘›â©¾9 points partitioned into ğ‘¡=ğ‘›/3 triplets (ğ‘ğ‘–,ğ‘ğ‘–,ğ‘ğ‘–) where |ğ‘ğ‘–ğ‘ğ‘–+1|=1 and |ğ‘ğ‘–ğ‘ğ‘–|=|ğ‘ğ‘–ğ‘ğ‘–|=ğœ– for some ğœ–<1/(2ğ‘›âˆ’3). We refer to an edge of length at least 1 as a long edge. The red bold tree is an ğ›¼-ST of total length (ğ‘¡âˆ’1)((1+3ğœ–)+2ğœ–+ğœ–)+2ğœ–+ğœ–=(ğ‘¡âˆ’1)+(6ğ‘¡âˆ’3)ğœ–<ğ‘¡, where the last inequality holds by our choice of ğœ–. Therefore any ğ›¼-MST for P has at most ğ‘¡âˆ’1 long edges because otherwise it would have a length larger than t. This implies that each interval [ğ‘ğ‘–,ğ‘ğ‘–+1] is covered by at most 1 edge of any ğ›¼-MST. On the other hand, any spanning tree for P has at least ğ‘¡âˆ’1 long edges as all triplet should be connected to the rest of the tree by a long tree edge. It turns out that any ğ›¼-MST T of P has exactly ğ‘¡âˆ’1 long edges each connecting a point in triplet (ğ‘ğ‘–,ğ‘ğ‘–,ğ‘ğ‘–) to a point in triplet (ğ‘ğ‘–+1,ğ‘ğ‘–+1,ğ‘ğ‘–+1). In the rest of the proof we show that T has an edge of length at least 1+3ğœ–. This immediately proves our claim because P admits an ğ›¼-ST of edge lengths at most 1+2ğœ–, see for example the thin blue tree in Fig. 4.

Fig. 4
figure 4
The red bold spanning tree has a total length of less than t. The blue thin spanning tree has edges of lengths at most 1+2ğœ–

Full size image
Consider any ğ‘–âˆˆ{1,â€¦,ğ‘¡âˆ’1}. Let ğ‘’ğ‘– be the long edge of T between triplets (ğ‘ğ‘–,ğ‘ğ‘–,ğ‘ğ‘–) and (ğ‘ğ‘–+1,ğ‘ğ‘–+1,ğ‘ğ‘–+1). The point ğ‘ğ‘– cannot be an endpoint of ğ‘’ğ‘– because otherwise there must be a long edge ğ‘’â€²ğ‘– in T that connects a point to the left of ğ‘ğ‘– to a point to the right of ğ‘ğ‘–; this contradicts the fact that the interval [ğ‘ğ‘–,ğ‘ğ‘–+1] is covered by exactly one edge of T (by the constraint on the angle, ğ‘ğ‘– cannot be connected to any point to the left). By symmetry, ğ‘ğ‘–+1 cannot be an endpoint of ğ‘’ğ‘– either. If ğ‘ğ‘– or ğ‘ğ‘–+1 is an endpoint of ğ‘’ğ‘– then |ğ‘’ğ‘–|â©¾1+3ğœ– and we are done. Assume that for every ğ‘–âˆˆ{1,â€¦,ğ‘¡âˆ’1} we have ğ‘’ğ‘–=(ğ‘ğ‘–,ğ‘ğ‘–+1). Then (ğ‘1,ğ‘2) and (ğ‘2,ğ‘3) are edges of T. Thus the angle at ğ‘2 is larger than ğ›¼ which contradicts T being an ğ›¼-ST. â—»

Approximating the 2ğœ‹/3-MST
Let ğ›¼=2ğœ‹/3 in this section. Let P be a set of points in the plane. Aschner and Katz [4] showed how to construct an ğ›¼-ST on P of length at most 6 times the MST length. In this section we present an alternate construction that achieves an ğ›¼-ST of length at most 16/3 times the MST length, thereby proving the following theorem.

Theorem 1
Given a set of points in the plane and an angle ğ›¼â©¾2ğœ‹/3, there is

an ğ›¼-spanning tree of length at most 16/3 times the length of the MST. Furthermore, there is a polynomial time algorithm to find such an ğ›¼-ST, thus providing a 16/3-approximation algorithm for the ğ›¼-MST problem.

The Construction of Aschner and Katz
To facilitate comparisons, we briefly describe the algorithm of Aschner and Katz [4]. They use the following theorems to compute an ğ›¼-ST.

Theorem 2
(Aschner and Katz, 2014) Given a set P of three points in the plane, one can place at each point of P a wedge of angle 2ğœ‹/3 such that the three wedges cover the plane and the induced mutual-visibility graph on P is connected, and hence it contains a 2ğœ‹/3-ST.

A placement that satisfies the conditions of Theorem 2 is given in the proof of Claim 2.1 [4]. This placement has an interesting property which is given in the following theorem whose proof is involved.

Theorem 3
(Aschner and Katz, 2014) Let ğ‘ƒ1 and ğ‘ƒ2 be two disjoint sets each containing three points in the plane. Assume that a wedge of angle 2ğœ‹/3 is placed at each point of ğ‘ƒ1 and at each point of ğ‘ƒ2 according to the placement of Theorem 2. Then, the induced mutual-visibility graph on ğ‘ƒ1âˆªğ‘ƒ2 is connected, and hence it contains a 2ğœ‹/3-ST.

Let H be a Hamiltonian path on P of length at most 2 times the MST length. The constant 2 is tight, since Fekete et al. [22] showed that for any fixed ğœ€>0 there exists a point set for which any Hamiltonian path has length at least 2âˆ’ğœ€ times the MST length.

Let (ğ‘0,â€¦,ğ‘ğ‘›âˆ’1) be the sequence of points of P from one endpoint of H to the other. Let (â„0,â„1,â€¦,â„ğ‘›âˆ’2) be the sequence of the edges of H where â„ğ‘–=(ğ‘ğ‘–,ğ‘ğ‘–+1). Partition the edges of H into three sets ğ»0={â„0,â„3,â„6,â€¦}, ğ»1={â„1,â„4,â„7,â€¦}, and ğ»2={â„2,â„5,â„8,â€¦}, as in Fig. 5. The length of one of these sets, say ğ»2, is at least w(H)/3. Therefore ğ‘¤(ğ»0)+ğ‘¤(ğ»1)â©½23ğ‘¤(ğ»). Partition P into a sequence of triplets (ğ‘0,ğ‘1,ğ‘2),(ğ‘3,ğ‘4,ğ‘5),â€¦ such that the edges of H, that lie between consecutive triplets, are in ğ»2. Then place three wedges on the points of each triplet according to Theorem 2, and let ğºğ›¼ be the induced mutual-visibility graph. The points in each triplet are connected (by Theorem 2) and any pair of triplets is connected (by Theorem 3), and thus ğºğ›¼ is connected.

Fig. 5
figure 5
Top: path H where ğ»0, ğ»1, ğ»2 are colored blue, green, and red, respectively. Bottom: spanning tree T where edges obtained by Theorems 2 and 3 are colored purple and orange, respectively

Full size image
Now let T be a spanning tree of ğºğ›¼ computed as follows (see Fig. 5): between the points in each triplet take two edges that are obtained from Theorem 2 (these edges are called inner edges), and between every two consecutive triplets take an edge that is obtained by Theorem 3 (these edges are called connecting edges). To bound the length of T, we charge edges of H for the edges of T. Every edge of H that belongs to ğ»2 lies between two consecutive triplets, and thus is charged only once for the connecting edge between the two triplets. Every edge of H that belongs to ğ»0âˆªğ»1 lies inside a triplet, say t. Such an edge is charged 4 times: twice for the two inner edges of t and twice for the two edges that connect t to adjacent triplets. Therefore,

ğ‘¤(ğ‘‡)â©½ğ‘¤(ğ»2)+4(ğ‘¤(ğ»0)+ğ‘¤(ğ»1))=ğ‘¤(ğ»)+3(ğ‘¤(ğ»0)+ğ‘¤(ğ»1))â©½3ğ‘¤(ğ»)â©½6ğ‘¤(ğ‘€ğ‘†ğ‘‡).
The New Construction
Our approach, for the construction of an ğ›¼-ST of length at most 16/3 times the MST length, is similar to that of Aschner and Katz, however we use a different placement of wedges on points of triplets which in turn requires different proof techniques.

Let ğ‘ƒ={ğ‘1,ğ‘2,ğ‘3} be any set of three points in the plane. The complete graph on P has edge set ğ¸={ğ‘1ğ‘2,ğ‘1ğ‘3,ğ‘2ğ‘3} and contains exactly three spanning trees. Let ğ‘‡1 be the tree that has the two shortest edges of E, ğ‘‡3 be the tree that has the two longest edges of E, and ğ‘‡2 be the tree that has the shortest and the longest edges of E. Observe that ğ‘¤(ğ‘‡1)â©½ğ‘¤(ğ‘‡2)â©½ğ‘¤(ğ‘‡3). We refer to ğ‘‡1, ğ‘‡2, and ğ‘‡3 as the shortest, intermediate, and longest trees on P, respectively.

The ğ›¼-ST obtained by the wedge placement in (the proof of) Theorem 2 contains the two longest edges of E. In other words, this placement gives the spanning tree ğ‘‡3. Due to the objective of minimizing the sum of edge lengths, one may ask for a wedge placement that covers the plane using ğ‘‡1 or ğ‘‡2. We answer this question in the affirmative in Theorem 4. This theorem improves Theorem 2 in the sense that it uses ğ‘‡1 or ğ‘‡2 and also allows more flexibility on the angles of the wedges.

Consider three points in the plane, and three angles ğ›¼1,ğ›¼2,ğ›¼3 where each ğ›¼ğ‘– is at most ğœ‹ and ğ›¼1+ğ›¼2+ğ›¼3=2ğœ‹. The Floodlight result of Bose et al. [11] implies that one can cover the plane by placing three wedges of angles ğ›¼1,ğ›¼2,ğ›¼3 at the three points. Our Theorem 4 also improves this result in two ways: (i) one can cover the plane with three wedges even if the assignment of angles to points is specified in advance, and (ii) the induced mutual-visibility graph is connected, in particular it contains the shortest or the intermediate tree on the points.

Theorem 4
(proved in Sect. 3.3) Given a set ğ‘ƒ={ğ‘1,ğ‘2,ğ‘3} of three points in the plane and three angles ğ›¼1,ğ›¼2,ğ›¼3â©½ğœ‹ where ğ›¼1+ğ›¼2+ğ›¼3=2ğœ‹, one can place at each ğ‘ğ‘– a wedge of angle ğ›¼ğ‘– such that the three wedges cover the plane and the induced mutual-visibility graph contains the shortest or the intermediate tree on P.

If we set each ğ›¼ğ‘– equal to 2ğœ‹/3 in Theorem 4, then we get the following corollary.

Corollary 1
Given a set P of three points in the plane, one can place wedges of angle 2ğœ‹/3 at points of P such that the three wedges cover the plane and the induced mutual-visibility graph contains the shortest or the intermediate tree on P.

Corollary 1 ensures covering of the plane and also uses ğ‘‡1 or ğ‘‡2. Unfortunately, we cannot directly use this corollary in the approach of Aschner and Katz because their Theorem 3 ensures a connection between two triplets ğ‘¡1 and ğ‘¡2 only if they are oriented by Theorem 2; such a connection may not exist if the triplets are oriented by Corollary 1. However, we show in Theorem 5 that if the relative positions of the points of ğ‘¡1 and ğ‘¡2 is not among the two configurations shown in Fig. 6, then the orientation of Corollary 1 ensures a connection between them. Our final proof relies on the fact that the configurations in Fig. 6 never arise from triplets of a non-crossing Hamiltonian path.

To be more precise, consider disjoint point sets ğ‘ƒ1 and ğ‘ƒ2, each of size three, in the plane. Let ğ¾1 and ğ¾2 be the complete graphs (triangles) on points of ğ‘ƒ1 and ğ‘ƒ2, respectively. We say that the (unordered) pair {ğ‘ƒ1,ğ‘ƒ2} is forbidden if there exist vertices ğ‘âˆˆğ¾1 and ğ‘âˆˆğ¾2 such that (i) both edges incident to p intersect both edges incident to q, or (ii) p lies inside the triangle ğ¾2 and the edge of ğ¾1 not incident to p intersects both edges incident to q. See Fig. 6.

Theorem 5
(proved in Sect. 3.4) Let ğ‘ƒ1 and ğ‘ƒ2 be two disjoint sets, each containing three points in the plane, such that {ğ‘ƒ1,ğ‘ƒ2} is not forbidden. Assume that a wedge of angle 2ğœ‹/3 is placed at each point of ğ‘ƒ1 and at each point of ğ‘ƒ2 according to the placement algorithm of Corollary 1. Then, the induced mutual-visibility graph on ğ‘ƒ1âˆªğ‘ƒ2 is connected, and hence it contains a 2ğœ‹/3-ST.

Intuitively, it would seem that our proof of Theorem 5 should follow the same approach as that of Aschner and Katzâ€™s Theorem 3. We note, however, that their proof of Theorem 3 is highly involved and uses a combination of nontrivial ideas. In order to cope with the large number of cases, they classify the number of edges in the induced mutual-visibility graph of each triplet. Their proof ensures the existence of an edge between ğ‘ƒ1 and ğ‘ƒ2 only if the wedges are oriented according to the placement in the proof of Theorem 2. Such an edge may not exist for other wedge placements with similar properties, i.e., coverage of the plane and connectivity of each set ğ‘ƒ1 and ğ‘ƒ2; for example see Fig. 7 which is borrowed from [4] (notice that the pair of triplets in this figure is forbidden).

Fig. 6
figure 6
Two configurations of a forbidden pair {ğ‘ƒ1,ğ‘ƒ2} forming triangles ğ¾1 and ğ¾2

Full size image
Fig. 7
figure 7
There is no connection between the red and blue triplets

Full size image
Thus, there is no straightforward way of adjusting their proof to work for our Theorem 5 where the wedges in ğ‘ƒ1 and ğ‘ƒ2 are oriented according to Corollary 1. We give a relatively short proof of Theorem 5 in Sect. 3.4. Instead of classifying the number of edges of visibility graphs, we introduce a â€œrepresentativeâ€ point for each triplet; this facilitates a shorter presentation of our proof.

The remaining ingredient we need in order to apply Theorem 5 is the following observation that forbidden triplets do not arise if we begin with a Hamiltonian path H that is non-crossing.

Observation 1
Let H be a non-crossing Hamiltonian path and let ğ‘¡1 and ğ‘¡2 be disjoint triplets, each of which is obtained from consecutive vertices of H. Then, {ğ‘¡1,ğ‘¡2} is not forbidden.

Proof
Each of ğ‘¡1 and ğ‘¡2 must contain two edges of H (because they come from consecutive vertices of H), and the union of these edges is non-crossing because H is non-crossing. But if {ğ‘¡1,ğ‘¡2} is forbidden (see Fig. 6), then there is no way to choose two edges in each of ğ‘¡1 and ğ‘¡2 such that their union is non-crossing. â—»

To use this observation, we need a non-crossing Hamiltonian path. Such a path can be obtained by iteratively flipping crossing edges of H. It is known that this iterative process terminates after ğ‘‚(ğ‘›3) edge flips [32], where n is the number of path vertices. (See [9] for some recent results on obtaining non-crossing configurations by edge flips.) Since the edge flip operation does not increase the total edge length (this can be verified by the triangle inequality), the length of the resulting non-crossing path is not more than that of the original path. Therefore, we assume from now on that H is non-crossing and ğ‘¤(ğ»)â©½2ğ‘¤(ğ‘€ğ‘†ğ‘‡).

Now we have the necessary tools (a non-crossing path H and Theorem 5) to use the orientation of the wedges as in Corollary 1. Let (ğ‘0,â€¦,ğ‘ğ‘›âˆ’1) be the sequence of points from one endpoint of H to the other. Construct edge sets ğ»0, ğ»1, ğ»2, and as before assume that ğ‘¤(ğ»2)â©¾ğ‘¤(ğ»)/3, which implies ğ‘¤(ğ»0)+ğ‘¤(ğ»1)â©½23ğ‘¤(ğ»). Construct triplets ğ‘¡0=(ğ‘0,ğ‘1,ğ‘2),ğ‘¡1=(ğ‘3,ğ‘4,ğ‘5),â€¦, and orient the wedges according to Corollary 1. Since H is non-crossing, no pair of triplets is forbidden (by Observation 1). The induced mutual-visibility graph, ğºğ›¼, is connected because the points of each triplet are connected (by Corollary 1) and every two triplets are connected (by Theorem 5). We obtain a spanning tree T from ğºğ›¼ as before. Every edge of ğ»2 is charged only once for the connecting edge between two consecutive triplets. Every pair (â„ğ‘–,â„ğ‘–+1) of edges in each triplet t (where â„ğ‘–âˆˆğ»0 and â„ğ‘–+1âˆˆğ»1) is charged 3.5 times: twice for connecting edges between t and its adjacent triplets, and 1.5 times for inner edges of t (by Lemma 1 the length of the tree obtained by Corollary 1 is at most 1.5(ğ‘¤(â„ğ‘–)+ğ‘¤(â„ğ‘–+1))). Therefore

ğ‘¤(ğ‘‡)â©½ğ‘¤(ğ»2)+3.5(ğ‘¤(ğ»0)+ğ‘¤(ğ»1))=ğ‘¤(ğ»)+2.5(ğ‘¤(ğ»0)+ğ‘¤(ğ»1))â©½ğ‘¤(ğ»)+53ğ‘¤(ğ»)=83ğ‘¤(ğ»)â©½163ğ‘¤(ğ‘€ğ‘†ğ‘‡).
This finishes the proof of Theorem 1.

Proof of Theorem 4
In this section we prove the following theorem. First we provide some preliminaries for the proof. We use similar notation for the proof of Theorem 5 in Sect. 3.4.

Theorem 4Given a set ğ‘ƒ={ğ‘1,ğ‘2,ğ‘3} of three points in the plane and three angles ğ›¼1,ğ›¼2,ğ›¼3â©½ğœ‹ where ğ›¼1+ğ›¼2+ğ›¼3=2ğœ‹, one can place at each ğ‘ğ‘– a wedge of angle ğ›¼ğ‘– such that the three wedges cover the plane and the induced mutual-visibility graph contains the shortest or the intermediate tree on P.

figure a
Let p be a point in the plane and let [ğ‘Ÿ1â†’(ğ‘),ğ‘Ÿ2â†’(ğ‘),ğ‘Ÿ3â†’(ğ‘)] be the cyclic counterclockwise permutation of three rays emanating from p where the angle between any two consecutive rays is less than ğœ‹. See the figure to the right for an illustration. These rays partition the plane into three cones with apices at p. For an index ğ‘–âˆˆ{1,2,3} we denote by ğ‘Ÿğ‘–+1âˆ’â†’âˆ’(ğ‘) the ray after ğ‘Ÿğ‘–â†’(ğ‘) in the cyclic permutation, by ğ‘Ÿğ‘–â†(ğ‘) the ray emanating from p in the opposite direction of ğ‘Ÿğ‘–â†’(ğ‘), and by ğ‘™ğ‘–(ğ‘) the line through ğ‘Ÿğ‘–â†’(ğ‘). We denote by ğ‘ğ‘–(ğ‘) the convex cone with boundary rays ğ‘Ÿğ‘–â†’(ğ‘) and ğ‘Ÿğ‘–+1âˆ’â†’âˆ’(ğ‘), and by ğ‘ğ‘–â¯â¯â¯â¯(ğ‘) the reflection of ğ‘ğ‘–(ğ‘) with respect to p. Moreover, we denote by ğ‘ğ‘–ğ‘…(ğ‘) the portion of ğ‘ğ‘–(ğ‘) that is between ğ‘Ÿğ‘–â†’(ğ‘) and ğ‘Ÿğ‘–+2â†âˆ’âˆ’(ğ‘), and by ğ‘ğ‘–ğ¿(ğ‘) the of portion ğ‘ğ‘–(ğ‘) of that is between ğ‘Ÿğ‘–+2â†âˆ’âˆ’(ğ‘) and ğ‘Ÿğ‘–+1âˆ’â†’âˆ’(ğ‘).

Fig. 8
figure 8
Illustration of the proof of Theorem 4

Full size image
Proof
Consider the triangle with vertices ğ‘1, ğ‘2, and ğ‘3. Let ğ›½1,ğ›½2,ğ›½3 denote the interior angles of this triangle at ğ‘1,ğ‘2,ğ‘3 respectively, and note that ğ›½1+ğ›½2+ğ›½3=ğœ‹. Without loss of generality assume that ğ›½1â©½ğ›½2â©½ğ›½3, and thus |ğ‘2ğ‘3|â©½|ğ‘1ğ‘3|â©½|ğ‘1ğ‘2|. After a suitable reflection assume that ğ‘3 appears to the left of the ray from ğ‘1 towards ğ‘2. We consider two cases where ğ›¼3â©¾ğ›½3 and ğ›¼3<ğ›½3. For each case we show how to place three wedges ğ‘¤1, ğ‘¤2, ğ‘¤3 (with angles ğ›¼1,ğ›¼2,ğ›¼3) at points ğ‘1,ğ‘2,ğ‘3, respectively, to satisfy the conditions of the theorem.

Let [ğ‘Ÿ1â†’(ğ‘¥),ğ‘Ÿ2â†’(ğ‘¥),ğ‘Ÿ3â†’(ğ‘¥)] be the cyclic counterclockwise permutation of three rays emanating from some point x in the plane such that the angle at each cone ğ‘ğ‘–(ğ‘¥) is ğ›¼ğ‘– for ğ‘–âˆˆ{1,2,3}. Let R(x) denote a fixed embedding of these rays in the plane, as in Fig. 8a.

ğ›¼3â©¾ğ›½3. Translate R(x) so that x lies on ğ‘3, i.e., ğ‘¥=ğ‘3. Rotate R(x) so that ğ‘1 and ğ‘2 lie in ğ‘3(ğ‘3) and ğ‘Ÿ2â†(ğ‘3) intersects the segment ğ‘1ğ‘2 (observe the existence of such rotation). Place ğ‘¤1, ğ‘¤2, and ğ‘¤3 at cones ğ‘1(ğ‘3), ğ‘2(ğ‘3), and ğ‘3(ğ‘3), respectively. The union of these wedges covers the entire pane. Now translate ğ‘¤1 and ğ‘¤2 so that their apices lie on ğ‘1 and ğ‘2, respectively, as in Fig. 8b. The union of the three wedges still covers the plane. In this setting, ğ‘3 and ğ‘1 are mutually visible and so are ğ‘3 and ğ‘2. Thus, the mutual-visibility graph contains the shortest tree on P with edges ğ‘‡1={ğ‘3â†”ğ‘1,ğ‘3â†”ğ‘2}.

ğ›¼3<ğ›½3. We claim that ğ›¼2â©¾ğ›½2. For the sake of contradiction assume that ğ›¼2<ğ›½2. Then ğ›¼1+ğ›½2+ğ›½3>ğ›¼1+ğ›¼2+ğ›¼3=2ğœ‹. Since ğ›½2 and ğ›½3 are interior angles of a triangle, ğ›½2+ğ›½3â©½ğœ‹. By combining these two inequalities we get ğ›¼1>ğœ‹, which contradicts that ğ›¼1,ğ›¼2,ğ›¼3â©½ğœ‹. Thus our claim follows.

Translate R(x) so that x lies on ğ‘2. Rotate R(x) so that ğ‘1 and ğ‘3 lie in ğ‘2(ğ‘2) and ğ‘Ÿ1â†(ğ‘2) intersects the segment ğ‘1ğ‘3. Place ğ‘¤1, ğ‘¤2,ğ‘¤3 at cones ğ‘1(ğ‘2), ğ‘2(ğ‘2), ğ‘3(ğ‘2). Translate ğ‘¤1 and ğ‘¤3 so that their apices lie on ğ‘1 and ğ‘3, respectively, as in Fig. 8c. Again the three wedges cover the entire plane, and the mutual-visibility graph contains the intermediate tree on P with edges ğ‘‡2={ğ‘2â†”ğ‘1,ğ‘2â†”ğ‘3}.

â—»

Remark 1
Our proof of Theorem 4 has the following property: if x is a point of P at which R(x) is placed then each cone ğ‘ğ‘–â¯â¯â¯â¯(ğ‘¥) contains a point of P whose wedge covers ğ‘ğ‘–(ğ‘¥). For one of the cones, this point is x itself.

Proof of Theorem 5
In this section we prove the following theorem. We use notations introduced in Sect. 3.3.

Theorem 5Let ğ‘ƒ1 and ğ‘ƒ2 be two disjoint sets, each containing three points in the plane, such that {ğ‘ƒ1,ğ‘ƒ2} is not forbidden. Assume that a wedge of angle 2ğœ‹/3 is placed at each point of ğ‘ƒ1 and at each point of ğ‘ƒ2 according to the placement algorithm of Corollary 1. Then, the induced mutual-visibility graph on ğ‘ƒ1âˆªğ‘ƒ2 is connected, and hence it contains a 2ğœ‹/3-ST.

We use the notation introduced in Sect. 3.3. Let ğ‘ƒ1={ğ‘,ğ‘,ğ‘} and ğ‘ƒ2={ğ‘â€²,ğ‘â€²,ğ‘â€²}. Orient ğ‘ƒ1 and ğ‘ƒ2 according to Corollary 1 (in fact according to the proof of Theorem 4 with angles 2ğœ‹/3). Let ğ‘¤ğ‘, ğ‘¤ğ‘, ğ‘¤ğ‘, ğ‘¤ğ‘â€², ğ‘¤ğ‘â€² and ğ‘¤ğ‘â€² be the wedges of angle 2ğœ‹/3 that are placed at these points, respectively. Recall, from the proof of Theorem 4, three rays [ğ‘Ÿ1â†’(ğ‘¥),ğ‘Ÿ2â†’(ğ‘¥),ğ‘Ÿ3â†’(ğ‘¥)] with cones of angle 2ğœ‹/3 placed at a point x. In the orientation of ğ‘ƒ1 we may assume that these rays are placed at a, i.e., ğ‘¥=ğ‘. Thus b and c lie in the same cone ğ‘ğ‘–(ğ‘) for some ğ‘–âˆˆ{1,2,3}; in particular one of them lies in ğ‘ğ‘–ğ¿(ğ‘) and the other lies in ğ‘ğ‘–ğ‘…(ğ‘). Moreover ğ‘¤ğ‘ covers ğ‘ğ‘–(ğ‘) and we have ğ‘â†”ğ‘ and ğ‘â†”ğ‘. In the orientation of ğ‘ƒ2 assume that these rays are placed at ğ‘â€². Thus one of ğ‘â€² and ğ‘â€² lies in ğ‘ğ‘—ğ¿(ğ‘â€²) and the other lies in ğ‘ğ‘—ğ‘…(ğ‘â€²) for some ğ‘—âˆˆ{1,2,3}, ğ‘¤ğ‘â€² covers ğ‘ğ‘—(ğ‘â€²), and we have ğ‘â€²â†”ğ‘â€² and ğ‘â€²â†”ğ‘â€². By Remark 1 each cone ğ‘ğ‘–â¯â¯â¯â¯(ğ‘) contains a point of ğ‘ƒ1 whose wedge covers ğ‘ğ‘–(ğ‘), and similarly each cone ğ‘ğ‘—â¯â¯â¯â¯â¯(ğ‘â€²) contains a point of ğ‘ƒ2 whose wedge covers ğ‘ğ‘—(ğ‘â€²).

Fig. 9
figure 9
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect but ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) do not intersect

Full size image
Fig. 10
figure 10
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) do not intersect, and ğ‘â€²âˆˆğ‘3ğ¿(ğ‘â€²)âˆ©ğ‘1(ğ‘)

Full size image
Since the three cones ğ‘1(ğ‘), ğ‘2(ğ‘), and ğ‘3(ğ‘) cover the plane, ğ‘â€² lies in one of them, say ğ‘3(ğ‘). Similarly, a lies in one of the three cones at ğ‘â€², say ğ‘2(ğ‘â€²). In this setting one of the following three configurations holds:

(A)
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, but ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) do not intersect. See Figs. 9, 10 and 11.

(B)
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) do not intersect, but ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) intersect.

(C)
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, and ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) intersect. See Figs. 12 and 13.

We consider each configuration separately. Since configurations (A) and (B) are symmetric, we describe only (A) and (C).

Configuration (A). Let d be the intersection point of ğ‘Ÿ1â†’(ğ‘) with ğ‘Ÿ2â†’(ğ‘â€²), and let ğ›¾ denote the convex angle âˆ ğ‘ğ‘‘ğ‘â€², as in Fig. 9. Since ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) do not intersect, ğ›¾â©¾2ğœ‹/3, and consequently ğ‘â€² lies in ğ‘3ğ¿(ğ‘) and a lies in ğ‘2ğ‘…(ğ‘â€²). Recall that each cone at a (resp. ğ‘â€²) is covered by a wedge at a point of ğ‘ƒ1 (resp. ğ‘ƒ2). Let ğ‘¥âˆˆğ‘ƒ1 be the point in ğ‘3â¯â¯â¯â¯â¯(ğ‘) whose wedge ğ‘¤ğ‘¥ covers ğ‘3(ğ‘), and let ğ‘¥â€²âˆˆğ‘ƒ2 be the point in ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²) whose wedge ğ‘¤ğ‘¥â€² covers ğ‘2(ğ‘â€²). If ğ‘¥âˆˆğ‘3â¯â¯â¯â¯â¯(ğ‘)âˆ©ğ‘2(ğ‘â€²) and ğ‘¥â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ©ğ‘3(ğ‘) (the dark-gray regions in Fig. 9) then ğ‘¥â†”ğ‘¥â€² and we are done. Therefore we may assume that ğ‘¥âˆˆğ‘3â¯â¯â¯â¯â¯(ğ‘)âˆ–ğ‘2(ğ‘â€²) or ğ‘¥â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ–ğ‘3(ğ‘). By symmetry we assume that ğ‘¥â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ–ğ‘3(ğ‘) (the light-gray region in Fig. 10). This and the fact that ğ‘â€²âˆˆğ‘3(ğ‘) imply that ğ‘¥â€²â‰ ğ‘â€², and thus ğ‘¥â€²âˆˆ{ğ‘â€²,ğ‘â€²}. After a suitable relabeling we assume that ğ‘¥â€²=ğ‘â€². Therefore, ğ‘¤ğ‘â€² covers ğ‘2(ğ‘â€²).

Fig. 11
figure 11
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) do not intersect, and ğ‘â€²âˆˆğ‘1ğ‘…(ğ‘â€²)âˆ©ğ‘1(ğ‘)

Full size image
Since ğ›¾â©¾2ğœ‹/3 and ğ‘â€²âˆˆğ‘3ğ¿(ğ‘), the rays ğ‘Ÿ3â†(ğ‘â€²) and ğ‘Ÿ2â†(ğ‘â€²) do not intersect ğ‘™2(ğ‘) (which is the line through ğ‘Ÿ2â†’(ğ‘)), and consequently the cone ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²) does not intersect ğ‘™2(ğ‘) and hence this cone is disjoint from ğ‘2(ğ‘). Therefore, ğ‘â€²â€”which is in ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ–ğ‘3(ğ‘)â€”lies in ğ‘1(ğ‘). Let ğ‘¦âˆˆğ‘ƒ1 be the point in ğ‘1â¯â¯â¯â¯â¯(ğ‘) whose wedge ğ‘¤ğ‘¦ covers ğ‘1(ğ‘). Since ğ‘â€²âˆˆğ‘1(ğ‘), the point y sees ğ‘â€², as in Fig. 10. If ğ‘¦âˆˆğ‘1â¯â¯â¯â¯â¯(ğ‘)âˆ©ğ‘¤ğ‘â€² (the dark-blue region) then ğ‘â€² sees y, and hence ğ‘¦â†”ğ‘â€² and we are done. Assume that ğ‘¦âˆˆğ‘1â¯â¯â¯â¯â¯(ğ‘)âˆ–ğ‘¤ğ‘â€², and hence it is not in ğ‘2(ğ‘â€²). Since ğ‘¦âˆˆğ‘1â¯â¯â¯â¯â¯(ğ‘) and ğ‘1â¯â¯â¯â¯â¯(ğ‘) is disjoint from ğ‘1(ğ‘â€²), the point y is not in ğ‘1(ğ‘â€²) either. Thus y lies in ğ‘3(ğ‘â€²). In this setting, ğ‘¤ğ‘¦ covers the region ğ‘3ğ¿(ğ‘)âˆ©ğ‘¤ğ‘â€² which contains ğ‘â€². Thus, y sees ğ‘â€². Recall that ğ‘â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ©ğ‘1(ğ‘). Since ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)=ğ‘3ğ¿(ğ‘â€²)âˆªğ‘1ğ‘…(ğ‘â€²) we consider two cases where ğ‘â€²âˆˆğ‘3ğ¿(ğ‘â€²)âˆ©ğ‘1(ğ‘) and ğ‘â€²âˆˆğ‘1ğ‘…(ğ‘â€²)âˆ©ğ‘1(ğ‘).

ğ‘â€²âˆˆğ‘3ğ¿(ğ‘â€²)âˆ©ğ‘1(ğ‘). This case is depicted in Fig. 10. Since ğ‘â€²âˆˆğ‘3(ğ‘â€²) and ğ‘¤ğ‘â€² covers the cone that contains ğ‘â€² (and also ğ‘â€²), it covers ğ‘3(ğ‘â€²). Therefore, ğ‘â€² sees y which lies in ğ‘3(ğ‘â€²), and hence ğ‘¦â†”ğ‘â€² and we are done.

ğ‘â€²âˆˆğ‘1ğ‘…(ğ‘â€²)âˆ©ğ‘1(ğ‘). This case is depicted in Fig. 11. Since ğ‘â€²âˆˆğ‘1(ğ‘â€²) and ğ‘¤ğ‘â€² covers the cone that contains ğ‘â€², it covers ğ‘1(ğ‘â€²). Since ğ‘¦âˆˆğ‘3(ğ‘â€²) and ğ‘âˆˆğ‘2(ğ‘â€²), we have ğ‘¦â‰ ğ‘ and thus ğ‘¦âˆˆ{ğ‘,ğ‘}. After a suitable relabeling we assume that ğ‘¦=ğ‘. Therefore ğ‘¤ğ‘ covers ğ‘1(ğ‘), and ğ‘¤ğ‘ covers the cone ğ‘3(ğ‘) which contains b. Since b lies in ğ‘3ğ‘…(ğ‘), the point c lies in ğ‘3ğ¿(ğ‘). Notice that ğ‘¤ğ‘ covers ğ‘2(ğ‘) (which is not covered by ğ‘¤ğ‘âˆªğ‘¤ğ‘).

Since ğ‘â€²âˆˆğ‘1ğ‘…(ğ‘â€²), the points ğ‘â€² lies in ğ‘1ğ¿(ğ‘â€²) and ğ‘¤ğ‘â€² covers ğ‘3(ğ‘â€²), and hence sees b. If ğ‘â€²âˆˆğ‘1ğ¿(ğ‘â€²)âˆ©ğ‘¤ğ‘ (the dark-orange region in Fig. 11) then b sees ğ‘â€² and we get ğ‘â€²â†”ğ‘. Assume that ğ‘â€²âˆˆğ‘1ğ¿(ğ‘â€²)âˆ–ğ‘¤ğ‘ (the light-orange region). This region is to the left of ğ‘¤ğ‘â†âˆ’ which is parallel to ğ‘Ÿ2â†’(ğ‘); in particular this region is a subset of ğ‘2ğ‘…(ğ‘) which is covered by ğ‘¤ğ‘. Thus c sees ğ‘â€². We are going to show that ğ‘â€² also sees c. Notice that ğ‘2ğ‘…(ğ‘) (which contains ğ‘â€²) is the reflection of ğ‘3ğ¿(ğ‘) (which contains c) with respect to a. This and the fact that ğ‘¤ğ‘â€²â†âˆ’âˆ’ is parallel to ğ‘Ÿ1â†’(ğ‘â€²) which intersects ğ‘Ÿ1â†’(ğ‘) (because ğ›¾â©¾2ğœ‹/3) imply that ğ‘¤ğ‘â€²â†âˆ’âˆ’ does not intersect ğ‘Ÿ1â†’(ğ‘). Moreover, since ğ‘¤ğ‘â€²âˆ’â†’âˆ’ is parallel to ğ‘Ÿ3â†’(ğ‘â€²) which intersects ğ‘Ÿ2â†(ğ‘) (because ğ›¾<ğœ‹), ğ‘¤ğ‘â€²âˆ’â†’âˆ’ does not intersect ğ‘Ÿ2â†(ğ‘). Thus ğ‘¤ğ‘â€²âˆ’â†’âˆ’ and ğ‘¤ğ‘â€²â†âˆ’âˆ’ do not intersect the boundary rays ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†(ğ‘) of ğ‘3ğ¿(ğ‘), and hence ğ‘¤ğ‘â€² covers ğ‘3ğ¿(ğ‘) which contains ğ‘â€². Therefore ğ‘â€² sees c and hence ğ‘â€²â†”ğ‘.

Fig. 12
figure 12
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) intersect, and ğ‘â€²âˆˆğ‘3ğ¿(ğ‘)

Full size image
Configuration (C). In this configuration ğ‘Ÿ1â†’(ğ‘â€²) does not intersect any of ğ‘Ÿ1â†’(ğ‘), ğ‘Ÿ2â†’(ğ‘), ğ‘Ÿ3â†’(ğ‘), and ğ‘Ÿ2â†’(ğ‘) does not intersect any of ğ‘Ÿ1â†’(ğ‘â€²), ğ‘Ÿ2â†’(ğ‘â€²), ğ‘Ÿ3â†’(ğ‘â€²). Let d be the intersection point of ğ‘Ÿ1â†’(ğ‘) with ğ‘Ÿ2â†’(ğ‘â€²), and e be the intersection point of ğ‘Ÿ3â†’(ğ‘) with ğ‘Ÿ3â†’(ğ‘â€²), as in Figs. 12 and 13. Let ğ›¾ denote the convex angle âˆ ğ‘ğ‘‘ğ‘â€², and ğ›½ denote the convex angle âˆ ğ‘ğ‘’ğ‘â€². After a suitable relabeling we assume that ğ›¾â©¾ğ›½, and thus ğ›¾â©¾ğœ‹/3 (notice that the sum of the interior angles of the convex quadrilateral with vertices ğ‘,ğ‘‘,ğ‘â€²,ğ‘’ is 2ğœ‹). This and the fact that âˆ ğ‘’ğ‘ğ‘‘=2ğœ‹/3 imply that ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ2â†(ğ‘â€²) do not intersect. Since ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) intersect, their opposite rays ğ‘Ÿ3â†(ğ‘) and ğ‘Ÿ3â†(ğ‘â€²) do not intersect.

Let ğ‘¥âˆˆğ‘ƒ1 be the point in ğ‘3â¯â¯â¯â¯â¯(ğ‘) whose wedge ğ‘¤ğ‘¥ covers ğ‘3(ğ‘), and let ğ‘¥â€²âˆˆğ‘ƒ2 be the point in ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²) whose wedge ğ‘¤ğ‘¥â€² covers ğ‘2(ğ‘â€²). As in configuration (A) if ğ‘¥âˆˆğ‘3â¯â¯â¯â¯â¯(ğ‘)âˆ©ğ‘2(ğ‘â€²) and ğ‘¥â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ©ğ‘3(ğ‘) (the dark-gray regions in Figs. 12 and 13) then ğ‘¥â†”ğ‘¥â€². Therefore we may assume by symmetry that ğ‘¥â€²âˆˆğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ–ğ‘3(ğ‘). This and the fact that ğ‘â€²âˆˆğ‘3(ğ‘) imply that ğ‘¥â€²â‰ ğ‘â€² and thus ğ‘¥â€²âˆˆ{ğ‘â€²,ğ‘â€²}. After a suitable relabeling we assume that ğ‘¥â€²=ğ‘â€², and thus ğ‘¤ğ‘â€² covers ğ‘2(ğ‘â€²), as in Figs. 12 and 13. The region ğ‘2â¯â¯â¯â¯â¯(ğ‘â€²)âˆ–ğ‘3(ğ‘) (shown by light-gray color in Figs. 12 and 13) which contains ğ‘â€² is in fact equal to ğ‘1ğ‘…(ğ‘â€²)âˆ©ğ‘1ğ‘…(ğ‘).

The wedge ğ‘¤ğ‘â€² covers ğ‘1(ğ‘â€²) which contains ğ‘â€². Since ğ‘â€² lies in ğ‘1ğ‘…(ğ‘â€²), the point ğ‘â€² lies in ğ‘1ğ¿(ğ‘â€²) and ğ‘¤ğ‘â€² covers ğ‘3(ğ‘â€²). Let ğ‘¦âˆˆğ‘ƒ1 be the point in ğ‘1â¯â¯â¯â¯â¯(ğ‘) whose wedge ğ‘¤ğ‘¦ covers ğ‘1(ğ‘). Since ğ‘â€²âˆˆğ‘1(ğ‘), y sees ğ‘â€². If ğ‘¦âˆˆğ‘1â¯â¯â¯â¯â¯(ğ‘)âˆ©ğ‘¤ğ‘â€² (the dark-blue regions in Figs. 12 and 13) then ğ‘â€² sees y and thus ğ‘¦â†”ğ‘â€² and we are done. Assume that ğ‘¦âˆˆğ‘1â¯â¯â¯â¯â¯(ğ‘)âˆ–ğ‘¤ğ‘â€² (the light-blue regions). This and the fact that a lies in ğ‘2(ğ‘â€²) (which is covered by ğ‘¤ğ‘â€²) imply that ğ‘¦â‰ ğ‘ and thus ğ‘¦âˆˆ{ğ‘,ğ‘}. After a suitable relabeling we assume that ğ‘¦=ğ‘. Our assumption that b is not in ğ‘¤ğ‘â€² implies that ğ‘âˆ‰ğ‘2(ğ‘â€²). Recall that ğ‘â€² is in ğ‘3(ğ‘) and thus it lies either in ğ‘3ğ¿(ğ‘) or in ğ‘3ğ‘…(ğ‘). We describe each case separately.

Fig. 13
figure 13
ğ‘Ÿ1â†’(ğ‘) and ğ‘Ÿ2â†’(ğ‘â€²) intersect, ğ‘Ÿ3â†’(ğ‘) and ğ‘Ÿ3â†’(ğ‘â€²) intersect, and ğ‘â€²âˆˆğ‘3ğ‘…(ğ‘)

Full size image
ğ‘â€²âˆˆğ‘3ğ¿(ğ‘). This case is depicted in Fig. 12. In this case ğ‘Ÿ1â†’(ğ‘â€²) and ğ‘Ÿ2â†(ğ‘) do not intersect because ğ›¾â©¾ğœ‹/3. Thus ğ‘1â¯â¯â¯â¯â¯(ğ‘) and ğ‘1(ğ‘â€²) are disjoint, and hence ğ‘âˆ‰ğ‘1(ğ‘â€²). Therefore ğ‘âˆˆğ‘3(ğ‘â€²) and thus ğ‘â€² sees b. The boundary rays ğ‘¤ğ‘â†âˆ’ and ğ‘¤ğ‘âˆ’â†’ of ğ‘¤ğ‘ do not intersect the boundary rays ğ‘Ÿ2â†’(ğ‘â€²) and ğ‘Ÿ3â†(ğ‘â€²) of cone ğ‘1ğ¿(ğ‘â€²) which contains ğ‘â€². Therefore ğ‘¤ğ‘ covers ğ‘1ğ¿(ğ‘â€²). This implies that b sees ğ‘â€², and hence ğ‘â†”ğ‘â€².

ğ‘â€²âˆˆğ‘3ğ‘…(ğ‘). See Fig. 13. If ğ‘â€² is to the left side of ğ‘Ÿ2â†(ğ‘) then ğ‘â†”ğ‘â€² and we are done. Assume that ğ‘â€² is to the right side of ğ‘Ÿ2â†(ğ‘), and thus ğ‘â€²âˆˆğ‘3ğ‘…(ğ‘). If ğ‘â€² is to the right side of ğ‘¤ğ‘â†âˆ’ then again ğ‘â†”ğ‘â€² and we are done. Assume that ğ‘â€² is to the left side of ğ‘¤ğ‘â†âˆ’, which implies that ğ‘âˆˆğ‘3ğ‘…(ğ‘) (we already knew that b is in ğ‘1â¯â¯â¯â¯â¯(ğ‘)=ğ‘2ğ¿(ğ‘)âˆªğ‘3ğ‘…(ğ‘)). Therefore ğ‘¤ğ‘ covers ğ‘3(ğ‘) which contains b, and thus c lies in ğ‘3ğ¿(ğ‘). This setting is depicted in Fig. 13. We show that this is an invalid setting for points in ğ‘ƒ1 and ğ‘ƒ2.

Consider the line through a and b. In the current setting ğ‘â€² and ğ‘â€² lie on the same side of this line, but ğ‘â€² lies on the other side. The points ğ‘â€² and ğ‘â€² are to the left side of the ray ğ‘â€²ğ‘âˆ’â†’ (because ğ‘â€²ğ‘âˆ’â†’ does not intersect the interior of ğ‘3(ğ‘) which contains ğ‘â€² and ğ‘â€²) and to the right side of the ray ğ‘â€²ğ‘âˆ’â†’ (because b is to the left side of ğ‘¤ğ‘â€²â†âˆ’âˆ’ while ğ‘â€² and ğ‘â€² are to its right side); see also Fig. 14. Therefore ğ‘â€² and ğ‘â€² lie in the convex cone with boundary rays ğ‘â€²ğ‘âˆ’â†’ and ğ‘â€²ğ‘âˆ’â†’. Since c is in ğ‘3ğ¿(ğ‘), it is also in the convex cone with boundary rays ğ‘ğ‘â€²âˆ’â†’ and ğ‘ğ‘âˆ’â†’. As depicted in Fig. 14, no matter whereâ€”in this coneâ€”c lies, the two triangles defined by the vertices of ğ‘ƒ1 and ğ‘ƒ2 form one of the forbidden configurations of Fig. 6. This is impossible because {ğ‘ƒ1,ğ‘ƒ2} is not forbidden by the statement of the theorem.

Fig. 14
figure 14
The point c lies in the shaded cone with boundary rays ğ‘ğ‘â€²âˆ’â†’ and ğ‘ğ‘âˆ’â†’

Full size image
Approximating the 2ğœ‹/3â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯-MST
In this section we prove the following theorem.

Theorem 6
Given a set of points in the plane and an angle ğ›¼â©¾2ğœ‹/3, there is an ğ›¼â¯â¯â¯-spanning tree of length at most 1.5 times the length of the MST and with edges of length at most 2 times the largest edge-length of the BST. Furthermore, there is an algorithm to find such an ğ›¼â¯â¯â¯-ST that runs in linear time after computing the MST.

Let P be a set of points in the plane. As in previous sections we assume that ğ›¼=2ğœ‹/3. Let T be a degree-5 MST of P. We assign to each vertex of T an initial angle ğ›¼ which we refer to as â€œchargeâ€. The initial charge of a vertex may not cover all its incident edges. The idea is to modify the tree locally and transfer charges between nodes to make sure that all vertices have enough charges to cover their incident edges in the new tree. Mainly we transfer charges from leaves to internal vertices, because edges incident to leaves can be covered by wedges of angle zero (however at the end of this section we assign positive wedges to all leaves).

Assume that T is not a path and thus has a vertex of degree at least 3 (we describe the case where T is a path at the end of this section). A maximal path in T is a path with at least two edges where its internal-node degrees are 2 and its end-node degrees are not 2.

Our algorithm has two phases. Phase 1 works as follows. Contract every maximal path of T to an edge (this is done by removing the internal nodes of the path and connecting its endpoints by an edge). This results in a tree ğ‘‡â€² that has no vertex of degree 2, and moreover, the degree of each vertex in ğ‘‡â€² is the same as its degree in T. Let â„“ denote the number of leaves of ğ‘‡â€² and let ğ‘›3, ğ‘›4, and ğ‘›5 denote the number of vertices of degree three, four, and five in ğ‘‡â€² respectively. Since each vertex of degree three, four, and five introduces 1, 2, and 3 new leaves respectively, we have â„“=2+ğ‘›3+2ğ‘›4+3ğ‘›5. We consider the â„“â‹…ğ›¼ charges of all leaves as a â€œpool of chargesâ€ that are available to be distributed among other vertices. From this pool, we give the charge ğ›¼, 2ğ›¼, and 3ğ›¼ to each vertex of degree three, four, and five respectively. After this redistribution, every vertex of degree three, four, and five holds the charge 4ğœ‹/3, 2ğœ‹, and 8ğœ‹/3 respectively (including its initial 2ğœ‹/3 charge), which is sufficient to cover all its incident edges. Moreover, the pool is left with 2ğ›¼ charges.

Based on the above discussion if T has no degree-2 vertices, then it is an ğ›¼â¯â¯â¯-ST and we are done. Now we describe Phase 2 which takes care of contracted paths; here is the place where our tree gains an extra 0.5w(T) length. Consider every contracted path and denote it by (ğ‘1,ğ‘2,â€¦,ğ‘ğ‘š) if it has an even number of edges and by (ğ‘1,ğ‘2,â€¦,ğ‘ğ‘š,ğ‘ğ‘š+1) if it has an odd number of edges. One endpoint of this path, say ğ‘1, has degree at least 3 in T and the other endpoint either is a leaf or it has degree at least 3 (see Fig. 15). The charges of the two endpoints of the path have already been considered in Phase 1, but the charges of its internal nodes are untouched. Let ğœ denote the path (ğ‘1,ğ‘2,â€¦,ğ‘ğ‘š); ğœ does not contain ğ‘ğ‘š+1 if this point exists. Observe that ğ‘šâ©¾3. Partition the edges of ğœ into matchings ğœ1={(ğ‘1,ğ‘2),(ğ‘3,ğ‘4),â€¦} and ğœ2={(ğ‘2,ğ‘3),(ğ‘4,ğ‘5),â€¦}, as in Fig. 15. Let ğœmax denote the heavier of ğœ1 and ğœ2 (i.e., the one with larger total length) and ğœmin denote the lighter one. Thus ğ‘¤(ğœmin)â©½ğ‘¤(ğœmax) and hence ğ‘¤(ğœmin)â©½0.5ğ‘¤(ğœ). We replace the edge set ğœmax in T by the edge set ğ›¿={(ğ‘1,ğ‘3),(ğ‘3,ğ‘5),â€¦,(ğ‘ğ‘šâˆ’2,ğ‘ğ‘š)}, as in Fig. 15. Let ğ‘‡â€³ be the tree obtained after performing this replacement for all contracted paths. Note that ğ‘‡â€³ can be constructed in linear time from T.

We claim that ğ‘‡â€³ is a desired ğ›¼â¯â¯â¯-ST. First we show that ğ‘¤(ğ‘‡â€³)â©½1.5ğ‘¤(ğ‘‡). To do so, it suffices to show that, for each contracted path, the length of edges after replacement (i.e., edges of ğœmin and ğ›¿) is not more than 1.5 times the length of original edges (i.e., edges of ğœ). By the triangle inequality, ğ‘¤(ğ›¿)â©½ğ‘¤(ğœ). Therefore ğ‘¤(ğ›¿)+ğ‘¤(ğœmin)â©½ğ‘¤(ğœ)+0.5ğ‘¤(ğœ)â©½1.5ğ‘¤(ğœ); this proves the total-length constraint of Theorem 6. Moreover, the length of every edge of ğ›¿ is at most twice the largest edge-length of ğœ (again by the triangle inequality); this proves the largest edge-length constraint of Theorem 6. It remains to ensure the coverage of incident edges for all vertices of ğ‘‡â€³. To that end we distribute the charges of ğ‘2,ğ‘4,â€¦,ğ‘ğ‘šâˆ’1 (which are new leaves) among other vertices. We consider two cases depending on the existence of ğ‘ğ‘š+1. First assume that ğ‘ğ‘š+1 does not exist. Now we consider two sub-cases depending on which of ğœ1 and ğœ2 is heavier (i.e., is ğœmax).

Fig. 15
figure 15
The contracted path is shown by black segments. The dashed-black edges belong to ğœmax and the red edges belong to ğ›¿

Full size image
ğœmax=ğœ1. In this case ğœ1 has been replaced by ğ›¿. This replacement has not changed the degree of ğ‘1 and thus it holds enough charge (from Phase 1) to cover its incident edges. We move the charges of leaves ğ‘2, ğ‘4, â€¦,ğ‘ğ‘šâˆ’1 to vertices ğ‘3,ğ‘5,â€¦,ğ‘ğ‘š respectively (see Fig. 15-top). Each of ğ‘3,ğ‘5,â€¦,ğ‘ğ‘šâˆ’2 has degree three and now holds 4ğœ‹/3 charge (including its own 2ğœ‹/3 charge) which is sufficient to cover its incident edges. Now consider ğ‘ğ‘š and notice that its degree has been increased by one. If ğ‘ğ‘š is of degree at least 3 in T, then it now holds at least 2ğœ‹ charge (2ğœ‹/3 from ğ‘ğ‘šâˆ’1 and at least 4ğœ‹/3 from Phase 1) which covers all its incident edges. Assume that ğ‘ğ‘š is a leaf in T, and thus it has degree 2 in ğ‘‡â€³. The original charge of ğ‘ğ‘š has been distributed among other vertices in Phase 1, but it now has 2ğœ‹/3 charge coming from ğ‘ğ‘šâˆ’1. Consider the triangle â–³ğ‘ğ‘šğ‘ğ‘šâˆ’1ğ‘ğ‘šâˆ’2. The segment ğ‘ğ‘šğ‘ğ‘šâˆ’2 is the largest side of this triangle because otherwise we could add this edge to the MST and remove the larger of the other two sides to obtain a smaller tree. Thus the angle at ğ‘ğ‘šâˆ’1 is the largest angle of this triangle, and hence the other two angles (including the one at ğ‘ğ‘š) are at most ğœ‹/2. Therefore the two edges incident to ğ‘ğ‘š can be covered by its 2ğœ‹/3 charge.

ğœmax=ğœ2. Then ğœ2 has been replaced by ğ›¿. We move the charges of ğ‘2, ğ‘4, â€¦,ğ‘ğ‘šâˆ’1 to ğ‘1,ğ‘3,â€¦,ğ‘ğ‘šâˆ’2 respectively (see Fig. 15-second from top). The replacement does not change the degree of ğ‘ğ‘š and thus it holds enough charge from Phase 1 to cover its incident edges. Each of ğ‘3, ğ‘5, â€¦,ğ‘ğ‘šâˆ’2 has degree three and now holds 4ğœ‹/3 charge which covers its incident edges. The vertex ğ‘1 now has at least 2ğœ‹ charge (2ğœ‹/3 from ğ‘2 and at least 4ğœ‹/3 from Phase 1) which covers all its incident edges.

Now assume that ğ‘ğ‘š+1 exists. Again we consider two sub-cases.

ğœmax=ğœ1. Move the charges of ğ‘2,ğ‘4,â€¦,ğ‘ğ‘šâˆ’1 to ğ‘3,ğ‘5,â€¦,ğ‘ğ‘š (see Fig. 15-third from top). The degrees of ğ‘1 and ğ‘ğ‘š+1 have not changed in Phase 2, and thus they hold enough charge from Phase 1 to cover their incident edges. Each of ğ‘3,ğ‘5,â€¦,ğ‘ğ‘š has degree three and now holds 4ğœ‹/3 charge which covers its incident edges.

ğœmax=ğœ2. Move the charges of ğ‘4,ğ‘6â€¦,ğ‘ğ‘šâˆ’1 to ğ‘3,ğ‘5,â€¦,ğ‘ğ‘šâˆ’2. Split the 2ğœ‹/3 charge of ğ‘2 evenly between ğ‘1 and ğ‘ğ‘š as in Fig. 15-bottom. The degree of ğ‘ğ‘š+1 has not changed and thus it holds enough charge from Phase 1. Each of ğ‘3,ğ‘5,â€¦,ğ‘ğ‘šâˆ’2 has degree three and now holds enough charge 4ğœ‹/3. The vertex ğ‘ğ‘š has degree two and now holds ğœ‹ charge (including its original 2ğœ‹/3 charge) which is sufficient to cover its two incident edges. Now consider ğ‘1. If it has degree 4 or 5 in T then after Phase 1 it holds at least 2ğœ‹ charge which covers all its incident edges. Assume that it has degree 3 in T, and now it has degree 4 in ğ‘‡â€³. Then it holds 5ğœ‹/3 charge (ğœ‹/3 from ğ‘2 and 4ğœ‹/3 from Phase 1) which is enough to cover its four incident edges (in fact 3ğœ‹/2 is enough). It might be the case that ğ‘1 was also incident to another contracted path and hence has received another incident edge which increases ğ‘1â€™s degree to five. In this case ğ‘1 also receives ğœ‹/3 charge from the other path. This would increase ğ‘1â€™s charge to 2ğœ‹ which covers all its incident edges.

Now we consider the case where T is a path. In this case we run only Phase 2 of the above algorithm on this path. Since there is no Phase 1, the charges of path endpoints are still available. The charge redistribution of Phase 2 guarantees the coverage of incident edges of all vertices. See Fig. 15. If ğ‘ğ‘š+1 does not exist then in the first sub-case (resp. the second sub-case) the charge of ğ‘1 (resp. ğ‘ğ‘š) remains unused. If ğ‘ğ‘š+1 exists, then its charge remains unused.

At the end of the algorithm we have at least 2ğœ‹/3 unused charge (from the pool or from a path endpoint). We split the unused charge evenly among all vertices such that every vertex has a positive charge and its incident edges lie strictly inside the assigned wedge.

Conclusions
The obvious open problem is to improve our 16/3 approximation ratio for the 2ğœ‹/3-MST problem further by designing better algorithms. Our proof relies on the fact that the orientation of the wedges of every triplet covers the entire plane. Such orientations are a bottleneck for our ratio. It might be possible to get a better ratio with orientations that do not necessarily cover the entire plane. Another bottleneck is the use of a Hamiltonian path which forces a factor of 2 in the ratio. It might be possible to get better ratios by using the original MST instead of the path. However, this has to be done in a clever way as the number of connecting edges incident to a triplet may increase.