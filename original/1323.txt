A graph ğº=(ğ‘‰,ğ¸) is a double-threshold graph if there exist a vertex-weight function ğ‘¤:ğ‘‰â†’â„ and two real numbers ğš•ğš‹,ğšğš‹âˆˆâ„ such that ğ‘¢ğ‘£âˆˆğ¸ if and only if ğš•ğš‹â‰¤ğš (ğ‘¢)+ğš (ğ‘£)â‰¤ğšğš‹. In the literature, those graphs are studied also as the pairwise compatibility graphs that have stars as their underlying trees. We give a new characterization of double-threshold graphs that relates them to bipartite permutation graphs. Using the new characterization, we present a linear-time algorithm for recognizing double-threshold graphs. Prior to our work, the fastest known algorithm by Xiao and Nagamochi [Algorithmica 2020] ran in ğ‘‚(ğ‘›3ğ‘š) time, where n and m are the numbers of vertices and edges, respectively.

Introduction
A graph is a threshold graph if there exist a vertex-weight function and a real number called a weight lower bound such that two vertices are adjacent in the graph if and only if the associated vertex weight sum is at least the weight lower bound. Threshold graphs and their generalizations are well studied because of their beautiful structures and applications in many areas [6, 15]. In particular, the edge-intersections of two threshold graphs, and their complements (i.e., the union of two threshold graphs) have attracted several researchers in the past, and recognition algorithms with running time ğ‘‚(ğ‘›5) by Ma [14], ğ‘‚(ğ‘›4) by Raschle and Simon [19], and ğ‘‚(ğ‘›3) by Sterbini and Raschle [24] have been developed, where n is the number of vertices.

In this paper, we study the class of double-threshold graphs, which is a proper generalization of threshold graphs and a proper specialization of the graphs that are edge-intersections of two threshold graphs [11]. A graph is a double-threshold graph if there exist a vertex-weight function and two real numbers called weight lower and upper bounds such that two vertices are adjacent if and only if the sum of their weights is at least the lower bound and at most the upper bound. Our main result in this paper is a linear-time recognition algorithm for double-threshold graphs based on a new characterization.

As described below, there are at least two different lines of recent studies that led to this class of graphs: one is on multithreshold graphs and the other is on pairwise compatibility graphs.

Multithreshold graphs Jamison and Sprague [12] introduced multithreshold graphs as a generalization of threshold graphs. The threshold number of a graph ğº=(ğ‘‰,ğ¸) is the minimum positive integer k such that there are k distinct thresholds ğœƒ1,â€¦,ğœƒğ‘˜ and a weight function ğš :ğ‘‰â†’â„ such that ğ‘¢ğ‘£âˆˆğ¸ if and only if the number of thresholds ğœƒğ‘– satisfying ğœƒğ‘–â‰¤ğš (ğ‘¢)+ğš (ğ‘£) is odd. Intuitively, the thresholds break the real line into â€œyesâ€ and â€œnoâ€ regions such that two vertices are adjacent if and only if the sum of their weights belongs to a yes region. Clearly, a graph has threshold number 1 if and only if it is a threshold graph and has threshold number at most 2 if and only if it is a double-threshold graph. They showed that every graph has threshold number, and asked some questions including the complexity for recognizing double-threshold graphs. Puleo [18] showed that there is no single choice of three thresholds that can represent all graphs of threshold number at most 3. Jamison and Sprague [11] later focused on double-threshold graphs and showed that all double-threshold graphs are permutation graphs and that the bipartite double-threshold graphs are exactly the bipartite permutation graphs. Our new characterization is closely related to these facts and our algorithm uses them.

Pairwise compatibility graphs Motivated by uniform sampling from phylogenetic trees in bioinformatics, Kearney, Munro, and Phillips [13] defined pairwise compatibility graphs. A graph ğº=(ğ‘‰,ğ¸) is a pairwise compatibility graph if there exists a quadruple (T, ğš , ğš•ğš‹, ğšğš‹), where T is a tree, ğš :ğ¸(ğ‘‡)â†’â„, and ğš•ğš‹,ğšğš‹âˆˆâ„, such that the set of leaves in T coincides with V and ğ‘¢ğ‘£âˆˆğ¸ if and only if the (weighted) distance ğ‘‘ğ‘‡(ğ‘¢,ğ‘£) between u and v in T satisfies ğš•ğš‹â‰¤ğ‘‘ğ‘‡(ğ‘¢,ğ‘£)â‰¤ğšğš‹. Since its introduction, several authors have studied properties of pairwise compatibility graphs, but the existence of a polynomial-time recognition algorithm for that graph class has been open. The survey article by Calamoneri and Sinaimeri [4] proposed to look at the class of pairwise compatibility graphs defined on stars (i.e., star pairwise compatibility graphs), and asked for a characterization of star pairwise compatibility graphs. As we will see later, the star pairwise compatibility graphs are precisely the double-threshold graphs (see Observation 2.2).

Polynomial-time recognition of double-threshold graphs Xiao and Nagamochi [26] solved the open problem of Calamoneri and Sinaimeri [4] by giving a vertex-ordering characterization and an ğ‘‚(ğ‘›3ğ‘š)-time recognition algorithm for star pairwise compatibility graphs, where n an m are the numbers of vertices and edges, respectively. Their result also answered the question by Jamison and Sprague [12] about the recognition of double-threshold graphs by the equivalence of the graph classes. In this paper, we further improve the running time to ğ‘‚(ğ‘š+ğ‘›).

Other generalizations of threshold graphs There are many other generalizations of threshold graphs such as bithreshold graphs [8], threshold signed graphs [3], threshold tolerance graphs [17], quasi-threshold graphs (also known as trivially perfect graphs) [27], weakly threshold graphs [1], paired threshold graphs [20], and mock threshold graphs [2]. We omit the definitions of these graph classes and only note that some small graphs show that these classes are incomparable to the class of double-threshold graphs (e.g., 3ğ¾2 and the bull for bithreshold graphs, 3ğ¾2 and the bull for threshold signed graphs, 2ğ¾2 and the bull for threshold tolerance graphs, ğ¶4 and 2ğ¾3 for quasi-threshold graphs, 2ğ¾2 and the bull for weakly threshold graphs, ğ¶4 and the bull for paired threshold graphs, ğ¾3âˆªğ¶4 and the bull for mock threshold graphsFootnote1).

Note that the concept of double-threshold digraphs [7] is concerned with directed acyclic graphs defined from a generalization of semiorders involving two thresholds and not related to threshold graphs or double-threshold graphs.

Organization of the paper We first review in Sect. 2 some known relationships between double-threshold graphs and permutation graphs, and then show that connected bipartite permutation graphs admit representations with some restrictions that we use in subsequent sections. In Sect. 3, which is the main body of this paper, we give a new characterization of double-threshold graphs. Using the characterization, we present in Sect. 4 a simple linear-time algorithm for recognizing double-threshold graphs.

Graph classes In Fig. 1, we summarize the inclusion relations among some of the graph classes mentioned so far. We can see that the class of double-threshold graphs connects several other graph classes studied before.

Fig. 1
figure 1
The hierarchy of graph classes mentioned in the introduction. The class of the edge-intersections of two threshold graphs is abbreviated as thresholdâˆ©threshold. A line segment between two classes indicates that the one below is a subclass of the one above

Full size image
Preliminaries
All graphs in this paper are undirected, simple, and finite. A graph G is given by the pair of its vertex set V and its edge set E as ğº=(ğ‘‰,ğ¸). The vertex set and the edge set of G are often denoted by V(G) and E(G), respectively. For a vertex v in a graph ğº=(ğ‘‰,ğ¸), its neighborhood is the set of vertices that are adjacent to v, and denoted by ğ‘ğº(ğ‘£)={ğ‘¢âˆ£ğ‘¢ğ‘£âˆˆğ¸}. When the graph G is clear from the context, we often omit the subscript. A linear ordering â‰º on a set S with |ğ‘†|=ğ‘› can be represented by a sequence âŸ¨ğ‘ 1,ğ‘ 2,â€¦,ğ‘ ğ‘›âŸ© of the elements in S, in which ğ‘ ğ‘–â‰ºğ‘ ğ‘— if and only if ğ‘–<ğ‘—. With abuse of notation, we sometimes write â‰º=âŸ¨ğ‘ 1,ğ‘ 2,â€¦,ğ‘ ğ‘›âŸ©.

Double-Threshold Graphs
A graph ğº=(ğ‘‰,ğ¸) is a threshold graph if there exist a vertex-weight function ğš :ğ‘‰â†’â„ and a real number ğš•ğš‹âˆˆâ„ with the following property:

ğ‘¢ğ‘£âˆˆğ¸âŸºğš•ğš‹â‰¤ğš (ğ‘¢)+ğš (ğ‘£).
A graph ğº=(ğ‘‰,ğ¸) is a double-threshold graph if there exist a vertex-weight function ğš :ğ‘‰â†’â„ and two real numbers ğš•ğš‹,ğšğš‹âˆˆâ„ with the following property:

ğ‘¢ğ‘£âˆˆğ¸âŸºğš•ğš‹â‰¤ğš (ğ‘¢)+ğš (ğ‘£)â‰¤ğšğš‹.
Then, we say that the double-threshold graph G is defined by ğš , ğš•ğš‹ and ğšğš‹.

Jamison and Sprague [12] showed that we can use any values as ğš•ğš‹ and ğšğš‹ for defining a double-threshold graph and that we do not have to consider degenerated cases, where some vertices have the same weight or some weight sum equals to the lower or upper bound.

Lemma 2.1
[12] Let ğº=(ğ‘‰,ğ¸) be a double-threshold graph. For every pair ğš•ğš‹,ğšğš‹âˆˆâ„ with ğš•ğš‹<ğšğš‹, there exists ğš :ğ‘‰â†’â„ defining G with ğš•ğš‹ and ğšğš‹ such that ğš (ğ‘¢)â‰ ğš (ğ‘£) if ğ‘¢â‰ ğ‘£, and ğš (ğ‘¢)+ğš (ğ‘£)âˆ‰{ğš•ğš‹,ğšğš‹} for all (ğ‘¢,ğ‘£)âˆˆğ‘‰2.

Every threshold graph is a double-threshold graph as one can set a dummy upper bound ğšğš‹>max{ğš (ğ‘¢)+ğš (ğ‘£)âˆ£ğ‘¢,ğ‘£âˆˆğ‘‰}. From the definition of double-threshold graphs, we can easily see that they coincide with the star pairwise compatibility graphs.

Observation 2.2
A graph is a double-threshold graph if and only if it is a star pairwise compatibility graph.

Proof
Let ğº=(ğ‘‰,ğ¸) be a double-threshold graph defined by ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„. We construct an edge-weighted star S with the center c and the leaf set V such that the weight ğš â€²(ğ‘£ğ‘) of each edge ğ‘£ğ‘âˆˆğ¸(ğ‘†) is ğš (ğ‘£). Then, G is the star pairwise compatibility graph defined by (ğ‘†,ğš â€²,ğš•ğš‹,ğšğš‹).

Let ğº=(ğ‘‰,ğ¸) be a star pairwise compatibility graph defined by (ğ‘†,ğš ,ğš•ğš‹,ğšğš‹), where the star S has c as its center. For each ğ‘£âˆˆğ‘‰, we set ğš â€²(ğ‘£)=ğš (ğ‘£ğ‘). Then, G is the double-threshold graph defined by ğš â€², ğš•ğš‹, and ğšğš‹. â—»

Observation 2.2 allows us to state the following useful property shown by Xiao and Nagamochi [26] in terms of double-threshold graphs.

Lemma 2.3
[26] A graph is a double-threshold graph if and only if it contains at most one non-bipartite component and all components are double-threshold graphs.

The following simple observation is useful when we conduct a detailed analysis on a specific triple ğš , ğš•ğš‹, ğšğš‹ defining a double-threshold graph.

Observation 2.4
Let ğº=(ğ‘‰,ğ¸) be a double-threshold graph defined by ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„. If ğš (ğ‘¥)â‰¤ğš (ğ‘¦)â‰¤ğš (ğ‘§) and ğ‘¥ğ‘¦,ğ‘¦ğ‘§âˆˆğ¸ hold for distinct vertices ğ‘¥,ğ‘¦,ğ‘§âˆˆğ‘‰, then ğ‘¥ğ‘§âˆˆğ¸.

Proof
Since ğš•ğš‹â‰¤ğš (ğ‘¥)+ğš (ğ‘¦)â‰¤ğš (ğ‘¥)+ğš (ğ‘§)â‰¤ğš (ğ‘¦)+ğš (ğ‘§)â‰¤ğšğš‹, we have ğ‘¥ğ‘§âˆˆğ¸.

â—»

The definition of double-threshold graphs can be understood visually in the plane, by its so called slab representation. See Fig. 2 for an example. In the xy-plane, we consider the slab defined by {(ğ‘¥,ğ‘¦)âˆ£ğš•ğš‹â‰¤ğ‘¥+ğ‘¦â‰¤ğšğš‹} that is illustrated in gray. Then, two vertices ğ‘¢,ğ‘£âˆˆğ‘‰ are joined by an edge if and only if the point (ğš (ğ‘¢),ğš (ğ‘£)) lies in the slab.

Fig. 2
figure 2
(Left) A double-threshold graph. The weight of each vertex is given as ğš (ğ‘)=1, ğš (ğ‘)=3, ğš (ğ‘)=5, and ğš (ğ‘‘)=7; the lower bound is ğš•ğš‹=4 and the upper bound is ğšğš‹=8. (Right) The slab representation of the graph. A white dot represents the point (ğš (ğ‘¢),ğš (ğ‘£)) for distinct vertices u, v, and a cross represents the point (ğš (ğ‘£),ğš (ğ‘£)) for a vertex v. Two distinct vertices u and v are joined by an edge if and only if the corresponding white dot lies in the gray slab

Full size image
Permutation Graphs
A graph ğº=(ğ‘‰,ğ¸) is a permutation graph if there exist linear orderings â‰º1 and â‰º2 on V with the following property:

ğ‘¢ğ‘£âˆˆğ¸âŸº(ğ‘¢â‰º1ğ‘£ and ğ‘£â‰º2ğ‘¢) or (ğ‘¢â‰º2ğ‘£ and ğ‘£â‰º1ğ‘¢).
(1)
A graph is a bipartite permutation graph if it is a bipartite graph and a permutation graph. It is known that every permutation graph admits a transitive orientation [6], which gives a direction to each edge in such a way that the existence of directed edges from x to y and from y to z implies a directed edge from x to z as well.

Jamison and Sprague [11] showed that permutation graphs and bipartite permutation graphs have strong connections to double-threshold graphs as follows.

Lemma 2.5
[11] Every double-threshold graph is a permutation graph.

Lemma 2.6
[11] The bipartite double-threshold graphs are exactly the bipartite permutation graphs.

We say that the orderings â‰º1 and â‰º2 in (1) define the permutation graph G. We call â‰º1 a permutation ordering of G if there exists a linear ordering â‰º2 satisfying the condition above. Since â‰º1 and â‰º2 play a symmetric role in the definition, â‰º2 is also a permutation ordering of G. Note that for a graph G and a permutation ordering â‰º1 of G, the other ordering â‰º2 that defines G together with â‰º1 is uniquely determined. Also note that if â‰º1 and â‰º2 define G, then â‰ºR1 and â‰ºR2 also define G, where â‰ºRğ‘– denotes the reversed ordering of â‰ºğ‘–.

We often represent a permutation graph with a permutation diagram, which is drawn as follows (see Fig. 3 for an illustration). Imagine two horizontal parallel lines â„“1 and â„“2 on the plane. Then, we place the vertices in V on â„“1 from left to right according to the permutation ordering â‰º1 as distinct points, and similarly place the vertices in V on â„“2 from left to right according to â‰º2 as distinct points. The positions of ğ‘£âˆˆğ‘‰ can be represented by x-coordinates on â„“1 and â„“2, which are denoted by ğš¡1(ğ‘£) and ğš¡2(ğ‘£), respectively. We connect the two points representing the same vertex with a line segment. The process results in a diagram (called a permutation diagram) with |V| line segments. By definition, ğ‘¢ğ‘£âˆˆğ¸ if and only if the line segments representing u and v cross in the permutation diagram, which is equivalent to the inequality (ğš¡1(ğ‘¢)âˆ’ğš¡1(ğ‘£))(ğš¡2(ğ‘¢)âˆ’ğš¡2(ğ‘£))<0.

Fig. 3
figure 3
An example of a permutation diagram. (Left) A permutation graph G. (Right) A permutation diagram that represents G

Full size image
Conversely, from a permutation diagram of G, we can extract linear orderings â‰º1 and â‰º2 as

ğš¡1(ğ‘¢)<ğš¡1(ğ‘£)ğš¡2(ğ‘¢)<ğš¡2(ğ‘£)âŸºğ‘¢â‰º1ğ‘£,âŸºğ‘¢â‰º2ğ‘£.
When those conditions are satisfied, we say that the orderings of the x-coordinates on â„“1 and â„“2 are consistent with the linear orderings â‰º1 and â‰º2, respectively.

Although a permutation graph may have an exponential number of permutation orderings, it is essentially unique for a connected bipartite permutation graph in the sense of Lemma 2.7 below. For a graph ğº=(ğ‘‰,ğ¸), linear orderings âŸ¨ğ‘£1,â€¦,ğ‘£ğ‘›âŸ© and âŸ¨ğ‘£â€²1,â€¦,ğ‘£â€²ğ‘›âŸ© on V are neighborhood-equivalent if ğ‘(ğ‘£ğ‘–)=ğ‘(ğ‘£â€²ğ‘–) for all i.

Lemma 2.7
[9] Let G be a connected bipartite permutation graph defined by â‰º1 and â‰º2. Then, every permutation ordering of G is neighborhood-equivalent to â‰º1, â‰º2, â‰ºR1, or â‰ºR2.

A bipartite graph (X, Y; E) is a unit interval bigraph if there is a set of unit intervals {ğ¼ğ‘£=[ğ‘™ğ‘£,ğ‘™ğ‘£+1]âˆ£ğ‘£âˆˆğ‘‹âˆªğ‘Œ} such that ğ‘¥ğ‘¦âˆˆğ¸ if and only if ğ¼ğ‘¥âˆ©ğ¼ğ‘¦â‰ âˆ… for ğ‘¥âˆˆğ‘‹ and ğ‘¦âˆˆğ‘Œ. The class of unit interval bigraphs is known to be equal to the class of bipartite permutation graphs.

Proposition 2.8
[10, 21, 25] A graph is a bipartite permutation graph if and only if it is a unit interval bigraph.

The following lemma shows that a bipartite permutation graph can be represented by a permutation diagram with the special property that the segments representing vertices of the same set of the bipartition are parallel. An illustration is given in Fig. 4.

Fig. 4
figure 4
An illustration of Lemma 2.9. (Left) A permutation diagram of a bipartite permutation graph ğº=(ğ‘‹,ğ‘Œ;ğ¸). The vertices in X are represented by blue segments, and the vertices in Y are represented by red segments. (Right) A permutation diagram that represents G obtained by Lemma 2.9

Full size image
Lemma 2.9
Let ğº=(ğ‘‹,ğ‘Œ;ğ¸) be a bipartite permutation graph. Then, G can be represented by a permutation diagram in which ğš¡2(ğ‘¥)=ğš¡1(ğ‘¥)+1 for ğ‘¥âˆˆğ‘‹ and ğš¡2(ğ‘¦)=ğš¡1(ğ‘¦)âˆ’1 for ğ‘¦âˆˆğ‘Œ.

Proof
By Proposition 2.8, there is a set of unit intervals {ğ¼ğ‘£=[ğ‘™ğ‘£,ğ‘™ğ‘£+1]âˆ£ğ‘£âˆˆğ‘‹âˆªğ‘Œ} such that for ğ‘¥âˆˆğ‘‹ and ğ‘¦âˆˆğ‘Œ, ğ‘¥ğ‘¦âˆˆğ¸ if and only if ğ¼ğ‘¥âˆ©ğ¼ğ‘¦â‰ âˆ…. We can assume that all endpoints of the intervals are distinct; that is, ğ‘™ğ‘¢âˆ‰{ğ‘™ğ‘£,ğ‘™ğ‘£+1} for all ğ‘¢,ğ‘£âˆˆğ‘‹âˆªğ‘Œ with ğ‘¢â‰ ğ‘£ [25]. For each ğ‘¥âˆˆğ‘‹, we set ğš¡1(ğ‘¥)=ğ‘™ğ‘¥ and ğš¡2(ğ‘¥)=ğ‘™ğ‘¥+1. For each ğ‘¦âˆˆğ‘Œ, we set ğš¡1(ğ‘¦)=ğ‘™ğ‘¦+1 and ğš¡2(ğ‘¦)=ğ‘™ğ‘¦. It suffices to show that this permutation diagram represents G. Observe that line segments corresponding to vertices from the same set, X or Y, are parallel and thus do not cross. For ğ‘¥âˆˆğ‘‹ and ğ‘¦âˆˆğ‘Œ, we have

ğ¼ğ‘¥âˆ©ğ¼ğ‘¦â‰ âˆ…âŸº|ğ‘™ğ‘¥âˆ’ğ‘™ğ‘¦|<1âŸºğ‘™ğ‘¥<ğ‘™ğ‘¦+1 and ğ‘™ğ‘¦<ğ‘™ğ‘¥+1âŸºğš¡1(ğ‘¥)<ğš¡1(ğ‘¦) and ğš¡2(ğ‘¦)<ğš¡2(ğ‘¥)âŸº(ğš¡1(ğ‘¥)âˆ’ğš¡1(ğ‘¦))(ğš¡2(ğ‘¥)âˆ’ğš¡2(ğ‘¦))<0.(âˆµ all endpoints are distinct)(âˆµğ‘¥âˆˆğ‘‹, ğ‘¦âˆˆğ‘Œ)
The â‡ direction of the last equivalence holds since ğš¡1(ğ‘¥)<ğš¡2(ğ‘¥) and ğš¡1(ğ‘¦)>ğš¡2(ğ‘¦). Therefore, we conclude that the diagram represents G. â—»

We can show that for every permutation ordering of a connected bipartite permutation graph, there exists a permutation diagram consistent with the ordering that satisfies the conditions in Lemma 2.9.

Corollary 2.10
Let ğº=(ğ‘‹,ğ‘Œ;ğ¸) be a connected bipartite permutation graph defined by permutation orderings â‰º1 and â‰º2. If the first vertex in â‰º1 belongs to X, then G can be represented by a permutation diagram such that the orderings of the x-coordinates on â„“1 and â„“2 are consistent with â‰º1 and â‰º2, respectively, and that ğš¡2(ğ‘¥)=ğš¡1(ğ‘¥)+1 for every ğ‘¥âˆˆğ‘‹ and ğš¡2(ğ‘¦)=ğš¡1(ğ‘¦)âˆ’1 for every ğ‘¦âˆˆğ‘Œ.

Proof
Since G is connected, the last vertex in â‰º1 belongs to Y, the first vertex in â‰º2 belongs to Y, and the last vertex in â‰º2 belongs to X.

By Lemma 2.9, G can be represented by a permutation diagram ğ·â€² in which ğš¡2(ğ‘¥)=ğš¡1(ğ‘¥)+1 for ğ‘¥âˆˆğ‘‹ and ğš¡2(ğ‘¦)=ğš¡1(ğ‘¦)âˆ’1 for ğ‘¦âˆˆğ‘Œ. Let â‰ºâ€²1 and â‰ºâ€²2 be the permutation orderings corresponding to â„“1 and â„“2, respectively, in this diagram ğ·â€². Lemma 2.7 and the assumption on the first vertex in â‰º1 imply that â‰º1 is neighborhood-equivalent to â‰ºâ€²1 or (â‰ºâ€²2)ğ‘…. We may assume that â‰º1 is neighborhood-equivalent to â‰ºâ€²1 since otherwise we can rotate the diagram ğ·â€² by 180 degrees and get a permutation diagram of G in which the ordering on â„“1 is â‰º1, ğš¡2(ğ‘¥)=ğš¡1(ğ‘¥)+1 for ğ‘¥âˆˆğ‘‹, and ğš¡2(ğ‘¦)=ğš¡1(ğ‘¦)âˆ’1 for ğ‘¦âˆˆğ‘Œ.

Now we can construct a desired permutation diagram of G using â‰º1 and ğ·â€² by appropriately giving a mapping between segments and vertices. That is, for each ğ‘–âˆˆ{1,â€¦,|ğ‘‹âˆªğ‘Œ|}, we assign the ith vertex in â‰º1 to the segment in ğ·â€² with the ith smallest x-coordinate on â„“1. This new diagram is a permutation diagram of G since â‰º1 is neighborhood-equivalent to â‰ºâ€²1. Since G and â‰º1 uniquely determine the ordering on â„“2, the x-coordinates ğš¡2 on â„“2 are consistent with â‰º2. â—»

New Characterization
In this section, we present a new characterization of double-threshold graphs (Theorem 3.1). This is one of our main results and a key ingredient of the linear-time algorithm given in the next section. Recall that Lemma 2.6 characterizes the bipartite double-threshold graphs as the bipartite permutation graphs, which can be recognized in linear time [22, 23]. Thus, we are going to focus on non-bipartite graphs in this section.

Let ğº=(ğ‘‰,ğ¸) be a graph. From G and a vertex subset ğ‘€âŠ†ğ‘‰, we construct an auxiliary bipartite graph ğºâ€²ğ‘€=(ğ‘‰â€²,ğ¸â€²) defined as follows (see Fig. 5):

ğ‘‰â€²={ğ‘£,ğ‘£â¯â¯â¯âˆ£ğ‘£âˆˆğ‘‰},ğ¸â€²={ğ‘¢ğ‘£â¯â¯â¯âˆ£ğ‘¢ğ‘£âˆˆğ¸}âˆª{ğ‘£ğ‘£â¯â¯â¯âˆ£ğ‘£âˆˆğ‘€}.
Note that (ğ‘‰,{ğ‘£â¯â¯â¯âˆ£ğ‘£âˆˆğ‘‰}) is a bipartition of ğºâ€²ğ‘€ no matter what M is.

Fig. 5
figure 5
An example of an auxiliary bipartite graph. (Left) A graph G and ğ‘€={ğ‘’,ğ‘“}. (Right) The auxiliary bipartite graph ğºâ€²ğ‘€

Full size image
An efficient maximum clique K of a graph G is a maximum clique (i.e., a clique of the maximum size) that minimizes the degree sum âˆ‘ğ‘£âˆˆğ¾degğº(ğ‘£). See Fig. 6.

Fig. 6
figure 6
An example of an efficient maximum clique. (Left) A slab representation of a double-threshold graph G. (Right) The vertices of G are ordered in the increasing order of their weights. The graph G has two maximum cliques ğ‘„1={ğ‘,ğ‘’,ğ‘“,ğ‘”} and ğ‘„2={ğ‘‘,ğ‘’,ğ‘“,ğ‘”}. The degree sums are âˆ‘ğ‘£âˆˆğ‘„1degğº(ğ‘£)=5+4+4+4=17, and âˆ‘ğ‘£âˆˆğ‘„2degğº(ğ‘£)=4+4+4+4=16. Therefore, ğ‘„2 is the only efficient maximum clique of G

Full size image
Using these terms, we present a characterization of non-bipartite double-threshold graphs as follows.

Theorem 3.1
For a non-bipartite graph G, the following are equivalent.

1.
G is a double-threshold graph.

2.
For every efficient maximum clique M of G, the graph ğºâ€²ğ‘€ is a bipartite permutation graph.

3.
For some efficient maximum clique M of G, the graph ğºâ€²ğ‘€ is a bipartite permutation graph.

The rest of this section is devoted to a proof of Theorem 3.1. The following is a quick overview of the proof steps (some terms will be defined later).

1.
We first prove the key lemma (Lemma 3.3) ensuring that a graph is a double-threshold graph if and only if ğºâ€²ğ‘€ is a permutation graph with a â€œsymmetricâ€ permutation diagram, where ğ‘€âŠ†ğ‘‰ is the set of â€œmid-weightâ€ vertices.

2.
We then show that every efficient maximum clique can be the set of mid-weight vertices by proving a couple of lemmas (Lemmas 3.4 and 3.6).

3.
Next, we show that the symmetry required in the key lemma follows for free if M is a clique (Lemma 3.10), which is true when we set M to be the set of mid-weight vertices.

4.
Finally, we complete the proof of Theorem 3.1 by putting everything together.

We start with the following simple but useful fact.

Lemma 3.2
For a connected non-bipartite graph ğº=(ğ‘‰,ğ¸) and a vertex subset ğ‘€âŠ†ğ‘‰, ğºâ€²ğ‘€ is connected.

Proof
For any ğ‘¢,ğ‘£âˆˆğ‘‰, since G is connected and non-bipartite, G contains both an odd walk and an even walk from u to v. This shows that ğºâ€²ğ‘€ contains walks from u to v, from u to ğ‘£Â¯, from ğ‘¢Â¯ to v, and from ğ‘¢Â¯ to ğ‘£Â¯. Hence, ğºâ€²ğ‘€ is connected. â—»

For the auxiliary graph ğºâ€²ğ‘€=(ğ‘‰â€²,ğ¸â€²) of ğº=(ğ‘‰,ğ¸), a linear ordering on ğ‘‰â€² represented by âŸ¨ğ‘¤1,ğ‘¤2,â€¦,ğ‘¤2ğ‘›âŸ© is symmetric if ğ‘¤ğ‘–=ğ‘£ implies ğ‘¤2ğ‘›âˆ’ğ‘–+1=ğ‘£Â¯ for any ğ‘£âˆˆğ‘‰ and any ğ‘–âˆˆ{1,2,â€¦,2ğ‘›}.

Lemma 3.3
Let ğº=(ğ‘‰,ğ¸) be a non-bipartite graph and ğ‘€âŠ†ğ‘‰. The following are equivalent.

1.
G is a double-threshold graph defined by ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ such that ğ‘€={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2}.

2.
The auxiliary graph ğºâ€²ğ‘€=(ğ‘‰â€²,ğ¸â€²) can be represented by a permutation diagram in which both orderings â‰º1 and â‰º2 are symmetric.

Proof
(1 âŸ¹ 2) An illustration is given in Fig. 7. Let G be a double-threshold graph defined by ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ such that ğ‘€={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2}. By Lemma 2.1, we can assume that ğš•ğš‹=0 and ğšğš‹=2, that ğš (ğ‘¢)+ğš (ğ‘£)âˆ‰{0,2} for every (ğ‘¢,ğ‘£)âˆˆğ‘‰2, and that ğš (ğ‘¢)â‰ ğš (ğ‘£) if ğ‘¢â‰ ğ‘£. We construct a permutation diagram of ğºâ€²ğ‘€ as follows. Let â„“1 and â„“2 be two horizontal parallel lines. For each vertex ğ‘¤âˆˆğ‘‰â€², we set the x-coordinates ğš¡1(ğ‘¤) and ğš¡2(ğ‘¤) on â„“1 and â„“2 as follows: for any ğ‘£âˆˆğ‘‰,

ğš¡1(ğ‘£)ğš¡2(ğ‘£)=ğš (ğ‘£)âˆ’1,=ğš (ğ‘£),ğš¡1(ğ‘£Â¯)ğš¡2(ğ‘£Â¯)=1âˆ’ğš (ğ‘£),=âˆ’ğš (ğ‘£).
Since ğš (ğ‘¢)+ğš (ğ‘£)âˆ‰{0,2} for every (ğ‘¢,ğ‘£)âˆˆğ‘‰2 and ğš (ğ‘¢)â‰ ğš (ğ‘£) if ğ‘¢â‰ ğ‘£, the x-coordinates are distinct on â„“1 and on â„“2. By connecting ğš¡1(ğ‘¤) and ğš¡2(ğ‘¤) with a line segment for each ğ‘¤âˆˆğ‘‰â€², we get a permutation diagram. The line segments corresponding to the vertices in V have negative slopes, and the ones corresponding to the vertices in ğ‘‰â€²âˆ–ğ‘‰ have positive slopes. Thus, for any two vertices ğ‘¢,ğ‘£âˆˆğ‘‰, the line segments corresponding to u and ğ‘£Â¯ cross if and only if both ğš¡1(ğ‘¢)â‰¤ğš¡1(ğ‘£Â¯) and ğš¡2(ğ‘¢)â‰¥ğš¡2(ğ‘£Â¯) hold, which is equivalent to 0â‰¤ğš (ğ‘¢)+ğš (ğ‘£)â‰¤2, and thus to ğ‘¢ğ‘£Â¯âˆˆğ¸â€². Similarly, the line segments corresponding to v and ğ‘£Â¯ cross if and only if 0â‰¤2ğš (ğ‘£)â‰¤2, i.e., ğ‘£âˆˆğ‘€. This shows that the obtained permutation diagram represents ğºâ€²ğ‘€. Let â‰º1 be the ordering on ğ‘‰â€² defined by ğš¡1. Since ğš¡1(ğ‘£)=âˆ’ğš¡1(ğ‘£Â¯) for each ğ‘£âˆˆğ‘‰, â‰º1 is symmetric. Similarly, the ordering â‰º2 defined by ğš¡2 is symmetric.

(2 âŸ¹ 1) Suppose we are given a permutation diagram of ğºâ€²ğ‘€ in which both â‰º1 and â‰º2 are symmetric. We may assume by symmetry that the first vertex in â‰º1 belongs to V. Since ğºâ€²ğ‘€ is connected by Lemma 3.2, Corollary 2.10 shows that we can represent ğºâ€²ğ‘€ by a permutation diagram in which the x-coordinates ğš¡1 and ğš¡2 on â„“1 and â„“2 satisfy that

ğš¡2(ğ‘£)=ğš¡1(ğ‘£)+1 and ğš¡2(ğ‘£Â¯)=ğš¡1(ğ‘£Â¯)âˆ’1(ğ‘£âˆˆğ‘‰)
(2)
and that the orderings of the x-coordinates on â„“1 and â„“2 are consistent with â‰º1 and â‰º2, respectively. Since â‰º1 is symmetric, if ğ‘¢,ğ‘£âˆˆğ‘‰ are the ith and the jth vertices in â‰º1, then ğ‘¢Â¯,ğ‘£Â¯ are the (2ğ‘›âˆ’ğ‘–+1)st and the (2ğ‘›âˆ’ğ‘—+1)st vertices in â‰º1. Since ğ‘–<2ğ‘›âˆ’ğ‘—+1 is equivalent to ğ‘—<2ğ‘›âˆ’ğ‘–+1, we have that ğ‘¢â‰º1ğ‘£Â¯ if and only if ğ‘£â‰º1ğ‘¢Â¯. As ğš¡1 is consistent with â‰º1, it holds for ğ‘¢,ğ‘£âˆˆğ‘‰ that ğš¡1(ğ‘¢)â‰¤ğš¡1(ğ‘£Â¯) if and only if ğš¡1(ğ‘£)â‰¤ğš¡1(ğ‘¢Â¯), and hence

ğš¡1(ğ‘¢)â‰¤ğš¡1(ğ‘£Â¯)âŸºğš¡1(ğ‘¢)+ğš¡1(ğ‘£)â‰¤ğš¡1(ğ‘£Â¯)+ğš¡1(ğ‘¢Â¯).
Similarly, we can show that for ğ‘¢,ğ‘£âˆˆğ‘‰,

ğš¡2(ğ‘¢)â‰¥ğš¡2(ğ‘£Â¯)âŸºğš¡2(ğ‘¢)+ğš¡2(ğ‘£)â‰¥ğš¡2(ğ‘£Â¯)+ğš¡2(ğ‘¢Â¯).
Thus, for any two distinct vertices ğ‘¢,ğ‘£âˆˆğ‘‰, it holds that

ğ‘¢ğ‘£âˆˆğ¸âŸºğ‘¢ğ‘£Â¯âˆˆğ¸â€²âŸºğš¡1(ğ‘¢)â‰¤ğš¡1(ğ‘£Â¯) and ğš¡2(ğ‘¢)â‰¥ğš¡2(ğ‘£Â¯)âŸºğš¡1(ğ‘¢)+ğš¡1(ğ‘£)â‰¤ğš¡1(ğ‘£Â¯)+ğš¡1(ğ‘¢Â¯) and ğš¡2(ğ‘¢)+ğš¡2(ğ‘£)â‰¥ğš¡2(ğ‘£Â¯)+ğš¡2(ğ‘¢Â¯).
(3)
For each ğ‘£âˆˆğ‘‰, define

ğš (ğ‘£)=ğš¡2(ğ‘£)âˆ’ğš¡2(ğ‘£Â¯)2.
By (2), we can see that (3) is equivalent to

0â‰¤ğš (ğ‘¢)+ğš (ğ‘£)â‰¤2,
which shows that ğš , ğš•ğš‹=0, and ğšğš‹=2 define G. Furthermore, for any ğ‘£âˆˆğ‘‰,

ğ‘£âˆˆğ‘€âŸºğ‘£ğ‘£Â¯âˆˆğ¸â€²âŸºğš¡1(ğ‘£)â‰¤ğš¡1(ğ‘£Â¯) and ğš¡2(ğ‘£)â‰¥ğš¡2(ğ‘£Â¯)âŸº0â‰¤ğš (ğ‘£)â‰¤1,
which shows that ğ‘€={ğ‘£âˆˆğ‘‰âˆ£0â‰¤ğš (ğ‘£)â‰¤1}. â—»

Fig. 7
figure 7
An illustration of (1 âŸ¹ 2) in Lemma 3.3. (Top left) A double-threshold graph G with ğ‘€={ğ‘‘,ğ‘’}. The auxiliary bipartite graph ğºâ€²ğ‘€ is also depicted. (Top right) A slab representation of G. (Bottom) A permutation diagram of ğºâ€²ğ‘€ as given in the proof

Full size image
To utilize Lemma 3.3, we need to find the set M of mid-weight vertices; that is, the vertices with weights in the range [ğš•ğš‹/2,ğšğš‹/2]. The first observation is that M has to be a clique as the weight sum of any two vertices in M is in the range [ğš•ğš‹,ğšğš‹]. In the following, we show that an efficient maximum clique can be chosen as M. To this end, we first prove that we only need to consider (inclusion-wise) maximal cliques.

Lemma 3.4
For a connected non-bipartite double-threshold graph ğº=(ğ‘‰,ğ¸), there exist ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ defining G such that {ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2} is a maximal clique of G.

Proof
Let G be a non-bipartite double-threshold graph ğº=(ğ‘‰,ğ¸) defined by ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„. Let ğ‘€={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2}. We choose ğš , ğš•ğš‹, and ğšğš‹ in such a way that for any ğš â€²:ğ‘‰â†’â„ and ğš•ğš‹â€²,ğšğš‹â€²âˆˆâ„ defining G, M is not a proper subset of {ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹â€²/2â‰¤ğš â€²(ğ‘£)â‰¤ğšğš‹â€²/2}. Suppose to the contrary that M is not a maximal clique of G. Observe that if ğ‘€=âˆ…, then V can be partitioned into two independent sets {ğ‘£âˆˆğ‘‰âˆ£ğš (ğ‘£)<ğš•ğš‹/2} and {ğ‘£âˆˆğ‘‰âˆ£ğš (ğ‘£)>ğšğš‹/2}, which is a contradiction to the non-bipartiteness of G. Hence, M is non-empty.

Let ğºâ€²ğ‘€ be the auxiliary graph constructed from G and M as before. By Lemma 3.3, ğºâ€²ğ‘€ has a permutation diagram in which both â‰º1=âŸ¨ğ‘¤1,â€¦,ğ‘¤2ğ‘›âŸ© and â‰º2=âŸ¨ğ‘¤â€²1,â€¦,ğ‘¤â€²2ğ‘›âŸ© are symmetric. Let ğ‘€â¯â¯â¯â¯â¯â¯={ğ‘£Â¯âˆ£ğ‘£âˆˆğ‘€}. By the definition of ğºâ€²ğ‘€, ğ‘€âˆªğ‘€â¯â¯â¯â¯â¯â¯ induces a complete bipartite graph in ğºâ€²ğ‘€. By symmetry, we may assume that ğ‘€â‰º1ğ‘€â¯â¯â¯â¯â¯â¯ and ğ‘€â¯â¯â¯â¯â¯â¯â‰º2ğ‘€. That is, in â‰º1 all vertices in M appear before any vertex in ğ‘€â¯â¯â¯â¯â¯â¯ appears, and in â‰º2 all vertices in ğ‘€â¯â¯â¯â¯â¯â¯ appear before any vertex in M appears. Note that these assumptions imply that for each edge ğ‘¥ğ‘¦Â¯âˆˆğ¸(ğºâ€²ğ‘€), ğ‘¥â‰º1ğ‘¦Â¯ and ğ‘¦Â¯â‰º2ğ‘¥ hold since ğºâ€²ğ‘€ is connected by Lemma 3.2 (see Fig. 8 (Left)).

As M is not a maximal clique in G, there is a vertex ğ‘£âˆ‰ğ‘€ such that ğ‘€âŠ†ğ‘ğº(ğ‘£). If ğ‘£Â¯â‰º1ğ‘£, then we have

ğ‘€â‰º1ğ‘£Â¯â‰º1ğ‘£â‰º1ğ‘€â¯â¯â¯â¯â¯â¯ and ğ‘£Â¯â‰º2ğ‘€â¯â¯â¯â¯â¯â¯â‰º2ğ‘€â‰º2ğ‘£
(4)
since ğ‘£ğ‘£Â¯âˆ‰ğ¸(ğºâ€²ğ‘€), ğ‘€â¯â¯â¯â¯â¯â¯âŠ†ğ‘ğºâ€²ğ‘€(ğ‘£), and ğ‘€âŠ†ğ‘ğºâ€²ğ‘€(ğ‘£Â¯). Similarly, if ğ‘£â‰º1ğ‘£Â¯, then we have

ğ‘£â‰º1ğ‘€â‰º1ğ‘€â¯â¯â¯â¯â¯â¯â‰º1ğ‘£Â¯ and ğ‘€â¯â¯â¯â¯â¯â¯â‰º2ğ‘£â‰º2ğ‘£Â¯â‰º2ğ‘€,
or equivalently,

ğ‘€â‰ºğ‘…2ğ‘£Â¯â‰ºğ‘…2ğ‘£â‰ºğ‘…2ğ‘€â¯â¯â¯â¯â¯â¯ and ğ‘£Â¯â‰ºğ‘…1ğ‘€â¯â¯â¯â¯â¯â¯â‰ºğ‘…1ğ‘€â‰ºğ‘…1ğ‘£.
Thus, by replacing â‰º1 with â‰ºğ‘…2 and â‰º2 with â‰ºğ‘…1 if necessary, we may assume that (4) holds (see Fig. 8 (Left)). We further assume that v has the smallest position in â‰º1 under these conditions. â—»

Claim 3.5
ğ‘¤ğ‘›+1=ğ‘£ (and thus ğ‘¤ğ‘›=ğ‘£Â¯).

Proof
(Claim 3.5) By the symmetry of âŸ¨ğ‘¤1,â€¦,ğ‘¤2ğ‘›âŸ©, it suffices to show that there is no vertex ğ‘¥âˆˆğ‘‰ such that ğ‘£Â¯â‰º1ğ‘¥â‰º1ğ‘£. Suppose that such a vertex x exists. In ğºâ€²ğ‘€, x is not adjacent to ğ‘£Â¯. This implies that ğ‘¥ğ‘£âˆ‰ğ¸, and hence ğ‘¥âˆ‰ğ‘€. On the other hand, in ğºâ€²ğ‘€, x is adjacent to all vertices in ğ‘€â¯â¯â¯â¯â¯â¯. Thus, we have ğ‘€âŠ†ğ‘ğº(ğ‘¥). This contradicts that v has the smallest position in â‰º1 under those conditions. â—»

Now we obtain â‰ºâ€²1 from â‰º1 by swapping v and ğ‘£Â¯ (see Fig. 8 (Right)). By Claim 3.5, this new ordering â‰ºâ€²1 gives (together with â‰º2) the graph obtained from ğºâ€²ğ‘€ by adding the edge ğ‘£ğ‘£Â¯. Observe that this new graph can be expressed as ğºâ€²ğ‘€âˆª{ğ‘£}. Since â‰ºâ€²1 and â‰º2 are symmetric, Lemma 3.3 implies that there are ğš â€²:ğ‘‰â†’â„ and ğš•ğš‹â€²,ğšğš‹â€²âˆˆâ„ defining G such that {ğ‘¢âˆˆğ‘‰âˆ£ğš•ğš‹â€²/2â‰¤ğš â€²(ğ‘¢)â‰¤ğšğš‹â€²/2}=ğ‘€âˆª{ğ‘£}. This contradicts the choice of ğš , ğš•ğš‹, and ğšğš‹.

Fig. 8
figure 8
(Left) Relative positions of v, ğ‘£Â¯, M, and ğ‘€â¯â¯â¯â¯â¯â¯. (Right) â‰ºâ€²1 is obtained from â‰º1 by swapping v and ğ‘£Â¯

Full size image
We show that every efficient maximum clique can be the set of mid-weight vertices, given an appropriate choice of ğš , ğš•ğš‹, and ğšğš‹.

Lemma 3.6
Let G be a non-bipartite double-threshold graph. For every efficient maximum clique K of G, there exist ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ defining G such that ğ¾={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2}.

Proof
Let K be an efficient maximum clique of G. By Lemma 2.5, G is a permutation graph, and thus cannot contain an induced odd cycle of length 5 or more [6]. As G is non-bipartite, G contains ğ¾3. This implies that |ğ¾|â‰¥3.

By Lemma 3.4, there exist ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ defining G such that ğ‘€:={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2} is a maximal clique of G. Assume that ğš , ğš•ğš‹, and ğšğš‹ are chosen so that the size of the symmetric difference |ğ‘€â–µğ¾|=|ğ‘€âˆ–ğ¾|+|ğ¾âˆ–ğ‘€| is minimized. Assume that ğ¾â‰ ğ‘€ since otherwise we are done. This implies that ğ¾âŠˆğ‘€ and ğ¾âŠ‰ğ‘€ as both K and M are maximal cliques. Observe that ğºâˆ’ğ‘€ is bipartite. This implies that |ğ¾âˆ–ğ‘€|âˆˆ{1,2} and that ğ¾âˆ©ğ‘€â‰ âˆ… as |ğ¾|â‰¥3. Since K is a maximum clique, |ğ‘€âˆ–ğ¾|â‰¤|ğ¾âˆ–ğ‘€| holds.

Let ğ‘¢âˆˆğ¾âˆ–ğ‘€. By symmetry, we may assume that ğš (ğ‘¢)<ğš•ğš‹/2. Note that no other vertex in K has weight less than ğš•ğš‹/2 as K is a clique. Let ğ‘£âˆˆğ‘€ be a non-neighbor of u that has the minimum weight among such vertices. Such a vertex exists since M is a maximal clique. Note that ğ‘£âˆˆğ‘€âˆ–ğ¾.

We now observe that v has the minimum weight in M. If ğ‘¤âˆˆğ‘€ is a non-neighbor of u, then ğš (ğ‘£)â‰¤ğš (ğ‘¤) follows from the definition of v. If ğ‘¤âˆˆğ‘€ is a neighbor of u, then ğš (ğ‘£)<ğš (ğ‘¤) holds, since otherwise ğš (ğ‘¢)<ğš•ğš‹/2â‰¤ğš (ğ‘¤)â‰¤ğš (ğ‘£) and ğ‘¢ğ‘¤,ğ‘¤ğ‘£âˆˆğ¸ imply that ğ‘¢ğ‘£âˆˆğ¸ by Observation 2.4.

We are going to show that ğ‘(ğ‘£)=ğ‘(ğ‘¢). â—»

Claim 3.7
ğ‘(ğ‘¢)âˆ©{ğ‘¥âˆ£ğš (ğ‘¥)<ğš•ğš‹/2}=ğ‘(ğ‘£)âˆ©{ğ‘¥âˆ£ğš (ğ‘¥)<ğš•ğš‹/2}=âˆ….

Proof
(Claim 3.7) Since ğš (ğ‘¢)<ğš•ğš‹/2, ğ‘(ğ‘¢)âˆ©{ğ‘¥âˆ£ğš (ğ‘¥)<ğš•ğš‹/2}=âˆ…. Suppose to the contrary that v has a neighbor x with ğš (ğ‘¥)<ğš•ğš‹/2. The maximality of M implies that x has a non-neighbor ğ‘¦âˆˆğ‘€. Since ğ‘¦âˆˆğ‘€, ğš (ğ‘£)â‰¤ğš (ğ‘¦) holds. However, ğš (ğ‘¥)<ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğš (ğ‘¦) and ğ‘¥ğ‘£,ğ‘£ğ‘¦âˆˆğ¸ imply ğ‘¥ğ‘¦âˆˆğ¸ by Observation 2.4. â—»

Claim 3.8
ğ‘(ğ‘¢)âˆ©ğ‘€=ğ‘(ğ‘£)âˆ©ğ‘€=ğ‘€âˆ–{ğ‘£}.

Proof
(Claim 3.8) Since M is a clique and ğ‘£âˆˆğ‘€, we have ğ‘(ğ‘£)âˆ©ğ‘€=ğ‘€âˆ–{ğ‘£}. Thus, the claim is equivalent to ğ‘€âˆ–{ğ‘£}âŠ†ğ‘(ğ‘¢). This holds if ğ‘€âˆ–ğ¾={ğ‘£}. Assume that ğ‘€âˆ–ğ¾={ğ‘£,ğ‘£â€²} for some ğ‘£â€²â‰ ğ‘£. To show the claim, it suffices to show that ğ‘¢ğ‘£â€²âˆˆğ¸.

Since |ğ‘€âˆ–ğ¾|â‰¤|ğ¾âˆ–ğ‘€|â‰¤2, we have ğ¾âˆ–ğ‘€={ğ‘¢,ğ‘¢â€²} for some ğ‘¢â€²â‰ ğ‘¢. Since ğš (ğ‘¢)<ğš•ğš‹/2 and ğ‘¢ğ‘¢â€²âˆˆğ¸, we have ğš (ğ‘¢â€²)â‰¥ğš•ğš‹/2. Moreover since ğ‘¢â€²âˆ‰ğ‘€, we have ğš (ğ‘¢â€²)>ğšğš‹/2. Let ğ‘¤âˆˆğ‘€âˆ©ğ¾. If ğš (ğ‘¤)>ğš (ğ‘£â€²), then, by Observation 2.4, we have ğ‘¢â€²ğ‘£,ğ‘¢â€²ğ‘£â€²âˆˆğ¸ since ğš (ğ‘£)â‰¤ğš (ğ‘£â€²)<ğš (ğ‘¤)â‰¤ğš (ğ‘¢â€²) and ğ‘£ğ‘¤,ğ‘£â€²ğ‘¤,ğ‘¤ğ‘¢â€²âˆˆğ¸. This implies that ğ‘€âŠ†ğ‘(ğ‘¢â€²), which contradicts the maximality of M. Hence, ğš (ğ‘¤)â‰¤ğš (ğ‘£â€²) holds. This implies by Observation 2.4 that ğ‘¢ğ‘£â€²âˆˆğ¸ as ğš (ğ‘¢)â‰¤ğš (ğ‘¤)â‰¤ğš (ğ‘£â€²) and ğ‘¢ğ‘¤,ğ‘¤ğ‘£â€²âˆˆğ¸. â—»

Claim 3.9
ğ‘(ğ‘¢)âˆ©{ğ‘¥âˆ£ğš (ğ‘¥)>ğšğš‹/2}âŠ‡ğ‘(ğ‘£)âˆ©{ğ‘¥âˆ£ğš (ğ‘¥)>ğšğš‹/2}.

Proof
(Claim 3.9) Let ğ‘¤âˆˆğ¾âˆ©ğ‘€. For ğ‘§âˆˆğ‘(ğ‘£) with ğš (ğ‘§)>ğšğš‹/2, we have

ğš•ğš‹â‰¤ğš (ğ‘¢)+ğš (ğ‘¤)â‰¤ğš (ğ‘¢)+ğšğš‹/2<ğš (ğ‘¢)+ğš (ğ‘§)<ğš•ğš‹/2+ğš (ğ‘§)<ğš (ğ‘£)+ğš (ğ‘§)â‰¤ğšğš‹,
and thus ğ‘§âˆˆğ‘(ğ‘¢) holds. â—»

Claims 3.7, 3.8, and 3.9 imply that ğ‘(ğ‘£)âŠ†ğ‘(ğ‘¢). To show that ğ‘(ğ‘£)=ğ‘(ğ‘¢), suppose to the contrary that N(v) is a proper subset of N(u). We show that K cannot be an efficient maximum clique in this case. Let ğ¾â€²=ğ¾âˆ–{ğ‘¢}âˆª{ğ‘£}. We first argue that ğ¾â€² is a maximum clique. To this end, it suffices to show that ğ¾â€² is a clique as |ğ¾â€²|=|ğ¾|. If ğ¾âˆ–ğ‘€={ğ‘¢}, then ğ¾â€²=ğ‘€ is a clique. Assume that ğ¾âˆ–ğ‘€={ğ‘¢,ğ‘¢â€²} for some ğ‘¢â€²â‰ ğ‘¢. Since ğš (ğ‘¢)<ğš•ğš‹/2 and ğ‘¢â€²âˆˆğ¾âˆ–ğ‘€, we have ğš (ğ‘¢â€²)>ğšğš‹/2 as before. Let ğ‘¤âˆˆğ¾âˆ©ğ‘€. Then, ğ‘£ğ‘¤,ğ‘¤ğ‘¢â€²âˆˆğ¸. Since ğš (ğ‘£)â‰¤ğš (ğ‘¤)â‰¤ğšğš‹/2<ğš (ğ‘¢â€²), we have ğ‘£ğ‘¢â€²âˆˆğ¸ by Observation 2.4. Thus, ğ¾â€² is a clique. The assumption ğ‘(ğ‘£)âŠŠğ‘(ğ‘¢) implies that degğº(ğ‘£)<degğº(ğ‘¢), and thus,

âˆ‘ğ‘¤âˆˆğ¾â€²degğº(ğ‘¤)=(âˆ‘ğ‘¤âˆˆğ¾degğº(ğ‘¤))âˆ’degğº(ğ‘¢)+degğº(ğ‘£)<âˆ‘ğ‘¤âˆˆğ¾degğº(ğ‘¤).
This contradicts that K is efficient. Therefore, we conclude that ğ‘(ğ‘£)=ğ‘(ğ‘¢).

Now, we define a weight function ğš â€²:ğ‘‰â†’â„ by setting ğš â€²(ğ‘¢)=ğš (ğ‘£), ğš â€²(ğ‘£)=ğš (ğ‘¢), and ğš â€²(ğ‘¥)=ğš (ğ‘¥) for all ğ‘¥âˆˆğ‘‰âˆ–{ğ‘¢,ğ‘£}. Then, ğš â€², ğš•ğš‹, and ğšğš‹ define G and ğ‘€â€²:={ğ‘¤âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš â€²(ğ‘¤)â‰¤ğšğš‹/2}=ğ‘€âˆª{ğ‘¢}âˆ–{ğ‘£} as ğ‘(ğ‘¢)=ğ‘(ğ‘£). This contradicts the choice of ğš  as |ğ‘€â€²â–µğ¾|<|ğ‘€â–µğ¾|.

Next, we show that the symmetry required in Lemma 3.3 follows for free when M is a clique.

Lemma 3.10
Let ğº=(ğ‘‰,ğ¸) be a connected non-bipartite graph and M be a clique of G. Then, ğºâ€²ğ‘€ is a permutation graph if and only if ğºâ€²ğ‘€ can be represented by a permutation diagram in which both orderings â‰º1 and â‰º2 are symmetric.

Proof
The if part is trivial. To prove the only-if part, we assume that ğºâ€²ğ‘€ is a permutation graph.

First we observe that we only need to deal with the twin-free case. Assume that ğ‘ğºâ€²ğ‘€(ğ‘¢)=ğ‘ğºâ€²ğ‘€(ğ‘£) (or equivalently ğ‘ğºâ€²ğ‘€(ğ‘¢Â¯)=ğ‘ğºâ€²ğ‘€(ğ‘£Â¯)) for some ğ‘¢,ğ‘£âˆˆğ‘‰, i.e., u, v are twins in ğºâ€²ğ‘€. If ğºâ€²ğ‘€âˆ’{ğ‘£,ğ‘£Â¯} has a permutation diagram in which both permutation orderings â‰º1 and â‰º2 are symmetric, then we can obtain symmetric permutation orderings â‰ºâ€²1 and â‰ºâ€²2 of ğºâ€²ğ‘€ by inserting v right after u, and ğ‘£Â¯ right before ğ‘¢Â¯ in both â‰º1 and â‰º2. Thus, it suffices to show that ğºâ€²ğ‘€âˆ’{ğ‘£,ğ‘£Â¯}=(ğºâˆ’ğ‘£)â€²ğ‘€âˆ–{ğ‘£} has a permutation diagram in which both permutation orderings â‰º1 and â‰º2 are symmetric.

Observe that ğºâˆ’ğ‘£ might be bipartite, but (ğºâˆ’ğ‘£)â€²ğ‘€âˆ–{ğ‘£} is still connected. Hence, we can assume in the following that no pair of vertices in ğºâ€²ğ‘€ have the same neighborhood and that ğºâ€²ğ‘€ is connected (but G might be bipartite). We also assume that |ğ‘‰|â‰¥2 since otherwise the statement is trivially true.

Let â‰º1 and â‰º2 be the permutation orderings corresponding to a permutation diagram of ğºâ€²ğ‘€. By Lemma 2.7, the assumption of having no twins implies that â‰º1, â‰º2, â‰ºR1, and â‰ºR2 are all the permutation orderings of ğºâ€²ğ‘€. Since ğºâ€²ğ‘€ is connected, we may assume that the first vertex in â‰º1 belongs to V, the last in â‰º1 belongs to ğ‘‰â€²âˆ–ğ‘‰, the first in â‰º2 belongs to ğ‘‰â€²âˆ–ğ‘‰, and the last vertex in â‰º2 belongs to V. Let âŸ¨ğ‘¤1,â€¦,ğ‘¤2ğ‘›âŸ© be the ordering defined by â‰º1.

Let ğœ‘:ğ‘‰â€²â†’ğ‘‰â€² be a map such that ğœ‘(ğ‘£)=ğ‘£Â¯ and ğœ‘(ğ‘£Â¯)=ğ‘£ for each ğ‘£âˆˆğ‘‰. This map ğœ‘ is an automorphism of ğºâ€²ğ‘€. Thus, âŸ¨ğœ‘(ğ‘¤1),â€¦,ğœ‘(ğ‘¤2ğ‘›)âŸ© is also a permutation ordering of ğºâ€²ğ‘€. Let â‰ºâ€²=âŸ¨ğœ‘(ğ‘¤1),â€¦,ğœ‘(ğ‘¤2ğ‘›)âŸ© denote this ordering. Then,

â‰ºâ€²âˆˆ{â‰º1,â‰º2,â‰ºR1,â‰ºR2}.
We claim that â‰ºâ€²=â‰ºR1. First, observe that â‰ºâ€²âˆ‰{â‰º1,â‰ºR2} as the first vertex of â‰ºâ€² belongs to ğ‘‰â€²âˆ–ğ‘‰ but the first vertices of â‰º1 and â‰ºR2 belong to V.

Suppose to the contrary that â‰ºâ€²=â‰º2. Then, for each ğ‘¤âˆˆğ‘‰â€², the positions of w in â‰º1 and ğœ‘(ğ‘¤) in â‰º2 (=â‰ºâ€²) are the same. Thus, ğ‘¤ğ‘–â‰º1ğœ‘(ğ‘¤ğ‘–) implies ğœ‘(ğ‘¤ğ‘–)â‰º2ğœ‘(ğœ‘(ğ‘¤ğ‘–))=ğ‘¤ğ‘–. Hence, we have ğ‘£ğ‘£Â¯âˆˆğ¸(ğºâ€²ğ‘€) for all ğ‘£âˆˆğ‘‰, and thus ğ‘€=ğ‘‰. As M is a clique, ğ‘€=ğ‘‰ implies that G is a complete graph ğ¾|ğ‘‰| and that ğºâ€²ğ‘€ is a complete bipartite graph ğ¾|ğ‘‰|,|ğ‘‰|. This contradicts the assumption that ğºâ€²ğ‘€ has no twins as |ğ‘‰|â‰¥2. Therefore, we conclude that â‰ºâ€²=â‰ºR1, and in particular that ğœ‘(ğ‘¤ğ‘–)=ğ‘¤2ğ‘›âˆ’ğ‘–+1 for each i. This means that ğ‘¤ğ‘–=ğ‘£ implies ğ‘¤2ğ‘›âˆ’ğ‘–+1=ğ‘£Â¯ for all ğ‘£âˆˆğ‘‰ and ğ‘–âˆˆ{1,â€¦,2ğ‘›}. Hence, â‰º1 is symmetric. â—»

Now we can prove Theorem 3.1 restated below.

Theorem
3.1 For a non-bipartite graph G, the following are equivalent.

1.
G is a double-threshold graph.

2.
For every efficient maximum clique M of G, the graph ğºâ€²ğ‘€ is a bipartite permutation graph.

3.
For some efficient maximum clique M of G, the graph ğºâ€²ğ‘€ is a bipartite permutation graph.

Proof
To show that 1 âŸ¹ 2, assume that G is a non-bipartite double-threshold graph. Let M be an efficient maximum clique of G. By Lemma 3.6, there exist ğš :ğ‘‰â†’â„ and ğš•ğš‹,ğšğš‹âˆˆâ„ defining G such that ğ‘€={ğ‘£âˆˆğ‘‰âˆ£ğš•ğš‹/2â‰¤ğš (ğ‘£)â‰¤ğšğš‹/2}. Now by Lemma 3.3, ğºâ€²ğ‘€ is a bipartite permutation graph.

The implication 2 âŸ¹ 3 is trivial.

We now show that 3 âŸ¹ 1. Assume that for an efficient maximum clique M of a non-bipartite graph G, the graph ğºâ€²ğ‘€ is a bipartite permutation graph.

Let H be a non-bipartite component of G. Then, H contains an induced odd cycle of length ğ‘˜â‰¥3. This means that, if H does not contain M, then ğºâ€²ğ‘€ contains an induced cycle of length 2ğ‘˜â‰¥6. However, this is a contradiction as a permutation graph cannot contain an induced cycle of length at least 5 [5]. Thus, H contains M. Also, there is no other non-bipartite component in G as it does not intersect M. Since H contains M, ğ»â€²ğ‘€ is a component of ğºâ€²ğ‘€. By Lemma 3.10, ğ»â€²ğ‘€ can be represented by a permutation diagram in which both â‰º1 and â‰º2 are symmetric, and thus H is a double-threshold graph by Lemma 3.3.

Let B be a bipartite component of G (if one exists). Since B does not intersect M, ğºâ€²ğ‘€ contains two isomorphic copies of B as components. Since ğºâ€²ğ‘€ is a permutation graph, B is a permutation graph too. By Lemma 2.6, B is a double-threshold graph.

Now we know that all components of G are double-threshold graphs and exactly one of them is non-bipartite. By Lemma 2.3, G is a double-threshold graph. â—»

Linear-Time Recognition Algorithm
We now present a linear-time recognition algorithm for double-threshold graphs.

Theorem 4.1
There is an ğ‘‚(ğ‘š+ğ‘›)-time algorithm that accepts a given graph ğº=(ğ‘‰,ğ¸) if and only if the graph is a double-threshold graph, where ğ‘›=|ğ‘‰| and ğ‘š=|ğ¸|.

Proof
Given a graph G, we accept G if and only if

G is a bipartite permutation graph, or

G is a non-bipartite permutation graph and ğºâ€²ğ‘€ is a permutation graph, where M is an efficient maximum clique of G.

By Lemma 2.6 and Theorem 3.1, this algorithm is correct. Thus, it suffices to present a linear-time implementation of this algorithm.

We first test whether G is a permutation graph in ğ‘‚(ğ‘š+ğ‘›) time [16]. If G is not a permutation graph, we can reject it by Lemma 2.5. Otherwise, we check in linear time whether G is bipartite. If so, we can accept G by Lemma 2.6.

In the remaining case, G is a non-bipartite permutation graph. Assume for now that we already have an efficient maximum clique M of G. Since |ğ‘‰(ğºâ€²ğ‘€)|=2ğ‘› and |ğ¸(ğºâ€²ğ‘€)|=2ğ‘š+|ğ‘€|, we can construct ğºâ€²ğ‘€ and test whether it is a permutation graph in ğ‘‚(ğ‘š+ğ‘›) time. Hence, by Theorem 3.1, it suffices to show that M can be found in ğ‘‚(ğ‘š+ğ‘›) time.

To find an efficient maximum clique of G, we set to each vertex ğ‘£âˆˆğ‘‰ the weight ğ‘“(ğ‘£)=ğ‘›2âˆ’degğº(ğ‘£), and then find a maximum-weight clique of G with respect to f. It is known that a transitive orientation of a permutation graph can be computed in ğ‘‚(ğ‘š+ğ‘›) time [16], and then using the orientation, we can find a maximum-weight clique M in ğ‘‚(ğ‘š+ğ‘›) time [6, pp. 133â€“134]. We show that M is an efficient maximum clique of G. Let K be an efficient maximum clique of G. Since âˆ‘ğ‘£âˆˆğ¾ğ‘“(ğ‘£)â‰¤âˆ‘ğ‘£âˆˆğ‘€ğ‘“(ğ‘£), we have

|ğ¾|â‹…ğ‘›2âˆ’âˆ‘ğ‘£âˆˆğ¾degğº(ğ‘£)â‰¤|ğ‘€|â‹…ğ‘›2âˆ’âˆ‘ğ‘£âˆˆğ‘€degğº(ğ‘£).
(5)
Since 0â‰¤âˆ‘ğ‘£âˆˆğ‘†degğº(ğ‘£)<ğ‘›2 for any ğ‘†âŠ†ğ‘‰, it holds that |ğ¾|â‹…ğ‘›2âˆ’ğ‘›2<|ğ‘€|â‹…ğ‘›2. This implies that |ğ¾|=|ğ‘€| as |ğ¾|â‰¥|ğ‘€|. It follows from (5) that âˆ‘ğ‘£âˆˆğ¾degğº(ğ‘£)â‰¥âˆ‘ğ‘£âˆˆğ‘€degğº(ğ‘£). Therefore, M is an efficient maximum clique. â—»