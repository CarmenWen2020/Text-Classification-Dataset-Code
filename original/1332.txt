The Non-Uniform k-center (NUkC) problem has recently been formulated by Chakrabarty et al. [ICALP, 2016; ACM Trans Algorithms 16(4):46:1â€“46:19, 2020] as a generalization of the classical k-center clustering problem. In NUkC, given a set of n points P in a metric space and non-negative numbers ğ‘Ÿ1,ğ‘Ÿ2,â€¦,ğ‘Ÿğ‘˜, the goal is to find the minimum dilation ğ›¼ and to choose k balls centered at the points of P with radius ğ›¼â‹…ğ‘Ÿğ‘– for 1â‰¤ğ‘–â‰¤ğ‘˜, such that all points of P are contained in the union of the chosen balls. They showed that the problem is ğ–­ğ–¯-hard to approximate within any factor even in tree metrics. On the other hand, they designed a â€œbi-criteriaâ€ constant approximation algorithm that uses a constant times k balls. Surprisingly, no true approximation is known even in the special case when the ğ‘Ÿğ‘–â€™s belong to a fixed set of size 3. In this paper, we study the NUkC problem under perturbation resilience, which was introduced by Bilu and Linial (Comb Probab Comput 21(5):643â€“660, 2012). We show that the problem under 2-perturbation resilience is polynomial time solvable when the ğ‘Ÿğ‘–â€™s belong to a constant-sized set. However, we show that perturbation resilience does not help in the general case. In particular, our findings imply that even with perturbation resilience one cannot hope to find any â€œgoodâ€ approximation for the problem.

Introduction
Stability is a popular notion, which has been used in literature in the context of beyond worst case analysis. The general idea is to impose extra constraints on the inputs such that the (stable) instances that satisfy those constraints can capture the instances that appear in real life applications. In other words, we would like to exclude the â€œunrealisticâ€ instances from consideration and obtain optimistic bounds for algorithms on the remaining inputs. For example, a major collection of work along this line have focused on designing polynomial time algorithms for ğ–­ğ–¯-complete problems under different stability conditions. Bilu and Linial [10] introduced a notion of stability, which they termed as ğœ“-perturbation resilience for some ğœ“>1. Informally, an instance is called ğœ“-perturbation-resilient if the optimal solution remains same even after the instance is perturbed by a factor of ğœ“.

Recently, researchers have shown a great interest in studying geometric clustering problems under perturbation resilience. An instance of a clustering problem is ğœ“-perturbation-resilient if the optimal clustering is unique and remains unchanged under ğœ“-factor perturbation of the input distances. Awasthi et al. [6] showed that the standard center based clustering problems (e.g. k-center, k-median) can be solved in polynomial time under ğœ“-perturbation-resilience for ğœ“â‰¥3. In any such center based clustering problem, the clustering is obtained by assigning a point to its nearest center. In other words, the clustering is induced by the Voronoi partition of the points w.r.t. the chosen centers. Subsequently, Balcan and Liang [8] designed a polynomial time algorithm for these clustering problems under ğœ“-perturbation-resilience for ğœ“â‰¥1+2â€¾âˆš, improving the bound of Awasthi et al. [6]. Later, Balcan et al. [7] improved the bound for k-center to 2. On the other hand, they showed that k-center under ğœ“-perturbation-resilience cannot be solved in polynomial time for ğœ“<2, unless ğ–­ğ–¯=ğ–±ğ–¯. They also considered the more general asymmetric k-center problem, where the distances are not necessarily symmetric (but satisfy triangle inequality). The problem is known to not admit a constant approximation unless ğ–­ğ–¯âŠ†ğ–£ğ–³ğ–¨ğ–¬ğ–¤(ğ‘›loglogğ‘›), where n is the input size [15]. Surprisingly, Balcan et al. [7] showed that asymmetric k-center under 2-perturbation-resilience can be solved in polynomial time. Angelidakis et al. [4] gave a generic polynomial time algorithm for clustering problems with center based objectives (e.g. k-center, k-median, and k-means) under 2-perturbation-resilience. Recently, Cohen-Addad and Schwiegelshohn [16] proved that a simple local search scheme yields optimal solutions for problems like k-median and k-means, under ğœ“-perturbation-resilience for ğœ“>3. Chekuri and Gupta [14] showed that an LP relaxation of k-center under 2-perturbation-resilience admits an integral solution. They also proved the same result for k-center with outliers. Balcan and Liang [8] introduced a weaker stability assumption called (ğœ“,ğœ–)-perturbation-resilience, where the optimal solution under ğœ“-perturbation can differ in at most ğœ– fraction of the points from the original optimal clustering (see Preliminaries for the formal definition). Assuming that each cluster contains more than 2ğœ–ğ‘› points, Balcan et al. [7] showed that k-center under (3,ğœ–)-perturbation-resilience can be solved in polynomial time, where n is the number of input points.

The increasing interest in studying perturbation resilient clustering has given rise to several open directions. One such interesting direction is to study clustering problems, where the clustering is not necessarily induced by Voronoi partition. One such clustering problem is Non-Uniform k-center (NUkC). In NUkC, we are given a set of n points P in a metric space, non-negative integers ğ‘Ÿ1,ğ‘Ÿ2,â€¦,ğ‘Ÿğ‘˜, and the goal is to find the minimum dilation ğ›¼ and to choose k balls centered at the points of P with radius ğ›¼â‹…ğ‘Ÿğ‘– for 1â‰¤ğ‘–â‰¤ğ‘˜, such that all points of P are contained in the union of the chosen balls. We refer to any feasible solution of this problem composed of the chosen balls as a feasible placement. From a feasible placement, a clustering is retrieved in the following way â€“ each point is assigned to a fixed ball that contains the point, and then for each ball, the points that are assigned to that ball form a cluster. Figure 1 shows that, the optimal clustering for an instance of NUkC is not the same as the Voronoi partition w.r.t. the centers of the balls in the optimal placement. The NUkC problem was formulated by Chakrabarty et al. [13] as a generalization of the well-studied k-center clustering problem, where all ğ‘Ÿğ‘–â€™s are equal. Apart from clustering, NUkC has several applications in vehicle routing, sensor placement, and so on. For example, in vehicle routing, we need to find k depot locations corresponding to k vehicles having different speeds, such that any customer can be served by some vehicle as quickly as possible.

Fig. 1
figure 1
The optimal clusters are contained in the two disks in the Euclidean plane. The centers of balls are shown by boxes. The Voronoi partition w.r.t. the centers contains two subsets of points lying on the different sides of the vertical bisector line

Full size image
As mentioned before, k-center is a special case of NUkC where all the input radii are equal. We call this version of the problem as NUkC with one radius class. In general, all the radii might not be equal. But, we can consider only distinct radii from the input and associate a multiplicity parameter ğ‘˜ğ‘–, with each such radius ğ‘Ÿğ‘–, which denotes the number of balls of radius ğ‘Ÿğ‘– that can be chosen. Then the problem can be formulated equivalently in the following way.

Definition 1
(NUkC with t radii classes) Given a set of n points P in a metric space, ğ‘¡â‰¤ğ‘˜ distinct radii ğ‘Ÿ1>ğ‘Ÿ2>â‹¯>ğ‘Ÿğ‘¡ and non-negative integers ğ‘˜1,â€¦,ğ‘˜ğ‘¡ such that âˆ‘ğ‘¡ğ‘–=1ğ‘˜ğ‘–=ğ‘˜, the goal is to find the minimum dilation ğ›¼ and to choose ğ‘˜ğ‘– balls centered at the points of P with radius ğ›¼â‹…ğ‘Ÿğ‘– for all 1â‰¤ğ‘–â‰¤ğ‘¡, such that the union of the chosen balls contains all the input points.

We note that k-center with outliers is a special case of NUkC with 2 radii classes where the radius ğ‘Ÿ2=0. Using a reduction from the Firefighters problem [1], Chakrabarty et al. [13] proved that NUkC is ğ–­ğ–¯-hard to approximate within any ğ›¾â‰ª2ğ—‰ğ—ˆğ—…ğ—’(ğ‘›) factor even in tree metrics. On the other hand, they designed a (ğ‘1,ğ‘2) bi-criteria approximation for the problem for large constants ğ‘1 and ğ‘2, i.e., if the algorithm is allowed to use ğ‘1â‹…ğ‘˜ğ‘– balls of type i (thus ğ‘1â‹…ğ‘˜ in total), it can produce a solution with dilation at most ğ‘2 times the optimal dilation. They also gave a (1+5â€¾âˆš)-approximation for NUkC with two radii classes. For k-center with outliers, they gave an improved 2-approximation. However, even when the number of distinct radii is 3, no true approximation is known.

The motivation behind the study of NUkC under perturbation resilience is that, in many applications, the distance function is heuristic. In fact, when the points represent structures like images, proteins, documents, etc., it is very hard to find the true distance function, and various standard distance/ dissimilarity measures are used. If one solves a clustering problem with such a heuristic distance function and expects good results, then they implicitly assume that the optimal solution of the problem is not sensitive to small perturbations of the distance function. The perturbation resilience condition is a natural way to make this implicit assumption precise. Additionally, the separation between the clusters forces an optimal clustering to be unique.

Our Results In this paper, we obtain the following results.

1.
Polynomial time exact algorithm for NUkC with a constant number of radii classes under â€œ2-perturbation-resilienceâ€ and â€œ(3,ğœ–)-perturbation-resilience when each cluster contains more than ğœ–ğ‘›+1pointsâ€. Our algorithm reduces the NUkC problem to a version of Firefighters problem on trees (formally defined in Sect. 4). Under the stability assumptions, we can show that a feasible solution of NUkC maps to a feasible solution of Firefighters problem and vice versa. Here, in particular, we use the â€œwell-separatedâ€ structure of the clusters in the optimal clustering that follows due to stability. The reduction has the property that if NUkC has t distinct radii classes, then the height of the constructed tree instance is ğ‘¡+1. Then we show that using a dynamic programming based scheme, the Firefighters problem can be solved in polynomial time for constant height tree instances. Thus we also obtain a polynomial time algorithm for NUkC under perturbation resilience with a constant number of radii classes. We note that the algorithms for center based clustering problems in [4, 8, 14] are also based on tree computation and dynamic programming. However, the structure of the tree we compute is very different. We also note that our result under 2-perturbation-resilience is tight, as even for k-center it is unlikely to obtain a polynomial time algorithm under ğœ“-perturbation-resilience for ğœ“<2. To prove the result for (3,ğœ–)-perturbation-resilience, we assume that each cluster contains more than ğœ–ğ‘›+1 points. We note that such a lower bound is necessary, as in its absence even k-center is ğ–­ğ–¯-hard [7] under (ğœ“,ğœ–)-perturbation-resilience for all ğœ“â‰¥1 and ğœ–>0.

2.
Inapproximability of NUkC within a factor of ğ›¾ under ğœ“-perturbation-resilience for any 2ğ—‰ğ—ˆğ—…ğ—’(ğ‘›)â‰«ğ›¾â‰¥1and ğœ“â‰¤ğ›¾, unless ğ–­ğ–¯=ğ–±ğ–¯. Our result implies that, for any 2ğ—‰ğ—ˆğ—…ğ—’(ğ‘›)â‰«ğœ“,ğ›¾â‰¥1, even with ğœ“-perturbation-resilience one cannot hope to find a ğ›¾-approximation for the problem. This shows that the complexity of NUkC remains unchanged under perturbation-resilience. Our result should be contrasted with the polynomial time algorithm for asymmetric k-center under 2-perturbation-resilience, as asymmetric k-center is another candidate problem which is hard to approximate within a constant factor. To prove the result, we use a chain of reductions starting from the satisfiability problem to the NUkC problem in tree metrics under perturbation resilience assumption. The last reduction in the chain is from a version of the Firefighters problem which shows that NUkC is hard to approximate within a factor of ğ›¾ in tree metrics for any ğ›¾. Our reduction is similar to the reduction in [13]. Then, we argue that the constructed tree instances of NUkC are ğ›¾-perturbation-resilient, and hence the similar hardness follows even for NUkC under ğ›¾-perturbation-resilience. We also extend this hardness result to Euclidean metric of dimension d for ğ‘‘â‰¥1 using a classical tree embedding result of Gupta [21].

The main contribution of this paper is twofold. The first one is to be able to establish an exact connection between NUkC under perturbation resilience and the Firefighters problem on trees. To establish this connection, we need to prove that perturbation resilience implies that the optimal clusters are â€œwell-separatedâ€. Similar properties have been proved in the context of other problems (e.g., k-center). Our contribution is to be able to extend these proofs for NUkC as well. However, the extension is non-trivial, and one need sufficiently good amount of extra work, as here we need to deal with non-uniform radii. We note that Chakrabarty et al. [13] also showed a reduction from NUkC to Firefighters. However, their Linear Programming based reduction is very different. Our second contribution is the tight hardness result for the problem. This result along with the polynomial time algorithm gives the complete picture for NUkC under perturbation resilience. To prove this result we are faced with the following challenges. In any such hardness construction, one needs to show that the instances of NUkC to which we map, are perturbation resilient. Thus, we need to show that these instances have unique optimal solution and the optimal solution does not change with some perturbation of the distances. Chakrabarty et al. [13] showed a reduction from Firefighers to NUkC. However, using their distance function it is not straightforward to show that the constructed instances are insensitive to the perturbation of distances. Nevertheless, we consider a similar distance function and show the reduction works out well with this modification. To prove the uniqueness of the optimal solutions, we reduce a â€œuniqueâ€ version of 3SAT to a â€œuniqueâ€ version of Firefighters using a chain of reductions.

Related Work and Open Questions Other optimization problems have also been studied under stability assumptions [4, 17, 19, 25, 26]. Also different stability assumptions have been introduced and well-studied in the literature [5, 24, 27]. Most of the clustering problems mentioned here are ğ–­ğ–¯-hard, but admit some constant approximations, e.g., see [3, 12, 20, 22] and the references therein. It would be interesting to see if one can obtain a constant approximation for NUkC with a constant number of radii classes without any perturbation resilience assumptions. Also, one can study similar hard clustering problems (e.g., k-clustering [9]) under perturbation resilience.

Organization In Sect. 2, we define some notations that we use throughout the paper, and make a few observations that will be useful later. In Sect. 3, we list some properties implied due to perturbation resilience of the input instances. Then in Sect. 4, we discuss the algorithm for NUkC with any constant number of classes and prove its correctness by using the properties proved in the previous section. Lastly, in Sect. 5, we prove the hardness results for the general problem.

Preliminaries
We denote an instance of NUkC with t radii classes on metric d by (P, d, t). Note that the radii (ğ‘Ÿğ‘–) and multiplicity (ğ‘˜ğ‘—) parameters remain implicit in this notation. But, references to these parameters will become clear from the context. A ball with center ğ‘âˆˆğ‘ƒ and radius r, denoted by B(p, r), is the set of points {ğ‘âˆˆğ‘ƒâˆ£ğ‘‘(ğ‘,ğ‘)â‰¤ğ‘Ÿ}. A set of balls covers a set of points if the union of the balls contains all the points. Recall that a feasible placement is a feasible solution of the problem composed of the chosen balls that cover all the input points. A feasible NUkC clustering îˆ¯ of the input set of points P is a partition {ğ¶1,â€¦,ğ¶ğ‘˜}, such that there is a feasible placement Î  with the property that for all i, ğ¶ğ‘– is a subset of a ball in the placement. We say that the clustering îˆ¯ is induced by the placement Î . The radius of a cluster C w.r.t. any distance function d, denoted by c-radius(C, d), is minğ‘âˆˆğ‘ƒmaxğ‘âˆˆğ¶ğ‘‘(ğ‘,ğ‘). Note that no ball centered at a point ğ‘âˆˆğ‘ƒ of radius smaller than c-radius(C, d) can cover all the points of C. For a placement with dilation ğ›¼, a ball with radius ğ›¼ğ‘Ÿğ‘– (resp. <ğ›¼ğ‘Ÿğ‘– and â‰¥ğ›¼ğ‘Ÿğ‘–) is called an ğ‘Ÿğ‘– (resp. <ğ‘Ÿğ‘– and â‰¥ğ‘Ÿğ‘–) -ball.

Consider a metric space P with metric ğ‘‘:ğ‘ƒÃ—ğ‘ƒâ†’â„â‰¥0. A metric ğ‘‘1 is called a ğœ“-perturbation of d if for any ğ‘,ğ‘âˆˆğ‘ƒ, ğ‘‘(ğ‘,ğ‘)/ğœ“â‰¤ğ‘‘1(ğ‘,ğ‘)â‰¤ğ‘‘(ğ‘,ğ‘).Footnote1 In this paper, all perturbations we consider satisfy the metric properties.

Definition 2
An instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) of NUkC is called ğœ“-perturbation-resilient (ğœ“-PR) if for any metric ğœ“-perturbation ğ‘‘1 of d, the unique optimal NUkC clustering of îˆµâ€²=(ğ‘ƒ,ğ‘‘1,ğ‘¡) is identical to the unique optimal clustering of îˆµ.

Fig. 2
figure 2
Examples demonstrating the definition of perturbation resilience. The top-right (resp. bottom-right) instance is a 2-perturbed instance of the top-left (resp. bottom-left) instance. The points in same optimal cluster are shown by same shape and color (Color figure online)

Full size image
Note that in general, optimal clustering of NUkC might not be unique. We refer to the instance îˆµâ€² as a ğœ“-perturbed instance of îˆµ. For more clarity, we describe the notion of ğœ“-perturbation-resilience in the context of NUkC using two examples in Fig. 2 (top-left and bottom-left). In all our examples, the number of clusters ğ‘˜=2 and the number of radii classes ğ‘¡=1. For the instance shown at the top-left figure, let ğ‘Ÿ1=10. We claim that this instance is 2-perturbation-resilient. To see this note that here the optimal dilation is 1, and the optimal clusters are {ğ‘,ğ‘} and {ğ‘,ğ‘‘}. Moreover, even if all the distances are perturbed by a factor of 2, the distance between a and c (resp. b and d) can be at most 10. Hence, the dilation of the previous clustering for the perturbed instance would be at most 1. But, as all the distances between a and b, a and d, c and b, and c and d are 50, in any 2-perturbation of the distances, the distance between the two points in any of these four pairs would be at least 25. Thus if both of the points in such a pair remain in same cluster, the dilation must be at least 2.5. As there is a clustering of dilation at most 1, in optimal clustering, both of these points cannot lie in the same cluster. Hence, the optimal clustering is unique and same as the one before. The top-right figure shows a 2-perturbed instance with the same optimal clustering. Now, consider the instance in the bottom-left figure. Let ğ‘Ÿ1=15. We claim that this instance is not 2-perturbation-resilient. To prove this we show a 2-perturbed instance where the optimal clustering is different. Note that in the original instance, the optimal dilation is 1, and the optimal clusters are {ğ‘,ğ‘} and {ğ‘,ğ‘‘}. The 2-perturbed instance we consider is shown in the bottom-right figure. Note that in the perturbed instance the optimal clustering is {{ğ‘,ğ‘},{ğ‘,ğ‘‘}} with dilation 10/15=2/3. This is because any other clustering has a dilation at least 1.

We also consider another notion of perturbation resilience introduced by Balcan and Liang [8], where the optimal clustering is allowed to be different by a few points when the distances are perturbed. Here we rewrite this notion in terms of NUkC. Two clusterings îˆ¯={ğ¶1,â€¦,ğ¶ğ‘˜} and îˆ¯â€²={ğ¶â€²1,â€¦,ğ¶â€²ğ‘˜} are called ğœ–-close if at most ğœ–ğ‘› points are clustered differently in the two clusterings, i.e., the minimum value of âˆ‘ğ‘˜ğ‘–=1|ğ¶ğ‘–âˆ–ğ¶â€²ğ‘“(ğ‘–)| over all permutations f of {1,2,â€¦,ğ‘˜} is at most ğœ–ğ‘›.

Definition 3
An instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) of NUkC is called (ğœ“,ğœ–)-perturbation-resilient ((ğœ“,ğœ–)-PR) if for any metric ğœ“-perturbation ğ‘‘1 of d, any optimal NUkC clustering of îˆµâ€²=(ğ‘ƒ,ğ‘‘1,ğ‘¡) is ğœ–-close to any optimal clustering of îˆµ.

This is again a well-studied stability criterion [2]. Note that when ğœ–=0, any optimal NUkC clustering of îˆµâ€² must be same as any optimal clustering of îˆµ. This implies that optimal clustering of îˆµ and îˆµâ€² are unique and we obtain the definition of ğœ“-PR. Thus, if an instance of NUkC is ğœ“-PR, then it is also (ğœ“,0)-PR, and hence any hardness result for NUkC under ğœ“-PR trivially follows for NUkC under (ğœ“,ğœ–)-PR. Now, we have the following simple observation, which will be useful later in proving the properties of the PR instances.

Observation 1
Consider an NUkC instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) that admits a unique optimal clustering îˆ». Let C be any cluster in îˆ». Also, consider an optimal placement Î  where C is covered by a ball B. Then, the following two properties hold.

The center p of the ball B must belong to C.

For any two points u, v that lie in two different clusters of îˆ», both of u, v cannot be contained in B.

Proof
Suppose p belongs to the cluster ğ¶â€² such that ğ¶â‰ ğ¶â€². Construct another clustering îˆ»â€² by selecting all the clusters in îˆ» except C and ğ¶â€², and the clusters ğ¶âˆª{ğ‘} and ğ¶â€²âˆ–{ğ‘}. It is not hard to see that îˆ»â€² is also a feasible clustering induced by Î . As Î  is an optimal placement, îˆ»â€² is also an optimal clustering, which contradicts the uniqueness of the optimal clustering of îˆµ. Hence, the statement follows.

Suppose B contains both u and v. We construct a new clustering îˆ»â€², which is identical to îˆ» except, in îˆ»â€², we move the points u, v to the cluster C. Note that the clustering îˆ»â€² can be induced by the placement Î , as the ball B that covers ğ¶âˆˆîˆ» also contains u, v. Hence, îˆ»â€² is an optimal clustering for îˆµ different than îˆ», which is a contradiction, and thus the statement follows.

â—»

WLOG we can assume that the optimal dilation of a ğœ“-PR or a (ğœ“,ğœ–)-PR instance of NUkC is 1. Like in the general case without perturbation resilience, in this case also the assumption can be introduced by scaling ğ‘Ÿğ‘– values by a guessed value of the optimal dilation ğ›¼.

Lemma 1
Suppose there is a polynomial time algorithm îˆ­ for the NUkC problem with t radii classes under ğœ“-PR (resp. (ğœ“,ğœ–)-PR) with the properties that (i) for an instance which admits a feasible placement of balls with dilation 1, îˆ­ returns â€œyesâ€ and a feasible clustering, and (ii) for an instance which does not admit a feasible placement of balls with dilation 1, îˆ­ returns â€œnoâ€. Then, the NUkC problem with t radii classes under ğœ“-PR (resp. (ğœ“,ğœ–)-PR) can be solved in polynomial time.

Proof
Consider any instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) of the NUkC problem with t radii classes under ğœ“-PR (resp. (ğœ“,ğœ–)-PR). Let ğ›¼ be the optimal dilation. Note that we do not know the value of ğ›¼. However, as the input metric is finite, there are only polynomial number of guesses for ğ›¼. We use the following procedure to obtain the optimal clustering for îˆµ. In each step, we guess a value ğ›¼â€² for the optimal dilation in the increasing order of the values. We construct a new instance îˆµâ€² from îˆµ by only changing the radius ğ‘Ÿğ‘– to ğ›¼â€²â‹…ğ‘Ÿğ‘– for all i. Then, we apply the algorithm îˆ­ on the constructed instance. If îˆ­ returns â€œnoâ€, we repeat the process with a different guess. Otherwise, the procedure terminates. We return the same clustering returned by îˆ­ as the solution for the instance îˆµ.

Now, we argue about the correctness of the procedure. First, we claim that îˆµâ€² is a ğœ“-PR (resp. (ğœ“,ğœ–)-PR) instance. Before proving this claim we discuss its consequences. Note that if there is no feasible solution for îˆµ with dilation ğ›¼â€², then with ğ‘˜ğ‘– balls of radius ğ›¼â€²â‹…ğ‘Ÿğ‘– for all i it is not possible to cover the input points. Hence, in this case, for the constructed instance, there is no feasible solution with dilation 1. Thus, the algorithm correctly returns â€œnoâ€ assuming îˆµâ€² is a ğœ“-PR (resp. (ğœ“,ğœ–)-PR) instance. If there is a feasible solution for îˆµ with dilation ğ›¼â€², then with ğ‘˜ğ‘– balls of radius ğ›¼â€²â‹…ğ‘Ÿğ‘– for all i one can cover the input points. Thus, in that case, for the constructed instance, there is a feasible solution with dilation 1. Hence, îˆ­ correctly returns â€œyesâ€ assuming îˆµâ€² is ğœ“-PR (resp. (ğœ“,ğœ–)-PR). Thus, when ğ›¼â€²=ğ›¼, îˆ­ returns â€œyesâ€ and the returned clustering is optimal for îˆµ. Now, we prove the claim.

Claim
îˆµâ€² is a ğœ“-PR (resp. (ğœ“,ğœ–)-PR) instance.

Proof
First, we show that the optimal clustering of îˆµâ€² is unique. Note that the optimal dilation of îˆµâ€² is ğ›¼/ğ›¼â€². Suppose optimal clustering of îˆµâ€² is not unique. Then, there are two different clusterings where the points can be covered using ğ‘˜ğ‘– balls of radius (ğ›¼/ğ›¼â€²)â‹…ğ›¼â€²â‹…ğ‘Ÿğ‘–=ğ›¼â‹…ğ‘Ÿğ‘– from each class i. It follows that there are two different optimal clusterings for îˆµ. But, this is a contradiction, and thus the optimal clustering of îˆµâ€² is unique. Note that the optimal clusterings of îˆµ and îˆµâ€² are identical. Let îˆ¯ be that clustering. Now, consider any ğœ“-perturbation ğ‘‘1 of the input metric d and the ğœ“ perturbed instance îˆµâ€²1 of îˆµâ€². Let îˆµ1=(ğ‘ƒ,ğ‘‘1,ğ‘¡) be the corresponding ğœ“ perturbed instance of îˆµ. Also, let îˆ¯â€²1 be the optimal clustering of îˆµâ€²1 with dilation ğ›¼â€²1. For the sake of contradiction, suppose îˆ¯â€²1 is not identical (resp. ğœ–-close) to îˆ¯. We argue that îˆ¯â€²1 is also an optimal clustering of îˆµ1. But, this is a contradiction, as îˆµ1 is a ğœ“ perturbed instance of îˆµ and îˆµ is a ğœ“-PR (resp. (ğœ“,ğœ–)-PR) instance. Now, note that a placement that induces the clustering îˆ¯â€²1 of îˆµâ€²1 uses ğ‘˜ğ‘– balls of radius ğ›¼â€²1â‹…ğ›¼â€²â‹…ğ‘Ÿğ‘– from each class i. Thus, îˆ¯â€²1 is a clustering for îˆµ1 with dilation ğ›¼â€²1â‹…ğ›¼â€². It is sufficient to argue that this dilation is optimal for îˆµ1. Suppose the optimal dilation is <ğ›¼â€²1â‹…ğ›¼â€². Then, using ğ‘˜ğ‘– balls of radius <ğ›¼â€²1â‹…ğ›¼â€²â‹…ğ‘Ÿğ‘– from each class i all the points can be covered. Hence, there is a clustering for îˆµâ€²1 with dilation <ğ›¼â€²1, which is a contradiction, and hence the claim follows. â—»

Finally, as the number of guesses for ğ›¼ is a polynomial, the procedure terminates in polynomial time. â—»

Properties of Perturbation Resilience
In this section, we show that perturbation resilience imposes useful structure on the optimal solution. First, we consider the instances under (ğœ“,ğœ–)-perturbation resilience with ğœ“=3 and prove an interesting property of the optimal clustering.

Lemma 2
Consider any optimal placement Î  for a (3,ğœ–)-PR NUkC instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) with optimal dilation 1 where the size of each optimal cluster is >ğœ–ğ‘›+1. Let ğ¶1 and ğ¶2 be two clusters induced by two balls of Î  with radii ğ‘Ÿğ‘– and ğ‘Ÿğ‘—, respectively with ğ‘Ÿğ‘–â‰¥ğ‘Ÿğ‘—. Then, for any ğ‘âˆˆğ¶1 and ğ‘âˆˆğ¶2, ğ‘‘(ğ‘,ğ‘)>ğ‘Ÿğ‘–.

Proof
Let îˆ» be an optimal clustering of îˆµ that is induced by Î  and contains ğ¶1,ğ¶2 as clusters. For the sake of contradiction, suppose there are two points ğ‘âˆˆğ¶1 and ğ‘âˆˆğ¶2 such that ğ‘‘(ğ‘,ğ‘)â‰¤ğ‘Ÿğ‘–. Then, we show that there is a 3-perturbation ğ‘‘â€² of d such that an optimal clustering of îˆµâ€²=(ğ‘ƒ,ğ‘‘â€²,ğ‘¡) is not ğœ–-close to îˆ». But, this gives a contradiction to the assumption that îˆµ is a (3,ğœ–)-PR instance, and hence the lemma follows.

To construct the 3-perturbation ğ‘‘â€² of d, we at first construct another metric ğ‘‘1. Later we will scale ğ‘‘1 to construct ğ‘‘â€². Let ğµ1=ğµ(ğ‘1,ğ‘Ÿğ‘–) and ğµ2=ğµ(ğ‘2,ğ‘Ÿğ‘—) be the balls in Î  that induce ğ¶1 and ğ¶2, respectively. Then, for any ğ‘ âˆˆğ¶2, ğ‘‘(ğ‘,ğ‘ )â‰¤ğ‘‘(ğ‘,ğ‘)+ğ‘‘(ğ‘,ğ‘ )â‰¤ğ‘Ÿğ‘–+2ğ‘Ÿğ‘—â‰¤3ğ‘Ÿğ‘–. Also, for any ğ‘¤âˆˆğ¶1, ğ‘‘(ğ‘,ğ‘¤)â‰¤2ğ‘Ÿğ‘–. First, we construct a complete graph G with vertex set equal to P, and for any edge (u, v), its length is defined by the function l as follows.

ğ‘™(ğ‘¢,ğ‘£)={3ğ‘Ÿğ‘–3â‹…ğ‘‘(ğ‘¢,ğ‘£)if ğ‘¢=ğ‘,ğ‘£âˆˆ(ğ¶1âˆªğ¶2)âˆ–{ğ‘1} and ğ‘‘(ğ‘¢,ğ‘£)â‰¥ğ‘Ÿğ‘–otherwise
The distance ğ‘‘1 is the shortest path metric on G. Note that, as mentioned before, for any ğ‘£âˆˆ(ğ¶1âˆªğ¶2)âˆ–{ğ‘1}, ğ‘‘(ğ‘,ğ‘£)â‰¤3ğ‘Ÿğ‘–. Thus, it is not hard to see that, for any ğ‘¢,ğ‘£âˆˆğ‘ƒ, ğ‘‘(ğ‘¢,ğ‘£)â‰¤ğ‘‘1(ğ‘¢,ğ‘£)â‰¤3â‹…ğ‘‘(ğ‘¢,ğ‘£). Now, let us define the metric ğ‘‘â€². For any two points u, v, ğ‘‘â€²(ğ‘¢,ğ‘£)=ğ‘‘1(ğ‘¢,ğ‘£)/3. Hence, for any ğ‘¢,ğ‘£âˆˆğ‘ƒ, ğ‘‘(ğ‘¢,ğ‘£)/3â‰¤ğ‘‘â€²(ğ‘¢,ğ‘£)â‰¤ğ‘‘(ğ‘¢,ğ‘£). It follows that ğ‘‘â€² is a metric 3-perturbation of d, and thus the optimal clustering of îˆµâ€² is ğœ–-close to îˆ».

Now, let îˆµ1=(ğ‘ƒ,ğ‘‘1,ğ‘¡) and îˆ»1 be an optimal clustering of îˆµ1. As scaling does not change optimality of a clustering (for a formal proof see the proof of Lemma 1), îˆ»1 is also an optimal clustering of the instance îˆµâ€²=(ğ‘ƒ,ğ‘‘â€²,ğ‘¡). Thus îˆ»1 is ğœ–-close to îˆ». Next, we prove the following claim.

Claim
The optimal dilation of îˆµ1 is 3.

Proof
As for any ğ‘¢,ğ‘£âˆˆğ‘‰, ğ‘‘1(ğ‘¢,ğ‘£)â‰¤3â‹…ğ‘‘(ğ‘¢,ğ‘£), the optimal dilation of îˆµ1 is at most 3. We prove that this dilation is at least 3. Suppose the dilation is less than 3.

Let Î â€² be any placement with dilation less than 3 that induces the optimal clustering îˆ»1 of îˆµ1. Then, we show that îˆ»1 is also a feasible clustering of îˆµ with dilation less than 1. But, this is a contradiction, and hence the claim follows. Next, given Î â€², we show the existence of a placement for îˆµ with dilation less than 1 that induces îˆ»1.

Consider any cluster ğ¶â€²âˆˆîˆ»1, and suppose it gets covered by an ğ‘Ÿğ‘™-ball ğµ=ğµ(ğ‘¤,ğ‘Ÿ) in Î â€². Let x be any point in ğ¶â€². Now, consider the distance ğ‘‘1. Let ğœ‹ be any shortest path between w and x. We claim that ğœ‹ cannot contain the edge (p, v) for any ğ‘£âˆˆ(ğ¶1âˆªğ¶2)âˆ–{ğ‘1} with ğ‘‘(ğ‘,ğ‘£)â‰¥ğ‘Ÿğ‘–. For the sake of contradiction, say ğœ‹ contains (p, v). Note that ğ‘‘1(ğ‘,ğ‘£)=3ğ‘Ÿğ‘–. As ğœ‹ contains (p, v), ğ‘‘1(ğ‘¤,ğ‘)â‰¤ğ‘Ÿâˆ’3ğ‘Ÿğ‘–. Now, consider any point ğ‘¢âˆˆ(ğ¶1âˆªğ¶2)âˆ–{ğ‘1}. If ğ‘‘(ğ‘,ğ‘¢)â‰¥ğ‘Ÿğ‘–, ğ‘‘1(ğ‘,ğ‘¢)=3ğ‘Ÿğ‘–. Otherwise, ğ‘‘(ğ‘,ğ‘¢)<ğ‘Ÿğ‘–, and thus ğ‘‘1(ğ‘,ğ‘¢)=3â‹…ğ‘‘(ğ‘,ğ‘¢)<3ğ‘Ÿğ‘–. Thus, ğ‘‘1(ğ‘¤,ğ‘¢)â‰¤ğ‘‘1(ğ‘¤,ğ‘)+ğ‘‘1(ğ‘,ğ‘¢)â‰¤ğ‘Ÿ. Hence, all the points of (ğ¶1âˆªğ¶2)âˆ–{ğ‘1} are in B. But, as ğ¶1,ğ¶2 contain more than ğœ–ğ‘›+1 points, it follows that there is an optimal clustering of îˆµ1 that is not ğœ–-close to îˆ». Thus, we get a contradiction. Hence, ğœ‹ does not contain (p, v), and thus from the definition of the metric ğ‘‘1, it follows that ğ‘‘1(ğ‘¤,ğ‘¥)=3â‹…ğ‘‘(ğ‘¤,ğ‘¥). Thus, a ball centered at w and having radius r/3 can cover the points of ğ¶â€² in îˆµ. Now, note that ğ‘Ÿ<3ğ‘Ÿğ‘™, and thus ğ‘Ÿ/3<ğ‘Ÿğ‘™. Hence, it is sufficient to use an ğ‘Ÿğ‘™-ball with less than 1 factor expansion to cover the points of ğ¶â€² in îˆµ. In our new placement for îˆµ, we use the ğ‘Ÿğ‘™-ball B(w, r/3) corresponding to each such cluster ğ¶â€². Clearly, the dilation of the new placement is less than 1. â—»

Now, we show a clustering îˆ»2 of îˆµ1 that contains exactly k clusters, has dilation 3 and is not ğœ–-close to îˆ». îˆ»2 contains all the clusters in îˆ» except ğ¶1 and ğ¶2, and the clusters (ğ¶1âˆªğ¶2)âˆ–{ğ‘1},{ğ‘1}. Note that for any ğ‘ âˆˆ(ğ¶1âˆªğ¶2)âˆ–{ğ‘1}, ğ‘‘(ğ‘,ğ‘ )â‰¤3ğ‘Ÿğ‘–. Thus, (ğ¶1âˆªğ¶2)âˆ–{ğ‘1} can be covered by a ball of radius 3ğ‘Ÿğ‘–. It follows that the dilation of îˆ»2 is at most 3 and hence it is an optimal clustering. Clearly, the two clusterings îˆ» and îˆ»2 differ in >ğœ–ğ‘› points, as |ğ¶1|>ğœ–ğ‘›+1 and |ğ¶2|>ğœ–ğ‘›+1. Now, for the same reason mentioned before, îˆ»2 is also an optimal clustering of the instance îˆµâ€²=(ğ‘ƒ,ğ‘‘â€²,ğ‘¡). Hence, ğ‘‘â€² is the desired 3-perturbation. This completes the proof of the lemma. â—»

In the proof of the above lemma, one could have defined ğ‘‘â€² directly without going via ğ‘‘1. However, for simplicity of exposition, we have followed this approach. Indeed, this approach shows that if one defines ğœ“-perturbation by increasing the (instead of decreasing) distances, the lemma still holds. A proof can directly use the 3-perturbation ğ‘‘1 in that case.

Note that, as a 3-PR instance is also a (3, 0)-PR instance, the above lemma trivially follows for 3-PR instances. In the following, we will show that the above mentioned property of the optimal clustering follows even for any 2-PR instance.

Lemma 3
Consider any optimal placement Î  for a 2-PR NUkC instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) with optimal dilation 1. Let ğ¶1 and ğ¶2 be two clusters induced by two balls of Î  with radius ğ‘Ÿğ‘– and ğ‘Ÿğ‘—, respectively, where ğ‘Ÿğ‘–â‰¥ğ‘Ÿğ‘—. Then, for any ğ‘âˆˆğ¶1 and ğ‘âˆˆğ¶2, ğ‘‘(ğ‘,ğ‘)>ğ‘Ÿğ‘–.

Proof
Let îˆ» be the optimal clustering induced by the placement Î . Also, let ğµ1 and ğµ2 be the balls that induce the clusters ğ¶1 and ğ¶2, respectively. For the sake of contradiction, suppose there exist two points ğ‘âˆˆğ¶1, ğ‘âˆˆğ¶2 such that ğ‘‘(ğ‘,ğ‘)â‰¤ğ‘Ÿğ‘–. The idea is to show that there is a metric ğ‘‘1 that is a 2-perturbation of d such that îˆµâ€²=(ğ‘ƒ,ğ‘‘1,ğ‘¡) has different optimal clustering than îˆ». But, this is a contradiction, and thus the lemma follows.

Let ğ‘ğ‘¡ be the center of the ball ğµğ‘¡ for ğ‘¡âˆˆ{1,2}. Then, ğ‘‘(ğ‘1,ğ‘)â‰¤ğ‘‘(ğ‘1,ğ‘)+ğ‘‘(ğ‘,ğ‘)â‰¤2ğ‘Ÿğ‘–. We define the distance function ğ‘‘1 in the following way. First, we construct the complete graph with vertex set equal to P, and for any edge (u, v), its length is defined by the function l.

ğ‘™(ğ‘¢,ğ‘£)={min{ğ‘‘(ğ‘¢,ğ‘£),ğ‘Ÿğ‘–}ğ‘‘(ğ‘¢,ğ‘£)if ğ‘¢=ğ‘1 and ğ‘£=ğ‘otherwise
We note that, for any u, v, ğ‘‘(ğ‘¢,ğ‘£)/2â‰¤ğ‘™(ğ‘¢,ğ‘£)â‰¤ğ‘‘(ğ‘¢,ğ‘£). The distance function ğ‘‘1 is defined by the shortest path distance between any pair of vertices. It is not hard to verify the following observation.

Observation 2
ğ‘‘1 is a metric 2-perturbation of d.

Hence, the instance îˆµâ€²=(ğ‘ƒ,ğ‘‘1,ğ‘¡) has the same optimal clustering îˆ». Next, we prove a claim that the optimal dilation of îˆµâ€² is also 1.

Claim
The optimal dilation of îˆµâ€² is 1.

Proof
As for any ğ‘¢,ğ‘£âˆˆğ‘‰, ğ‘‘1(ğ‘¢,ğ‘£)â‰¤ğ‘‘(ğ‘¢,ğ‘£), the optimal dilation of îˆµâ€² is at most 1. We prove that this dilation is at least 1. Suppose the dilation is less than 1.

Let Î â€² be any placement with dilation less than 1 that induces the clustering îˆ» of îˆµâ€². Then, we show that there is a placement for îˆµ with dilation less than 1. But, this is a contradiction, and hence the claim follows. Consider any cluster ğ¶âˆˆîˆ» that gets covered by an ğ‘Ÿğ‘¡-ball ğµ=ğµ(ğ‘¤,ğ‘Ÿ) in Î â€². Let x be any point in C. Now, consider the distance ğ‘‘1. Let ğœ‹ be any shortest path between w and x. We claim that ğœ‹ cannot contain the edge (ğ‘1,ğ‘). For the sake of contradiction, say ğœ‹ contains (ğ‘1,ğ‘). But, this implies ğ‘‘1(ğ‘¤,ğ‘1)â‰¤ğ‘‘1(ğ‘¤,ğ‘¥)â‰¤ğ‘Ÿ and ğ‘‘1(ğ‘¤,ğ‘)â‰¤ğ‘‘1(ğ‘¤,ğ‘¥)â‰¤ğ‘Ÿ. Thus, B contains both ğ‘1 and q. Now, by the first property of Observation 1, ğ‘1 belongs to ğ¶1. Thus, by the second property of Observation 1, we obtain a contradiction, as ğ‘âˆˆğ¶2. Hence, ğœ‹ does not contain (ğ‘1,ğ‘). It follows that ğ‘‘1(ğ‘¤,ğ‘¥)â‰¥ğ‘‘(ğ‘¤,ğ‘¥). Thus, the radius of the ball needed to cover the points of C in îˆµ is at most r. Hence, it is sufficient to use an ğ‘Ÿğ‘¡-ball with at most ğ‘Ÿ/ğ‘Ÿğ‘¡<1 factor expansion to cover the points of C in îˆµ. Now, we construct a placement for îˆµ by selecting the same balls to cover the clusters that are used in Î â€². Clearly, the dilation of this placement is less than 1. â—»

Next, we show that there is a different clustering îˆ»â€² of îˆµâ€² with exactly k clusters that achieves the optimal dilation. This gives rise to a contradiction, and thus ğ‘‘(ğ‘,ğ‘)>ğ‘Ÿğ‘–. Now, there are two cases. In the first case, q is the only point in ğ¶2, and thus ğ¶2âˆ–{ğ‘} is empty. In this case, we pick a non-singleton cluster C from îˆ»âˆ–{ğ¶1} and choose a point ğ‘ âˆˆğ¶. Such a cluster exists WLOG. Then, we define îˆ»â€² to be the set of clusters in îˆ» except ğ¶,ğ¶1 and ğ¶2, and the clusters ğ¶1âˆª{ğ‘},{ğ‘ } and ğ¶âˆ–{ğ‘ }. In the second case, q is not the only point in ğ¶2, and thus ğ¶2âˆ–{ğ‘} is not empty. In this case, îˆ»â€² is defined to be the set of clusters in îˆ» except ğ¶1 and ğ¶2, and the clusters ğ¶1âˆª{ğ‘},ğ¶2âˆ–{ğ‘}. It is not hard to see that ğ¶1âˆª{ğ‘} can be covered by the ball ğµ(ğ‘1,ğ‘Ÿğ‘–). Also, if ğ¶2âˆ–{ğ‘} is not empty, then ğµ(ğ‘2,ğ‘Ÿğ‘—) covers the points in ğ¶2âˆ–{ğ‘}. Hence, in all the cases, it is trivial to verify that the dilation of the new clustering is 1. â—»

Note that, in the above proof, to show that îˆ»â€² has dilation 1, we argue that there is a placement with dilation 1. The balls in the placement might not be disjoint (both ğµ(ğ‘1,ğ‘Ÿğ‘–) and ğµ(ğ‘2,ğ‘Ÿğ‘—) cover q). But, for the sake of just showing the optimality of the clustering, it is sufficient to show the existence of such a placement.

NUkC with a Constant Number of Radii Classes
In this section, we show a polynomial time reduction from NUkC to the Constrained Resource Minimization for Fire Containment on Trees problem.

Definition 4
(Constrained Resource Minimization for Fire Containment on Trees (CRMFC-T)). Given a rooted tree ğ‘‡=(ğ‘‰,ğ¸) with height ğ‘¡+1, a set of forbidden nodes ğ¹âŠ†ğ‘‰, and integers ğ‘˜1,â€¦,ğ‘˜ğ‘¡, the goal is to decide if there is a collection of non-root nodes ğ‘ˆâŠ†(ğ‘‰âˆ–ğ¹) such that (a) for every leaf-root path ğœ‹, U contains at least one node from ğœ‹, and (b) |ğ‘ˆâˆ©ğ¿ğ‘–|â‰¤ğ‘˜ğ‘– for 1â‰¤ğ‘–â‰¤ğ‘¡, where ğ¿ğ‘– is the layer i nodes of T, i.e., the nodes at distance exactly i from the root.

Given any instance îˆµ=(ğ‘ƒ,ğ‘‘,ğ‘¡) of NUkC under 2-PR or (3,ğœ–)-PR (the size of each optimal cluster is more than ğœ–ğ‘›+1), we will show how to construct an instance îˆµâ€² of CRMFC-T such that îˆµ has a feasible placement with dilation 1 iff îˆµâ€² has a feasible solution. Also, from a feasible solution for îˆµâ€², a feasible solution for îˆµ can be computed in polynomial time. In the constructed instance îˆµâ€², the height of the tree is one more than the number of radii classes in NUkC. We show that CRMFC-T can be solved in polynomial time if the height of the input tree is a constant. From Lemma 1, it follows that the perturbation resilient version of NUkC can be solved in polynomial time if the number of classes is a constant. Thus, we obtain the following theorem.

Theorem 1
NUkC under 2-PR (or (3,ğœ–)-PR, where the size of each optimal cluster is more than ğœ–ğ‘›+1) can be solved in polynomial time if the number of radii classes is a constant.

Tree Construction
Let G be the complete graph that defines the distances between the input points. Note that we are also given the input radii ğ‘Ÿ1>ğ‘Ÿ2>â‹¯>ğ‘Ÿğ‘¡. We construct the tree T in t rounds that contains t levels other than the root level. We denote the nodes at level i by ğ¿ğ‘– for ğ‘–âˆˆ{0,â€¦,ğ‘¡}. ğ¿0 contains a singleton nodeâ€”the root of the tree. For ğ‘–â‰¥1, in i th round, we construct the nodes ğ¿ğ‘– and connect them with the nodes in ğ¿ğ‘–âˆ’1. Each node v in T corresponds to a connected subgraph ğºğ‘£ of G. The root corresponds to G itself. Also, each node is marked with either yes or no denoting if the node can be selected or it is in the forbidden set.

For each index ğ‘–âˆˆ{1,â€¦,ğ‘¡}, in i th round, we consider all the nodes ğ‘£âˆˆğ¿ğ‘–âˆ’1 and the subgraph ğºğ‘£ corresponding to v. We remove all the edges with weight more than ğ‘Ÿğ‘– from ğºğ‘£. Let ğº1ğ‘£,â€¦,ğºğ‘™ğ‘£ be the connected components formed from ğºğ‘£ due to the removal of these edges. We add l children of v to ğ¿ğ‘– corresponding to these connected l subgraphs. For each such child u, if there is a node w in ğºğ‘¢, such that for all node x in ğºğ‘¢, ğ‘‘(ğ‘¤,ğ‘¥)â‰¤ğ‘Ÿğ‘–, we label u with yes. Otherwise, we label u with no (forbidden). Lastly, for each level ğ‘–â‰¥1, the number of nodes that can be chosen from ğ¿ğ‘– in CRMFC-T is set to ğ‘˜ğ‘–. The following lemma establishes the connection between the two instances îˆµ and îˆµâ€².

Lemma 4
îˆµ has a feasible placement with dilation 1 iff îˆµâ€² has a feasible solution to CRMFC-T.

Proof
First, suppose there is a feasible solution to îˆµâ€². For each chosen node v, v must be a yes node. Let i be the integer such that ğ‘£âˆˆğ¿ğ‘–. Then, the points in ğºğ‘£ can be covered by an ğ‘Ÿğ‘– ball centered at some point in ğºğ‘£. We choose this ball in our placement. Note that we select at most ğ‘˜ğ‘– balls of radius ğ‘Ÿğ‘– for all i. We prove that each point is covered in the constructed placement. Consider any point p. The way we construct the tree, each point can lie in the connected subgraph ğºğ‘£ of exactly one node v of ğ¿ğ‘— for all j. Let ğœ‹ be the root-leaf path in T, such that for any ğ‘£âˆˆğœ‹, p is in ğºğ‘£. Now, there must be a node along ğœ‹ that is chosen in the solution of CRMFC-T. Let u be such a node. As we place a ball of radius ğ‘Ÿğ‘– that covers all the points of ğºğ‘¢, p gets covered. Thus, îˆµ has a feasible placement with dilation 1.

Now, suppose îˆµ has a feasible placement with dilation 1. Let îˆ» be the clustering induced by the placement. Now, consider any cluster ğ¶âˆˆîˆ», which is covered by a ball of radius ğ‘Ÿğ‘—. Thus, c-radius(ğ¶,ğ‘‘)â‰¤ğ‘Ÿğ‘—. The way the tree T is constructed it follows that all the points in C remain in the same connected subgraph ğºğ‘£ corresponding to a unique vertex ğ‘£âˆˆğ¿ğ‘– for each ğ‘–â‰¤ğ‘—. Let ğºğ‘¢ be the subgraph corresponding to level ğ‘—âˆ’1. As îˆµ is a 2-PR (resp. (3,ğœ–)-PR) instance, from Lemma 3 (resp. Lemma 2), we know that, for any ğ‘âˆˆğ¶ and ğ‘âˆˆğ‘ƒâˆ–ğ¶, ğ‘‘(ğ‘,ğ‘)>ğ‘Ÿğ‘—. Thus, when the edges with weight more than ğ‘Ÿğ‘— are removed from ğºğ‘¢, p and q cannot remain in the same component. But, as c-radius(ğ¶,ğ‘‘)â‰¤ğ‘Ÿğ‘— all the points of C remain in the same component. Also, by the first property of Observation 1, the center of the ğ‘Ÿğ‘—-ball that covers C must lie in C. It follows that there is a yes node ğ¶(ğ‘£)âˆˆğ¿ğ‘— such that ğºğ¶(ğ‘£) contains only the points of C as vertices. For each cluster ğ¶âˆˆîˆ», we select the yes node C(v) in the solution to CRMFC-T. It is not hard to see that we choose at most ğ‘˜ğ‘— nodes from ğ¿ğ‘—. Now, consider any root-leaf path ğœ‹ in T corresponding to a leaf l. Let p be a point in ğºğ‘™. Also, let p be a point in the cluster ğ¶âˆˆîˆ». Then, there must be a yes node C(v) in ğœ‹ such that ğºğ¶(ğ‘£) contains only the points of C. As we choose v in our solution, we have at least one node from the path ğœ‹. Hence, the constructed solution is feasible. â—»

The Algorithm for CRMFC-T
In this section, we design a dynamic programming based algorithm that decides the feasibility of any instance of CRMFC-T. The algorithm runs in polynomial time when the height of the tree is a constant. Let T be the input tree having height t, i.e., T has ğ‘¡+1 levels ğ¿0,â€¦,ğ¿ğ‘¡. ğ¿0 contains only the root of T. Let ğ‘›ğ‘–=|ğ¿ğ‘–|. We also assume that the nodes of ğ¿ğ‘– are ordered for all ğ‘–â‰¥1, i.e., ğ¿ğ‘–={ğ‘£ğ‘–1,â€¦,ğ‘£ğ‘–ğ‘›ğ‘–}. For ğ‘—â‰¤ğ‘™, let F(i, j, l) be the union of the induced subtrees of T rooted at the vertices ğ‘£ğ‘–ğ‘—,â€¦,ğ‘£ğ‘–ğ‘™. We construct the tree T(i, j, l) from F(i, j, l) by connecting the roots of the subtrees to a common root.

Let feasible(ğ‘‡(ğ‘–,ğ‘—,ğ‘™),ğ‘™ğ‘–,ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡) be the function that decides if there is a feasible solution to CRMFC-T for the tree T(i, j, l) by selecting at most ğ‘™ğ‘š nodes from level m, where ğ‘–â‰¤ğ‘šâ‰¤ğ‘¡. Note that computing the function feasible(ğ‘‡=ğ‘‡(1,1,ğ‘›1),ğ‘˜1,â€¦,ğ‘˜ğ‘¡) solves the CRMFC-T problem. We consider the following recursive definition of feasible(). In the base case, if ğ‘–=ğ‘¡âˆ’1, the function can be computed in polynomial time. Otherwise, if ğ‘™ğ‘– is 0, let ğ‘—â€² be the minimum index such that ğ‘£ğ‘–+1,ğ‘—â€² is a child of ğ‘£ğ‘–ğ‘— and ğ‘™â€² be the maximum index such that ğ‘£ğ‘–+1,ğ‘™â€² is a child of ğ‘£ğ‘–ğ‘™. In this case, feasible(ğ‘‡(ğ‘–,ğ‘—,ğ‘™),ğ‘™ğ‘–,ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡)=feasible(ğ‘‡(ğ‘–+1,ğ‘—â€²,ğ‘™â€²),ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡). Otherwise, there must be a minimum index ğ‘—â‰¤ğ‘—1â‰¤ğ‘™ such that a yes node ğ‘£ğ‘–ğ‘—1 is selected to be in the solution. For such a fixed ğ‘—<ğ‘—1<ğ‘™, let ğ‘—â€² be the minimum index such that ğ‘£ğ‘–+1,ğ‘—â€² is a child of ğ‘£ğ‘–ğ‘— and ğ‘™â€² be the maximum index such that ğ‘£ğ‘–+1,ğ‘™â€² is a child of ğ‘£ğ‘–,ğ‘—1âˆ’1. In this case, if there are values ğ‘™1ğ‘–+1,â€¦,ğ‘™1ğ‘¡,ğ‘™2ğ‘–,ğ‘™2ğ‘–+1,â€¦,ğ‘™2ğ‘¡ such that ğ‘™2ğ‘–=ğ‘™ğ‘–âˆ’1, ğ‘™ğ‘š=ğ‘™1ğ‘š+ğ‘™2ğ‘š for all ğ‘–+1â‰¤ğ‘šâ‰¤ğ‘¡, and both feasible(ğ‘‡(ğ‘–+1,ğ‘—â€²,ğ‘™â€²),ğ‘™1ğ‘–+1,â€¦,ğ‘™1ğ‘¡) and feasible(ğ‘‡(ğ‘–,ğ‘—1+1,ğ‘™),ğ‘™2ğ‘–,ğ‘™2ğ‘–+1,â€¦,ğ‘™2ğ‘¡) return yes, then feasible(ğ‘‡(ğ‘–,ğ‘—,ğ‘™),ğ‘™ğ‘–,ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡) also returns yes. Otherwise if for all ğ‘—1 there are no such values, feasible(ğ‘‡(ğ‘–,ğ‘—,ğ‘™),ğ‘™ğ‘–,ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡) returns no. The corner cases when ğ‘—1=ğ‘— or ğ‘—1=ğ‘™ can be handled similarly.

It is not hard to verify that feasible(ğ‘‡(ğ‘–,ğ‘—,ğ‘™),ğ‘™ğ‘–,ğ‘™ğ‘–+1,â€¦,ğ‘™ğ‘¡) correctly decides whether there is a feasible solution or not for T(i, j, l). To compute the feasible() function for all possible values one can use a simple dynamic programming based technique. In particular, one can store the values of the function for all possible parameters in a table. The table is filled up in a bottom-up manner, where the values corresponding to a level j subtree is computed before computations of the values corresponding to a level i subtree for ğ‘–<ğ‘—. It is not hard to see that the procedure would take polynomial time and space for a constant t.

Hardness of Approximation
In this section, we will prove the following theorem.

Theorem 2
For any constant c and any ğ›¾â‰¤ğ‘ğ‘›ğ‘, NUkC under ğ›¾-PR is hard to approximate in polynomial time within a factor of ğ›¾, unless ğ–­ğ–¯=ğ–±ğ–¯.

To prove this theorem, we use a chain of reductions that involves the following problems.

1-in-3SAT [28]

INSTANCE: An ordered pair (B, C) consisting of a set B of Boolean variables and a set C of clauses over B having three literals each in conjunctive normal form.

QUESTION: Is there a truth assignment for B such that every clause in C contains exactly one true literal?

RESOURCE MINIMIZATION FOR FIRE CONTAINMENT oN TREES (RMFC-T) [18, 23]

INSTANCE: A rooted tree T and an integer m.

QUESTION: Is there a set N of non-root nodes such that every root-leaf path contains a node from N and for any integer ğ‘—â‰¥1, |ğ‘âˆ©ğ¿ğ‘—|â‰¤ğ‘š, where ğ¿ğ‘— is the set of nodes at distance exactly j from the root?

The chain of reductions that we use consists of the following reductions: (1) 3SAT to 1-in-3SAT, (2) 1-in-3SAT to RMFC-T, and (3) RMFC-T to NUkC. Note that NUkC under PR has a unique optimal solution. As we would like to show hardness for the PR version of NUkC, we will consider â€œUnambiguousâ€ version of all these problems. For â€œUnambiguousâ€ version of 3SAT and 1-in-3SAT, if an instance has a feasible solution, the solution is unique. For â€œUnambiguousâ€ version of RMFC-T, if an instance has a feasible solution, the solution has a specific structure that we will define shortly. For the reduction from 3SAT to 1-in-3SAT, we ensure that the reduction preserves the number of solutions. Such a reduction is called a parsimonious reduction. To refer to the Unambiguous version of a problem we add a prefix â€˜U-â€™ to the problem name. Next, we discuss the details of the reductions.

In a celebrated work, Valiant and Vazirani [29] showed that U-3SAT is hard, unless ğ–­ğ–¯=ğ–±ğ–¯. Schaefer [28] showed a reduction from 3SAT to 1-in-3SAT to prove the ğ–­ğ–¯-hardness of the latter problem. As noted in [11] the reduction is parsimonious. We use the same reduction (now from U-3SAT to U-1-in-3SAT) to prove the hardness of U-1-in-3SAT, unless ğ–­ğ–¯=ğ–±ğ–¯.

Next, we discuss the reduction from 1-in-3SAT to RMFC-T. First, we define the Unambiguous version of RMFC-T. For a vertex v of a rooted tree T, let leaves(ğ‘‡ğ‘£) be the set of leaves at the subtree rooted at v. For any two feasible solutions ğ‘†1 and ğ‘†2 of RMFC-T, ğ‘†1 and ğ‘†2 are called equivalent, if the two sets âˆªğ‘£âˆˆğ‘†1 { leaves(ğ‘‡ğ‘£)} and âˆªğ‘£âˆˆğ‘†2 { leaves(ğ‘‡ğ‘£)} are identical. U-RMFC-T is same as RMFC-T except if the input instance has more than one feasible solutions, then all the feasible solutions are pairwise equivalent. The reduction from U-1-in-3SAT to U-RMFC-T appears towards the end of this section. The reduction is a non-trivial adaptation of the reduction due to Finbow et al. [18] from a version of 3SAT (RESTRICTED NAE 3-SAT) to the RMFC-T problem. We summarize our finding in the following lemma.

Lemma 5
Given a tree T, it is not possible to distinguish between the following two cases in polynomial time, unless ğ–­ğ–¯=ğ–±ğ–¯.

YES: There is a solution to the U-RMFC-T instance with ğ‘š=1.

NO: There is no solution to the U-RMFC-T instance with ğ‘š=1.

To complete the chain of reductions, now we discuss the last reduction. In particular, we show a reduction from RMFC-T to NUkC that proves the following theorem.

Theorem 3
For any constant c and any ğ›¾â‰¤ğ‘ğ‘›ğ‘, NUkC is ğ–­ğ–¯-hard to approximate within a factor of ğ›¾ in tree metrics.

Note that this theorem has already been proved in [13]. However, it is not straightforward to show that the instances of NUkC they construct are perturbation resilient. Using a similar construction, we will argue that the instances of NUkC to which the instances of RMFC-T map are perturbation resilient. However, to ensure that the constructed instance of NUkC has a unique optimal solution, we will consider the Unambiguous version of RMFC-T.

Proof of Theorem 3
To prove the theorem we show a reduction from U-RMFC-T. As mentioned before, the reduction is similar to the reduction used by Chakrabarty et al. [13]. The construction is as follows. Let h be the height of the tree. We set P to be the leaves of the given tree T, i.e., ğ‘ƒ=ğ¿â„. For any edge (u, v) of T such that ğ‘¢âˆˆğ¿â„ and ğ‘£âˆˆğ¿â„âˆ’1, assign a weight (ğ›¾+1)/2 to (u, v). For any edge (u, v) of T such that ğ‘¢âˆˆğ¿ğ‘– and ğ‘£âˆˆğ¿ğ‘–âˆ’1 for ğ‘–â‰¤â„âˆ’1, assign a weight ((ğ›¾+1)â„âˆ’ğ‘–+1âˆ’(ğ›¾+1)â„âˆ’ğ‘–)/2 to (u, v). Then the distance function d is the shortest-path metric on P induced by the weights of T. We set ğ‘¡=â„, ğ‘Ÿğ‘¡=0 and for any 1â‰¤ğ‘—<ğ‘¡, ğ‘Ÿğ‘—=(ğ›¾+1)ğ‘¡âˆ’ğ‘—. Also ğ‘˜1=â€¦=ğ‘˜ğ‘¡=1. Now we have the following observation.

Observation 3
For any two leaves ğ‘¢,ğ‘¢â€² with a common ancestor ğ‘£âˆˆğ¿ğ‘—, ğ‘‘(ğ‘¢,ğ‘¢â€²)â‰¤ğ‘Ÿğ‘—.

Proof
ğ‘‘(ğ‘¢,ğ‘¢â€²)â‰¤ğ‘‘(ğ‘¢,ğ‘£)+ğ‘‘(ğ‘£,ğ‘¢â€²)=((ğ›¾+1)/2+((ğ›¾+1)2âˆ’(ğ›¾+1))/2+â€¦+((ğ›¾+1)â„âˆ’ğ‘—âˆ’(ğ›¾+1)â„âˆ’ğ‘—âˆ’1)/2)+((ğ›¾+1)/2+((ğ›¾+1)2âˆ’(ğ›¾+1))/2+â€¦+((ğ›¾+1)â„âˆ’ğ‘—âˆ’(ğ›¾+1)â„âˆ’ğ‘—âˆ’1)/2)=ğ‘Ÿğ‘—.
â—»

We note that the weight of any edge is bounded by (ğ›¾+1)â„âˆ’1=ğ‘ğ‘‚(ğ‘›ğ‘â„) and thus can be represented using ğ‘‚(ğ‘›ğ‘â„) number of bits. It follows that the construction can be done in polynomial-time. We denote the constructed instance of NUkC by I. For simplicity, we use the terms point and leaf interchangeably. The following lemma completes the proof of Theorem 3 which follows from the construction and the fact that the feasible solutions for T are pairwise equivalent.

Lemma 6
If T is the â€œYESâ€ case of Lemma 5, then the optimum dilation of I is 1. If T is the â€œNOâ€ case of Lemma 5, then the optimum dilation of I is more than ğ›¾. Moreover, I has a unique optimal clustering.

Proof
Let T be a â€œYESâ€ instance and N be a solution for T. We construct a solution for I from N as follows. For any ğ‘£âˆˆğ‘, let j be the integer such that ğ‘£âˆˆğ¿ğ‘—. We select a leaf u from the subtree rooted at v and place a ball of radius ğ‘Ÿğ‘—. We note that at most 1 ball of radius ğ‘Ÿğ‘– is selected for all i, as |ğ‘âˆ©ğ¿ğ‘–|â‰¤1. Now consider any point ğ‘¤âˆˆğ‘ƒ. Then there must be a node v in N along the path between w and the root. Let ğ‘£âˆˆğ¿ğ‘—. Now the way we place the balls there must be a leaf u in the subtree rooted at v such that a ball of radius ğ‘Ÿğ‘— is opened at u. As v is a common ancestor of u and w, from Observation 3, it follows that ğ‘‘(ğ‘¢,ğ‘¤)â‰¤ğ‘Ÿğ‘—. Hence the ball ğµ(ğ‘¢,ğ‘Ÿğ‘—) covers w.

Now let T be a â€œNOâ€ instance and the optimum dilation of I be at most ğ›¾. Consider such a solution S corresponding to the instance I. We construct a solution N for U-RMFC-T on T using S as follows. For any 1â‰¤ğ‘—â‰¤ğ‘¡, let u be the point where the ball (of radius at most ğ›¾ğ‘Ÿğ‘—) corresponding to ğ‘Ÿğ‘— is placed. Let v be the ancestor of u that is in ğ¿ğ‘—. We add v to N. Note that, as S contains only one ball corresponding to the value ğ‘Ÿğ‘–, |ğ‘âˆ©ğ¿ğ‘–|â‰¤1 for all i. Now consider any leaf w. We show that N contains a node along the w-root path. Let B be a ball in S that covers w. Also let B be corresponding to the value ğ‘Ÿğ‘— and is centered at the point u. Suppose v is the ancestor of u that is in ğ¿ğ‘—. As the radius of the ball at u is at most ğ›¾ğ‘Ÿğ‘—<ğ‘Ÿğ‘—âˆ’1, a point that is not contained in the subtree rooted at v cannot be covered by B. Hence w must be contained in the subtree rooted at v and thus w-root path contains ğ‘£âˆˆğ‘. But this implies that N is a solution for T corresponding to the â€œYESâ€ case and thus T must be a â€œYESâ€ instance. But this is a contradiction and thus the optimum dilation of I must be more than ğ›¾.

As the feasible solutions for T are pairwise equivalent, it follows due to argument above that these feasible solutions get mapped to a unique optimal clustering of dilation 1. Similarly, the unique optimal clustering of dilation 1 gets mapped to a feasible solution of T. It follows that I has a unique optimal clustering. â—»

Hardness of Perturbation Resilient Version of NUkC
To show the hardness of the ğ›¾-perturbation-resilient version of NUkC, we prove that the constructed instances of U-NUkC in the reduction from U-RMFC-T to U-NUkC in tree metrics are ğ›¾-PR. First, we remind the reader of the tree metric ğ‘‘âˆ— we used there. We are given a parameter ğ›¾ and a tree ğ‘‡ğ›¾ with height h whose leaves are at the same distance from the root. The points in the metric space correspond to all the leaves of ğ‘‡ğ›¾. Let n be the number of leaves. Also, let ğ¿ğ‘– be the nodes of ğ‘‡ğ›¾ at level i for 1â‰¤ğ‘–â‰¤â„. For an edge (u, v) of T such that ğ‘¢âˆˆğ¿â„ and ğ‘£âˆˆğ¿â„âˆ’1, we assign a weight ğ‘™(ğ‘¢,ğ‘£)=(ğ›¾+1)/2 to (u, v). For each ğ‘¢âˆˆğ¿ğ‘–, ğ‘£âˆˆğ¿ğ‘–âˆ’1 for ğ‘–â‰¤â„âˆ’1 such that (u, v) is an edge in ğ‘‡ğ›¾, we assign a weight ğ‘™(ğ‘¢,ğ‘£)=((ğ›¾+1)â„âˆ’ğ‘–+1âˆ’(ğ›¾+1)â„âˆ’ğ‘–)/2. For any two leaves ğ‘¤,ğ‘¤â€², ğ‘‘âˆ—(ğ‘¤,ğ‘¤â€²) is the length of the shortest path between w and ğ‘¤â€², i.e., if the least common ancestor of ğ‘¤,ğ‘¤â€² is in ğ¿ğ‘—, then ğ‘‘âˆ—(ğ‘¤,ğ‘¤â€²)=(ğ›¾+1)â„âˆ’ğ‘—. We set ğ‘¡=â„, ğ‘Ÿğ‘¡=0 and for any 1â‰¤ğ‘—<ğ‘¡, ğ‘Ÿğ‘—=(ğ›¾+1)ğ‘¡âˆ’ğ‘—. Also, ğ‘˜1=â€¦=ğ‘˜ğ‘¡=1. Let ğ¿(ğ›¾) be the set of leaves of ğ‘‡ğ›¾. As the distance between any two points and the ğ‘Ÿğ‘—â€™s are of the form (ğ›¾+1)ğ‘– for some i, we have the following observation.

Observation 4
The optimal dilation of the instance îˆµ={ğ¿(ğ›¾),ğ‘‘âˆ—,ğ‘¡} is (ğ›¾+1)ğ‘– for some integer ğ‘–â‰¥0.

As we have shown before, for any constant c and any ğ›¾â‰¤ğ‘ğ‘›ğ‘, U-NUkC is hard to approximate within a factor of ğ›¾ for the metric space (ğ‘‡ğ›¾,ğ‘‘âˆ—), unless ğ–­ğ–¯=ğ–±ğ–¯. Next, we prove the following lemma.

Lemma 7
The instance îˆµ={ğ¿(ğ›¾),ğ‘‘âˆ—,ğ‘¡} is ğ›¾-PR.

Proof
Let îˆ» be the optimal clustering of îˆµ and ğ›¼ be its dilation. Consider any ğ›¾-perturbation ğ‘‘â€² of ğ‘‘âˆ—. We prove that the optimal clustering îˆ»â€² of the instance îˆµâ€²={ğ¿(ğ›¾),ğ‘‘â€²,ğ‘¡} is same as îˆ». Suppose for the sake of contradiction that îˆ»â€² is not same as îˆ». As ğ‘‘â€² is a ğ›¾-perturbation (the distances are non-increasing), the dilation of îˆ»â€² is at most ğ›¼. We show that îˆ»â€² is also a feasible clustering for îˆµ with dilation at most ğ›¼.

Consider any non-singleton cluster ğ¶âˆˆîˆ»â€² with center ğ‘1 that is covered by an ğ‘Ÿğ‘—-ball for ğ‘—<ğ‘¡. Then, for all pairs of points ğ‘,ğ‘âˆˆğ¶, ğ‘‘â€²(ğ‘,ğ‘)â‰¤ğ›¼ğ‘Ÿğ‘—. This is true, as all the points are leaves of the tree. From Observation 4, it follows that ğ›¼ğ‘Ÿğ‘—=(ğ›¾+1)ğ‘– for some i. As ğ‘‘â€² is a ğ›¾-perturbation of ğ‘‘âˆ—, ğ‘‘âˆ—(ğ‘,ğ‘)â‰¤ğ›¾â‹…ğ‘‘â€²(ğ‘,ğ‘)<(ğ›¾+1)ğ‘–+1. Now, the way ğ‘‡ğ›¾ is constructed, there is no distance values strictly between (ğ›¾+1)ğ‘– and (ğ›¾+1)ğ‘–+1. Hence, ğ‘‘âˆ—(ğ‘,ğ‘)â‰¤(ğ›¾+1)ğ‘–=ğ›¼ğ‘Ÿğ‘—, and the ball ğµ(ğ‘1,ğ›¼ğ‘Ÿğ‘—) covers the points of the cluster C w.r.t. ğ‘‘âˆ—. It follows that îˆ»â€² is also a feasible clustering for îˆµ with dilation at most ğ›¼. But, as per our assumption îˆ» and îˆ»â€² are different, and thus the optimal clustering of îˆµ is not unique. This is a contradiction, and hence îˆ» and îˆ»â€² must be same. â—»

Hardness in the Euclidean Metric
For Euclidean metric, we prove the following theorem.

Theorem 4
For any constant ğœ… and any ğ›½â‰¤ğœ…ğ‘›ğœ…, NUkC under ğ›½-PR is hard to approximate within a factor of ğ›½ in the Euclidean metric of dimension d for any ğ‘‘â‰¥1, unless ğ–­ğ–¯=ğ–±ğ–¯.

This result is in turn based on the following theorem due to Gupta [21].

Theorem 5
[21] Any weighted tree T with L leaves can be embedded in polynomial -time into d-dimensional Euclidean space with ğ‘‚(ğ‘‘ğ¿1/(ğ‘‘âˆ’1)min{logğ¿, ğ‘‘}1/2) distortion.

The idea is to show that if there is a polynomial-time ğ›½-approximation for NUkC under ğ›½-PR in the Euclidean metric for any constant ğœ… and any ğ›½â‰¤ğœ…ğ‘›ğœ…, then there is also a polynomial-time ğ›¾-approximation for NUkC under ğ›¾-PR in tree metrics for any ğ›¾â‰¤ğ‘ğ‘›ğ‘, where c is a constant. But, by Theorem 2 this is a contradiction, and hence the proof of the theorem follows. To obtain the ğ›¾-approximation in tree metrics we embed the tree metric into Euclidean metric of dimension d using the algorithm of Theorem 5. Then, we use the algorithm for Euclidean metric to obtain a solution for the embedded instance. Lastly, we map this solution back to the tree metric with sufficient expansion of the balls. For a suitable choice of ğ›½, one can show that the constructed solution is a ğ›¾-approximation.

Let X and Y be two finite metric spaces with metrics d and ğ‘‘â€², respectively. Let ğ‘“:ğ‘‹â†’ğ‘Œ be a map. Then, the contraction of f is defined as,

ğ·ğ‘(ğ‘“)=maxğ‘¥,ğ‘¦âˆˆğ‘‹ğ‘‘(ğ‘¥,ğ‘¦)ğ‘‘â€²(ğ‘“(ğ‘¥),ğ‘“(ğ‘¦)).
The expansion of f is similarly defined as,

ğ·ğ‘’(ğ‘“)=maxğ‘¥,ğ‘¦âˆˆğ‘‹ğ‘‘â€²(ğ‘“(ğ‘¥),ğ‘“(ğ‘¦))ğ‘‘(ğ‘¥,ğ‘¦).
The distortion of f, ğ·(ğ‘“)=ğ·ğ‘(ğ‘“)â‹…ğ·ğ‘’(ğ‘“). We need Theorem 5 due to Gupta [21] for proving the hardness result. Next, we prove Theorem 4.

Proof
Suppose there is a polynomial-time ğ›½-approximation for NUkC under ğ›½-PR in the Euclidean metric for any constant ğœ… and any ğ›½â‰¤ğœ…ğ‘›ğœ…. Then, we show that there is a polynomial-time ğ›¾-approximation for NUkC under ğ›¾-PR in tree metrics for any ğ›¾â‰¤ğ‘ğ‘›ğ‘, where c is a constant. But, by Theorem 2 this is a contradiction, and hence the proof of the theorem follows.

Now, consider a constant c and any ğ›¾â‰¤ğ‘ğ‘›ğ‘. Also, consider any instance of NUkC under ğ›¾-PR in the tree metric induced by the weighted tree T. We show how to get a ğ›¾-approximate solution for T using the approximation algorithm for the Euclidean metric. Let Î”=ğ‘‚(ğ‘‘ğ‘›1/(ğ‘‘âˆ’1)logğ‘›). First, we embed the tree T into d-dimensional Euclidean space â„ğ‘‘ using the algorithm of Theorem 5. Let ğ‘“:ğ‘‡â†’â„ğ‘‘ be the embedding. Also, let d and ğ‘‘ğ‘“ denote the tree and the Euclidean metric, respectively. We fix ğ›½ such that ğ›½â‰¤ğ›¾/Î”, and compute a ğ›½-approximate solution S of NUkC under ğ›½-PR for the Euclidean instance. Thereafter, we construct a solution ğ‘†â€² for the problem on T from the solution S in the following way. For any node x of T, if S contains a ball centered at f(x) with radius r, then we add the ball at x of radius ğ·ğ‘(ğ‘“)â‹…ğ‘Ÿ to ğ‘†â€², where ğ·ğ‘(ğ‘“) is the contraction of f. First, we show that the solution ğ‘†â€² constructed in this way covers all the nodes of T. Consider any node x of T. Then, there is a ball in S centered at some point f(y) that covers f(x). Let r be the radius of this ball. It follows that ğ‘†â€² contains the ball B centered at y having radius ğ·ğ‘(ğ‘“)â‹…ğ‘Ÿ. Now,

ğ‘‘(ğ‘¥,ğ‘¦)â‰¤ğ·ğ‘(ğ‘“)â‹…ğ‘‘ğ‘“(ğ‘“(ğ‘¥),ğ‘“(ğ‘¦))â‰¤ğ·ğ‘(ğ‘“)â‹…ğ‘Ÿ.
Hence, the ball B contains x, and thus ğ‘†â€² is a feasible solution. Now, we show that the dilation ğ›¼(ğ‘†â€²) of the balls in ğ‘†â€² is at most ğ›¾ times the optimum dilation. To this end, let OPT and ğ‘‚ğ‘ƒğ‘‡ğ‘“ be the optimum dilation for the tree and the Euclidean instance, respectively. Then, the dilation ğ›¼(ğ‘†â€²) is at most ğ›½â‹…ğ‘‚ğ‘ƒğ‘‡ğ‘“â‹…ğ·ğ‘(ğ‘“). Now, as the distances between the points can get expanded by a factor of at most ğ·ğ‘’(ğ‘“) due to the embedding, ğ‘‚ğ‘ƒğ‘‡ğ‘“â‰¤ğ·ğ‘’(ğ‘“)â‹…ğ‘‚ğ‘ƒğ‘‡. Here ğ·ğ‘’(ğ‘“) is the expansion of f. Hence,

ğ›¼(ğ‘†â€²)â‰¤ğ›½â‹…ğ·ğ‘’(ğ‘“)â‹…ğ‘‚ğ‘ƒğ‘‡â‹…ğ·ğ‘(ğ‘“)=ğ›½â‹…ğ·(ğ‘“)â‹…ğ‘‚ğ‘ƒğ‘‡â‰¤ğ›½â‹…Î”â‹…ğ‘‚ğ‘ƒğ‘‡â‰¤ğ›¾â‹…ğ‘‚ğ‘ƒğ‘‡.
This completes the proof of the theorem. â—»

Reduction from U-1-in-3SAT to U-RMFC-T
Finbow et al. [18] showed a reduction from Restricted NAE 3-SAT to RMFC-T. As per the definition of Restricted NAE 3-SAT, if the input instance has a feasible assignment, then it must at least have two. Thus, it cannot have a unique feasible solution. This is the reason behind our selection of the problem 1-in-3SAT, which can have a unique feasible solution. However, the reduction is motivated by the one in [18]. For consistency, we borrow some of their notations.

Given an instance I of U-1-in-3SAT, we construct a rooted tree T with root r in multiple steps. Also, we choose the parameter ğ‘š=1. Before discussing the reduction, we have a few definitions to set up the stage. Throughout this discussion, we will use the operation root a copy of a rooted tree (T, r) at a vertex x of a graph G. This means we construct a new graph from the disjoint union of G and T by identifying x and r. A vertex v of a tree is said to be defended by a vertex u if the root to v path contains u. For any path, we assume that its root is one of the degree one vertices. Also, the length of a path is defined as the number of edges contained in it.

A ladder tree â„’ğ‘‡(ğ‘›) is a path having 2ğ‘›+1 vertices such that the middle vertex of the path is identified as the root of the tree. See Fig. 3(i). Thus, the root of â„’ğ‘‡(ğ‘›) has two branches each being a path of length n. A bell tree â„¬ğ‘‡(ğ‘›,ğ‘š) is formed by rooting a ladder tree â„’ğ‘‡(ğ‘›âˆ’ğ‘š) at an endpoint of a path having m edges. The other endpoint of the path becomes the root of the bell tree. See Fig. 3(ii). Thus, in the figure, the distance (in terms of edges) between a and b is m and the distance between a and a leaf is n. A snake tree ğ’®ğ‘‡(ğ‘›,ğ‘š) is formed by rooting an ğ‘šâˆ’1 length path at the root of a bell tree â„¬ğ‘‡(ğ‘›,ğ‘š+1). The root of the bell tree (or the path) becomes the root of the snake tree. Note that a snake tree has exactly one degree 3 vertex. See Fig. 3(iii). Thus, in the figure, the distance between a and b is m, and the length of the path between a and a leaf such that the path contains b is n. A rooted tree T is called full if all leaves occur at the same level. A rooted tree T is called complete if every internal vertex has exactly two children. One simple observation is that a complete and full binary tree of height â„â‰¥0 has 2â„+1âˆ’1 vertices, and among those 2â„ are leaves.

Fig. 3
figure 3
(i) A ladder tree. (ii) A bell tree. (iii) A snake tree. Dashed segments denote paths

Full size image
Now, we describe the construction. We are given the U-1-in-3SAT instance I=(B, C) with the set of variables ğµ={ğ‘1,â€¦,ğ‘ğ‘} and the set of clauses ğ¶={ğ¶1,â€¦,ğ¶ğ‘›}. Let ğ‘=âŒˆlogğ‘›âŒ‰+2. Thus, 2ğ‘â‰¥4ğ‘›. We are going to construct a tree T which is initialized to the root vertex r. For each 1â‰¤ğ‘–â‰¤ğ‘, root two paths of length i at the root r of T. Call the degree one vertices of these two paths ğ‘ğ‘– and ğ‘ğ‘–â¯â¯â¯â¯â¯. Root a complete and full binary tree of height p at ğ‘ğ‘– and ğ‘ğ‘–â¯â¯â¯â¯â¯ for each i. From each leaf of these trees root a path of length ğ‘âˆ’ğ‘–. Call the leaves of these paths ğ‘¡ğ‘ğ‘–,1,â€¦,ğ‘¡ğ‘ğ‘–,2ğ‘ and ğ‘¡ğ‘ğ‘–â¯â¯â¯â¯â¯,1,â€¦,ğ‘¡ğ‘ğ‘–â¯â¯â¯â¯â¯,2ğ‘. Note that all the leaf nodes are now at a distance ğ‘+ğ‘ from r. Root two paths of length ğ‘+1 at r, and call the degree one vertices of these paths ğ‘0 and ğ‘0â¯â¯â¯â¯â¯. So far the construction is exactly the same as the one in [18]. In the following, we modify their construction to adapt it for our setting. From ğ‘0 and ğ‘0â¯â¯â¯â¯â¯ root a complete and full binary tree of height p and ğ‘+1, respectively, and call their leaves ğ‘¡ğ‘0,1,â€¦,ğ‘¡ğ‘0,2ğ‘ and ğ‘¡ğ‘0â¯â¯â¯â¯â¯â¯,1,â€¦,ğ‘¡ğ‘0â¯â¯â¯â¯â¯â¯,2ğ‘+1. This completes the first phase of the construction (see Fig. 4).

Fig. 4
figure 4
Figure showing the constructed tree after the first phase

Full size image
In the second phase, we add clause gadgets by rooting special tree structures at the leaves of T constructed so far. For each 1â‰¤ğ‘—â‰¤ğ‘›, and for each literal l of ğ¶ğ‘—, root the snake tree ğ’®ğ‘‡(4ğ‘›+3,4ğ‘—âˆ’2) at ğ‘¡ğ‘™â¯â¯,ğ‘—. For 1â‰¤ğœâ‰¤3, let q be the ğœğ‘¡â„ literal of ğ¶ğ‘—. Root ğ’®ğ‘‡(4ğ‘›+3,4ğ‘—âˆ’2+ğœ) at ğ‘¡ğ‘,ğ‘—. Also, root the bell tree â„¬ğ‘‡(4ğ‘›+3,4ğ‘—+1) at r for each 1â‰¤ğ‘—â‰¤ğ‘›. For 1â‰¤ğ‘–â‰¤2ğ‘, add two children ğ‘¥ğ‘– and ğ‘¦ğ‘– of ğ‘¡ğ‘0,ğ‘–. In each such added child, root the ladder tree â„’ğ‘‡(4ğ‘›+1). For 1â‰¤ğ‘–â‰¤2ğ‘+1, add two children ğ‘¥ğ‘–â¯â¯â¯â¯â¯ and ğ‘¦ğ‘–â¯â¯â¯â¯â¯ of ğ‘¡ğ‘0â¯â¯â¯â¯â¯â¯,ğ‘–. In each such added child, root the ladder â„’ğ‘‡(4ğ‘›). At each remaining leaf of T (as mentioned before) where no tree structure has been rooted so far, root â„’ğ‘‡(4ğ‘›+3). This completes the construction.

Now, let us give an intuitive description of the clause gadgets. Note that our main goal is to defend all the leaves. Consider the clause ğ¶ğ‘—=(ğ‘1âˆ¨ğ‘2âˆ¨ğ‘3). In a feasible solution, exactly one literal of ğ¶ğ‘— must be true, say ğ‘1. Now suppose in the solution of U-RMFC-T we select the vertices corresponding to true literals, i.e., ğ‘1, ğ‘2â¯â¯â¯â¯â¯ and ğ‘3â¯â¯â¯â¯â¯. Note that we have added one snake tree corresponding to each complemented literal of ğ¶ğ‘—. Thus, all the vertices in the snake trees corresponding to ğ‘2â¯â¯â¯â¯â¯ and ğ‘3â¯â¯â¯â¯â¯ are already defended. In this case, we can defend the degree three vertex (and all of its descendants) of the snake tree corresponding to ğ‘1â¯â¯â¯â¯â¯ by choosing the degree three vertex itself. If more than one literal are true, then we need to defend vertices of at least two snake trees instead for which we would have to pick more than one vertices from a level. Now, we have also added three other snake trees one for each literal of ğ¶ğ‘—. As the snake tree corresponding to ğ‘1 is already defended by ğ‘1, we just need to defend the leaves of the remaining two. We can defend them by selecting the parent of the degree three vertex from the corresponding snake tree. In this way, we can also defend the last added bell tree by selecting its degree three vertex (see Fig. 5). The alignments of these degree three vertices and their parents help us pick them in different levels. Note that if none of the literals are true, then we would need to defend the leaves of the three snake trees corresponding to the literals and in that case it is not possible to defend the leaves of the bell tree corresponding to ğ¶ğ‘—.

Fig. 5
figure 5
Figure showing parts of the three snake trees and the bell tree corresponding to the literals of ğ¶ğ‘—. The circled vertices are selected in the solution

Full size image
The argument behind the correctness of the reduction is similar to the one in [18]. The forward direction is simple. First, defend the vertices corresponding to true literals, i.e., if ğ‘ğ‘– (resp. ğ‘ğ‘–â¯â¯â¯â¯â¯) is true, defend ğ‘ğ‘– (resp. ğ‘ğ‘–â¯â¯â¯â¯â¯) at time i for 1â‰¤ğ‘–â‰¤ğ‘. At time ğ‘+1, defend ğ‘0â¯â¯â¯â¯â¯. From time ğ‘+2 to ğ‘+ğ‘+1, defend the unprotected descendant of ğ‘0 which is not on the path from r to ğ‘¥1. At time ğ‘+ğ‘+2, defend ğ‘¥1. From time ğ‘+ğ‘+3 to ğ‘+ğ‘+4ğ‘›+3, defend the tree greedily by picking a vertex at each level that contains the maximum number of nodes in the subtree rooted at it. The other direction is nontrivial, but similar counting arguments as in [18] should be used for the proof. It follows that the U-1-in-3SAT formula is satisfiable if and only if all the leaves of T can be defended by selecting exactly one vertex from each level.

Finally, we show that all the feasible solutions are pairwise equivalent as claimed. This actually follows from the construction. Fix the unique feasible assignment to the U-1-in-3SAT formula. Then, while finding a feasible solution for U-RMFC-T from the assignment in the above, in all the steps one need to select a unique vertex except when one needs to choose the parent of the degree three vertices of ğ’®ğ‘‡(4ğ‘›+3,4ğ‘—+1) and â„¬ğ‘‡(4ğ‘›+3,4ğ‘—+1) both of which lie at the same level. However, irrespective of the selection, the set of leaves remains same. Thus, even though the solutions are different, the corresponding sets of leaves are same, and hence the solutions are pairwise equivalent.