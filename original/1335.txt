Given a fixed graph H, the H-free editing problem asks whether we can edit at most k edges to make a graph contain no induced copy of H. We obtain a polynomial kernel for this problem when H is a diamond. The incompressibility dichotomy for H being a 3-connected graph and the classical complexity dichotomy suggest that except for H being a complete/empty graph, H-free editing problems admit polynomial kernels only for a few small graphs H. Therefore, we believe that our result is an essential step toward a complete dichotomy on the compressibility of H-free editing. Additionally, we give a cubic-vertex kernel for the diamond-free edge deletion problem, which is far simpler than the previous kernel of the same size for the problem.

Access provided by University of Auckland Library

Introduction
A graph modification problem asks whether one can apply at most k modifications to a graph to make it satisfy certain properties. By modifications we usually mean additions and/or deletions, and they can be applied to vertices or edges. Although other modifications are also considered, most results in literature are on vertex deletion and the following three edge modifications: edge deletion, edge completion, and edge editing (deletion/completion).

As usual, we use n to denote the number of vertices of the input graph. For each graph modification problem, one may ask three questions: (1) Is it NP-complete? (2) Can it be solved in time ğ‘“(ğ‘˜)â‹…ğ‘›ğ‘‚(1) for some function f, and if yes, what is the (asymptotically) best f? (3) Does it have a polynomial kernel? The first question concerns classic complexity, while the other two are about parameterized complexity [7, 11]. With parameter k, a problem is fixed-parameter tractable (FPT) if it can be solved in time ğ‘“(ğ‘˜)â‹…ğ‘›ğ‘‚(1) for some function f. On the other hand, given an instance (G, k), a kernelization algorithm produces in polynomial time an equivalent instance (ğºâ€²,ğ‘˜â€²)â€”(G, k) is a yes-instance if and only if (ğºâ€²,ğ‘˜â€²) is a yes-instanceâ€”such that ğ‘˜â€²â‰¤ğ‘˜. It is a polynomial kernel if the size of ğºâ€² is bounded from above by a polynomial function of k.

For hereditary properties, a classic result of Lewis and Yannakakis [15] states that all the vertex deletion problems are either NP-hard or trivial. In contrast, the picture for edge modification problems is far murkier. Earlier efforts for edge deletion problems [9, 17], though having produced fruitful concrete results, shed little light on a systematic answer, and it was noted that such a generalization is difficult to obtain.

A basic and ostensibly simple case of graph modification problems is to make the graph H-free, where H is a fixed graph on at least two vertices. (We say that a graph is H-free if it does not contain H as an induced subgraph.) For this special case, all the three questions have been satisfactorily answered for vertex deletion problems, at least in the asymptotic sense. All of them are NP-complete and FPTâ€”indeed, H-free vertex deletion problems admit simple |ğ‘‰(ğ»)|ğ‘˜â‹…ğ‘›ğ‘‚(1)-time algorithms [4]. On the other hand, the reduction of Lewis and Yannakakis [15] excludes subexponential-time algorithms (2ğ‘œ(ğ‘˜)â‹…ğ‘›ğ‘‚(1)-time algorithms) assuming the exponential time hypothesis (ETH) [13]. Further, as observed by Flum and Grohe [11], the sunflower lemma of ErdÅ‘s and Rado [10] can be used to produce polynomial kernels for H-free vertex deletion problems.

Even restricted to this very simple case, edge modification problems remain elusive. Significant efforts have been devoted to an ongoing program that tries to answer these questions in a systematic way, and promising progress has been reported in literature. Recently, Aravind et al. [2] gave a complete answer to the first question: The H-free editing problem is NP-complete if and only if H contains at least three vertices. They also excluded subexponential-time algorithms for the NP-complete H-free edge modification problems, assuming ETH. Noting that H-free edge modification problems can always be solved in 2ğ‘‚(ğ‘˜)â‹…ğ‘›ğ‘‚(1) time [4], we are left with the third question, the existence of polynomial kernels.

Some of the H-free graph classes are important for their own structural reasons, e.g., most notably, cluster graphs and cographs, which are ğ‘ƒ3-free graphs and ğ‘ƒ4-free graphs respectively; hence the edge modification problems toward them have been well-studied [6, 12]. (Note that edge modification problems to ğ‘ƒ2-free graphs, i.e., independent sets, are trivial.) Given the simplicity of H-free edge modification problems, and the naive FPT algorithms for them, it may sound shocking that many of them do not admit polynomial kernels. Indeed, the earliest incompressibility results of graph modification problems, by Kratsch and WahlstrÃ¶m [14], are on H-free edge modification problems. Guillemot et al. [12] excluded polynomial kernels for H-free edge deletion problems when H is a path of length at least seven or a cycle of length at least four. An influential result of Cai and Cai [5] furnishes a dichotomy on the compressibility of H-free edge modification problems when H is a path, a cycle, or a 3-connected graph.

We tend to believe that H-free edge modification problems admitting polynomial kernels are the exceptions. Our exploration suggests that graphs on four vertices play the pivotal roles if we want to fully map the territory. Let ğ»â¯â¯â¯â¯â¯â¯ be the complement graph of H. Then the H-free edge deletion problem is equivalent to the ğ»â¯â¯â¯â¯â¯â¯-free edge completion problem, while the edge editing problems are the same for H-free and ğ»â¯â¯â¯â¯â¯â¯-free graphs. We are thus focused on the four-vertex graphs (Fig. 1); see Table 1 for a summary of compressibility results of H-free edge modification problems when H is one of them. We conjecture that claw-free edge modification problems admit polynomial kernels.

Fig. 1
figure 1
Graphs on four vertices (their complements are omitted)

Full size image
Table 1 The compressibility results of H-free edge modification problems for H being four-vertex graphs
Full size table
We show a polynomial kernel for the diamond-free editing problem. Our observations also lead to a cubic-vertex kernel for the diamond-free edge deletion problem, which is far simpler than the previous kernel of the same size [16]. Formally, these two problems are defined as following.

Diamond-free editing problem: Given an input graph G, can we edit (add/delete) at most k edges to make it diamond-free?

Diamond-free edge deletion problem: Given an input graph G, can we delete at most k edges to make it diamond-free?

On the other hand, the completion problem to diamond-free graphs is trivial: For each diamond, there is no choice but adding the only missing edge.

Our key observations are on maximal cliques. A graph G is diamond-free if and only if every two maximal cliques of G share at most one vertex. We say that a maximal clique is of type I if it shares an edge with another maximal clique, or type II otherwise. It is not hard to see that to make a graph diamond-free, we should never delete edges from a sufficiently large clique. We thus put the maximal cliques of G into three categories, small type I, big type I, and type II. It turns out that a vertex participates in a diamond if and only if it is in a maximal clique of type I, and the small type-I maximal cliques are crucial for the problem.

The first phase of our algorithm comprises two routine reduction rules for edge editing problems. If a (non-)edge participates in ğ‘˜+1 or more diamonds that pairwise share only this (non-)edge, then it has to be in a solution of size at most k. (This is exactly the reason why no edge is deleted from a â€œlargeâ€ clique.) If there exists such an edge/non-edge, we delete/add it. We may henceforth assume that these two simple rules have been exhaustively applied. We are able to show that the ends of an edge added by a minimum solution must be from some small maximal cliques of type I. The situation for deleted edges is slightly more complex. The two ends of a deleted edge are either in a small maximal clique of type I, or in a maximal clique of type II. In the second case, the maximal clique has to intersect some small maximal clique of type I.

The second phase of our algorithm uses three nontrivial reduction rules to delete irrelevant vertices. To analyze the size of the kernel, we bound the number of vertices that are (a) in small type-I maximal cliques only, (b) in big type-I maximal cliques but not in any small type-I maximal clique, and (c) only in type-II maximal cliques. First, we show an upper bound on the number of type-I maximal cliques. This immediately bounds the number of vertices in part (a), because each small type-I maximal clique has a bounded size. For part (b), the focus now is to bound the sizes of big maximal cliques of type I. We introduce another reduction rule to delete certain â€œprivate verticesâ€ from them. On the other hand, the pattern of vertices shared by big maximal cliques is very limited. We are thus able to bound the number of vertices in part (b), and we are left with part (c). We correlate a maximal clique K of type II with small maximal cliques of type I: we would touch K only because it had become type I after some operation, and this operation has to be an edge addition. Recall that an edge can only be added between two vertices in part (a). For each pair of them, we can build a blocker of ğ‘‚(ğ‘˜2) vertices from part (c). One more reduction rule is introduced to remove all vertices behind the blockers. Together with the bound of vertices in part (a), this bounds the number of vertices in part (c).

Putting everything together, we obtain the main result of this paper.

Theorem 1
The diamond-free editing problem has a kernel of ğ‘‚(ğ‘˜8) vertices.

In passing we would like to mention that the reduction rules in the second phase of our algorithm only delete vertices, and none of the deleted vertices is from a small maximal clique of type I. Hence, the main structure of the graph will not change, and this allows us to run them only once, and more importantly, we do not need to re-run the reduction rules in the first phase.

Before we conclude this section, let us have some remarks on future work. The main purpose of this paper is to take a step toward a complete dichotomy on the compressibility of H-free edge modification problems. Although our kernel for the diamond-free editing problem does not seem to be tight, we do not consider obtaining a smaller kernel a pressing issue. Instead, we would ask for the existence of polynomial kernels for the H-free editing problem in general, and for claw-free editing in particular.

Another question one may ask for graph modification problems is: (4) Does it admit a constant-ratio approximation algorithm? Again, the answer is simply yes for H-free vertex deletion problems. Once an induced copy of H is found, we delete all its vertices, which achieves ratio |V(H)|. However, this simple algorithm breaks down for edge modification problems: An edge added or deleted to fix an erstwhile H may introduce new one(s). This kind of propagations are the core difficulty of these problems [3, 5]. Hence, both the approximability and the compressibility seem to hinge on whether the propagations can be tamed, though maybe in different senses.

Outline of the Paper. After two simple reduction rules, Section 2 studies maximal cliques in the graph on which these two rules are not applicable, and how a minimum solution may impact them. Section 3 presents the main reduction rules, and establishes the bounds on the numbers of vertices in different categories, thereby proving the main theorem of the paper. Using the properties established in previous sections, the last section presents a very simple kernelization algorithm for the diamond-free edge deletion problem.

Maximal Cliques
All graphs discussed in this paper are undirected and simple. A graph G is given by its vertex set V(G) and edge set E(G). The neighborhood of a vertex v in a graph G, denoted by ğ‘ğº(ğ‘£), consists of all the vertices adjacent to v in G. We extend this to a set ğ‘†âŠ†ğ‘‰(ğº) of vertices by defining the neighborhood ğ‘ğº(ğ‘†) of S as (â‹ƒğ‘£âˆˆğ‘†ğ‘ğº(ğ‘£))âˆ–ğ‘†. For a set ğ‘ˆâŠ†ğ‘‰(ğº) of vertices, we denote by G[U] the subgraph induced by U, whose vertex set is U and whose edge set comprises all edges of G with both ends in U. We use ğºâˆ’ğ‘£, where v is a vertex of G, as a shorthand for ğº[ğ‘‰(ğº)âˆ–{ğ‘£}]. In a diamond, we refer to the edge between the two degree-three vertices as the cross edge, and the only non-edge the missing edge.

For a set ğ¸+ of edges, we denoted by ğº+ğ¸+ the graph obtained by adding edges in ğ¸+ to G,â€”its vertex set is still V(G) and its edge set becomes ğ¸(ğº)âˆªğ¸+. The graph ğºâˆ’ğ¸âˆ’ is defined analogously. Throughout the paper we always tacitly assume ğ¸+âˆ©ğ¸(ğº)=âˆ… and ğ¸âˆ’âŠ†ğ¸(ğº); hence ğ¸+ and ğ¸âˆ’ are disjoint. A solution of an instance (G, k) consists of a set ğ¸+ of added edges and a set ğ¸âˆ’ of deleted edges such that ğº+ğ¸+âˆ’ğ¸âˆ’ is diamond-free and |ğ¸+âˆªğ¸âˆ’|â‰¤ğ‘˜. We use ğ¸Â± as a shorthand for ğ¸+âˆªğ¸âˆ’, and there should be no ambiguities: ğ¸+=ğ¸Â±âˆ–ğ¸(ğº) and ğ¸âˆ’=ğ¸Â±âˆ©ğ¸(ğº). We also use ğºâ–³ğ¸Â± as a shorthand for ğº+ğ¸+âˆ’ğ¸âˆ’.

We start from a routine step for edge editing problems. If a (non-)edge uv participates in ğ‘˜+1 or more diamonds that pairwise share only this (non)-edge, then it has to be in any solution of size at most k. The following two reduction rules, taking care of the cases uv being the missing edge and being the cross edge respectively, would suffice for our purpose. The correctness of them is straightforward: If we do not add/delete uv, then we have to delete/add at least ğ‘˜+1 edges.

Rule 1
If there exist a non-edge uv and 2ğ‘˜+2 distinct vertices ğ‘¥1,ğ‘¦1,â€¦,ğ‘¥ğ‘˜+1,ğ‘¦ğ‘˜+1 in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) such that ğ‘¥ğ‘–ğ‘¦ğ‘–âˆˆğ¸(ğº) for all 1â‰¤ğ‘–â‰¤ğ‘˜+1, then add uv and decrease k by one.

Rule 2
If there exist an edge uv and 2ğ‘˜+2 distinct vertices ğ‘¥1,ğ‘¦1,â€¦,ğ‘¥ğ‘˜+1,ğ‘¦ğ‘˜+1 in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) such that ğ‘¥ğ‘–ğ‘¦ğ‘–âˆ‰ğ¸(ğº) for all 1â‰¤ğ‘–â‰¤ğ‘˜+1, then delete uv and decrease k by one.

For a non-edge uv, whether Rule 1 is applicable to uv can be decided by finding a maximum matching in ğº[ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£)]. Likewise, for ğ‘¢ğ‘£âˆˆğ¸(ğº), we can find a maximum matching in the complement graph of ğº[ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£)]. Therefore, Rules 1 and 2 can be applied in polynomial time. We call an instance (G, k) reduced if neither Rule 1 nor 2 is applicable to it. In the rest, we will focus on reduced instances. A similar idea as the two rules enables us to exclude some (non-)edges from consideration.

Proposition 2
Let ğ¸Â± be a solution to a yes-instance (G, k). A (non-)edge uv cannot be in ğ¸Â± if

(i)
ğ‘¢ğ‘£âˆˆğ¸(ğº) and there are ğ‘˜+1 pairwise adjacent vertices in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£); or

(ii)
ğ‘¢ğ‘£âˆ‰ğ¸(ğº) and there are ğ‘˜+1 pairwise nonadjacent vertices in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£).

Proof
Suppose for contradiction to assertion (i) that ğ‘¢ğ‘£âˆˆğ¸âˆ’. Let K be a set of ğ‘˜+1 pairwise adjacent vertices in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£), and let ğ‘‹âŠ†ğ¾ be the set of vertices x with xu or xv in ğ¸âˆ’. Vertices in ğ¾âˆ–ğ‘‹ remain adjacent to both u and v in ğºâˆ’ğ¸âˆ’. Since the final graph is diamond-free, ğ¸âˆ’ must contain all edges among ğ¾âˆ–ğ‘‹. Therefore,

|ğ¸âˆ’|â‰¥1+|ğ‘‹|+(|ğ¾âˆ–ğ‘‹|âˆ’1)=ğ‘˜+1,
which is impossible because ğ¸Â± is a solution to (G, k).

The argument for assertion (ii) is similar and hence omitted. â—»

Proposition 3
Let (G, k) be a reduced yes-instance. For any (non-)edge uv in a solution of (G, k), the cardinality of ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) is at most 3k.

Proof
We consider only ğ‘¢ğ‘£âˆˆğ¸âˆ’, and the argument for ğ‘¢ğ‘£âˆˆğ¸+ is similar and omitted.

Let ğ‘Š=ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£); we find a maximum matching in the complement graph of G[W], and let ğ‘Šâ€² be the ends of the edges in the matching. Since Rule 2 is not applicable (to uv), |ğ‘Šâ€²|â‰¤2ğ‘˜. There cannot be non-edges between vertices in ğ‘Šâˆ–ğ‘Šâ€²; then by Proposition 2(i), the size of ğ‘Šâˆ–ğ‘Šâ€² is at most k. Therefore, |ğ‘Š|â‰¤3ğ‘˜. â—»

Our algorithm will be mostly concerned with maximal cliques. According to Proposition 2(i), a maximal clique on ğ‘˜+3 or more vertices cannot be touched by a minimum solution â€œfrom inside,â€ but it may be touched â€œfrom outsideâ€. We call a maximal clique big if it contains at least 3ğ‘˜+2 vertices, and small otherwise.

Lemma 4
Let (G, k) be a reduced instance.

(i)
Two big maximal cliques of G share at most one vertex.

(ii)
If (G, k) is a yes-instance, then a big maximal clique of G remains a maximal clique after applying a solution to (G, k).

Proof
Let ğ¾1 and ğ¾2 be two big maximal cliques of G. Suppose first that some vertex ğ‘¢âˆˆğ¾1âˆ–ğ¾2 is adjacent to more than 2ğ‘˜+1 vertices in ğ¾2. Since ğ¾2 is a maximal clique, we can find ğ‘£âˆˆğ¾2âˆ–ğ¾1 nonadjacent to u, but then Rule 1 would be applicable (to uv). Hence, every vertex in ğ¾1âˆ–ğ¾2 has at most 2ğ‘˜+1 neighbors in ğ¾2, which implies |ğ¾1âˆ©ğ¾2|â‰¤2ğ‘˜+1. By assumption, |ğ¾1|â‰¥3ğ‘˜+2 and |ğ¾2|â‰¥3ğ‘˜+2. For each vertex in ğ¾1âˆ–ğ¾2, we can find ğ‘˜+1 non-neighbors in ğ¾2âˆ–ğ¾1. Therefore, we can greedily find ğ‘˜+1 pairs of distinct vertices {ğ‘¥1,ğ‘¦1}, â€¦, {ğ‘¥ğ‘˜+1,ğ‘¦ğ‘˜+1} such that for all 1â‰¤ğ‘–â‰¤ğ‘˜+1, (a) ğ‘¥ğ‘–âˆˆğ¾1âˆ–ğ¾2 and ğ‘¦ğ‘–âˆˆğ¾2âˆ–ğ¾1; and (b) ğ‘¥ğ‘–ğ‘¦ğ‘–âˆ‰ğ¸(ğº). Rule 2 would be applicable (to any edge in ğº[ğ¾1âˆ©ğ¾2]) if |ğ¾1âˆ©ğ¾2|â‰¥2. Therefore, |ğ¾1âˆ©ğ¾2|â‰¤1, and this concludes the proof for assertion (i).

Let ğ¸Â± be a solution to (G, k) and ğºâˆ—=ğºâ–³ğ¸Â±. By Proposition 2(i), a big maximal clique K in G remains a clique in ğºâˆ—. Let ğ‘£âˆˆğ‘‰(ğº)âˆ–ğ¾ and let ğ‘¢âˆˆğ¾âˆ–ğ‘ğº(ğ‘£). Since Rule 1 is not applicable to uv, there are at most 2ğ‘˜+1 neighbors of v in K. Since |ğ¾|â‰¥3ğ‘˜+2, at least one vertex in K remains nonadjacent to v in ğºâˆ— because |ğ¸+|â‰¤ğ‘˜. Therefore, K is a maximal clique in ğºâˆ— as well. â—»

It is well known that a graph G is diamond-free if and only if every pair of adjacent vertices is contained in exactly one maximal clique of G. (Proposition 5 implies this fact.) This characterization turns out to be fundamental for the results in this paper. We say that a maximal clique of G is of type I if it shares two or more vertices with some other maximal clique, and type II otherwise (its intersection with any other maximal clique is either 0 or 1 vertex). We can then rephrase the first sentence of this paragraph as: A graph is diamond-free if and only if it has no maximal clique of type I.

We use îˆ·ğ‘(ğº), îˆ·ğ‘ (ğº), and îˆ·2(ğº) to denote, respectively, the set of big maximal cliques of type I, the set of small maximal cliques of type I, and the set of maximal cliques of type II, of G. A maximal clique in G is in precisely one of them. The next proposition characterizes maximal cliques of type I and vertices in them.

Proposition 5
(i) A maximal clique is of type I if and only if it contains both ends of the cross edge of a diamond. (ii) A vertex is in a maximal clique of type I if and only if it is contained in an induced diamond.

Proof
The following argument proves assert (i), and it also works for assert (ii).

Let u, v, x, y be four vertices inducing a diamond in G with cross edge uv. We can find two maximal cliques ğ¾1,ğ¾2 containing u, v, x and u, v, y respectively. For any maximal clique K containing u, v, at least one of ğ¾1,ğ¾2 is different from K, hence K is of type I.

We now consider the â€œonly ifâ€ direction. Let ğ¾1 be a maximal clique of type I; by definition, there is another maximal clique ğ¾2 such that |ğ¾1âˆ©ğ¾2|â‰¥2. For any vertex ğ‘¥âˆˆğ¾1âˆ–ğ¾2 and any vertex ğ‘¢âˆˆğ¾1âˆ©ğ¾2, we can find another vertex ğ‘£âˆˆğ¾1âˆ©ğ¾2 different from u and a vertex ğ‘¦âˆˆğ¾2âˆ–ğ¾1 not adjacent to x (because ğ¾2 is maximal). Clearly, these four vertices induce a diamond with cross edge uv. â—»

The following two statements help us understand edges added by a minimum solution.

Proposition 6
Let G be a diamond-free graph, and let ğ‘ˆâŠ†ğ‘‰(ğº) such that every vertex in ğ‘‰(ğº)âˆ–ğ‘ˆ is adjacent to at most one vertex of U. If ğº[ğ‘ˆ]â–³ğ¸Â± is diamond-free for a set ğ¸+ of non-edges in G[U] and a set ğ¸âˆ’ of edges in G[U], then so is ğºâ–³ğ¸Â±.

Proof
Suppose for contradiction that ğºâˆ—=ğºâ–³ğ¸Â± contains a diamond; let D be a set of vertices inducing a diamond in ğºâˆ—. Since G[D] is not a diamond, at least one (non-)edge of this diamond belongs to ğ¸Â±, and is between vertices of U. On the other hand, ğº[ğ‘ˆ]â–³ğ¸Â± remains diamond-free, hence ğ·âŠˆğ‘ˆ. Therefore, |ğ·âˆ©ğ‘ˆ| is either two or three, but then a vertex in ğ·âˆ–ğ‘ˆ is adjacent to at least two vertices of ğ·âˆ©ğ‘ˆ in G, a contradiction. â—»

Lemma 7
Let ğ¸Â± be a minimum solution to a reduced yes-instance (G, k). Every vertex incident to some edge in ğ¸+ is contained in some small maximal clique of type I in G.

Proof
Let ğºâˆ—=ğºâ–³ğ¸Â±, where uv is an edge in ğ¸+, and let U be a maximal clique of ğºâˆ— containing u, v. We argue first that v is in some induced diamond in G[U].

Suppose for contradiction that v participates in no diamond in G[U]. Let ğ‘‹=ğ‘ğº(ğ‘£)âˆ©ğ‘ˆ. The subgraph G[X] is a disjoint union of cliques: An induced path of length two would make a diamond with v. Let {ğ´1,â€¦,ğ´ğ‘} be those nontrivial cliques (containing more than one vertex) in G[X]; let B be the other vertices of X; and let ğ¶=ğ‘ˆâˆ–ğ‘ğº[ğ‘£]. Then {ğ´1,â€¦,ğ´ğ‘,ğµ,ğ¶} is a partition of the set ğ‘ˆâˆ–{ğ‘£}. Note that p or |B| may be 0, but |ğ¶|>0 because ğ‘¢âˆˆğ¶.

To arrive at a contradiction, we will construct a solution ğ¸â€²Â± for G[U] whose size is smaller than the number of non-edges in G[U]. Assume such an ğ¸â€²Â± exists and let ğºâ€² be the graph obtained from ğºâˆ— by replacing ğºâˆ—[ğ‘ˆ] with ğº[ğ‘ˆ]â–³ğ¸â€²Â±. Since U is a type-II maximal clique of ğºâˆ—, for each ğ‘¥âˆˆğ‘‰(ğº)âˆ–ğ‘ˆ we have |ğ‘ğºâˆ—(ğ‘¥)âˆ©ğ‘ˆ|â‰¤1. By Proposition 6, ğºâ€² is diamond-free. This would however imply a strictly smaller solution than ğ¸Â±, contradicting that ğ¸Â± is a minimum solution of (G, k). Now we show how to construct ğ¸â€²Â±.

Case 1, |ğµ|â‰¥|ğ¶|. We set ğ¸â€²+=âˆ… and ğ¸â€²âˆ’ the set of edges in G[C]. No edge in ğ¸â€²âˆ’ is incident to v or N(v), and hence ğ‘(ğ‘£)âˆ©ğ‘ˆ is still a disjoint union of cliques in ğºâ€². On the other hand, no vertex ğ‘¥âˆˆğ¶ is in any diamond in ğºâ€²[ğ‘ˆ] because ğ‘ğºâ€²(ğ‘¥)âˆ©ğ‘ˆ is an independent set. Thus, ğºâ€²[ğ‘ˆ] is diamond-free. Since B is an independent set of G, and v is nonadjacent to C, we have

|ğ¸+âˆ©ğ‘ˆ2|â‰¥(|ğµ|2)+|ğ¶|â‰¥(|ğ¶|2)+|ğ¶|>|ğ¸â€²âˆ’|=|ğ¸â€²+âˆªğ¸â€²âˆ’|.
Case 2, |ğµ|<|ğ¶|. We set ğ¸â€²+ to be the set of non-edges in ğº[ğµâˆªğ¶], and ğ¸â€²âˆ’ the set of edges between ğµâˆªğ¶ and ğ‘ˆâˆ–(ğµâˆªğ¶). To see that ğºâ€²[ğ‘ˆ] is diamond-free, note that its maximal cliques are ğµâˆªğ¶ and {ğ‘£}âˆªğ´ğ‘– for 1â‰¤ğ‘–â‰¤ğ‘, whose intersection is either {ğ‘£} or empty. We then calculate the cardinality of ğ¸+âˆ©ğ‘ˆ2, which comprises three parts, those among ğµâˆªğ¶, which is exactly ğ¸â€²+, those between C and v, and those between C and ğ´ğ‘–â€™s. Since v does not belong to any diamond in G[U], each vertex in C is adjacent to at most one vertex of ğ´ğ‘–,1â‰¤ğ‘–â‰¤ğ‘. In other words, for each ğ‘¥âˆˆğ¶ and each 1â‰¤ğ‘–â‰¤ğ‘, the number of non-edges between x and ğ´ğ‘– is at least one. Therefore

|ğ¸+âˆ©ğ‘ˆ2|â‰¥|ğ¸â€²+|+|ğ¶|+|ğ¶|Ã—ğ‘>|ğ¸â€²+|+|ğµ|+|ğ¶|Ã—ğ‘â‰¥|ğ¸â€²+|+|ğ¸â€²âˆ’|.
Now that v is in some induced diamond in G[U], we can find a maximal clique K of G containing v and another two vertices of this diamond. Since U is not a clique in G, we have ğ¾â‰ ğ‘ˆ. And |ğ¾âˆ©ğ‘ˆ|â‰¥3 implies that K cannot induce a maximal clique of ğºâˆ—. Hence by Lemma 4(ii), it is small. This concludes the proof of the lemma. â—»

After delimiting the ends of the edges added by a minimum solution, we now turn to the ends of those edges deleted by a minimum solution. The next lemma states that some maximal cliques in G remain maximal cliques after applying the solution, that is, none of the edges inside those cliques are deleted.

Lemma 8
Let ğ¸Â± be a minimum solution to an instance (G, k), and let K be a maximal clique of type II in G. If ğ¸+ contains neither (i) an edge between ğ‘¢âˆˆğ¾ and ğ‘£âˆˆğ‘(ğ¾), nor (ii) two edges between vertices of K and the same vertex in ğ‘‰(ğº)âˆ–ğ¾, then K remains a maximal clique (of type II) in ğºâ–³ğ¸Â±.

Proof
Let ğºâˆ—=ğºâ–³ğ¸Â±. Since K is a type-II maximal clique of G, each vertex ğ‘£âˆˆğ‘‰(ğº)âˆ–ğ¾ has at most one neighbor in K. By the assumption that ğ¸+ contains neither (i) nor (ii), this remains true in ğº+ğ¸+ and ğºâˆ—.

On the other hand, ğ¸âˆ’ cannot contain edges of G[K]; otherwise, by Proposition 6, ğºâˆ— remains diamond-free after replacing ğºâˆ—[ğ¾] by G[K], which implies a strictly smaller solution than ğ¸Â±. Therefore, K is a maximal clique in ğºâˆ—. â—»

The next corollary follows from Lemmas 7 and 8.

Corollary 9
Let ğ¸Â± be a minimum solution to a reduced yes-instance (G, k), and let K be a maximal clique of G containing both ends of an edge in ğ¸âˆ’. Then either ğ¾âˆˆîˆ·ğ‘ (ğº), or ğ¾âˆˆîˆ·2(ğº) and K intersects one clique in îˆ·ğ‘ (ğº).

Fig. 2
figure 2
An example with ğ‘˜=4, of which a minimum solution is {+ğ‘¢2ğ‘£2,âˆ’ğ‘¢1ğ‘£2,âˆ’ğ‘£0ğ‘£1,âˆ’ğ‘¢3ğ‘£9}. (Note that ğ‘¢1ğ‘£2 and ğ‘£0ğ‘£1 are not in any diamond of G.) It has six maximal cliques, ğ¾1={ğ‘£0,ğ‘£1,ğ‘£2,ğ‘¢1}, ğ¾2={ğ‘£2,ğ‘£3,ğ‘£4,ğ‘£5,ğ‘£6}, ğ¾3={ğ‘¢2,ğ‘£3,ğ‘£4,ğ‘£5,ğ‘£6}, ğ¾4={ğ‘¢3,ğ‘£7,ğ‘£8}, ğ¾5={ğ‘¢3,ğ‘¢4,ğ‘£9}, while ğ¾6 comprises of ğ‘¢1,ğ‘¢2,ğ‘¢3,ğ‘¢4 and other ten unlabeled vertices. Four of these maximal cliques, ğ¾2, ğ¾3, ğ¾5, and ğ¾6, are of type I, of which only ğ¾6 is big, the other two of type II. All 14 labeled vertices are vulnerable, and the other 8 unlabeled vertices are guarded

Full size image
Lemma 7 and Corollary 9 motivate the following definition. We say that a vertex v is vulnerable in graph G if (1) there exists some ğ¾âˆˆîˆ·ğ‘ (ğº) containing v; or (2) there are intersecting maximal cliques ğ¾1âˆˆîˆ·ğ‘ (ğº) and ğ¾2âˆˆîˆ·2(ğº) such that ğ‘£âˆˆğ¾2. A vertex is guarded if it is not vulnerable. Lemma 7 and Corollary 9 can be summarized as: No (non-)edge in a minimum solution can be incident to a guarded vertex. See Fig. 2 for an illustration.

The Kernel
We partition the vertex set of a reduced graph into five parts, and deal with them separately.

(i)
Vertices in small maximal cliques of type I (all of them are vulnerable);

(ii)
Vulnerable vertices in big maximal cliques of type I but not in the previous part;

(iii)
Other vulnerable vertices (not in any maximal cliques of type I);

(iv)
Guarded vertices in (big) maximal cliques of type I; and

(v)
Other guarded vertices (not in any maximal cliques of type I).

Note that for this purpose we do not need to enumerate the maximal cliques. The key observation is that we can easily find the cross edges of all diamonds by enumeration, from which we can identify all vertices and edges in maximal cliques of type I. We use the procedure partition presented in Fig. 3, which computes this partition in three steps: It first finds all vertices in a maximal clique of type I, from which it identifies those in a small maximal clique of type I, and finally it uses them to get all vulnerable vertices.

Fig. 3
figure 3
The procedure partition

Full size image
It is easy to check that procedure partition runs in polynomial time. We now show its correctness.

Lemma 10
Procedure partition is correct.

Proof
An edge ğ‘¢ğ‘£âˆˆğ¸(ğº) is a cross edge if and only if ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) does not induce a clique; this justifies step 1.1. Steps 1.2 and 1.3 follow from Proposition 5(i).

Step 2 considers all vertices in maximal cliques of type I. If some component of G[N(v)] is not a clique, we can find a path xyz of length two. There are two different maximal cliques containing v, x, y and v, y, z respectively. Both are of type I, and hence by Lemma 4(i), at least one of them is small. Step 2.2 also follows from Proposition 5(i). If a vertex v is not marked in step 2, then every maximal clique containing v is either big or of type II. Therefore, all vertices in small maximal cliques of type I have been correctly identified in step 2.

Step 3 finds other vulnerable vertices. By definition, such a vertex is in some maximal clique of type II. If a type-II maximal clique consists of an isolated vertex, it is guarded and not marked in step 3. We may hence consider only nontrivial maximal cliques. All edges in a type-II maximal clique remain unmarked. Note that any two vertices of a type-II maximal clique determines this clique: It is the only maximal clique that contains these two vertices. Vertices in the clique are vulnerable if and only if it contains a vertex marked â€œsmall.â€ We only need to check the clique K once, so we mark them to avoid unnecessary repetition in step 3.3. After step 3, all type-II maximal cliques have been checked, and the algorithm is complete. â—»

Maximal Cliques of Type I
We start from the vertices that are in some small type-I maximal cliques of G; let them be denoted by S(G), i.e., ğ‘†(ğº)=â‹ƒğ¾âˆˆîˆ·ğ‘ (ğº)ğ¾. Noting that the final graph has no small type-I maximal cliques, we can bound the size of S(G) by relating vertices in it to edges in a minimum solution.

Lemma 11
If (G, k) is a reduced yes-instance, then |ğ‘†(ğº)|â‰¤18ğ‘˜3+2ğ‘˜.

Proof
Let ğ¸Â± be a minimum solution of (G, k). Let ğ‘‹=â‹ƒğ‘¥ğ‘¦âˆˆğ¸Â±{ğ‘¥,ğ‘¦} and ğ‘Œ=â‹ƒğ‘¥ğ‘¦âˆˆğ¸Â±ğ‘ğº(ğ‘¥)âˆ©ğ‘ğº(ğ‘¦), i.e., all vertices incident to a (non-)edge in the solution and respectively, all vertices that is a common neighbor of the two ends of a (non-)edge in the solution. Note that |ğ‘‹|â‰¤2ğ‘˜, and by Proposition 3, |ğ‘Œ|â‰¤3ğ‘˜â‹…|ğ¸Â±|â‰¤3ğ‘˜2.

Since

|ğ‘†(ğº)âˆ©(ğ‘‹âˆªğ‘Œ)|â‰¤|ğ‘‹âˆªğ‘Œ|â‰¤3ğ‘˜2+2ğ‘˜,
it suffices to bound ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ). A vertex ğ‘£âˆˆğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ) cannot be contained in two type-I maximal cliques of G if they share more than one vertex: Otherwise, there is a diamond (as in Proposition 5(ii)) in ğ‘ğº[ğ‘£], but then v has to be in ğ‘‹âˆªğ‘Œ, a contradiction.

Let us now consider the set of small type-I maximal cliques of G that contain vertices from ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ), which we denote by îˆ·â€². We argue by contradiction that any pair of cliques in îˆ·â€² shares at most one vertex. Suppose otherwise, there are two maximal cliques ğ¾1,ğ¾2âˆˆîˆ·â€² with |ğ¾1âˆ©ğ¾2|â‰¥2. We have seen that ğ¾1âˆ©ğ¾2 is disjoint from ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ). Now let ğ‘¢âˆˆğ¾1âˆ–ğ¾2 and ğ‘£âˆˆğ¾2âˆ–ğ¾1 be two vertices in ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ). Then there is a diamond with u and two vertices in ğ¾1âˆ©ğ¾2 and one vertex in ğ¾2âˆ–ğ¾1. But by the assumption ğ‘¢âˆ‰ğ‘‹âˆªğ‘Œ, we cannot add or delete any edge incident to u; on the other hand, ğ‘£âˆ‰ğ‘‹âˆªğ‘Œ forbids the deletion of other three edges, a contradiction.

Let ğ‘£âˆˆğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ), and let K be a clique in îˆ·â€² containing v. By definition, there exists a diamond in which (1) v is a degree-two vertex; (2) the two degree-three vertices are in K; and (3) the other degree-two vertex is not in K. Since v is not in ğ‘‹âˆ©ğ‘Œ, one of the two edges of this diamond that are incident to the other degree-two vertex has to be in ğ¸âˆ’. In other words, K contains for some edge ğ‘¥ğ‘¦âˆˆğ¸âˆ’, one in {ğ‘¥,ğ‘¦} and a common neighbor of x, y. By Proposition 3, for each edge ğ‘¥ğ‘¦âˆˆğ¸âˆ’, there are at most 3k vertices in ğ‘ğº(ğ‘¥)âˆ©ğ‘ğº(ğ‘¦); for each ğ‘§âˆˆğ‘ğº(ğ‘¥)âˆ©ğ‘ğº(ğ‘¦), there can be at most one clique in îˆ·â€² containing x, z and at most one clique in îˆ·â€² containing y, z. Therefore, there can be at most 3ğ‘˜â‹…2â‹…|ğ¸âˆ’|â‰¤6ğ‘˜2 cliques in îˆ·â€². By definition, each clique in it is small and has at most 3ğ‘˜+1 vertices, of which at least two are not in ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ). Hence

|ğ‘†(ğº)âˆ–(ğ‘‹âˆªğ‘Œ)|â‰¤(3ğ‘˜âˆ’1)â‹…6ğ‘˜2=18ğ‘˜3âˆ’6ğ‘˜2.
Putting the two parts together, we have |ğ‘†(ğº)|â‰¤18ğ‘˜3+2ğ‘˜. â—»

Next, we consider the big maximal cliques of type I. By Lemma 4(ii), a clique in îˆ·ğ‘(ğº) remains a maximal clique after a minimum solution is applied to G. We bound first the number of big type-I maximal cliques.

Lemma 12
If (G, k) is a reduced yes-instance, then |îˆ·ğ‘(ğº)|â‰¤6ğ‘˜2.

Proof
By Lemma 4, the only way to transform a big maximal clique of type I into one of type II is deleting edges incident to it. For an edge ğ‘’=ğ‘¢ğ‘£âˆˆğ¸âˆ’, denote by îˆ·ğ‘’ the set of big type-I maximal cliques containing one in {ğ‘¢,ğ‘£}, and one vertex in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£). Note that îˆ·ğ‘(ğº)=â‹ƒğ‘’âˆˆğ¸âˆ’îˆ·ğ‘’. By Proposition 3, îˆ·ğ‘’ has at most 6k maximal cliques. Then |îˆ·ğ‘(ğº)|â‰¤6ğ‘˜â‹…|ğ¸âˆ’|=6ğ‘˜2. â—»

To bound the number of vertices in big type-I maximal cliques, it suffices to bound their sizes, for which we introduce another reduction rule.

Rule 3
Let ğ¾âˆˆîˆ·ğ‘(ğº) with |ğ¾|â‰¥3ğ‘˜+3. If K contains a guarded vertex x that does not occur in any other type-I maximal clique of G, delete it.

Lemma 13
Rule 3 is safe: A reduced instance (G, k) is a yes-instance if and only if (ğºâˆ’ğ‘¥,ğ‘˜) is a yes-instance.

Proof
It is easy to see that (ğºâˆ’ğ‘¥,ğ‘˜) is a reduced instance, and every solution of (G, k) confined to ğºâˆ’ğ‘¥ is a solution of (ğºâˆ’ğ‘¥,ğ‘˜). For the â€œifâ€ direction, let ğ¸Â± be a minimum solution of (ğºâˆ’ğ‘¥,ğ‘˜), and let ğºâˆ—=ğºâ–³ğ¸Â±. Note that (ğºâˆ’ğ‘¥)â–³ğ¸Â±=ğºâˆ—âˆ’ğ‘¥, and it is diamond-free. No edge in ğ¸Â± is incident to x, and hence ğ‘ğº(ğ‘¥)=ğ‘ğºâˆ—(ğ‘¥), which we simply denote by N(x). By Proposition 5(ii), it suffices to prove that each maximal clique of ğºâˆ— containing x is of type II. For this purpose, we show that each component of G[N(x)] is either a single vertex or a type-II maximal clique in ğºâˆ—âˆ’ğ‘¥.

Note that ğ¾âˆ–{ğ‘¥} is a big maximal clique in ğºâˆ’ğ‘¥: It is a clique of size at least 3ğ‘˜+2, and its maximality follows from Lemma 4(i). Hence, by Lemma 4(ii), ğ¾âˆ–{ğ‘¥} is a maximal clique (of type II) in ğºâˆ—âˆ’ğ‘¥. Since x is a guarded vertex that does not occur in any other type-I maximal clique, every other maximal clique ğ¾â€² containing x in G is of type II, and it cannot intersect any small type-I maximal clique. Therefore, by Lemma 7, no edge added by ğ¸+ can be incident to any vertex in N(x). From Lemma 8 we can conclude that ğ¾â€²âˆ–{ğ‘¥} either contains only a vertex or is a maximal clique (of type II) in ğºâˆ—âˆ’ğ‘¥.

Since no edge added by ğ¸+ is between two vertices in N(x) and since x is a guarded vertex, each component of G[N(x)] is either ğ¾âˆ–{ğ‘¥} or ğ¾â€²âˆ–{ğ‘¥}, hence is either a single vertex or a type-II maximal clique in ğºâˆ—âˆ’ğ‘¥. This concludes the proof. â—»

Remark that Rule 3 only deletes one vertex and does not change the number k. Hence, after applications of Rule 3, the reduced instance remains reduced.

Lemma 14
Let (G, k) be a reduced yes-instance. If Rule 3 is not applicable, then for each ğ¾âˆˆîˆ·ğ‘(ğº), we have that |ğ¾|=ğ‘‚(ğ‘˜3).

Proof
Without loss of generality, assume that |ğ¾|â‰¥3ğ‘˜+3. Since Rule 3 is not applicable, every vertex in K is either a vulnerable vertex, or a guarded vertex in more than one big type-I maximal clique. Let ğ‘ˆ1 and ğ‘ˆ2 be the set of vulnerable vertices in ğ¾âˆ©ğ‘†(ğº) and ğ¾âˆ–ğ‘†(ğº) respectively. By the definition, each vertex in ğ‘ˆ2 is adjacent to some vertex in ğ‘†(ğº)âˆ–ğ‘ˆ1 by an edge of type-II maximal clique. For each vertex ğ‘£âˆˆğ‘†(ğº)âˆ–ğ‘ˆ1, the cardinality of ğ‘ˆ2âˆ©ğ‘(ğ‘£) is at most one; otherwise, there is a type-I maximal clique containing ğ‘ˆ2âˆ©ğ‘(ğ‘£) and v which by Lemma 4(i) is small, contradicting to ğ‘ˆ2âŠ†ğ¾âˆ–ğ‘†(ğº). Therefore, |ğ‘ˆ2|â‰¤|ğ‘†(ğº)âˆ–ğ‘ˆ1|, and by Lemma 11, K contains at most 18ğ‘˜3+2ğ‘˜ vulnerable vertices. By Lemma 4(i), every pair of big type-I maximal cliques shares at most one vertex. Hence, by Lemma 12, K contains at most 6ğ‘˜2 guarded vertices that appear in some other big maximal cliques of type I. Putting them together we get |ğ¾|â‰¤18ğ‘˜3+2ğ‘˜+6ğ‘˜2. â—»

The next corollary follows immediately from Lemmas 12 and 14 .

Corollary 15
Let (G, k) be a reduced yes-instance. If Rule 3 is not applicable, then the number of vertices that are contained in some cliques in îˆ·ğ‘(ğº) is ğ‘‚(ğ‘˜5).

Maximal Cliques of Type II
We have bounded the number of vertices in all maximal cliques of type I, and it remains to bound the number of vertices that occur only in maximal cliques of type II. Let T(G) denote these vertices, i.e., ğ‘‡(ğº)=ğ‘‰(ğº)âˆ–â‹ƒğ¾âˆˆîˆ·ğ‘ (ğº)âˆªîˆ·ğ‘(ğº)ğ¾. It may not be surprising that we can delete all the guarded vertices in them.

Rule 4
If there is a guarded vertex x not in any type-I maximal clique of G, delete it.

Lemma 16
Rule 4 is safe: A reduced instance (G, k) is a yes-instance if and only if (ğºâˆ’ğ‘¥,ğ‘˜) is a yes-instance.

Proof
It is easy to see that (ğºâˆ’ğ‘¥,ğ‘˜) is a reduced instance, and every solution of (G, k) confined to ğºâˆ’ğ‘¥ is a solution of (ğºâˆ’ğ‘¥,ğ‘˜). For the other direction, let ğ¸Â± be a minimum solution of (ğºâˆ’ğ‘¥,ğ‘˜), and it is sufficient to show that x is not part of any diamond in ğºâˆ—=ğºâ–³ğ¸Â±. Note that x is a vertex which is part of only type-II maximal cliques in G and not adjacent to any vertex in small type-I maximal cliques in G. Therefore, by Lemma 7, none of the vertices in N(x) is incident to any edges of ğ¸+. If x is part of a diamond in ğºâˆ—, then it is formed by a deletion of an edge in G[N[x]] by ğ¸âˆ’. But this is not possible by Corollary 9, as none of the edges in G[N[x]] is part of any type-II maximal clique which intersects with a small type-I maximal clique in ğºâˆ’ğ‘¥. â—»

If Rule 4 is not applicable, then all vertices in T(G) are vulnerable. As demonstrated in Fig. 2, an edge may be deleted from a maximal clique of type II. In that example, neither end of the deleted edge ğ‘£0ğ‘£1 is in any maximal clique of type I. This can happen only after some modification happens in the neighborhood of this vertexâ€”ğ‘¢2ğ‘£2 added in the example. Indeed, we may consider the added/deleted edges stepwise, then there is an order such that each edge is added/deleted only if it is in some diamond. One modification may introduce new diamond(s) not in the original graph. For example, neither ğ‘£0ğ‘£1 nor ğ‘¢1ğ‘£2 is in a diamond of G, but the addition of ğ‘¢2ğ‘£2 jeopardizes ğ‘¢1ğ‘£2, whose deletion consequently brings ğ‘£0ğ‘£1 down.

This example is actually exemplary: The only way to bring an edge in a maximal clique K of type II to a diamond is through adding edge(s) between K and other vertices. According to Proposition 2, however, this would not happen when |ğ¾|â‰¥ğ‘˜+3. In other words, to make sure a large clique in îˆ·2(ğº) is immutable to future modifications, it suffices to keep ğ‘˜+3 of its vertices. This motivates the following reduction rule, whose statement is however more complex than previous ones. The main trouble here is that we are not allowed to delete all but ğ‘˜+3 guarded vertices from a clique in îˆ·2(ğº), because it may be required for another clique in îˆ·2(ğº).

For a pair of vertices u, v, we denote by N(u, v) the set of common neighbors of u and v not in S(G), i.e., ğ‘(ğ‘¢,ğ‘£)=(ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£))âˆ–ğ‘†(ğº).

Proposition 17
Let u, v be two vertices in G. If ğ‘¢ğ‘£âˆ‰ğ¸(ğº), then N(u, v) form an independent set. Moreover, if ğ‘¢ğ‘£âˆˆğ¸+ for a solution ğ¸Â± of (G, k), then |ğ‘(ğ‘¢,ğ‘£)|â‰¤ğ‘˜.

Proof
If G[N(u, v)] has an edge, say xy, then {ğ‘¢,ğ‘£,ğ‘¥,ğ‘¦} forms a diamond. There are two type-I maximal cliques containing {ğ‘¥,ğ‘¦,ğ‘¢} and {ğ‘¥,ğ‘¦,ğ‘£} respectively. By Lemma 4(i), at least one of them is small, contradicting to ğ‘¥,ğ‘¦âˆ‰ğ‘†(ğº). The second claim follows from Proposition 2. â—»

Our last rule would keep at most ğ‘˜+1 from such sets. To avoid unnecessary clutters, we simply say we mark ğ‘˜+1 vertices in N(u, v), even if its size is smaller than ğ‘˜+1; in which case, we mark all of them.

Rule 5
For each pair of vertices ğ‘¢,ğ‘£âˆˆğ‘†(ğº), arbitrarily mark ğ‘˜+1 vertices in N(u, v). If |ğ‘(ğ‘¢,ğ‘£)|â‰¤ğ‘˜, then for each vertex ğ‘¤âˆˆğ‘(ğ‘¢,ğ‘£), arbitrarily mark ğ‘˜+1 vertices in N(u, w) and ğ‘˜+1 vertices in N(v, w). If there is an unmarked vertex x in T(G), delete it.

Lemma 18
Rule 5 is safe: A reduced instance (G, k) is a yes-instance if and only if (ğºâˆ’ğ‘¥,ğ‘˜) is a yes-instance.

Proof
It is easy to see that (ğºâˆ’ğ‘¥,ğ‘˜) is a reduced instance, and every solution of (G, k) confined to ğºâˆ’ğ‘¥ is a solution of (ğºâˆ’ğ‘¥,ğ‘˜). For the â€œifâ€ direction, let ğ¸Â± be a minimum solution of (ğºâˆ’ğ‘¥,ğ‘˜), and let ğºâˆ—=ğºâ–³ğ¸Â±. We show that each maximal clique of ğºâˆ— containing x is a maximal clique of G and is of type II in ğºâˆ—. Since Proposition 5(ii) implies that deleting a vertex not in any type-I maximal clique does not alter type-I maximal cliques, we have ğ‘†(ğºâ€²)=ğ‘†(ğº).

Let K be a maximal clique of G containing x; note that K is a maximal clique of type II in G, as ğ‘¥âˆˆğ‘‡(ğº). We argue that |ğ‘ğºâˆ—(ğ‘¦)âˆ©ğ¾|â‰¤1 for every ğ‘¦âˆˆğ‘‰(ğº)âˆ–ğ¾. Since K is a maximal clique of type II in G, we have (1) |ğ‘ğº(ğ‘¦)âˆ©ğ¾| is either 0 or 1; and (2) for every pair of vertices ğ‘¢,ğ‘£âˆˆğ¾,

ğ‘(ğ‘¢,ğ‘£)âŠ†ğ‘ğº(ğ‘¢)âˆ©ğ‘ğº(ğ‘£)=ğ¾.
Suppose first that there are at least two edges between y and K in ğ¸+. Let ğ‘¢,ğ‘£âˆˆğ¾ be two vertices such that ğ‘¦ğ‘¢,ğ‘¦ğ‘£âˆˆğ¸+. Then by Lemma 7, ğ‘¢,ğ‘£âˆˆğ‘†(ğºâ€²), and hence ğ‘¢,ğ‘£âˆˆğ‘†(ğº). Clearly, ğ‘¥â‰ ğ‘¢, ğ‘¥â‰ ğ‘£ and x is an unmarked vertex in N(u, v). Further, there are ğ‘˜+1 marked vertices in N(u, v). It follows that |ğ¾âˆ–{ğ‘¥}|â‰¥ğ‘˜+3, and ğ¸âˆ’ does not have any edge in ğºâ€²[ğ¾âˆ–{ğ‘¥}] by Proposition 2(i). Therefore, for each marked vertex ğ‘§âˆˆğ‘(ğ‘¢,ğ‘£) that is not adjacent to y, the set {ğ‘¢,ğ‘£,ğ‘¦,ğ‘§} induces a diamond in ğºâ€²+{ğ‘¦ğ‘¢,ğ‘¦ğ‘£}. The only edge we can edit is yz, but |ğ‘ğº(ğ‘¦)âˆ©ğ¾|â‰¤1, and there are at least ğ‘˜+2 edges between y and K, which is impossible.

Hence, at most one edge can be added between y and K by ğ¸+. If |ğ‘ğº(ğ‘¦)âˆ©ğ¾|=0, or |ğ‘ğº(ğ‘¦)âˆ©ğ¾|=1 but the only edge between y and K is deleted, then it is trivial that y is adjacent to at most one vertex of K in ğºâˆ—. Suppose that ğ‘ğºâˆ—(ğ‘¦)âˆ©ğ¾={ğ‘¢,ğ‘£} while only u is in ğ‘ğº(ğ‘¦); note that ğ‘¦ğ‘¢âˆ‰ğ¸âˆ’ and ğ‘¦ğ‘£âˆˆğ¸+. By Lemma 7, ğ‘¦,ğ‘£âˆˆğ‘†(ğºâ€²), and hence in S(G). According to Proposition 17, there are at most k vertices in N(v, y) in ğºâ€². If ğ‘¢âˆ‰ğ‘†(ğº), then it has been marked; hence ğ‘¥â‰ ğ‘¢. Also, ğ‘¥â‰ ğ‘£ as ğ‘¥âˆˆğ‘‡(ğº). By the rule, no matter whether u is in S(G) or not, we should have marked vertices in N(u, v). Since ğ‘¥âˆˆğ‘(ğ‘¢,ğ‘£) but is not marked, we have |ğ‘(ğ‘¢,ğ‘£)|>ğ‘˜+1. Let z be any marked vertex in N(u, v); it is not in ğ‘ğº(ğ‘¦) by assumption. But then {ğ‘¢,ğ‘£,ğ‘¦,ğ‘§} induces a diamond in ğºâ€²+ğ‘¦ğ‘£, in which we have to add the missing edge yz, which requires |ğ¸+|>ğ‘˜, a contradiction.

We have thus concluded |ğ‘ğºâˆ—(ğ‘¦)âˆ©ğ¾|â‰¤1 for each vertex y in ğ‘‰(ğº)âˆ–ğ¾. By Proposition 6, ğ¾âˆ–{ğ‘¥} remains a clique in ğºâˆ—âˆ’ğ‘¥, otherwise we can find a strictly smaller solution. Then K is a maximal clique of type II in ğºâˆ—. On the other hand, according to Proposition 17, no edge is added between two vertices of ğ‘ğº(ğ‘¥). Therefore, N(x) induces exactly the same subgraph in G and ğºâˆ—. Hence, any maximal clique of ğºâˆ— containing x is a maximal clique of G as well, hence of type II in ğºâˆ—. This concludes the proof of the lemma. â—»

Now Theorem 1 follows by counting numbers of different kinds of vertices.

Proof of Theorem 1
We show first that Rules 3â€“5 can be applied in polynomial time. For a guarded vertex x, N(x) induces a cluster graph and each maximal clique in the cluster graph together with x forms the maximal cliques of G containing x. Recall that a maximal clique is of type I if and only if it contains both ends of a cross edge. Since the procedure partition finds all guarded vertices (no mark) and cross edges, we can find for each guarded vertex all type-I maximal cliques and type-II maximal cliques containing it in polynomial time. Therefore, both Rules 3 and Rule 4 can be applied in polynomial time. Moreover, the procedure partition finds all vertices in S(G) (mark â€œsmallâ€) and T(G) (no mark â€œtype Iâ€), and hence Rule 5 can be applied in polynomial time.

We claim that if none of Rules 3â€“5 is applicable to a reduced yes-instance (G, k), then |ğ‘‰(ğº)|=ğ‘‚(ğ‘˜8). By Lemma 11, the number of vertices in small type-I maximal cliques is |ğ‘†(ğº)|=ğ‘‚(ğ‘˜3). By Corollary 15, we have ğ‘‚(ğ‘˜5) vertices in big type-I maximal cliques. For each pair of vertices u, v in S(G), we mark at most ğ‘˜+1 common neighbors of them. And for each common neighbor w of u, v, we mark at most 2ğ‘˜+2 vertices: ğ‘˜+1 vertices in N(u, w) and ğ‘˜+1 vertices in N(v, w). Hence |ğ‘‡(ğº)|=ğ‘‚(ğ‘˜8), and |ğ‘‰(ğº)|=ğ‘‚(ğ‘˜3)+ğ‘‚(ğ‘˜5)+ğ‘‚(ğ‘˜8)=ğ‘‚(ğ‘˜8). â—»

A Cubic Kernel for Diamond-Free Edge Deletion
We now present a cubic-vertex kernel for the diamond-free edge deletion problem. Note that if ğºâˆ’ğ¸âˆ’ is diamond-free, then ğ¸âˆ’ can be viewed as a solution to the diamond-free editing problem as well, where ğ¸+=âˆ…. Therefore, most statements, except those on minimum solutions, also hold for ğ¸âˆ’. We will need Rule 2 from page 5; for the sake of completeness, we include it here.

Rule 1
If there exist an edge uv and 2ğ‘˜+2 distinct vertices ğ‘¥1,ğ‘¦1,â€¦,ğ‘¥ğ‘˜+1,ğ‘¦ğ‘˜+1 in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) such that ğ‘¥ğ‘–ğ‘¦ğ‘–âˆ‰ğ¸(ğº) for all 1â‰¤ğ‘–â‰¤ğ‘˜+1, then delete uv and decrease k by one.

The correctness of the following rule is also straightforward.

Rule 2
Mark an edge uv â€œpermanentâ€ if there are 2ğ‘˜+2 distinct vertices ğ‘¥1,ğ‘¦1,â€¦,ğ‘¥ğ‘˜+1,ğ‘¦ğ‘˜+1 in ğ‘(ğ‘¢)âˆ©ğ‘(ğ‘£) such that ğ‘¥ğ‘–ğ‘¦ğ‘–âˆˆğ¸(ğº) for all 1â‰¤ğ‘–â‰¤ğ‘˜+1. If there exists a diamond consisting of only permanent edges, return a trivial no-instance.

An instance of the diamond-free edge deletion problem is reduced if neither Rule 1 nor 2 is applicable. Henceforth we are concerned exclusively with reduced instances.

Proposition 19
Two big maximal cliques of a reduced instance (G, k) share at most one vertex.

Proof
Each edge in a maximal clique would be marked permanent by Rule 2. Therefore, if two big maximal cliques share more than one vertex, there is a diamond in them, consisting of only permanent edges. â—»

Rule 3
If there is a vertex x not in any small maximal clique, delete it.

Lemma 20
Rule 3 is safe: A reduced instance (G, k) is a yes-instance if and only if (ğºâˆ’ğ‘¥,ğ‘˜) is a yes-instance.

Proof
Let ğ¸âˆ’ be a minimum solution of (ğºâˆ’ğ‘¥,ğ‘˜). We show that ğºâˆ—=ğºâˆ’ğ¸âˆ’ is also diamond-free. Suppose for contradiction that there are maximal cliques ğ¾1 and ğ¾2 in ğºâˆ— such that |ğ¾1âˆ©ğ¾2|â‰¥2. At least one of them contains x; assume without loss of generality ğ‘¥âˆˆğ¾1. Let K be a maximal clique of G containing ğ¾1. By the assumption (x is not in any small maximal clique), K is big. By Proposition 2(i), no edge in the clique ğ¾âˆ–{ğ‘¥} can be deleted by ğ¸âˆ’. Hence ğ¾=ğ¾1 and ğ¾2âŠˆğ¾. By Proposition 19, ğ¾2 is small, and ğ‘¥âˆ‰ğ¾2. We can find a pair of nonadjacent vertices ğ‘¥â€²âˆˆğ¾âˆ–{{ğ‘¥}âˆªğ¾2} and ğ‘¦âˆˆğ¾2âˆ–ğ¾. If no such pair of vertices exists, then ğ¾2 contains all vertices in ğ¾âˆ–{ğ‘¥} and is big, a contradiction. Let u, v be two vertices in ğ¾âˆ©ğ¾2. Then {ğ‘¥â€²,ğ‘¢,ğ‘£,ğ‘¦} induces a diamond in ğºâˆ’ğ‘¥ and one of uy, vy has to be deleted by ğ¸âˆ’, contradicting that ğ¾2 is a maximal clique of ğºâˆ—. This concludes the proof of this lemma. â—»

Again, given any minimal solution ğ¸âˆ’, we can view the edges as deleted in a sequence, such that each edge is in a diamond when it is deleted. Likewise to Lemma 8, a type-II maximal clique would remain so during the course. If a vertex is not in any type-I maximal clique of G, then no edge incident to it will be deleted. These vertices and edges are thus irrelevant to the problem; we can actually delete them from the graph.

Rule 4
Delete all edges and vertices not in any maximal clique of type I.

Lemma 21
Rule 4 is safe.

Proof
Let ğºâ€² be the graph obtained by deleting all edges in type-II maximal cliques. Note that a vertex is not in any type-I maximal clique of G if and only if it is isolated in ğºâ€². Therefore, to show the safeness of Rule 4, it suffices to prove that (G, k) is a yes-instance if and only if (ğºâ€²,ğ‘˜) is a yes-instance. Note that we do not require that (G, k) is reduced.

Let ğ¸âˆ’ be a minimum solution of (G, k), and let ğ¸â€²âˆ’=ğ¸âˆ’âˆ©ğ¸(ğºâ€²). We claim that ğºâ€²âˆ’ğ¸â€²âˆ’ is diamond-free. Suppose for contradiction that ğºâ€²âˆ’ğ¸â€²âˆ’ contains a diamond on {ğ‘¥,ğ‘¢,ğ‘£,ğ‘¦} with cross edge uv. Then ğ‘¥ğ‘¦âˆˆğ¸(ğº)âˆ–ğ¸(ğºâ€²), and {ğ‘¥,ğ‘¢,ğ‘£,ğ‘¦} is a clique in ğºâˆ’ğ¸âˆ’, also in G. The edge xy is not in any type-I maximal clique of G, and hence {ğ‘¥,ğ‘¢,ğ‘£,ğ‘¦} is part of a type-II maximal clique of G. Hence all edges of this diamond are in ğ¸(ğº)âˆ–ğ¸(ğºâ€²), a contradiction.

For the other direction, let ğ¸â€²âˆ’ be a minimum solution of (ğºâ€²,ğ‘˜). We claim that ğºâˆ’ğ¸â€²âˆ’ is diamond-free. Suppose for contradiction that ğºâˆ’ğ¸â€²âˆ’ contains a diamond on {ğ‘¥,ğ‘¢,ğ‘£,ğ‘¦} with cross edge uv. Then at least one of the five edges of the diamond, i.e., {ğ‘¢ğ‘¥,ğ‘£ğ‘¥,ğ‘¢ğ‘£,ğ‘¢ğ‘¦,ğ‘£ğ‘¦}, is in ğ¸(ğº)âˆ–ğ¸(ğºâ€²). Assume without loss of generality that one edge in the triangle on {ğ‘¢,ğ‘£,ğ‘¥} belongs to ğ¸(ğº)âˆ–ğ¸(ğºâ€²). Then the maximal clique K of G containing u, v, x is of type II. Now y is adjacent to at least two vertices of K in G, hence y must be in K as well. But then xy would be in ğ¸(ğº)âˆ–ğ¸(ğºâ€²), and hence not in ğ¸â€²âˆ’; in other words, xy is an edge in ğºâˆ’ğ¸â€²âˆ’, a contradiction. This concludes the proof. â—»

It is clear that all the four rules can be applied in polynomial time. Indeed, a simplified version of procedure partition would suffice.

Lemma 22
Let (G, k) be a yes-instance of the diamond-free edge deletion problem. If none of Rules 1â€“4 is applicable, then |ğ‘‰(ğº)|=ğ‘‚(ğ‘˜3).

Proof
We claim that if neither Rule 3 nor 4 is applicable to a reduced yes-instance (G, k), then |ğ‘‰(ğº)|=ğ‘‚(ğ‘˜3). By Lemma 11, there are at most ğ‘‚(ğ‘˜3) vertices in small type-I maximal cliques in G. After the exhaustive application of Rule 3 and 4 , every vertex is in some small type-I maximal clique. Therefore, graph G contains ğ‘‚(ğ‘˜3) vertices. â—»