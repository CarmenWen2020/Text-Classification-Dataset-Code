Given a graph G, we define ğ›ğœğ (ğº) as the minimum k for which G can be contracted to the uniformly triangulated grid Î“ğ‘˜. A graph class îˆ³ has the SQGC property if every graph ğºâˆˆîˆ³ has treewidth îˆ»(ğ›ğœğ (ğº)ğ‘) for some 1â‰¤ğ‘<2. The SQGC property is important for algorithm design as it defines the applicability horizon of a series of meta-algorithmic results, in the framework of bidimensionality theory, related to fast parameterized algorithms, kernelization, and approximation schemes. These results apply to a wide family of problems, namely problems that are contraction-bidimensional. Our main combinatorial result reveals a wide family of graph classes that satisfy the SQGC property. This family includes, in particular, bounded-degree string graphs. This considerably extends the applicability of bidimensionality theory for contraction bidimensional problems.

Access provided by University of Auckland Library

Introduction
Treewidth is one of most well-studied parameters in graph algorithms. It serves as a measure of how close a graph is to the topological structure of a tree (see Sect. 2 for the formal definition). Gavril is the first to introduce the concept in [30] but it obtained its name in the second paper of the Graph Minors series of Robertson and Seymour in [38]. Treewidth has extensively used in graph algorithm design due to the fact that a wide class of intractable problems in graphs becomes tractable when restricted on graphs of bounded treewidth [1, 5, 6]. Before we present some key combinatorial properties of treewidth, we need some definitions.

Graph contractions and minors. Our first aim is to define two parameterized versions of the contraction relation on graphs.

Definition 1
(Contractions) Given a non-negative integer c, two graphs H and G, and a surjection ğœ:ğ‘‰(ğº)â†’ğ‘‰(ğ») we write ğ»â‰¤ğ‘ğœğº if

for every ğ‘¥âˆˆğ‘‰(ğ»), the graph ğº[ğœâˆ’1(ğ‘¥)] is a non-empty graph (i.e., a graph with at least one vertex) of diameter at most c and

for every ğ‘¥,ğ‘¦âˆˆğ‘‰(ğ»), {ğ‘¥,ğ‘¦}âˆˆğ¸(ğ»)âŸºğº[ğœâˆ’1(ğ‘¥)âˆªğœâˆ’1(ğ‘¦)] is connected.

We say that H is a c-diameter contraction of G if there exists a surjection ğœ:ğ‘‰(ğº)â†’ğ‘‰(ğ») such that ğ»â‰¤ğ‘ğœğº and we write this ğ»â‰¤ğ‘ğº. Moreover, if ğœ is such that for every ğ‘¥âˆˆğ‘‰(ğ»), |ğœâˆ’1(ğ‘¥)|â‰¤ğ‘â€², then we say that H is a ğ‘â€²-size contraction of G, and we write ğ»â‰¤(ğ‘â€²)ğº. Given two graphs G and H, if there exists an integer c such that ğ»â‰¤ğ‘ğº, then we say that H is a contraction of G, and we write ğ»â‰¤ğº. Moreover, if there exists a subgraph ğºâ€² of G such that ğ»â‰¤ğºâ€², we say that H is a minor of G and we write this ğ»âª¯ğº. Given a graph H, we denote by ğ–¾ğ—‘ğ–¼ğ—…(ğ») the class of graphs that exclude H as a minor.

Combinatorics of Treewidth
One of the most celebrated structural results on treewidth is the following:

Proposition 2
There is a function ğ‘“:â„•â†’â„• such that every graph excluding a (ğ‘˜Ã—ğ‘˜)-grid as a minor has treewidth at most f(k).

A proof of Proposition 2 appeared for the first time by Robertson and Seymour in [39]. Other proofs, with better bounds to the function f, appeared in [40] and later in [17] (see also [33, 35]). Currently, the best bound for f is due to Chuzhoy, who recently proved in [4] that ğ‘“(ğ‘˜)=ğ‘˜9â‹…logîˆ»(1)ğ‘˜. On the other hand, it is possible to show that Proposition 2 is not correct when ğ‘“(ğ‘˜)=îˆ»(ğ‘˜2â‹…logğ‘˜) (see [43]).

The potential of Proposition 2 on graph algorithms has been capitalized by the theory of bidimensionality that was introduced in [10] and has been further developed in [9, 13, 14, 16, 21,22,23, 26, 29, 32]. This theory offered general techniques for designing efficient fixed-parameter algorithms and approximation schemes for NP-hard graph problems in broad classes of graphs (see [8, 11, 12, 15, 20]). In order to present the result of this paper we first give a brief presentation of this theory and of its applicability.

Optimization parameters and bidimensionality. A graph parameter is a function ğ© mapping graphs to non-negative integers. We say that p is a minimization graph parameter if ğ©(ğº)=min{ğ‘˜âˆ£âˆƒğ‘†âŠ†ğ‘‰(ğº):|ğ‘†|â‰¤ğ‘˜ and ğœ™(ğº,ğ‘†)=ğšğš›ğšğš}, where ğœ™ is a some predicate on G and S. Similarly, we say that p is a maximization graph parameter if in the above definition we we replace min and â‰¤ by max and â‰¥ respectivelly. Minimization or maximization parameters are briefly called optimization parameters.

Definition 3
(Bidimensionality) Given two real functions f and g, we use the term ğ‘“â‰³ğ‘” to denote that ğ‘“(ğ‘¥)â‰¥ğ‘”(ğ‘¥)âˆ’ğ‘œ(ğ‘”(ğ‘¥)). A graph parameter p is minor-closed (resp. contraction-closed) when ğ»âª¯ğºâ‡’ğ©(ğ»)â‰¤ğ©(ğº) (resp. ğ»â‰¤ğºâ‡’ğ©(ğ»)â‰¤ğ©(ğº)). We can now give the two following definitions:

p is minor-bidimensional if          p is contraction-bidimensional if

âˆ™ ğ© is minor-closed, and          âˆ™ ğ© is contraction-closed,

âˆ™ ğ©(âŠğ‘˜)â‰³ğ›¿â‹…ğ‘˜2.          âˆ™ ğ©(Î“ğ‘˜)â‰³ğ›¿â‹…ğ‘˜2.

for some ğ›¿>0. In the above definitions, we use âŠğ‘˜ for the (ğ‘˜Ã—ğ‘˜)-grid and Î“ğ‘˜ for the uniformly triangulated (ğ‘˜Ã—ğ‘˜)-grid (see Fig. 1). If ğ© is a minimization (resp. maximization) graph parameter, we denote by Î ğ© the problem that, given a graph G and a non-negative integer k, asks whether ğ©(ğº)â‰¤ğ‘˜ (resp. ğ©(ğº)â‰¥ğ‘˜). We say that a problem is minor/contraction-bidimensional if it is Î ğ© for some bidimensional optimization parameter ğ©.

Fig. 1
figure 1
The graph Î“9

Full size image
A (non exhaustive) list of minor-bidimensional problems is: VERTEX COVER, FEEDBACK VERTEX SET, LONGEST CYCLE, LONGEST PATH, CYCLE PACKING, PATH PACKING, DIAMOND HITTING SET, MINIMUM MAXIMAL MATCHING, FACE COVER, and MAX BOUNDED DEGREE CONNECTED SUBGRAPH. Some problems that are contraction-bidimensional (but not minor-bidimensional) are CONNECTED VERTEX COVER , DOMINATING SET , CONNECTED DOMINATING SET , CONNECTED FEEDBACK VERTEX SET , INDUCED MATCHING , INDUCED CYCLE PACKING , CYCLE DOMINATION , CONNECTED CYCLE DOMINATION , d -SCATTERED SET , INDUCED PATH PACKING , r -CENTER , CONNECTED r -CENTER , CONNECTED DIAMOND HITTING SET , UNWEIGHTED TSP TOUR (see [14, 20, 44]).

Subquadratic grid minor/contraction property. In order to present the meta-algorithmic potential of bidimensionality theory we need to define some property on graph classes that defines the horizon of its applicability.

Definition 4
(SQGC and SQGC) Let îˆ³ be a graph class. We say that îˆ³ has the subquadratic grid minor property (SQGM property for short) if there exist a constant 1â‰¤ğ‘<2 such that every graph ğºâˆˆîˆ³ which excludes âŠğ‘¡ as a minor, for some integer t, has treewidth îˆ»(ğ‘¡ğ‘). In other words, this property holds for îˆ³ if Proposition 2 can be proven for a sub-quadratic f on the graphs of îˆ³.

Similarly, we say that îˆ³ has the subquadratic grid contraction property (SQGC property for short) if there exist a constant 1â‰¤ğ‘<2 such that every graph ğºâˆˆîˆ³ which excludes Î“ğ‘¡ as a contraction, for some integer t, has treewidth îˆ»(ğ‘¡ğ‘). For brevity we say that îˆ³âˆˆğš‚ğš€ğ™¶ğŒ(ğ‘) (resp. îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘)) if îˆ³ has the SQGM (resp SQGC) property for c. Notice that ğš‚ğš€ğ™¶ğ‚(ğ‘)âŠ†ğš‚ğš€ğ™¶ğŒ(ğ‘) for every 1â‰¤ğ‘<2.

Algorithmic Implications
The meta-algorithmic consequences of bidimensionality theory are summarised as follows. Let îˆ³âˆˆğš‚ğš€ğ™¶ğŒ(ğ‘), for 1â‰¤ğ‘<2, and let p be a minor-bidimensional-optimization parameter.

[A]:
As it was observed in [10], the problem Î ğ© can be solved in 2ğ‘œ(ğ‘˜)â‹…ğ‘›îˆ»(1) steps on îˆ³, given that the computation of ğ© can be done in 2îˆ»(ğ­ğ°(ğº))â‹…ğ‘›îˆ»(1) steps (here ğ­ğ°(ğº) is the treewidth of the input graph G). This last condition can be implied by a purely meta-algorithmic condition that is based on some variant of Modal Logic [37]. There is a wealth of results that yield the last condition for various optimization problems either in classes satisfying the SQGM propety [18, 18, 19, 41, 42] or to general graphs [3, 7, 24].

[B]:
As it was shown in [26] (see also [27]), when the predicate ğœ™ can be expressed in Counting Monadic Second Order Logic (CMSOL) and ğ© satisfies some additional combinatorial property called separability, then the problem Î ğ© admits a linear kernel, that is a polynomial-time algorithm that transforms (G, k) to an equivalent instance (ğºâ€²,ğ‘˜â€²) of Î ğ© where ğºâ€² has size îˆ»(ğ‘˜) and ğ‘˜â€²â‰¤ğ‘˜.

[C]:
It was proved in [22] (see also [25] and [28]), that the problem of computing ğ©(ğº) for ğºâˆˆîˆ³ admits a Efficient Polynomial Approximation Scheme (EPTAS) â€” that is an ğœ–-approximation algorithm running in ğ‘“(1ğœ–)â‹…ğ‘›îˆ»(1) steps â€” given that îˆ³ is hereditary and ğ© satisfies the separability property and some reducibility property (related to CMSOL expresibility).

Fig. 2
figure 2
The applicability of bidimensionality theory. The green lines correspond the consequences [32] while the red lines correspond to the result of this paper (Color figure online)

Full size image
All above results have their counterparts for contraction-bidimensional problems with the difference that one should instead demand that îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘). Clearly, the applicability of all above results is delimited by the SQGM/SQGC property. This is schematically depicted in Fig. 2, where the green triangles triangles indicate the applicability of minor-bidimensionality and the red triangle indicate the applicability of contraction-bidimensionality. The aforementioned Î©(ğ‘˜2â‹…logğ‘˜) lower bound to the function f of Proposition 2, indicates that ğš‚ğš€ğ™¶ğŒ(ğ‘) does not contain all graphs (given that ğ‘<2).

As an example we mention the well known d-Domination Set problem (for some ğ‘‘â‰¥1), asking whether a graph G has a set S of at most k vertices such that every vertex in G is within distance at most d from some vertex of S. d-Domination Set is contraction bidimensional problem that satisfies the additional meta-algorithmic conditions in [A], [B], and [C]. This implies that it can be solved in 2ğ‘‚(ğ‘˜âˆš)â‹…ğ‘› time, it admits a linear kernel, and its optimization version admits an EPTAS on every graph class that has the SQGC property.

The emerging direction of research is to detect the most general classes in ğš‚ğš€ğ™¶ğŒ(ğ‘) and ğš‚ğš€ğ™¶ğ‚(ğ‘). Concerning the SQGM property, the following result was proven in [15].

Proposition 5
For every graph H, ğ–¾ğ—‘ğ–¼ğ—…(ğ»)âˆˆğš‚ğš€ğ™¶ğŒ(1).

A graph H is an apex graph if it contains a vertex whose removal from H results to a planar graph. For the SQGC property, the following counterpart of Proposition 5 was proven in [21].

Proposition 6
For every apex graph H, ğ–¾ğ—‘ğ–¼ğ—…(ğ»)âˆˆğš‚ğš€ğ™¶ğ‚(1).

Notice that both above results concern graph classes that are defined by excluding some graph as a minor. For such graphs, Proposition 6 is indeed optimal. To see this, consider ğ¾â„-minor free graphs where â„â‰¥6 (these graphs are not apex graphs). Such classes do not satisfy the SQGC property: take Î“ğ‘˜, add a new vertex, and make it adjacent, with all its vertices. The resulting graph excludes Î“ğ‘˜ as a contraction and has treewidth >ğ‘˜.

String Graphs
An important step extending the applicability of bidimensionality theory further than H-minor free graphs, was done in [23] (see also [25]).

Definition 7
(String graphs, map graphs, and unit disk graphs) Unit disk graphs are intersections graphs of unit disks in the plane and map graphs are intersection graphs of face boundaries of planar graph embeddings. We denote by î‰ğ‘‘ the set of unit disk graphs (resp. of îˆ¹ğ‘‘ map graphs) of maximum degree d.

The following was proved in [23, 25].

Proposition 8
For every positive integer d, î‰ğ‘‘âˆˆğš‚ğš€ğ™¶ğŒ(1) and îˆ¹ğ‘‘âˆˆğš‚ğš€ğ™¶ğŒ(1).

Proposition 8 was further extended for intersection graphs of more general geometric objects (in 2 dimensions) in [32]. To explain the results of [32] we need to define a more general model of intersection graphs.

Definition 9
(String graphs) Let îˆ¸={ğ¿1,â€¦,ğ¿ğ‘˜} be a collection of lines in the plane. We say that îˆ¸ is normal if there is no point belonging to more than two lines. The intersection graph ğºîˆ¸ of îˆ¸, is the graph whose vertex set is îˆ¸ and where, for each i, j where 1â‰¤ğ‘–<ğ‘—â‰¤ğ‘˜, the edge {ğ¿ğ‘–,ğ¿ğ‘—} has multiplicity |ğ¿1âˆ©ğ¿2|. We denote by îˆ¿ğ‘‘ the set containing every graph ğºîˆ¸ where îˆ¸ is a normal collection of lines in the plane and where each vertex of ğºîˆ¸ has edge-degree at most d. i.e., is incident to at most d edges. We call îˆ¿ğ‘‘ string graphs with edge-degree bounded by d.

It is easy to observe that î‰ğ‘‘âˆªîˆ¹ğ‘‘âŠ†îˆ¿ğ‘“(ğ‘‘) for some quadratic function f. Indeed, given a graph G in î‰ğ‘‘, for each unit disk of its representation in the plane, we can create a string that corresponds to the perimeter of the disk. As all the disks are of the same size, the intersection graph of the strings is homeomorphic to G. The same applies for map graphs by considering the boundaries of the faces and creating a string for each of them. Moreover, apart from the classes considered in [23], îˆ¿ğ‘‘ includes a much wider variety of classes of intersection graphs [32]. As an example, consider îˆ¯ğ‘‘,ğ›¼ as the class of all graphs that are intersection graphs of ğ›¼-convex bodiesFootnote1 in the plane and have edge-degree at most d. In [32], it was proven that îˆ¯ğ‘‘,ğ›¼âŠ†îˆ¿ğ‘ where c depends (polynomially) on d and ğ›¼. Another interesting class from [32] is îˆ²ğ»,ğ›¼ containing all H-subgraph free intersection graphs of ğ›¼-fatFootnote2 families of convex bodies. Notice î‰ğ‘‘ can be seen as a special case of both îˆ¯ğ‘‘,ğ›¼ and îˆ²ğ»,ğ›¼. (See [36] for other examples of classes included in îˆ¿ğ‘‘.)

Fig. 3
figure 3
A graphical representation of the definition of îˆ³(ğ‘1,ğ‘2)

Full size image
Our Contribution
Graph class extensions.

Definition 10
((ğ‘1,ğ‘2)-extension) Given a class of graph îˆ³ and two integers ğ‘1 and ğ‘2, we define the (ğ‘1,ğ‘2)-extension of îˆ³, denoted by îˆ³(ğ‘1,ğ‘2), as the set containing every graph H such that there exist a graph ğºâˆˆîˆ³ and a graph J that satisfy ğºâ‰¤(ğ‘1)ğ½ and ğ»â‰¤ğ‘2ğ½ (see Fig. 3 for a visualization of this construction). Keep in mind that îˆ³(ğ‘1,ğ‘2) and îˆ³(ğ‘2,ğ‘1) are two different graph classes. We also denote by îˆ¼ the class of all planar graphs.

Using the above notation, the two combinatorial results in [32] can be rewritten as follows:

Proposition 11
Let ğ‘1â‰¥1 and ğ‘2â‰¥0 be two integers. If îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2, then îˆ³(ğ‘1,ğ‘2)âˆˆğš‚ğš€ğ™¶ğŒ(ğ‘).

Proposition 12
For every ğ‘‘âˆˆâ„•, îˆ¿ğ‘‘âŠ†îˆ¼(1,ğ‘‘).

We visualise the idea of the proof of Proposition 12 by some example, depicted in Fig. 4. In Lemma 25 we use the same idea for a more general result. Fig. 4 motivates the definition of the (ğ‘1,ğ‘2)-extension of a graph class. Intuitively, the fact that ğ»âˆˆîˆ³(ğ‘1,ğ‘2) expresses the fact that H can be seen as a â€œboundedâ€ distortion of a graph in îˆ³ (after a fixed number of â€œde-contractionsâ€ and contractions).

Fig. 4
figure 4
An example of the proof of Proposition 12. In the leftmost figure we we a collection of lines in the plane îˆ¸={ğ¿1,â€¦,ğ¿ğ‘˜} whose intersection graph ğºîˆ¸ is depicted in the rightmost figure and has maximum edge degree 9 because of line c that meets other lines in 9 points, therefore ğºîˆ¸âˆˆîˆ¿9. To see why ğºîˆ¸âˆˆîˆ¼(1,9), one may see the leftmost figure are a planar graph ğ‘ƒâˆˆîˆ¼ where vertices of degree 1 are discarded. The vertices of this planar graph can be seen as the result of the contraction of the red edges (seen as subgraphs of diameter 1) in the graph J in the middle, i.e., ğ‘ƒâ‰¤(1)ğ½. Finally, the intersection graph ğºîˆ¸ can be seen as a result of the contraction in J of each one of the paths, on at most 9 vertices, to a single vertex. Therefore ğºîˆ¸â‰¤9ğ½, hence ğºîˆ¸ belongs in the (1, 9)-extension of planar graphs

Full size image
Proposition 6, combined with Proposition 11, provided the wider, so far, framework on the applicability of minor-bidimensionality: ğš‚ğš€ğ™¶ğŒ(1) contains ğ–¾ğ—‘ğ–¼ğ—…(ğ»)(ğ‘1,ğ‘2) for every apex graph H and positive integers ğ‘1,ğ‘2. As, by Proposition 6, îˆ¼âˆˆğš‚ğš€ğ™¶ğ‚(1), Proposition 11 and Proposition 12 directly classifies in ğš‚ğš€ğ™¶ğŒ(1) the graph class îˆ¿ğ‘‘, and therefore a large family of bounded degree intersection graphs (including î‰ğ‘‘ and îˆ¹ğ‘‘). As a result of this, the applicability of bidimensionality theory for minor-bidimensional problems has been extended to much wider families (not necessarily minor-closed) of graph classes of geometric nature [32].

Our Main Result.

Definition 13
(Intersection graphs) Given a graph G and a set ğ‘†âŠ†ğ‘‰(ğº) we say that S is a connected set of G if G[S] is a connected graph. We also define by îˆ¯(ğº) the set of all connected subsets of V(G). Given a îˆ¯âŠ†îˆ¯(ğº), we define the intersection graph of îˆ¯ in G, denoted by ğ¼ğº(îˆ¯), as the graph whose vertex set is îˆ¯, where two vertices ğ¶1 and ğ¶2 of ğ¼ğº(îˆ¯) are connected by an edge if ğ¶1âˆ©ğ¶2â‰ âˆ…, and, moreover, the multiplicity of the edge {ğ¶1,ğ¶2} is equal to |ğ‘‰(ğ¶1âˆ©ğ¶2)|. Given a graph class îˆ³ we define the following class of graphs

ğ—‚ğ—‡ğ—ğ–¾ğ—‹(îˆ³)=â‹ƒğºâˆˆîˆ³{ğ¼ğº(îˆ¯)âˆ£îˆ¯âŠ†îˆ¯(ğº)}.
In other words, ğ—‚ğ—‡ğ—ğ–¾ğ—‹(îˆ³) contains all the intersection graphs of the connected vertex subsets of each of the graphs in îˆ³. Given a ğ‘‘âˆˆâ„•, we define ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³) as the set of graphs in ğ—‚ğ—‡ğ—ğ–¾ğ—‹(îˆ³) that have edge-degree at most d.

However, also the degree bound is maintained, as indicated by the following easy lemma.

Lemma 14
For every ğ‘‘âˆˆâ„•, îˆ¿ğ‘‘âŠ†ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ¼)âŠ†îˆ¿ğ‘‘â€², for some ğ‘‘â€²=ğ‘‚(ğ‘‘2).

Proof
(Proof (sketch).) We deal with the less trivial statement that ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ¼)âŠ†îˆ¿ğ‘‚(ğ‘‘2). For this, let ğ»âˆˆğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ¼) such that ğ»=ğ¼ğº(îˆ¯) for some collection îˆ¯ of connected subsets of V(G), for some ğºâˆˆîˆ¼. We choose the planar graph G so that |ğ‘‰(ğº)|+|ğ¸(ğº)| is minimized. This means that for every ğ¶âˆˆîˆ¯, G[C] is a tree on at most 2d vertices. If we now replace each tree G[C] by a string â€œsurroundingâ€ it is easy to observe that two such string cannot have more than ğ‘‚(ğ‘‘2) points in common. â—»

Observe that Proposition 11 exhibits some apparent â€œlack of symmetryâ€ as the assumption is â€œqualitatively strongerâ€ than the conclusion. This does not permit the application of bidimensionality for contraction-bidimensional parameters on classes further than those of apex-minor free graphs. In other words, the results in [32] covered, for the case of îˆ¿ğ‘‘, the green triangles in Fig. 2 but left the red triangles open. The main result of this paper is to fill this gap by proving the following extension of Proposition 11. The main result of this paper is the following.

Theorem 15
Let ğ‘1 and ğ‘2 be two positive integers. If îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2, then îˆ³(ğ‘1,ğ‘2)âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘).

Consequences. We call a graph class monotone if it is closed under taking of subgraphs, i.e., every subgraph of a graph in îˆ³ is also a graph in îˆ³. A powerful consequence of Theorem 15 is the following (the proof is postponed in Sect. 3).

Theorem 16
If îˆ³ is a monotone graph class, where îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2, and ğ‘‘âˆˆâ„•, then ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³)âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘).

Fig. 5
figure 5
The hierarchy of graph classes where Proposition 11 applies. î‰ğ‘‘ and îˆ¹ğ‘‘ are the bounded-degree unit-disk and map graphs respectively (where the results of [23, 25] apply). îˆ¿ğ‘‘ are the bounded-degree string graphs, while ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(ğ–¾ğ—‘ğ–¼ğ—…(ğ»)) are the bounded-degree intersection graphs of connected sets of H-minor free graphs, where H is an apex graph

Full size image
Combining Proposition 6 and Theorem 16 we obtain that ğš‚ğš€ğ™¶ğ‚(1) contains ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(ğ–¾ğ—‘ğ–¼ğ—…(ğ»)) for every apex graph H. This extends the applicability horizon of contraction-bidimensionality further than apex-minor free graphs (see Fig. 5). As a (very) special case of this, we have that îˆ¿ğ‘‘âˆˆğš‚ğš€ğ™¶ğ‚(1). Therefore, on îˆ¿ğ‘‘, the results described in Sect. 1.2 apply for contraction-bidimensional problems as well.

This paper is organized as follows. In Sect. 2, we give the necessary definitions and some preliminary results. We prove Theorem 16 in Sect. 3 while Sect. 4 is dedicated to the proof of Theorem 15. We should stress that this proof is quite different than the one of Proposition 11 in [32]. Finally, Sect. 5 contains some discussion and open problems.

Definitions and Preliminaries
We denote by â„• the set of all non-negative integers. Given ğ‘Ÿ,ğ‘âˆˆâ„•, we define [ğ‘Ÿ,ğ‘]={ğ‘Ÿ,â€¦,ğ‘} and [ğ‘Ÿ]=[1,ğ‘Ÿ].

All graphs in this paper are undirected, loop-less, and may have multiple edges. If a graph has no multiple edges, we call it simple. Given a graph G, we denote by V(G) its vertex set and by E(G) its edge set. Let x be a vertex or an edge of a graph G and likewise for y; their distance in G, denoted by ğğ¢ğ¬ğ­ğº(ğ‘¥,ğ‘¦), is the smallest number of vertices of a path in G that contains them both. Moreover if G is a graph and ğ‘¥âˆˆğ‘‰(ğº), we denote by ğ‘ğ‘ğº(ğ‘¥), for each ğ‘âˆˆâ„•, the set {ğ‘¦âˆ£ğ‘¦âˆˆğ‘‰(ğº), ğğ¢ğ¬ğ­ğº(ğ‘¥,ğ‘¦)â‰¤ğ‘+1}. For any set of vertices ğ‘†âŠ†ğ‘‰(ğº), we denote by G[S] the subgraph of G induced by the vertices from S. If G[S] is connected, then we say that S is a connected vertex set of G. We define the diameter of a connected subset S as the maximum pairwise distance between any two vertices of S. The edge-degree of a vertex ğ‘£âˆˆğ‘‰(ğº) is the number of edges that are incident to it (multi-edges contribute with their multiplicity to this number).

Fig. 6
figure 6
The graph Î“Ì‚ 9

Full size image
Definition 17
(Grids) The (ğ‘˜Ã—ğ‘˜)-grid, denoted by âŠğ‘˜, is the graph whose vertex set is [0,ğ‘˜âˆ’1]2 and two vertices (i, j) and (ğ‘–â€²,ğ‘—â€²) are adjacent if |ğ‘–âˆ’ğ‘–â€²|+|ğ‘—âˆ’ğ‘—â€²|=1. For ğ‘˜â‰¥3, the graph Î“ğ‘˜ (resp. Î“Ì‚ ğ‘˜), is defined if we add in âŠğ‘˜ all the edges in {{(ğ‘–+1,ğ‘—),(ğ‘–,ğ‘—+1)}âˆ£(ğ‘–,ğ‘—)âˆˆ[0,ğ‘˜âˆ’2]2} as well as all the edges between (ğ‘˜âˆ’1,ğ‘˜âˆ’1) (resp. a new vertex a) and the vertices in {(ğ‘–,ğ‘—)âˆ£[0,ğ‘˜âˆ’1]2âˆ–[1,ğ‘˜âˆ’2]2} that have not been added already. For an example of Î“ğ‘˜ (resp. Î“Ì‚ ğ‘˜), see Fig. 1 (resp. Fig. 6). Notice that Î“ğ‘˜ is a triangulation of âŠğ‘˜. In each of these graphs we denote the vertices of the underlying grid by their coordinates (ğ‘–,ğ‘—)âˆˆ[0,ğ‘˜âˆ’1]2 agreeing that the upper-left corner (i.e., the unique vertex of degree 3) is the vertex (0, 0). Î“Ì‚ ğ‘˜ has two vertices of degree 3, the top left and the bottom right of the grid part. We call Î“ğ‘˜ the uniformly triangulated grid and Î“Ì‚ ğ‘˜ the extended uniformly triangulated grid.

Definition 18
(Treewidth) A tree-decomposition of a graph G, is a pair (ğ‘‡,î‰„), where T is a tree and î‰„={ğ‘‹ğ‘¡: ğ‘¡âˆˆğ‘‰(ğ‘‡)} is a family of subsets of V(G), called bags, such that the following three properties are satisfied:

âˆ™ â‹ƒğ‘¡âˆˆğ‘‰(ğ‘‡)ğ‘‹ğ‘¡=ğ‘‰(ğº),

âˆ™ for every edge ğ‘’âˆˆğ¸(ğº) there exists ğ‘¡âˆˆğ‘‰(ğ‘‡) such that ğ‘’âŠ†ğ‘‹ğ‘¡, and

âˆ™ âˆ€ğ‘£âˆˆğ‘‰(ğº), the set ğ‘‡ğ‘£={ğ‘¡âˆˆğ‘‰(ğ‘‡)âˆ£ğ‘£âˆˆğ‘‹ğ‘¡} is a connected vertex set of T.

The width of a tree-decomposition is the cardinality of the maximum size bag minus 1 and the treewidth of a graph G is the minimum width over all the tree-decompositions of G. We denote the treewidth of G by ğ—ğ—(ğº).

Lemma 19
Let G be a graph and let H be a c-size contraction of G. Then ğ—ğ—(ğº)â‰¤(ğ‘+1)â‹…(ğ—ğ—(ğ»)+1)âˆ’1.

Proof
By definition, since H is a c-size contraction of G, there is a mapping between each vertex of H and a connected set of at most c edges in G, so that by contracting these edge sets we obtain H from G. The endpoints of these edges form disjoint connected sets in G, implying a partition of the vertices of G into connected sets {ğ‘‰ğ‘¥âˆ£ğ‘¥âˆˆğ‘‰(ğ»)}, where |ğ‘‰ğ‘¥|â‰¤ğ‘+1 for any vertex ğ‘¥âˆˆğ‘‰(ğ»).

Consider now a tree decomposition (ğ‘‡,î‰„) of H. We claim that the pair (ğ‘‡,î‰„â€²), where ğ‘‹â€²ğ‘¡:=â‹ƒğ‘¥âˆˆğ‘‹ğ‘¡ğ‘‰ğ‘¥ for ğ‘¡âˆˆğ‘‡ is a tree decomposition of G. Clearly all vertices of G are included in some bag, since all vertices of H did. Every edge of G with both endpoints in the same part of the partition is in a bag, as each of these vertex sets is placed as a whole in the same bag. If e is an edge of G with endpoints in different parts of the partition, say ğ‘‰ğ‘¥ and ğ‘‰ğ‘¦, then this implies that {ğ‘¥,ğ‘¦}âˆˆğ¸(ğ»). Thus, there is a node t of T for which ğ‘¥,ğ‘¦âˆˆğ‘‹ğ‘¡ and therefore ğ‘’âŠ†ğ‘‹â€²ğ‘¡. Moreover, the continuity property remains unaffected, since for any vertex ğ‘¥âˆˆğ‘‰(ğ») each vertex in ğ‘‰ğ‘¥ induces the same subtree in T that x did. â—»

In Table 1 we present all the notation that we use in this paper.

Table 1 Graphs, graph classes, and functions of the paper
Full size table
Proof of Theorem 16
We start with the following useful property of the contraction relation. We use ğ›¿(ğº) for the minimum number of edges that are incident to a vertex of the graph G. Given a vertex v in G incident to exactly two edges ğ‘’1={ğ‘£,ğ‘¥} and ğ‘’2={ğ‘£,ğ‘¦}, the dissolution of v in G is the operation of removing ğ‘’1 and ğ‘’2 from G and then we add the edge {ğ‘¥,ğ‘¦}. If the graph H occurs from G after applying some (possibly empty) sequence of vertex dissolutions, then we say that H is a dissolution of G. We also say that H is a topological minor of G if H the dissolution of some subgraph of G.

Lemma 20
Let Q be a graph where ğ›¿(ğ‘„)â‰¥3 and let H, G be graphs where H is a dissolution of G. If ğ‘„â‰¤ğº, then ğ‘„â‰¤ğ».

Proof
As ğ‘„â‰¤ğº then there exist ğœ:ğ‘‰(ğº)â†’ğ‘‰(ğ‘„) such that for all ğ‘¥âˆˆğ‘‰(ğ‘„), ğº[ğœâˆ’1(ğ‘¥)] is a non-empty graph and for every ğ‘¥,ğ‘¦âˆˆğ‘‰(ğ‘„), {ğ‘¥,ğ‘¦}âˆˆğ¸(ğ‘„)âŸºğº[ğœâˆ’1(ğ‘¥)âˆªğœâˆ’1(ğ‘¦)] is connected.

Let v be a vertex in G incident to exactly two edges ğ‘’1={ğ‘£,ğ‘£â€²} and ğ‘’2={ğ‘£,ğ‘£â€³}, and let ğºâ€² be the graph obtained from G after the dissolution of v. Let ğœâ€²:ğ‘‰(ğºâ€²)â†’ğ‘‰(ğ‘„) such that for all ğ‘§âˆˆğ‘‰(ğºâ€²), ğœâ€²(ğ‘§)=ğœ(ğ‘§). As the dissolution maintains connectivity, we have that for every ğ‘¥,ğ‘¦âˆˆğ‘‰(ğ‘„), {ğ‘¥,ğ‘¦}âˆˆğ¸(ğ‘„)âŸºğº[ğœâ€²âˆ’1(ğ‘¥)âˆªğœâ€²âˆ’1(ğ‘¦)] is connected. Moreover, as ğ›¿(ğ‘„)â‰¥3, we know that for each ğ‘¥âˆˆğ‘‰(ğ‘„), there exists ğ‘§âˆˆğœâˆ’1(ğ‘¥) such that z has edge degree at least 3. In particular we know that z is different from v. So we have that ğº[ğœâ€²âˆ’1(ğ‘¥)] is a non-empty graph. Thus ğ‘„â‰¤ğºâ€². The lemma follows by iterating this argument. â—»

Definition 21
(The function bcg) Given a graph G, we define ğ›ğœğ (ğº) as the maximum k for which G can be contracted to the uniformly triangulated grid Î“ğ‘˜.

Notice that ğ›ğœğ  is a contraction-closed parameter, i.e., if ğ»â‰¤ğº, then ğ›ğœğ (ğ»)â‰¤ğ›ğœğ (ğº).

Lemma 22
Let H and G be two graphs. If H is a dissolution of G, then ğ›ğœğ (ğ»)=ğ›ğœğ (ğº).

Proof
The fact that ğ›ğœğ (ğ»)â‰¤ğ›ğœğ (ğº) follows from the fact that H is also a contraction of G and taking into account the contraction-closedness of ğ›ğœğ . The fact that ğ›ğœğ (ğº)â‰¤ğ›ğœğ (ğ») follows by taking into account that ğ›¿(Î“ğ‘˜)â‰¥3 and applying inductively Lemma 20 to the vertices of degee 2 in G that need to be dissolved in order to transform G to H. â—»

Definition 23
Given a graph class îˆ³, we define the dissolution closure of îˆ³ as the graph class ğ–½ğ—‚ğ—Œğ—Œ(îˆ³) containing all the dissolutions of the graphs in îˆ³.

We observe the following.

Lemma 24
If îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2, then ğ–½ğ—‚ğ—Œğ—Œ(îˆ³)âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘).

Proof
Suppose that îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2, wich implies that

âˆ€ğºâˆˆîˆ³ ğ—ğ—(ğº)â‰¤ğœ†â‹…(ğ›ğœğ (ğº))ğ‘.
(1)
Let ğ»âˆˆğ–½ğ—‚ğ—Œğ—Œ(îˆ³) and let ğºâˆˆîˆ³ such that H is a dissolution of G. By Lemma 22, ğ›ğœğ (ğ»)=ğ›ğœğ (ğº) and from (1), ğ—ğ—(ğº)â‰¤ğœ†(ğ›ğœğ (ğ»))ğ‘. As H is a minor of G, we have that ğ—ğ—(ğ»)â‰¤ğœ†(ğ›ğœğ (ğ»))ğ‘ and the lemma follows.

The next lemma uses as a departure point the same idea as the one of proof of Proposition 12, visualized by the example of Fig. 4.

Lemma 25
If îˆ³ is a graph class that is topological minor closed, then ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³)âŠ†îˆ³(ğ‘‘+1,ğ‘‘âˆ’1).

Proof
Let H be a graph on h vertices in ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³), for some ğ‘‘âˆˆâ„•. This means that there is a graph G in îˆ³ such that we can see the vertices of H as a set îˆ¯={ğ¶1,â€¦,ğ¶â„} of connected subsets of G and each multi-edge ğ‘’={ğ¶ğ‘–,ğ¶ğ‘—} of H corresponds to two mutually intersecting subsets of îˆ¯ and the multiplicity of e is |ğ¶ğ‘–âˆ©ğ¶ğ‘—|. For every {ğ‘–,ğ‘—}âˆˆ(â„2), we set ğ‘‰ğ‘–,ğ‘—=ğ¶ğ‘–âˆ©ğ¶ğ‘—, ğ‘šğ‘–,ğ‘—=|ğ¶ğ‘–âˆ©ğ¶ğ‘—|, and we assume that ğ‘’ğ‘–,ğ‘—={ğ¶ğ‘–,ğ¶ğ‘—} is a multi-edge of H of multiplicity ğ‘šğ‘–,ğ‘— (if this edge does not exists in H, then the multiplicity of ğ‘’ğ‘–,ğ‘— is 0).

We define ğ‘‰ğ‘–=â‹ƒğ‘—âˆˆ[â„]ğ‘‰ğ‘–,ğ‘—, for every ğ‘–âˆˆ[â„] and also set ğ‘‰=â‹ƒğ‘–âˆˆ[â„]ğ‘‰ğ‘–. Notice that, for each ğ‘–âˆˆ[â„], |ğ‘‰ğ‘–| is upper bounded by the edge-degree, in H, of the vertex ğ¶ğ‘–, therefore, |ğ‘‰ğ‘–|â‰¤ğ‘‘ for each ğ‘–âˆˆ[â„]. Also, a vertex in V cannot belong in more that ğ‘‘+1 distinct ğ¶ğ‘–â€™s as, otherwise H would contain a clique with at least ğ‘‘+2 vertices. As ğ»âˆˆğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³), this is not possible.

Recall that, for each ğ‘–âˆˆ[â„], ğ‘‰ğ‘– is a subset of ğ¶ğ‘– and let ğ‘‡ğ‘– be a minimum-size tree of ğº[ğ¶ğ‘–] containing the vertices of ğ‘‰ğ‘–. We partition the set of vertices of ğ‘‡ğ‘– into three sets ğ‘‰ğ‘–,ğ‘‰â¯â¯â¯â¯â¯ğ‘–,ğ·ğ‘– where among the vertices in ğ‘‰(ğ‘‡ğ‘–)âˆ–ğ‘‰ğ‘–, ğ·ğ‘– are the vertices of degree 2 and ğ‘‰â¯â¯â¯â¯â¯ğ‘– are the rest. By minimality, the leaves of ğ‘‡ğ‘– belong in ğ‘‰ğ‘–. Moreover, there is no vertex in ğ‘‰â¯â¯â¯â¯â¯ğ‘– that belongs to some other ğ‘‰â¯â¯â¯â¯â¯ğ‘–â€², ğ‘–âˆˆ[â„]âˆ–{ğ‘–}. We denote by ğ‘‡Ì‚ ğ‘– the tree obtained from ğ‘‡ğ‘– if we dissolve in ğ‘‡ğ‘– all vertices of ğ·ğ‘–. That way we can still partition the vertices of each ğ‘‡Ì‚ ğ‘–, ğ‘–âˆˆ[â„], into ğ‘‰ğ‘– and ğ‘‰â¯â¯â¯â¯â¯ğ‘–. Also, it is easy to see that ğ‘‡Ì‚ ğ‘– has diameter at most |ğ‘‰ğ‘–|âˆ’1â‰¤ğ‘‘âˆ’1.

We define the graph ğºâ€²:=â‹ƒğ‘–âˆˆ[â„]ğ‘‡Ì‚ ğ‘–. Notice that ğºâ€² is obtained from â‹ƒğ‘–âˆˆ[â„]ğ‘‡ğ‘– (that is a subgraph of G) after we dissolve all vertices in â‹ƒğ‘–âˆˆ[â„]ğ·ğ‘–. Therefore ğºâ€² is a topological minor of G, thus ğºâ€²âˆˆîˆ³. We consider the collection î‰€={ğ‘‡Ì‚ 1,â€¦,ğ‘‡Ì‚ â„} of connected subgraphs of ğºâ€².

We define the graph J to be the disjoint union of the h trees in î‰€ in which, for each ğ‘¥âˆˆğ‘‰, we add a clique between all the copies of x. Notice that each added clique has size at least 2 and at most ğ‘‘+1.

Observe now that ğºâ€²â‰¤(ğ‘‘+1)ğ½, as ğºâ€² is obtained after contracting in J the aforementioned pairwise disjoint cliques. Moreover, ğ»â‰¤ğ‘‘âˆ’1ğ½ as H is obtained after we contract in J each ğ‘‡Ì‚ ğ‘– (of diameter â‰¤ğ‘‘âˆ’1) to a single vertex. As ğºâ€²âˆˆîˆ³, we conclude that ğ»âˆˆîˆ³(ğ‘‘+1,ğ‘‘âˆ’1) as required. â—»

We are now ready to prove Theorem 16.

Proof of Theorem 16
Let îˆ³ be a monotone graph class in ğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1â‰¤ğ‘<2 and let îˆ°=ğ–½ğ—‚ğ—Œğ—Œ(îˆ³). From Lemma 24, îˆ°âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) and by the monotonicity of îˆ³, we have that ğ–½ğ—‚ğ—Œğ—Œ(îˆ³) is closed under taking of topological minors. Therefore, from Lemma 25, ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ°)âŠ†îˆ°(ğ‘‘+1,ğ‘‘âˆ’1) and from Theorem 15, ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ°)âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘). The result follows because îˆ³âŠ†îˆ°, as this implies that ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³)âŠ†ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ°). â—»

Proof of Theorem 15
Let H and G be graphs and c be a non-negative integer. If ğ»â‰¤ğ‘ğœğº, then we say that H is a ğœ-contraction of G, and denote this by ğ»â‰¤ğœğº.

Before we proceed the the proof of Theorem 15 we make first the following three observations. (In all statements, we assume that G and H are two graphs and ğœ:ğ‘‰(ğº)â†’ğ‘‰(ğ») such that H is a ğœ-contraction of G.)

Observation 26
Let S be a connected subset of V(H). Then the set â‹ƒğ‘¥âˆˆğ‘†ğœâˆ’1(ğ‘¥) is connected in G.

Observation 27
Let ğ‘†1âŠ†ğ‘†2âŠ†ğ‘‰(ğ»). Then ğœâˆ’1(ğ‘†1)âŠ†ğœâˆ’1(ğ‘†2)âŠ†ğ‘‰(ğº).

Observation 28
Let S be a connected subset of V(G). Then the diameter of ğœ(ğ‘†) in H is at most the diameter of S in G.

Given a graph G and ğ‘†1,ğ‘†2âŠ†ğ‘‰(ğº) we say that ğ‘†1 and ğ‘†2 touch if either ğ‘†1âˆ©ğ‘†2â‰ âˆ… or there is an edge of G with one endpoint in ğ‘†1 and the other in ğ‘†2.

We say that a collection îˆ¾ of paths of a graph is internally disjoint if none of the internal vertices, i.e., none of the vertex of degree 2, of some path in îˆ¾ is a vertex of some other path in îˆ¾. Let îˆ­ be a collection of subsets of V(G). We say that îˆ­ is a connected packing of G if its elements are connected and pairwise disjoint. If additionally îˆ­ is a partition of V(G), then we say that îˆ­ is a connected partition of G and if, additionally, all its elements have diameter bounded by some integer c, then we say that îˆ­ is a c-diameter partition of G.

Î›-State Configurations
Definition 29
(Î›-state configurations) Let G be a graph. Let Î›=(î‰ƒ,îˆ±) be a graph whose vertex set is a connected packing of G, i.e., its vertices are connected subsets of V(G). A Î›-state configuration of a graph G is a quadruple îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½) where

1.
î‰„ is a connected packing of G,

2.
ğ›¼ is a bijection from î‰ƒ to î‰„ such that for every ğ‘Šâˆˆî‰ƒ, ğ‘ŠâŠ†ğ›¼(ğ‘Š),

3.
îˆ¾ is a collection of internally disjoint paths of G, and

4.
ğ›½ is a bijection from îˆ± to îˆ¾ such that if {ğ‘Š1,ğ‘Š2}âˆˆîˆ± then the endpoints of ğ›½({ğ‘Š1,ğ‘Š2}) are in ğ‘Š1 and ğ‘Š2 and ğ‘‰(ğ›½({ğ‘Š1,ğ‘Š2}))âŠ†ğ›¼(ğ‘Š1)âˆªğ›¼(ğ‘Š2).

Definition 30
(States, freeways, clouds, and coverage) A Î›-state configuration îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½) of G is complete if î‰„ is a partition of V(G). We refer to the elements of î‰„ as the states of îˆ¿ and to the elements of îˆ¾ as the freeways of îˆ¿. We define ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)=ğ‘‰(ğº)âˆ–â‹ƒğ‘‹âˆˆî‰„ğ‘‹. Note that if îˆ¿ is a Î›-state configuration of G, îˆ¿ is complete if and only if ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)=âˆ….

Let îˆ­ be a c-diameter partition of G. We refer to the sets of îˆ­ as the îˆ­-clouds of G. We define ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿) as the set of all îˆ­-clouds of G that are not subsets of some ğ‘‹âˆˆî‰„. Given a îˆ­-cloud C and a state X of îˆ¿ we say that C shadows X if ğ¶âˆ©ğ‘‹â‰ âˆ…. The coverage ğ–¼ğ—ˆğ—îˆ¿(ğ¶) of an îˆ­-cloud C of G is the number of states of îˆ¿ that are shadowed by C. A Î›-state configuration îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½) of G is îˆ­-normal if its satisfies the following conditions:

(A)
If a îˆ­-cloud C intersects some ğ‘Šâˆˆî‰ƒ, then ğ¶âŠ†ğ›¼(ğ‘Š).

(B)
If a îˆ­-cloud over îˆ¿ intersects the vertex set of at least two freeways of îˆ¿, then it shadows at most one state of îˆ¿.

We define ğ–¼ğ—ˆğ—Œğ—îˆ­(îˆ¿)=âˆ‘ğ¶âˆˆğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿)ğ–¼ğ—ˆğ—îˆ¿(ğ¶). Given ğ‘†1âŠ†ğ‘†2âŠ†ğ‘‰(ğº) where ğ‘†1 is connected, we define ğ–¼ğ–¼ğº(ğ‘†2,ğ‘†1) as the (unique) connected component of ğº[ğ‘†2] that contains ğ‘†1.

Triangulated Grids Inside Triangulated Grids
The next lemma is the main combinatorial engine of our results. We assume that ğ»â‰¤ğ‘ğº and Î“ğ‘˜â‰¤ğº. Here H should be seen as the result of a â€œshrinkâ€ of G in the sense that G can be contracted to H so that each vertex of H is created after a bounded number of contractions. The lemma states that if G can be contracted to a uniformly triangulated grid, then H, as a â€œshrunk versionâ€ of G, can also be contracted to a uniformly triangulated grid that is no less than linearly smaller.

The proof strategy views the graph G as being contracted into a uniformly triangulated grid Î“ğ‘˜ (see Fig. 7), we choose a scattered set of â€œcapitalsâ€ in it (the black vertices in Fig. 7). Then we set up a â€œconquestâ€ procedure where each capital is trying to expand to a country. This procedure has three phases. The first phase is the expansion face where each country tries to incorporate unconquested territories around it (the limits of this expansion is depicted by the red cycles in Fig. 7). The second phase is the clash face, where different countries are fighting for disputed territories. Finally, the third phase is the annex phase, where each country naturally incorporates remaining enclaves. The end of this war creates a set of countries occupying the whole G that, when contracted, give rise to a uniformly triangulated grid Î“ğ‘˜â€², where ğ‘˜â€²=Î©(ğ‘˜).

Lemma 31
Let G and H be graphs and c, k be non-negative integers such that ğ»â‰¤ğ‘ğº and Î“ğ‘˜â‰¤ğº. Then Î“ğ‘˜â€²â‰¤ğ» where ğ‘˜â€²=âŒŠğ‘˜âˆ’12ğ‘+1âŒ‹âˆ’1.

Proof
Let ğ‘˜âˆ—=1+(2ğ‘+1)â‹…(ğ‘˜â€²+1) and observe that ğ‘˜âˆ—â‰¤ğ‘˜, therefore Î“ğ‘˜âˆ—â‰¤Î“ğ‘˜â‰¤ğº. For simplicity we use Î“=Î“ğ‘˜âˆ—. Let ğœ™:ğ‘‰(ğº)â†’ğ‘‰(ğ») such that ğ»â‰¤ğ‘ğœ™ğº and let ğœ:ğ‘‰(ğº)â†’ğ‘‰(Î“) such that Î“â‰¤ğœğº. We define îˆ­={ğœ™âˆ’1(ğ‘)âˆ£ğ‘âˆˆğ‘‰(ğ»)}. Notice that îˆ­ is a c-diameter partition of G.

For each (ğ‘–,ğ‘—)âˆˆ[[0,ğ‘˜â€²+1]]2, we define ğ‘ğ‘–,ğ‘— to be the vertex of Î“ with coordinate (ğ‘–(2ğ‘+1),ğ‘—(2ğ‘+1)). We set ğ‘„in={ğ‘ğ‘–,ğ‘—âˆ£(ğ‘–,ğ‘—)âˆˆ[[1,ğ‘˜â€²]]2} and ğ‘„out={ğ‘ğ‘–,ğ‘—âˆ£(ğ‘–,ğ‘—)âˆˆ[[0,ğ‘˜â€²+1]]2}âˆ–ğ‘„in. Let also ğ‘„=ğ‘„inâˆª{ğ‘out} were ğ‘out is a new element that does not belong in ğ‘„in. Here ğ‘out can be seen as a vertex that â€œrepresentsâ€ all vertices in ğ‘„out.

Let q, p be two different elements of Q. We say that q and p are linked if they both belong in ğ‘„in and their distance in Î“ is 2ğ‘+1 or one of them is ğ‘out and the other is ğ‘ğ‘–,ğ‘— where ğ‘–âˆˆ{1,ğ‘˜â€²} or ğ‘—âˆˆ{1,ğ‘˜â€²}. â—»

Fig. 7
figure 7
A visualization of the proof of Lemma 31. In this whole graph Î“ğ‘˜, we initialize our reaserch of Î“Ì‚ ğ‘˜â€² such that every internal red hexagon will become a vertex of Î“Ì‚ ğ‘˜â€² and correspond to a state and the border, also circle by a red line will become the vertex ğ‘out. The blue edges correspond to the freeways. Red cycles correspond to the boundaries of the starting countries. Blue paths between big-black vertices are the freeways. Big-black vertices are the capitals (Color figure online)

Full size image
For each ğ‘âˆˆğ‘„in, we define ğ‘Šğ‘=ğœâˆ’1(ğ‘). ğ‘Šğ‘ is connected by the definition of ğœ. In case ğ‘=ğ‘out we define ğ‘Šğ‘=â‹ƒğ‘â€²âˆˆğ‘„outğœâˆ’1(ğ‘â€²). Note that as ğ‘„out is a connected set of Î“, then, by Observation 26, ğ‘Šğ‘out is connected in G. We also define î‰ƒ={ğ‘Šğ‘âˆ£ğ‘âˆˆğ‘„}. Given some ğ‘âˆˆğ‘„ we call ğ‘Šğ‘ the q-capital of G and a subset S of V(G) is a capital of G if it is the q-capital for some ğ‘âˆˆğ‘„. Notice that î‰ƒ is a connected packing of V(G).

Let ğ‘âˆˆğ‘„. If ğ‘âˆˆğ‘„in then we set ğ‘ğ‘=ğ‘ğ‘Î“(ğ‘). If ğ‘=ğ‘out, then we set ğ‘ğ‘=â‹ƒğ‘â€²âˆˆğ‘„outğ‘ğ‘Î“(ğ‘â€²). Note that for every ğ‘âˆˆğ‘„, ğ‘ğ‘âŠ†ğ‘‰(Î“). For every ğ‘âˆˆğ‘„, we define ğ‘‹ğ‘=ğœâˆ’1(ğ‘ğ‘). Note that ğ‘‹ğ‘âŠ†ğ‘‰(ğº). We also set î‰„={ğ‘‹ğ‘âˆ£ğ‘âˆˆğ‘„}. Let q and p we two linked elements of Q. If both q and p belong to ğ‘„in, and therefore are vertices of Î“, then we define ğ‘ğ‘,ğ‘ as the unique shortest path between them in Î“. If ğ‘=ğ‘out and ğ‘âˆˆğ‘„in, then we know that ğ‘=ğ‘ğ‘–,ğ‘— where ğ‘–âˆˆ{1,ğ‘˜â€²} or ğ‘—âˆˆ{1,ğ‘˜â€²}. In this case we define ğ‘ğ‘,ğ‘ as any shortest path in Î“ between ğ‘ğ‘–,ğ‘— and the vertices in ğ‘„out. In both cases, we define ğ‘ƒğ‘,ğ‘ by picking some path between ğ‘Šğ‘ and ğ‘Šğ‘ in ğº[ğœâˆ’1(ğ‘‰(ğ‘ğ‘,ğ‘))] such that |ğ‘‰(ğ‘ƒğ‘,ğ‘)âˆ©ğ‘Šğ‘|=1 and |ğ‘‰(ğ‘ƒğ‘,ğ‘)âˆ©ğ‘Šğ‘|=1.

Let îˆ±={{ğ‘Šğ‘,ğ‘Šğ‘}âˆ£ p and q are linked} and let Î›=(î‰ƒ,îˆ±). Notice that Î› is isomorphic to Î“Ì‚ ğ‘˜â€² and consider the isomorphism that correspond each vertex ğ‘=ğ‘ğ‘–,ğ‘—, ğ‘–,ğ‘—âˆˆ[[1,ğ‘˜â€²]]2 to the vertex with coordinates (i, j). Moreover ğ‘out corresponds to the apex vertex of Î“Ì‚ ğ‘˜â€².

Let ğ›¼:î‰ƒâ†’î‰„ such that for every ğ‘âˆˆğ‘„, ğ›¼(ğ‘Šğ‘)=ğ‘‹ğ‘. Let also îˆ¾={ğ‘ƒğ‘,ğ‘âˆ£ğ‘,ğ‘âˆˆğ‘„, p and q are linked}. We define ğ›½:îˆ±â†’îˆ¾ such that if q and p are linked, then ğ›½(ğ‘Šğ‘,ğ‘Šğ‘)=ğ‘ƒğ‘,ğ‘. We use notation îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½).

Claim 32
îˆ¿ is an îˆ­-normal Î›-state configuration of G.

Proof of Claim 32
We first see that îˆ¿ is a Î›-state configuration of G. Condition 1 follows by the definition of ğ‘‹ğ‘ and Observation 26. Condition 2 follows directly by the definitions of ğ‘Šğ‘ and ğ‘‹ğ‘. For Condition 3, we first observe that, by the construction of Î“ and the definition of ğ‘ğ‘,ğ‘, for any two pairs p, q and ğ‘â€²,ğ‘â€² of pairwise linked elements of Q, the paths ğ‘ğ‘,ğ‘ and ğ‘ğ‘â€²,ğ‘â€² are internally vertex disjoined paths of Î“. It implies that ğ‘ƒğ‘,ğ‘ and ğ‘ƒğ‘â€²,ğ‘â€² can intersect each other only on the vertices of ğ‘Šğ‘âˆªğ‘Šğ‘âˆªğ‘Šğ‘â€²âˆªğ‘Šğ‘â€². But ğ‘ƒğ‘,ğ‘ (resp. ğ‘ƒğ‘â€²,ğ‘â€²), by construction contains only two vertices of ğ‘Šğ‘âˆªğ‘Šğ‘âˆªğ‘Šğ‘â€²âˆªğ‘Šğ‘â€² that are the extremities of ğ‘ƒğ‘,ğ‘, (resp. ğ‘ƒğ‘â€²,ğ‘â€²). So ğ‘ƒğ‘,ğ‘ and ğ‘ƒğ‘â€²,ğ‘â€² are internally vertex disjoined, as required. For Condition 4, assume that {ğ‘Šğ‘,ğ‘Šğ‘}âˆˆîˆ±. The fact that the endpoints of ğ›½({ğ‘Šğ‘,ğ‘Šğ‘}) are in ğ‘Šğ‘ and ğ‘Šğ‘ follows directly by the definition of ğ›½({ğ‘Šğ‘,ğ‘Šğ‘})=ğ‘ƒğ‘,ğ‘. It remains to prove that ğ‘‰(ğ›½({ğ‘Šğ‘,ğ‘Šğ‘}))âŠ†ğ›¼(ğ‘Šğ‘)âˆªğ›¼(ğ‘Šğ‘) or equivalently, that ğ‘‰(ğ‘ƒğ‘,ğ‘)âŠ†ğ‘‹ğ‘âˆªğ‘‹ğ‘. Observe that, if both ğ‘,ğ‘âˆˆğ‘„in, then every vertex in the shortest path ğ‘ğ‘,ğ‘ should be within distance c from either p or q. Similarly, if ğ‘âˆˆğ‘„in and ğ‘=ğ‘out, then every vertex in the shortest path ğ‘ğ‘,ğ‘ should be within distance c from either p or some vertex in ğ‘„out. So for every ğ‘,ğ‘âˆˆğ‘„, with ğ‘â‰ ğ‘, ğ‘ğ‘,ğ‘âŠ†ğ‘ğ‘âˆªğ‘ğ‘. By Observation 27, every vertex in ğœâˆ’1(ğ‘‰(ğ‘ğ‘,ğ‘)) belongs to ğ‘‹ğ‘âˆªğ‘‹ğ‘ and the required follows as ğ‘‰(ğ‘ƒğ‘,ğ‘)âŠ†ğœâˆ’1(ğ‘‰(ğ‘ğ‘,ğ‘)). This completes the proof that îˆ¿ is a Î›-state configuration of G.

We now prove that îˆ¿ is îˆ­-normal. Recall that îˆ­ be a c-diameter partition of G. Let C be a îˆ­-cloud and let ğ¶â€²=ğœ(ğ¶) be a subset of ğ‘‰(Î“). As C is of diameter at most c, then, from Observation 28, ğ¶â€² is also of diameter at most c. Notice that if C intersects some member W of î‰ƒ, then ğ¶â€²=ğœ(ğ¶) also intersects ğœ(ğ‘Š), therefore ğ¶â€² intersects some element of ğ‘„inâˆªğ‘„out. Assume ğ¶â€² contains ğ‘âˆˆğ‘„inâˆªğ‘„out, then ğ¶â€²âŠ†ğ‘ğ‘. From Observation 26, ğ¶âŠ†ğ‘‹ğ‘=ğ›¼(ğ‘Šğ‘), therefore C satisfies Condition (A).

By construction, the distance in Î“ between two elements of ğ‘„in is either 2ğ‘+1 or at least 4ğ‘+2. The distance in Î“ between on elements of ğ‘„in and any element of ğ‘„out is a multiple of 2ğ‘+1. This implies that if ğ‘,ğ‘âˆˆğ‘„, ğ‘â‰ ğ‘, ğ‘ğ‘âˆ©ğ¶â€²â‰ âˆ…, and ğ‘ğ‘âˆ©ğ¶â€²â‰ âˆ…, then p and q are linked.

By construction, if p and q are linked, then for every ğ‘Ÿâˆˆğ‘„ and every ğ‘¢âˆˆğ‘ğ‘,ğ‘, ğğ¢ğ¬ğ­Î“(ğ‘Ÿ,ğ‘¢)â‰¥min(ğğ¢ğ¬ğ­Î“(ğ‘Ÿ,ğ‘),ğğ¢ğ¬ğ­ğº(ğ‘Ÿ,ğ‘)), where for every ğ‘¥âˆˆğ‘„in, the quantity ğğ¢ğ¬ğ­Î“(ğ‘¥,ğ‘out) is interpreted as min{ğğ¢ğ¬ğ­Î“(ğ‘¥,ğ‘â€²)âˆ£ğ‘â€²âˆˆğ‘„out}. This implies that if ğ¶â€² intersects ğ‘ğ‘,ğ‘ for some ğ‘,ğ‘âˆˆğ‘„, then for every ğ‘Ÿâˆˆğ‘„âˆ–{ğ‘,ğ‘}, then ğ¶â€² does not intersect ğ‘ğ‘Ÿ. We will use this fact in the next paragraph towards completing the proof of Condition (B).

We now claim that if ğ¶â€² intersects two distinct paths in {ğ‘ğ‘,ğ‘âˆ£(ğ‘,ğ‘)âˆˆğ‘„2,ğ‘â‰ ğ‘}, then ğ¶â€² intersects at most one of the sets in {ğ‘ğ‘â€²âˆ£ğ‘â€²âˆˆğ‘„}. Let ğ‘ğ‘,ğ‘ and ğ‘ğ‘â€²,ğ‘â€² be two distinct paths intersected by ğ¶â€². We argue first that ğ‘,ğ‘,ğ‘â€²,ğ‘â€² cannot be all different. Indeed, if this is the case, as ğ¶â€² intersects ğ‘ğ‘,ğ‘ then ğ¶â€² cannot intersect ğ‘ğ‘â€² or ğ‘ğ‘â€² as ğ‘â€²,ğ‘â€²âˆ‰{ğ‘,ğ‘}. As ğ‘ğ‘â€²,ğ‘â€²âŠ†ğ‘ğ‘â€²âˆªğ‘ğ‘â€², we have a contradiction. Assume now that ğ‘=ğ‘â€² and ğ‘â‰ ğ‘â€². As ğ¶â€² intersects ğ‘ğ‘,ğ‘, then it does not intersect ğ‘ğ‘Ÿ for any ğ‘Ÿâˆˆğ‘„âˆ–{ğ‘,ğ‘}, and as it intersects ğ‘ğ‘,ğ‘â€², then it does not intersect ğ‘ğ‘Ÿ for any ğ‘Ÿâˆˆğ‘„âˆ–{ğ‘,ğ‘â€²}. We obtain that ğ¶â€² intersects at most one of the sets in {ğ‘ğ‘Ÿâˆ£ğ‘Ÿâˆˆğ‘„} that is ğ‘ğ‘. By definition of the states, we obtain that C shadows at most one state that is ğ‘‹ğ‘. That completes the proof of condition (B). â—»

We define bellow three ways to transform a Î›-state configuration of G. In each of them, îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½) is an îˆ­-normal Î›-state configuration of G and C is an îˆ­-cloud in ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿).

1.
The expansion procedure applies when C intersects at least two freeways of îˆ¿. Let X be the state of îˆ¿ shadowed by C (this state is unique because of property (B) of îˆ­-normality). We define (î‰„â€²,ğ›¼â€²,îˆ¾â€²,ğ›½â€²)=ğ–¾ğ—‘ğ—‰ğ–ºğ—‡ğ–½(îˆ¿,ğ¶) such that

î‰„â€²=î‰„âˆ–{ğ‘‹}âˆª{ğ‘‹âˆªğ¶},

for each ğ‘Šâˆˆî‰ƒ, ğ›¼â€²(ğ‘Š)=ğ‘‹â€² where ğ‘‹â€² is the unique set of î‰„â€² such that ğ‘ŠâŠ†ğ‘‹â€²,

îˆ¾â€²=îˆ¾, and ğ›½â€²=ğ›½.

2.
The clash procedure applies when C intersects exactly one freeway P of îˆ¿. Let ğ‘‹1,ğ‘‹2 be the two states of îˆ¿ that intersect this freeway. Notice that ğ‘ƒ=ğ›½(ğ›¼âˆ’1(ğ‘‹1),ğ›¼âˆ’1(ğ‘‹2)), as it is the only freeway with vertices in ğ‘‹1 and ğ‘‹2. Assume that (ğ¶âˆ©ğ‘‰(ğ‘ƒ))âˆ©ğ‘‹1â‰ âˆ… (if, not, then swap the roles of ğ‘‹1 and ğ‘‹2). We define (î‰„â€²,ğ›¼â€²,îˆ¾â€²,ğ›½â€²)=ğ–¼ğ—…ğ–ºğ—Œğ—(îˆ¿,ğ¶) as follows:

î‰„â€²={ğ‘‹1âˆªğ¶}âˆªâ‹ƒğ‘‹âˆˆî‰„âˆ–{ğ‘‹1}{ğ–¼ğ–¼ğº(ğ‘‹âˆ–ğ¶,ğ›¼âˆ’1(ğ‘‹))} (notice that ğ›¼âˆ’1(ğ‘‹)âŠ†ğ‘‹âˆ–ğ¶, for every ğ‘‹âˆˆî‰„, because of property (A) of îˆ­-normality),

for each ğ‘Šâˆˆî‰ƒ, ğ›¼â€²(ğ‘Š)=ğ‘‹â€² where ğ‘‹â€² is the unique set of î‰„â€² such that ğ‘ŠâŠ†ğ‘‹â€²,

îˆ¾â€²=îˆ¾âˆ–{ğ‘ƒ}âˆª{ğ‘ƒâ€²}, where ğ‘ƒâ€²=ğ‘ƒ1âˆªğ‘ƒâˆ—âˆªğ‘ƒ2 is defined as follows: let ğ‘ ğ‘– be the first vertex of C that we meet while traversing P when starting from its endpoint that belongs in ğ‘Šğ‘– and let ğ‘ƒğ‘– the subpath of P that we traversed that way, for ğ‘–âˆˆ{1,2}. We define ğ‘ƒâˆ— by taking any path between ğ‘ 1 and ğ‘ 2 inside G[C], and

ğ›½â€²=ğ›½âˆ–{({ğ‘Š1,ğ‘Š2},ğ‘ƒ)}âˆª{{ğ‘Š1,ğ‘Š2},ğ‘ƒâ€²}.

3:
The annex procedure applies when C intersects no freeway of îˆ¿ and touches some country ğ‘‹âˆˆî‰„. We define (î‰„â€²,ğ›¼â€²,îˆ¾â€²,ğ›½â€²)=ğ–ºğ—‡ğ–¾ğ—‘(îˆ¿,ğ¶) such that

î‰„â€²={ğ‘‹1âˆªğ¶}âˆªâ‹ƒğ‘‹âˆˆî‰„âˆ–{ğ‘‹1}{ğ–¼ğ–¼ğº(ğ‘‹âˆ–ğ¶,ğ›¼âˆ’1(ğ‘‹))} (notice that ğ›¼âˆ’1(ğ‘‹)âŠ†ğ‘‹âˆ–ğ¶, for every ğ‘‹âˆˆî‰„, because of property (A) of îˆ­-normality),

for each ğ‘Šâˆˆî‰ƒ, ğ›¼â€²(ğ‘Š)=ğ‘‹â€² where ğ‘‹â€² is the unique set of î‰„â€² such that ğ‘ŠâŠ†ğ‘‹â€²,

îˆ¾â€²=îˆ¾, and ğ›½â€²=ğ›½.

Claim 33
Let îˆ¿=(î‰„,ğ›¼,îˆ¾,ğ›½) be an îˆ­-normal Î›-state configuration of G, and ğ¶âˆˆğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿). Let îˆ¿â€²=ğ–ºğ–¼ğ—ğ—‚ğ—ˆğ—‡(îˆ¿,ğ¶) where ğ–ºğ–¼ğ—ğ—‚ğ—ˆğ—‡âˆˆ{ğ–¾ğ—‘ğ—‰ğ–ºğ—‡ğ–½,ğ–¼ğ—…ğ–ºğ—Œğ—,ğ–ºğ—‡ğ–¾ğ—‘}. Then îˆ¿â€² is an îˆ­-normal Î›-state configuration of G where ğ–¼ğ—ˆğ—Œğ—(îˆ¿â€²,îˆ­)â‰¤ğ–¼ğ—ˆğ—Œğ—(îˆ¿,îˆ­). Moreover, if ğ–¼ğ—ˆğ—îˆ¿(ğ¶)â‰¥1, then ğ–¼ğ—ˆğ—Œğ—(îˆ¿â€²,îˆ­)<ğ–¼ğ—ˆğ—Œğ—(îˆ¿,îˆ­) and if ğ–¼ğ—ˆğ—îˆ¿(ğ¶)=0 (which may be the case only when ğ–ºğ–¼ğ—ğ—‚ğ—ˆğ—‡=ğ–ºğ—‡ğ–¾ğ—‘), then |ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿â€²)|<|ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)|.

Proof of Claim 33
We first show that îˆ¿â€² is an îˆ­-normal Î›-state configuration of G. In each case, the construction of îˆ¿â€² makes sure that î‰„â€² is a connected packing of G and that the countries are updated in a way that their capitals remain inside them. Moreover, the highways are updated so to remain internally disjoint and inside the corresponding updated countries. We next prove that îˆ¿â€² is îˆ­-normal. Condition (A) is invariant as the cloud we take into consideration cannot intersect any ğ‘Šâˆˆî‰ƒ and a cloud intersecting some capital ğ‘Šâˆˆî‰ƒ cannot be disconnected from W. It now remains to prove condition (B). Because of Condition 4 of the definition of a Î›-state configuration, if a cloud C intersects a freeway, then it shadows at least one state. Now assume that a cloud C intersects two freeways in îˆ¿â€², then by construction of îˆ¿â€², it also intersects at least the two same freeways in îˆ¿. This along with the fact that îˆ¿ satisfies Condition (B), implies that îˆ¿â€² satisfies condition (B) as well, as required.

Notice that, for any cloud ğ¶âˆ—âˆˆîˆ­âˆ–{ğ¶}, if ğ¶âˆ— does not intersect a state X in îˆ¿, then the corresponding state ğ‘‹â€² in îˆ¿â€², i.e., the state ğ‘‹â€²=ğ›¼â€²(ğ›¼âˆ’1(ğ‘‹)), also does not intersect ğ¶âˆ—. This means that ğ–¼ğ—ˆğ—Œğ—(îˆ¿â€²,îˆ­)â‰¤ğ–¼ğ—ˆğ—Œğ—(îˆ¿,îˆ­).

Notice now that by the construction of îˆ¿â€², C is not in ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿â€²). In the case where ğ–¼ğ—ˆğ—îˆ¿(ğ¶)â‰¥1 we have that ğ–¼ğ—ˆğ—Œğ—(îˆ¿â€²,îˆ­)<ğ–¼ğ—ˆğ—Œğ—(îˆ¿,îˆ­).

Notice that the case where ğ–¼ğ—ˆğ—îˆ¿(ğ¶)=0 happens only when ğ–ºğ–¼ğ—ğ—‚ğ—ˆğ—‡=ğ–ºğ—‡ğ–¾ğ—‘ and there is an edge with one endpoint in C and one in some country ğ‘‹âˆ— of îˆ¿ that does not intersect C. Moreover ğ–¼ğ–¼ğº(ğ‘‹âˆ–ğ¶,ğ›¼âˆ’1(ğ‘‹))=ğ‘‹, for every state X of îˆ¿. This implies that ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿â€²)âŠ†ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿). As ğ¶âŠ†ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿) and ğ¶âˆ©ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿â€²)=âˆ…, we conclude that |ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿â€²)|<|ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)| as required. â—»

To continue with the proof of Lemma 31 we explain how to transform the îˆ­-normal Î›-state configuration îˆ¿ of G to a complete one. This is done in two phases. First, as long as there is an îˆ­-cloud ğ¶âˆˆğ–¿ğ—‹ğ—ˆğ—‡ğ—(îˆ¿) where ğ–¼ğ—ˆğ—îˆ¿(ğ¶)â‰¥1, we apply one of the above three procedures depending on the number of freeways intersected by C. We again use îˆ¿ to denote the îˆ­-normal Î›-state configuration of G that is created in the end of this first phase. Notice that, as there is no îˆ­-cloud with ğ–¼ğ—ˆğ—îˆ¿(ğ¶)â‰¥1, then ğ–¼ğ—ˆğ—Œğ—îˆ­(îˆ¿)=0. The second phase is the application of ğ–ºğ—‡ğ–¾ğ—‘(îˆ¿,ğ¶), as long as some ğ¶âˆˆğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿) is touching some of the countries of îˆ¿. We claim that this procedure will be applied as long as there are vertices in ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿). Indeed, if this is the case, the set ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿) is non-empty and by the connectivity of G, there is always a ğ¶âˆˆğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿) that is touching some country of îˆ¿. Therefore, as ğ–¼ğ—ˆğ—Œğ—îˆ­(îˆ¿)=0 (by Claim 33), procedure ğ–ºğ—‡ğ–¾ğ—‘(îˆ¿,ğ¶) will be applied again.

By Claim 33, |ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)| is strictly decreasing during the second phase. We again use îˆ¿ for the final outcome of this second phase. We have that ğ—‚ğ—‡ğ–½ğ–¾ğ—‰(îˆ¿)=âˆ… and we conclude that îˆ¿ is a complete îˆ­-normal Î›-state configuration of G such that |ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿)|=0.

We are now going to create a graph isomorphic to Î› only by doing contractions in G. For this we use îˆ¿, a complete îˆ­-normal Î›-state configuration of G such that |ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿)|=0, obtained as describe before. We contract in G every country of îˆ¿ into a unique vertex. This can be done because the countries of îˆ¿ are connected. Let ğºâ€² be the resulting graph. By construction of îˆ¿, ğºâ€² is a contraction of H. Because of Condition 4 of Î›-state configuration, every freeway of îˆ¿ becomes an edge in ğºâ€². This implies that there is a graph isomorphic to Î› that is a subgraph of ğºâ€². So Î“Ì‚ ğ‘˜â€² is isomorphic to a subgraph of ğºâ€² with the same number of vertices. Let see Î“Ì‚ ğ‘˜â€² as a subgraph of ğºâ€² and let e be an edge of ğºâ€² that is not an edge of Î“Ì‚ ğ‘˜â€². As e is an edge of ğºâ€², this implies that in G, there is two states of îˆ¿ such that there is no freeway between them but still an edge. This is not possible by construction of îˆ¿. We deduce that ğºâ€² is isomorphic to Î“Ì‚ ğ‘˜â€². Moreover, as |ğ–¿ğ—‹ğ—ˆğ—‡ğ—îˆ­(îˆ¿)|=0, then every cloud is a subset of a country. This implies that ğºâ€² is also a contraction of H. By contracting in ğºâ€² the edge corresponding to {ğ‘,(ğ‘˜â€²âˆ’1,ğ‘˜â€²âˆ’1)} in Î“Ì‚ ğ‘˜â€², we obtain that Î“ğ‘˜â€² is a contraction of H. Lemma 31 follows.

Proof of Theorem 15
Let ğœ†, c, ğ‘1, and ğ‘2 be integers. It is enough to prove that there exists an integer ğœ†â€²=îˆ»(ğœ†â‹…ğ‘1â‹…(ğ‘2)ğ‘) such that for every graph class îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘),

âˆ€ğºâˆˆîˆ³&ğ—ğ—(ğº)â‰¤ğœ†â‹…(ğ›ğœğ (ğº))ğ‘âˆ€ğ¹âˆˆîˆ³(ğ‘1,ğ‘2)&ğ—ğ—(ğ¹)â‰¤ğœ†â€²â‹…(ğ›ğœğ (ğ¹))ğ‘.â‡’
Let îˆ³âˆˆğš‚ğš€ğ™¶ğ‚(ğ‘) be a class of graph such that âˆ€ğºâˆˆîˆ³  ğ—ğ—(ğº)â‰¤ğœ†â‹…(ğ›ğœğ (ğº))ğ‘. Let ğ»âˆˆîˆ³(ğ‘1,ğ‘2) and let G and J be two graphs such that ğºâˆˆîˆ³, ğºâ‰¤(ğ‘1)ğ½, and ğ»â‰¤ğ‘2ğ½. G and J exist by definition of îˆ³(ğ‘1,ğ‘2).

By definition of H and J, ğ—ğ—(ğ»)â‰¤ğ—ğ—(ğ½).

By Lemma 19, ğ—ğ—(ğ½)â‰¤(ğ‘1+1)(ğ—ğ—(ğº)+1)âˆ’1.

By definition of îˆ³, ğ—ğ—(ğº)â‰¤ğœ†â‹…ğ›ğœğ (ğº)ğ‘.

By Lemma 31, ğ›ğœğ (ğº)â‰¤(2ğ‘2+1)(ğ›ğœğ (ğ»)+2)+1.

If we combine these four statements, we obtain that

ğ—ğ—(ğ»)â‰¤(ğ‘1+1)(ğœ†â‹…[(2ğ‘2+1)(ğ›ğœğ (ğ»)+2)+1]ğ‘+1)âˆ’1.
As the formula is independent of the graph class, the Theorem 15 follows. â—»

Conclusions, Extensions, and Open Problems
The main combinatorial result of this paper is that, for every d and every apex-minor-free graph class îˆ³, the intersection class ğ—‚ğ—‡ğ—ğ–¾ğ—‹ğ‘‘(îˆ³) has the SQGC property for ğ‘=1. Certainly, the main general question is to detect even wider graph classes with the SQGM/SQGC property. In this direction, some insisting open issues are the following:

Is the bound on the (multi-)degree necessary? Are there classes of intersection graphs with unbounded or â€œalmost boundedâ€ maximum degree that have the SQGM/SQGC property?

All so far known results classify graph classes in SQGM(1) or SQGC(1). Are there (interesting) graph classes in ğš‚ğš€ğ™¶ğŒ(ğ‘) or ğš‚ğš€ğ™¶ğ‚(ğ‘) for some 1<ğ‘<2 that do not belong in ğš‚ğš€ğ™¶ğŒ(1) or ğš‚ğš€ğ™¶ğ‚(1) respectively? An easy (but trivial) example of such a class is the class îˆ½ğ‘‘ of the q-dimensional grids, i.e., the cartesian products of ğ‘â‰¥2 equal length paths. It is easy to see that the maximum k for which an n-vertex graph ğºâˆˆîˆ½ğ‘ contains a (ğ‘˜Ã—ğ‘˜)-grid as a minor is ğ‘˜=Î˜(ğ‘›12). On the other size, it can also be proven that ğ—ğ—(ğº)=Î˜(ğ‘›ğ‘âˆ’1ğ‘). These two facts together imply that îˆ½ğ‘âˆˆğš‚ğš€ğ™¶ğŒ(2âˆ’2ğ‘) while îˆ½ğ‘âˆ‰ğš‚ğš€ğ™¶ğŒ(2âˆ’2ğ‘âˆ’ğœ–) for every ğœ–>0.

Usually the graph classes in ğš‚ğš€ğ™¶ğ‚(1) are characterised by some â€œflatnessâ€ property. For instance, see the results in [31, 34, 34] for H-minor free graphs, where H is an apex graph. Can ğš‚ğš€ğ™¶ğ‚(1) be useful as an intuitive definition of the â€œflatnessâ€ concept? Does this have some geometric interpretation?

