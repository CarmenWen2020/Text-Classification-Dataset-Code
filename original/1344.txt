We study a security game over a network played between a defender and k attackers. Every attacker chooses, probabilistically, a node of the network to damage. The defender chooses, probabilistically as well, a connected induced subgraph of the network of ğœ† nodes to scan and clean. Each attacker wishes to maximize the probability of escaping her cleaning by the defender. On the other hand, the goal of the defender is to maximize the expected number of attackers that she catches. This game is a generalization of the model from the seminal paper of Mavronicolas et al. Mavronicolas et al. (in: International symposium on mathematical foundations of computer science, MFCS, pp 717â€“728, 2006). We are interested in Nash equilibria of this game, as well as in characterizing defense-optimal networks which allow for the best equilibrium defense ratio; this is the ratio of k over the expected number of attackers that the defender catches in equilibrium. We provide a characterization of the Nash equilibria of this game and defense-optimal networks. The equilibrium characterizations allow us to show that even if the attackers are centrally controlled the equilibria of the game remain the same. In addition, we give an algorithm for computing Nash equilibria. Our algorithm requires exponential time in the worst case, but it is polynomial-time for ğœ† constantly close to 1 or n. For the special case of tree-networks, we further refine our characterization which allows us to derive a polynomial-time algorithm for deciding whether a tree is defense-optimal and if this is the case it computes a defense-optimal Nash equilibrium. On the other hand, we prove that it is ğ™½ğ™¿-hard to find a best-defense strategy if the tree is not defense-optimal. We complement this negative result with a polynomial-time constant-approximation algorithm that computes solutions that are close to optimal ones for general graphs. Finally, we provide asymptotically (almost) tight bounds for the Price of Defense for any ğœ†; this is the worst equilibrium defense ratio over all graphs.

Introduction
With technology becoming a ubiquitous and integral part of our lives, we find ourselves using several different types of computer networks. An important issue when dealing with such networks, which are often prone to security breaches [6], is to prevent and monitor unauthorized access and misuse of the network or its accessible resources. Therefore, the study of network security has attracted a lot of attention over the years [18]. Unfortunately, such breaches are often inevitable, since some parts of a large system are expected to have weaknesses that expose them to security attacks; history has indeed shown several successful and highly-publicized such incidents [17]. Therefore, the challenge for someone trying to keep those systems and networks of computers secure is to counteract these attacks as efficiently as possible, once they occur.

To that end, inventing and studying appropriate theoretical models that capture the essence of the problem is an important line of research, ongoing for a few years now [13, 14]. Here, extending some known models for very simple cases of attacks and defenses [11, 12], we introduce and analyze a more general model for a scenario of network attacks and defenses modeling it as a defense game.

The Network Security Game
We follow the terminology established by the seminal paper of Mavronicolas et al. [11]. We consider a network whose nodes are vulnerable to infection by threats called attackers; think of those as viruses, worms, Trojan horses or eavesdroppers [7] infecting the components of a computer network. Available to the network is a security software (or firewall), called the defender. The defender is only able to â€œcleanâ€ a limited part of the network from threats that occur; the reason for the limited cleaning capacity of the defender may be, for example, the cost of purchasing a global security software. The defender seeks to protect the network as much as possible, and on the other hand, every attacker seeks to increase the likelihood of not being caught. Both the attackers and the defender make individual decisions for their positioning in the network with the aim to maximize their own objectives.

Every attacker targets (and attacks) a node chosen via her own probability distribution over the nodes of the network. The defender cleans a connected induced subgraph of the network with size ğœ†, chosen via her own probability distribution over all connected induced subgraphs of the graph with ğœ† nodes. The attack of a particular attacker is successful unless the node chosen by the attacker is incident to an edge (link) being cleaned by the defender, i.e. to an edge belonging in the induced subgraph chosen by the defender. One could equivalently think of the defender selecting a set of ğœ† connected nodes to defend, and an attacker is successful if and only if she attacks a node that is not being defended. Since attacks and defenses over a large computer network are self-interested procedures that seek to maximize damage and protection, respectively, it is natural to model this network security scenario as a non-cooperative strategic game on graphs with two kinds of players: ğ‘˜â‰¥1 attackers, each playing a vertex of the graph, and a single defender playing a connected induced subgraph of the graph. The (expected) payoff of an attacker is the probability that she is not caught by the defender; the (expected) payoff of the defender is the (expected) number of attackers she catches. We are interested in the Nash equilibria [15, 16] associated with this graph theoretic game, where no player can unilaterally improve her (expected) payoff by switching to another probability distribution. We are also interested in understanding and characterizing the networks that allow for a good defense ratio: given a strategy profile, i.e. a combination of strategies for the network entities (attackers and defender), the defense ratio of a network is the ratio of the total number of attackers over the defenderâ€™s expected payoff in that strategy profile.

Our Results
In this work we depart from and significantly extend the line of work of Mavronicolas et al. in their seminal paper [11] on defense games in graphs; we term the type of games we consider Connected Subgraph Defense (CSD) games. In our model the defender is more powerful than in [11,12,13,14], since her power is parameterized by the size, ğœ†, of the defended part of the network. We allow ğœ† to take values from 1 to n, while in [11,12,13,14] only the case where ğœ†=2 was studied. We study many questions related to CSD games. We extend the notions of defense ratio and defense-optimal graphs for CSD games. In fact, the defense ratio of a given graph G and a given strategy profile S of the attackers and the defender is the ratio of the number of attackers, k, over the defenderâ€™s expected payoff (the number of attackers she catches on expectation). We thoroughly investigate the notion of the defense ratio for Nash equilibria strategy profiles.

Firstly, we precisely characterize the Nash equilibria and defense-optimal graphs in CSD games. This allows us to show that, in equilibrium, the game version of k uncoordinated attackers and a single defender is equivalent to the version in which a single leader coordinates the k attackers; meaning that both versions of the game have the exact same equilibria and defense ratio. We present an LP-based algorithm to compute an exact equilibrium of any given CSD game, whose running time is polynomial in (ğ‘›ğœ†). Then, we focus on tree-graphs. There, we further refine our equilibrium characterization which allows us to derive a polynomial-time algorithm for deciding whether a tree is defense-optimal and, if this is the case, it computes a defense-optimal Nash equilibrium. A tree is defense-optimal if and only if it can be partitioned into ğ‘›ğœ† disjoint sub-trees. On the other hand, we prove that it is ğ™½ğ™¿-hard to find a best-defense strategy if the tree is not defense-optimal.

We remark that a very crucial parameter for defense-optimality of a graph G is the â€œbestâ€ probability with which any vertex of G is defended in a NE; we call that probability MaxMin probability and denote it by ğ‘âˆ—(ğº). Then, for any graph G, the defense ratio in equilibrium is shown to be exactly 1ğ‘âˆ—(ğº). Although it is hard to exactly compute ğ‘âˆ—(ğº) even for trees, we complement this negative result with a polynomial-time constant-approximation algorithm that computes solutions that are close to the optimal ones for any ğœ†, for any given general graph. In particular, we approximate the (best) defense ratio of any graph within a factor of 2+ğœ†âˆ’3ğ‘›. Finally, we provide asymptotically tight bounds for the Price of Defense for any ğœ†âˆˆğœ”(1)âˆ©ğ‘œ(ğ‘›), and almost tight bounds for any other value of ğœ†.

Related Work
Our graph-theoretic game is a direct generalization of the defense game considered by Mavronicolas et al. [11,12,13,14].

In the latter, the authors examined the case where the size of the defended part of the network is ğœ†=2, i.e. where the defender â€œcleansâ€ an edge. This leads to a nice connection between equilibria and (fractional) matchings in the graph [13]. But when ğœ† is greater than 2, one has to investigate (as we shall see here) how to sparsely cover the graph by as small a number as possible of connected induced subgraphs of size ğœ†. This direction can be seen as an extension of fractional matchings that cover the graph by equisized connected subgraphs. Sparse covering of graphs by connected induced subgraphs (clusters), not necessarily equisized, is a notion known to be useful also for distributed algorithms, since it affects message communication complexity [5].

In another line of work, Kearns and Ortiz [9] study Interdependent Security games in which a large number of players must make individual decisions regarding security. Each playerâ€™s safety may depend on the actions of the entire population (in a complex way). The graph-theoretic game that we consider could be seen as a particular instance of such games with some sort of limited interdependence: the actions of the defender and an attacker are interdependent, while the actions of the attackers are not dependent on each other.

Aspnes et al. [4] consider a graph-theoretic game that models containment of the spread of viruses on a network; each node individually must choose to either install anti-virus software at some cost, or risk infection if a virus reaches it without being stopped by some intermediate node with installed anti-virus software. Aspnes et al. [4] prove several algorithmic properties for their graph-theoretic game and establish connections to a certain graph-theoretic problem called Sum-of-Squares Partition.

A game on a weighted graph with two players, the tree player and the edge player, was studied by Alon et al. [2]. At each play, the tree player chooses a spanning tree and the edge player chooses an edge of the graph, and the payoffs of the players depend on whether the chosen edge belongs in the spanning tree. Alon et al. investigate the theoretical aspects of the above game and its connections to the k-server problem and network design.

Finally, there is a long line of work on security games [3] where many scenarios are modelled using graph theoretic problems [8, 10, 19, 20].

Preliminaries
The game
A Connected Subgraph Defense (CSD) game is defined by a graph ğº=(ğ‘‰,ğ¸), a defender, ğ‘˜â‰¥1 attackers, and a positive integer ğœ†. Throughout the paper, ğœ† is considered to be a given parameter of the game. A pure strategy for the defender is any induced connected subgraph H of G with ğœ† vertices, which we term ğœ†-subgraph. For any ğœ†-subgraph H of G we denote V(H) its set of vertices. Since V(H) uniquely defines an induced subgraph of G, we will use the term ğœ†-subgraph to denote either V(H) or H. The action set of the defender is ğ·:={ğ‘‰(ğ»)|ğ» is a ğœ†-subgraph of ğº} and we will denote its cardinality by ğœƒ, i.e. ğœƒ:=|ğ·|. For ease of presentation, we will also refer to D as [ğœƒ]:={1,2,â€¦,ğœƒ}. A pure strategy for each of the attackers is any vertex of G. So, the action set of every attacker is V, the vertex set of G; we denote ğ‘›:=|ğ‘‰| and we similarly refer to V also as [n].

To play the game, the defender chooses a defense (mixed) strategy, i.e. a probability distribution over her action set, and each attacker chooses an attack (mixed) strategy, i.e. a probability distribution over the vertices of G. We denote a strategy by ğ‘ :=(ğ‘ 1,â€¦,ğ‘ ğ‘‘)âˆˆğ›¥ğ‘‘, i.e. by the probability distribution over d enumerated pure strategies, where ğ›¥ğ‘‘:={ğ‘¥1,â€¦,ğ‘¥ğ‘‘â‰¥0|âˆ‘ğ‘‘ğ‘–=1ğ‘¥ğ‘–=1} is the (ğ‘‘âˆ’1)-unit simplex. In a defense strategy ğ‘âˆˆğ›¥ğœƒ, each pure strategy ğ‘—âˆˆ[ğœƒ] is assigned a probability ğ‘ğ‘—.

We say that a pure strategy of the defender, i.e. a specific ğœ†-subgraph H of G, covers a vertex ğ‘£âˆˆğ‘‰, if ğ‘£âˆˆğ‘‰(ğ»). A defense strategy covers a vertex ğ‘£âˆˆğ‘‰ if it assigns strictly positive probability to at least one ğœ†-subgraph H of G which contains v.

Definition 1
(vertex-probability) The vertex-probability ğ‘ğ‘– of vertex ğ‘–âˆˆ[ğ‘›], is the probability that i will be covered, formally  ğ‘ğ‘–:=âˆ‘ğ‘—âˆˆ[ğœƒ]:ğ‘–âˆˆğ‘—ğ‘ğ‘—.

Payoffs and Strategy profiles. A strategy profile is a tuple of strategies ğ‘†=(ğ‘,ğ‘¡1,â€¦,ğ‘¡ğ‘˜), where q denotes the defenderâ€™s strategy and ğ‘¡ğ‘— denotes the j-th attackerâ€™s strategy, ğ‘—âˆˆ[ğ‘˜]. A strategy profile is pure if the support of every strategy has size one. The payoff of every attacker is 1 in any pure strategy profile where she does not choose a defended vertex, and 0 in all the rest. The payoff of the defender in a pure strategy profile where she defends V(H), is the number of attackers that choose a vertex in V(H). Under a strategy profile, the expected payoff of the defender is the expected number of attackers that she catches, which we call defense value, and the expected payoff of the attacker is the probability that she will not get caught. A best response strategy for a participant is a strategy that maximizes her expected payoff, given that the strategies of the rest of the participants are fixed. A Nash equilibrium is a strategy profile where all the participants are playing a best response strategy. In other words, neither the defender nor any of the attackers can increase their expected payoff by unilaterally changing their strategy.

Definition 2
(Defense ratio) For a given graph G we define a measure of the quality of a strategy profile S, called defense ratio of G and denoted DR(ğº,ğ‘†), as the ratio of the total number of attackers k over the defense value.

In this work we are only interested in the cases where S is an equilibrium. For a given graph, when in equilibrium, the defenderâ€™s expected payoff is unique (due to Corollary 1 (a)) and achieves the equilibrium defense ratio DR(ğº,ğ‘†âˆ—), where ğ‘†âˆ— is an equilibrium. The defense strategy in ğ‘†âˆ— which achieves this defense ratio will be termed best-defense strategy.

Definition 3
(MaxMin probability, ğ‘âˆ—) We call MaxMin Probability of a graph G the maximum, over all defense strategies, minimum vertex-probability in G, that is:

ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒminğ‘–âˆˆ[ğ‘›]ğ‘ğ‘–.
As we will show in Lemma 1, the equilibrium defense ratio of a graph G turns out to be DR(ğº,ğ‘†âˆ—)=1/ğ‘âˆ—(ğº).

Definition 4
(Price of defense) The Price of Defense, PoD, for a given parameter ğœ† of the game, is the worst defense ratio, over all graphs on n vertices, achievable in equilibrium, that is:

PoD(ğœ†)=supğºDR(ğº,ğ‘†âˆ—).
Definition 5
(Defense-optimal graph) For a given ğœ†, a graph ğºâˆ— that achieves the minimum equilibrium defense ratio over all graphs on n vertices, i.e. ğºâˆ—âˆˆ{ğºâ€² | |ğ‘‰(ğºâ€²)|=ğ‘›,DR(ğºâ€²,ğ‘†âˆ—)â‰¤DR(ğºâ€³,ğ‘†âˆ—), for all ğºâ€³ with |ğ‘‰(ğºâ€³)|=ğ‘›}, is called defense-optimal graph.

In the following, for ease of presentation, whenever we refer to defense optimality, we implicitly assume that ğœ† has a fixed value.

Nash Equilibria
In this section, we provide a characterization of Nash equilibria in CSD games, as well as important properties of their structure, which turn out to be useful for the development of our algorithms in the remainder of the paper.

Theorem 1
(Equilibrium characterization) For a given graph G, in any equilibrium with support ğ‘†âŠ†[ğœƒ] of the defender and support ğ‘‡ğ‘—âŠ†[ğ‘›] of each attacker ğ‘—âˆˆ[ğ‘˜], the following conditions are necessary and sufficient:

1.
minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– is maximized over all defense strategies, and

2.
â‹ƒğ‘—âˆˆ[ğ‘˜]ğ‘‡ğ‘—âŠ†ğ‘‰âˆ—, where ğ‘‰âˆ—:={ğ‘–|minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– is maximized over all defense strategies}, and

3.
every ğ‘ âˆˆğ‘† has the maximum expected total number of attackers on its vertices over all pure strategies.

Proof
First we will prove that the conditions in the statement of the theorem hold in equilibrium, i.e. equilibrium is sufficient for the conditions to hold.

Condition 1 By definition, in an equilibrium, the defender and each attacker have chosen a best response. Suppose that the defender has chosen some strategy ğ‘=(ğ‘1,ğ‘2,â€¦,ğ‘ğœƒ) over her action set [ğœƒ]; we will consider this strategy to be a vector variable for now. Given q, each vertex ğ‘–âˆˆ[ğ‘›] has a vertex-probability ğ‘ğ‘–. Now consider the minimum vertex-probability ğ‘â€²:=minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘–, and the set ğ‘‰â€²âŠ†ğ‘‰ consisting of the vertices with vertex-probability ğ‘â€², i.e. ğ‘‰â€²:={ğ‘–âˆˆğ‘‰ | ğ‘ğ‘–=ğ‘â€²}. Since an attacker plays a best response, her support will be a subset of ğ‘‰â€²; otherwise, if she assigns probability ğ‘¡ğ‘£>0 on a vertex ğ‘£âˆ‰ğ‘‰â€² (with ğ‘ğ‘£>ğ‘â€²) her expected payoff (see quantity (2)) can be strictly increased by choosing to move all of ğ‘¡ğ‘£ to another vertex ğ‘¢âˆˆğ‘‰â€², thus increasing her expected payoff by ğ‘¡ğ‘¢â‹…(ğ‘ğ‘£âˆ’ğ‘â€²). Therefore, every attackerâ€™s support will be a subset of ğ‘‰â€².

We will denote by ğ‘¡ğ‘—ğ‘– the probability that the strategy of attacker ğ‘—âˆˆ[ğ‘˜] has assigned to vertex ğ‘–âˆˆ[ğ‘›]. The expected payoff of the defender is:

âˆ‘ğ‘–âˆˆ[ğ‘›](ğ‘ğ‘–âˆ‘ğ‘—âˆˆ[ğ‘˜]ğ‘¡ğ‘—ğ‘–).
(1)
Since as we argued above, in an equilibrium, each attackerâ€™s strategy has support that is a subset of ğ‘‰â€², the expected payoff of the defender will be

âˆ‘ğ‘–âˆˆğ‘‰â€²(ğ‘ğ‘–âˆ‘ğ‘—âˆˆ[ğ‘˜]ğ‘¡ğ‘—ğ‘–)+âˆ‘ğ‘–âˆˆğ‘‰âˆ–ğ‘‰â€²(ğ‘ğ‘–âˆ‘ğ‘—âˆˆ[ğ‘˜]ğ‘¡ğ‘—ğ‘–)=ğ‘â€²â‹…âˆ‘ğ‘–âˆˆğ‘‰â€²(âˆ‘ğ‘—âˆˆ[ğ‘˜]ğ‘¡ğ‘—ğ‘–)=ğ‘â€²â‹…âˆ‘ğ‘—âˆˆ[ğ‘˜]â›ââœâœâˆ‘ğ‘–âˆˆğ‘‰â€²ğ‘¡ğ‘—ğ‘–ââ âŸâŸ=ğ‘â€²â‹…ğ‘˜,
where the first equality is due to the fact that ğ‘ğ‘–=ğ‘â€², âˆ€ğ‘–âˆˆğ‘‰â€² and ğ‘¡ğ‘—ğ‘–=0, âˆ€ğ‘–âˆˆğ‘‰âˆ–ğ‘‰â€², and the last equality is due to the fact that the support of any strategy ğ‘¡ğ‘—=(ğ‘¡ğ‘—1,â€¦,ğ‘¡ğ‘—ğ‘–) of an attacker ğ‘—âˆˆ[ğ‘˜] is a subset of ğ‘‰â€². It is important to note here that the entire probability mass of each of the attackers is placed on vertices with minimum vertex-probability ğ‘â€². So, according to the definition of the defenderâ€™s expected payoff, i.e., the expected number of attackers that are caught by the defender, this will be equal to ğ‘â€²â‹…ğ‘˜. Furthermore, in an equilibrium, the defender also plays a best response, i.e. she maximizes her expected payoff. Thus, given the above quantity, the defender in an equilibrium has expected payoff maxğ‘âˆˆğ›¥ğœƒğ‘â€²â‹…ğ‘˜, and Condition 1 of the theoremâ€™s statement is satisfied.

Condition 2 The proof is by contradiction. Assume an equilibrium profile where the defender has strategy ğ‘=(ğ‘1,â€¦,ğ‘ğœƒ) and there is an attacker, a, with strategy ğ‘¡=(ğ‘¡1,â€¦,ğ‘¡ğ‘›) whose support includes vertex ğ‘£âˆˆ[ğ‘›] with ğ‘ğ‘£>ğ‘â€², where ğ‘â€²:=minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘–. Then aâ€™s expected payoff is

âˆ‘ğ‘–âˆˆğ‘‰âˆ–{ğ‘£}ğ‘¡ğ‘–(1âˆ’ğ‘ğ‘–)+ğ‘¡ğ‘£(1âˆ’ğ‘ğ‘£).
(2)
However, a can increase her expected payoff by moving all her probability ğ‘¡ğ‘£ to a vertex ğ‘£â€² for which ğ‘ğ‘£â€²=ğ‘â€², which contradicts the equilibrium assumption.

Condition 3 The proof is by contradiction. Suppose that in an equilibrium the defender has strategy ğ‘âˆ—âˆˆğ›¥ğœƒ, where supp(ğ‘âˆ—):=ğ‘†. According to Condition 1, this strategy achieves ğ‘âˆ—(ğº). Let us define the set

ğ‘‰âˆ—:={ğ‘–âˆˆ[ğ‘›] | minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– is maximized over all defense strategies}.
We denote by ğ‘ğ‘– the random variable that indicates the number of attackers on vertex ğ‘–âˆˆ[ğ‘›], under the strategy profile determined by the strategy of the defender and each attacker. The expected payoff of the defender according to Eq. (1) is âˆ‘ğ‘–âˆˆ[ğ‘›](ğ‘ğ‘–â‹…ğ”¼[ğ‘ğ‘–]). Since, as argued above, in an equilibrium each attacker has support in ğ‘‰âˆ—, the defenderâ€™s expected payoff is in fact ğ‘âˆ—â‹…âˆ‘ğ‘–âˆˆğ‘‰âˆ—ğ”¼[ğ‘ğ‘–].

For the sake of contradiction, suppose that for the expected total number of attackers on two different pure defense strategies ğ‘ 1âˆˆğ‘† and ğ‘ 2âˆˆ[ğœƒ] it holds that ğ”¼[âˆ‘ğ‘–âˆˆğ‘ 1ğ‘ğ‘–]<ğ”¼[âˆ‘ğ‘—âˆˆğ‘ 2ğ‘ğ‘—], and equivalently ğ”¼[âˆ‘ğ‘–âˆˆğ‘ 1âˆ–ğ‘ 2ğ‘ğ‘–]<ğ”¼[âˆ‘ğ‘—âˆˆğ‘ 2âˆ–ğ‘ 1ğ‘ğ‘—]. Then, the expected payoff of the defender can be strictly increased if she chooses a strategy ğ‘â€²=(ğ‘â€²1,â€¦,ğ‘â€²ğœƒ) where ğ‘â€²ğ‘ 1=0 and ğ‘â€²ğ‘ 2=ğ‘âˆ—ğ‘ 2+ğ‘âˆ—ğ‘ 1. In particular, when the defender plays ğ‘âˆ— her expected payoff is

ğ‘ˆâˆ—=ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘–âˆˆğ‘‰âˆ–(ğ‘ 1âˆªğ‘ 2)ğ‘ğ‘–â¤â¦â¥â¥+ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘—âˆˆğ‘ 1âˆ©ğ‘ 2ğ‘ğ‘—â¤â¦â¥â¥+ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘™âˆˆğ‘ 2âˆ–ğ‘ 1ğ‘ğ‘™â¤â¦â¥â¥+ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘Ÿâˆˆğ‘ 1âˆ–ğ‘ 2ğ‘ğ‘Ÿâ¤â¦â¥â¥,
whereas when she plays ğ‘â€² it is

ğ‘ˆâ€²=ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘–âˆˆğ‘‰âˆ–(ğ‘ 1âˆªğ‘ 2)ğ‘ğ‘–â¤â¦â¥â¥+ğ‘âˆ—â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘—âˆˆğ‘ 1âˆ©ğ‘ 2ğ‘ğ‘—â¤â¦â¥â¥+(ğ‘âˆ—+ğ‘âˆ—ğ‘ 1)â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘™âˆˆğ‘ 2âˆ–ğ‘ 1ğ‘ğ‘™â¤â¦â¥â¥+(ğ‘âˆ—âˆ’ğ‘âˆ—ğ‘ 1)â‹…ğ”¼â¡â£â¢â¢âˆ‘ğ‘Ÿâˆˆğ‘ 1âˆ–ğ‘ 2ğ‘ğ‘Ÿâ¤â¦â¥â¥=ğ‘ˆâˆ—+ğ‘âˆ—ğ‘ 1â‹…â›ââœâœğ”¼â¡â£â¢â¢âˆ‘ğ‘™âˆˆğ‘ 2âˆ–ğ‘ 1ğ‘ğ‘™â¤â¦â¥â¥âˆ’ğ”¼â¡â£â¢â¢âˆ‘ğ‘Ÿâˆˆğ‘ 1âˆ–ğ‘ 2ğ‘ğ‘Ÿâ¤â¦â¥â¥ââ âŸâŸ>ğ‘ˆâˆ—,
which contradicts the equilibrium assumption. Therefore, for every pure defense strategy ğ‘ 1âˆˆğ‘† it holds that ğ”¼[âˆ‘ğ‘–âˆˆğ‘ 1ğ‘ğ‘–]â‰¥ğ”¼[âˆ‘ğ‘—âˆˆğ‘ 2ğ‘ğ‘—] for every ğ‘ 2âˆˆ[ğœƒ].

Now we will prove that equilibrium is necessary for the three conditions of the statement to hold. Suppose that all conditions hold and ğ‘âˆ—(ğº) is achieved for the defense strategy ğ‘=(ğ‘1,â€¦,ğ‘ğœƒ). We will show that the defender and each attacker play a best response.

Consider an attacker ğ‘—âˆˆ[ğ‘˜] with strategy ğ‘¡=(ğ‘¡1,â€¦,ğ‘¡ğ‘›) and support ğ‘‡ğ‘—âŠ†ğ‘‰âˆ— according to Condition 2. Her expected payoff is

âˆ‘ğ‘–âˆˆğ‘‡ğ‘—ğ‘¡ğ‘–â‹…(1âˆ’ğ‘âˆ—)=1âˆ’ğ‘âˆ—.
It suffices to consider unilateral deviations of j to pure strategies. Any pure strategy ğ‘–â€²âˆˆğ‘‡ğ‘— gives her expected payoff 1âˆ’ğ‘âˆ—, since ğ‘ğ‘–â€²=ğ‘âˆ— (because ğ‘‡ğ‘—âŠ†ğ‘‰âˆ—). Any pure strategy ğ‘–â€²âˆˆğ‘‰âˆ—âˆ–ğ‘‡ğ‘— also gives her expected payoff 1âˆ’ğ‘âˆ— for the same reason. Finally, any pure strategy ğ‘–â€²âˆˆğ‘‰âˆ–ğ‘‰âˆ— gives her expected payoff 1âˆ’ğ‘ğ‘–â€²<1âˆ’ğ‘âˆ— by the definition of ğ‘‰âˆ—. Therefore every attacker plays a best response.

Now consider the defender with strategy ğ‘=(ğ‘1,â€¦,ğ‘ğœƒ) and support ğ‘†âŠ†[ğœƒ]. According to Condition 1 of the theoremâ€™s statement, q results to vertices of G having vertex-probability ğ‘âˆ—. By Condition 3, for any pure defense strategy ğ‘ 1âˆˆğ‘† it holds that ğ”¼[âˆ‘ğ‘–âˆˆğ‘ 1ğ‘ğ‘–]â‰¥ğ”¼[âˆ‘ğ‘—âˆˆğ‘ 2ğ‘ğ‘—] for every ğ‘ 2âˆˆ[ğœƒ], and let us denote ğ‘ğ‘šğ‘ğ‘¥:=ğ”¼[âˆ‘ğ‘–âˆˆğ‘ 1ğ‘ğ‘–]. Now consider a unilateral deviation ğ‘â€²=(ğ‘â€²1,â€¦,ğ‘â€²ğœƒ) of the defender. Her expected payoff is

ğ‘ˆ(ğ‘â€²)=âˆ‘ğ‘—âˆˆ[ğœƒ](ğ‘â€²ğ‘—â‹…ğ”¼[âˆ‘ğ‘–âˆˆğ‘—ğ‘ğ‘–])â‰¤âˆ‘ğ‘—âˆˆ[ğœƒ]ğ‘â€²ğ‘—â‹…ğ‘ğ‘šğ‘ğ‘¥=ğ‘ğ‘šğ‘ğ‘¥=âˆ‘ğ‘—âˆˆğ‘†(ğ‘ğ‘—â‹…ğ”¼[âˆ‘ğ‘–âˆˆğ‘—ğ‘ğ‘–])=ğ‘ˆ(ğ‘),
where the penultimate equation holds due to the fact that âˆ‘ğ‘—âˆˆğ‘†ğ‘ğ‘—=1 and Condition 3. Therefore, q is a best response for the defender, and the three conditions of the theoremâ€™s statement imply a strategy profile that is an equilibrium. â—»

Lemma 1
For any given graph G, the equilibrium defense ratio is DR(ğº,ğ‘†âˆ—)=1ğ‘âˆ—(ğº), where ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒminğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– and ğ‘†âˆ— is an equilibrium.

Proof
By Theorem 1, in an equilibrium, every attacker will have in her support only vertices that are defended with probability exactly ğ‘âˆ—(ğº). Thus, the expected number of attackers the defender catches is ğ‘âˆ—(ğº)â‹…ğ‘˜. By the definition of the defense ratio, DR(ğº,ğ‘†âˆ—)=ğ‘˜ğ‘âˆ—(ğº)â‹…ğ‘˜=1ğ‘âˆ—(ğº). â—»

Corollary 1
The following hold.

(a)
For a given graph G, in any equilibrium, the expected payoff of the defender and each attacker is unique.

(b)
For a given graph G, in any equilibrium with support ğ‘†âŠ†[ğœƒ] of the defender, for every ğ‘ âˆˆğ‘† there exists a vertex ğ‘£âˆˆğ‘  such that ğ‘ğ‘£=ğ‘âˆ—(ğº).

(c)
In any CSD game on a graph G, the problem of finding the equilibrium defense ratio (or equivalently, ğ‘âˆ—(ğº)) for ğ‘˜â‰¥2 attackers, reduces to the same problem in the game with ğ‘˜=1 attacker, which is a two-player constant-sum game.

Proof
   

(a)
By Theorem 1, at any equilibrium the defender chooses a strategy that induces probability ğ‘âˆ—(ğº) to some vertex of G (Condition 1). Also, each of the attackers has in her support T only vertices with vertex-probability ğ‘âˆ—(ğº). Therefore, all attackers attack only such vertices and the expected payoff of the defender is ğ‘˜â‹…ğ‘âˆ—(ğº). Consider also an attacker with strategy ğ‘¡=(ğ‘¡1,ğ‘¡2,â€¦,ğ‘¡ğ‘›). Her expected payoff is âˆ‘ğ‘–âˆˆ[ğ‘›]ğ‘¡ğ‘–â‹…(1âˆ’ğ‘ğ‘–), where ğ‘ğ‘– is the vertex-probability of vertex i. This value is equal to âˆ‘ğ‘–âˆˆğ‘‡ğ‘¡ğ‘–â‹…(1âˆ’ğ‘âˆ—(ğº))=1âˆ’ğ‘âˆ—(ğº). Since ğ‘âˆ—(ğº) is unique for a graph G, the expected payoffs of the defender and each attacker is unique.

(b)
The proof is by contradiction. Consider an equilibrium where the defenderâ€™s strategy is ğ‘âˆˆ[ğœƒ] with support S, and there exists a pure strategy ğ‘ âˆˆğ‘† for which every vertex ğ‘£âˆˆğ‘  has ğ‘ğ‘£>ğ‘âˆ—(ğº). By Condition 2 of Theorem 1, no attacker has in her support a vertex in s. Therefore, the defender can strictly increase her expected payoff by moving all her probability ğ‘ğ‘ >0 from s to some other pure strategy ğ‘ â€² that contains a vertex which is in the support of some attacker.

(c)
Observe that for any given graph G, the quantity ğ‘âˆ—(ğº), by definition, only depends on the graph and not the number of attackers k. That is, ğ‘âˆ—(ğº) is the same for every ğ‘˜â‰¥1. Lemma 1 states that in any equilibrium ğ‘†âˆ—, it is DR(ğº,ğ‘†âˆ—)=1ğ‘âˆ—(ğº), therefore the defense ratio in an equilibrium does not depend on k. This means that when we are given G and we are interested in the equilibrium defense ratio, we might as well consider the game with the single defender and a single attacker. By the definition of the game (see Sect. 2) the latter is a two-player constant-sum game.

â—»

The following corollary implies that coordination (resp. individual selfishness) of the attackers cannot increase the attackersâ€™ (resp. defenderâ€™s) expected payoff in equilibrium.

Corollary 2
Every equilibrium with uncoordinated attackers (i.e. as described in Sect. 2) is an equilibrium with coordinated (i.e. centrally controlled) attackers, and vice versa.

Proof
Let ğ‘âˆ— be a best-defense strategy for the defender. Then, in any best response of any attacker, coordinated or not, every attacker plays only pure strategies that yield maximum payoff against ğ‘âˆ—; i.e. they play only strategies that are defended with probability ğ‘âˆ—(ğº). If this was not the case, either an uncoordinated attacker could increase her payoff by unilaterally changing her strategy, or the â€œcoordinatorâ€ could increase the payoff the attackers collectively get by dictating all the attackers to play vertices that are covered with probability ğ‘âˆ—(ğº).

So, assume that we have an equilibrium in the uncoordinated case. This is an equilibrium for the coordinated case as well: according to Theorem 1, all attackers play vertices that are defended with probability ğ‘âˆ—(ğº) and thus the expected collective payoff of the attackers cannot be increased, and furthermore the expected total number of attackers on the vertices of a pure strategy that is in the support of the defender is maximized over all pure defense strategies, so no unilateral deviation of the defender can increase her expected payoff.

Conversely, in any equilibrium in the coordinated setting, the â€œcoordinatorâ€ dictates all the attackers to attack vertices that are covered with probability ğ‘âˆ—(ğº), satisfying Conditions 1, 2 of Theorem 1. Also in the equilibrium of the coordinated setting, similarly to Condition 3 of Theorem 1, the â€œcoordinatorâ€ will have placed the attackers in a way such that the vertices of any pure defense strategy in the support have maximum expected total number of attackers over all pure defense strategies; otherwise the defender can increase her expected payoff by neglecting a pure strategy with smaller than maximum expected total number of attackers, and move the probability assigned to that pure strategy to another one that has maximum expected total number of attackers. By Theorem 1, this is an equilibrium also for the uncoordinated setting. â—»

The following theorem provides an algorithm for computing an equilibrium for any CSD game, whose running time is polynomial in n when ğœ†=ğ‘ or ğœ†=ğ‘›âˆ’ğ‘, where c is a constant natural number.

Theorem 2
For any given graph G and parameter ğœ†, there is an algorithm that computes ğ‘âˆ—(ğº) and also finds an equilibrium in time polynomial in (ğ‘›ğœ†).

Proof
Given a graph G, the number of attackers ğ‘˜â‰¥1, and some ğœ†âˆˆ{1,2,â€¦,ğ‘›}, the action set D of the defender is constructed by the vertex sets of at most (ğ‘›ğœ†) ğœ†-subgraphs; so for Dâ€™s cardinality ğœƒ it holds that ğœƒâ‰¤(ğ‘›ğœ†). Consider now the mixed strategy ğ‘âˆˆğ›¥ğœƒ of the defender, where each pure strategy ğ‘—âˆˆ[ğœƒ] is assigned probability ğ‘ğ‘—. Consider also the vertex-probability ğ‘ğ‘– for each vertex ğ‘–âˆˆ[ğ‘›]. According to Corollary 1 (a) and (c), the unique ğ‘âˆ—(ğº) in the case of a single attacker can be used to derive an equilibrium for the case of ğ‘˜â‰¥2 attackers. Therefore, we will find ğ‘âˆ—(ğº) for a single attacker, find an equilibrium for that case, and then extend this equilibrium to an equilibrium in the case of ğ‘˜â‰¥2 attackers. In more detail, after we find the defense strategy ğ‘âˆ— that maximizes minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– (Condition 1 of Theorem 1), i.e. yields ğ‘âˆ—(ğº) on the set

ğ‘‰âˆ—:={ğ‘–âˆˆğ‘‰ | ğ‘ğ‘–=maxğ‘âˆˆğ›¥ğœƒminğ‘—âˆˆ[ğ‘›]ğ‘ğ‘—}, an equilibrium is achieved if the single attacker assigns probability 1/|ğ‘‰âˆ—| to each vertex of ğ‘‰âˆ—. This is because all conditions of Theorem 1 are satisfied. Then, an equilibrium for ğ‘˜â‰¥2 is achieved if every attacker plays the same strategy as the single attacker; that is because again all conditions of Theorem 1 are satisfied.

The crucial observation that allows us to design such an algorithm is that we can compute ğ‘âˆ—(ğº) via a linear program which has ğ‘‚((ğ‘›ğœ†)) many variables and O(n) constraints, and therefore its running time is in the worst case polynomial in (ğ‘›ğœ†), for ğœ†âˆˆ{2,3,â€¦,ğ‘›âˆ’1}. For the trivial cases ğœ†=1 and ğœ†=ğ‘›, ğ·={{ğ‘–}|ğ‘–âˆˆğ‘‰} and ğ·=ğ‘‰ respectively, therefore ğ‘âˆ—(ğº)=1/ğ‘› and ğ‘âˆ—(ğº)=1 respectively. So in the rest of the proof we will assume that ğœ†âˆˆ{2,3â€¦,ğ‘›âˆ’1}. It remains to show how ğ‘âˆ—(ğº) is computed.

Let us denote ğ‘âˆ—:=ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒminğ‘–âˆˆ[ğ‘›]ğ‘ğ‘–. The computation of ğ‘âˆ— can be done as follows. First, consider each of the (ğ‘›ğœ†) subsets of V of size ğœ†, and find if it is a proper ğœ†-subgraph of G (i.e. connected); this can be done by running a Depth (or Breadth) First Search algorithm for each subset of size ğœ†. If it is not, then continue with the next subset. If it is, we consider it in the action set [ğœƒ], and assign to it a variable ğ‘ğ‘— which stands for its assigned probability in a general defense strategy. Now, by definition, for some vertex ğ‘–âˆˆ[ğ‘›], ğ‘ğ‘–=âˆ‘ğ‘—âˆˆ[ğœƒ]ğ‘–âˆˆğ‘—ğ‘ğ‘—. Therefore, we will consider only pure strategies j which are ğœ†-subgraphs to create the ğ‘ğ‘–â€™s. To compute the minimum ğ‘ğ‘– over all iâ€™s we introduce the variable ğ‘â€² and write the following set of n inequalities as a constraint in our linear program:

âˆ‘ğ‘—âˆˆ[ğœƒ]ğ‘–âˆˆğ‘—ğ‘ğ‘—â‰¥ğ‘â€²,forğ‘–âˆˆ{1,2,â€¦,ğ‘›}.
The left-hand side of each of the above inequalities is in fact ğ‘ğ‘–. The variable constraints are ğ‘â€²,ğ‘1,ğ‘2,â€¦,ğ‘ğœƒâ‰¥0 and also âˆ‘ğœƒğ‘—=1ğ‘ğ‘—=1, and all of the aforementioned constraints can be written in canonical form by applying standard transformations. Finally, the objective function of the linear program is variable ğ‘â€² and we require its maximization, which is the value ğ‘âˆ—. â—»

Connections to Other Types of Games
Although CSD games are defined as a normal form game with ğ‘˜+1 players, we can observe that they are a special case of other well-studied types of games: polymatrix games and Stackelberg games.

A polymatrix game is defined by a graph where every vertex represents a player and every edge represents a two-player game played by the endpoints of the edge. Every player has the same set of pure strategies in every game he is involved and to play the game he plays the same (mixed) strategy in every game. The payoff of every player is the sum they get from every two-player game they participate in. In a CSD game we observe the following. Firstly, the payoff of every attacker depends only on the strategy the defender plays, thus every attacker is involved only in one two-player game. In addition, all the attackers have the same set of pure strategies and they share the same payoff matrix. Similarly, the payoff the defender gets from catching an attacker depends only on the strategy the defender and this specific attacker chose. Hence, the payoff of the defender can be decomposed into a sum of payoffs from k two-player games. So, a CSD game can be seen as a polymatrix game where the underlying graph is a star with k leaves that correspond to the attackers and the defender is the center of the star. Although many-player polymatrix games have exponentially smaller representation size compared to the equivalent normal-form representation, we should note that this polymatrix game is of exponential size in the worst case since the defender can have exponential in n pure strategies to choose from.

A Stackelberg game is an extensive form two-player game. In the first round, one of the players commits to a (mixed) strategy. In the second round, the other player chooses a best response against the committed strategy of her opponent. In a Stackelberg equilibrium the first player is playing a strategy that maximizes her expected payoff, given that the second player plays a best response (mixed strategy). The MaxMin probability ğ‘âˆ—(ğº) for a CSD game on a graph G corresponds to a Stackelberg equilibrium. By Corollary 1(c), any CSD game, with ğ‘˜â‰¥1 attackers has the same ğ‘âˆ— as that of the case with ğ‘˜=1. Furthermore, as in a Stackelberg game, in the CSD game with ğ‘˜=1 the defender chooses a mixed strategy that maximizes her expected payoff, given that the attacker plays a best response (mixed strategy). Therefore, when we are interested in the defense-ratio in equilibrium of a CSD game for some arbitrary ğ‘˜â‰¥1, finding a Stackelberg equilibrium of the corresponding CSD game with ğ‘˜=1 suffices.

Defense-Optimal Graphs
We now focus our attention on defense-optimal graphs. We first characterize defense-optimal graphs with respect to the MaxMin probability ğ‘âˆ— and then use this characterization to analyze more specific classes of graphs like Hamiltonian graphs and tree graphs. We begin by an exact computation of the equilibrium defense ratio of any defense-optimal graph.

Theorem 3
In any defense-optimal graph G, we have that DR(ğº,ğ‘†âˆ—)=ğ‘›ğœ†.

Proof
First we will show that ğ‘›ğœ† is a lower bound on the equilibrium defense ratio DR(ğº,ğ‘†âˆ—) and then prove that it is tight. According to Lemma 1, a lower bound on DR(ğº,ğ‘†âˆ—) can be found by equivalently founding an upper bound on ğ‘âˆ—(ğº) over all graphs G with n vertices. Let us show that ğ‘âˆ—(ğº)â‰¤ğœ†ğ‘› for every G.

Suppose there is a graph ğºâ€² such that ğ‘âˆ—(ğºâ€²)>ğœ†ğ‘›, and let us focus only on ğºâ€². Suppose also that the defender has an action set [ğœƒ] on ğºâ€². Fix the strategy ğ‘=(ğ‘1,â€¦,ğ‘ğœƒ)âˆˆğ›¥ğœƒ that achieves ğ‘âˆ—(ğºâ€²). Then, by the definition of ğ‘âˆ—(ğºâ€²), for the vertex probabilities ğ‘ğ‘– it holds that ğ‘ğ‘–>ğœ†ğ‘› for all ğ‘–âˆˆ[ğ‘›]. Therefore, it is

âˆ‘ğ‘–=1ğ‘›ğ‘ğ‘–>ğœ†.
(3)
Also, by the definition of a defense strategy, if X denotes the random variable corresponding to the number of vertices that the defender covers, then:

ğ”¼[ğ‘‹]=âˆ‘ğ‘—=1ğœƒğ‘ğ‘—â‹…|ğ¿ğ‘—|=ğœ†(where ğ¿ğ‘— is a ğœ†-subgraph of ğº, hence |ğ¿ğ‘—|=ğœ†âˆ€ğ‘—âˆˆ[ğœƒ]).
(4)
Let us introduce the indicator variables ğ‘‹ğ‘–ğ‘—, ğ‘–âˆˆ[ğ‘›], ğ‘—âˆˆ[ğœƒ] with value 1 if vertex ğ‘–âˆˆğ¿ğ‘—, and 0 otherwise. Then,

ğ”¼[ğ‘‹]=âˆ‘ğ‘—=1ğœƒğ‘ğ‘—âˆ‘ğ‘–=1ğ‘›ğ‘‹ğ‘–ğ‘—=âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=1ğœƒğ‘ğ‘—ğ‘‹ğ‘–ğ‘—=âˆ‘ğ‘–=1ğ‘›ğ‘ğ‘–>ğœ†(by Inequality (3)),
(5)
which contradicts Eq. (4).

It remains to show that the lower bound ğ‘›ğœ† on DR(ğº,ğ‘†âˆ—) is tight. This is easy to do by showing that ğœ†ğ‘› is a tight upper bound on ğ‘âˆ—(ğº): any Hamiltonian graph has ğ‘âˆ—(ğº)=ğœ†ğ‘› as we show in Observation 1. â—»

As an intermediate corollary of Theorem 3 we get the following characterization of defense-optimal graphs.

Corollary 3
A graph G is defense-optimal if and only if all of its vertices are defended with probability ğœ†ğ‘›.

Proof
Necessity of defense-optimality is trivial: every vertex has vertex-probability ğœ†ğ‘›, therefore ğ‘âˆ—(ğº)=ğœ†ğ‘›, so by Theorem 3 the graph is defense-optimal.

Sufficiency of defense-optimality is also easy to see using the Eqs. (4), (5) of the proof of Theorem 3. Suppose that the graph is defense-optimal and consider an equilibrium where the defense strategy is ğ‘=(ğ‘1,â€¦,ğ‘ğœƒ). Then the sum of vertex probabilities is âˆ‘ğ‘›ğ‘–=1ğ‘ğ‘–=ğœ† according to the aforementioned equations. Therefore, if there exists a vertex v with vertex-probability ğ‘ğ‘£>ğœ†ğ‘› then there is another vertex u with probability ğ‘ğ‘¢<ğœ†ğ‘›. This means that ğ‘âˆ—(ğº)<ğœ†ğ‘›, and as a result the graph is not defense-optimal which contradicts our assumption. â—»

Someone may wonder whether Corollary 3 can be further exploited to prove that, in general, there are best-defense strategies in defense-optimal graphs are uniform, i.e. every pure strategy s in the support S of the defender is assigned probability 1/|S|. However, as we demonstrate in Fig. 1 this is not the case. On the other hand, this claim is true for Hamiltonian graphs and tree graphs.

Fig. 1
figure 1
An example of a defense-optimal graph G with no uniform best-defense strategy. Here ğ‘›=7, ğœ†=3 and ğ‘âˆ—(ğº)=3/7 is achievable by assigning probability 3/7 to pure strategy {ğ‘£1,ğ‘£2,ğ‘£3} and probability 1/7 to each of the pure strategies {ğ‘£4,ğ‘£5,ğ‘£6}, {ğ‘£4,ğ‘£5,ğ‘£7}, {ğ‘£4,ğ‘£6,ğ‘£7}, {ğ‘£5,ğ‘£6,ğ‘£7}, so the graph is defense optimal. Suppose that there is a uniform best-defense strategy for the graph, with support of size r. Observe that ğ‘£1 cannot participate in more than one pure defense strategies, so in the uniform defense strategy, the vertex-probability ğ‘ğ‘£1 has to be 1/r (by the definition of uniformity), but it also has to be 3/7 due to Corollary 3. Since ğ‘Ÿâˆˆâ„•, this is a contradiction, and there is no uniform best-defense strategy for G

Full size image
Observation 1
All Hamiltonian graphs are defense-optimal.

Proof
Consider an arbitrary Hamiltonian graph G with n vertices. We will show that the graph can achieve vertex-probability ğ‘ğ‘–=ğœ†ğ‘› for every ğ‘–âˆˆ[ğ‘›], thus by Corollary 3 it is defense-optimal. Consider a Hamiltonian cycle of G and let us denote it by H. In the rest of the proof H will be the graph under study. Now consider the whole action set D of the defender, i.e. every path on H starting from a vertex i going clockwise and ending at vertex ğ‘–+ğœ†âˆ’1. Observe that there are only n such paths, therefore ğœƒ:=|ğ·|=ğ‘›. By assigning probability 1ğ‘› to each pure strategy ğ‘—âˆˆ[ğœƒ], since each vertex is in exactly ğœ† pure strategies, each vertex ğ‘–âˆˆ[ğ‘›] has vertex-probability ğ‘ğ‘–=ğœ†â‹…1ğœƒ=ğœ†ğ‘›. â—»

Tree Graphs
In this section we focus on the case where the graph is a tree. First, we further refine the characterization of defense-optimal graphs for trees. Then, we utilize this characterization to derive an algorithm that decides in polynomial time whether a given tree is defense-optimal, and if that is the case, it constructs in polynomial time a defense-optimal strategy for it. On the other hand, in the case where the tree is not defense-optimal, we show that it is ğ™½ğ™¿-hard to compute a best-defense strategy for it, namely it is ğ™½ğ™¿-hard to compute ğ‘âˆ—(ğº). We first provide Lemma 2 which will be used in our polynomial-time algorithm for checking defense-optimality on trees. Henceforth, we write that a graph is covered by a defense strategy if every vertex of the graph is covered by a ğœ†-subgraph that is in the support of the defense strategy.

Lemma 2
A tree T is defense-optimal if and only if T can be decomposed into ğ‘›ğœ† disjoint ğœ†-subgraphs.

Proof
(â‡’)(â‡’) Let T be defense-optimal. We will show that the support of any best-defense strategy on T must comprise of pure strategies that are disjoint ğœ†-subgraphs which altogether cover every ğ‘£âˆˆğ‘‰. Since those are disjoint and cover T, it follows that their number is ğ‘›ğœ† in total.

If ğœ†=1 then the above trivially holds. Assume that ğœ†â‰¥2 and consider a best-defense strategy on T whose support comprises of a collection îˆ¸ of ğœ†-subgraphs.

Let ğ‘¢âˆˆğ‘‰ be a leaf of T and let ğ‘£âˆˆğ‘‰ be its parent. Any ğœ†-subgraph in îˆ¸ covering u must also cover v, since ğœ†â‰¥2. Also, any ğœ†-subgraph in îˆ¸ covering v must also cover u, otherwise ğ‘ğ‘£ would be greater than ğ‘ğ‘¢. Now, consider the neighbors of v. For those of them that are leaves, the same must hold as holds for u, namely v and its leaf-children must all be covered by the exact same ğœ†-subgraph(s).

Consider the case where there is a leaf ğ‘¢âˆˆğ‘‰, such that a single ğœ†-subgraph contains u, its parent v, and all the other leaf-children of v (and, possibly, other vertices connected to v). Then we can remove this ğœ†-subgraph from îˆ¸ and the corresponding tree from T. This leaves the remainder of T being a forest comprising of trees ğ‘‡1,â€¦,ğ‘‡ğ‘¥, each of which has a (best-)defense strategy comprising of the corresponding subset of (the remainder of) îˆ¸ on ğ‘‡ğ‘–. Notice that it must be the case that every tree ğ‘‡ğ‘–, ğ‘–=1,2,â€¦,ğ‘¥, has size at least ğœ† (otherwise the initial collection îˆ¸ would not have covered T). So, if there is always a leaf u in some tree of the forest, such that a single ğœ†-subgraph contains u, its parent v, and all the other leaf-children of v (and, possibly, other vertices connected to v), we can proceed in the same fashion for each of the ğ‘‡ğ‘–â€™s, always removing a ğœ†-subgraph from îˆ¸, and the corresponding vertices from T, until we end up with an empty tree. This means that îˆ¸ was indeed a collection of disjoint ğœ†-subgraphs covering T.

However, assume for the sake of contradiction that at some â€œiterationâ€ the assumption does not hold, namely assume that there is a tree in the forest with no leaf u, such that a single ğœ†-subgraph contains u, its parent v, and all the other leaf-children of v (and, possibly, other vertices connected to v). This means that there are (at least) two ğœ†-subgraphs in îˆ¸, namely ğ¿1,ğ¿2, that cover u. Due to our initial observations, u, together with its parent v and all of vâ€™s leaf-children are contained in both ğ¿1 and ğ¿2. Since those are different ğœ†-subgraphs, there is a vertex z in the tree which belongs to ğ¿2 but does not belong to ğ¿1. Since ğ‘ğ‘§=ğ‘ğ‘£ (due to the fact that îˆ¸ is the support of the defense-optimal strategy and Corollary 3), it must hold that there is a different ğœ†-subgraph, ğ¿3, which covers z but does not cover v or any of its leaf-children. If ğ¿3 also covers a vertex in ğ¿1âˆ–ğ¿2Footnote1, then there is a cycle in the tree which is a contradiction. So ğ¿3 must not cover vertices in ğ¿1âˆ–ğ¿2. Since ğ¿3 is different to ğ¿2, there must be a vertex ğ‘§â€² in the tree which belongs in ğ¿3 but not in ğ¿2 (also not in ğ¿1). Since ğ‘ğ‘§â€²=ğ‘ğ‘§ (due to the fact that îˆ¸ is the support of the defense-optimal strategy and Corollary 3), it must hold that there is a different ğœ†-subgraph, ğ¿4, which covers ğ‘§â€² but does not cover z or any of the vertices in ğ¿2. Similarly to before, if ğ¿4 covers a vertex in ğ¿1âˆ–ğ¿2, then there is a cycle in the tree which is a contradiction. So ğ¿4 must not cover vertices in ğ¿1 or in ğ¿2.

Proceeding in the same way, we result in contradiction since the tree has finite number of vertices and there will need to be an overlap in coverage of some ğ¿ğ‘— with some ğ¿ğ‘–, ğ‘—>ğ‘–+1, which would mean that there is a cycle in the tree.

Therefore, there cannot be any overlaps between the ğœ†-subgraphs of îˆ¸, meaning that îˆ¸ comprises of ğ‘›ğœ† disjoint ğœ†-subgraphs which altogether cover T.

(â‡â‡) Let îˆ¸={ğ¿1,â€¦,ğ¿ğ‘›ğœ†} be a collection of ğ‘›ğœ† disjoint ğœ†-subgraphs that altogether cover T. Let the defender play each ğ¿ğ‘–, ğ‘–âˆˆ{1,â€¦,ğ‘›ğœ†}, equiprobably, that is, with probability 1/(ğ‘›ğœ†)=ğœ†ğ‘›. Then every vertex ğ‘£âˆˆğ‘‰ is covered with probability ğ‘ğ‘£=ğœ†ğ‘›=ğ‘âˆ—(ğº), meaning that T is defense-optimal. â—»

With Lemma 2 in hand we can derive a polynomial-time algorithm that decides if a tree is defense-optimal, and if it is, to produce a best-defense strategy.

Theorem 4
There exists a polynomial-time algorithm that decides whether a tree is defense-optimal, and if it is, it outputs a best-defense strategy.

Proof
The algorithm works as follows. Let us pick arbitrarily a vertex as the root of the tree. Initially, there is a pointer associated with a counter in every leaf of the tree T that moves â€œupwardsâ€ towards the root. For every move of the pointer the corresponding counter increases by one. The pointer moves until one of the following happens: either the counter is equal to ğœ†, or it reaches a vertex with degree greater or equal to 3 where it â€œstallsâ€. In the case where the counter is equal to ğœ†, we create a ğœ†-subgraph of T, we delete this ğœ†-subgraph from the tree, we move the pointer one position upwards, and we reset the counter back to zero. If a pointer stalls at a vertex of degree ğ‘‘â‰¥3, it waits until all ğ‘‘âˆ’1 pointers reach this vertex. Then, all these pointers are merged to a single one and a new counter is created whose value is equal to the sum of the counters of all d pointers. If this sum is larger than ğœ†, then the algorithm returns that the graph is not defense-optimal. If this sum is less than or equal to ğœ†, then we proceed as if there was initially only this pointer with its counter; if the new counter is equal to ğœ†, then we create a ğœ†-subgraph of T and reset the counter to 0; else the pointer moves upwards and the counter increases by one. To see why the algorithm requires polynomial time, observe that we need at most n pointers and n counters and in addition every pointer moves at most n times.

We now argue about the correctness of the algorithm described above. Clearly, if the algorithm does not output that the tree is not defense-optimal, it means that it partitioned T into ğœ†-subgraphs. So, from Lemma 2 we get that T is defense-optimal and the uniform probability distribution over the produced partition covers every vertex with probability ğœ†ğ‘›. It remains to argue that when the algorithm outputs that the graph is not defense-optimal, this is indeed the case. Consider the case where we delete a ğœ†-subgraph of the (remaining) tree. Observe that the ğœ†-subgraph our algorithm deleted should be uniquely covered by this ğœ†-subgraph in any best-defense strategy; any other ğœ†-subgraph would overlap with some other ğœ†-subgraph. Hence, the deletion of such a ğœ†-subgraph was not a â€œwrongâ€ move of our algorithm and the remaining tree is defense-optimal if and only if the tree before the deletion was defense-optimal. This means that any deletion that occurred by our algorithm did not make the remaining graph non defense-optimal. So, consider the case where after a merge that occurred at vertex v we get that the new counter is ğ‘>ğœ†. Then, we can deduce that all the subtrees rooted at v associated with the counters have strictly less than ğœ† vertices. Hence, in order to cover all the ğ‘>ğœ† vertices using ğœ†-subgraphs, at least two of these ğœ†-subgraphs cover vertex v. Hence, the condition of Lemma 2 is violated. But since every step of our algorithm so far was correct, it means that v cannot be covered only by one ğœ†-subgraph. Hence, our algorithm correctly outputs that the tree is not defense-optimal. â—»

In Theorem 4 we showed that it is easy to decide whether a tree is defense-optimal and if this is the case, it is easy to find a best-defense strategy for it. Now we prove that if a tree is not defense-optimal, then it is ğ™½ğ™¿-hard to compute ğ‘âˆ—(ğº). Note that the problem of computing ğ‘âˆ—(ğº) reduces to the problem of finding a best-defense strategy for graph G. Therefore finding a best-defense strategy is also ğ™½ğ™¿-hard.

Theorem 5
Computing ğ‘âˆ—(ğº) in CSD games is strongly ğ™½ğ™¿ -hard, even if the graph G is a tree. Consequently, finding a best-defense strategy is strongly ğ™½ğ™¿ -hard.

Proof
We will prove the theorem by reducing from the strongly ğ™½ğ™¿-hard problem 3-PARTITION. In an instance of 3-PARTITION we are given a multiset with n positive integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› written in unary, where ğ‘›=3ğ‘š for some ğ‘šâˆˆâ„•>0, and we ask whether it can be partitioned into m triplets ğ‘†1,ğ‘†2,â€¦,ğ‘†ğ‘š such that the sum of the numbers in each subset is equal. Let ğ‘ =âˆ‘ğ‘›ğ‘–=1ğ‘ğ‘–. Observe then that the problem is equivalent to asking whether there is a partition of the integers to m triplets such that the numbers in every triplet sum up to ğ‘ ğ‘š. Without loss of generality, we can assume that ğ‘ğ‘–<ğ‘ ğ‘š for every ğ‘–âˆˆ[ğ‘›]; if this was not the case, the problem could be trivially answered. So, given an instance of 3-PARTITION, we create a tree ğº=(ğ‘‰,ğ¸) with ğ‘ +1 vertices and ğœ†=ğ‘ ğ‘š+1. The tree is created as follows. For every integer ğ‘ğ‘–, we create a path with ğ‘ğ‘– vertices. In addition, we create the vertex ğ‘£0 and connect it to one of the two ends of each path. We will ask whether ğ‘âˆ—(ğº)â‰¥1ğ‘š. Observe that this is a polynomial-time construction since the integers ğ‘ğ‘– are given in unary.

Firstly, assume that the given instance of 3-PARTITION is satisfiable. Then, given ğ‘†ğ‘— we create a (ğ‘ ğ‘š+1)-subgraph of G as follows. If ğ‘ğ‘–âˆˆğ‘†ğ‘—, then we add the corresponding path of G to the subgraph. Finally, we add vertex ğ‘£0 in our (ğ‘ ğ‘š+1)-subgraph and the resulting subgraph is connected (by the construction of G). Since the sum of ğ‘ğ‘–â€™s equals ğ‘ ğ‘š, the constructed subgraph has ğ‘ ğ‘š+1 vertices. If we assign probability 1ğ‘š to every (ğ‘ ğ‘š+1)-subgraph we get that ğ‘ğ‘£â‰¥1ğ‘š for every ğ‘£âˆˆğ‘‰.

To prove the other direction, assume that ğ‘âˆ—(ğº)â‰¥1ğ‘š and observe the following. Firstly, since as we argued it is ğ‘ğ‘–<ğ‘ ğ‘š for every ğ‘–âˆˆ[ğ‘›], it holds that every (ğ‘ ğ‘š+1)-subgraph of G contains vertex ğ‘£0. Thus, ğ‘ğ‘£0=1 and âˆ‘ğ‘£â‰ ğ‘£0ğ‘ğ‘£â‰¥ğ‘ ğ‘š, since there are s vertices other than ğ‘£0 and for each one of them holds that ğ‘ğ‘£â‰¥1ğ‘š. In addition, observe that âˆ‘ğ‘£âˆˆğ‘‰ğ‘ğ‘£=ğœ†=ğ‘ ğ‘š+1. Hence, we get that ğ‘ğ‘£=ğ‘âˆ—(ğº)=1ğ‘š for every vertex ğ‘£â‰ ğ‘£0. In addition, observe that every pure defense strategy that covers a leaf of this tree, covers all the vertices of the branch. Hence, for every branch of the tree, all its vertices are covered by the same set of pure strategies; if a vertex u that is closer to ğ‘£0 is covered by one strategy that does not cover the whole branch, then the leaf ğ‘¢â€² of the branch is covered with probability less than u. So, in order for ğ‘ğ‘£=ğ‘âˆ—(ğº)=1ğ‘š for every ğ‘£â‰ ğ‘£0, it means that there exist a (ğ‘ ğ‘š+1)-subgraph that exactly covers a subset of the paths; this means that if a (ğ‘ ğ‘š+1)-subgraph covers a vertex in a path, then it covers every vertex of the path. Hence, by the construction of the graph, we get that this (ğ‘ ğ‘š+1)-subgraph of G corresponds to a subset of integers in the 3-PARTITION instance that sum up to ğ‘ ğ‘š. Since, 3-PARTITION is ğ™½ğ™¿-hard, we get that computing ğ‘âˆ—(ğº) is ğ™½ğ™¿-hard. Also, since finding a best-defense strategy is at least as hard, we conclude it is ğ™½ğ™¿-hard. â—»

General Graphs
We conjecture that contrary to checking defense-optimality of tree graphs and constructing a corresponding defense-optimal strategy in polynomial time, it is ğ™½ğ™¿-hard to even decide whether a given (general) graph is defense-optimal.

Conjecture 1
It is ğ™½ğ™¿-hard to decide whether a graph is defense-optimal.

Approximation Algorithm for ğ‘âˆ—(ğº)
We showed in the previous section that, given a graph G, it is ğ™½ğ™¿-hard to compute ğ‘âˆ—(ğº), and consequently, ğ™½ğ™¿-hard to find a best-defense strategy. We also presented in Theorem  an algorithm for computing the exact value ğ‘âˆ—(ğº) of a given graph G (and therefore its best defense ratio), but this algorithm has running time polynomial in the size of the input only in the cases ğœ†=ğ‘ or ğœ†=ğ‘›âˆ’ğ‘, where c is a constant natural. On the positive side, we present now a polynomial-time algorithm which, given a graph G of n vertices, returns a defense strategy with defense ratio which is within factor 2+ğœ†âˆ’3ğ‘› of the best defense ratio for G. In particular, it achieves defense ratio 1/ğ‘â€²â‰¤(2+ğœ†âˆ’3ğ‘›)/ğ‘âˆ—(ğº), where ğ‘â€²=minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– and every ğ‘ğ‘–, ğ‘–âˆˆ[ğ‘›] is the vertex-probability determined by the constructed defense strategy. We henceforth write that a collection îˆ¸ of ğœ†-subgraphs covers a graph ğº=(ğ‘‰,ğ¸), if every vertex of V is covered by some ğœ†-subgraph in îˆ¸. The algorithm presented in this section returns a collection îˆ¸ of at most 2ğ‘›âˆ’3ğœ†+1 ğœ†-subgraphs that covers G. Therefore, the uniform defense strategy over îˆ¸ assigns probability at least 1/(2ğ‘›âˆ’3ğœ†+1) to each ğœ†-subgraph.

For any collection îˆ¸ of ğœ†-subgraphs and for any ğ‘£âˆˆğ‘‰, let us denote by coverageîˆ¸(ğ‘£) the number of ğœ†-subgraphs in îˆ¸ which v belongs in. Observe that:

âˆ‘ğ‘£âˆˆğ‘‰coverageîˆ¸(ğ‘£)=|îˆ¸|â‹…ğœ†,
(6)
where |îˆ¸| denotes the cardinality of îˆ¸.

We first prove Lemma 3, to be used in the proof of the main theorem of this section. We henceforth denote by V(G) and E(G) the vertex set and edge set, respectively, of some graph G.

Lemma 3
For any tree T of n vertices, and for any ğœ†â‰¤ğ‘›, we can find a collection îˆ¸ of distinct ğœ†-subgraphs such that for every ğ‘£âˆˆğ‘‰, it holds that 1â‰¤coverageîˆ¸(ğ‘£)â‰¤degree(ğ‘£), except maybe for (at most) ğœ†âˆ’1 vertices, where for each of them it holds that coverageîˆ¸(ğ‘£)=degree(ğ‘£)+1.

Proof
We will prove the statement of the lemma by providing Algorithm 1 that takes as input T and ğœ† and outputs the requested collection îˆ¸ of ğœ†-subgraphs.

figure a
The algorithm starts by picking an arbitrary vertex v to serve as the root of the tree. Then it performs a Depth-First-Search (DFS) starting from v. We will distinguish between visiting a vertex and covering a vertex in the following way. We say that DFS visited a vertex if it considered that vertex as a candidate to be inserted to some ğœ†-subgraph, and we say that DFS covered a vertex if it visited and inserted the vertex at some ğœ†-subgraph. By definition, DFS visits in a greedy manner first an uncovered child, and only if there is no such child, it visits its parent (lines 14â€“17, 21â€“24). The set-variable that keeps track of the covered vertices is S.

Starting with the root of T, the algorithm simply visits the whole vertex set according to DFS, putting each visited vertex in the same ğœ†-subgraph ğ¿ğ‘– (starting with ğ‘–=1) (lines 18â€“24), and when |ğ¿ğ‘–|=ğœ†, a new empty ğœ†-subgraph ğ¿ğ‘–+1 is picked to get filled in with ğœ† vertices (lines 26â€“27) taking care of one extra thing: The first vertex that the algorithm puts in an empty ğœ†-subgraph ğ¿ğ‘–, ğ‘–âˆˆ{1,2,â€¦} is guaranteed to be one that has not been covered by any other ğœ†-subgraph so far (lines 13â€“17). This ensures that no two ğœ†-subgraphs will eventually be identical.

The algorithm will not only visit all vertices in T, but also cover them. That is because there is no point where the algorithm checks whether the currently visited vertex is uncovered and then does not cover it. On the contrary, it covers every vertex that it visits, except for some already covered one in case the current ğœ†-subgraph is empty (lines 13â€“24). And since DFS by construction visits every vertex, we know that at some point the whole vertex set will be covered, or equivalently, coverageîˆ¸(ğ‘£)â‰¥1,âˆ€ğ‘£âˆˆğ‘‰. Therefore, the algorithm will eventually exit the while-loop in lines 12â€“29.

Now we prove that, after the algorithm terminates, every vertex ğ‘£âˆˆğ‘‰ is covered at most degree(v) times, except for at most ğœ†âˆ’1 vertices that are covered ğ‘‘ğ‘’ğ‘”ğ‘Ÿğ‘’ğ‘’(ğ‘£)+1 times. Observe that DFS visits every vertex v at most degree(v) times: (a) v will be visited after its parent u only if v is uncovered (lines 14â€“15, 21â€“22), v will get covered (lines 19â€“20), and will not get visited ever again by its parent since it will be covered (lines 16â€“17, 23â€“24). (b) v will be visited at most once by each of its children, say w, only if w does not have an uncovered child (lines 16â€“17, 23â€“24), and v will not get ever visited by its parent since v will be covered, and also v cannot be visited a second time by any of its children, since they can never be visited again (they can only be visited through v since T is a tree). Therefore, any vertex v will be visited exactly once after its parent is visited, and at most once by each of its children, having a total of at most degree(v) visits. And since, as argued above, the total number of times a vertex will be covered is at most the number of times it will get visited, when DFS terminates (i.e ğ‘†=ğ‘‰), it will be coverageîˆ¸(ğ‘£)â‰¤ğ‘‘ğ‘’ğ‘”ğ‘Ÿğ‘’ğ‘’(ğ‘£), for every ğ‘£âˆˆğ‘‰.

However, note that the last nonempty ğœ†-subgraph ğ¿ğ‘– might not consist of ğœ† vertices since the entire V was covered and DFS could not proceed further. In this case, the algorithm empties the set S that keeps track of the covered vertices, takes the current ğ¿ğ‘– and fills it in with exactly another ğœ†âˆ’|ğ¿ğ‘–| vertices. This is done by picking an arbitrary vertex from ğ¿ğ‘– and setting it as the root of T, and performing one last DFS starting from it until ğ¿ğ‘– has ğœ† vertices in total (lines 30â€“33). To ensure that the DFS will continue only until it fills in this current ğ¿ğ‘–, the algorithm counts the number of times that it runs the while-loop of DFS, namely lines 12â€“29, via the variable count (line 34), which escapes the while-loop of DFS in case DFS has filled in ğ¿ğ‘– (lines 28â€“29) and terminates. Observe that in the last ğœ†-subgraph ğ¿ğ‘–, a vertex v inserted in the last iteration of DFS (ğ‘ğ‘œğ‘¢ğ‘›ğ‘¡=1) and was not inserted in ğ¿ğ‘– by the first run (ğ‘ğ‘œğ‘¢ğ‘›ğ‘¡=0) might have been covered by the first run of DFS exactly degree(v) times, therefore when the algorithm terminates it has been covered ğ‘‘ğ‘’ğ‘”ğ‘Ÿğ‘’ğ‘’(ğ‘£)+1 times. Since by the end of the first DFS run,â€˜ ğ¿ğ‘– had at least one vertex, the cardinality of such vertices that are covered more times than their degree are at most ğœ†âˆ’1. â—»

We can now prove the following.

Lemma 4
For any graph G of n vertices, and for any ğœ†â‰¤ğ‘›, there exist (at most) 2ğ‘›âˆ’3ğœ†+1 ğœ†-subgaphs of G that cover G.

Proof
Consider a spanning tree T of G. Then Lemma 3 applies to T. Observe that a collection îˆ¸ as described in the statement of the aforementioned lemma has the same qualities for G since ğ‘‰(ğ‘‡)=ğ‘‰(ğº) and ğ¸(ğ‘‡)âŠ†ğ¸(ğº). That is, îˆ¸ is a collection of distinct ğœ†-subgraphs of G, such that for every ğ‘£âˆˆğ‘‰, it holds that 1â‰¤coverageîˆ¸(ğ‘£)â‰¤degree(ğ‘£), except maybe for (at most) ğœ†âˆ’1 vertices, for each v of which, it is coverageîˆ¸(ğ‘£)=degree(ğ‘£)+1, where by degree(ğ‘£) we denote the degree of vertex v in T.

Fix a particular value for ğœ† and consider a collection îˆ¸ of ğœ†-subgraphs as constructed in the proof of Lemma 3. Then, by Eq. (6),

|îˆ¸|==âˆ‘ğ‘£âˆˆğ‘‰coverageîˆ¸(ğ‘£)ğœ†â‰¤âˆ‘ğ‘£âˆˆğ‘‰degree(ğ‘£)+(ğœ†âˆ’1)ğœ†2(ğ‘›âˆ’1)ğœ†+ğœ†âˆ’1ğœ†=2ğ‘›âˆ’3ğœ†+1.
â—»

We conclude with the simple algorithm that achieves a defense strategy with defense ratio which is within factor 2+ğœ†âˆ’3ğ‘› of the best defense ratio for G.

Theorem 6
Given any graph ğº=(ğ‘‰,ğ¸), Algorithm 2 computes in time O(|E|) a defense strategy such that, for any combination of attack strategies, the resulting strategy profile S yields defense ratio DR(ğº,ğ‘†)â‰¤(2+ğœ†âˆ’3ğ‘›)â‹…DR(ğº,ğ‘†âˆ—).

figure b
Proof
As argued in Lemma 4, there is a collection îˆ¸ of ğœ†-subgraphs with |îˆ¸|â‰¤2ğ‘›ğœ†+1âˆ’3ğœ† which covers G. Therefore, the uniform defense strategy returned by Algorithm 2 (which determines the vertex-probability ğ‘ğ‘– for each vertex i) achieves a minimum vertex-probability ğ‘â€²:=minğ‘–âˆˆ[ğ‘›]ğ‘ğ‘– for which it holds that:

ğ‘â€²=1|îˆ¸|â‰¥12ğ‘›ğœ†+1âˆ’3ğœ†=ğœ†ğ‘›2+ğœ†âˆ’3ğ‘›â‰¥12+ğœ†âˆ’3ğ‘›â‹…ğ‘âˆ—(ğº),
(7)
where the first equality is due to the fact that any leaf ğ‘£âˆˆğ‘‰ of the spanning tree T of G through which îˆ¸ was created has coverageîˆ¸(ğ‘£)=1, and therefore there is such a vertex v in G that is covered by exactly one ğœ†-subgraph; and the last inequality is due to the fact that ğ‘âˆ—(ğº)â‰¤ğœ†/ğ‘› for any graph G (due to Corollary 3), where ğ‘âˆ—(ğº) is the MaxMin probability of G.

The above inequality implies that if the defender chooses the prescribed strategy, the minimum defense ratio cannot be too bad. That is because in the worst case for the defender, each attacker will choose a vertex ğ‘£â€² on which the aforementioned strategy of the defender results to vertex-probability ğ‘â€² (so that the attacker is caught with minimum probability). As a result, the defender will have the minimum possible expected payoff which is ğ‘â€²â‹…ğ‘˜. Thus, for the constructed defend strategy and any combination of attack strategies, the resulting strategy profile S yields defense ratio:

DR(ğº,ğ‘†)â‰¤ğ‘˜ğ‘â€²â‹…ğ‘˜â‰¤(2+ğœ†âˆ’3ğ‘›)â‹…1ğ‘âˆ—(ğº)=(2+ğœ†âˆ’3ğ‘›)â‹…DR(ğº,ğ‘†âˆ—),
where the last equality is due to Lemma 1.

With respect to the running time, notice that Step 1 of Algorithm 2 can be executed in time ğ‘‚(|ğ‘‰|+|ğ¸(ğº)|)=ğ‘‚(|ğ¸(ğº)|). Step 2 can be executed in time ğ‘‚(|ğ‘‰|+|ğ¸(ğ‘‡)|)=ğ‘‚(|ğ‘‰|). Finally, Step 3 can be executed in constant time. Therefore, the total running time of Algorithm 2 is O(|E(G)|). â—»

Corollary 4
For any graph G there is a polynomial (in both n and ğœ†) time approximation algorithm (Algorithm 2) with approximation factor 1/(2+ğœ†âˆ’3ğ‘›) for the computation of ğ‘âˆ—(ğº).

The merit of finding a probability ğ‘â€² that approximates (from below) ğ‘âˆ—(ğº) for a given graph G through an algorithm such as Algorithm 2 is in guaranteeing to the defender that, no matter what the attackers play, she always â€œcatchesâ€ at least a portion ğ‘â€² of them in expectation, where the best portion is ğ‘âˆ—(ğº) in an equilibrium. In fact, one can see from Inequality (7) (penultimate step) that Algorithm 2 guarantees that the defender catches a fraction of attackers which is at least 1/(2+ğœ†âˆ’3ğ‘›) times the best expected number (among all strategy profiles, not only equilibrium profiles).

Bounds on the Price of Defense
In the following theorem we give a lower bound on the PoD for any given n and 2â‰¤ğœ†â‰¤ğ‘›âˆ’1 by constructing a graph G with particular (very small) ğ‘âˆ—(ğº) (which, by Lemma 1 implies great best defense ratio).

Theorem 7
The PoD(ğœ†) is lower bounded by âŒŠ2(ğ‘›âˆ’1)ğœ†âŒ‹ and âŒŠ2(ğ‘›âˆ’1)ğœ†+1âŒ‹ for ğœ† even and odd respectively, when ğœ†âˆˆ{2,3,â€¦,ğ‘›âˆ’1}.

Proof
We will prove the statement by showing that for any given n and ğœ†âˆˆ{2,3,â€¦,ğ‘›âˆ’1}, there exists a graph ğº=(ğ‘‰,ğ¸) on n vertices that requires (at least) some number roughly ğ‘=âŒŠ2(ğ‘›âˆ’1)ğœ†+1âŒ‹ of ğœ†-subgraphs to be covered and additionally this graphâ€™s structure achieves ğ‘âˆ—(ğº) for the uniform defense strategy, i.e. each ğœ†-subgraph is assigned equal probability 1/b.

The graph we construct is the following. First, consider a line graph with ğœ vertices, where ğœ=âŒˆğœ†2âŒ‰. Keep a central vertex to use later, and using only ğ‘›âˆ’1 vertices, create as many complete lines with ğœ vertices as possible, i.e. ğ‘=âŒŠğ‘›âˆ’1ğœâŒ‹. Create another incomplete line (if needed) with strictly less than ğœ vertices using the remaining ones ğ‘›âˆ’1âˆ’ğ‘â‹…ğœ. Now draw an edge from the central vertex to a single leaf of each of the constructed lines. For examples of the construction of G in each of the below three cases, see Figs. 2, 3, and 4.

Fig. 2
figure 2
An example of Case 1 of Theorem 7, where ğ‘›=15 and ğœ†=6. Here, graph G has ğœ=3 and ğ‘=4. The ğœ†-subgraphs ğ¿1,ğ¿2,ğ¿3,ğ¿4 that constitute the support of a best-defense strategy are shown with various colors (Color figure online)

Full size image
Fig. 3
figure 3
An example of Case 2(a) of Theorem 7, where ğ‘›=19 and ğœ†=7. Here, graph G has ğœ=4 and ğ‘=4. The ğœ†-subgraphs ğ¿1,ğ¿2,ğ¿3,ğ¿4 that constitute the support of a best-defense strategy are shown with various colors (Color figure online)

Full size image
Fig. 4
figure 4
An example of Case 2(b) of Theorem 7, where ğ‘›=20 and ğœ†=7. Here, graph G has ğœ=4 and ğ‘=4. The ğœ†-subgraphs ğ¿1,ğ¿2,ğ¿3,ğ¿4,ğ¿5 that constitute the support of a best-defense strategy are shown with various colors (Color figure online)

Full size image
Consider now a defense strategy ğ‘:=(ğ‘1,ğ‘2,â€¦,ğ‘ğœƒ)âˆˆğ›¥ğœƒ and the vertex probabilities ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› it induces on the vertices of G.

Case 1: ğœ† is even. In this case ğœ=ğœ†/2 and observe that the diameter of this graph G is equal to ğœ†, therefore no ğœ†-subgraph that covers a leaf of a complete line can cover a leaf of another complete line. Also, any ğœ†-subgraph that covers a leaf of a complete line can also cover the whole incomplete line. Therefore, this graph can be covered by b ğœ†-subgraphs but no less. Assume that q covers G, i.e. ğ‘ğ‘–>0,âˆ€ğ‘–âˆˆ[ğ‘›], and let us focus on the set ğ‘‰ğ‘ğ‘œğ‘š of leaves of the complete lines of G, where |ğ‘‰ğ‘ğ‘œğ‘š|=ğ‘ as argued earlier, and denote ğ‘‰ğ‘ğ‘œğ‘š by [b]. Consider the vertex probabilities ğ‘ğ‘–, ğ‘–âˆˆ[ğ‘], and note that âˆ‘ğ‘–âˆˆ[ğ‘]ğ‘ğ‘–â‰¤1 where strict inequality holds for the case where there exists some pure strategy ğ¿ğ‘—âˆˆğ‘ ğ‘¢ğ‘ğ‘(ğ‘) such that ğ¿ğ‘—âˆ©ğ‘‰ğ‘ğ‘œğ‘š=âˆ…. Then for ğ‘â€²:=minğ‘–âˆˆ[ğ‘]ğ‘ğ‘– it holds that ğ‘â€²â‰¤1/ğ‘, otherwise ğ‘ğ‘–>1/ğ‘, âˆ€ğ‘–âˆˆ[ğ‘] and therefore âˆ‘ğ‘–âˆˆ[ğ‘]ğ‘ğ‘–>1 which is a contradiction. Also, for ğ‘ğ‘–=1/ğ‘, âˆ€ğ‘–âˆˆ[ğ‘], it is ğ‘â€²=1/ğ‘, which yields ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒğ‘â€²=1/ğ‘.

Case 2: ğœ† is odd. In this case ğœ=(ğœ†+1)/2 and the diameter of G equals ğœ†+1, therefore no ğœ†-subgraph that covers a leaf of a complete line can also cover a leaf of another complete line.

Subcase (a): ğœâˆ’(ğ‘›âˆ’1âˆ’ğ‘â‹…ğœ)â‰ 1. Any ğœ†-subgraph that covers a leaf of a complete line can cover the whole incomplete line. Therefore, this graph can be covered with b ğœ†-subgraphs but no less. Following the analysis of Case 1, it is ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒğ‘â€²=1/ğ‘.

Subcase (b): ğœâˆ’(ğ‘›âˆ’1âˆ’ğ‘â‹…ğœ)=1. No ğœ†-subgraph that covers a leaf of a complete line can cover the leaf of the incomplete line. Therefore, this graph can be covered by ğ‘+1 ğœ†-subgraphs but no less. Following similar analysis as that of Case 1, where instead of ğ‘‰ğ‘ğ‘œğ‘š we have ğ‘‰ğ‘ğ‘œğ‘šâˆª{ğ‘£ğ‘–ğ‘›ğ‘} where ğ‘£ğ‘–ğ‘›ğ‘ is the leaf of the incomplete line, and instead of b we have ğ‘+1, we conclude that ğ‘âˆ—(ğº):=maxğ‘âˆˆğ›¥ğœƒğ‘â€²=1/(ğ‘+1).

For Case 1, and Case 2(a), since each of the leaves of the b complete lines have vertex-probability 1/b, the defense strategy ğ‘âˆ— with probability ğ‘âˆ—ğ‘–=1/ğ‘ assigned to the respective pure defense strategy ğ¿ğ‘–,ğ‘–âˆˆ[ğ‘] that contains vertex ğ‘–âˆˆ[ğ‘], yields ğ‘âˆ—(ğº). For Case 2(b), since each of the leaves of the b complete lines and the leaf ğ‘£ğ‘–ğ‘›ğ‘ of the incomplete line have vertex-probability 1/(ğ‘+1), the defense strategy ğ‘âˆ— with probability ğ‘âˆ—ğ‘–=1/(ğ‘+1) assigned to the respective pure strategy ğ¿ğ‘–,ğ‘–âˆˆ[ğ‘]âˆª{ğ‘£ğ‘–ğ‘›ğ‘} that contains vertex ğ‘–âˆˆ[ğ‘]âˆª{ğ‘£ğ‘–ğ‘›ğ‘}, yields ğ‘âˆ—(ğº).

By the above values of ğ‘âˆ—(ğº) and Lemma 1, the proof of the theorem is complete. â—»

Corollary 5
For any given n and 2â‰¤ğœ†â‰¤ğ‘›âˆ’1, it holds that âŒŠ2(ğ‘›âˆ’1)ğœ†+1âŒ‹â‰¤PoD(ğœ†)â‰¤2(ğ‘›âˆ’1)+ğœ†âˆ’1ğœ†. Furthermore, for the trivial cases ğœ†âˆˆ{1,ğ‘›} it is PoD(1)=ğ‘› and PoD(ğ‘›)=1.

Proof
The lower bound is established by Theorem 7. The upper bound is due to Theorem 6. For the cases ğœ†=1 and ğœ†=ğ‘›, observe that the defenderâ€™s action set is ğ·={{ğ‘–}|ğ‘–âˆˆğ‘‰} and ğ·={ğ‘‰} respectively, therefore ğ‘âˆ—(ğº)=1/ğ‘› and ğ‘âˆ—(ğº)=1 respectively, and again from Lemma 1 we get the values in the statement of the corollary. â—»

Conclusion and Open Problems
Our results extend the line of work by Mavronicolas et al. [11] on defense games in graphs. In these games, we have generalized the pure strategy of the defender to be a connected induced subgraph of the underlying graph of size ğœ† instead of two adjacent vertices. We termed these new games Connected Subgraph Defense (CSD) games and studied the structure of equilibria and the complexity of finding one, depending on the power of the defender ğœ†. We also extended the notion of Price of Defense, as termed in [11], for any ğœ† and found almost tight bounds for its value.

An interesting open problem is the following. For ğœ† that is both more than constantly away from 1 and n, our LP-based algorithm for computing a Nash equilibrium is not efficient. That is because in that case, our algorithm considers the strategy space of the defender to have cardinality (ğ‘›ğœ†) and brute forces through all of that space. Is there a polynomial time algorithm for computing a Nash equilibrium when ğœ†âˆˆğœ”(1)âˆ©ğ‘œ(ğ‘›)? Another open problem is to determine the complexity of deciding whether a general graph is defense-optimal. We conjecture that it is ğ™½ğ™¿-hard.