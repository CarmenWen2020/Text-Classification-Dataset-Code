The 1â€“2â€“3 Conjecture, raised by KaroÅ„ski, Åuczak and Thomason, states that almost every graph G admits a proper 3-labelling, i.e., a labelling of the edges with 1, 2, 3 such that no two adjacent vertices are incident to the same sum of labels. Another interpretation of this conjecture, that may be attributed to Chartrand et al., is that almost every graph G can be turned into a locally irregular multigraph M, i.e., with no two adjacent vertices having the same degree, by replacing each of its edges by at most three parallel edges. In other words, for almost every graph G there should be a locally irregular multigraph M with the same adjacencies and having a relatively small number of edges. The 1â€“2â€“3 Conjecture, if true, would indeed imply that there is such an M with |ğ¸(ğ‘€)|â‰¤3|ğ¸(ğº)|. In this work, we study proper labellings of graphs with the extra requirement that the sum of assigned labels must be as small as possible. In other words, given a graph G, we are looking for a locally irregular multigraph ğ‘€âˆ— with the smallest number of edges possible that can be obtained from G by multiplying edges. This problem is actually quite different from the 1â€“2â€“3 Conjecture, as we prove that there is no absolute constant k such that ğ‘€âˆ— can always be obtained from G by replacing each edge with at most k parallel edges. We investigate several aspects of this problem, covering algorithmic and combinatorial aspects. In particular, we prove that the problem of designing proper labellings with minimum label sum is îˆºîˆ¼-hard in general, but solvable in polynomial time for graphs with bounded treewidth. We also conjecture that for almost every connected graph G there should be a proper labelling with label sum at most 2|E(G)|, which we verify for several classes of graphs.

Introduction
In this work we study properties of some distinguishing labellings of graphs. We begin by giving some useful definitions and notations. Let ğº=(ğ‘‰,ğ¸) be a graph. Throughout this work, most of the time we denote by V and E the vertex set and edge set of a given graph. In a few cases where ambiguities are possible, we instead denote these sets by V(G) and E(G). For a vertex ğ‘£âˆˆğ‘‰ of G, we denote by d(v) the degree of v, that is the number of edges that are incident to v. We say that G is regular if for each ğ‘¢,ğ‘£âˆˆğ‘‰, we have ğ‘‘(ğ‘¢)=ğ‘‘(ğ‘£). It is well known that there exists no non-trivial simple graph that is totally irregular, meaning a simple graph for which all vertices have different degrees. This however is not true for multigraphs, where multiple edges between two adjacent vertices are allowed. A graph G is called locally irregular if for each ğ‘¢ğ‘£âˆˆğ¸, we have ğ‘‘(ğ‘¢)â‰ ğ‘‘(ğ‘£). For any additional notation on graph theory not defined here, we refer the reader to [11].

A function â„“:ğ¸â†¦{1,â€¦,ğ‘˜} is called a k-labelling of G. By a distinguishing labelling we mean a labelling â„“ that allows us to distinguish the vertices of G accord to some vertex parameter computed from â„“. Note that this can equivalently be seen through the scope of graph colouring. In this work, we are more particularly interested in proper labellings, which are defined as follows. For any ğ‘£âˆˆğ‘‰, let us denote by ğ‘â„“(ğ‘£) the colour of v that is induced by â„“, being the sum of labels assigned to the edges incident to v. That is,


ğ‘â„“(ğ‘£)=âˆ‘ğ‘¢âˆˆğ‘(ğ‘£)â„“(ğ‘£ğ‘¢),

where ğ‘(ğ‘£)={ğ‘¢âˆˆğ‘‰:ğ‘¢ğ‘£âˆˆğ¸} is the neighbourhood of v. We say that â„“ is proper if the resulting ğ‘â„“ is a proper vertex-colouring of G, i.e., for every edge ğ‘¢ğ‘£âˆˆğ¸ we have ğ‘â„“(ğ‘¢)â‰ ğ‘â„“(ğ‘£). Note that a graph admits a proper labelling if and only if it has no ğ¾2 as a component [14]. Therefore, we here focus only on nice graphs, i.e., graphs without any component isomorphic to ğ¾2. It is clear that for every (not necessarily proper) labelling â„“ of G and for every ğ‘£âˆˆğ‘‰, we have ğ‘â„“(ğ‘£)â‰¥ğ‘‘(ğ‘£) with ğ‘â„“(ğ‘£)=ğ‘‘(ğ‘£) if and only if all edges incident to v are assigned label 1. It follows that G admits a proper 1-labelling if and only if G is locally irregular.

The connection between the labellings of a graph G and its â€œregularityâ€ has been explored by several authors, in particular through the notion of irregularity strength of graphs, introduced by Chartrand et al. [10]. The irregularity strength s(G) of G is defined as the smallest k such that G admits a k-labelling â„“ with the property that for every two ğ‘¢,ğ‘£âˆˆğ‘‰ (not necessarily adjacent), we have ğ‘â„“(ğ‘¢)â‰ ğ‘â„“(ğ‘£). The main point for studying such labellings â„“, is that if, from G, we replace each edge e by â„“(ğ‘’) parallel edges, then we get a multigraph M that is totally irregular. Note that building M in this way preserves the adjacencies of G, that is M has the same structure as G. As stated earlier, no non-trivial simple graph G is totally irregular; it is thus legitimate to wonder how to build a corresponding totally irregular multigraph M in the fashion above. In their work, Chartrand et al. regard edge multiplications as an expensive operation and, as such, they want to limit it as much as possible. This results in the following optimisation problem: for a given graph G, what is the smallest k such that G can be turned into a totally irregular multigraph M by replacing each edge with at most k parallel edges? From the labelling point of view, this smallest k is precisely s(G).

Since the notion of total irregularity does not fit with simple graphs, as ğ¾1 is the only totally irregular simple graph, it is legitimate to consider that this notion is too strong for simple graphs, and instead consider weaker notions of irregularity. A few such notions have been explored in the literature, such as the notions of highly irregular graphs [9] or locally irregular graphs [2], which we introduced earlier. With respect to Chartrand et al.â€™s point of view, we note that there is again a straight connection between proper labellings and locally irregular graphs. Namely, given a proper labelling â„“ of a graph G, by replacing each edge e with â„“(ğ‘’) parallel edges, we get a locally irregular multigraph M with the same structure as G. As in the previous problem, one can again ask about the smallest k such that G admits proper k-labellings. This smallest k (if any) is denoted ğœ’Î£(ğº).

This parameter ğœ’Î£ is precisely at the heart of one of the most famous conjectures concerning proper labellings of graphs, the so-called 1â€“2â€“3 Conjecture, introduced by KaroÅ„ski, Åuczak and Thomason in 2004 [14]. This conjecture states that for every nice graph G, we have ğœ’Î£(ğº)â‰¤3. It is worth noting that there exist nice graphs G that verify ğœ’Î£(ğº)=3 (for example every nice complete graph ğ¾ğ‘› has ğœ’Î£(ğ¾ğ‘›)=3 as shown in [8]) and thus it is meaningless to try to show that ğœ’Î£(ğº)â‰¤2 holds for all graphs G. There are many results supporting the 1â€“2â€“3 Conjecture, the most famous of which belonging to Kalkowski, KaroÅ„ski and Pfender [13], stating that for any nice graph G, we have ğœ’Î£(ğº)â‰¤5. Another important result shown in [14] states that the 1â€“2â€“3 Conjecture holds for nice 3-colourable graphs. However, unless a graph G is locally irregular (in which case ğœ’Î£(ğº)=1), it is not easy in general to characterise which graphs G have ğœ’Î£(ğº)=2 (see [12]). Nevertheless, a â€œgoodâ€ characterisation of nice bipartite graphs G with ğœ’Î£(ğº)=3, was provided quite recently in [20].

Minimising, however, the maximum label that is used to create a proper labelling of a graph G, does not always guarantee that we have actually minimised the cost that corresponds to the edge multiplications described above. For example, a 2-labelling â„“ that assigns label 2 to three edges of G and label 1 to the rest is more expensive (in terms of how many edges the corresponding multigraphs have) than a 3-labelling â„“â€² that assigns label 3 to only one edge of G and label 1 to the rest. The 1â€“2â€“3 Conjecture, if true, would imply that every nice graph G admits a proper labelling where the sum of assigned labels is at most 3|E|; but it might be that, using labels with value larger than 3, we can design better (with respect to the concerns above) proper labellings of G. This motivates us to introduce and study a new problem, namely the problem of finding proper labellings that minimise the sum of the assigned labels.

Formally, for a labelling â„“ of a graph G, we denote by ğœ(â„“) the sum of labels assigned to the edges of G by â„“. That is,

For any ğ‘˜â‰¥1, we denote by mEğ‘˜(ğº) the minimum value of ğœ(â„“) over all k-labellings â„“ of G (if any). That is,


mEğ‘˜(ğº)=min{ğœ(â„“):â„“ is a ğ‘˜- labelling of ğº}.

We set mE(ğº)=min{mEğ‘˜(ğº):ğ‘˜â‰¥ğœ’Î£(ğº)}.

The study of the parameter mE(ğº) takes place in a recent series of works dedicated to better understanding the connection between proper labellings and proper vertex-colourings of graphs. In [1], the authors studied proper vertex-colourings of graphs that minimise the number of distinct resulting colours. In other words, the authors are interested by proper labellings by which the number of distinct resulting vertex colours is as close as possible to the chromatic number. Noticing that this minimum number of distinct colours by a proper labelling is bounded above by the minimum maximum vertex colour that can be achieved by a proper labelling, in [5] the authors studied proper labellings where the maximum resulting vertex colour is as small as possible. In these two works, the authors mainly showed that finding an â€œoptimalâ€ proper labelling is hard in general but easy in particular graph classes, and provided results towards conjectures they have raised on their modified notions of proper labellings.

An important point for mentioning the existence of [1] and [5] is that determining mE(ğº) for a given graph G is also related to finding a proper labelling of G where the resulting vertex colours satisfy some properties. More precisely, by a straight equivalence between edge labels and vertex colours, see upcoming Observation 2.2, it can be established that determining mE(ğº) is equivalent to finding a proper labelling of G that minimises the sum of resulting vertex colours. Thus, at least at first glance, one could think that determining mE(ğº) is somewhat related to the investigations in [1] and [5]. In Sect. 4.1, we actually show that this is not the case, in the sense that proper labellings that are good for our concerns might be arbitrarily bad for those in [1] and [5], and vice versa.

Our contributions
In Sect. 2 we provide some observations that will be used throughout this work.Footnote 1As a warm up, we also provide the exact value of mE(ğº) for easy classes of graphs G, namely complete bipartite graphs, complete graphs and cycles.

In Sect. 3 we deal with the algorithmic aspects of the problem. We show that for ğ‘˜âˆˆâ„•, determining mEğ‘˜(ğº) is îˆºîˆ¼-complete when G is a planar bipartite graph. Then we provide an algorithm that, given two integers s and k, decides in polynomial time if mEğ‘˜(ğº)â‰¤ğ‘  when G belongs to the family of graphs that have bounded treewidth.

In Sect. 4 we answer two different questions that deal with the particular nature of our problem. First, in Sect. 4.1, we show that in general a proper k-labelling that minimises the maximum induced colour does not minimise the sum of the labels used, and vice versa. Then, in Sect. 4.2, we provide an infinite family of graphs G for which mEğ‘˜(ğº), for every ğ‘˜â‰¥2, can be arbitrarily larger than mEğ‘˜+1(ğº). As mentioned earlier, this property justifies the study of our problem, as it shows that just finding a proper k-labelling of G for ğ‘˜=ğœ’Î£(ğº) is not enough.

Finally, in Sect. 5 we study more general aspects of the problem. In particular we propose Conjecture 5.2 stating that for every nice connected graph G, we should have mE(ğº)â‰¤2|ğ¸|. We then proceed by providing upper bounds for some families of graphs, namely bipartite graphs and trees, as well as graphs with large chromatic number, that further strengthen our belief that Conjecture 5.2 should hold true.

First Observations and Classes of Graphs
In this warm-up section, we give some first insight into the problem of determining the parameters mE(ğº) and mEğ‘˜(ğº) for a given graph G. This is done through first observations on the problem, and by then focusing on easy classes of graphs.

First Observations and Remarks
The following observation provides trivial bounds on ğœ(â„“) for a k-labelling â„“.

Observation 2.1
Let G be a graph and â„“ be a k-labelling of G. Then

Consequently, for any ğ‘˜â‰¥ğœ’Î£(ğº), we have

The following provides an obvious way for relating edge labels and vertex colours by a labelling of a graph G, that, in general, is a convenient tool for establishing lower bounds on mE(ğº).

Observation 2.2
Let G be a graph and â„“ be a labelling of G. Then


âˆ‘ğ‘’âˆˆğ¸2â„“(ğ‘’)=âˆ‘ğ‘£âˆˆğ‘‰ğ‘â„“(ğ‘£).

In particular, by any labelling â„“, the sum âˆ‘ğ‘£âˆˆğ‘‰ğ‘â„“(ğ‘£) must be an even number.

In several contexts, we will make use of the following property of proper labellings in graphs having some particular sparse structure (adjacent degree-2 vertices):

Observation 2.3
Let G be a graph with a path (ğ‘£1,ğ‘£2,ğ‘£3,ğ‘£4) such that ğ‘‘(ğ‘£2)=ğ‘‘(ğ‘£3)=2. Then, by any proper labelling â„“ of G, we have â„“(ğ‘£1ğ‘£2)â‰ â„“(ğ‘£3ğ‘£4).

Proof
This is because ğ‘â„“(ğ‘£2)=â„“(ğ‘£1ğ‘£2)+â„“(ğ‘£2ğ‘£3) and ğ‘â„“(ğ‘£3)=â„“(ğ‘£2ğ‘£3)+â„“(ğ‘£3ğ‘£4). This implies we must have â„“(ğ‘£1ğ‘£2)â‰ â„“(ğ‘£3ğ‘£4) so that ğ‘â„“(ğ‘£2)â‰ ğ‘â„“(ğ‘£3). â—»

Easy Classes of Graphs
In this section, we determine the value of mE(ğº) when G is any nice complete bipartite graph, complete graph, or cycle. Let us recall that, for any nice complete bipartite graph ğ¾ğ‘›,ğ‘š, we have ğœ’Î£(ğ¾ğ‘›,ğ‘š)=1 if ğ‘›â‰ ğ‘š>1, and ğœ’Î£(ğ¾ğ‘›,ğ‘š)=2 otherwise. For every nice complete graph ğ¾ğ‘›, we have ğœ’Î£(ğ¾ğ‘›)=3. For every nice cycle ğ¶ğ‘›, we have ğœ’Î£(ğ¶ğ‘›)=3 whenever ğ‘›â‰¥3 is odd or ğ‘›â‰¡2mod4, while we have ğœ’Î£(ğ¶ğ‘›)=2 otherwise, i.e., when ğ‘›â‰¡0mod4. Simple proofs for these statements can be found e.g. in [8].

Note that in all the results obtained in this section, constructing a proper labelling â„“ of a graph G achieving ğœ(â„“)=mE(ğº) does not require the use of a label larger than ğœ’Î£(ğº). That is, we here always have mEğ‘˜(ğº)=mE(ğº) for ğ‘˜=ğœ’Î£(ğº). It is important to point out however that this behaviour is not true in general (see Sect. 4.2).

Theorem 2.4
Let ğº=(ğ´,ğµ,ğ¸)=ğ¾ğ‘›,ğ‘š be a complete bipartite graph with ğ‘›+ğ‘š>2. Then:

If ğ‘›â‰ ğ‘š, then mE(ğº)=mE1(ğº)=ğ‘›ğ‘š=|ğ¸|;

Otherwise, i.e., ğ‘›=ğ‘š, we have mE(ğº)=mE2(ğº)=ğ‘›(ğ‘š+1)=|ğ¸|+|ğ¸|â€¾â€¾â€¾âˆš.

Proof
If ğ‘›â‰ ğ‘š, then G is locally irregular, in which case we get a proper 1-labelling when assigning label 1 to all edges. This is best possible due to Observation 2.1. If ğ‘›=ğ‘š, then G is not locally irregular, which implies that a proper labelling of G must assign a label different from 1 to some edges. Moreover, if a labelling assigns a label different than 1 to less than n edges, then there would necessarily be, in both A and B, vertices incident only to edges labelled 1, thus with colour n. In that case, â„“ would not be proper as some adjacent vertices would have the same colour.

This means that if ğ‘›=ğ‘š, a proper labelling â„“ of G must assign a label different from 1 to at least n edges. This implies that mEğ‘˜(ğº)â‰¥|ğ¸|+ğ‘›. We claim there is a proper 2-labelling â„“ achieving this lower bound, hence best possible. To obtain â„“, let a be any vertex of A. Assign label 2 to all the n edges incident to a, and assign label 1 to all other edges. This labelling is proper. Indeed ğ‘â„“(ğ‘)=2ğ‘›, ğ‘â„“(ğ‘â€²)=ğ‘› for every ğ‘â€²âˆˆğ´âˆ–{ğ‘}, and ğ‘â„“(ğ‘)=ğ‘›+1 for every ğ‘âˆˆğµ. Furthermore, ğœ(â„“)=|ğ¸|+ğ‘›=|ğ¸|+|ğ¸|â€¾â€¾â€¾âˆš. â—»

Theorem 2.5
Let ğ¾ğ‘› be a complete graph with ğ‘›â‰¥3. Then:

If ğ‘›=3, then mE(ğ¾3)=mE3(ğ¾3)=6=2|ğ¸|;

If ğ‘›â‰¡0mod4 or ğ‘›â‰¡1mod4, then mE(ğ¾ğ‘›)=mE3(ğ¾ğ‘›)=12(ğ‘›2+(ğ‘›âˆ’2)(ğ‘›âˆ’1)2âˆ’1)=32|ğ¸|;

If ğ‘›â‰¡2mod4 or ğ‘›â‰¡3mod4, then mE(ğ¾ğ‘›)=mE3(ğ¾ğ‘›)=12(ğ‘›2+(ğ‘›âˆ’2)(ğ‘›âˆ’1)2)=âŒˆ32|ğ¸|âŒ‰.

Proof
Throughout this proof, for any ğ‘›â‰¥3, let ğ‘‰={ğ‘£1,â€¦,ğ‘£ğ‘›}.

Regarding the first item, Observation 2.3 implies that a proper 3-labelling of ğ¾3 must assign three distinct labels to the edges, and thus having {â„“(ğ‘£1ğ‘£2),â„“(ğ‘£1ğ‘£3),â„“(ğ‘£2ğ‘£3)}={1,2,3} is optimal, in which case ğœ(â„“)=6.

Let us now focus on the second and third items. Following Observation 2.2, finding a proper 3-labelling of ğ¾ğ‘› achieving mE3(ğ¾ğ‘›) is equivalent to finding a proper 3-labelling minimising the sum of vertex colours. Since, in ğ¾ğ‘›, all vertices have degree ğ‘›âˆ’1, and all vertex colours must be different by a proper 3-labelling, any proper 3-labelling producing distinct vertex colours in ğ‘†1={ğ‘›âˆ’1,ğ‘›,ğ‘›+1,â€¦,2ğ‘›âˆ’2} would be optimal. Note, however, that when n is congruent to 2 or 3 modulo 4, such a proper 3-labelling cannot exist as, in such cases, the sum ğ‘›âˆ’1+ğ‘›+(ğ‘›+1)+â‹¯+(2ğ‘›âˆ’2) of the values in ğ‘†1 is odd, which cannot be achieved by a labelling (recall the last statement of Observation 2.2). In these cases, however, any proper labelling producing distinct vertex colours in ğ‘†2={ğ‘›âˆ’1,ğ‘›,ğ‘›+1,â€¦,2ğ‘›âˆ’3,2ğ‘›âˆ’1} would be optimal.

Now consider the following 3-labelling â„“ of ğ¾ğ‘› (ğ‘›â‰¥4), already introduced in [5], to establish what the value of mS3(ğ¾ğ‘›) is (where mS3(ğº) denotes the smallest maximum color over the vertices by a proper 3-labelling of G). We label the edges of ğ¾ğ‘› through three steps. Firstly, we assign label 1 to every edge. Secondly, we change the labels of the edges in {ğ‘£ğ‘–ğ‘£ğ‘— : 1â‰¤ğ‘–,ğ‘—â‰¤ğ‘›,ğ‘–+ğ‘—â‰¥ğ‘›+2} to 2. Then ğ‘£1 is incident to no edge labelled 2, vertex ğ‘£2 is incident to one edge labelled 2, vertex ğ‘£ğ‘– for 3â‰¤ğ‘–â‰¤âŒŠ(ğ‘›âˆ’1)/2âŒ‹+1 is incident to ğ‘–âˆ’1 edges labelled 2, and ğ‘£ğ‘– for âŒŠ(ğ‘›âˆ’1)/2âŒ‹+2â‰¤ğ‘–â‰¤ğ‘› is incident to ğ‘–âˆ’2 edges labelled 2. Let ğ‘—=âŒŠ(ğ‘›âˆ’1)/2âŒ‹+1. Note that for every ğ‘–âˆˆ{2,3,â€¦,ğ‘—,ğ‘—+2,â€¦,ğ‘›}, ğ‘£ğ‘– is adjacent to one more edge labelled 2 than ğ‘£ğ‘–âˆ’1; and that ğ‘£ğ‘— and ğ‘£ğ‘—+1 are both adjacent to ğ‘—âˆ’1 edges labelled 2 (and ğ‘›âˆ’ğ‘— edges labelled 1). So ğ‘ğ‘™(ğ‘£1)<ğ‘ğ‘™(ğ‘£2)<â‹¯<ğ‘ğ‘™(ğ‘£ğ‘—)=ğ‘ğ‘™(ğ‘£ğ‘—+1)<ğ‘ğ‘™(ğ‘£ğ‘—+2)<â‹¯<ğ‘ğ‘™(ğ‘£ğ‘›) and ğ‘ğ‘™(ğ‘£ğ‘–+1)â‰¤ğ‘ğ‘™(ğ‘£ğ‘–)+1 for 1â‰¤ğ‘–â‰¤ğ‘›, i.e., all vertices have different colours except ğ‘£ğ‘— and ğ‘£ğ‘—+1. Finally, to avoid the conflict between ğ‘£ğ‘— and ğ‘£ğ‘—+1, let us increase the label of ğ‘£ğ‘—+1ğ‘£ğ‘—+2 from 2 to 3. This change induces a new conflict between ğ‘£ğ‘—+2 and ğ‘£ğ‘—+3. Then we need to increase the label of ğ‘£ğ‘—+3ğ‘£ğ‘—+4 from 2 to 3 to get rid of this conflict, which creates a new conflict, and so on. Formally, we change the labels of the edges in {ğ‘£ğ‘—+1ğ‘£ğ‘—+2,ğ‘£ğ‘—+3ğ‘£ğ‘—+4,â€¦,ğ‘£ğ‘›âˆ’1ğ‘£ğ‘›} to 3 if ğ‘›âˆ’ğ‘— is even, i.e., if ğ‘›â‰¡0mod4 or ğ‘›â‰¡1mod4. Otherwise, if ğ‘›âˆ’ğ‘— is odd and ğ‘›â‰¡2mod4 or ğ‘›â‰¡3mod4, then we change the labels of the edges in {ğ‘£ğ‘—+1ğ‘£ğ‘—+2,ğ‘£ğ‘—+3ğ‘£ğ‘—+4,â€¦,ğ‘£ğ‘›âˆ’4ğ‘£ğ‘›âˆ’3,ğ‘£ğ‘›âˆ’2ğ‘£ğ‘›,ğ‘£ğ‘›âˆ’1ğ‘£ğ‘›} to 3.

It can be checked that the resulting 3-labelling â„“ is proper, and achieves vertex colours in ğ‘†1 when n is congruent to 0 or 1 modulo 4, or vertex colours in ğ‘†2 when n is congruent to 2 or 3 modulo 4. As discussed above, this is best possible. Furthermore, it can easily be checked that the elements in ğ‘†1 sum up to the value claimed in the second item, and similarly for the elements in ğ‘†2 and the value claimed in the third item. This concludes the proof. â—»

Theorem 2.6
Let ğ‘›â‰¥3, and ğ¶ğ‘› be the cycle of length n. Then:

If ğ‘›â‰¡0mod4, then mE(ğ¶ğ‘›)=mE2(ğ¶ğ‘›)=32|ğ¸|;

If ğ‘›â‰¡1mod4 or ğ‘›â‰¡3mod4, then mE(ğ¶ğ‘›)=mE3(ğ¶ğ‘›)=âŒˆ32|ğ¸|âŒ‰+1;

If ğ‘›â‰¡2mod4, then mE(ğ¶ğ‘›)=mE3(ğ¶ğ‘›)=32|ğ¸|+3.

Proof
Let us order the edges of ğ¶ğ‘› following a â€œclockwise directionâ€ and define ğ¸={ğ‘’1,â€¦,ğ‘’ğ‘›} and ğ‘‰={ğ‘£1,â€¦,ğ‘£ğ‘›} such that for ğ‘–<ğ‘›, ğ‘’ğ‘–=ğ‘£ğ‘–ğ‘£ğ‘–+1 and ğ‘’ğ‘›=ğ‘£ğ‘›ğ‘£1. Thus, for ğ‘–>0, ğ‘(ğ‘£ğ‘–)={ğ‘£ğ‘–âˆ’1,ğ‘£ğ‘–+1} and ğ‘(ğ‘£1)={ğ‘£2,ğ‘£ğ‘›}. Recall that ğœ’Î£(ğ¶ğ‘›)=2 for the first item and that ğœ’Î£(ğ¶ğ‘›)=3 for the second and third items.

Claim 2.7
Let ğ‘™â‰¤ğ‘˜ and â„“ be a k-labelling of ğ¶ğ‘› that assigns label l to at least one edge. If â„“ is proper, then it assigns label l to at most  edges if n is odd, while it assigns label l to at most 12|ğ¸|âˆ’1 edges if ğ‘›â‰¡2mod4, and it assigns label l to at most 12|ğ¸| edges if ğ‘›â‰¡0mod4.

Proof of the claim Let îˆ±={ğ‘’âˆˆğ¸:â„“(ğ‘’)=ğ‘™} and ğº=(ğ‘‰â€²,ğ¸â€²) be the graph that has ğ‘‰â€²={ğ‘£ğ‘–:ğ‘’ğ‘–âˆˆğ¸} and, for ğ‘–â‰ ğ‘—, ğ‘£ğ‘–ğ‘£ğ‘—âˆˆğ¸â€² if the corresponding edges ğ‘’ğ‘–,ğ‘’ğ‘— are at distance exactly 2 in ğ¶ğ‘›. Obviously |ğ¸|=|ğ‘‰â€²|. It follows from Observation 2.3 that if â„“ is a proper labelling of ğ¶ğ‘› that maximises |îˆ±|, then |îˆ±|=|ğ‘†|, where S is an independent set of G. For n odd, G is a copy of the graph ğ¶ğ‘›. Since G is a cycle, . For ğ‘›â‰¡2mod4, let m be such that ğ‘›=4ğ‘š+2. It is clear that G contains two connected components, each one being a copy of the ğ¶ğ‘›2 cycle. Thus, . Similarly, if ğ‘›=4ğ‘š, it is clear that G contains two connected components, each one being a copy of the ğ¶ğ‘›2 cycle. Thus, |îˆ±|=|ğ‘†|=2ğ‘š=12|ğ¸|. â‹„

We are now ready to deal with the four values of n (modulo 4) separately:

For the first item let â„“ be the following 2-labelling: â„“(ğ‘’1)=1,â„“(ğ‘’2)=1,â„“(ğ‘’3)=2,â„“(ğ‘’4)=2,â„“(ğ‘’5)=1,â€¦,â„“(ğ‘’ğ‘›)=2. Let us assume that this â„“ is not proper. Then there would exist at least two adjacent vertices ğ‘£ğ‘–,ğ‘£ğ‘–+1 such that ğ‘â„“(ğ‘£ğ‘–)=ğ‘â„“(ğ‘£ğ‘–+1). It follows that â„“(ğ‘£ğ‘–âˆ’1)=â„“(ğ‘£ğ‘–+2) (if ğ‘–=1 then ğ‘£ğ‘–âˆ’1=ğ‘£ğ‘› and if ğ‘–=ğ‘› then ğ‘£ğ‘–+1=ğ‘£1) which is a contradiction. Furthermore, since ğ‘›â‰¡0mod4, label 2 is used on exactly half the edges of ğ¶ğ‘› and thus ğœ(â„“)=|ğ¸|+12|ğ¸|=32|ğ¸|. Moreover, this value is optimal. Indeed, assume it is not. Then, there would exist a proper labelling â„“â€² such that more than 12|ğ¸| edges are labelled 1 by â„“â€², a contradiction by Claim 2.7.

Let ğ¶ğ‘› be a cycle with ğ‘›â‰¡1mod4. We will show that . Let â„“ be a proper labelling of ğ¶ğ‘› that assigns label 3 to only one edge. It follows from Claim 2.7 that at most  edges of ğ¶ğ‘› are labelled 1. Actually, there are exactly  edges labelled 1: if this was not the case, then, since only one edge of ğ¶ğ‘› is labelled 3, there would be more than  edges labelled 2, contradicting Claim 2.7. The same holds true for the edges labelled 2. Since ğ‘›â‰¡1mod4 implies that there exists an m verifying ğ‘›=4ğ‘š+1, then, using this, one can easily show that . Furthermore, let â„“â€² be a proper labelling of ğ¶ğ‘› that assigns label 3 to more than one edge. It is clear that if â„“â€² is proper, then ğœ(â„“)<ğœ(â„“â€²). Thus, ğœ(â„“)=mE(ğ¶ğ‘›). The following is a proper labelling â„“ that achieves this optimal value: â„“(ğ‘’1)=1,â„“(ğ‘’2)=1,â„“(ğ‘’3)=2,â„“(ğ‘’4)=2,â„“(ğ‘’5)=1,â€¦,â„“(ğ‘’ğ‘›âˆ’1)=2,â„“(ğ‘’ğ‘›)=3.

Let ğ¶ğ‘› be a cycle with ğ‘›â‰¡3mod4. Similarly to before, . The following is a proper labelling â„“ that achieves this optimal value: â„“(ğ‘’1)=1,â„“(ğ‘’2)=1,â„“(ğ‘’3)=2,â„“(ğ‘’4)=2,â„“(ğ‘’5)=1,â€¦,â„“(ğ‘’ğ‘›âˆ’3)=2,â„“(ğ‘’ğ‘›âˆ’2)=1,â„“(ğ‘’ğ‘›âˆ’1)=3,â„“(ğ‘’ğ‘›)=2.

Let ğ¶ğ‘› be a cycle with ğ‘›â‰¡2mod4 (ğ‘›â‰¥6). We will show that mE(ğ¶ğ‘›)=32|ğ¸|+3. Indeed, let â„“ be a proper labelling of ğ¶ğ‘› that assigns label 3 to only one edge. Since â„“ is proper, it is obliged to assign label 1 to at most 12|ğ¸|âˆ’1 edges of ğ¶ğ‘› and label 2 to the rest. This however would lead to â„“ assigning label 2 on at least 12|ğ¸| edges, which is a contradiction to Claim 2.7. Thus, â„“ must assign label 3 on at least two edges. Similarly to before, a labelling that assigns label 3 to exactly two edges, label 1 to at most 12|ğ¸|âˆ’1 edges, and label 2 to the rest of the edges, would achieve the optimal value. The following â„“ is one such proper labelling: â„“(ğ‘’1)=1,â„“(ğ‘’2)=1,â„“(ğ‘’3)=2,â„“(ğ‘’4)=2,â„“(ğ‘’5)=1,â€¦,â„“(ğ‘’ğ‘›âˆ’3)=2,â„“(ğ‘’ğ‘›âˆ’2)=2,â„“(ğ‘’ğ‘›âˆ’1)=3,â„“(ğ‘’ğ‘›)=3.

â—»

Complexity Aspects
In this section, we establish both a negative and a positive result on the complexity of computing the parameter mEğ‘˜(ğº) for some input integer k and nice graph G. More precisely:

We first prove that determining mE2(ğº) is îˆºîˆ¼-complete, even when G is restricted to a planar bipartite graph. Recall that this is contrasting with the complexity of determining whether ğœ’Î£(ğº)â‰¤2 holds for a given bipartite graph G, which is a problem that can be solved in polynomial time due to a result of Thomassen, Wu and Zhang [20].

We then prove that determining mEğ‘˜(ğº) can be done in polynomial time whenever k is fixed and G is a graph with bounded treewidth.

A Negative Result for Bipartite Graphs
In this section, we prove, in Theorem 3.2 below, that the problem of determining mEğ‘˜(ğº) is îˆºîˆ¼-complete in planar bipartite graphs G.

Let us first introduce the k-gadget, for ğ‘˜â‰¥2, which will be useful for proving Theorem 3.2. To build this gadget, let us start with ğ‘˜âˆ’1 stars, each having a center ğ‘ ğ‘– with ğ‘‘(ğ‘ ğ‘–)=ğ‘˜+1 for every ğ‘–âˆˆ{1,â€¦,ğ‘˜âˆ’1}. For each star, pick an arbitrary edge ğ‘ ğ‘–ğ‘¦ğ‘– and identify all the ğ‘¦ğ‘–â€™s into a single vertex y, which is called the representative of the gadget. Finally add another vertex u, called the root of the gadget, and join it to y via an edge. It is clear that ğ‘‘(ğ‘¢)=1 and ğ‘‘(ğ‘¦)=ğ‘˜. Each k-gadget is a tree with îˆ»(ğ‘˜2) edges. Let v be a vertex of a graph G, and H be a k-gadget. The operation of adding H to G and identifying the root u of H with v is called attaching H to v.

Claim 3.1
Let G(V, C, E) be a bipartite graph and â„“ be any proper 2-labelling of G such that ğœ(â„“)â‰¤|ğ¸|+ğ‘, for ğ‘=|ğ¶|. Let H be any p-gadget attached to G, where ğ‘âˆ’1>ğ‘, forming the graph ğºâ€². Let y be the representative of H. Let â„“â€² be a labelling of ğºâ€² such that for all edges ğ‘’âˆˆğ¸(ğº), we have â„“â€²(ğ‘’)=â„“(ğ‘’). If at least one edge e of H incident to y is labelled 2 by â„“â€², then there are at least two edges of H that are labelled 2 by â„“â€².

Proof of the claim Let us suppose that at least one of the edges of H incident to y is labelled 2. Let ğ‘§âˆˆğ‘‰âˆªğ¶ be the vertex of ğºâ€² to which H has been attached.

Let us first assume that the edge zy is labelled 2. If y is incident to only a single edge labelled 2 (i.e., zy), then its colour is ğ‘â„“(ğ‘¦)=ğ‘+1. Since all its ğ‘âˆ’1 neighbours (different from z) have degree ğ‘+1, each of them must be incident to at least one edge labelled 2 as otherwise it would have the same colour as y. This leads to at least ğ‘>ğ‘ edges labelled 2, which is a contradiction (observe that since ğœ(â„“)â‰¤|ğ¸|+ğ‘, there are at most c edges labelled 2). Otherwise, if y has exactly one other incident edge (different from yz) labelled 2, say the edge yw, then we are done.

Then, let us assume that â„“(ğ‘¦ğ‘§)=1. Moreover, let us assume that some edge incident to y, say ğ‘¦ğ‘¤1 different from yz, is labelled 2. Then ğ‘â„“(ğ‘¦)â‰¥ğ‘+1 with ğ‘â„“(ğ‘¦)=ğ‘+1 if ğ‘¦ğ‘¤1 is the unique edge incident to y labelled 2. In this case, each one of the ğ‘âˆ’2 neighbours of y (different from z and ğ‘¤1) must be incident to at least one edge labelled 2, leading to at least ğ‘âˆ’1>ğ‘ edges labelled 2, which is a contradiction. Thus ğ‘â„“(ğ‘¦)>ğ‘+1, which means there is at least one more edge ğ‘¦ğ‘¤2 incident to y labelled 2. â‹„

We are now ready for proving our result.

Theorem 3.2
Let G be a nice planar bipartite graph, ğ‘˜â‰¥2 and ğ‘âˆˆâ„•. The problem of deciding if mEğ‘˜(ğº)â‰¤ğ‘ is îˆºîˆ¼-complete.

Proof
The problem is clearly in îˆºîˆ¼. We focus on showing it is also îˆºîˆ¼-hard. The proof is done by reduction from Planar Monotone 1-in-3 SAT, which was shown to be îˆºîˆ¼-complete in [17]. In this problem, a 3CNF formula F is given as input, which has clauses with exactly three distinct variables all of which appear only positively. We say that a bipartite graph ğºâ€²=(ğ‘‰,ğ¶,ğ¸) corresponds to F if it is constructed from F in the following way: for each variable ğ‘¥ğ‘– of F add a variable vertex ğ‘£ğ‘– in V and for each clause ğ¶ğ‘— of F add a clause vertex ğ‘ğ‘— in C. Then the edge ğ‘£ğ‘–ğ‘ğ‘— is added if variable ğ‘¥ğ‘– appears in clause ğ¶ğ‘—. Furthermore, F is valid as input to the Planar Monotone 1-in-3 SAT problem if the graph ğºâ€² that corresponds to F is planar. The question is whether there exists a 1-in-3 truth assignment of F; that is a truth assignment to the variables of F such that each clause has exactly one variable with the value true.

Observe now that we may assume that each variable appears in at least two clauses. If there exists a variable, say ğ‘¥ğ‘–, that belongs to a single clause ğ¶=(ğ‘¥ğ‘–âˆ¨ğ‘¥ğ‘—âˆ¨ğ‘¥ğ‘˜), let us add another clause ğ¶â€² identical to C. Clearly, the obtained formula ğ¹â€² is 1-in-3 satisfiable if and only if F is. Moreover, the graph corresponding to ğ¹â€² is planar. Indeed, consider a planar embedding of the graph ğºâ€²âˆ–{ğ‘£ğ‘–} (where ğ‘£ğ‘– is the vertex of ğºâ€² corresponding to ğ‘¥ğ‘–). Clearly, ğ‘£ğ‘— and ğ‘£ğ‘˜ are in a same face (since their common neighbour, corresponding to C, has degree 2 in ğºâ€²âˆ–{ğ‘£ğ‘–}). The graph obtained by adding a vertex ğ‘£ğ‘– (adjacent to the vertex corresponding to C) and a vertex corresponding to ğ¶â€² (adjacent to ğ‘£ğ‘–,ğ‘£ğ‘— and ğ‘£ğ‘˜) in this face is planar.

Let us prove the statement for ğ‘˜=2. Let F be a 3CNF formula with c clauses that is given as input to the Planar Monotone 1-in-3 SAT problem. Our goal is to construct a planar bipartite graph G such that F is 1-in-3 satisfied if and only if mE2(ğº)â‰¤|ğ¸(ğº)|+ğ‘.

Start from ğºâ€²=(ğ‘‰,ğ¶,ğ¸) being the planar bipartite graph that corresponds to F, with V being the set of the variable vertices ğ‘£ğ‘– and C being the set of the clause vertices ğ‘ğ‘—. Note that in F, each clause has exactly three variables but there is no bound on how many times a variable appears in F. Thus for each ğ‘£ğ‘–âˆˆğ‘‰, we have ğ‘‘(ğ‘£ğ‘–)â‰¥2 and for each ğ‘ğ‘—âˆˆğ¶, we have ğ‘‘(ğ‘ğ‘—)=3. It follows that |ğ¶|=ğ‘ and |ğ‘‰|â‰¤3ğ‘.

Proceed by modifying ğºâ€² by adding the gadgets described earlier. For each variable vertex ğ‘£ğ‘– , let ğ‘‘ğ‘– be the initial degree of ğ‘£ğ‘– in ğºâ€². Let ğ‘‘ğ‘£,ğ‘–=(ğ‘‘ğ‘–âˆ’1)(ğ‘+1)+ğ‘‘ğ‘– and ğ‘‘ğ‘=3(ğ‘+1)+3. For each variable vertex ğ‘£ğ‘–, for all 1â‰¤ğ‘—<ğ‘‘ğ‘–, attach ğ‘+1 copies of the (ğ‘‘ğ‘£,ğ‘–+ğ‘—)-gadget. On each clause vertex ğ‘ğ‘—, attach ğ‘+1 copies of the ğ‘‘ğ‘-gadget, ğ‘+1 copies of the (ğ‘‘ğ‘+2)-gadget and ğ‘+1 copies of the (ğ‘‘ğ‘+3)-gadget. Name the resulting graph G and observe that the degree of each ğ‘£ğ‘– in G becomes equal to ğ‘‘ğ‘£,ğ‘– and the degree of each ğ‘ğ‘— in G becomes equal to ğ‘‘ğ‘. Clearly, the construction of G is achieved in polynomial time. Finally observe that since ğºâ€² is planar and the attached gadgets are actually trees, G is also planar.

Let â„“ be a proper 2-labelling of G such that ğœ(â„“)â‰¤|ğ¸(ğº)|+ğ‘, i.e., there are at most c edges of G labelled 2 by â„“. Observe that G contains p-gadgets for ğ‘âˆˆ{ğ‘‘ğ‘£,ğ‘–+1,ğ‘‘ğ‘£,ğ‘–+2,â€¦,ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘–âˆ’1,ğ‘‘ğ‘,ğ‘‘ğ‘+2,ğ‘‘ğ‘+3} and ğ‘‘ğ‘£,ğ‘–âˆ’1,ğ‘‘ğ‘âˆ’1>ğ‘. Thus Claim 3.1 holds for each gadget attached to G.

Claim 3.3
For any proper 2-labelling â„“ of G such that ğœ(â„“)â‰¤|ğ¸(ğº)|+ğ‘, we have that:

ğ‘â„“(ğ‘£ğ‘–)âˆ‰{ğ‘‘ğ‘£,ğ‘–+1,ğ‘‘ğ‘£,ğ‘–+2,â€¦,ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘–âˆ’1} for each variable vertex ğ‘£ğ‘–âˆˆğ‘‰;

ğ‘â„“(ğ‘ğ‘—)âˆ‰{ğ‘‘ğ‘,ğ‘‘ğ‘+2,ğ‘‘ğ‘+3} for each clause vertex ğ‘ğ‘—âˆˆğ¶.

Proof of the claim. Indeed, each variable vertex ğ‘£ğ‘– is adjacent to ğ‘+1 copies of the (ğ‘‘ğ‘£,ğ‘–+1)-gadget and at most c edges are labelled 2 by â„“. Thus, at least one of the (ğ‘‘ğ‘£,ğ‘–+1)-gadgets, let us call it H, that is attached to ğ‘£ğ‘–, has all of its edges labelled 1. Moreover, ğ‘£ğ‘– is adjacent to the representative y of H which has degree ğ‘‘(ğ‘¦)=ğ‘‘ğ‘£,ğ‘–+1. Since all the edges of H are labelled 1, the colour ğ‘â„“(ğ‘¦) of y is ğ‘‘ğ‘£,ğ‘–+1 and thus this colour is forbidden for ğ‘£ğ‘–, i.e., ğ‘â„“(ğ‘£ğ‘–)â‰ ğ‘‘ğ‘£,ğ‘–+1.

By repeating the same arguments for the (ğ‘‘ğ‘£,ğ‘–+2)-gadgets attached to ğ‘£ğ‘–, we deduce that ğ‘â„“(ğ‘£ğ‘–)â‰ ğ‘‘ğ‘£,ğ‘–+2. Similarly, by considering the ğ‘‘ğ‘-gadgets (resp., the (ğ‘‘ğ‘+2)- and (ğ‘‘ğ‘+3)-gadgets) attached to any clause vertex ğ‘ğ‘—, we get that ğ‘â„“(ğ‘ğ‘—)âˆ‰{ğ‘‘ğ‘,ğ‘‘ğ‘+2,ğ‘‘ğ‘+3}. â‹„

Claim 3.4
Let â„“ be any proper 2-labelling of G such that ğœ(â„“)â‰¤|ğ¸(ğº)|+ğ‘. Then all edges of the attached gadgets must be labelled 1.

Proof of the claim. Observe that for each clause vertex ğ‘§âˆˆğ¶, at least one of its incident edges must be labelled 2. If this were not the case, then ğ‘â„“(ğ‘§)=ğ‘‘ğ‘, and this is not allowed due to Claim 3.3.

Let H be a gadget attached to z, and y be the representative of H. Suppose â„“(ğ‘¦ğ‘§)=2. It follows from Claim 3.1 that there are at least two edges of H labelled 2. Recall that the number of edges of G that can be labelled 2 is at most c. Thus, the number of edges of G, that do not belong to H and can be labelled 2, is at most ğ‘âˆ’2. Furthermore, there are ğ‘âˆ’1 clause vertices in G that are different from z. It follows that there exists a clause vertex that has all of its incident edges labelled 1, a contradiction. Thus, each ğ‘§âˆˆğ¶ must be incident to an edge wz with â„“(ğ‘¤ğ‘§)=2 and w cannot belong to a gadget attached to z. It follows that there must be |ğ¶|=ğ‘ edges of ğºâ€² labelled 2 and since ğœ(â„“)â‰¤|ğ¸(ğº)|+ğ‘, all the edges of the attached gadgets are labelled 1. â‹„

It follows from Claim 3.4, that the only possible colours induced on the vertices of ğºâ€² by a proper 2-labelling â„“ of G are:

ğ‘â„“(ğ‘£ğ‘–)âˆˆ{ğ‘‘ğ‘£,ğ‘–,ğ‘‘ğ‘£,ğ‘–+1,ğ‘‘ğ‘£,ğ‘–+2,â€¦,ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘–âˆ’1,ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘–} for each variable vertex ğ‘£ğ‘–âˆˆğ‘‰,

ğ‘â„“(ğ‘ğ‘—)âˆˆ{ğ‘‘ğ‘,ğ‘‘ğ‘+1,ğ‘‘ğ‘+2,ğ‘‘ğ‘+3} for each clause vertex ğ‘ğ‘—âˆˆğ¶.

The following hold due to Claim 3.3:

For every variable vertex ğ‘£ğ‘–, we have ğ‘â„“(ğ‘£ğ‘–)âˆˆ{ğ‘‘ğ‘£,ğ‘–,ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘–}. Observe that ğ‘â„“(ğ‘£ğ‘–)=ğ‘‘ğ‘£,ğ‘– if all edges of ğºâ€² adjacent to ğ‘£ğ‘– are labelled 1, and ğ‘â„“(ğ‘£ğ‘–)=ğ‘‘ğ‘£,ğ‘–+ğ‘‘ğ‘– if all edges of ğºâ€² adjacent to ğ‘£ğ‘– are labelled 2.

For every clause vertex ğ‘ğ‘—, we have ğ‘â„“(ğ‘ğ‘—)=ğ‘‘ğ‘+1, which corresponds to two edges of ğºâ€² adjacent to ğ‘ğ‘— labelled 1 and only one edge labelled 2.

We are now ready to show the equivalence between finding a 1-in-3 truth assignment ğœ™ of F and finding a proper 2-labelling â„“ of G such that ğœ(â„“)=mE2(ğº)â‰¤|ğ¸(ğº)|+ğ‘. An edge ğ‘£ğ‘–ğ‘ğ‘— of ğºâ€² labelled 2 (respectively 1) by â„“ corresponds to variable ğ‘¥ğ‘– bringing truth value true (respectively false) to clause ğ¶ğ‘— by ğœ™. Also, we know that in ğºâ€², every variable vertex ğ‘£ğ‘– is incident to ğ‘›â‰¥1 edges, all having the same label (either 1 or 2). Accordingly, the corresponding variable ğ‘¥ğ‘– brings, by ğœ™, the same truth value to the n clauses of F that contain it. Finally, in ğºâ€², every clause vertex ğ‘ğ‘— is incident to two edges labelled 1 and one edge labelled 2. This corresponds to the clause ğ¶ğ‘— being regarded as satisfied by ğœ™ only when it has exactly one true variable. â—»

A Positive Result for Graphs with Bounded Treewidth
Given a graph ğº=(ğ‘‰,ğ¸), a tree-decomposition of G is a pair (ğ‘‡,î‰„) such that ğ‘‡=(ğ‘‰(ğ‘‡),ğ¸(ğ‘‡)) is a tree and î‰„={ğ‘‹ğ‘¡âŠ†ğ‘‰âˆ£ğ‘¡âˆˆğ‘‰(ğ‘‡)} is a familly of subsets (called bags) of vertices of G such that:

ğ‘‰=â‹ƒğ‘¡âˆˆğ‘‰(ğ‘‡)ğ‘‹ğ‘¡;

For every ğ‘¢ğ‘£âˆˆğ¸, there exists ğ‘¡âˆˆğ‘‰(ğ‘‡) with ğ‘¢,ğ‘£âˆˆğ‘‹ğ‘¡; and

For every ğ‘£âˆˆğ‘‰, the subset {ğ‘¡âˆˆğ‘‰(ğ‘‡)âˆ£ğ‘£âˆˆğ‘‹ğ‘¡} induces a subtree of T.

The width of (ğ‘‡,î‰„) is equal to maxğ‘¡âˆˆğ‘‰(ğ‘‡)|ğ‘‹ğ‘¡|âˆ’1 and the tree-width tw(ğº) is the minimum width of a tree-decomposition of G.

A tree-decomposition (ğ‘‡,î‰„) is nice [7] if T is rooted in ğ‘Ÿâˆˆğ‘‰(ğ‘‡) and every node ğ‘¡âˆˆğ‘‰(ğ‘‡) is exactly of one of the following four types:

1.
Leaf t is a leaf of T and |ğ‘‹ğ‘¡|=1.

2.
Introduce t has a unique child ğ‘¡â€² and there exists ğ‘£âˆˆğ‘‰ such that ğ‘‹ğ‘¡=ğ‘‹ğ‘¡â€²âˆª{ğ‘£}.

3.
Forget t has a unique child ğ‘¡â€² and there exists ğ‘£âˆˆğ‘‰ such that ğ‘‹ğ‘¡â€²=ğ‘‹ğ‘¡âˆª{ğ‘£}.

4.
Join t has exactly two children ğ‘¡â€²,ğ‘¡â€³ and ğ‘‹ğ‘¡=ğ‘‹ğ‘¡â€²=ğ‘‹ğ‘¡â€³.

It is well known that every graph ğº=(ğ‘‰,ğ¸) admits a nice tree-decomposition (ğ‘‡,î‰„) rooted in ğ‘Ÿâˆˆğ‘‰(ğ‘‡), that has width equal to tw(ğº), |ğ‘‰(ğ‘‡)|=îˆ»(|ğ‘‰|) and ğ‘‹ğ‘Ÿ={âˆ…} [7].

Let (ğ‘‡,î‰„) be a rooted tree-decomposition (with root r) of G and ğ‘¡âˆˆğ‘‰(ğ‘‡). A subtree of T induced by t and its descendants is denoted as ğ‘‡ğ‘¡ and the corresponding subgraph of G, i.e., the graph induced by âˆªğ‘¡â€²âˆˆğ‘‰(ğ‘‡ğ‘¡)ğ‘‹ğ‘¡â€², is denoted by ğºğ‘¡ (clearly, ğºğ‘Ÿ=ğº). For every ğ‘£âˆˆğ‘‰(ğºğ‘¡), let ğ‘ğ‘¡(ğ‘£) denote the neighbourhood of v in ğºğ‘¡, that is ğ‘ğ‘¡(ğ‘£)={ğ‘¢âˆˆğ‘‰(ğºğ‘¡):ğ‘¢ğ‘£âˆˆğ¸(ğºğ‘¡)}. A quasi k-labelling of ğºğ‘¡ consists of a pair of functions (â„“,ğ‘), with â„“:ğ¸(ğºğ‘¡)â†’{1,â€¦,ğ‘˜} and ğ‘:ğ‘‰(ğºğ‘¡)â†’â„•, such that c is a proper vertex-colouring of ğºğ‘¡, for every ğ‘£âˆˆğ‘‰(ğºğ‘¡)âˆ–ğ‘‹ğ‘¡ we have ğ‘(ğ‘£)=ğ‘â„“(ğ‘£), and for every ğ‘£âˆˆğ‘‰(ğ‘‹ğ‘¡) we have ğ‘(ğ‘£)â‰¥ğ‘â„“(ğ‘£). Intuitively, the notion of quasi k-labelling is a generalisation of proper k-labellings that allows us to further modify the labels (and thus the induced colours) of the edges of ğ‘‹ğ‘¡ if this is needed in order to extend a proper k-labelling of ğºğ‘¡ into a proper k-labelling of ğºğ‘¡â€², where ğ‘¡â€² is the parent of t in T. Finally, let ğ‘ ğ‘¡(â„“)=âˆ‘ğ‘’âˆˆğ¸(ğºğ‘¡)â„“(ğ‘’).

Observe that every proper k-labelling â„“â€² of G induces a quasi k-labelling of ğºğ‘¡. For every ğ‘’âˆˆğ¸(ğºğ‘¡) and ğ‘£âˆˆğ‘‰(ğºğ‘¡), let â„“(ğ‘’)=â„“â€²(ğ‘’) and ğ‘(ğ‘£)=ğ‘â„“â€²(ğ‘£). The pair (â„“,ğ‘) is a quasi k-labelling of ğºğ‘¡. Indeed, since (ğ‘‡,î‰„) is a tree-decomposition of G, for every internal node t of T, ğ‘‹ğ‘¡ is a separator between ğºğ‘¡âˆ’ğ‘‹ğ‘¡ and ğºâˆ’ğ‘‰(ğºğ‘¡). Put differently, there are no edges between vertices of ğºğ‘¡âˆ’ğ‘‹ğ‘¡ and ğºâˆ’ğ‘‰(ğºğ‘¡). Furthermore, if r is such that ğ‘‹ğ‘Ÿ=âˆ…, then a quasi k-labelling of ğºğ‘Ÿ is a proper k-labelling of G. Indeed, it is true (by definition) that a quasi k-labelling of ğºğ‘Ÿ differs from a proper k-labelling only on the vertices of ğ‘‹ğ‘Ÿ and since ğ‘‹ğ‘Ÿ=âˆ… and ğºğ‘Ÿ=ğº the observation follows.

Theorem 3.5
Let ğ‘˜â‰¥2 and twâ‰¥1 be two fixed integers. Given a nice graph ğº=(ğ‘‰,ğ¸) with |ğ‘‰|=ğ‘› and an integer s, the problem of deciding whether mEğ‘˜(ğº)â‰¤ğ‘  holds can be solved in polynomial time if G belongs to the family of graphs that have width at most tw (and in linear time if G is additionally of bounded maximum degree).

Proof
Let us start by giving some definitions. Let Î”=Î”(ğº) denote the maximum degree of G. For every ğ‘¡âˆˆğ‘‰(ğ‘‡), let |ğ‘‹ğ‘¡|=ğ‘¤ğ‘¡, |ğ¸(ğº[ğ‘‹ğ‘¡])|=ğ‘ğ‘¡, ğ‘‹ğ‘¡={ğ‘£1,â€¦,ğ‘£ğ‘¤ğ‘¡} and ğ¸(ğº[ğ‘‹ğ‘¡])={ğ‘’1,â€¦,ğ‘’ğ‘ğ‘¡} (to simplify the notation, we will simply denote ğ‘ğ‘¡ and ğ‘¤ğ‘¡ by q and w respectively). Let îˆ²ğ‘¡={1,â€¦,ğ‘˜}ğ‘Ã—{1,â€¦,ğ‘˜Î”}ğ‘¤Ã—{0,â€¦,ğ‘˜Î”}ğ‘¤ and (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡, where ğ¿={ğ‘™1,â€¦,ğ‘™ğ‘}, ğ¹ğ¶={ğ‘“1,â€¦,ğ‘“ğ‘¤} and ğ¶ğµ={ğ‘1,â€¦,ğ‘ğ‘¤}. The labels we â€œintentâ€ to assign to the edges of ğ‘‹ğ‘¡ are in L, the â€œfinal coloursâ€ induced by these labels on the vertices of ğ‘‹ğ‘¡ are in FC, and in CB we can find the contribution to these colours that come â€œfrom belowâ€ (meaning the part of these final colours that are due to edges between ğ‘‹ğ‘¡ and ğºğ‘¡âˆ’ğ‘‹ğ‘¡). Furthermore, for ğ‘‹â€²ğ‘¡âŠ†ğ‘‹ğ‘¡ with ğ‘‹â€²ğ‘¡={ğ‘¢1,â€¦,ğ‘¢ğ‘¤â€²} (where ğ‘¤â€²â‰¤ğ‘¤), let ğ¹ğ¶|ğ‘‹â€²ğ‘¡={ğ‘“â€²1,â€¦,ğ‘“â€²ğ‘¤â€²} be defined by setting, for each ğ‘—âˆˆ{1,â€¦,ğ‘¤â€²}, ğ‘“â€²ğ‘—=ğ‘“ğ‘–ğ‘— where ğ‘¢ğ‘—=ğ‘£ğ‘–ğ‘— (ğ¿|ğ‘‹â€²ğ‘¡ and ğ¶ğµ|ğ‘‹â€²ğ‘¡ are defined similarly).

Moreover, a quasi labelling (â„“,ğ‘) of ğºğ‘¡ is said compatible with (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡ if, for each ğ‘–âˆˆ{1,â€¦,ğ‘} and ğ‘—âˆˆ{1,â€¦,ğ‘¤}, we have that â„“(ğ‘’ğ‘–)=ğ‘™ğ‘–,ğ‘(ğ‘£ğ‘—)=ğ‘“ğ‘—, and ğ‘ğ‘—=âˆ‘ğ‘¥âˆˆğ‘ğ‘¡(ğ‘£ğ‘—)âˆ–ğ‘‹ğ‘¡â„“(ğ‘£ğ‘—ğ‘¥). This implies that, for all ğ‘–âˆˆ{1,â€¦,ğ‘} and ğ‘—âˆˆ{1,â€¦,ğ‘¤},


âˆ‘ğ‘§âˆˆğ‘ğ‘¡(ğ‘£ğ‘—)â„“(ğ‘§ğ‘£ğ‘—)=ğ‘ğ‘—+âˆ‘ğ‘§âˆˆğ‘(ğ‘£ğ‘—)âˆ©ğ‘‹ğ‘¡,ğ‘’ğ‘–=ğ‘£ğ‘—ğ‘§ğ‘™ğ‘–â‰¤ğ‘(ğ‘£ğ‘—)=ğ‘“ğ‘—.

Among all quasi labellings compatible with (L, FC, CB), let us denote as (â„“âˆ—,ğ‘âˆ—) one such compatible labelling that minimises the sum of the labels assigned by â„“âˆ—. That is, for any ğ‘¡âˆˆğ‘‰(ğ‘¡), we have ğ‘ ğ‘¡(â„“âˆ—)â‰¤ğ‘ ğ‘¡(â„“) for every quasi labelling â„“ compatible with (L, FC, CB). Let ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=ğ‘ ğ‘¡(â„“âˆ—). In essence, for each possible (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡, we have that ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ) is equal to the sum of the labels of an optimal (in terms of sum of labels) quasi labelling (â„“âˆ—,ğ‘âˆ—) of ğºğ‘¡ that is compatible with (L, FC, CB). Note that not all (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡ admit compatible quasi labellings. If (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡ has no compatible quasi labelling, then we set ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=âˆ.

Finally, let us set


Table(ğ‘¡)=((ğ¿,ğ¹ğ¶,ğ¶ğµ,ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)))(ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡

being the table associated to each ğ‘¡âˆˆğ‘‰(ğ‘‡). Note that


|Table(ğ‘¡)|=îˆ»(ğ‘˜ğ‘(ğ‘˜Î”+1)2ğ‘¤)=îˆ»(ğ‘˜(tw(ğº)+1)2(ğ‘˜Î”+1)2tw(ğº)+2),

since ğ‘â‰¤(tw(ğº)+12)=îˆ»((tw(ğº)+1)2) and ğ‘¤â‰¤tw(ğº)+1. Furthermore, since r is such that ğ‘‹ğ‘Ÿ=âˆ…, then ğ›¼ğ‘Ÿ=ğ›¼ğ‘Ÿ(âˆ…,âˆ…,âˆ…) is equal to the sum of an optimal proper k-labelling of ğºğ‘Ÿ and thus Table(ğ‘Ÿ)=((âˆ…,âˆ…,âˆ…,ğ›¼ğ‘Ÿ)), where ğ›¼ğ‘Ÿ=mEğ‘˜(ğº). All that remains to be done is to compute this Table(ğ‘¡) for every ğ‘¡âˆˆğ‘‰(ğ‘¡). We present a dynamic-programming algorithm that performs this computation bottoms up; that is, starting from the leaves of T and progressing towards r. The computation depends on the type of t.

Let t be a leaf node. Recall that |ğ‘‹ğ‘¡|=1 and thus there are no edges in ğ‘‹ğ‘¡. For every ğ‘¦âˆˆ{1,â€¦,ğ‘˜Î”} and (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡, the ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ) entry of Table(ğ‘¡) is defined as:


ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)={0,âˆ,if (ğ¿,ğ¹ğ¶,ğ¶ğµ)=(âˆ…,{ğ‘¦},{0});otherwise.

Let t be an introduce node and ğ‘¡â€² be its unique child. Set ğ‘¤=|ğ‘‹ğ‘¡â€²|, and let v be such that ğ‘‹ğ‘¡=ğ‘‹ğ‘¡â€²âˆª{ğ‘£}={ğ‘£1,â€¦,ğ‘£ğ‘¤,ğ‘£ğ‘¤+1=ğ‘£}. Moreover, let ğ¸(ğ‘‹ğ‘¡)={ğ‘’1,â€¦,ğ‘’ğ‘,ğ‘’ğ‘+1,â€¦,ğ‘’ğ‘+â„}, where ğ¸(ğ‘‹ğ‘¡â€²)={ğ‘’1,â€¦,ğ‘’ğ‘}. Essentially, the set {ğ‘’ğ‘+1,â€¦,ğ‘’ğ‘+â„} contains the edges between v and the other vertices of ğ‘‹ğ‘¡. By induction, we can assume that Table(ğ‘¡â€²) is already computed. Let us show how to compute Table(ğ‘¡). Let


(ğ¿=(ğ‘™1,â€¦,ğ‘™ğ‘+â„),ğ¹ğ¶=(ğ‘“1,â€¦,ğ‘“ğ‘¤+1),ğ¶ğµ=(ğ‘1,â€¦,ğ‘ğ‘¤+1))âˆˆîˆ²ğ‘¡.

There is a quasi labelling of ğºğ‘¡ compatible with (L, FC, CB) only if the following three (easily computable) conditions are satisfied:

The final colour ğ‘“ğ‘¤+1 that corresponds to v is not in conflict with the final colours that correspond to the neighbours of v in ğ‘‹ğ‘¡. That is, for each ğ‘—âˆˆ{1,â€¦,ğ‘¤} such that ğ‘£ğ‘—âˆˆğ‘ğ‘¡(ğ‘£)âˆ©ğ‘‹ğ‘¡, we have ğ‘“ğ‘¤+1â‰ ğ‘“ğ‘—.

Since v is introduced in ğ‘‹ğ‘¡, we have ğ‘ğ‘¡(ğ‘£)âˆ–ğ‘‹ğ‘¡=âˆ… and, as a consequence, c(v) cannot have any contribution coming from ğºğ‘¡âˆ–ğ‘‹ğ‘¡. That is ğ‘ğ‘¤+1=0.

The colour of each vertex in ğºğ‘¡ cannot exceed the final colour that corresponds to it. That is, for every ğ‘£ğ‘–âˆˆğ‘‹ğ‘¡, we must have


ğ‘ğ‘–+âˆ‘ğ‘—=1ğ‘+â„ğ‘™ğ‘—ğ•€ğ‘–,ğ‘—â‰¤ğ‘“ğ‘–,

where ğ•€ğ‘–,ğ‘—={1,0,if there is ğ‘¤âˆˆğ‘(ğ‘£ğ‘–)âˆ©ğ‘‹ğ‘¡ such that ğ‘¤ğ‘£ğ‘–=ğ‘’ğ‘—;otherwise.

If one of these three conditions is not satisfied, then ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=âˆ. Otherwise, let us set


ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=ğ›¼ğ‘¡â€²(ğ¿|ğ‘‹ğ‘¡â€²,ğ¹ğ¶|ğ‘‹ğ‘¡â€²,ğ¶ğµ|ğ‘‹ğ‘¡â€²)+âˆ‘ğ‘—=ğ‘+1ğ‘+â„ğ‘™ğ‘—.

Following the above process, the element ((ğ¿,ğ¹ğ¶,ğ¶ğµ),ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)) is added to Table(ğ‘¡) for every (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡.

Let t be a forget node and ğ‘¡â€² be its unique child. Set ğ‘¤=|ğ‘‹ğ‘¡|, and let v be such that ğ‘‹ğ‘¡â€²=ğ‘‹ğ‘¡âˆª{ğ‘£}={ğ‘£1,â€¦,ğ‘£ğ‘¤,ğ‘£ğ‘¤+1=ğ‘£}. Moreover, let ğ¸(ğ‘‹ğ‘¡â€²)={ğ‘’1,â€¦,ğ‘’ğ‘,ğ‘’ğ‘+1,â€¦,ğ‘’ğ‘+â„}, where ğ¸(ğ‘‹ğ‘¡)={ğ‘’1,â€¦,ğ‘’ğ‘}. By induction, we can assume that Table(ğ‘¡â€²) is already computed. Let us show how to compute Table(ğ‘¡).

Let (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡. Let Î“ğ‘¡â€² be the subset of îˆ²ğ‘¡â€² that consists of all (ğ¿â€²,ğ¹ğ¶â€²,ğ¶ğµâ€²)âˆˆîˆ²ğ‘¡â€² such that (ğ¿,ğ¹ğ¶,ğ¶ğµ)=(ğ¿â€²|ğ‘‹ğ‘¡,ğ¹ğ¶â€²|ğ‘‹ğ‘¡,ğ¶ğµâ€²|ğ‘‹ğ‘¡) (i.e., (L, FC, CB) must be the restriction to ğ‘‹ğ‘¡ of some (ğ¿â€²,ğ¹ğ¶â€²,ğ¶ğµâ€²)âˆˆîˆ²ğ‘¡â€²) and such that ğ‘“â€²ğ‘¤+1=ğ‘â€²ğ‘¤+1+âˆ‘ğ‘+1â‰¤ğ‘—â‰¤ğ‘+â„ğ‘™â€²ğ‘—. The latter condition allows to respect the property of quasi labellings. Since ğ‘£âˆˆğºğ‘¡âˆ’ğ‘‹ğ‘¡, the â€œcolour" that it received so far (with a contribution of ğ‘â€²ğ‘¤+1 from the vertices in ğºğ‘¡â€²âˆ’ğ‘‹ğ‘¡â€²) plus the labels ğ‘™â€²ğ‘+1,â€¦,ğ‘™â€²ğ‘+â„ of its incident edges in ğ‘‹ğ‘¡â€² must equal its â€œfinal" colour ğ‘“â€²ğ‘¤+1. Finally, let


ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=minğ›¾âˆˆÎ“ğ‘¡â€²ğ›¼ğ‘¡â€²(ğ›¾).

Following the above process, the element ((ğ¿,ğ¹ğ¶,ğ¶ğµ),ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)) is added to Table(ğ‘¡) for every (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡.

Let t be a join node, ğ‘¡â€² and ğ‘¡â€³ be its two children, with ğ‘‹ğ‘¡=ğ‘‹ğ‘¡â€²=ğ‘‹ğ‘¡â€³={ğ‘£1,â€¦,ğ‘£ğ‘¤} and ğ¸(ğ‘‹ğ‘¡)=ğ¸(ğ‘‹ğ‘¡â€²)=ğ¸(ğ‘‹ğ‘¡â€³)={ğ‘’1,â€¦,ğ‘’ğ‘}. By induction, we can assume that Table(ğ‘¡â€²) and Table(ğ‘¡â€³) have already been computed. Let us show how to compute Table(ğ‘¡).

Let (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡. Let Î“ğ‘¡ be the set of pairs ((ğ¿,ğ¹ğ¶,ğ¶ğµâ€²),(ğ¿,ğ¹ğ¶,ğ¶ğµâ€³)) such that (ğ¿,ğ¹ğ¶,ğ¶ğµâ€²)âˆˆîˆ²ğ‘¡â€² and (ğ¿,ğ¹ğ¶,ğ¶ğµâ€³)âˆˆîˆ²ğ‘¡â€³ such that ğ¶ğµ=ğ¶ğµâ€²+ğ¶ğµâ€³ (meaning that for each ğ‘—âˆˆ{1,â€¦,ğ‘¤} we have ğ‘ğ‘—=ğ‘â€²ğ‘—+ğ‘â€³ğ‘—, where ğ‘ğ‘—âˆˆğ¶ğµ, ğ‘â€²ğ‘—âˆˆğ¶ğµâ€² and ğ‘â€³ğ‘—âˆˆğ¶ğµâ€³). Then, let


ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)=min((ğ¿,ğ¹ğ¶,ğ¶ğµâ€²),(ğ¿,ğ¹ğ¶,ğ¶ğµâ€³))âˆˆÎ“ğ‘¡ğ›¼ğ‘¡â€²(ğ¿,ğ¹ğ¶,ğ¶ğµâ€²)+ğ›¼ğ‘¡â€³(ğ¿,ğ¹ğ¶,ğ¶ğµâ€³)âˆ’âˆ‘ğ‘–=1ğ‘ğ‘™ğ‘–.

Following the above process, the element ((ğ¿,ğ¹ğ¶,ğ¶ğµ),ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)) is added to Table(ğ‘¡) for every (ğ¿,ğ¹ğ¶,ğ¶ğµ)âˆˆîˆ²ğ‘¡.

In all cases, it can be shown by induction that ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)â‰ âˆ if and only if there is a quasi labelling of ğºğ‘¡ compatible with (L, FC, CB), and, moreover, that if ğ›¼ğ‘¡(ğ¿,ğ¹ğ¶,ğ¶ğµ)â‰ âˆ, then it is the minimum sum of the edge labels among all quasi labellings of ğºğ‘¡ compatible with (L, FC, CB). â—»

Particular Behaviours of the Problem
In this section, we study some behaviours of the problem of determining mEğ‘˜(ğº) for some integer k and nice graph G. We start by establishing that there is no systematic relationship between the proper labellings we are interested in and those considered in [1] and [5]. We then prove that, in general, using large labels might be needed for designing proper labellings â„“ verifying ğœ(â„“)=mE(ğº). This actually remains true in cases where G is a tree.

Minimising the Maximum Colour Versus Minimising the Sum of Labels
As described in the introductory section, quite recently the authors of [5] investigated proper labellings that minimise the maximum resulting vertex colour. The formal definitions are as follows. For a given graph G and a labelling â„“ of G, let mS(ğº,â„“) denote the maximum vertex colour ğ‘â„“(ğ‘£) induced by â„“ over all vertices v of G. For a given ğ‘˜â‰¥ğœ’Î£(ğº), let mSğ‘˜(ğº) denote the smallest value of mS(ğº,â„“) over all proper k-labellings of G. Now, the main parameter of interest is mS(ğº), which is defined as the minimum value of mSğ‘˜(ğº) over all values of ğ‘˜â‰¥ğœ’Î£(ğº).

As established in Observation 2.2 determining mE(ğº) for a nice graph G can equivalently be seen as finding a proper labelling of G that minimises the sum of resulting vertex colours. Thus, one could think that maybe mE(ğº) is a good approximation of mS(ğº), or vice-versa. In this section, we show that this is actually not the case.

The next result shows that, when constructing a proper labelling â„“ of a graph G with mS(ğº,â„“)=mS(ğº), we might have ğœ(â„“) being arbitrarily far from mE(ğº). In other words, minimising the maximum colour does not imply minimising the sum of labels. This actually remains true for trees.

Theorem 4.1
There exist nice trees T with arbitrarily large maximum degree Î”â‰¥2 for which, for any proper labelling â„“ achieving mS(ğ‘‡,â„“)=mS(ğ‘‡), we have mE(ğ‘‡,â„“)=mE(ğ‘‡)+Î”âˆ’2.

Proof
Consider the following tree T with maximum degree Î”â‰¥2. We start from a vertex v with Î” neighbours ğ‘¢1,â€¦,ğ‘¢Î”, each of which is adjacent to Î”âˆ’1 leaves. In other words, all neighbours of v have degree Î”, and all other vertices are leaves at distance exactly 2 from v.

Now consider a proper labelling â„“ of T that minimises the maximum colour, i.e., mS(ğ‘‡,â„“)=mS(ğ‘‡). Since T has adjacent vertices with degree Î”, we have mS(ğ‘‡,â„“)â‰¥Î”+1. One possible way to attain mS(ğ‘‡,â„“)=Î”+1 is to have all edges incident to v being labelled 1, and, for each ğ‘¢ğ‘–, to have exactly one incident edge going to a leaf being labelled 2 and all other Î”âˆ’2 incident edges being labelled 1. Indeed, we get ğ‘â„“(ğ‘£)=Î”â‰ Î”+1=ğ‘â„“(ğ‘¢ğ‘–) for every ğ‘–âˆˆ{1,â€¦,Î”}. Actually, this is the only way to have mS(ğ‘‡,â„“)=Î”+1, because if we label the edges incident to v so that ğ‘â„“(ğ‘£)=Î”+1, then it is easy to see that the vertex ğ‘¢ğ‘– such that â„“(ğ‘£ğ‘¢ğ‘–)=2 would get ğ‘â„“(ğ‘¢ğ‘–)â‰¥Î”+2 to avoid a colour conflict between v and ğ‘¢ğ‘–. Therefore, there is only one general way to label (actually 2-label) T so that mS(ğ‘‡,â„“)=mS(ğ‘‡)=Î”+1, and we note that the number of edges labelled 2 by â„“ is exactly Î” (one for each ğ‘¢ğ‘–). Thus mE(ğ‘‡,â„“)=|ğ¸|+Î”.

Observe now that regardless of the value of Î”, the 2-labelling â„“âˆ— of T where â„“âˆ—(ğ‘£ğ‘¢1)=â„“âˆ—(ğ‘£ğ‘¢2)=2 and all other edges are labelled 1 is proper. This is because we get ğ‘â„“âˆ—(ğ‘£)=Î”+2, ğ‘â„“âˆ—(ğ‘¢1)=ğ‘â„“âˆ—(ğ‘¢2)=Î”+1 and ğ‘â„“âˆ—(ğ‘¢ğ‘–)=Î”, for ğ‘–âˆˆ{3,â€¦,Î”}. Thus, mE(ğ‘‡)â‰¤mE2(ğ‘‡)â‰¤mE(ğ‘‡,â„“âˆ—)=|ğ¸|+2 and the difference between ğœ(â„“) and ğœ(â„“âˆ—) then gets arbitrarily large as Î” grows larger. â—»

Fig. 1
figure 1
The only proper 2-labellings â„“1 (left) and â„“2 (right) of the ğ‘‡2 gadget, used in the construction illustrated in Fig. 2. The induced colours for each labelling are represented as integers in the corresponding vertices. Vertex ğ‘¢1 is called the root of the gadget. Wiggly edges are edges that could be labelled either 1 or 2

Full size image

Fig. 2
figure 2
The only proper 2-labellings of the spreading gadget ğºâ‹. A triangle marked as â€œğ‘‡2â€ indicates that a copy of the ğ‘‡2 gadget (depicted in Fig. 1) is attached via its root vertex. That is, ğ‘¢5 (resp., ğ‘¢6 and ğ‘¢7) is identified to the root of one copy of ğ‘‡2. The induced colours for each labelling are represented as integers in the corresponding vertices. Wiggly edges are edges that could be labelled either 1 or 2

Full size image

The next result shows that the converse is also true: a proper labelling that minimises the sum of labels does not necessarily minimise the maximum colour as well.

Theorem 4.2
There exist nice graphs G with arbitrarily large maximum degree Î”â‰¥12 for which, for any proper 2-labelling â„“ achieving ğœ(â„“)=mE2(ğº), we have mS(ğº,â„“)=mS(ğº)+Î”.

Proof
In [5] is exhibited a spreading gadget ğºâ‹ (a slight modification of the graph depicted in Fig. 2) with one input (the edge ğ‘¢1ğ‘¢2) and two outputs (the edges ğ‘¢9ğ‘¢10 and ğ‘¢12ğ‘¢13), that are pending edges that must all be assigned the same label (which can be either 1 or 2) by any proper 2-labelling (see Section 4.4 in [5] for details). Having a closer look at ğºâ‹, we note that, regarding our minimisation problem, it has the following property:

Claim 4.3
Let â„“ be a proper 2-labelling of ğºâ‹ achieving ğœ(â„“)=mE2(ğºâ‹). Then â„“ assigns label 2 to the input and two outputs of ğºâ‹.

Proof of the claim. As mentioned above, the proper 2-labellings of ğºâ‹ are of two kinds: those â„“1 assigning label 1 to the input and two outputs, and those â„“2 assigning label 2 to the input and two outputs. Such labellings â„“1 and â„“2 are as described in Fig. 2a, b, respectively (see [5]). In particular, it is important to mention that the solid edges in the figures must be labelled as illustrated (up to symmetry), while the only sources of freedom we have are the labels assigned to the wiggly edges, which can each freely be chosen to be 1 or 2.

Let us now determine the minimum sum of labels assigned by these proper labellings:

For a proper 2-labelling â„“1 of ğºâ‹ assigning label 1 to the input and two outputs, we note, as illustrated in Fig. 2a, that ğ‘¢5 and ğ‘¢6 must get colour 10, which is possible only if the two copies of ğ‘‡2 attached to ğ‘¢5 and ğ‘¢6 are labelled as in Fig. 1a. Indeed, assuming that one of these copies of ğ‘‡2, say the one attached to ğ‘¢5, is labelled as in Fig. 1b, would mean that ğ‘â„“1(ğ‘¢5)=ğ‘â„“1(ğ‘¢3)=10, and thus â„“1 would not be a proper labelling. The vertex ğ‘¢7 must get colour 11, which is not prevented by any of the two ways of labelling the copy of ğ‘‡2 attached to it. Thus, for â„“1 to minimise the sum of labels, the copies of ğ‘‡2 attached to ğ‘¢5 and ğ‘¢6 must be labelled as in Fig. 1a, and the copy of ğ‘‡2 attached to ğ‘¢7 must be labelled as in Fig. 1a as well (as the sum of labels in the labelling of Fig. 1b is larger). All wiggly edges should be assigned label 1. In total, a minimum â„“1 assigns label 1 to 40 edges and label 2 to 25 edges, and thus ğœ(â„“1)=90.

By similar arguments, we deduce that, by a proper 2-labelling â„“2 of ğºâ‹ assigning label 2 to the input and two outputs, the copies of ğ‘‡2 attached to ğ‘¢5 and ğ‘¢6 should be labelled as depicted in Fig. 1b, while the copy of ğ‘‡2 attached to ğ‘¢7 should be labelled as depicted in Fig. 1a (in particular, the two labellings of ğ‘‡2 depicted in Fig. 1 comply with ğ‘¢7 having colour 7). Again, the wiggly edges should be labelled 1. In total, a minimum â„“2 assigns label 1 to 42 edges and label 2 to 23 edges, and thus ğœ(â„“2)=88.

Thus, a proper 2-labelling â„“ of ğºâ‹ achieving ğœ(â„“)=mE2(ğºâ‹) must assign label 2 to the input and two outputs. â‹„

Now consider the graph operation consisting in taking two copies ğº1 and ğº2 of ğºâ‹, and identifying the input of ğº1 and one output of ğº2 (so that the two degree-1 vertices do not get identified together). Thus, if ğ‘¢1ğ‘– and ğ‘¢2ğ‘– (for 1â‰¤ğ‘–â‰¤13) denote the vertices of ğº1 and ğº2 respectively, in ğºâ‹ we can either have ğ‘¢19ğ‘¢110=ğ‘¢21ğ‘¢22 or ğ‘¢112ğ‘¢113=ğ‘¢21ğ‘¢22. As described in [5], this results in a graph G with one input and three outputs such that, for every proper 2-labelling, the input and three outputs must all be assigned the same label (which can be either 1 or 2). By repeating this operation with more and more copies of ğºâ‹, we can come up with a graph ğº1/2 with one input and arbitrarily many outputs that must all be assigned the same label (either 1 or 2) by a proper 2-labelling. So there are, essentially, two groups of proper 2-labellings of ğº1/2: those â„“1 assigning label 1 to the input and all outputs, and those â„“2 assigning label 2 to the input and all outputs. Clearly, a proper 2-labelling â„“ of ğº1/2 verifying ğœ(â„“)=mE2(ğº1/2), when restricted to any constituting copy of ğºâ‹ in ğº1/2, should also be minimum in terms of sum of assigned labels. From Claim 4.3, we thus deduce that a proper 2-labelling â„“ of ğº1/2 achieving ğœ(â„“)=mE2(ğº1/2) must assign label 2 to the input and all outputs, i.e., must belong to the â„“2 group mentioned above. In particular, the difference between the sum of labels of a minimum â„“1 and the sum of labels of a minimum â„“2 gets larger as the number of copies involved in the construction of ğº1/2 gets larger.

Now let G be the graph obtained as follows. Consider the graph ğº1/2 with Î” outputs (for any Î”â‰¥12), and identify the degree-1 vertices of these Î” outputs to a single vertex ğ‘œâˆ— (with maximum degree Î”, as it can be checked from Figs. 1 and 2 that all other vertices of ğº1/2 have degree at most 6). Note that a proper 2-labelling of G is also proper for ğº1/2, since vertices of degree 1 cannot be involved in conflicts. Also, a proper 2-labelling of ğº1/2 must be proper in G as well, since ğ‘œâˆ— has degree at least 12 while all its neighbours have degree 2. By these arguments, a proper 2-labelling â„“ of G verifying ğœ(â„“)=mE2(ğº) must thus be one of these proper 2-labellings â„“2 assigning label 2 to the input and all outputs. Such an â„“2 verifies ğ‘â„“2(ğ‘œâˆ—)=2Î”. On the other hand, a proper 2-labelling â„“1 assigning label 1 to all outputs verifies ğ‘â„“1(ğ‘œâˆ—)=Î”. Thus, a proper 2-labelling â„“ of G verifying ğœ(â„“)=mE2(ğº) will make ğ‘œâˆ— get colour 2Î”, while there are proper 2-labellings by which ğ‘œâˆ— gets colour Î”. Note in particular that by our choice of Î”, vertex ğ‘œâˆ— must indeed be the vertex with the largest colour, as its degree is at least 12, all other vertices have degree at most 6, and we are only assigning labels 1 and 2. â—»

Using Larger Labels can be Arbitrarily Better
In this section, we present, for any ğ‘˜â‰¥3, a construction for a tree ğ‘‡ğ‘˜ such that mE2(ğ‘‡ğ‘˜)=mE3(ğ‘‡ğ‘˜)=mE4(ğ‘‡ğ‘˜)=â‹¯=mEğ‘˜(ğ‘‡ğ‘˜) and mEğ‘˜+1(ğ‘‡ğ‘˜)<mEğ‘˜(ğ‘‡ğ‘˜). In other words, for these trees ğ‘‡ğ‘˜ we need to consider larger labels to design a proper labelling â„“ achieving mE(ğ‘‡ğ‘˜,â„“)=mE(ğ‘‡ğ‘˜).

Let us first introduce the auxiliary graph ğ´(ğ›¼,ğ›½) (for ğ›¼â‰¥2 and ğ›½â‰¥0), which will serve as the building block for ğ‘‡ğ‘˜. This auxiliary graph is a tree and is built recursively as follows: for any ğ›¼âˆ—âˆˆâ„•, define ğ´(ğ›¼âˆ—,0) as a leaf. For any ğ›½>0, ğ´(ğ›¼,ğ›½) is a tree of height ğ›½, rooted in a vertex r that has ğ›¼ children. For each 1â‰¤ğ‘–â‰¤ğ›¼, let ğ‘ğ‘– be the corresponding child of r; each ğ‘ğ‘– is the root of a ğ´(ğ›¼+ğ‘–,ğ›½âˆ’1) tree and thus ğ‘‘(ğ‘ğ‘–)=ğ›¼+ğ‘–+1 (since each ğ‘ğ‘– has ğ›¼+ğ‘– children of its own as well as an edge connecting him with his parent). Note that ğ‘‘(ğ‘ğ‘–)âˆˆğ·(ğ›¼)={ğ›¼+2,â€¦,2ğ›¼+1} and that, for ğ‘–â‰ ğ‘—, we have ğ‘‘(ğ‘ğ‘–)â‰ ğ‘‘(ğ‘ğ‘—) (and thus all the values of ğ·(ğ›¼) are used exactly once). Finally, we say that ğ´(ğ›¼,ğ›½) is represented by r. The auxiliary graph A(2, 2) is illustrated in Fig. 3.

Fig. 3
figure 3
The auxiliary graph A(2, 2)

Full size image

Let us also define the pending auxiliary graph that corresponds to ğ´(ğ›¼,ğ›½) as ğ‘ƒ(ğ›¼,ğ›½)=(ğ‘‰,ğ¸), where ğ‘‰=ğ‘‰(ğ´(ğ›¼,ğ›½))âˆª{ğ‘£} and ğ¸=ğ¸(ğ´(ğ›¼,ğ›½))âˆªğ‘£ğ‘Ÿ; in essence ğ‘ƒ(ğ›¼,ğ›½) is ğ´(ğ›¼,ğ›½) with an extra vertex v connected to r. We say that ğ‘ƒ(ğ›¼,ğ›½) is pending from v. Observe that ğ‘ƒ(ğ›¼,ğ›½) is locally irregular and thus the labelling â„“ that assigns label 1 to every one of its edges is proper and verifies mE(ğ‘ƒ(ğ›¼,ğ›½),â„“)=|ğ¸|.

Lemma 4.4
Let ğ›½âˆˆâ„•âˆ— and ğ›¼â‰¥2. Let â„“ be a proper ğ›¼-labelling of the pending auxiliary graph ğ‘ƒ(ğ›¼,2ğ›½) pending from v. Let ğ‘¢,ğ‘¤âˆˆğ‘‰(ğ‘ƒ(ğ›¼,2ğ›½)) such that 1â‰¤dist(ğ‘¢,ğ‘£)â‰¤2 and w is the parent of u. If â„“(ğ‘¢ğ‘¤)>1, then mE(ğ‘ƒ(ğ›¼,2ğ›½),â„“)â‰¥|ğ¸|+ğ›½.

Proof
Let us prove the claim for the case where dist(ğ‘¢,ğ‘£)=2 and u is the root of the ğ´(ğ›¼+1,2ğ›½âˆ’1) subtree and ğ‘¤=ğ‘Ÿ (similar arguments hold for the other cases) and let us first assume that uw is the only edge of ğ‘ƒ(ğ›¼,ğ›½) that has label more than 1, say â„“(ğ‘¢ğ‘¤)=ğ›¼â€² where 2â‰¤ğ›¼â€²â‰¤ğ›¼. It follows that ğ‘â„“(ğ‘¢)=ğ›¼+ğ›¼â€²+1 and that ğ›¼+3â‰¤ğ‘â„“(ğ‘¢)â‰¤2ğ›¼+1. Since all edges of ğ‘ƒ(ğ›¼,2ğ›½) except uw are labelled 1, each child y of u has ğ‘â„“(ğ‘¦)=ğ‘‘(ğ‘¦). Moreover, since u is the root of the ğ´(ğ›¼+1,2ğ›½âˆ’1) tree, each one of the ğ›¼+1 children of u has a unique degree in the set ğ·(ğ›¼+1). But ğ·(ğ›¼+1)={ğ›¼+3,â€¦,2ğ›¼+2} and ğ‘â„“(ğ‘¢)âˆˆğ·(ğ›¼+1). It follows that there exists a child of u that has, by â„“, the same colour as u. Thus â„“ must assign a label different from 1 to at least one more edge of ğ‘ƒ(ğ›¼,ğ›½), and the argument can be repeated at least ğ›½ times (since the height of ğ‘‡(ğ›¼,2ğ›½) is 2ğ›½+1), leading to â„“ having to assign a label different than 1 to at least ğ›½ edges. The exact value of mE(ğ‘ƒ(ğ›¼,2ğ›½),â„“)=|ğ¸|+ğ›½ is reached if each time the argument is repeated, ğ›¼â€²=2 and the next edge that gets assigned label 2 is at distance 2 from the previous ones. â—»

Theorem 4.5
For every ğ‘˜â‰¥2, there exists a nice graph ğ‘‡ğ‘˜ such that mEğ‘˜+1(ğ‘‡ğ‘˜)<mEğ‘˜(ğ‘‡ğ‘˜).

Proof
Let ğ‘˜â‰¥2 and let us describe the construction of ğ‘‡ğ‘˜=(ğ‘‰,ğ¸). For 0â‰¤ğ‘—â‰¤ğ‘˜âˆ’1, let ğ‘ƒ(ğ‘˜+ğ‘—,2(ğ‘˜+1)) be the auxiliary graph pending from ğ‘£ğ‘— that corresponds to an auxiliary graph ğ´(ğ‘˜+ğ‘—,2(ğ‘˜+1)) (represented by a vertex ğ‘Ÿğ‘—) and let u, v be two vertices connected by the edge uv. The tree ğ‘‡ğ‘˜ is the graph that is produced by identifying v with each one of the ğ‘£ğ‘—. Observe that since ğ‘Ÿğ‘— represents ğ´(ğ‘˜+ğ‘—,2(ğ‘˜+1)), each ğ‘Ÿğ‘— has d(r_j)=k+j+1ğ‘‘(ğ‘Ÿğ‘—)=ğ‘˜+ğ‘—+1 in T_kğ‘‡ğ‘˜ and that the height of T_kğ‘‡ğ‘˜ is 2(k+1)+12(ğ‘˜+1)+1. Also observe that in T_kğ‘‡ğ‘˜, since N(v)=\{r_0,\ldots ,r_{k-1},u\}ğ‘(ğ‘£)={ğ‘Ÿ0,â€¦,ğ‘Ÿğ‘˜âˆ’1,ğ‘¢}, we have d(v)=k+1=d(r_0)ğ‘‘(ğ‘£)=ğ‘˜+1=ğ‘‘(ğ‘Ÿ0).

Claim 4.6
There exists a proper (k+1)(ğ‘˜+1)-labelling \ell â„“ of T_kğ‘‡ğ‘˜ such that \sigma (\ell )=|E|+kğœ(â„“)=|ğ¸|+ğ‘˜.

Proof of the claim. Note that T_kğ‘‡ğ‘˜ is almost locally irregular. Indeed, let w be a non-leaf vertex of T_kğ‘‡ğ‘˜ different from r_1, vğ‘Ÿ1,ğ‘£ and u, and let x be its parent. If d(w)=d+1ğ‘‘(ğ‘¤)=ğ‘‘+1, then d+1>d(x)ğ‘‘+1>ğ‘‘(ğ‘¥) (by construction) and w has d children, each one having degree at least d+2ğ‘‘+2. In fact, the only adjacent vertices that have the same degree are v and r_0ğ‘Ÿ0.

Let \ell â„“ be the (k+1)(ğ‘˜+1)-labelling of T_kğ‘‡ğ‘˜ that assigns label k+1ğ‘˜+1 to the edge uv and label 1 to the remaining edges of T_kğ‘‡ğ‘˜. Then c_\ell (v)=2k+1ğ‘â„“(ğ‘£)=2ğ‘˜+1 and, for each 0\le i\le k-10â‰¤ğ‘–â‰¤ğ‘˜âˆ’1, we have d(r_j)\in [k+1,2k]ğ‘‘(ğ‘Ÿğ‘—)âˆˆ[ğ‘˜+1,2ğ‘˜] and thus there is no conflict between the colour of v and that of its children. It follows that \ell â„“ is a proper (k+1)(ğ‘˜+1)-labelling for T_kğ‘‡ğ‘˜ and \sigma (\ell )=|E|+kğœ(â„“)=|ğ¸|+ğ‘˜. \diamond â‹„

Let \ell 'â„“â€² be any proper k-labelling of T_kğ‘‡ğ‘˜. It suffices to show that \sigma (\ell ')>|E|+kğœ(â„“â€²)>|ğ¸|+ğ‘˜. Note that, since d(v) = d(r_0) = k+1ğ‘‘(ğ‘£)=ğ‘‘(ğ‘Ÿ0)=ğ‘˜+1 and \ell 'â„“â€² is proper, there must exist vertices w, y, with w\in N(r_0)\setminus \{v\}ğ‘¤âˆˆğ‘(ğ‘Ÿ0)âˆ–{ğ‘£} and y\in N(v)\setminus \{u,r_0\}ğ‘¦âˆˆğ‘(ğ‘£)âˆ–{ğ‘¢,ğ‘Ÿ0}, such that at least one of the edges uv, r_0wğ‘Ÿ0ğ‘¤ or vy has to have a label different from 1. Let \ell '(uv)=lâ„“â€²(ğ‘¢ğ‘£)=ğ‘™ with 2\le l\le k2â‰¤ğ‘™â‰¤ğ‘˜ and assume that this is the only edge of T_kğ‘‡ğ‘˜ that has a label different from 1. Then c_{\ell '}(v)=k+lğ‘â„“â€²(ğ‘£)=ğ‘˜+ğ‘™ and k+l\in \{k+2,\ldots ,2k\}ğ‘˜+ğ‘™âˆˆ{ğ‘˜+2,â€¦,2ğ‘˜}. Recall that for every 0\le j\le k-10â‰¤ğ‘—â‰¤ğ‘˜âˆ’1, vertex r_jğ‘Ÿğ‘— has d(r_j)=k+j+1ğ‘‘(ğ‘Ÿğ‘—)=ğ‘˜+ğ‘—+1 and thus d(r_j)\in \{k+1,\ldots ,2k\}ğ‘‘(ğ‘Ÿğ‘—)âˆˆ{ğ‘˜+1,â€¦,2ğ‘˜}. Besides, since uv is the only edge with a label different from 1, we have c_{\ell '}(r_j)=d(r_j)ğ‘â„“â€²(ğ‘Ÿğ‘—)=ğ‘‘(ğ‘Ÿğ‘—). It follows that there exists a j\in \{0,\ldots ,k-1\}ğ‘—âˆˆ{0,â€¦,ğ‘˜âˆ’1}, such that c_{\ell '}(r_j)=c_{\ell '}(v)ğ‘â„“â€²(ğ‘Ÿğ‘—)=ğ‘â„“â€²(ğ‘£) leading to \ell 'â„“â€² not being proper. Thus, there must exist another edge u'v'ğ‘¢â€²ğ‘£â€² (with, say, u'ğ‘¢â€² being the parent of v'ğ‘£â€²) that is assigned a label different from 1 by \ell 'â„“â€². Note that u'ğ‘¢â€² is either r_jğ‘Ÿğ‘— or v. This edge, however, belongs to P(q,2(k+1))ğ‘ƒ(ğ‘,2(ğ‘˜+1)) (for some q\in \{k,\ldots ,2k-1\}ğ‘âˆˆ{ğ‘˜,â€¦,2ğ‘˜âˆ’1}) and we have that 1\le \mathrm{dist}(v',v)\le 21â‰¤dist(ğ‘£â€²,ğ‘£)â‰¤2. It follows from Lemma 4.4 that \mathrm{mE}(T_k)\ge |E|+k+1mE(ğ‘‡ğ‘˜)â‰¥|ğ¸|+ğ‘˜+1. The cases where r_0wğ‘Ÿ0ğ‘¤ or vy are assigned a label different from 1 follow by applying directly Lemma 4.4.

\square â—»

Observe that the height of T_kğ‘‡ğ‘˜ can be controlled by changing the \beta ğ›½ value of the pending auxiliary graphs that form it. Furthermore, for \alpha \ge 2ğ›¼â‰¥2 and \beta ,\beta ' \in {\mathbb {N}}^*ğ›½,ğ›½â€²âˆˆâ„•âˆ— with \beta <\beta 'ğ›½<ğ›½â€², it follows from Lemma 4.4 that \mathrm{mE}(T(\alpha ,2\beta ))<\mathrm{mE}(T(\alpha ,2\beta '))mE(ğ‘‡(ğ›¼,2ğ›½))<mE(ğ‘‡(ğ›¼,2ğ›½â€²)), where T(\alpha ,2\beta )ğ‘‡(ğ›¼,2ğ›½) denotes the graph T_kğ‘‡ğ‘˜ formed by \alpha ğ›¼ pending auxiliary graphs of height 2\beta 2ğ›½. This proves the following corollary:

Corollary 4.7
For every k\ge 2ğ‘˜â‰¥2, there exists a graph T_kğ‘‡ğ‘˜ such that \mathrm{mE}_{k+1}(T_k)mEğ‘˜+1(ğ‘‡ğ‘˜) is arbitrarily smaller than \mathrm{mE}_k(T_k)mEğ‘˜(ğ‘‡ğ‘˜).

Bounds
Observation 2.1 establishes that, for any nice graph G, in general \mathrm{mE}(G)mE(ğº) should be expressed as a function of |E|. To date, the best result towards the 1â€“2â€“3 Conjecture, due to Kalkowski, KaroÅ„ski and Pfender [13], states that \chi _\Sigma (G) \le 5ğœ’Î£(ğº)â‰¤5 holds for every nice graph G. It implies the following:

Theorem 5.1
[13] For every nice graph G, we have \mathrm{mE}(G) \le \mathrm{mE}_5(G) \le 5|E|mE(ğº)â‰¤mE5(ğº)â‰¤5|ğ¸|.

Of course, the upper bound in Theorem 5.1 is immediately improved for every nice graph G for which we can beat the upper bound of Kalkowski, KaroÅ„ski and Pfender. In particular, let us recall that \chi _\Sigma (G) \le 3ğœ’Î£(ğº)â‰¤3 whenever \chi (G) \le 3ğœ’(ğº)â‰¤3 (see [14]), which implies that \mathrm{mE}(G) \le \mathrm{mE}_3(G) \le 3|E|mE(ğº)â‰¤mE3(ğº)â‰¤3|ğ¸| holds here. Recently, PrzybyÅ‚o proved in [18] that \chi _\Sigma (G) \le 4ğœ’Î£(ğº)â‰¤4 whenever G is regular, which implies that \mathrm{mE}(G) \le \mathrm{mE}_4(G) \le 4|E|mE(ğº)â‰¤mE4(ğº)â‰¤4|ğ¸| holds. More results of this sort can be found e.g. in the survey [19] by Seamone.

More generally, the 1â€“2â€“3 Conjecture, if true, would imply that, for every nice graph G, we even have \mathrm{mE}(G) \le \mathrm{mE}_3(G) \le 3|E|mE(ğº)â‰¤mE3(ğº)â‰¤3|ğ¸|. A natural question to wonder is whether there exist graphs G for which \mathrm{mE}(G)mE(ğº) is close to this theoretical upper bound 3|E|. Recall that, already, we have \mathrm{mE}(G) \le \mathrm{mE}_2(G) \le 2|E|mE(ğº)â‰¤mE2(ğº)â‰¤2|ğ¸| whenever \chi _\Sigma (G) \le 2ğœ’Î£(ğº)â‰¤2. The fact that we are not aware of graphs G with \chi _\Sigma (G)=3ğœ’Î£(ğº)=3 needing a lot of 3â€™s in all proper 3-labellings leads us to suspect that even the following conjecture might be true.

Conjecture 5.2
For every nice graph G, we have \mathrm{mE}(G) \le 2|E|mE(ğº)â‰¤2|ğ¸|.

Conjecture 5.2 holds true for all graphs G with \chi _\Sigma (G) \le 2ğœ’Î£(ğº)â‰¤2, recall Observation 2.1. Experimentation via computer programs led us to observe that, actually, it might even be true that the equality \mathrm{mE}(G)=2|E|mE(ğº)=2|ğ¸| holds if and only if G is K_3ğ¾3 or C_6ğ¶6, recall Theorems 2.5 and 2.6. However, these cases are very peculiar, due to the small number of edges these two graphs have.

Throughout this section, we provide weaker results towards Conjecture 5.2 for graphs with given chromatic number, we verify Conjecture 5.2 for bipartite graphs, and we prove a stronger result in the particular case of trees.

Graphs with Large Chromatic Number
Towards Conjecture 5.2, we provide a general bound on \mathrm{mE}(G)mE(ğº) being a function of the chromatic number \chi (G)ğœ’(ğº). In particular, the bound we get is better than that in Theorem 5.1, and even better than the conjectured one in Conjecture 5.2, for dense enough graphs.

In the upcoming proofs, we make use of arguments that are fairly common in this field (see e.g. [1, 6, 8, 14,15,16, 20]), based on label modifications along walks with certain parity length. Recall that a walk in a graph is a path in which vertices and/or edges might be repeated. A walk is said closed if it starts and ends at a same vertex. We say a path is even (odd, respectively) if it is of even length (odd length, respectively).

The next results are for graphs that are not bipartite. Results dedicated to bipartite graphs will be provided in the next section.

Theorem 5.3
Let G=(V,E)ğº=(ğ‘‰,ğ¸) be a nice connected graph with chromatic number k=\chi (G)ğ‘˜=ğœ’(ğº) at least 3. Then, we have \mathrm{mE}(G) \le \mathrm{mE}_{k+1}(G) \le |E|+k|V|mE(ğº)â‰¤mEğ‘˜+1(ğº)â‰¤|ğ¸|+ğ‘˜|ğ‘‰|.

Proof
Since k\ge 3ğ‘˜â‰¥3, we have that G is not a bipartite graph. It follows that there exists an odd cycle C in G. Let H be the subgraph of G constructed according the following procedure: start by H=Cğ»=ğ¶. Then, iteratively, for each vertex v\in V\setminus V(H)ğ‘£âˆˆğ‘‰âˆ–ğ‘‰(ğ») such that there exists a vertex h\in V(H)â„âˆˆğ‘‰(ğ») with vh\in Eğ‘£â„âˆˆğ¸, add v to V(H) and vh to E(H). Repeat this process until V(H)=Vğ‘‰(ğ»)=ğ‘‰. In the end, H will contain only one cycle, the cycle C, and simple paths that lead to all the vertices of G that do not belong to C. Observe that for each e\in E(C)ğ‘’âˆˆğ¸(ğ¶), the subgraph H-eğ»âˆ’ğ‘’ is a spanning tree of G. Thus |E(H)|=|V(G)||ğ¸(ğ»)|=|ğ‘‰(ğº)|.

Let G'=G\cup S_0ğºâ€²=ğºâˆªğ‘†0, where S_0=\emptyset ğ‘†0=âˆ…, and S_i\subseteq V(G')ğ‘†ğ‘–âŠ†ğ‘‰(ğºâ€²), for 1\le i\le k1â‰¤ğ‘–â‰¤ğ‘˜, be the k stable sets induced by a proper vertex-colouring c of G'ğºâ€² (i.e. if v\in S_iğ‘£âˆˆğ‘†ğ‘– then c(v)=iğ‘(ğ‘£)=ğ‘–). We are going to construct a (k+1)(ğ‘˜+1)-labelling \ell â„“ on the edges of G'ğºâ€² such that \sigma (\ell )\le |E(G')|+k|V(G')|ğœ(â„“)â‰¤|ğ¸(ğºâ€²)|+ğ‘˜|ğ‘‰(ğºâ€²)|. Let us start by having \ell â„“ assigning label 1 to all edges of G'ğºâ€². At this point, the colour of every vertex is exactly its degree. For each 0\le i\le k0â‰¤ğ‘–â‰¤ğ‘˜, let S_i^*=\{v\in S_i|c_\ell (v)=i\bmod {k+1}\}ğ‘†âˆ—ğ‘–={ğ‘£âˆˆğ‘†ğ‘–|ğ‘â„“(ğ‘£)=ğ‘–modğ‘˜+1} (obviously S_0^*=\emptyset ğ‘†âˆ—0=âˆ…). Our goal is to modify \ell â„“ so that for each i, we have S_i^*=S_iğ‘†âˆ—ğ‘–=ğ‘†ğ‘–, from which it follows that c_\ell ğ‘â„“ is a proper vertex-colouring of G'ğºâ€². Aiming at reaching that conclusion, note that, modulo k+1ğ‘˜+1, we can equivalently have \ell â„“ assigning labels 0,\ldots ,k0,â€¦,ğ‘˜ instead.

Let v^*\in V(G')ğ‘£âˆ—âˆˆğ‘‰(ğºâ€²) such that d(v)=d\bmod {k+1}ğ‘‘(ğ‘£)=ğ‘‘modğ‘˜+1. Since c_\ell (v^*)=d(v^*)ğ‘â„“(ğ‘£âˆ—)=ğ‘‘(ğ‘£âˆ—), it follows that v^*\in S_d^*ğ‘£âˆ—âˆˆğ‘†âˆ—ğ‘‘. Free to relabel the stable sets induced by c, we may assume that d is such that S_{d-1}=\emptyset ğ‘†ğ‘‘âˆ’1=âˆ…. For each v\in S_i\setminus S_i^*ğ‘£âˆˆğ‘†ğ‘–âˆ–ğ‘†âˆ—ğ‘–, we define P_o(v)=(v^*,h^o_1,\ldots ,h^o_n,v)ğ‘ƒğ‘œ(ğ‘£)=(ğ‘£âˆ—,â„ğ‘œ1,â€¦,â„ğ‘œğ‘›,ğ‘£) and P_e(v)=(v^*,h^e_1,\ldots ,h^e_m,v)ğ‘ƒğ‘’(ğ‘£)=(ğ‘£âˆ—,â„ğ‘’1,â€¦,â„ğ‘’ğ‘š,ğ‘£) to be an odd and an even walk, respectively, following the edges of H, that connect v^*ğ‘£âˆ— and v (thus n is an even number and m is an odd number). These walks are sure to exist because H contains the odd cycle C. We modify \ell â„“ to a labelling \ell 'â„“â€² as follows. We traverse P_o(v)ğ‘ƒğ‘œ(ğ‘£) from one end to the other, and, as going along, alternate between removing 1\bmod {k+1}1modğ‘˜+1 and adding 1\bmod {k+1}1modğ‘˜+1 from the labels of the traversed edges. Thus \ell '(v^*h_1^o)=\ell (v^*h_1^o)-1 \bmod {k+1}, \ell '(h_1^oh_2^o)=\ell (h_1^oh_2^o)+1\bmod {k+1}, \dots ,\ell '(h_n^ov)=\ell (h_n^ov)-1\bmod {k+1}â„“â€²(ğ‘£âˆ—â„ğ‘œ1)=â„“(ğ‘£âˆ—â„ğ‘œ1)âˆ’1modğ‘˜+1,â„“â€²(â„ğ‘œ1â„ğ‘œ2)=â„“(â„ğ‘œ1â„ğ‘œ2)+1modğ‘˜+1,â€¦,â„“â€²(â„ğ‘œğ‘›ğ‘£)=â„“(â„ğ‘œğ‘›ğ‘£)âˆ’1modğ‘˜+1. We perform similar modifications as traversing P_e(v)ğ‘ƒğ‘’(ğ‘£) from one end to the other. Thus \ell '(v^*h_1^e)=\ell (v^*h_1^e)+1\bmod {k+1}, \ell '(h_1^eh_2^e) =\ell (h_1^eh_2^e)-1\bmod {k+1},\ldots ,\ell '(h_m^ev)=\ell (h_m^ev) -1\bmod {k+1}â„“â€²(ğ‘£âˆ—â„ğ‘’1)=â„“(ğ‘£âˆ—â„ğ‘’1)+1modğ‘˜+1,â„“â€²(â„ğ‘’1â„ğ‘’2)=â„“(â„ğ‘’1â„ğ‘’2)âˆ’1modğ‘˜+1,â€¦,â„“â€²(â„ğ‘’ğ‘šğ‘£)=â„“(â„ğ‘’ğ‘šğ‘£)âˆ’1modğ‘˜+1. These modifications do not affect the colours of the internal vertices of P_o(v)ğ‘ƒğ‘œ(ğ‘£) and P_e(v)ğ‘ƒğ‘’(ğ‘£). We perform these modifications one after the other. That is, if we start by modifying P_o(v)ğ‘ƒğ‘œ(ğ‘£), then we continue by modifying P_e(v)ğ‘ƒğ‘’(ğ‘£), next with modifying P_o(v)ğ‘ƒğ‘œ(ğ‘£), and so on. Each time we modify P_o(v)ğ‘ƒğ‘œ(ğ‘£) or P_e(v)ğ‘ƒğ‘’(ğ‘£), the colour of v is reduced by 1\bmod {k+1}1modğ‘˜+1 and if we alternate between modifying P_o(v)ğ‘ƒğ‘œ(ğ‘£) and P_e(v)ğ‘ƒğ‘’(ğ‘£), then the colour of v^*ğ‘£âˆ— stays the same.

Let v\in S_i\setminus S_i^*ğ‘£âˆˆğ‘†ğ‘–âˆ–ğ‘†âˆ—ğ‘–. We alternate between modifying P_o(v)ğ‘ƒğ‘œ(ğ‘£) and P_e(v)ğ‘ƒğ‘’(ğ‘£) until c_{\ell '}(v)=i\bmod {k+1}ğ‘â„“â€²(ğ‘£)=ğ‘–modğ‘˜+1. Then me move on to modifying another vertex v'\in S_{i'}\setminus S_{i'}^*ğ‘£â€²âˆˆğ‘†ğ‘–â€²âˆ–ğ‘†âˆ—ğ‘–â€² (i is not necessarily different from i'ğ‘–â€²). If the last modification for v was on P_o(v)ğ‘ƒğ‘œ(ğ‘£), then we start with modifying P_e(v')ğ‘ƒğ‘’(ğ‘£â€²) and once more we proceed by alternating between modification on P_e(v')ğ‘ƒğ‘’(ğ‘£â€²) and P_o(v')ğ‘ƒğ‘œ(ğ‘£â€²) and vice versa.

It is clear that once the above process is finished, for each v\ne v^*ğ‘£â‰ ğ‘£âˆ— and i, we have v\in S_iğ‘£âˆˆğ‘†ğ‘– if and only if c_{\ell '}(v)=i\bmod {k+1}ğ‘â„“â€²(ğ‘£)=ğ‘–modğ‘˜+1. Also, if the total number w of modifications done is even, then c_{\ell '}(v^*)=d\bmod {k+1}ğ‘â„“â€²(ğ‘£âˆ—)=ğ‘‘modğ‘˜+1 and if w is odd, then c_{\ell '}(v^*)=d-1\bmod {k+1}ğ‘â„“â€²(ğ‘£âˆ—)=ğ‘‘âˆ’1modğ‘˜+1. In any case, and since before the modifications we had S_{d-1}=\emptyset ğ‘†ğ‘‘âˆ’1=âˆ…, the vertex-colouring c_{\ell '}ğ‘â„“â€² of G is proper. Note that this remains true when turning all labels 0 into k+1ğ‘˜+1, so that \ell 'â„“â€² is a proper (k+1)(ğ‘˜+1)-labelling as desired. Recall also that the modifications are done on the edges of H and |E(H)|=|V(G)||ğ¸(ğ»)|=|ğ‘‰(ğº)|. In the worst case, all the edges of H are labelled k+1ğ‘˜+1 by \ell 'â„“â€² and thus \mathrm{mE}(G,\ell ')\le |E|+k|V|mE(ğº,â„“â€²)â‰¤|ğ¸|+ğ‘˜|ğ‘‰|. \square â—»

In most proof contexts making use of the walk-switching procedure described in the proof of Theorem 5.3, there are favourable situations in which the bound can be further reduced. The next result illustrates that fact.

Theorem 5.4
Let G=(V,E)ğº=(ğ‘‰,ğ¸) be a nice connected graph with odd chromatic number k=\chi (G)ğ‘˜=ğœ’(ğº) at least 3. Then, we have \mathrm{mE}(G) \le \mathrm{mE}_{k}(G)\le |E|+(k-1)|V|mE(ğº)â‰¤mEğ‘˜(ğº)â‰¤|ğ¸|+(ğ‘˜âˆ’1)|ğ‘‰|.

Proof
Let H be the subgraph of G as it was defined in the proof of Theorem 5.3 and S_iğ‘†ğ‘– be the stable sets induced by a proper vertex-colouring c of G. Our goal is to reach, by \ell â„“, the desired colours modulo k. Under that assumption, we can here assign labels 0, \dots , k-10,â€¦,ğ‘˜âˆ’1 instead. Once more, we start with \ell â„“ assigning label 1 to all edges of G. For each 1\le i\le k1â‰¤ğ‘–â‰¤ğ‘˜, let S_i^*=\{v\in S_i \mid c_\ell (v)=i\bmod {k}\}ğ‘†âˆ—ğ‘–={ğ‘£âˆˆğ‘†ğ‘–âˆ£ğ‘â„“(ğ‘£)=ğ‘–modğ‘˜}.

For each v\in S_i\setminus S_i^*ğ‘£âˆˆğ‘†ğ‘–âˆ–ğ‘†âˆ—ğ‘–, let P_vğ‘ƒğ‘£ be an odd-length closed walk of H that contains v. Again the existence of P_vğ‘ƒğ‘£ is guaranteed because of C. We proceed by modifying the labels of P_vğ‘ƒğ‘£: we alternate between adding 1 (modulo k) and removing 1 (modulo k) from the labels of consecutive edges of P_vğ‘ƒğ‘£. Since P_vğ‘ƒğ‘£ is a closed walk of odd length, exactly two consecutive edges (not necessarily distinct) will have to be altered in the same way (i.e., either they are both incremented by 1 or reduced by 1 modulo k). The modification is done so that these two edges have v as a common vertex. Let \ell 'â„“â€² be the modified \ell â„“ and let us assume that the labels of the edges of H that are adjacent to v are both incremented by 1 modulo k (symmetric arguments hold for the other case). Clearly c_{\ell '}(v)=c_{\ell }(v)+2\bmod {k}ğ‘â„“â€²(ğ‘£)=ğ‘â„“(ğ‘£)+2modğ‘˜ and since k is odd, by repeating this process the desired value c_{\ell '}(v)=i\bmod {k}ğ‘â„“â€²(ğ‘£)=ğ‘–modğ‘˜ is eventually reached.

Eventually turn all 0â€™s into kâ€™s. In the worst case, \ell 'â„“â€² assigns label k on each one of the |V| edges of H. Thus \mathrm{mE}(G,\ell ')\le |E|+(k-1)|V|mE(ğº,â„“â€²)â‰¤|ğ¸|+(ğ‘˜âˆ’1)|ğ‘‰|. \square â—»

Bipartite Graphs
In this section, we prove Conjecture 5.2 for nice bipartite graphs. It turns out, however, that we are not aware of many bipartite graphs G for which \mathrm{mE}_3(G)mE3(ğº) reaches exactly 2|E|. To go further, we both improve the upper bound in particular contexts, and exhibit constructions of connected bipartite graphs G with large value of \mathrm{mE}_2(G)mE2(ğº), that are legitimate candidates for having \mathrm{mE}(G)mE(ğº) large. Throughout this section, it is worth keeping in mind that determining \mathrm{mE}_2(G)mE2(ğº) for a given bipartite graph G is {\mathcal {N}}{\mathcal {P}}îˆºîˆ¼-complete by Theorem 3.2.

Conjecture 5.2 for Nice Bipartite Graphs
Since, according to [14], nice bipartite graphs G verify the 1â€“2â€“3 Conjecture and some of them even verify \chi _\Sigma (G)=3ğœ’Î£(ğº)=3, they can be classified into three classes {\mathcal {B}}_1îˆ®1, {\mathcal {B}}_2îˆ®2 and {\mathcal {B}}_3îˆ®3 where, for each i \in \{1,2,3\}ğ‘–âˆˆ{1,2,3}, the set {\mathcal {B}}_iîˆ®ğ‘– contains exactly the connected bipartite graphs G with \chi _{\Sigma }(G)=iğœ’Î£(ğº)=ğ‘–. Note that {\mathcal {B}}_1îˆ®1 contains the locally irregular bipartite graphs G, each one of which verifies \mathrm{mE}_1(G) = |E|mE1(ğº)=|ğ¸|. The graphs G of {\mathcal {B}}_2îˆ®2 admit proper 2-labellings, and, for these, by Observation 2.1 we have \mathrm{mE}_2(G) \le 2 |E|mE2(ğº)â‰¤2|ğ¸|. So, in order to prove Conjecture 5.2 for nice bipartite graphs, we only need to focus on the graphs of {\mathcal {B}}_3îˆ®3.

Fig. 4
figure 4
Constructing an odd multi-cactus through several steps, from the red-green C_6ğ¶6 (a). Red-green paths with length at least 5 congruent to 1 modulo 4 are being repeatedly attached onto green edges through steps (bâ€“d). Solid edges are red edges. Wiggly edges are green edges (Color figure online)

Full size image

The graphs of {\mathcal {B}}_3îˆ®3 were characterized by Thomassen, Wu and Zhang in [20], who proved that these graphs are exactly the so-called odd multi-cacti, which are the graphs that can be obtained at any step of the following procedure (see Fig. 4 for an illustration):

Start from a cycle with length at least 6 congruent to 2 modulo 4 whose edges are properly coloured with red and green (i.e., no two adjacent edges have the same colour).

Consider a green edge uv and join u and v via a new path of length at least 5 congruent to 1 modulo 4 whose edges are properly coloured with red and green, where both the edge incident to u and the edge incident to v are red.

It is worth mentioning that odd multi-cacti are 2-degenerate and 2-connected. Also, they are bipartite, and both of their parts have odd size. It can also be noted that for every green edge uv, we have d(u)=d(v)ğ‘‘(ğ‘¢)=ğ‘‘(ğ‘£), and no two green edges share ends. In [8], it was actually shown that any nice bipartite graph with a part of even size does not belong to {\mathcal {B}}_3îˆ®3:

Lemma 5.5
[8] Let G=(U,V,E)ğº=(ğ‘ˆ,ğ‘‰,ğ¸) be a connected bipartite graph. If |U| is even, then \chi _{\Sigma }(G) \le 2ğœ’Î£(ğº)â‰¤2. Furthermore, G admits proper 2-labellings where all vertices of U have odd colour while all vertices of V have even colour.

We are now ready to prove our main result in this section.

Theorem 5.6
For every nice connected bipartite graph G, we have \mathrm{mE}(G) \le \mathrm{mE}_3(G) \le 2|E|mE(ğº)â‰¤mE3(ğº)â‰¤2|ğ¸|.

Proof
Since the statement holds for G\in {\mathcal {B}}_1\cup {\mathcal {B}}_2ğºâˆˆîˆ®1âˆªîˆ®2, as explained earlier, we can assume G \in {\mathcal {B}}_3ğºâˆˆîˆ®3, i.e., G is an odd multi-cactus with bipartition (U, V) (where both |U| and |V| are odd). If G is a cycle with length at least 6 congruent to 2 modulo 4, then the result follows from Theorem 2.6. Thus, we may assume that \Delta (G) \ge 3Î”(ğº)â‰¥3, i.e., some path attachments were made to build G starting from an original cycle.

Let us consider the last green edge xy to which a path P=(x,v_1,\ldots ,v_{4k},y)ğ‘ƒ=(ğ‘¥,ğ‘£1,â€¦,ğ‘£4ğ‘˜,ğ‘¦) was attached in the construction of G, where k \ge 1ğ‘˜â‰¥1. Recall that d(x)=d(y) \ge 3ğ‘‘(ğ‘¥)=ğ‘‘(ğ‘¦)â‰¥3 by construction. Consider G'=G-\{v_1,v_2,v_3\}ğºâ€²=ğºâˆ’{ğ‘£1,ğ‘£2,ğ‘£3}. Assuming v_1,v_3 \in Uğ‘£1,ğ‘£3âˆˆğ‘ˆ and v_2 \in Vğ‘£2âˆˆğ‘‰, the bipartition of G'ğºâ€² is (U',V')=(U \setminus \{v_1,v_3\}, V \setminus \{v_2\})(ğ‘ˆâ€²,ğ‘‰â€²)=(ğ‘ˆâˆ–{ğ‘£1,ğ‘£3},ğ‘‰âˆ–{ğ‘£2}). This means that |V'||ğ‘‰â€²| is even. By Lemma 5.5, there is a proper 2-labelling \ell 'â„“â€² of G'ğºâ€² such that all vertices of U'ğ‘ˆâ€² have even colour while all vertices of V'ğ‘‰â€² have odd colour. Since x \in V'ğ‘¥âˆˆğ‘‰â€², the colour c_{\ell '}(x)ğ‘â„“â€²(ğ‘¥) is odd, and thus at least 3 since d_{G'}(x) \ge 2ğ‘‘ğºâ€²(ğ‘¥)â‰¥2. Similarly, v_4 \in V'ğ‘£4âˆˆğ‘‰â€², so the colour c_{\ell '}(v_4)ğ‘â„“â€²(ğ‘£4) is odd, and it is precisely 1 since d_{G'}(v_4)=1ğ‘‘ğºâ€²(ğ‘£4)=1.

We now extend \ell 'â„“â€² to a proper 3-labelling \ell â„“ of G, by assigning label 1 to v_1v_2ğ‘£1ğ‘£2, label 2 to xv_1ğ‘¥ğ‘£1 and v_3v_4ğ‘£3ğ‘£4, and label 3 to v_2v_3ğ‘£2ğ‘£3. This way:

c_\ell (x)ğ‘â„“(ğ‘¥) and c_\ell (v_4)ğ‘â„“(ğ‘£4) remain odd;

c_\ell (v_1)=3<5\le c_\ell (x)ğ‘â„“(ğ‘£1)=3<5â‰¤ğ‘â„“(ğ‘¥);

c_\ell (v_3)=5>3=c_\ell (v_4)ğ‘â„“(ğ‘£3)=5>3=ğ‘â„“(ğ‘£4);

c_\ell (v_2)=4 \not \in \{c_\ell (v_1),c_\ell (v_3)\}=\{3,5\}ğ‘â„“(ğ‘£2)=4âˆ‰{ğ‘â„“(ğ‘£1),ğ‘â„“(ğ‘£3)}={3,5}.

For these reasons, it should be clear that \ell â„“ is indeed proper. We additionally note that label 3 is actually assigned only once by \ell â„“, to v_2v_3ğ‘£2ğ‘£3. Furthermore, \ell â„“ assigns label 1 at least once, e.g. to v_1v_2ğ‘£1ğ‘£2. From this, it follows that \sigma (\ell ) \le 2 |E|ğœ(â„“)â‰¤2|ğ¸|. \square â—»

As mentioned earlier, the only connected bipartite graph G verifying \mathrm{mE}(G)=2|E|mE(ğº)=2|ğ¸| we are aware of, is C_6ğ¶6. Due to the small number of edges of C_6ğ¶6, this case looks quite pathological. In particular, it is natural to wonder whether Theorem 5.6 can be improved in general, when excluding C_6ğ¶6. We investigate this concern in what follows.

Lower Bounds for Some Bipartite Graphs
Our main result in this section is that, in general, for a nice connected bipartite graph G it is not possible to lower \mathrm{mE}_2(G)mE2(ğº) below the \frac{3}{2}|E|32|ğ¸| barrier. Put differently, there exist connected bipartite graphs for which label 2 must be assigned to at least half of the edges by any proper 2-labelling. This is a consequence of the following more general result, which is of independent interest.

Theorem 5.7
Let G be any nice connected graph, and let H be a graph obtained from G by subdividing every edge e exactly n_eğ‘›ğ‘’ times, where n_e=4k_e+3ğ‘›ğ‘’=4ğ‘˜ğ‘’+3 for some k_e \ge 0ğ‘˜ğ‘’â‰¥0. Then \chi _{\Sigma }(H)=2ğœ’Î£(ğ»)=2. Furthermore, \mathrm{mE}_2(H)=\frac{3}{2}|E(H)|mE2(ğ»)=32|ğ¸(ğ»)|.

Proof
For every edge e=uvğ‘’=ğ‘¢ğ‘£ of G, let us denote by P_eğ‘ƒğ‘’ the corresponding path of length 4(k_e+1)4(ğ‘˜ğ‘’+1) in H. Note that H has many adjacent 2-vertices, so \chi _\Sigma (H)>1ğœ’Î£(ğ»)>1. Also, H is bipartite with bipartition (X, Y), where w.l.o.g. X contains all vertices of G. Now let \ell â„“ be the 2-labelling of H obtained by considering every edge e=uvğ‘’=ğ‘¢ğ‘£ of G, and assigning labels 2,1,1,2,2,1,1,\ldots ,1,1,22,1,1,2,2,1,1,â€¦,1,1,2 to the consecutive edges of P_eğ‘ƒğ‘’ as going from u to v. Then \ell â„“ is proper since all vertices in X have even colour, while all vertices in Y have odd colour. The last part of the claim follows from the fact that for every edge e of G, in any labelling \ell â„“ of H every two edges of P_eğ‘ƒğ‘’ being at distance 2 apart must receive distinct labels (recall Observation 2.3). Due to the length of P_eğ‘ƒğ‘’, this implies that the sum of the labels assigned to its edges is at least \frac{3}{2}|E(P_e)|32|ğ¸(ğ‘ƒğ‘’)|. Thus, \sigma (\ell ) \ge \frac{3}{2}|E(H)|ğœ(â„“)â‰¥32|ğ¸(ğ»)|. \square â—»

Corollary 5.8
There exist infinitely many connected bipartite graphs G \in {\mathcal {B}}_2ğºâˆˆîˆ®2 with various structure verifying \mathrm{mE}_2(G) =\frac{3}{2}|E|mE2(ğº)=32|ğ¸|. This remains true for trees.

Proof
This follows from Theorem 5.7. The last part of the statement is because any subdivision of a tree is clearly a tree itself. \square â—»

In particular through experimentation via computer programs, we also managed to come up with the following construction yielding connected bipartite graphs G for which \mathrm{mE}_2(G)mE2(ğº) slightly exceeds \frac{3}{2}|E|32|ğ¸|. These graphs can be constructed as follows. Let x,y \ge 4ğ‘¥,ğ‘¦â‰¥4 be any two integers congruent to 0 modulo 4. The graph H(x, y) is the graph obtained by starting from the disjoint union of a cycle C with length x and a cycle C'ğ¶â€² with length y, by adding an edge joining any vertex of C and any vertex of C'ğ¶â€². Note that H(x, y) has odd size.

Theorem 5.9
Let x, y be any two integers congruent to 0 modulo 4, with x,y \ge 4ğ‘¥,ğ‘¦â‰¥4. Then, we have \mathrm{mE}_2(H(x,y))=\left\lceil \frac{3}{2} |E(H(x,y))|\right\rceil mE2(ğ»(ğ‘¥,ğ‘¦))=âŒˆ32|ğ¸(ğ»(ğ‘¥,ğ‘¦))|âŒ‰.

Proof
We begin by showing the following claim:

Claim 5.10
Let G be obtained from a cycle C with length x at least 4 congruent to 0 modulo 4 by adding an edge from any vertex v of C to a new pending vertex u. Then, by any proper 2-labelling \ell â„“ of G, exactly half of the edges of G must be labelled 2. Furthermore, either:

\ell (vu)=1â„“(ğ‘£ğ‘¢)=1 and c_\ell (v)=5ğ‘â„“(ğ‘£)=5, or

\ell (vu)=2â„“(ğ‘£ğ‘¢)=2 and c_\ell (v)ğ‘â„“(ğ‘£) can be either of 4, 5, 6.

Proof of the claim. Let us denote by v_0,\ldots ,v_{x-1}ğ‘£0,â€¦,ğ‘£ğ‘¥âˆ’1 the successive vertices of C, where v_0=vğ‘£0=ğ‘£. Because d(v_i)=2ğ‘‘(ğ‘£ğ‘–)=2 for every i \in \{1,\ldots ,x-1\}ğ‘–âˆˆ{1,â€¦,ğ‘¥âˆ’1}, recall, according to Observation 2.3, that, by any proper 2-labelling \ell â„“ of G, we must have \ell (v_0v_1) \ne \ell (v_2v_3) \ne \ell (v_4v_5) \ne \dots \ne \ell (v_{x-2}v_{x-1})â„“(ğ‘£0ğ‘£1)â‰ â„“(ğ‘£2ğ‘£3)â‰ â„“(ğ‘£4ğ‘£5)â‰ â‹¯â‰ â„“(ğ‘£ğ‘¥âˆ’2ğ‘£ğ‘¥âˆ’1) (and thus, by the length of x, we have \ell (v_0v_1) \ne \ell (v_{x-2}v_{x-1})â„“(ğ‘£0ğ‘£1)â‰ â„“(ğ‘£ğ‘¥âˆ’2ğ‘£ğ‘¥âˆ’1)), and similarly \ell (v_1v_2) \ne \ell (v_3v_4) \ne \ell (v_5v_6) \ne \dots \ne \ell (v_{x-1}v_0)â„“(ğ‘£1ğ‘£2)â‰ â„“(ğ‘£3ğ‘£4)â‰ â„“(ğ‘£5ğ‘£6)â‰ â‹¯â‰ â„“(ğ‘£ğ‘¥âˆ’1ğ‘£0) (and thus \ell (v_1v_2) \ne \ell (v_{x-1}v_0)â„“(ğ‘£1ğ‘£2)â‰ â„“(ğ‘£ğ‘¥âˆ’1ğ‘£0)). So there are essentially three ways for \ell â„“ to be designed:

If \ell (v_0v_1)=\ell (v_0v_{x-1})=1â„“(ğ‘£0ğ‘£1)=â„“(ğ‘£0ğ‘£ğ‘¥âˆ’1)=1, then \ell (v_1v_2)=\ell (v_{x-1}v_{x-2})=2â„“(ğ‘£1ğ‘£2)=â„“(ğ‘£ğ‘¥âˆ’1ğ‘£ğ‘¥âˆ’2)=2, and c_\ell (v_1)=c_\ell (v_{x-1})=3ğ‘â„“(ğ‘£1)=ğ‘â„“(ğ‘£ğ‘¥âˆ’1)=3. In that case, so that c_\ell (v_0) \ne 3ğ‘â„“(ğ‘£0)â‰ 3, we must have \ell (v_0u)=2â„“(ğ‘£0ğ‘¢)=2 in which case c_\ell (v_0)=4ğ‘â„“(ğ‘£0)=4.

If \ell (v_0v_1)=\ell (v_0v_{x-1})=2â„“(ğ‘£0ğ‘£1)=â„“(ğ‘£0ğ‘£ğ‘¥âˆ’1)=2, then \ell (v_1v_2)=\ell (v_{x-1}v_{x-2})=1, and c_\ell (v_1)=c_\ell (v_{x-1})=3. In that case, we can either have \ell (v_0u)=1 in which case c_\ell (v_0)=5, or \ell (v_0u)=2 in which case c_\ell (v_0)=6.

If \ell (v_0v_1)=1 and \ell (v_0v_{x-1})=2, then \ell (v_1v_2)=1 and \ell (v_{x-1}v_{x-2})=2, and c_\ell (v_1)=2 and c_\ell (v_{x-1})=4. In that case, so that c_\ell (v_0) \ne 4, we must have \ell (v_0u)=2 in which case c_\ell (v_0)=5.

This concludes the proof. \diamond

Let G=H(x,y), and \ell be a proper 2-labelling of G. Let H_1,H_2 be the two connected components resulting from the removal of the unique bridge uv of G, and G_1 and G_2 be the subgraphs H_1+uv and H_2+uv, respectively, of G (where, say, G_1 contains the cycle C_1 with length x, and G_2 contains the cycle C_2 with length y). Applying Claim 5.10 onto G_1 and G_2 and the restriction of \ell to these graphs, we deduce that we cannot have \ell (uv)=1 as otherwise we would have c_\ell (u)=c_\ell (v)=5, a contradiction. So we must have \ell (uv)=2. Furthermore, still by Claim 5.10, exactly half of the edges of C_1 must be labelled 2 by \ell , and similarly exactly half of the edges of C_2 must be labelled 2. It yields that . Note that \ell does exist, since G is not an odd multi-cactus (due to the presence of the bridge uv). In particular, the edges of C_1 and C_2 can be 2-labelled in such a way that c_\ell (u) and c_\ell (v) are two distinct values in \{4,5,6\}. \square

Improved Upper Bounds
As shown previously, it seems that, in general, for nice connected bipartite graphs the bound in Theorem 5.6 might not be optimal. Following our investigations in the previous section, we believe that perhaps the following could be the right direction to investigate:

Conjecture 5.11
There is an absolute constant c \ge 1 such that, for every nice connected bipartite graph G \in {\mathcal {B}}_2, we have \mathrm{mE}_2(G) \le \frac{3}{2}|E|+c.

It is worth pointing out that a proper 2-labelling \ell of a graph G where \sigma (\ell ) is about \frac{3}{2} |E| is actually a 2-labelling where the number of assigned 1â€™s is about the same as the number of assigned 2â€™s. Thus, Conjecture 5.11 can be sort of related to the notion of equitable proper labellings of graphs, which were introduced in [3] and are proper labellings where, for every two assigned labels i, j, the number of edges assigned label i differs by at most 1 from the number of edges assigned label j. Regarding Conjecture 5.11, it can be observed that \mathrm{mE}_2(G) \le \frac{3}{2} |E|+1 holds for every graph G admitting an equitable proper 2-labelling. The additive c term is naturally reduced from 1 to 0 when G has even size. Among other results, the authors in [3] proved that nice bipartite complete graphs and forests admit equitable proper 2-labellings.

Towards Conjecture 5.11, in this section our aim is to improve Theorem 5.6 further for the bipartite graphs of {\mathcal {B}}_2. First off, we point out that the theoretical upper bound in Theorem 5.6 cannot be reached for a bipartite graph in {\mathcal {B}}_2.

Observation 5.12
For every graph G \in {\mathcal {B}}_2, we have \mathrm{mE}_2(G)<2|E|

Proof
By definition of {\mathcal {B}}_1, {\mathcal {B}}_2 and {\mathcal {B}}_3, since G \not \in {\mathcal {B}}_1 the graph G is not locally irregular. Now, if \mathrm{mE}_2(G)=2 |E|, then the only proper 2-labelling of G is the one assigning label 2 to all edges. For such a labelling to be proper, G must have no two adjacent vertices having the same degree. So G must be locally irregular, a contradiction. \square

In particular contexts, better bounds can be obtained by adapting the arguments from the proof of Theorem 5.3 in a particular way.

Theorem 5.13
Let G=(U,V,E) be a nice connected bipartite graph where |U| is even. Then, we have \mathrm{mE}_2(G) \le |E| + |V| -1.

Proof
Let us denote by U_e (U_o, respectively) the set of vertices of U having even (odd, respectively) degree in G, and similarly by V_e (V_o, respectively) the set of vertices of V having even (odd, respectively) degree in G. Note that either |U_e| and |V_o| must have the same parity, or |U_o| and |V_e| must have the same parity. This is because, otherwise, since |U| is even and |U|=|U_e|+|U_o|, the sizes |U_e| and |U_o| must have the same parity, we would get that also |V_e| and |V_o| have the same parity. From this, we would deduce that \sum _{u \in U} d(u) \not \equiv \sum _{v \in V} d(v) \bmod 2, which is not possible.

Without loss of generality, we may assume that U_e and V_o have the same parity, thus that |U_e|+|V_o| is even. Our aim now, is to design a 2-labelling of G where all vertices in U get odd colour while all vertices in V get even colour. Such a labelling will obviously be proper. To that aim, we proceed as follows. Let us start with assigning label 1 to all edges of G. This way, at this point the colour of every vertex is exactly its degree; so all vertices in U_o and V_e verify the desired colour property, while all vertices in U_e and V_o do not. To fix these vertices, we consider any spanning tree T of G. We now repeatedly apply the following fixing procedure: we consider any two vertices x and y of U_e \cup V_o that remain to be fixed, and flip (i.e., turn the 1â€™s into 2â€™s, and vice versa) the labels of all edges on the unique path in T from x to y. This way, note that only the colours of x and y are altered modulo 2. Since |U_e|+|V_o| is even, there are an even number of vertices to fix, and, by flipping labels along paths of T, we can fix the colour of all vertices in U_e \cup V_o. This results in a 2-labelling \ell of G, with the desired properties, which is thus proper.

Note now that \ell assigns label 2 only to a subset of the edges of T. Since T has |V(G)|-1 edges, the result follows. \square

Note for instance that, for a graph G, we have |E|+|V|-1 \le \frac{3}{2} |E| as soon as |E| \ge 2 |V|-2. As notable consequences, this implies that a connected bipartite graph G \in {\mathcal {B}}_2 with a part of even size verifies \mathrm{mE}_2(G) \le \frac{3}{2} |E| as soon as G has minimum degree at least 4, or more generally when the graph is dense enough.

The same result also holds when G is bipartite and cubic (in which case \chi _\Sigma (G)=2, by definition of odd multi-cacti), from a more general argument:

Observation 5.14
Let G be a connected regular graph with \chi _\Sigma (G)=2. Then, we have \mathrm{mE}(G) \le \mathrm{mE}_2(G) \le \frac{3}{2} |E|.

Proof
Let \ell be a proper 2-labelling of G. Since G is regular, the edges labelled 1 by \ell , and similarly the edges labelled 2, must induce a locally irregular subgraph of G. Then the 2-labelling \ell ' of G obtained by turning all 1â€™s into 2â€™s, and vice versa, is also proper. Now there is one of \ell and \ell ' that assigns label 2 to at most half of the edges, and the conclusion follows. \square

Slight modifications of the proof of Theorem 5.13 also yield the desired result for certain bipartite graphs that are Hamiltonian.

Observation 5.15
Let G=(U,V,E) be a Hamiltonian bipartite graph where |U| is even. Then, we have \mathrm{mE}(G) \le \mathrm{mE}_2(G) \le \frac{3}{2}|E|.

Proof
Just mimic the proof of Theorem 5.13, but repair pairs of defective vertices of G along a Hamiltonian cycle C=(v_0, \dots , v_{n-1},v_0), matching each of them, say, with the next defective vertex in the ordering of C. If this fixing process turns more than half of the edges to 2, then, instead, repair pairs of vertices around C matching each of them with the previous defective vertex in the ordering (which is equivalent to flipping the labels along C). \square

Trees
Our main result here is that for every nice tree T, we have \mathrm{mE}_2(T) \le \frac{3}{2} |E|, which cannot be lowered in general, due to Corollary 5.8. Still, it confirms Conjecture 5.11 for nice trees. Let us recall that it was proved in [3] that nice forests admit equitable proper 2-labelling. This directly implies our result below for trees with even size, while it does not for trees with odd size (as a 2-labelling where the number of assigned 2â€™s is one more than the number of assigned 1â€™s does not fulfil our claim).

Theorem 5.16
For every nice tree T, we have \mathrm{mE}_2(T) \le \frac{3}{2} |E|.

Proof
The proof is by induction on the number of branching vertices of T, where by branching vertex we mean any vertex of degree at least 3. The base case is when T has no branching vertex, i.e., when \Delta (T) \le 2. In that case, T is a path. Let us here consider the 2-labelling \ell of T obtained by assigning labels 1,1,2,2,1,1,2,2,\ldots as traversing the edges from an end-vertex to the second one. It is easy to see that \ell is proper. Indeed, recall first that degree-1 vertices cannot be involved in a colour conflict. Furthermore, for two adjacent 2-vertices u, v to have the same colour, the edge incident to u different from uv must be assigned the same label as the edge incident to v different from uv (recall Observation 2.3). Since, by \ell , no two edges at distance 2 get assigned the same label, this implies that no colour conflict arises. Lastly, since 1â€™s and 2â€™s are assigned by pairs starting from a pair of 1â€™s, it should be clear that \ell assigns more 1â€™s than 2â€™s. Thus, \mathrm{mE}_2(T) \le \sigma (\ell ) \le \frac{3}{2} |E|.

We now focus on the general case. That is, we now assume that T has branching vertices, and every nice tree with fewer branching vertices verifies the claim. Let us root T at some degree-1 vertex r. In the usual way, this defines a (virtual) orientation of T, where every vertex v of T but r has a unique parent (unique neighbour of v that is closer to r), all vertices v but the leaves have children (neighbours of v that are farther from r), and more generally all vertices v but the leaves have descendants (vertices where their unique shortest path to r passes through v). By a deepest branching vertex of T, we refer to a branching vertex whose all descendants are not branching vertices, i.e., they have degree at most 2.

Let us consider a deepest branching vertex v of T. Then v is adjacent to its parent w and there are k \ge 2 hanging paths P_1,\ldots ,P_k attached to v. Note that some of the P_iâ€™s may be of length 1 in case some of the children of T are leaves. Let T' be the tree obtained from T by removing the edges of P_1,\ldots ,P_k (i.e., all their vertices different from v). If T' is just an edge, then T is actually a subdivided star. If T is a star with at least two leaves, then it is locally irregular and we can assign label 1 to all edges. Otherwise, when T is a subdivided star different from a star, then, without loss of generality, P_1 has length at least 2. We then change the root r to be the degree-1 vertex of P_1 so that, now, we can assume that T' indeed is not an edge.

Thus, we can assume that T' is not just an edge. Since T' has less branching vertices than T, by the induction hypothesis there is a proper 2-labelling \ell ' of T' verifying \mathrm{mE}(T',\ell ') \le \frac{3}{2} |E(T')|. We wish to extend \ell ' to the edges of P_1,\ldots ,P_k, thus to a 2-labelling \ell of T. To that aim, we consider the following two extension schemes for extending \ell ' to the edges of one P_x of the P_iâ€™s:

1-extension: We assign labels 1,1,2,2,1,1,2,2,\ldots to the consecutive edges of P_x, as they are traversed going from v to the degree-1 vertex of P_x.

2-extension: We assign labels 2,1,1,2,2,1,1,2,2,\ldots to the consecutive edges of P_x, as they are traversed going from v to the degree-1 vertex of P_x.

Note that whenever P_x has length not congruent to 1 modulo 4, the number of assigned 1â€™s is always at least the number of assigned 2â€™s by both 1-extensions and 2-extensions. More precisely, if P_x has length congruent to 1 modulo 4, then the number of 2â€™s by a 2-extension is one more than the number of 1â€™s, and vice versa by a 1-extension. Recall also that 1-vertices cannot be involved in colour conflicts. Furthermore, for two adjacent 2-vertices x, y to have the same colour, the edge incident to x different from xy must be labelled the same way as the edge incident to y different from xy. From this, we deduce that when extending \ell ' to the edges of the P_iâ€™s via 1-extensions and 2-extensions, we must just make sure that (1) the colour of v does not get equal to the colour of its parent w, and (2) the colour of v does not get equal to the colour of one of its children.

We note that the second type of colour conflict cannot actually occur. Indeed, note that by a 1-extension of P_x, the neighbour of v in P_x, unless it has degree 1 (in which case it cannot be in conflict with v), gets colour 2, while, by a 2-extension, it gets colour 3. Since v is a branching vertex with k \ge 2 children, thus of degree k+1, when performing 1-extensions and 2-extensions to the P_iâ€™s, vertex v gets colour precisely k+1 \ge 3 if only 1-extensions are performed, and colour at least k+2 \ge 4 if at least one 2-extension is performed.

Thus, we just need to find a combination of 1-extensions and 2-extensions to the P_iâ€™s so that no colour conflict involving v and its parent w arises. Also, we need to make sure that the number of assigned 1â€™s is at least the number of assigned 2â€™s. If one of the P_iâ€™s has length not congruent to 1 modulo 4, then we choose it as P_1. Otherwise, if they all have length congruent to 1 modulo 4, then we choose any P_i as P_1.

We first perform 1-extensions only, i.e., to all P_iâ€™s. If the colour of v gets different from that of w, then we are done. Otherwise, when performing a 2-extension to P_1 and a 1-extension to all other P_iâ€™s, the colour of v gets bigger, thus getting different from the colour of w. This results in the desired extension \ell to all edges of T.

Let us conclude by noting that the number of 1â€™s assigned by \ell is at least the number of assigned 2â€™s. This is because \mathrm{mE}_2(T',\ell ') \le \frac{3}{2} |E(T')|, and, as mentioned earlier, by 1-extensions to the P_iâ€™s the number of assigned 1â€™s is at least the number of assigned 2â€™s. By 2-extensions, this is true when performed on paths of length not congruent to 1 modulo 4. By our choice of P_1, if P_1 has length congruent to 1 modulo 4, then so do all P_iâ€™s. In that precise case, the number of 2â€™s assigned to the edges of P_1 is one bigger than the number of assigned 1â€™s, but this is compensated by the fact that, in P_2, the number of assigned 1â€™s is one bigger than the number of assigned 2â€™s. Thus we additionally have \sigma (\ell ) \le \frac{3}{2} |E(T)|, as desired. \square

Conclusion
In this work, we have studied proper labellings of graphs with the additional requirement that we want the sum of assigned labels to be as small as possible. Our interests were guided by both straight questions, such as determining \mathrm{mE}(G) for a given graph G, as well as more fundamental ones, such as the difference, in general, between \mathrm{mE}_k(G) and \mathrm{mE}_{k'}(G) for k \ne k'. We have also investigated the complexity of finding â€œoptimalâ€ labellings.

We quickly ran into Conjecture 5.2, which seems rather natural when knowing that the 1â€“2â€“3 Conjecture seems to be a more than plausible conjecture and that graphs, in general, seem to need only a few 3â€™s to design proper 3-labellings. We believe it would be interesting to further study this point in the future, as Conjecture 5.2 stands as the main open problem regarding our investigations in the current paper. It would also be interesting to progress towards its refinement for bipartite graphs, Conjecture 5.11. A way to progress towards answering both questions could be to exhibit families of connected (possibly bipartite) graphs G for which \mathrm{mE}(G) is â€œlargeâ€, i.e. larger than the quantity in Theorem 5.9.

Regarding our algorithmic results in Sect. 3, we note that they all deal, for a given graph G, with the parameter \mathrm{mE}_k(G) (for some k), and not with the more general parameter \mathrm{mE}(G). This is mainly because, as indicated by Theorem 4.5, in general there is no absolute constant that bounds, for all graphs G, the smallest k such that \mathrm{mE}(G)=\mathrm{mE}_k(G). In particular, even for a graph G of bounded treewidth, although we can determine \mathrm{mE}_k(G) in polynomial time for any k (due to our algorithm in Theorem 3.5), running multiple iterations of our algorithm to determine \mathrm{mE}(G) is not feasible in polynomial time. Thus, we leave the following problem open even for the seemingly simplest case:

