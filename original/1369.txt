We initiate the parameterized complexity study of minimum t-spanner problems on directed graphs. For a positive integer t, a multiplicative t-spanner of a (directed) graph G is a spanning subgraph H such that the distance between any two vertices in H is at most t times the distance between these vertices in G, that is, H keeps the distances in G up to the distortion (or stretch) factor t. An additive t-spanner is defined as a spanning subgraph that keeps the distances up to the additive distortion parameter t, that is, the distances in H and G differ by at most t. The task of DIRECTED MULTIPLICATIVE SPANNER is, given a directed graph G with m arcs and positive integers t and k, decide whether G has a multiplicative t-spanner with at most ğ‘šâˆ’ğ‘˜ arcs. Similarly, DIRECTED ADDITIVE SPANNER asks whether G has an additive t-spanner with at most ğ‘šâˆ’ğ‘˜ arcs. We show that (i) DIRECTED MULTIPLICATIVE SPANNER admits a polynomial kernel of size îˆ»(ğ‘˜4ğ‘¡5) and can be solved in randomized (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1) time, (ii) the weighted variant of DIRECTED MULTIPLICATIVE SPANNER can be solved in ğ‘˜2ğ‘˜â‹…ğ‘›îˆ»(1) time on directed acyclic graphs, (iii) DIRECTED ADDITIVE SPANNER is ğ–¶[1]-hard when parameterized by k for every fixed ğ‘¡â‰¥1 even when the input graphs are restricted to be directed acyclic graphs. The latter claim contrasts with the recent result of Kobayashi from STACS 2020 that the problem for undirected graphs is ğ–¥ğ–¯ğ–³ when parameterized by t and k.

Introduction
Given a (directed) graph G, a spanner is a spanning subgraph of G that approximately preserves distances between the vertices of G. Graph spanners were formally introduced by Peleg and SchÃ¤ffer in [16] (see also [17]). Originally, the concept was introduced for constructing network synchronizers [17]. However, graph spanners have a plethora of theoretical and practical applications in various areas like efficient routing and fast computing of shortest paths in networks, distributed computing, robotics, computational geometry and biology. We refer to the recent survey of Ahmed et al. [1] for the introduction to graph spanners and their applications.

We are interested in the classical multiplicative and additive graph spanners in graphs. Let G be a (directed) graph. For two vertices ğ‘¢,ğ‘£âˆˆğ‘‰(ğº), distğº(ğ‘¢,ğ‘£) denotes the distance between u and v in G, that is, the number of edges (arcs, respectively, for the directed case) of a shortest (u, v)-path. Let t be a positive integer. It is said that a spanning subgraph H of G is a multiplicative t-spanner if distğ»(ğ‘¢,ğ‘£)â‰¤ğ‘¡â‹…distğº(ğ‘¢,ğ‘£) for every two vertices ğ‘¢,ğ‘£âˆˆğ‘‰(ğº), i.e., H approximates distances in G within factor t. A spanning subgraph H of G is called an additive t-spanner if distğ»(ğ‘¢,ğ‘£)â‰¤distğº(ğ‘¢,ğ‘£)+ğ‘¡ for every ğ‘¢,ğ‘£âˆˆğ‘‰(ğº), that is, H approximates the distances in G within the additive parameter t. The standard task in the graph spanner problems is, given an allowed distortion parameter t, find a sparsest t-spanner, i.e., a spanner with the minimum number of edges. We consider the parameterized versions of this task:

figure a
and

figure b
Informally, the task of these problems is to decide whether we can delete at least k edges (arcs, respectively, for the directed case) in such a way that all the distances in the resulting graph are â€œt-closeâ€ to the original ones.

Previous work. We refer to [1] for the comprehensive survey of the known results and mention here only those that directly concern our work. First, we point that the considered graph spanner problems are computationally hard. It was already shown by Peleg and SchÃ¤ffer in [16] that deciding whether an undirected graph G has a multiplicative t-spanner with at most â„“ edges is ğ–­ğ–¯-complete even for fixed ğ‘¡=2. In fact, the problem is ğ–­ğ–¯-complete for every fixed ğ‘¡â‰¥2 [2]. Moreover, for every ğ‘¡â‰¥2, it is ğ–­ğ–¯-hard to approximate the minimum number of edges of a multiplicative t-spanner within the factor ğ‘logğ‘› for some ğ‘>1 [12]. The same complexity lower bounds for directed graphs were also shown by Cai [2] and Kortsarz [12]. Stronger inapproximability bounds were given by Elkin and Peleg [7]. Additive t-spanners for undirected graphs were introduced by Liestman and Shermer in [13, 14]. In particular, they proved in [14], that for every fixed ğ‘¡â‰¥1, it is ğ–­ğ–¯-complete to decide whether a graph G admits an additive t-spanner with at most â„“ edges. It was shown by ChlamtÃ¡c et al. [4] that for every integer ğ‘¡â‰¥1 and any constant ğœ€>0, there is no polynomial-time 2log1âˆ’ğœ€ğ‘›/ğ‘¡3-approximation for the minimum number of edges of an additive t-spanner unless ğ–­ğ–¯âŠ†ğ–£ğ–³ğ–¨ğ–¬ğ–¤(2polylog(n)).

The aforementioned hardness results make it natural to consider these spanner problems in the parameterized complexity framework. The investigation of MULTIPLICATIVE SPANNER and ADDITIVE SPANNER on undirected graphs was initiated by Kobayashi in [10] and [11]. In [10], it was proved that MULTIPLICATIVE SPANNER admits a polynomial kernel of size îˆ»(ğ‘˜2ğ‘¡2). For ADDITIVE SPANNER, it was shown in [11] that the problem can be solved in time 2îˆ»((ğ‘˜2+ğ‘˜ğ‘¡)logğ‘¡)â‹…ğ‘›îˆ»(1), that is, the problem is fixed-parameter tractable (ğ–¥ğ–¯ğ–³) when parameterized by k and t.

Our results. We initiate the study of MULTIPLICATIVE SPANNER and ADDITIVE SPANNER on directed graphs and further refer to them as DIRECTED MULTIPLICATIVE SPANNER and DIRECTED ADDITIVE SPANNER, respectively. We show that DIRECTED MULTIPLICATIVE SPANNER admits a kernel of size îˆ»(ğ‘˜4ğ‘¡5). We complement this result by observing that the problem can be solved in (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1) time by a Monte Carlo algorithm with false negatives. We leave open the question whether the problem is ğ–¥ğ–¯ğ–³ when parameterized by k only. However we show that this is the case when the inputs are restricted to be directed acyclic graphs (DAGs). In fact, we show the more general claim for the weighted variant of the problem called WEIGHTED DIRECTED MULTIPLICATIVE SPANNER, where the input directed graph G is supplied with a weight function ğœ”(â‹…) with positive values defining the lengths of the arcs and the distances are defined with respect to these arc lengths. Clearly, DIRECTED MULTIPLICATIVE SPANNER is the special case of this problem with unit arc lengths. We show that WEIGHTED DIRECTED MULTIPLICATIVE SPANNER can be solved in ğ‘˜2ğ‘˜â‹…ğ‘›îˆ»(1) on DAGs. We also observe that DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-complete on DAGs. For additive spanners, we show that the problem becomes much harder on directed graphs by showing that DIRECTED ADDITIVE SPANNER is ğ–¶[1]-hard for every fixed ğ‘¡â‰¥1 even on DAGs.

Organization of the paper. In Section 2, we introduce basic notions used in the paper. In Section 3, we prove that DIRECTED MULTIPLICATIVE SPANNER admits a polynomial kernel and sketch an ğ–¥ğ–¯ğ–³ algorithm. Further in this section, we show that DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-complete on DAGs and prove that WEIGHTED DIRECTED MULTIPLICATIVE SPANNER is ğ–¥ğ–¯ğ–³ for the parameterization by k only for this class of directed graphs. In Section 4, we show hardness for DIRECTED ADDITIVE SPANNER. We conclude in Section 5 by stating some open problems.

Preliminaries
Parameterized Complexity and Kernelization. We refer to the recent books [5, 6, 8] for the detailed introduction. In the Parameterized Complexity theory, the computational complexity is measured as a function of the input size n of a problem and an integer parameter k associated with the input. A parameterized problem is said to be fixed-parameter tractable (or ğ–¥ğ–¯ğ–³) if it can be solved in time ğ‘“(ğ‘˜)â‹…ğ‘›îˆ»(1) for some function ğ‘“(â‹…). A kernelization algorithm for a parameterized problem Î  is a polynomial algorithm that maps each instance (I, k) of Î  to an instance (ğ¼â€²,ğ‘˜â€²) of Î  such that

(i)
(I, k) is a yes-instance of Î  if and only if (ğ¼â€²,ğ‘˜â€²) is a yes-instance of Î , and

(ii)
|ğ¼â€²|+ğ‘˜â€² is bounded by f(k) for a computable function ğ‘“(â‹…).

Respectively, (ğ¼â€²,ğ‘˜â€²) is a kernel and ğ‘“(â‹…) is its size. A kernel is polynomial if ğ‘“(â‹…) is polynomial. It is common to present a kernelization algorithm as a series of reduction rules. A reduction rule for a parameterized problem is an algorithm that takes an instance of the problem and computes in polynomial time another instance that is more â€œsimpleâ€ in a certain way. A reduction rule is safe if the computed instance is equivalent to the input instance.

Graphs. Recall that an undirected graph is a pair ğº=(ğ‘‰,ğ¸), where V is a set of vertices and E is a set of unordered pairs {ğ‘¢,ğ‘£} of distinct vertices called edges. A directed graph ğº=(ğ‘‰,ğ´) is a pair, where V is a set of vertices and A is a set of ordered pairs (u, v) of distinct vertices called arcs. We say that u and v are incident to (u, v). Note we do not allow loops and multiple arcs (that are irrelevant for distances). We use V(G) and E(G) (A(G), respectively) to denote the set of vertices and the set of edges (set of arcs, respectively) of G. For a (directed) graph G and a subset ğ‘‹âŠ†ğ‘‰(ğº) of vertices, we write G[X] to denote the subgraph of G induced by X. For a set of vertices S, ğºâˆ’ğ‘† denotes the (directed) graph obtained by deleting the vertices of S, that is, ğºâˆ’ğ‘†=ğº[ğ‘‰(ğº)âˆ–ğ‘†]; for a vertex v, we write ğºâˆ’ğ‘£ instead of ğºâˆ’{ğ‘£}. Similarly, for a set of edges (arcs, respectively) S (an edge or arc e, respectively), ğºâˆ’ğ‘† (ğºâˆ’ğ‘’, respectively) denotes the graph obtained by the deletion of the elements of S (the deletion of e, respectively). A subgraph H of a (directed) graph G is a spanning subgraph of G if ğ‘‰(ğ»)=ğ‘‰(ğº). Every directed acyclic graph (DAG) G has a topological ordering of its vertex set, that is there exists ğœ‹:ğ‘‰(ğº)â†’{1,â€¦,|ğ‘‰(ğº)|} such that if (ğ‘¢,ğ‘£)âˆˆğ´(ğº) then ğœ‹(ğ‘¢)<ğœ‹(ğ‘£). The notation ğ‘¢â‰ºğ‘£ denotes ğœ‹(ğ‘¢)<ğœ‹(ğ‘£) and ğ‘¢âª¯ğ‘£ denotes that either ğœ‹(ğ‘¢)<ğœ‹(ğ‘£) or ğ‘¢=ğ‘£.

We write ğ‘ƒ=ğ‘£1â‹¯ğ‘£ğ‘˜ to denote a path with the vertices ğ‘£1,â€¦,ğ‘£ğ‘˜ and the edges {ğ‘£1,ğ‘£2},â€¦,{ğ‘£ğ‘˜âˆ’1,ğ‘£ğ‘˜} (arcs (ğ‘£1,ğ‘£2),â€¦,(ğ‘£ğ‘˜âˆ’1,ğ‘£ğ‘˜), respectively); ğ‘£1 and ğ‘£ğ‘˜ are the end-vertices of P and we say that P is a (ğ‘£1,ğ‘£ğ‘˜)-path. A single vertex path is trivial, and for a trivial ğ‘ƒ=ğ‘£, P is a (v, v)-path. All considered paths are assumed to be simple, that is, ğ‘£1,â€¦,ğ‘£ğ‘˜ are distinct. The length of a path is the number of edges (arcs, respectively) in the path. Also A(P) denotes the arc set of the path P. For a (u, v)-path ğ‘ƒ1 and a (v, w)-path ğ‘ƒ2, we denote by ğ‘ƒ1âˆ˜ğ‘ƒ2 the concatenation of ğ‘ƒ1 and ğ‘ƒ2. We use similar notation for walks; the difference between and a path and a walk is that, the vertices of a walk ğ‘Š=ğ‘£1â‹¯ğ‘£ğ‘˜ are not required to be distinct and a walk may go through the same edges (arcs, respectively) several times. Notice that the concatenation of two paths is a walk but not necessarily a path. For two vertices ğ‘¢,ğ‘£âˆˆğ‘‰(ğº), distğº(ğ‘¢,ğ‘£) denotes the distance between u and v in G, that is, the length of a shortest (u, v)-path; we assume that distğº(ğ‘¢,ğ‘£)=+âˆ if there is no (u, v)-path in G. Clearly, distğº(ğ‘¢,ğ‘£)=distğº(ğ‘£,ğ‘¢) for undirected graphs but this not always the case for directed graphs.

Let t be a positive integer. It is said that a spanning subgraph H of G is a multiplicative t-spanner if distğ»(ğ‘¢,ğ‘£)â‰¤ğ‘¡â‹…distğº(ğ‘¢,ğ‘£) for every ğ‘¢,ğ‘£âˆˆğ‘‰(ğº). A spanning subgraph H of G is called an additive t-spanner if distğ»(ğ‘¢,ğ‘£)â‰¤distğº(ğ‘¢,ğ‘£)+ğ‘¡ for every ğ‘¢,ğ‘£âˆˆğ‘‰(ğº).

We also consider the weighted variant of spanners for directed graph. Let G be an arc wighted directed graph, that is, we a given a weight (or length) function ğœ”:ğ´(ğº)â†’â„+ with positive values; we say that ğœ”(ğ‘’) is the length of an arc e. The length of a weighted path ğ‘ƒ=ğ‘£1â‹¯ğ‘£ğ‘˜ is âˆ‘ğ‘˜ğ‘–=2=ğœ”(ğ‘£ğ‘–âˆ’1,ğ‘£ğ‘–); the length of a trivial path is zero. Then the weighted distance distğœ”ğº(ğ‘¢,ğ‘£) is the length of a shortest path with respect to the arc lengths. For real ğ‘¡â‰¥1 and a weighted directed graph G, it is said that a spanning subgraph H a weighted multiplicative t-spanner if distğœ”ğ»(ğ‘¢,ğ‘£)â‰¤ğ‘¡â‹…distğœ”ğº(ğ‘¢,ğ‘£) for every ğ‘¢,ğ‘£âˆˆğ‘‰(ğº); note that the stretch factor t is not required to be an integer.

Directed Multiplicative t-spanners
In this section, we consider DIRECTED MULTIPLICATIVE SPANNER. We show that the problem admits a polynomial kernel and then complement this result by obtaining an ğ–¥ğ–¯ğ–³ algorithm. Further, we consider multiplicative spanners on DAGs. We prove that DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-complete on this class of directed graphs and show that WEIGHTED DIRECTED MULTIPLICATIVE SPANNER is ğ–¥ğ–¯ğ–³ when parameterized by k only. These results are based on locality of multiplicative spanners in the sense of the following observation made by Peleg and SchÃ¤ffer [16].

Observation 1
([16]). Let t be a positive integer (or ğ‘¡>1 be a real for the weighted case). A spanning subgraph H of a directed graph G is a (weighted) multiplicative t-spanner if and only if for every arc (ğ‘¢,ğ‘£)âˆˆğ´(ğº), there is a (u, v)-path in H of length at most t (t times the length of (u, v) in the weighted case).

Let t be a positive integer (or real for the weighted spanners) and let G be a directed graph. For an arc ğ‘=(ğ‘¢,ğ‘£) of G, we say that a (u, v)-path P is a t-detour for a if the length of P is at most t (t times the length of a in the weighted case) and P does not contain a. By Observation 1, to solve DIRECTED MULTIPLICATIVE SPANNER for (G, t, k), it is necessary and sufficient to identify k arcs that have t-detours that do not contain selected arcs. Then H can be constructed by deleting these arcs. Notice that this observation holds for both unweighted and weighted spanners. However, for the weighted case, the number of arcs in a t-detour may be arbitrary and depends on the length of a.

Polynomial Kernel for DIRECTED MULTIPLICATIVE SPANNER
In this subsection, we show that DIRECTED MULTIPLICATIVE SPANNER admits a polynomial kernel.

Theorem 1
DIRECTED MULTIPLICATIVE SPANNER has a kernel of size îˆ»(ğ‘˜4ğ‘¡5).

Proof
Let (G, t, k) be an instance of DIRECTED MULTIPLICATIVE SPANNER. Clearly, if ğ‘˜=0, then (G, t, k) is a yes-instance, and our algorithm returns a trivial yes-instance in this case. We assume from now that ğ‘˜>0.

We say that ğ‘âˆˆğ´(ğº) is t-good if G has a t-detour for a. Let S be the set of t-good arcs. Clearly, S can be constructed in polynomial time by making use of Dijkstraâ€™s algorithm. We follow the idea of Kobayashi [10] for constructing a polynomial kernel for undirected case and show that if S is sufficiently big, then (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER.

Claim 1
If |ğ‘†|â‰¥12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2), then (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER.

Proof of Claim 1
Let |ğ‘†|â‰¥12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2). For every ğ‘âˆˆğ‘†, let ğ‘ƒğ‘ be a t-detour for a.

Let ğ‘†0=âˆ…. For ğ‘–=1,â€¦,ğ‘˜, we iteratively construct sets of arcs ğ‘†1,â€¦,ğ‘†ğ‘˜ such that

ğ‘†0âŠ‚ğ‘†1âŠ‚â‹¯âŠ‚ğ‘†ğ‘˜âŠ†ğ‘†
and sets of arcs ğ‘…ğ‘– such that ğ‘…ğ‘–âŠ†ğ‘†ğ‘–âˆ–ğ‘†ğ‘–âˆ’1 and |ğ‘…ğ‘–|=(ğ‘˜âˆ’ğ‘–)ğ‘¡+1 for ğ‘–âˆˆ{1,â€¦,ğ‘˜} using the following procedure. For ğ‘–=1,â€¦,ğ‘˜,

select an arbitrary set ğ‘…ğ‘– of size (ğ‘˜âˆ’ğ‘–)ğ‘¡+1 in ğ‘†âˆ–ğ‘†ğ‘–âˆ’1,

set ğ‘†ğ‘–=ğ‘†ğ‘–âˆ’1âˆªâ‹ƒğ‘âˆˆğ‘…ğ‘–((ğ´(ğ‘ƒğ‘)âˆ©ğ‘†)âˆª{ğ‘}).

We show by induction, that the sets ğ‘†1,â€¦,ğ‘†ğ‘˜ and ğ‘…1,â€¦,ğ‘…ğ‘˜ exist. Since |ğ‘†âˆ–ğ‘†0|=|ğ‘†|â‰¥(ğ‘˜âˆ’1)ğ‘¡+1, we conclude that ğ‘…1 of size (ğ‘˜âˆ’1)ğ‘¡+1 can be selected. Assume that the sets ğ‘†ğ‘— and ğ‘…ğ‘— have been constructed for 0â‰¤ğ‘—<ğ‘–â‰¤ğ‘˜. Observe that because |â‹ƒğ‘âˆˆğ‘…ğ‘—((ğ´(ğ‘ƒğ‘)âˆ©ğ‘†)âˆª{ğ‘})|â‰¤(ğ‘¡+1)|ğ‘…ğ‘—|,

|ğ‘†ğ‘—âˆ–ğ‘†ğ‘—âˆ’1|â‰¤|ğ‘…ğ‘—|(ğ‘¡+1)=((ğ‘˜âˆ’ğ‘—)ğ‘¡+1)(ğ‘¡+1)
for 1â‰¤ğ‘—<ğ‘–. Therefore,

|ğ‘†ğ‘–âˆ’1|â‰¤âˆ‘ğ‘—=1ğ‘–âˆ’1(((ğ‘˜âˆ’ğ‘—)ğ‘¡+1)(ğ‘¡+1)).
(1)
Notice that

12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2)=âˆ‘ğ‘—=1ğ‘˜(((ğ‘˜âˆ’ğ‘—)ğ‘¡+1)(ğ‘¡+1)).
(2)
Then by (1) and (2),

|ğ‘†âˆ–ğ‘†ğ‘–âˆ’1|â‰¥âˆ‘ğ‘—=ğ‘–ğ‘˜(((ğ‘˜âˆ’ğ‘—)ğ‘¡+1)(ğ‘¡+1))â‰¥(ğ‘˜âˆ’ğ‘–)ğ‘¡+1.
This means that ğ‘…ğ‘– can be selected and we can construct ğ‘†ğ‘–.

Now we select arcs ğ‘ğ‘–âˆˆğ‘…ğ‘– for ğ‘–=ğ‘˜,ğ‘˜âˆ’1,â€¦,1. Since |ğ‘…ğ‘˜|=1, the choice of ğ‘ğ‘˜ is unique. Assume that ğ‘ğ‘˜,â€¦,ğ‘ğ‘–+1 have been selected for 1<ğ‘–+1â‰¤ğ‘˜. Then we select an arbitrary

ğ‘ğ‘–âˆˆğ‘…ğ‘–âˆ–â‹ƒğ‘—=ğ‘–+1ğ‘˜ğ´(ğ‘ƒğ‘ğ‘—).
Because |â‹ƒğ‘˜ğ‘—=ğ‘–+1ğ´(ğ‘ƒğ‘ğ‘—)|â‰¤(ğ‘˜âˆ’ğ‘–)ğ‘¡ and |ğ‘…ğ‘–|=(ğ‘˜âˆ’ğ‘–)ğ‘¡+1, ğ‘ğ‘– exists.

Let ğ‘–âˆˆ{1,â€¦,ğ‘˜}. By the choice of ğ‘ğ‘–, we have that ğ‘ğ‘–âˆ‰ğ´(ğ‘ƒğ‘ğ‘—) for ğ‘–<ğ‘—â‰¤ğ‘˜. From the other side, ğ‘ğ‘–âˆ‰ğ´(ğ‘ƒğ‘—) for 1â‰¤ğ‘—<ğ‘–, because ğ‘ğ‘–âˆˆğ‘…ğ‘– and ğ‘…ğ‘– does not contain the arcs of ğ‘ƒğ‘ for ğ‘âˆˆğ‘…ğ‘— for 1â‰¤ğ‘—<ğ‘– by the construction of the sets ğ‘…1,â€¦,ğ‘…ğ‘˜. We obtain that the t-detours ğ‘ƒğ‘ğ‘– for ğ‘–âˆˆ{1,â€¦,ğ‘˜} do not contain any ğ‘ğ‘— for ğ‘—âˆˆ{1,â€¦,ğ‘˜}. By Observation 1, ğ»=ğºâˆ’{ğ‘1,â€¦,ğ‘ğ‘˜} is a multiplicative t-spanner. Therefore, (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER. â—»

By Claim 1, we can apply the next rule:

Reduction Rule 1
If |ğ‘†|â‰¥12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2), then return a trivial yes-instance of DIRECTED MULTIPLICATIVE SPANNER and stop.

From now, we assume that |ğ‘†|<12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2).

The analog of Reduction Rule 1 is a main step of the kernelization algorithm of Kobayashi [10] for the undirected case, because it almost immediately allows to upper bound the total number of edges of the graph. However, the directed case is more complicated, since the arcs of t-detours for ğ‘âˆˆğ‘† may be outside S contrary to the undirected case, where all the edges of t-detours are in cycles of length at most ğ‘¡+1 and, therefore, have t-detours themselves. We use the following procedure to mark the crucial arcs of potential detours.

Marking Procedure Let ğºâ€²=ğºâˆ’ğ‘†.

(i)
For every (ğ‘¢,ğ‘£)âˆˆğ‘†, find a shortest (u, v)-path P in ğºâ€² and if the length of P is at most t, then mark the arcs of P.

(ii)
For every ordered pair of two distinct arcs (ğ‘¢1,ğ‘£1),(ğ‘¢2,ğ‘£2)âˆˆğ‘†,

(a)
find a shortest (ğ‘¢1,ğ‘¢2)-path ğ‘ƒ1 in ğºâ€² and if the length of ğ‘ƒ1 is at most t, then mark the arcs of ğ‘ƒ1,

(b)
find a shortest (ğ‘£2,ğ‘£1)-path ğ‘ƒ2 in ğºâ€² and if the length of ğ‘ƒ2 is at most t, then mark the arcs of ğ‘ƒ2,

(c)
find a shortest (ğ‘£1,ğ‘¢2)-path ğ‘ƒ3 in ğºâ€² and if the length of ğ‘ƒ3 is at most t, then mark the arcs of ğ‘ƒ3.

Observe that marking can be done in polynomial time by Dijkstraâ€™s algorithm. Denote by L the set of marked arcs. Our final rule constructs the output instance.

Reduction Rule 2
Consider the graph ğ»=(ğ‘‰(ğº),ğ‘†âˆªğ¿). Delete the isolated vertices of H, and for the obtained ğºâˆ—, output (ğºâˆ—,ğ‘¡,ğ‘˜).

We argue that the rule is safe.

Claim 2
(G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER if and only if (ğºâˆ—,ğ‘¡,ğ‘˜) is a yes-instance.

Proof of Claim 2
Suppose that (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER. Then, by Observation 1, there are k distinct arcs ğ‘1,â€¦,ğ‘ğ‘˜âˆˆğ‘† with their t-detours ğ‘ƒ1,â€¦,ğ‘ƒğ‘˜, respectively, such that ğ‘ğ‘–âˆ‰â‹ƒğ‘˜ğ‘—=1ğ´(ğ‘ƒğ‘—). Notice that ğ‘1,â€¦,ğ‘ğ‘˜âˆˆğ´(ğºâˆ—). Consider ğ‘–âˆˆ{1,â€¦,ğ‘˜} and let ğ‘ğ‘–=(ğ‘¢,ğ‘£).

Suppose that ğ‘ƒğ‘– does not contain arcs from S. Then ğ‘ƒğ‘– is a (u, v)-path in ğºâ€²=ğºâˆ’ğ‘†. By the first step of Marking Procedure, there is a t-detour ğ‘ƒâ€²ğ‘– for ğ‘ğ‘– whose arcs are in ğºâ€² and are marked. Then ğ‘ƒâ€²ğ‘– is a t-detour for ğ‘ğ‘– in ğºâˆ— and ğ‘ğ‘—âˆ‰ğ´(ğ‘ƒâ€²ğ‘–) for ğ‘—âˆˆ{1,â€¦,ğ‘˜}.

Assume that ğ‘ƒğ‘– contains some arcs from S. Let ğ‘’1,â€¦,ğ‘’ğ‘  be these arcs (in the path order with respect to ğ‘ƒğ‘– starting from u). Note that ğ‘’1,â€¦,ğ‘’ğ‘ âˆˆğ´(ğºâˆ—) and they are distinct from ğ‘1,â€¦,ğ‘ğ‘˜. Let ğ‘’ğ‘—=(ğ‘¥ğ‘—,ğ‘¦ğ‘—) for ğ‘—âˆˆ{1,â€¦,ğ‘ }. Then ğ‘ƒğ‘– can be written as the concatenation of the paths ğ‘ƒğ‘–=ğ‘„1âˆ˜ğ‘¥1ğ‘¦1âˆ˜ğ‘„2âˆ˜â‹¯âˆ˜ğ‘¥ğ‘ ğ‘¦ğ‘ âˆ˜ğ‘„ğ‘ +1, where ğ‘„1 is the (ğ‘¢,ğ‘¥1)-subpath of ğ‘ƒğ‘–, ğ‘„ğ‘— is the (ğ‘¦ğ‘—âˆ’1,ğ‘¥ğ‘—)-subpath of ğ‘ƒğ‘– for ğ‘—âˆˆ{2,â€¦,ğ‘ }, and ğ‘„ğ‘ +1 is the (ğ‘¦ğ‘ ,ğ‘£)-subpath of ğ‘ƒğ‘–; note that some of the paths ğ‘„1,â€¦,ğ‘„ğ‘ +1 may be trivial, i.e., contain a single vertex. We allow trivial paths to make the notation for ğ‘ƒğ‘– uniform. Let ğ‘—âˆˆ{1,â€¦,ğ‘ +1}. If ğ‘„ğ‘— is trivial, then ğ‘„â€²ğ‘—=ğ‘„ğ‘— is a path in ğºâˆ—, because the vertices incident to the arcs of S are vertices of ğºâˆ—. Suppose that ğ‘„ğ‘— is not trivial. If ğ‘—=1, then by step (ii)(a) of Marking Procedure, there is a (ğ‘¢,ğ‘¥1)-path ğ‘„â€²1, whose arcs are in ğºâ€² and are marked, and the length of ğ‘„â€²1 is at most the length of ğ‘„1. For ğ‘—=ğ‘ +1, we have, by step (ii)(b), that there is a (ğ‘¦ğ‘ ,ğ‘£)-path ğ‘„â€²ğ‘ +1, whose arcs are in ğºâ€² and are marked, and the length of ğ‘„â€²ğ‘ +1 is at most the length of ğ‘„ğ‘ +1. Suppose that 2â‰¤ğ‘—â‰¤ğ‘ . Then by step (ii)(c), there is a (ğ‘¦ğ‘—âˆ’1,ğ‘¥ğ‘—)-path ğ‘„â€²ğ‘—, whose arcs are in ğºâ€² and are marked, and the length of ğ‘„â€²ğ‘— is at most the length of ğ‘„ğ‘—. Consider the (u, v)-walk ğ‘Šğ‘–=ğ‘„â€²1âˆ˜ğ‘¥1ğ‘¦1âˆ˜ğ‘„â€²2âˆ˜â‹¯âˆ˜ğ‘¥ğ‘ ğ‘¦ğ‘ âˆ˜ğ‘„â€²ğ‘ +1. We have that ğ‘Šğ‘– is a (u, v)-walk of length at most t in ğºâˆ— such that ğ‘ğ‘—âˆ‰ğ´(ğ‘Šğ‘–) for ğ‘—âˆˆ{1,â€¦,ğ‘˜}. This implies that ğºâˆ— has a t-detour ğ‘ƒâ€²ğ‘– in ğºâˆ— such that ğ‘ğ‘—âˆ‰ğ´(ğ‘ƒâ€²ğ‘–) for ğ‘—âˆˆ{1,â€¦,ğ‘˜}.

We obtain that for every ğ‘–âˆˆ{1,â€¦,ğ‘˜}, ğ‘ğ‘–âˆˆğ´(ğºâˆ—) has a t-detour ğ‘ƒâ€²ğ‘– such that ğ‘1,â€¦,ğ‘ğ‘˜âˆ‰ğ´(ğ‘ƒâ€²ğ‘–). By Observation 1, we conclude that ğºâˆ—âˆ’{ğ‘1,â€¦,ğ‘ğ‘˜} is a multiplicative spanner for ğºâˆ—, that is, (ğºâˆ—,ğ‘¡,ğ‘˜) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER.

For the opposite direction, assume that (ğºâˆ—,ğ‘¡,ğ‘˜) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER. By Observation 1, there are k distinct arcs ğ‘1,â€¦,ğ‘ğ‘˜âˆˆğ´(ğºâˆ—) with their t-detours ğ‘ƒ1,â€¦,ğ‘ƒğ‘˜, respectively, such that ğ‘ğ‘–âˆ‰â‹ƒğ‘˜ğ‘—=1ğ´(ğ‘ƒğ‘—). Since ğºâˆ— is a subgraph of G, ğ‘1,â€¦,ğ‘ğ‘˜ have the same t-detours in G. By Observation 1, (G, t, k) is a yes-instance. â—»

To upper bound the size of ğºâˆ—, observe that Marking Procedure marks at most t arcs for each ğ‘âˆˆğ‘† in step (i), that is, at most |S|t arcs are marked in this step. In step (ii), we mark at most 3t arcs for each ordered pair of arcs of S. Hence, at most 3|ğ‘†|(|ğ‘†|âˆ’1)ğ‘¡ arcs are marked in total in the second step. Since |ğ‘†|<12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2), we have that ğºâˆ— has îˆ»(ğ‘˜4ğ‘¡5) arcs. Because ğºâˆ— has no isolated vertices, the number of vertices is îˆ»(ğ‘˜4ğ‘¡5).

Since each of the reduction rules and Marking Procedure can be applied in polynomial time, we conclude that the total running time of our kernelization algorithm is polynomial. â—»

ğ–¥ğ–¯ğ–³ Algorithm for DIRECTED MULTIPLICATIVE SPANNER
Combining Theorem 1 with the brute-force procedure that guesses k arcs of G and verifies whether the deletion of these arcs gives a multiplicative t-spanner, we obtain the straightforward 2îˆ»(ğ‘˜log(ğ‘˜ğ‘¡))+ğ‘›îˆ»(1) algorithm for DIRECTED MULTIPLICATIVE SPANNER. If we use the intermediate steps of the kernelization algorithm, then the running time may be improved (upto some constants in the exponent) to (ğ‘˜ğ‘¡)2ğ‘˜â‹…ğ‘›îˆ»(1). Namely, we can construct the set S of t-good arcs and execute Reduction Rule 1 of the kernelization algorithm. Then we either solve the problem or obtain an instance, where the set S has size at most 12ğ‘˜(ğ‘¡+1)((ğ‘˜âˆ’1)ğ‘¡+2)âˆ’1â‰¤ğ‘˜2ğ‘¡2. Then for every ğ‘…âŠ†ğ‘† of size k, we check whether ğºâˆ’ğ‘… is a multiplicative t-spanner by computing the distances between every pair of vertices. However, we can slightly improve the parameter dependence by making use of the random separation technique proposed by Cai, Chan, and Chan in [3] (we refer to [5, Chapter 5] for the detailed introduction to the technique). In this subsection, we briefly sketch a Monte Carlo algorithm with false negatives for DIRECTED MULTIPLICATIVE SPANNER.

Theorem 2
DIRECTED MULTIPLICATIVE SPANNER can be solved in time (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1) by a Monte Carlo algorithm with false negatives.

Proof
Let (G, t, k) be an instance of DIRECTED MULTIPLICATIVE SPANNER. If ğ‘˜=0 or ğ‘¡=1, then the problem is trivial: if ğ‘˜=0, then (G, t, k) is a yes-instance, and if ğ‘˜>0 and ğ‘¡=1, then (G, t, k) is a no-instance. From now we assume that ğ‘˜â‰¥1 and ğ‘¡â‰¥2.

By Observation 1, (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER for (G, t, k) if and only if there are k arcs that have t-detours avoiding these arcs. We use random separation to distinguish the arcs that have t-detours and the arcs of the detours. We randomly color the arcs of G by two colors red and blue. An arc is colored red with probability 1ğ‘¡ and is colored blue with probability ğ‘¡âˆ’1ğ‘¡. Then we try to find k red arcs that have t-detours composed by blue arcs. Let R be the set of arcs colored red and let B the set of blue arcs. For (ğ‘¢,ğ‘£)âˆˆğ‘…, it can be checked in polynomial time whether (u, v) has a t-detour with blue arcs by finding the distance between u and v in ğºğµ=(ğ‘‰(ğº),ğµ). Then we greedily construct the set S of all red arcs with blue t-detours. If |ğ‘†|â‰¥ğ‘˜, then we conclude that (G, t, k) is a yes-instance by Observation 1.

Suppose that (G, t, k) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER. Then by Observation 1, there are k distinct arcs ğ‘1,â€¦,ğ‘ğ‘˜ and their t-detours ğ‘ƒ1,â€¦,ğ‘ƒğ‘˜, respectively, such that ğ‘1,â€¦,ğ‘ğ‘˜âˆ‰ğ¿=â‹ƒğ‘˜ğ‘–=1ğ´(ğ‘ƒğ‘–). Notice that |ğ¿|â‰¤ğ‘¡ğ‘˜. Then the probability that the considered random coloring colors the arcs ğ‘1,â€¦,ğ‘ğ‘˜ red is ğ‘¡âˆ’ğ‘˜ and the probability that the arcs of L are colored blue is at least (ğ‘¡âˆ’1ğ‘¡)ğ‘¡ğ‘˜. We have that

(ğ‘¡âˆ’1ğ‘¡)ğ‘¡=(1âˆ’1ğ‘¡)ğ‘¡â‰¥14.
Therefore, the probability that the arcs ğ‘1,â€¦,ğ‘ğ‘˜ are red and their t-detours are blue is at least (4ğ‘¡)âˆ’ğ‘˜. Respectively, the probability that the random coloring fails to color the arcs ğ‘1,â€¦,ğ‘ğ‘˜ red and their t-detours blue is at most 1âˆ’1(4ğ‘¡)ğ‘˜. This implies that if we iterate our algorithm for (4ğ‘¡)ğ‘˜ colorings, then we either find a solution and stop or we conclude that (G, t, k) is a no-instance with the mistake probability at most (1âˆ’1(4ğ‘¡)ğ‘˜)(4ğ‘¡)ğ‘˜â‰¤ğ‘’âˆ’1. This gives us a Monte Carlo algorithm with running time (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1). â—»

The same approach can be used for undirected graphs and it can be shown that MULTIPLICATIVE SPANNER can be solved by a Monte Carlo algorithm with false negatives in (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1) time. This improves the running time given in [10] at the cost of randomization.

The algorithm from Theorem 2 can be derandomized by using universal sets [15] instead of random colorings (see also  [5, Chapter 5]). However, this leads to an algorithm with worst running time that is not better than (ğ‘˜ğ‘¡)2ğ‘˜â‹…ğ‘›îˆ»(1).

Directed Multiplicative Spanners on Acyclic Graphs
In this section, we show that WEIGHTED DIRECTED MULTIPLICATIVE SPANNER is ğ–¥ğ–¯ğ–³ on DAGs when parameterized by k only. Formally, the problem is stated as follows:

figure c
MULTIPLICATIVE SPANNER is know to be ğ–­ğ–¯-complete for restricted graph families. However, we are not aware of hardness results for the directed variants of the problem on DAGs. Hence, we begin with showing that DIRECTED MULTIPLICATIVE SPANNER and WEIGHTED DIRECTED MULTIPLICATIVE SPANNER are ğ–­ğ–¯-hard on DAGs. As we are mainly interested in Parameterized Complexity, we do not try to push down the value of t for which DIRECTED MULTIPLICATIVE SPANNER becomes ğ–­ğ–¯-hard.

Theorem 3
DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-complete for every ğ‘¡â‰¥7 on DAGs. Moreover, WEIGHTED DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-hard for every ğ‘¡>1 when the input is restricted to DAGs.

Fig. 1
figure 1
Construction of D for ğ‘¡=7

Full size image
Proof
We show the theorem for DIRECTED MULTIPLICATIVE SPANNER and then explain how to modify the reduction for WEIGHTED DIRECTED MULTIPLICATIVE SPANNER. We reduce from the INDEPENDENT SET problem that is well-known to be ğ–­ğ–¯-complete [9]. Given a graph G and a positive integer k, the problem asks whether G has an independent set of size at least k.

Let (G, k) be an instance of INDEPENDENT SET and let ğ‘¡â‰¥7 be an integer. Denote by ğ‘£1,â€¦,ğ‘£ğ‘› the vertices of G and denote ğ‘š=|ğ¸(ğº)|.

For every ğ‘–âˆˆ{1,â€¦,ğ‘›}, construct two vertices ğ‘¥ğ‘–,ğ‘¦ğ‘–, an arc (ğ‘¥ğ‘–,ğ‘¦ğ‘–), and then construct a directed (ğ‘¥ğ‘–,ğ‘¦ğ‘–)-path ğ‘…ğ‘– of length ğ‘¡âˆ’5.

For every {ğ‘£ğ‘–,ğ‘£ğ‘—}âˆˆğ¸(ğº) such that ğ‘–<ğ‘—, do the following:

construct a vertex ğ‘§ğ‘–ğ‘— and arcs (ğ‘¦ğ‘–,ğ‘§ğ‘–ğ‘—) and (ğ‘§ğ‘–ğ‘—,ğ‘¥ğ‘—),

construct ğ‘›+1 vertices ğ‘¢(0)ğ‘–ğ‘—,â€¦,ğ‘¢(ğ‘›)ğ‘–ğ‘— and ğ‘›+1 vertices ğ‘¤(0)ğ‘–ğ‘—,â€¦,ğ‘¤(ğ‘›)ğ‘–ğ‘—,

for every â„âˆˆ{1,â€¦,ğ‘›}, construct arcs (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—), (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¥ğ‘–), and (ğ‘¦ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—), and set ğ´ğ‘–ğ‘—={(ğ‘¢(0)ğ‘–ğ‘—,ğ‘¤(0)ğ‘–ğ‘—),â€¦,(ğ‘¢(ğ‘›)ğ‘–ğ‘—,ğ‘¤(ğ‘›)ğ‘–ğ‘—)}.

Denote the obtained directed graph by D (see Figure 1). Clearly, D is a DAG. To complete the reduction, we set ğ‘˜â€²=ğ‘š(ğ‘›+1)+ğ‘˜. Let also ğ´=â‹ƒ(ğ‘£ğ‘–,ğ‘£ğ‘—)âˆˆğ¸(ğº), ğ‘–<ğ‘—ğ´ğ‘–ğ‘—.

We claim that (G, k) is a yes-instance of INDEPENDENT SET if and only if (ğ·,ğ‘¡,ğ‘˜â€²) is a yes-instance of DIRECTED MULTIPLICATIVE SPANNER.

For the forward direction, assume that ğ‘‹={ğ‘£ğ‘–1,â€¦,ğ‘£ğ‘–ğ‘˜} is an independent set of G. Consider

ğ‘†={(ğ‘¥ğ‘–ğ‘—,ğ‘¦ğ‘–ğ‘—)âˆ£1â‰¤ğ‘—â‰¤ğ‘˜}âˆªğ´.
Observe that |ğ‘†|=ğ‘˜+|ğ´|=ğ‘˜+ğ‘š(ğ‘›+1)=ğ‘˜â€². We show that ğ»=ğ·âˆ’ğ‘† is a multiplicative t-spanner. For this, observe that every arc of S has a t-detour with its arcs in H. For every ğ‘—âˆˆ{1,â€¦,ğ‘˜}, the path ğ‘…ğ‘–ğ‘— is a t-detour for (ğ‘¥ğ‘–ğ‘—,ğ‘¦ğ‘–ğ‘—). Consider an arbitrary arc ğ‘âˆˆğ´. Then ğ‘=(ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—) for some indices ğ‘–<ğ‘— such that {ğ‘£ğ‘–,ğ‘£ğ‘—}âˆˆğ¸(ğº) and some â„âˆˆ{0,â€¦,ğ‘›}. Because X is an independent set, either ğ‘£ğ‘–âˆ‰ğ‘‹ or ğ‘£ğ‘—âˆ‰ğ‘‹. In the first case, ğ‘¢(â„)ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¦ğ‘–ğ‘§ğ‘–ğ‘—ğ‘¥ğ‘—âˆ˜ğ‘…ğ‘—âˆ˜ğ‘¦ğ‘—ğ‘¤(â„)ğ‘–ğ‘— has length t and, therefore, is a t-detour for a. Symmetrically, ğ‘¢(â„)ğ‘–ğ‘—ğ‘¥ğ‘–âˆ˜ğ‘…ğ‘–âˆ˜ğ‘¦ğ‘–ğ‘§ğ‘–ğ‘—ğ‘¥ğ‘—ğ‘¦ğ‘—ğ‘¤(â„)ğ‘–ğ‘— is a t-detour if ğ‘£ğ‘—âˆ‰ğ‘‹. We conclude that every arc of S has a t-detour in H. Hence, H is a multiplicative t-spanner by Observation 1.

For the opposite direction, assume that H is a multiplicative t-spanner of D with at most |ğ´(ğ·)|âˆ’ğ‘˜â€² arcs. Let ğ‘†=ğ´(ğ·)âˆ–ğ´(ğ»). Recall that every arc of S should have a t-detour in D by Observation 1. Then our construction implies that ğ‘†âŠ†{(ğ‘¥ğ‘–,ğ‘¦ğ‘–)âˆ£1â‰¤ğ‘–â‰¤ğ‘›}âˆªğ´, because only these arcs have detours. Let ğ‘†â€²=ğ‘†âˆ–ğ´. Because |ğ‘†|â‰¥ğ‘˜â€², |ğ‘†â€²|â‰¥ğ‘˜. Let ğ‘†â€²={(ğ‘¥ğ‘–1,ğ‘¦ğ‘–1),â€¦,(ğ‘¥ğ‘–ğ‘ ,ğ‘¦ğ‘–ğ‘ )} for some ğ‘ â‰¥ğ‘˜. We show that ğ‘‹={ğ‘£ğ‘–1,â€¦,ğ‘£ğ‘–ğ‘ } is an independent set of G. For the sake of contradiction, assume that ğ‘£ğ‘– and ğ‘£ğ‘— are adjacent in G for some ğ‘£ğ‘–,ğ‘£ğ‘—âˆˆğ‘‹. Consider an arc (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—)âˆˆğ´ğ‘–ğ‘— for arbitrary â„âˆˆ{0,â€¦,ğ‘›}. Notice that every (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—)-path P in D avoiding (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—) contains the arcs (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¥ğ‘–) and (ğ‘¦ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—), the paths ğ‘…ğ‘– and ğ‘…ğ‘—, and some (ğ‘¦ğ‘–,ğ‘¥ğ‘—)-path Q. Clearly, the length of Q is at least 2. Then the length of P is at least 2+2(ğ‘¡âˆ’5)+2=ğ‘¡+(ğ‘¡âˆ’6)>ğ‘¡, because ğ‘¡â‰¥7. This implies that (ğ‘¢(â„)ğ‘–ğ‘—,ğ‘¤(â„)ğ‘–ğ‘—)âˆ‰ğ‘†. Then ğ´ğ‘–ğ‘—âˆ©ğ‘†=âˆ… and |ğ´âˆ©ğ‘†|â‰¤(ğ‘šâˆ’1)(ğ‘›+1). Since ğ‘ â‰¤ğ‘›, we obtain that |ğ‘†|=|ğ‘†âˆ©ğ´|+|ğ‘†â€²|â‰¤(ğ‘šâˆ’1)(ğ‘›+1)+ğ‘›<ğ‘š(ğ‘›+1)â‰¤ğ‘˜â€²; a contradiction. This proves that X is an independent set of G and concludes the proof of the theorem for DIRECTED MULTIPLICATIVE SPANNER.

For the second claim, we modify the above reduction. Let (G, k) be an instance of INDEPENDENT SET and let ğ‘¡â€²>1. We construct the instance (ğ·,ğœ”,ğ‘¡â€²,ğ‘˜â€²) of WEIGHTED DIRECTED MULTIPLICATIVE SPANNER as follows. First, we construct D for ğ‘¡=7 and define ğ‘˜â€² exactly in the same way as above. Then we define the weight function ğœ”(â‹…):

ğœ”(ğ‘)=â§â©â¨âªâª1+5/ğ‘¡â€²,ğ‘¡â€²/2,1, if ğ‘âˆˆğ´, if ğ‘âˆˆğ´(ğ‘…ğ‘–) for some ğ‘–âˆˆ{1,â€¦,ğ‘›}, otherwise .
Then by the essentially the same arguments as above, one can show that (G, k) is a yes-instance of INDEPENDENT SET if and only if (ğ·,ğœ”,ğ‘¡â€²,ğ‘˜â€²) is a yes-instance of WEIGHTED DIRECTED MULTIPLICATIVE SPANNER. â—»

Now we show the main claim of the subsection that WEIGHTED DIRECTED MULTIPLICATIVE SPANNER is ğ–¥ğ–¯ğ–³ on DAGs when parameterized by k only.

Theorem 4
WEIGHTED DIRECTED MULTIPLICATIVE SPANNER can be solved in ğ‘˜2ğ‘˜â‹…ğ‘›îˆ»(1) time on DAGs.

Proof
Let (ğº,ğœ”,ğ‘¡,ğ‘˜) be an instance of WEIGHTED DIRECTED MULTIPLICATIVE SPANNER. Consider the set S of arcs of G having t-detours. For every ğ‘âˆˆğ‘†, denote by ğ‘ƒğ‘ an arbitrary t-detour for a.

Let ğ‘1,ğ‘2âˆˆğ‘† be distinct arcs, and let ğ‘1=(ğ‘¢1,ğ‘£1) and ğ‘2=(ğ‘¢2,ğ‘£2). Assume that G has a path P such that ğ‘1,ğ‘2âˆˆğ´(ğ‘ƒ). We claim that ğ‘2âˆ‰ğ´(ğ‘ƒğ‘1) and ğ‘1âˆ‰ğ´(ğ‘ƒğ‘2). To show this, assume that ğ‘1 occurs in P before ğ‘2. Then ğ‘¢1â‰ºğ‘£1âª¯ğ‘¢2â‰ºğ‘£2 with respect to an arbitrary topological ordering of the vertices of D. Suppose that ğ‘2âˆˆğ´(ğ‘ƒğ‘1). Then ğ‘ƒğ‘1 has the (ğ‘£2,ğ‘£1)-subpath Q. However, this contradict that ğ‘£1â‰ºğ‘£2. Symmetrically, if ğ‘1âˆˆğ´(ğ‘ƒğ‘2), then ğ‘ƒğ‘2 has the (ğ‘¢2,ğ‘¢1)-subpath contradicting that ğ‘¢1â‰ºğ‘¢2. This proves the claim.

Using the above claim, we now show that if |ğ‘†|>ğ‘˜(ğ‘˜âˆ’1), then (ğº,ğœ”,ğ‘¡,ğ‘˜) is a yes-instance. If there exists an arc ğ‘âˆˆğ‘† such that the set ğ‘†â€²=ğ´(ğ‘ƒğ‘)âˆ©ğ‘† contains at least k arcs, then ğºâˆ’ğ‘†â€² is a multiplicative t-spanner by Observation 1. Indeed, because the arcs of ğ‘†â€² are on the same path ğ‘ƒğ‘, the detours ğ‘ƒğ‘’ for ğ‘’âˆˆğ‘†â€² do not contain any arc of ğ‘†â€² from the previous claim. In the other case, |ğ´(ğ‘ƒğ‘)âˆ©ğ‘†|â‰¤ğ‘˜âˆ’1 for every ğ‘âˆˆğ‘†. Clearly, |(ğ´(ğ‘ƒğ‘)âˆª{ğ‘})âˆ©ğ‘†|â‰¤ğ‘˜ for every ğ‘âˆˆğ‘†. Then because |ğ‘†|>ğ‘˜(ğ‘˜âˆ’1), we can greedily select k distinct arcs ğ‘1,â€¦,ğ‘ğ‘˜âˆˆğ‘† such that the sets (ğ´(ğ‘ƒğ‘ğ‘–)âˆª{ğ‘ğ‘–})âˆ©ğ‘† for ğ‘–âˆˆ{1,â€¦,ğ‘˜} are disjoint. We choose ğ‘1âˆˆğ‘† arbitrarily. Let 2â‰¤ğ‘–â‰¤ğ‘˜ and assume that ğ‘1,â€¦,ğ‘ğ‘–âˆ’1 are selected. Because |ğ‘†|>ğ‘˜(ğ‘˜âˆ’1) and |(ğ´(ğ‘ƒğ‘ğ‘—)âˆª{ğ‘ğ‘—})âˆ©ğ‘†|â‰¤ğ‘˜ for every ğ‘—âˆˆ{1,â€¦,ğ‘–âˆ’1}, we have that |ğ‘†âˆ–â‹ƒğ‘–âˆ’1ğ‘—=1(ğ´(ğ‘ƒğ‘ğ‘—)âˆª{ğ‘ğ‘—})|>ğ‘˜(ğ‘˜âˆ’1)âˆ’ğ‘˜(ğ‘–âˆ’1)â‰¥0. Then we arbitrary choose ğ‘ğ‘–âˆˆğ‘†âˆ–â‹ƒğ‘–âˆ’1ğ‘—=1(ğ´(ğ‘ƒğ‘ğ‘—)âˆª{ğ‘ğ‘—}). This way we construct ğ‘1,â€¦,ğ‘ğ‘˜. Then we conclude that ğºâˆ’{ğ‘1,â€¦,ğ‘ğ‘˜} is a multiplicative t-spanner from Observation 1.

This leads to the following algorithm for WEIGHTED DIRECTED MULTIPLICATIVE SPANNER. First, we construct S. Clearly, it can be done in polynomial time by Dijkstraâ€™s algorithm. If |ğ‘†|>ğ‘˜(ğ‘˜âˆ’1), then we return the answer yes. Otherwise, we consider all subsets ğ‘…âŠ†ğ‘† of size k, and for each R, we check whether ğºâˆ’ğ‘… is a multiplicative t-spanner. This can be done by making use of Observation 1 and the Dijkstraâ€™s algorithm. The algorithm returns yes if ğºâˆ’ğ‘… is a multiplicative t-spanner. We return no if we fail to find a spanner this way. Since there are at most (ğ‘˜(ğ‘˜âˆ’1)ğ‘˜) sets R, the algorithm runs in ğ‘˜2ğ‘˜â‹…ğ‘›îˆ»(1) time. This concludes the proof. â—»

Note that unlike DIRECTED MULTIPLICATIVE SPANNER, the arguments of Theorem 4 do not yield a kernel because even though the weight of t-detours of the arcs of S is bounded, their lengths could be very long because the weights are real numbers.

Directed Additive t-spanners
In this section, we consider DIRECTED ADDITIVE SPANNER and show that the problem is hard on DAGs for every ğ‘¡â‰¥1.

Theorem 5
DIRECTED ADDITIVE SPANNER is ğ–¶[1]-hard on DAGs when parameterized by k for every ğ‘¡â‰¥1.

Fig. 2
figure 2
Construction of D for ğ‘¡=1

Full size image
Proof
We reduce from the INDEPENDENT SET problem. Recall that, given a graph G and a positive integer k, the problem asks whether G has an independent set of size at least k. INDEPENDENT SET parameterized k is well-known to be one of the basic ğ–¶[1]-complete problems (see [5, 6]).

Let (G, k) be an instance of INDEPENDENT SET and let t be a positive integer. Denote by ğ‘£1,â€¦,ğ‘£ğ‘› the vertices of G.

For every ğ‘–âˆˆ{1,â€¦,ğ‘›}, construct two vertices ğ‘¥ğ‘–,ğ‘¦ğ‘–, an arc (ğ‘¥ğ‘–,ğ‘¦ğ‘–), and then construct a directed (ğ‘¥ğ‘–,ğ‘¦ğ‘–)-path ğ‘…ğ‘– of length ğ‘¡+1.

For every ğ‘–,ğ‘—âˆˆ{1,â€¦,ğ‘›} such that ğ‘–<ğ‘—, do the following:

if {ğ‘£ğ‘–,ğ‘£ğ‘—}âˆˆğ¸(ğº), then construct a directed (ğ‘¦ğ‘–,ğ‘¥ğ‘—)-path ğ‘ƒğ‘–ğ‘— of length ğ‘¡+3,

if {ğ‘£ğ‘–,ğ‘£ğ‘—}âˆ‰ğ¸(ğº), then construct a directed (ğ‘¥ğ‘–,ğ‘¦ğ‘—)-path ğ‘„ğ‘–ğ‘— of length ğ‘¡+3.

Denote the obtained directed graph by D (see Figure 2). It is straightforward to verify that D is a DAG. We show that (G, k) is a yes-instance of INDEPENDENT SET if and only if (D, t, k) is a yes-instance of DIRECTED ADDITIVE SPANNER.

Suppose that ğ¼={ğ‘£ğ‘–1,â€¦,ğ‘£ğ‘–ğ‘˜} is an independent set of size k in G. Let ğ‘†={(ğ‘¥ğ‘–1,ğ‘¦ğ‘–1),â€¦,(ğ‘¥ğ‘–ğ‘˜,ğ‘¦ğ‘–ğ‘˜)}. We show that ğ·â€²=ğ·âˆ’ğ‘† is an additive t-spanner for D.

We first claim that for every two vertices u and w of D, each shortest (u, w)-path in D contains at most one arc of S. The proof is by contradiction. Assume that there are ğ‘¢,ğ‘¤âˆˆğ‘‰(ğ·) and a shortest (u, w)-path P such that P contains at least two arcs of S. Let (ğ‘¥ğ‘–,ğ‘¦ğ‘–) and (ğ‘¥ğ‘—,ğ‘¦ğ‘—) be such arcs and let ğ‘–<ğ‘—. By the construction, (ğ‘¥ğ‘–,ğ‘¦ğ‘–) occurs before (ğ‘¥ğ‘—,ğ‘¦ğ‘—) in P. Since the arcs of S correspond to vertices of the independent set I, ğ‘£ğ‘– and ğ‘£ğ‘— are not adjacent in G. Therefore, D contains the (ğ‘¥ğ‘–,ğ‘¦ğ‘—)-path ğ‘„ğ‘–ğ‘— of length ğ‘¡+3. Since P is a shortest path containing (ğ‘¥ğ‘–,ğ‘¦ğ‘–) and (ğ‘¥ğ‘—,ğ‘¦ğ‘—), the (ğ‘¦ğ‘–,ğ‘¥ğ‘—)-subpath of P should have length at most ğ‘¡+1. However, by the construction, the distance between ğ‘¦ğ‘– and ğ‘¥ğ‘— is at least ğ‘¡+3; a contradiction proving the claim.

Now let u and w be two vertices of D. Let P be a shortest (u, w)-path in D. If P is a path in ğ·â€², then distğ·â€²(ğ‘¢,ğ‘¤)=distğ·(ğ‘¢,ğ‘¤). Suppose that P is not a path in ğ·â€². Then P contains a unique arc (ğ‘¥ğ‘–,ğ‘¦ğ‘–)âˆˆğ‘† by the proved claim. Let ğ‘ƒ1 be the (ğ‘¢,ğ‘¥ğ‘–)-subpath of P and let ğ‘ƒ2 be the (ğ‘¦ğ‘–,ğ‘¤)-subpath. Let ğ‘ƒâ€²=ğ‘ƒ1âˆ˜ğ‘…ğ‘–âˆ˜ğ‘ƒ2. Observe that ğ‘ƒâ€² is a path in ğ·â€². Since the length of ğ‘ƒâ€² is the length of P plus the length of ğ‘…ğ‘–, that is, ğ‘¡+1, distğ·â€²(ğ‘¢,ğ‘¤)â‰¤distğ·(ğ‘¢,ğ‘¤)+ğ‘¡. This implies that ğ·â€² is an additive t-spanner of D.

Now we assume that (D, t, k) is a yes-instance of DIRECTED ADDITIVE SPANNER. Then there is a set of k arcs ğ‘†âŠ†ğ´(ğ·) such that ğ·â€²=ğ·âˆ’ğ‘† is an additive t-spanner. Observe that if (ğ‘¢,ğ‘£)âˆˆğ‘†, then D has an (u, v)-path P that does not use the arc (u, v). Otherwise, distğ·â€²(ğ‘¢,ğ‘£)=+âˆ and distğ·â€²(ğ‘¢,ğ‘£)>distğ·(ğ‘¢,ğ‘£)+ğ‘¡. Therefore, ğ‘†âŠ†{(ğ‘¥1,ğ‘¦1),â€¦,(ğ‘¥ğ‘›,ğ‘¦ğ‘›)}. Let ğ‘†={(ğ‘¥ğ‘–1,ğ‘¦ğ‘–1),â€¦,(ğ‘¥ğ‘–ğ‘˜,ğ‘¦ğ‘–ğ‘˜)}. We claim that ğ¼={ğ‘£ğ‘–1,â€¦,ğ‘£ğ‘–ğ‘˜} is an independent set of G. Assume, for the sake of contradiction, that this is not the case and there are ğ‘£ğ‘–,ğ‘£ğ‘—âˆˆğ¼ such that ğ‘£ğ‘– and ğ‘£ğ‘— are adjacent in G. Let ğ‘–<ğ‘—. Consider the vertices ğ‘¥ğ‘– and ğ‘¦ğ‘— of D. Since {ğ‘£ğ‘–,ğ‘£ğ‘—}âˆˆğ¸(ğº), ğ‘ƒ=ğ‘¥ğ‘–ğ‘¦ğ‘–âˆ˜ğ‘ƒğ‘–ğ‘—âˆ˜ğ‘¥ğ‘—ğ‘¦ğ‘— is an (ğ‘¥ğ‘–,ğ‘¦ğ‘—)-path of length ğ‘¡+5, that is, distğ·(ğ‘¥ğ‘–,ğ‘¦ğ‘—)â‰¤ğ‘¡+5. The path ğ‘ƒâ€²=ğ‘…ğ‘–âˆ˜ğ‘ƒğ‘–ğ‘—âˆ˜ğ‘…ğ‘— has length 3ğ‘¡+5 and is a path in ğ·â€². Any other (ğ‘¥ğ‘–,ğ‘¦ğ‘—)-path in ğ·â€² uses at least two paths of length ğ‘¡+3: one of the paths ğ‘ƒğ‘–ğ‘–â€² and ğ‘„ğ‘–ğ‘–â€² for some ğ‘–â€²âˆˆ{1,â€¦,ğ‘›} such that ğ‘–â€²â‰ ğ‘—, and one of the paths ğ‘ƒğ‘—â€²ğ‘— and ğ‘„ğ‘—â€²ğ‘— for some ğ‘—â€²âˆˆ{1,â€¦,ğ‘›} such that ğ‘—â€²â‰ ğ‘–. This means that distğ·â€²(ğ‘¥ğ‘–,ğ‘¦ğ‘—)â‰¥2(ğ‘¡+3)>(ğ‘¡+5)+ğ‘¡â‰¥distğ·(ğ‘¥ğ‘–,ğ‘¦ğ‘—)+ğ‘¡ contradicting that ğ·â€² is an additive t-spanner. We conclude that I is an independent set of G and, therefore, (G, k) is a yes-instance of INDEPENDENT SET. â—»

Conclusion
We proved that DIRECTED MULTIPLICATIVE SPANNER admits a kernel of size îˆ»(ğ‘˜4ğ‘¡5) and can be solved in (4ğ‘¡)ğ‘˜â‹…ğ‘›îˆ»(1) randomized time. We also demonstrated that (WEIGHTED) DIRECTED MULTIPLICATIVE SPANNER is ğ–­ğ–¯-complete on DAGs and can be solved in ğ‘˜2ğ‘˜â‹…ğ‘›îˆ»(1) on this class of directed graphs. This leads to the question whether MULTIPLICATIVE SPANNER is FPT on general graphs when parameterized by k only for both undirected and directed cases. Also, is the weighted version of MULTIPLICATIVE SPANNER ğ–¥ğ–¯ğ–³ when parameterized by k and t on general graphs? Again, this question is open for both undirected and directed graphs.

Further we proved that DIRECTED ADDITIVE SPANNER is ğ–¶[1]-hard for every fixed ğ‘¡â‰¥1 even if the input graphs are restricted to DAGs. This result leads to the question whether DIRECTED ADDITIVE SPANNER is tractable on some special classes of directed graphs, like planar directed graphs. We believe that this problem may be interesting even if the distortion parameter t is assumed to be a constant.

Another possible direction of research is considering different types of directed graph spanners. For example, what can be said about the roundtrips spanners introduced by Roditty, Thorup, and Zwick [18]? A spanning subgraph H of a directed graph G is a multiplicative t-roundtrip-spanner if for every two vertices u and v, distğ»(ğ‘¢,ğ‘£)+distğ»(ğ‘£,ğ‘¢)â‰¤ğ‘¡(distğº(ğ‘¢,ğ‘£)+distğº(ğ‘£,ğ‘¢)), that is, H approximates the sum of the distances between any two vertices in both directions. Is the analog of DIRECTED MULTIPLICATIVE SPANNER for roundtrip spanners ğ–¥ğ–¯ğ–³? Notice that we cannot use Observation 1 that is crucial for our results for the new problem. Consider, for example, the directed graph G constructed as follows: construct two vertices u and v and an arc (u, v), and then add a (u, v)-path ğ‘ƒ1 and a (v, u)-path ğ‘ƒ2 of arbitrary length â„“â‰¥2 that are internally vertex disjoint. Then it is easy to see that ğ»=ğºâˆ’(ğ‘¢,ğ‘£) is a 2-roundtrip spanner for G. However, H has no short detour for (u, v). It is also possible to define additive t-roundtrip-spanners and consider the analog of DIRECTED ADDITIVE SPANNER. We conjecture that this problem is at least as hard as DIRECTED ADDITIVE SPANNER.