The past few years have witnessed the great potential of exploiting channel state information retrieved from commodity WiFi
devices for respiration monitoring. However, existing approaches only work when the target is close to the WiFi transceivers
and the performance degrades significantly when the target is far away. On the other hand, most home environments only
have one WiFi access point and it may not be located in the same room as the target. This sensing range constraint greatly
limits the application of the proposed approaches in real life.
This paper presents FarSense–the first real-time system that can reliably monitor human respiration when the target is
far away from the WiFi transceiver pair. FarSense works well even when one of the transceivers is located in another room,
moving a big step towards real-life deployment. We propose two novel schemes to achieve this goal: (1) Instead of applying
the raw CSI readings of individual antenna for sensing, we employ the ratio of CSI readings from two antennas, whose
noise is mostly canceled out by the division operation to significantly increase the sensing range; (2) The division operation
further enables us to utilize the phase information which is not usable with one single antenna for sensing. The orthogonal
amplitude and phase are elaborately combined to address the ”blind spots” issue and further increase the sensing range.
Extensive experiments show that FarSense is able to accurately monitor human respiration even when the target is 8 meters
away from the transceiver pair, increasing the sensing range by more than 100%.1 We believe this is the first system to enable
through-wall respiration sensing with commodity WiFi devices and the proposed method could also benefit other sensing
applications.
CCS Concepts: • Human-centered computing → Ubiquitous and mobile computing systems and tools;
Fig. 1. In an indoor environment, WiFi signals propagate through multiple paths before
arriving at the receiver, thus carrying information about the environment.
Additional Key Words and Phrases: Respiration sensing, WiFi, Channel state information (CSI), CSI-ratio model
1 INTRODUCTION
Wireless technologies have achieved a great success in data communication in the last two decades. Wi-Fi and
cellular networks enable us to be seamlessly connected to the Internet, changing our lives in every aspect. In
the indoor environment, Wi-Fi is the preferred choice due to its high rate and low cost. According to [32], there
are approximately five billion devices communicating over WiFi networks worldwide in 2016 and this number
is expected to increase to thirty billion by 2020. In the last few years, Wi-Fi signals are creatively exploited
for contactless human activity sensing. As shown in Fig. 1, in an indoor environment, WiFi signals propagate
through direct path and also reflection paths, bouncing off the objects in the environment before arriving at the
receiver. With careful signal processing on the reflected signal, we can actually obtain a lot of useful information
about the objects such as the direction of the signal which can be utilized for localization. When the object is a
human target, we can employ the signal variations to infer the target’s gestures and activities, enabling human
sensing without a device attached to the human body.
In the last few years, we have seen a lot of emerging WiFi-based human sensing applications, ranging from
coarse-grained activity recognition [3, 23, 34, 37, 44, 48–50, 60, 64], indoor localization/tracking [9, 26, 40, 55],
intrusion/motion detection [24, 27, 53, 59] to fine-gained respiration monitoring [11, 29–31, 36, 47, 51, 52, 54,
62, 63, 65]. As one of the most important applications, respiration monitoring attracts lots of attention since
respiration is an important health metric used for tracking diseases in many areas, such as sleep, pulmonology
and cardiology. The features extracted from human respiration also provide useful insights about the psychological state of an individual [18, 21]. Among these features, respiration rate is particularly important [8] and
needs to be carefully observed. For example, an abnormal respiration rate, either too high (tachypnea), too low
(bradypnea), or absent (apnea), is a sensitive indicator of physiological distress that requires immediate clinical
intervention [47].
Traditional approaches employ wearables or cameras for respiration monitoring. However, the elderly are
usually reluctant to wear wearables and the camera-based approaches raise severe privacy concerns. The latest
research in this area explore the possibility of applying pervasive WiFi signals for respiration monitoring without
attaching a device on the target. Multiple efforts have been made for accurate respiration monitoring leveraging
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:3
either CSI amplitude of a single antenna or phase difference between two antennas available at commodity WiFi
hardware [29, 30, 47, 51–53, 66]. However, the problem with the existing work is that the sensing range is still
very limited, and the sensing devices are required to be placed close to the target. While the communication
range of WiFi can be tens of meters, the sensing range is limited to 2-4 meters. The main reason is that wireless
sensing relies on weak reflected signal and the subtle respiration-induced signal variation can be easily buried in
noise. Furthermore, the existing works face the “blind-spot” issue that respiration cannot be effectively detected
at certain locations even when the target is close to the sensing devices. The short sensing range and “blind-spot”
constraints greatly limit the real-life application of the existing approaches.
In this paper, for the first time, we present novel solutions to push the respiration sensing range from the
current 2-4 meters to house level (8-9 meters) with commodity WiFi devices, bridging the gap between lab prototype and real-life deployment. The key idea is that we employ the widely available two antennas at commodity
WiFi AP for performance boosting. With just two antennas, we construct a new metric – the ratio of CSI readings of two antennas. With this division operation between two antennas, most of the noise in the original
CSI amplitude and the time-varying phase offset are canceled out. The CSI ratio of two antennas obtained is
much more noise-free and sensitive compared to the original CSI reading from a single antenna when sensing
subtle movements. Another big advantage of this ”CSI ratio” is that phase information can now be utilized together with the amplitude for sensing. Note that previously people usually only employ the CSI amplitude for
sensing because the CSI phase is not stable due to the lack of tight time synchronization between transmitter
and receiver. The phase of the ratio is stable as the time-varying random offsets are the same at both antennas
and are thus canceled by the division operation. We further combine the phase and amplitude of the CSI ratio
which are complementary to each other in terms of sensing capability to remove the ”blind spots” reported in
[47]. With the two proposed techniques, we significantly extend the sensing range to 8 meters with commodity
WiFi device while still keep the 100% detection rate, outperforming the state-of-the-art WiFi-based approaches.
What’s more, in this work, we propose the CSI-ratio model that establishes the relationship between the target
movement and CSI ratio changes which lays the foundation to guide wireless sensing with CSI ratio. We believe
this general CSI-ratio model will benefit not just respiration sensing but a lot of other CSI-based sensing applications as well. We also believe this general signal ratio method can be applied to other wireless technologies
such as RFID (Radio Frequency IDentification), LTE (Long Term Evolution) [38] and LoRa (Long Range) [28]
to increase the sensing range and performance. To validate the effectiveness and robustness of the proposed
system FarSense, we conduct comprehensive experiments with different subjects in different environments by
varying the settings below:
• the subject is located at different distances to the transceivers;
• the challenging scenario when the WiFi transmitter is placed in a different room from the receiver with a
wall in between, and the subject is located either in the transmitter side or in the receiver side;
• another challenging scenario when both transceivers are mounted on the ceiling, far away from the subject.
The demo video of FarSense that works in all three scenarios above is also submitted as an accompanying material
to show the effectiveness and robustness of the proposed techniques in real-world settings.
The main contributions of the work can be summarized as follows:
(1) We propose to employ CSI ratio rather than raw CSI for sensing. We develop the CSI-ratio model that
establishes the relationship between human’s movement and CSI ratio changes which lays the foundation
to guide fine-grained sensing. We believe the general CSI-ratio model will benefit not just respiration
sensing but a lot of other sensing applications.
(2) We apply the CSI-ratio model for respiration sensing and elaborately combine the amplitude and phase of
CSI ratio to address the ”blind spots” issue and further increase the sensing range.
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:4 • Zeng et al.
(3) We design and implement FarSense on commodity WiFi devices. The sensing range is increased from the
current state-of-the-art 2-4 meters to 8-9 meters. For the first time, FarSense is able to enable through-wall
respiration sensing with commodity WiFi hardware, moving one step further towards real-life deployment.
The rest of this paper is organized as follows. Sec. 2 surveys the related work. Sec. 3 employs benchmark
experiments to demonstrate the ratio of CSI between two antennas has higher sensitivity than CSI of one antenna
for fine-grained sensing. Sec. 4 presents the CSI-ratio model and its verification. Sec. 5 shows how to effectively
extract respiration pattern from the CSI ratio. Sec. 6 presents the detailed design and implementation of the
prototype system FarSense. Sec. 7 presents the experimental setup and evaluation results. Sec. 8 discusses the
limitations and opportunities followed by a conclusion in Sec. 9.
2 RELATED WORK
In this section, we discuss the most related work in respiration sensing with RF signals which can be broadly
grouped into two following categories.
Radar-based respiration sensing. These approaches can be mainly divided into three categories according
to the technologies they are using.
(1) Continuous-wave (CW) Doppler radar. CW Doppler radar technique is based on detecting the reflected
frequency echoes to the chest wall motion during respiration [6, 7]. It has the advantages of low power consumption and simple radio architecture. However, it suffers from the clutter noise and multipath reflection
so that vital sign signals may not be differentiable from other received frequency echoes.
(2) Ultra-wideband (UWB) pulse radar. The basic operation of UWB pulse radar is to send a train of pulses
towards the target and then the received signal can be visualized in the frequency domain [12, 20]. To
get an accurate estimation of vital signs, the delay profile in time domain is extracted using IFFT. With
a bandwidth of 1-2 GHz, the UWB pulse radar can eliminate interference caused by reflection from other
objects and multipath reflection [22]. However, such a wide bandwidth requires precise control on the
pulse width and the radar peak signal intensity [19], thus increasing the hardware requirements and system
complexity.
(3) Frequency-modulated continuous-wave (FMCW) radar. FMCW radar radiates continuous transmission
power like a CW radar but linearly increases operating frequency of the transmitted signal during the
measurement within a wide bandwidth (for example, 1.79 GHz in [2]). By comparing the frequency of the
received signal bounced off human body to the transmission signal, FMCW radar can directly measure
the distance of the reflection body from the device. Vital-Radio [2] separates signals from different users
based on their reflection time and analyze the signals from each user to measure his/her respiration rate
and heart rate using FFT. EQ-Radio [67] proposes a new algorithm to extract individual heartbeats from the
wireless signal and recognizes a person’s emotional state based on his/her respiration signal and heartbeat
segmentation. All these works are based on FMCW signal, not WiFi (CSI). FMCW hardware employs a
much wider bandwidth (1.79 GHz in [2]) which is not available with cheap commodity WiFi hardware
(the bandwidth of WiFi is 20/40 MHz). Further, the costs of FMCW hardware are usually much higher
which make these solutions less practical for everyday home usage. In this work, we would like to employ
the commodity WiFi hardware already pervasively deployed in our home environment for respiration
sensing.
WiFi-based respiration sensing. These WiFi-based approaches can be divided into two categories based on
which part of the information from the complex-valued CSI they are using.
(1) Respiration sensing with amplitude information. Most existing approaches employ CSI amplitude information for respiration sensing. CSI amplitude is also widely used in other WiFi-based human sensing
applications, even though it contains relatively large noise caused by power amplifier uncertainty (PAU)
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:5
and environmental noise [50, 60, 69]. CSI amplitude has explicit mathematical and physical relationship
with the target’s movements, as demonstrated in [50]. Wi-Sleep [30] is the first sleep monitoring system
that extracts rhythmical patterns caused by respiration from WiFi signals. The performance is further improved in [31] by considering the sleep postures and abnormal respiration patterns. Liu et al. [29] have
shown to track human heart rate by analyzing power spectral density (PSD) of CSI amplitude during sleep.
Wu et al. [53] have demonstrated that respiration information can be obtained no matter the target is lying
or standing. These works leverage the amplitude information of CSI and the ”blind spots” issue still exists.
A recent work [47] introduces the Fresnel zone theory to explain why the blind spots occur.
(2) Respiration sensing with phase information. The phase information of the CSI readings retrieved from
commodity WiFi devices is especially noisy due to the presence of sampling frequency offset (SFO), carrier
frequency offset (CFO) and packet detection delay (PDD) [17, 46, 56, 60], which make it not directly usable
for sensing. Multiple approaches [17, 60, 68] have been proposed to calibrate out the CSI phase offset,
including SFO and CFO calibration. However, as shown in [62], these proposed approaches still fail to
monitor fine-grained millimeter-level chest motion caused by respiration.
Thus, researchers employ the phase difference between two antennas instead to cancel out the timevarying phase offset since they are the same across two antennas on a same WiFi card [17, 26, 41]. In [51,
52], researchers demonstrated that phase difference can be utilized for respiration monitoring. However,
the phase difference between two antennas can be constructive or destructive depending on their in-phase
or out-phase relationship. When they are in phase, ”blind spots” occur and the sensing performance is poor.
The latest work [62] demonstrated the complementary property between phase and amplitude for sensing
and employ both amplitude and phase to remove the amount of ”blind spots”. However, it still fails to
address the fundamental ”small range” issue for WiFi-based respiration sensing.
Differently, we propose to employ the ratio of CSI readings from two antennas as a new signal for the first
time for respiration sensing. With this simple division operation between two antennas, most of the noise in
the original CSI amplitude and the time-varying phase offset are canceled out. With the random phase offset
removed, we are now able to retrieve stable phase information for sensing. We further combine the phase and
amplitude of the CSI ratio which are complementary to each other in terms of sensing capability to remove
the ”blind spots”. These two novel schemes enable FarSense to achieve robust sensing performance and a much
larger sensing range, moving one big step towards practical application of WiFi-based respiration sensing in real
life.
3 EMPIRICAL STUDY
In this section, we conduct the proof-of-concept experiments using commodity WiFi devices to see if the ratio
of CSI between two antennas has higher sensitivity than the CSI of one antenna. Note that the amplitude of the
CSI ratio equals to the ratio of two CSI amplitudes at the two antennas while the phase of the CSI ratio equals to
the CSI phase difference between the two antennas. Since the CSI phase of one antenna is not directly usable for
sensing, here, we focus on comparing the amplitude information, i.e., the CSI amplitude of one antenna which
was widely used for sensing with the ratio of CSI amplitude between two antennas proposed by us.
Experimental Settings. As shown in Fig. 2, we move a square metal plate with a side length of 15 cm along
the perpendicular bisector of the transceivers with a LoS length of 5.5 m in an empty room. The transceivers and
the metal plate are placed at the same height (1.2 m). Since the flat metal plate can serve as a perfect reflector for
radio waves, there is only one dominating reflection path from the plate. For the experiment, we move the metal
plate along the perpendicular bisector of the transceiver pair in the range of 5 m to 7 m. We record the ground
truth of the start position Ds and end position De . Following simple geometry, the ground truth of the reflection
path length change is 2
√
(
LoS
2
)
2 + D
2
e − 2
√
(
LoS
2
)
2 + D
2
s
. We also vary the LoS path length to see the effect.
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:6 • Zeng et al.
Metal
Plate
Tx
Rx
LoS=550cm
Ds
De
Start Position End Position
Fig. 2. Experimental settings: the metal plate
moves from the start position to the end position.
(a) (b) (c)
Fig. 3. Comparison of three amplitude waveforms when a metal plate moves further away. Obviously, the ratio of amplitude
outperforms the other two raw amplitude waveforms for its clear fluctuation caused by the movements of metal plate.
Experimental Results. Fig. 3 shows the raw amplitude waveforms of two antennas respectively as well as the
ratio of CSI amplitdue when the metal plate moves from Ds = 5.83 m to De = 5.99 m which incurs a reflection path
length change of 2
√
(
5.5
2
)
2 + 5.992 −2
√
(
5.5
2
)
2 + 5.832 = 0.29 m. According to the Fresnel zone model proposed
in [47, 55], at the carrier frequency of 5.24 GHz (λ = 5.7 cm), we ought to observe 0.29
0.057 = 5 peaks/valleys in the CSI
amplitude waveform. Fig. 3 (a) and (b) show the CSI amplitudes retrieved from two antennas at the same receiver.
As shown in Fig. 3 (a), the plate movement-induced signal variation pattern is buried in the noise, and we can
hardly see it. The signal variation pattern is slightly clearer in Fig. 3 (b) but it is still difficult to be visualized.
Fig. 3 (c) shows the ratio of amplitude between two antennas, and we can observe much clearer peaks/valleys.
This is because the division operation cancels out most of the noise in the raw amplitude readings (e.g., high
amplitude impulse and burst noise). Thus, the signal variation pattern with amplitude ratio is much clearer than
that with raw amplitude readings. When we vary the LoS path length, we have the same observation that the
amplitude ratio shows much clearer movement-induced signal variation patterns especially when the target is
far away from the transceivers.
The ratio of two CSI readings is still a complex number with amplitude and phase. Mathematically, the amplitude is the ratio of the raw CSI amplitudes while the phase is the phase difference of the raw CSI phases. We have
just shown that the ratio of the amplitudes exhibits better sensing performance compared to raw amplitudes, we
further explore the other properties of CSI ratio for human sensing.
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:7
Q
O I
Hs
Hd
H
Fig. 4. Ideal CSI in complex plane:
when d(t) increases, it rotates
clockwise. In this case, its locus is
a clockwise circle.
Q
O I
Q
I O I
Q
O
(a) (b) (c)
scaling rotation translation
Fig. 5. The scaling (H(f ,t) 7→ αH(f ,t), α ∈ R), rotation (H(f ,t) 7→ e
iθH(f ,t), θ ∈ R)
and translation (H(f ,t) 7→ H(f ,t) + β, β ∈ C) operations do not change the geometric
shape and rotation orientation (clockwise or counterclockwise) of the circle (represented
as H(f ,t)).
4 THE CSI-RATIO MODEL
In this section, we first introduce the basic concept of CSI and present the relationship between human’s movement and the change of CSI readings. Next, we present the CSI-ratio model which establishes the corresponding
relationship between human’s movement and CSI ratio. At last, we summarize three key properties of CSI ratio
which can be utilized for human sensing and verify them via benchmark experiments.
4.1 CSI Primer
In an indoor environment, radio frequency (RF) signals propagate from transmitter to receiver through multiple
paths, i.e., one direct path and multiple reflection paths from objects (such as walls, furniture and the human
target). The channel state information (CSI), which characterizes the multipath propagation, is a superposition
of signals from all the paths. Mathematically, the CSI can be represented as:
H(f ,t) = ∑
L
i=1
Aie
−j2π
di
(t )
λ (1)
where L is the number of paths, Ai
is the complex attenuation and di(t) is the propagation length of the i
th path.
According to prior work [50], the paths can be grouped into static path and dynamic path. Without loss of
generality, we assume there is only one reflection path. When there is only one reflection path corresponding
to the human target’s movement, the dynamic component is the path reflected from the human target while
the static component is composed of the LoS propagation and other reflection paths from static objects in the
environment. Thus, the CSI can be rewritten as:
H(f ,t) = Hs (f ,t) + Hd (f ,t) = Hs (f ,t) + A(f ,t)e
−j2π
d(t )
λ (2)
where Hs (f ,t) is the static component, A(f ,t), e
−j2π
d(t )
λ and d(t) are the complex attenuation, phase shift and
path length of dynamic component Hd (f ,t), respectively.
When the human target moves a short distance, the signal amplitude of the dynamic component A(f ,t) can
be considered as a constant. This is because the signal amplitude is determined by the path length. Changes of a
few centimeters in path length have very little effect when the path length d(t) is in the scale of meters. When
d(t) is increased by one wavelength, the CSI (H(f ,t) in Eq. 2) rotates 2π clockwise, as shown in Fig. 4. It is easy
to see that with operations such as scaling (H(f ,t) 7→ αH(f ,t), α ∈ R), rotation (H(f ,t) 7→ e
iθH(f ,t), θ ∈ R)
and translation (H(f ,t) 7→ H(f ,t) + β, β ∈ C) in complex plane, the CSI trajectory is still a clockwise circle,
as shown in Fig. 5. This observation is quite important and helps to investigate the properties of CSI ratio in
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:8 • Zeng et al.
Sec. 4.2. Note that for some sensing applications (e.g., respiration sensing and finger tracking), the caused path
length change is smaller than one wavelength. In this case, d(t) is increased by less than one wavelength and
the CSI rotates less than 2π clockwise, thus its locus is just part of the full circle (a circular arc).
Unfortunately, for commodity WiFi devices, as the transmitter and receiver are not time-synchronized, there
is a time-varying random phase offset e
−jθof f s e t in each CSI sample as follows:
H(f ,t) = e
−jθof f s e t (Hs (f ,t) + A(f ,t)e
−j2π
d(t )
λ ) (3)
With this random phase offset, the movement-induced CSI change in complex plane is no longer a circle. This
random phase offset thus prevents us from directly using the CSI phase information for fine-grained sensing.
4.2 Understanding CSI Ratio
Before derivating the formula of CSI ratio, we first present two key observations as follows:
(1) For commodity WiFi card such as the widely used Intel 5300, the time-varying phase offset is the same
across different antennas on a Wi-Fi card as they share the same RF oscillator [17, 25].
(2) When the target moves a short distance (a few centimeters), the difference of the two reflection path
lengths at two close-by antennas d2(t) − d1(t) can be considered as a constant ∆d [62].
Based on these two observations, we obtain the CSI ratio by taking the ratio of CSI in Eq. 3 between two
antennas as follows:
H1(f ,t)
H2(f ,t)
=
e
−jθof f s e t (Hs,1 + A1e
−j2π
d1(t )
λ )
e
−jθof f s e t (Hs,2 + A2e
−j2π
d2(t )
λ )
=
A1e
−j2π
d1(t )
λ + Hs ,1
A2e
−j2π
d1(t )+∆d
λ + Hs,2
=
A1e
−j2π
d1(t )
λ + Hs,1
A2e
−j2π
∆d
λ e
−j2π
d1(t )
λ + Hs,2
(4)
where H1(f ,t) is the CSI of the first antenna and H2(f ,t) is the CSI of the second antenna. To simplify the
equation for easier illustration, we employ A, B, C, D and Z to represent the terms: A1 = A, Hs ,1 = B,
A2e
−j2π
∆d
λ = C and Hs ,2 = D; e
−j2π
d1(t )
λ = Z represents a unit circle rotates clockwise when d1(t) increases.
We can then simplify Eq. 4 as:
H1(f ,t)
H2(f ,t)
=
AZ + B
CZ + D
(5)
which is exactly in the form of Mobius transformation [43], provided BC − AD , 0. We further decompose it
into the following form:
H1(f ,t)
H2(f ,t)
=
BC − AD
C2
·
1
Z +
D
C
+
A
C
(6)
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:9
0 1 Real axis
Imaginary axis
0
z
1/z
1/ ẕ
0 1 Real axis
Imaginary axis
(b)
(a)
1
0
θ
-θ
r
1/r
Z
I(Z)
Z ͠
0 1 Real axis
Imaginary axis
0
(c)
Z
I(Z)
Z
͠
Fig. 6. Illustration of complex inversion: (a) the point z is mapped to a new point 1
z
that has the reciprocal length and
the negative angle; (b) the clockwise circle Z that does not contain the origin is mapped to a new circle Ze that has the
same orientation; (c) the clockwise circle Z that contains the origin is mapped to a new circle that has the opposite
orientation. Here, 1/z and I(Z) represent the inversion of the point z and the circle Z, respectively.
Consequently, the mapping in Eq. 6 is composed of the following transformations [35]:
(i) Z 7→ Z +
D
C
, which is a translation by D
C
;
(ii) Z 7→
1
Z
, which is a complex inversion;
(iii) Z 7→ BC − AD
C2 Z, which is a multiplication by the complex number BC − AD
C2
;
2
(iv) Z 7→ Z +
A
C
, which is another translation by A
C
.



(7)
As shown in Sec. 4.1, the scaling and rotation operation in step (iii) and translation operations in step (i) and (iv)
do not change the geometric shape and rotation orientation (clockwise or counterclockwise) of the circle. Thus,
for the remaining step (iii) in Eq. 7, its complex inversion operation (Z 7→ 1
Z
) holds the key to understanding
the effect of CSI ratio (Mobius transformation) and we introduce it below.
Mathematically, the complex inversion of a point z = reiθ
is 1
r
e
−iθ
: the new length is the reciprocal of the
original, and the new phase is the opposite of the original. Fig. 6 (a) shows how a point z outside the unit circle is
mapped to a point 1
z
inside it: (1) move z = reiθ
to the point that is at the same direction as z but has a reciprocal
2Mathematically, a multiplication by a complex number Aeiθ
corresponds to a scaling (amplitude A) and a rotation (phase θ ).
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:10 • Zeng et al.
length, namely the point 1
r
e
iθ
; (2) apply a complex conjugate operation (i.e., symmetrical with respect to the real
axis) to arrive at the point 1
r
e
−iθ
.
Next, we investigate the effect of complex inversion (denoted as Ze) on a clockwise circle Z, as shown in Fig. 6
(b) and (c). The complex inversion does not change the shape of Z [35]. However, it may change the rotation
orientation of Z. Whether Ze has the same orientation as Z depends on whether the origin (0, 0) is inside Z or
not. As shown in Fig. 6 (b), if (0, 0) is not inside Z, then Ze has the same rotation orientation as Z. As shown in
Fig. 6 (c), if (0, 0) is inside Z, then Ze has the opposite rotation orientation. Recall that the complex inversion is
applied to Z +
D
C
in Eq. 6 where Z represents a unit circle and D
C
is the translation to the origin (0, 0). Thus,
given |
D
C
| = |
Hs ,2
A2
| > 1 (the radius of a unit circle), Z +
D
C will not contain the origin. So we can conclude that
1
Z+ D
C
does have the same orientation as Z +
D
C
. As shown above, the scaling, rotation and translation in Eq. 6
does not change the rotation orientation, thus the CSI ratio AZ+B
CZ+D
has the same rotation orientation as 1
Z+ D
C
(and Z +
D
C
). This is also the case for human sensing most of the time: the magnitude of the static component
|Hs,2| is larger than that of the dynamic component |A2| [26]. This may not hold true when the LoS path signal
is attenuated by objects, in which case the CSI ratio AZ+B
CZ+D
has the opposite rotation orientation as Z +
D
C
.
Based on the analysis above, it is easy to obtain the following three properties of CSI ratio for human sensing:
P1 The CSI ratio changes following a circle in complex plane when the reflection path length changes several
wavelengths.
P2 If the reflection path length increases: when the magnitude of static component is larger than that of
dynamic component, CSI ratio rotates clockwise; otherwise, it rotates counterclockwise.
P3 If the reflection path length changes exactly one wavelength, the CSI ratio forms a full circle whose radian
is exactly 2π in complex plane. If the reflection path length changes less than one wavelength, the CSI
ratio forms a circular arc whose radian roughly matches the reflection path length change.
These three properties in CSI-ratio model relate the reflection path length change to the change of CSI ratio.
4.3 Model Verification with Benchmark Experiments
In this subsection, we verify the three properties above via benchmark experiments. As shown in Fig. 7 (a),
the verification experiments are conducted in a large room with less multipath so that the three properties
can be more clearly visualized. We setup one pair of GIGABYTES mini-PCs equipped with Intel 5300 NICs as
transceivers, and the LoS distance is set as 4 meters. The transmitter (Tx) is equipped with one antenna while
the receiver (Rx) is equipped with two antennas. All the antennas are commonly-seen vertically-polarized omnidirectional antennas. The central frequency is set as 5.24 GHz, corresponding to the wavelength of 5.725 cm. We
adopt a metal plate as the reflector to reflect off WiFi signals. To precisely control the displacement of the metal
plate, we mount it on a high-precision linear motion slider with an accuracy of 0.01 mm. We put a desk at the
perpendicular bisector of the LoS path and place the slider on the desk, as shown in Fig. 7. When the metal plate
moves along the slider, the reflection path length changes accordingly. Note that, in this real-life setting, the
magnitude of static component is much larger than that of dynamic component.
Verification of P1. We control the metal plate to move 0.1 m away from the LoS path with the start position
of 2.55 m perpendicular to the LoS. As shown in Fig. 8 (a), the dots are the samples of CSI ratio and the line is
smoothed CSI ratio after Savitzky-Golay filter which can effectively preserve the envelope of the raw waveform
[4]. We can observe that the CSI ratio changes following a circle in complex plane, which meets our expectation.
We obtain the same results when the plate moves at different start positions.
Verification of P2. When the LoS path is not obscured, the magnitude of static component is larger than that
of dynamic component, in which case the CSI ratio rotates clockwise, as shown in Fig. 8 (a). Next, we place a
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:11
Tx
Rx
LoS
Metal
Plate
Slider
Fig. 7. Experimental settings for model verification.
(a) (b)
Fig. 8. The CSI ratio in complex plane when the metal plate moves
0.1 m away from the LoS path: (a) normal case; (b) the LoS path is
obscured by a large metal plate between the transceivers. 0.6cm
3.6cm
0.5cm
Metal 3.0cm
Plate
Tx
Rx
LoS=400cm
D1=255cm
D2=575cm
L1 L2 L3 L4 L5 L6
Fig. 9. Conceptual illustration of experimental settings for verification of P3. (a) (b)
Fig. 10. The CSI ratio in complex plane when the metal plate moves
away from the LoS path: (a) from L1 to L3; (b) from L1 to L2.
large square metal plate (1 m × 1 m) vertically between the transceivers to greatly attenuate the LoS path signal
so that the magnitude of the dynamic component is larger than that of the static component. Then we repeat
the experiment as the same as verification of P1. In this case, when the metal plate moves 0.1 m away from the
LoS path, the CSI ratio rotates counterclockwise, as shown in Fig. 8 (b). We also conduct the experiments when
the metal plate moves towards the LoS path and observe that if the reflection path length decreases: when the
magnitude of static component is larger than that of dynamic component, CSI ratio rotates counterclockwise;
otherwise, it rotates clockwise. We skip these figures for conciseness.
Verification of P3. As shown in Fig. 9, we conduct experiments in two different regions, one near to the
LoS (255 cm) and the other relatively far away (575 cm). In each region, we control the start and end positions
of the metal plate’s motion to make sure the reflection path length changes one wavelength or one-sixth of the
wavelength. In detail, when the metal plate moves from L1 (255 cm) to L3 (258.6 cm) and from L4 (575 cm) to
L6 (578.0 cm), the reflection path length changes exactly one wavelength. When the metal plate moves from
L1 (255 cm) to L2 (255.6 cm) and from L4 (575 cm) to L5 (575.5 cm), the reflection path length changes exactly
one-sixth of the wavelength. Note that the experiments described above are conducted without obscuration of
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:12 • Zeng et al.
Tx
Rx
Static
object
Static
path
Human
chest
End of inhalation,
start of exhalation
End of exhalation,
start of inhalation
Dynamic
path CSI ratio
I
Q
o
Fig. 11. When a subject breathes, the dynamic path length increases or decreases, then CSI ratio rotates along
a circular arc (labeled in blue) clockwise or counterclockwise corresponding to the inhalation and exhalation.
the LoS path, which means the magnitude of static component is larger than that of dynamic component. Fig. 10
(a) shows the CSI ratio when the metal plate moves from L1 to L3, and we can observe a clear full circle. That
is to say, when the metal plate moves from L1 to L3, the reflection path length is changed by one wavelength,
and thus the CSI ratio rotates clockwise by exactly 2π along a circle. In Fig. 10 (b), we observe the CSI ratio
rotates clockwise by roughly π
3
along a circle when the metal plate moves from L1 to L2. That is to say, when the
reflection path length changes less than one wavelength, the CSI ratio forms a circular arc whose radian roughly
matches the reflection path length change. We obtain similar results when the plate is 5.75 meters away, and we
omit the figures for the sake of brevity.
To sum up, the benchmark results above validate the three properties of CSI ratio. These three properties
relate the reflection path length change to the change of CSI ratio and guide us how to sense human activities
exploiting CSI ratio. We want to point out that the proposed CSI-ratio model in this session is a very general
method which can be applied to many existing WiFi-based sensing applications such as indoor tracking and
motion detection. It also lays a solid foundation for sensing finer-grained subtle movement, such as tiny finger
tracking. It can also be applied to other wireless technologies such as RFID, LTE and LoRa. In this paper, we
focus on applying CSI ratio to significantly increase the sensing range of WiFi-based respiration, and we present
the details in next section.
5 EXTRACTING RESPIRATION PATTERN FROM CSI RATIO
In this section, we aim to extract the subtle signal variation caused by respiration from CSI ratio even when
the target is far away. We first introduce how to apply the CSI-ratio model presented in previous section for
human respiration sensing. Next, we present our approach that extracts respiration pattern more accurately
by combining the amplitude and phase of the CSI ratio to achieve an even further sensing range and higher
accuracy.
5.1 Applying CSI-ratio Model for Respiration Sensing
For respiration sensing, it is safe to assume that there is one dominating reflection path from the human chest,
as previously verified in [47, 62]. Therefore, the formula of CSI ratio obtained in Eq. 4 can be directly applied
for respiration sensing where d(t) is the path length of signal bouncing off the human chest. Since the chest
displacement caused by respiration is between 5 mm to 12 mm [33], the reflection path length changes less
than one wavelength (5.7 cm for 5.24 GHz), then the locus of CSI ratio during respiration is just a circular arc
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:13
z´
o I
Q
θ
z=a+bi
oz´=acosθ+bsinθ
projection axis
[cosθ sinθ]
Fig. 12. A point z = a +bi is projected on
an axis to get a new point z
′
.
CSI Ratio in Complex Plane Projection of CSI Ratio on Three Axes
Time (s) I
Q
(a) (b)
CSI ratio during
 respiration
Fig. 13. Example of projecting a time series of two-dimensional CSI ratio during respiration in complex plane: (a) CSI ratio and three projection axes (θ =
0, π/4, π/2); (b) projection results on three corresponding axes in (a).
(part of a full circle). As shown in Fig. 11, when a subject inhales and exhales during respiration, the dynamic
reflection path length increases and decreases accordingly. The CSI ratio rotates along the circular arc clockwise
or counterclockwise corresponding to inhalation and exhalation, respectively. By analyzing the time interval
between clockwise and counterclockwise rotation, we can obtain the respiration rate.
As shown in Sec. 4.2, when reflection path length increases, whether CSI ratio rotates clockwise or counterclockwise is determined by the relationship between the static and dynamic components. However, the rotation
orientation does not change the time interval between exhalation and inhalation during respiration and thus
has no effect on the respiration rate estimation.
5.2 Combining Amplitude and Phase of CSI Ratio
With the CSI reading at one antenna, the phase can not be utilized for sensing because of the time-varying
random phase offset. With CSI ratio, the phase difference between two antennas is stable (the random phase
offset gets canceled out). Thus, we can combine the phase and amplitude of the CSI ratio to eliminate the ”blind
spots” issue reported in [47] and further extend the sensing range.
Note that a complex number can be represented in the form of a + bi as well as Aeiθ where a, b are the
real part (I) and imaginary part (Q), and A, θ are the amplitude and phase, respectively. The orthogonal I and
Q components of CSI ratio keep perfect complementarity for respiration sensing which means at a location I
component is bad for sensing, Q component is good and vice versa.
Thus, we combine the I, Q components for sensing which is equivalent to combining amplitude and phase. As
shown below, the combination scheme consists of two steps: (1) generating multiple combination candidates by
assigning different weights to the I/Q components for combination; (2) selecting one from the candidates as the
final extracted respiration pattern.
5.2.1 Generating Combination Candidates. Traditional approach [7] simply selects a better one from I and Q,
thus has only two candidates–I and Q. We linearly combine I/Q components by projecting the complex-valued
CSI ratio on an axis in the complex plane. Fig. 12 shows how a point z = a+bi is projected on an axis [
cos θ sinθ
]
to get a new point z
′
, where θ is the angle of projection axis. Following simple geometry, we can obtain:
oz′ =
[
cos θ sinθ
] [a b]T
= a cos θ + b sinθ
(8)
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:14 • Zeng et al.
which is exactly the linear combination of the I-Q components of the point z. In this combination, the weights
assigned are cos θ for I component and sinθ for Q component. Similarly, for a time series of CSI ratio data x, its
projection y on axis [
cos θ sinθ
]
can be denoted as:
y =
[
cos θ sinθ
] [ℜ(x) ℑ(x)
]T
(9)
where ℜ(x) is the real part (I component) of x and ℑ(x) is the imaginary part (Q component) of x. By varying
θ from 0 to 2π at a fixed step size, we can generate different combination candidates.
Fig. 13 presents the example of projecting a time series of two-dimensional CSI ratio (during respiration)
on three axes in complex plane. As shown in Fig. 13 (a), the locus of CSI ratio during respiration process is
a circular arc, and three different projection axes are chosen, namely axis 1 (θ = 0), axis 2 (θ = π/4) and
axis 3 (θ = π/2). Projection axis 1 is tangential to the circular arc while projection axis 3 is perpendicular to it, and
projection axis 2 is between 1 and 3. Fig. 13 (b) presents the projection results on these three axes. We can observe
that, different projections have different capabilities in terms of sensing respiration: while projection 3 has very
little fluctuation, projection 1 and 2 have clear periodical fluctuation patterns corresponding to inhalation and
exhalation.
We can see that compared to traditional approach [7] which simply selects a better one from I and Q (weight is
either 0 or 1), we tune the weight for combination in a fine-grained manner by changing the projection parameter
θ from 0 to 2π at a chosen step size π
n
. Our approach will generate 2n combination candidates, which is much
larger than that of the traditional approach. The selection between I and Q can be viewed as a combination of
I/Q with θ = 0 or θ =
π
2
. Thus the traditional approach is actually a small subset of our approach. The much
larger number of combination candidates make our approach outperform the previous work.
5.2.2 Selection from Multiple Candidates. After generating multiple combination candidates, we need to select
the best one from these candidates to generate the respiration pattern. Our insight comes from that the target’s
respiration rate can be assumed a constant during a short period of time [61, 62]. Therefore, the periodicity of
the signal pattern during a short period can represent its capacity to sense respiration, which can be used to
select the best one from the candidates.
Here, we adopt the short term breathing-to-noise ratio (BNR) proposed in [61] to measure the periodicity of
a combination candidate, which is defined as the ratio of respiration energy to the overall energy. We compute
BNR by first taking FFT of the combination candidate. In our computation, the window length of projection is
set to 12 seconds which corresponds to 1200 samples. Next, we find the FFT bin with maximal energy within
the human respiration range (10 bpm to 37 bpm). Here, we increase the number of samples to 8192 by means
of zero-padding which appends the time-domain signal with 6992 zero-value samples [45]. The zero-padding
of course can not improve the spectral resolution, however, it can reveal finer details in the spectrum so that
the FFT bin with maximal energy can be more easily located [16]. Then BNR is calculated by dividing that bin’s
energy by the energy sum of all FFT bins. At last, we select the one that has the maximal BNR value among all
the combination candidates.
Our selection strategy based on periodicity performs better than the commonly used strategy that is based on
variance[47, 51]. When the target is near to the transceiver pair, both strategies can effectively extract the respiration pattern. However, when the target is further away from the transceivers, even the CSI ratio becomes noisy
and it is no longer a circular arc any more. Then the selection based on variance may fail since the respirationcaused signal variation is now smaller than the noise level and in this case the variance is mainly caused by
environmental noise [50]. Differently, our selection strategy based on periodicity still tries its best to combine
I/Q for extracting the quasi-periodical respiration pattern during a short period.
Fig. 14 compares different respiration pattern extraction methods when a target breathes naturally far away
from the transceivers and the ground-truth respiration rate is 25 bpm. Fig. 14 (b) and (c), which employ the
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:15
Amplitude of CSI Ratio Projection with Maximal Variance
(b)
Phase of CSI Ratio
(c)
(d)
(e)
Projection with Maximal Periodicity
CSI Ratio in Complex Plane
I
(a)
Q
CSI ratio during
 respiration
Fig. 14. Comparison of different respiration pattern extraction approaches when a subject is far away from the transceivers:
(a) CSI ratio in complex plane is no longer a circular arc; (b) amplitude; (c) phase; (d) projection with maximal variance; (e)
projection with maximal periodicity. We can see clear and periodical respiration pattern in (e).
Respiration Rate
Estimation
Data Collection
Respiration
Pattern Extraction
Data
Preprocessing
Raw CSI
Denoised
CSI Ratio
Respiration
Pattern
Respiration
Rate
Fig. 15. System architecture of FarSense.
amplitude and phase of the CSI ratio, have no clear rhythmical pattern caused by respiration. In Fig. 14 (d),
the projection has the maximal variance. However, the rhythmical pattern is still not clear and respiration can
hardly be detected. In contrast, the projection with maximal periodicity in Fig. 14 (e) shows clear respiration
pattern, which matches the ground truth well. Obviously, our approach outperforms the selection of a better
one from amplitude/phase [62] and the I/Q combination with maximal variance, thus significantly increasing
the respiration sensing accuracy and range.
6 THE FARSENSE SYSTEM
In this section, we present our design and implementation of a real-time respiration monitoring system named
FarSense. The FarSense system consists of four basic modules: Data Collection, Data Preprocessing, Respiration
Pattern Extraction and Respiration Rate Estimation, as shown in Fig. 15.
6.1 Data Collection
In this module, we collect CSI data from two antennas at the receiver using the CSI tool [10] developed by
Halperin which collects the CSI samples for each received packet. Here, we configure the WiFi card to run at a
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:16 • Zeng et al.
central frequency of 5.24 GHz with a bandwidth of 20 MHz. Note that the Intel 5300 WiFi card provides CSI on 30
sub-carriers out of a total of 56 sub-carriers for 20 MHz bandwidth. The sampling rate of CSI is set to 100 Hz in our
system. Although a sampling rate of 10 Hz is enough to capture the change of CSI caused by respiration (smaller
than 1 Hz), we set a higher sampling rate for higher respiration rate estimation resolution using autocorrelation
in Sec. 6.4.
6.2 Data Preprocessing
In this module, for each sub-carrier, we first divide the two complex CSI readings from the two antennas at the
same receiver to obtain the CSI ratio which is still a complex value.
Next, we introduce the motion detector proposed in [27] to flag periods of time when there are large motions
and exclude these time periods for sensing. This is because when the human target is at high mobility, the CSI
change due to minute chest movement is overwhelmed by the large motions so that FarSense system will not be
able to accurately monitor respiration. Different from [27] that feeds the conjugate multiplication of CSI from
two antennas into the speed spectrum estimator, we feed the CSI ratio into it to robustly determine whether the
human target is stationary or non-stationary (i.e., whether there are large motions).
At last, we apply the Savitzky-Golay filter to smooth the CSI ratio data of each sub-carrier during these stable
time periods and use them for further processing.
6.3 Respiration Pattern Extraction
In this module, we extract respiration patterns of 30 sub-carriers. For each sub-carrier i, we go through all the
projection axis parameter θ (i.e., 0,
π
50,
2π
50 , ...,
99π
50 at a step size of π
50 ) to generate 100 candidates and select
one that maximizes BNR as the final extracted respiration pattern, as shown in Sec. 5.2. For the laptop (DELL
Precision 5520 with Intel Xeon E3-1505M v6 and 8 GB RAM) we use for data processing, the time cost of all 30
sub-carriers for searching θ from 0 to 2π with a given step π
50 is about 0.54 s, which is acceptable for a real-time
respiration monitoring system. We can further reduce the time cost by increasing the step size of searching.
6.4 Respiration Rate Estimation
In this module, we estimate respiration rate by combining results from multiple sub-carriers. We adopt the
autocorrelation method which has shown to perform well in low SNR scenario [6]. The periodicity of respiration
presents us this unique opportunity to obtain peaks with autocorrelation. We first apply autocorrelation on the
respiration pattern of each sub-carrier. Then we combine the autocorrelation results from multiple sub-carriers
to obtain a final respiration rate estimation.
6.4.1 Applying Autocorrelation on Respiration Pattern. First, for each sub-carrier, we calculate the autocorrelation of its respiration pattern. The autocorrelation function describes the similarity of a signal to a shifted version
of itself. According to [5], for sub-carrieri, the autocorrelation ri(k) of a time series of respiration pattern yi for
a shift of k samples is defined as:
ri(k) =
∑
T
t=k+1
(yi(t) − yi)(yi(t − k) − yi)
∑
T
t=1
(yi(t) − yi)
2
(10)
where T is the total length of yi
, yi
is the mean of yi and k = 0, ...,T − 1 is number of samples shifted.
6.4.2 Multiple Sub-carriers Combining. We now combine the sub-carriers by employing a weighted sum of each
sub-carrier’s autocorrelation result. The weight of each sub-carrier is the respiration pattern’s BNR value. With
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:17
Sub-carrier 4
Sub-carrier 8
Sub-carrier 17
Time (s) Lag
Respiration Patterns Autocorrelation Results Weights
0.13261
0.13696
0.13556
Lag
Combined Autocorrelation Result
∑
Lag=335
Fig. 16. Example of multiple sub-carriers combining. In this case, we use the weighted sum of three selected sub-carriers’
autocorrelation results to obtain a final one. The estimated respiration rate is 60
335/100 = 17.9 bpm.
extensive experiments, we find that, when the subject is far away from the WiFi transceivers, there are occasionally some so-called “bad” sub-carriers whose respiration patterns are chaotic even after we apply our proposed
methods. We believe this is because each sub-carrier experiences different multipath fading and shadowing effects, and the CSI ratios of different sub-carrier have different sensitivity to subtle respiration motions. Thus, we
do not include all the sub-carriers but only those ”good” ones. Those ”bad” sub-carriers which have BNR values
smaller than a pre-defined threshold will be excluded from combination. Let the maximal BNR among all 30
sub-carriers be ε, we just include those sub-carriers whose BNR is larger than 0.7ε for combination.3 And the
final combined autocorrelation result can be represented as:
rmsc =
∑
i ∈S
BN Ri × ri
(11)
where S is the set of sub-carriers whose BNR is larger than 0.7ε, BN Ri
is the BNR of sub-carrier i and ri
is the
autocorrelation result of sub-carrier i. The first peak of rmsc (k)(k = 0, ...,T − 1) is the component describing
the periodicity of respiration [13]. And the shift of the first peak divided by the sampling rate is the estimated
period for one respiration cycle.
Fig. 16 shows an example of respiration rate estimation by combining multiple sub-carriers. Three sub-carriers
(i.e., 4, 8 and 17) are selected to participate in the weighted sum operation. As shown in the final combined
autocorrelation result, the lag (shift) of the first peak labeled with 1 is 335. For a sampling rate of 100 Hz, the
estimated respiration rate is calculated as 60
335/100 = 17.9 bpm.
7 EVALUATION
In this section, we conduct comprehensive experiments to evaluate the performance of FarSense with commodity
WiFi devices. In Sec. 7.1, we describe the experimental setup. In Sec. 7.2, we compare FarSense with the state-ofthe-art approaches in terms of sensing range. In Sec. 7.3, we evaluate the robustness of FarSense in challenging
real-life scenario such as when the WiFi AP is located in another room far away from the target.
3We tested different thresholds with large amounts of data and empirically chose 0.7 for sub-carrier selection.
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:18 • Zeng et al.
Fig. 17. Graphical user interface of FarSense.
(a) (b)
Marker
Tx
Rx
Marker Tx
Rx
Fig. 18. Comparison with the state-of-the-art approaches in two different experimental environments: (a) a large corridor; (b) a typical home.
7.1 Experimental Setup
As shown in Sec. 4.3, we employ a pair of GIGABYTE mini-PCs equipped with cheap Intel 5300 WiFi cards
as transceivers where one antenna is equipped at the transmitter (Tx) and two antennas are equipped at the
receiver (Rx). The carrier frequency of the WiFi channel is set as 5.24 GHz and the transmitter broadcasts 100
packets one second. We collect CSI data at the Rx using the CSI tool [10] and process it with MATLAB at a
DELL Precision 5520 laptop (Intel Xeon E3-1505M v6, 8 GB RAM) in real time. Fig. 17 shows the graphical user
interface (GUI) of FarSense, which consists of four components: (1) the respiration pattern of the sub-carrier
that has the largest BNR; (2) the real-time video of the test environment captured by a camera; (3) the human
status (stationary or non-stationary); and (4) the estimated respiration rate. Note that if the human status is
non-stationary, the GUI will not display the value of respiration rate. Different from the lab-controlled groundtruth collection approaches which ask subjects to breathe to a metronome [14, 42], we collect the ground-truth
respiration rates when a subject breathes naturally with a commercial device (Neulog Respiration Monitor Belt
logger sensor NUL-236 [15]). In the experiments, we recruit 12 people and collect a total of 197 hours of CSI data
in different environments where each subject sits on a chair or lies in a bed.
7.2 Comparison with Previous Approaches
In this subsection, we compare FarSense with two state-of-the-art WiFi-based respiration sensing approaches
[47, 62] in terms of sensing range. To quantitatively understand the effective sensing range, we adopt the metric
of detection rate when a subject breathes at locations with different distances to the transceivers. As shown
in previous section, the distance from a subject to the transceivers is defined as the average distance from the
subject to the transmitter and receiver. The detection rate at a certain distance is defined as Nd e t ec t ed
Nal l
, where
Ndetected is the number of CSI measurements whose respiration rate estimation is very close to the ground
truth (i.e., the absolute error is less than 0.5 bpm) and Nall is the total number of collected CSI measurements.
Then, we define the sensing range of a respiration sensing system as the maximal distance at where the detection
rate is higher than 95%. Obviously, a higher detection rate means a larger sensing range.
7.2.1 Baseline Approaches. We first introduce these two state-of-the-art approaches as follows:
• HRD.4 HRD [47] uses the CSI amplitude for respiration sensing. HRD first applies the Hampel filter and a
moving average filter to remove outliers and high-frequency noise. Then HRD employs a threshold-based
method to select sub-carriers that have larger variance of CSI amplitude and estimates the respiration rate
with peak detection method.
4For convenience, we use the term ”HRD” (Human Respiration Detection) to represent the respiration detection system proposed in [47].
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:19
3
Distance to Transceivers (m)
4 5
FarSense
FullBreathe
HRD
(c)
(b)
(a) (d)
(e)
(f)
(g)
(h)
(i)
Fig. 19. The detailed respiration patterns of each approach at three different
distances to the transceivers. At the distance of 5 m, FarSense can still effectively sense respiration while the other two approaches fail.
Fig. 20. The overall detection rate of
each approach versus distance to the
transceivers.
• FullBreathe. FullBreathe [62] uses the conjugate multiplication (CM) of CSI readings from two adjacent
antennas at the same sub-carrier for sensing. FullBreathe first applies the Savitzky-Golay filter to smooth
the noisy raw CM. FullBreathe then selects either the amplitude or phase which achieves better performance for sensing. FullBreathe also estimates the respiration rate by peak detection.
7.2.2 Experimental Settings. We conduct experiments in two different environments, as shown in Fig. 18 (a) and
(b): one is a large corridor and the other is a typical home environment with furniture and electrical appliances
which has rich multipath. In each environment, we deploy a pair of transceivers and ask a subject to sit in the
chair located on the perpendicular bisector of the LoS path of the transceivers. We place markers on the floor
to label the distances (i.e., 0 m, 2 m, 4 m and 6 m) to the LoS path and record CSI data when a subject breathes
naturally. We vary the distance between the subject and the LoS path from 2.5 m to 5 m at a step size of 0.1 m.
Since the subject is on the perpendicular bisector of the LoS path, following simple geometry, we can obtain the
distance from the subject to a transceiver pair √
(
LoS
2
)
2 + l
2, where l is the distance between the subject and
the LoS path. We further vary the distance between the transmitter and receiver from 3 m to 5.5 m at a step size
of 0.1 m so we record CSI data at different distances to the transceivers ranging from √
(
3
2
)
2 + 2.5
2 = 2.9 m
to √
(
5.5
2
)
2 + 5
2 = 5.7 m. To see the effect of environment changes, we also move the furniture randomly to
change the multipath.
7.2.3 Experimental Results. To clearly visualize the comparison results, we show them from two aspects: one is
the detailed respiration patterns in one of the above settings and the other is the overall detection rate of each
approach with varying distances between the target and the transceivers.
Respiration Pattern. Fig. 19 presents the detailed respiration patterns of the three approaches at different
distances to the transceivers (i.e., 3 m, 4 m and 5 m) in a typical home with the transmitter and receiver separated
by 3 m. The ground truth of respiration rate is 18.2 bpm, which means 18.2
60/12 ≈ 3.5 peaks/valleys in a 12-second
window. When the subject is 3 m away from the transceivers, we can observe the clear respiration patterns
with all three approaches. We can see that among the three clear patterns, FarSense still achieves the clearest
respiration pattern. When the distance is increased to 4 m, as shown in Fig. 19 (d), the pattern obtained with HRD
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:20 • Zeng et al.
Tx
Rx
The subject
Fig. 21. Experimental settings in a large office room
(7.5 m × 9 m).
Fig. 22. The mean absolute error of respiration rate versus distance to the transceivers.
is full of noise, and we can hardly extract respiration rate from it. However, FullBreathe (Fig. 19 (e)) and FarSense
(Fig. 19 (f)) still have clear fluctuations, which match the ground truths. If the subject moves 5 m away from the
transceivers, as shown in Fig. 19 (g)-(i), both HRD and FullBreathe fail to extract clear respiration patterns while
FarSense still performs well. Under other settings specified in Sec. 7.2.2, FarSense always outperforms the other
two state-of-the-art systems and we skip the similar results here.
Overall Detection Rate. Fig. 20 presents the overall detection rates of the three approaches with different
distances away from the transceivers ranging from 3 m to 5 m at a step size of 0.5 m. The figure shows that our
detection rate remains 100% even when the subject is 5 m away from transceivers, while the detection rate of HRD
and FullBreathe drop to 1.4% and 7.7%, respectively. Obviously, at a greater distance, both HRD and FullBreathe
can hardly detect the human respiration, achieving very low detection rates. According to the definition of
sensing range in Sec. 7.2, we get the sensing range for HRD (less than 2.9 m), FullBreathe (3.7 m) and FarSense
(larger than 5.7 m). The experimental results demonstrate the effectiveness of FarSense in terms of increasing
the sensing range without sacrificing the accuracy.
7.3 Performance in Challenging Real-life Scenarios
In this subsection, we evaluate FarSense’s performance in challenging real-life scenarios. In Sec. 7.3.1, we conduct
experiments when the subject is located 6 m to 9 m away from the transceivers to evaluate the range limit of our
system. Apart from the LoS scenarios, in Sec. 7.3.2, we evaluate the FarSense’s performance when the subject
has non-LoS path with the transmitter (or receiver)–the WiFi transmitter is placed in a different room from the
receiver with a wall in between and the subject is located either in the transmitter side or in the receiver side.
In addition to sitting scenario, in Sec. 7.3.3, we evaluate FarSense when the subject lies in bed with different
sleeping postures while both transceivers are mounted far away on the ceiling.
7.3.1 Sitting Far from the Transceivers. We now evaluate FarSense’s performance when the subject sits beyond
5 m to the transceivers. As shown in Fig. 21, we conduct the experiments in a large office room (7.5 m × 9 m),
where rich multipath exists due to a large number of furniture and electronic appliances. In the experiments, the
transceivers are placed in the corner with a LoS path length of 6.8 m, and the subject sits on a barstool with a
height of 0.95 m, breathing naturally. We randomly move the subject’s position so that he/she is not just located
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:21
Tx
Rx
(a)
1
1
i Tx of setup i i Rx of setup i
2
2
3
3
(c)
Camera 1
Camera 2
(b)
Fig. 23. The Experiments for NLoS scenarios are conducted in a typical home: (a) the floor plan of the home
with three different transceiver setups, namely setup 1, 2 and 3; (b) the photo for setup 1, which is captured
by camera 1; (c) the photo for setup 1, which is captured by camera 2.
on the perpendicular bisector of the LoS path. We measure the distances from the subject to the transmitter and
receiver with a laser meter [39] and average these two distances to obtain the distance from the subject to the
transceivers.
We plot the mean absolute error of respiration rate as a function of distance from 6 m to 9 m in Fig. 22. The
figure shows that the mean absolute error of FarSense is 0.28 bpm at 6 meters and slightly increases to 0.64 bpm
even when the subject is 9 meters away from the transceivers. When the distance from the subject to transceivers
increases, the mean absolute error increases, too. This is because the signal reflected off human target is further
attenuated when the distance is increased. We also observe that, the mean absolute error is still less than 0.5 bpm
when the distance is 8 m. That is to say, FarSense can reliably sense human respiration at 100% detection rate
(less than 0.5 bpm) even when the subject is 8 m away from the transceivers. According to the definition of
sensing range in Sec. 7.2, the sensing range of FarSense is larger than 8 m. Compared to HRD (less than 2.9 m)
and FullBreathe (3.7 m), the sensing range of FarSense is increased by more than 8−3.7
3.7 = 116%.
7.3.2 NLoS Scenarios. To evaluate the ability of FarSense to monitor human respiration in NLoS scenarios, we
conduct experiments when the WiFi transmitter is placed in a different room from the receiver with a wall in
between, and the subject is located either in the transmitter side or in the receiver side. As shown in Fig. 23 (a),
we conduct the experiments in a typical home with three different transceiver setups, namely setup 1, 2 and 3.
For each setup, the subject sits on the sofa, in the bed or a chair, and is about 5 m to the transceivers. Fig. 23
(b) and (c) present the two photos of deployment for setup 1, which is captured by one camera in the living
room (camera 1) and another camera in the bedroom (camera 2), respectively. In this setup, the subject sitting
on the sofa is in the same room with the receiver while the transmitter is in the bedroom with a 10cm-thick wall
between the two rooms.
For all the experiments in NLoS scenarios, the achieved mean absolute error is as small as 0.34 bpm. The results
indicate that FarSense can reliably monitor human respiration even in the challenging NLoS scenario with a wall
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:22 • Zeng et al.
Rx Tx
Fig. 24. Experimental settings for sleeping scenarios. Fig. 25. Mean absolute error of respiration
rate versus the sleeping postures.
in between. We also observe that the mean absolute error at the same distance of 5 m for the NLoS scenarios
is slightly higher than that for the LoS scenarios (0.23 bpm) in Sec. 7.2. This is because the signal reflected off
the human target becomes even weaker after penetrating the wall. We also want to point out that the other two
state-of-the-art systems fail to work in these NLoS scenarios.
7.3.3 Sleeping in Different Postures. We conduct experiments when the subject sleeps in the bed with four different postures, i.e., supine, prone, left and right. Different from the lab-controlled settings in [29, 47] where
the transceivers are placed close at two sides of the bed, we mount the transceivers on the ceiling which is a
deployable setup in real indoor environments, far away from the subject. To make it even more challenging, the
subject is covered with a quilt. As shown in Fig. 24, the antennas of the transceivers are placed horizontally. In
this setting, the LoS path length is 3.9 m and the distance from the subject to the transceivers mounted on the
ceiling is 3.8 m.
Fig. 25 shows the mean absolute error of respiration rate for different sleeping postures. As shown in the
figure, no matter at what posture, the mean absolute error is always less than 0.3 bpm, which demonstrates
the effectiveness and robustness of FarSense. As can be seen, the respiration rate is more accurate in supine
posture than in other postures. We believe this is because when the subject’s chest faces the transceivers in
supine posture, the chest displacement induces larger signal fluctuations and and thus achieves more accurate
estimation.
8 DISCUSSIONS
In this work, we focus on designing a single-person respiration detection system with commodity WiFi devices,
which achieves a much further sensing range than the state-of-the-art WiFi-based systems. We briefly discuss
the limitation and future direction of our work below.
8.1 Through the Wall Twice
FarSense works well when one of the transceivers is in another room. However, when both WiFi transceivers
are located in another room, FarSense has difficulty to sense human respiration because now the weak reflected
signal from the human chest will need to go through the wall twice [1]. A potential solution is to null out the
strong static LoS signal and other reflections as shown in [1] for FMCW radar.
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
FarSense: Pushing the Range Limit of WiFi-based Respiration Sensing with CSI Ratio of… • 121:23
8.2 Multiple Subjects
In real life, there are scenarios when multiple subjects are in the same room, e.g., a couple is sharing a same
bed. It is a well-known challenge to separate the signals reflected off multiple targets and achieve multi-target
sensing with cheap commodity hardware. Basically there are two ways to address the challenging multi-target
sensing issue with WiFi. One is to increase the bandwidth and the other is to increase the number of antennas
at the WiFi transceivers.
For example, with a 40 MHz bandwidth for 802.11n WiFi, the time domain resolution is merely 25 ns. This
means that if the path length difference of two signals is within 7.5 m (25 ns · 3 · 108 m/s), the two signals cannot
be separated in time domain. Fortunately, larger bandwidth is expected in future WiFi standards which can be
utilized to further increase the sensing resolution. As for multi-person respiration sensing, the BBS (Blind Source
Separation) or FFT (Fast Fourier Transformation) techniques could also be utilized to separate a set of source
signals with different frequencies, as demonstrated in [47, 51, 61].
The other possible solution is that we can employ antenna array (multiple antennas) to separate the signals
coming from different directions in space domain. Actually, the proposed CSI-ratio model can be combined with
the multiple-antenna techniques to increase both the sensing range and resolution. On top of the multipleantenna setting, advanced signal processing techniques such as MUSIC (MUltiple SIgnal Classification) and
multi-dimensional information fusion [57] can be utilized to further increase the signal separation resolution.
8.3 Commodity WiFi NICs with Multiple Antennas
In this work, we propose to utilize the ratio of CSI readings from two antennas at the WiFi receiver for respiration
sensing. We implement our FarSense system with commodity Intel 5300 NICs equipped with one antenna at the
transmitter and two antennas at the receiver. Actually, FarSense can work with other multi-antenna commodity
WiFi NICs as long as the NICs can provide us CSI information.
• FarSense does not depend on any specific MIMO mechanism (precoding, beamforming, multiplexing, etc)
to work. The MIMO mechanisms do affect the data transmission but have very little effect on human sensing with CSI. Thus, no matter what MIMO mechanisms are adopted at the WiFi transceivers, FarSense
works as long as the CSI streams from two receiving antennas share the same clock, which is true for current commodity MIMO WiFi NICs. To obtain the CSI data, commodity MIMO WiFi NICs such as Intel 5300
[10] and Atheros AR9580 [58] can be used (with three antennas supported). With more and more wireless
sensing applications proposed, we believe more commodity MIMO WiFi NICs may support exportation of
the CSI information for sensing in the future.
• Assuming that we have M transmitting antennas and N receiving antennas, we are able to obtain MN CSI
readings at each timestamp for every sub-carrier. By selecting one CSI reading as the numerator of CSI
ratio and another one as the denominator, we will get A
2
M N = MN(MN −1) CSI ratios for human sensing.
Since different antenna pairs experience different multipath and environment noise, we can then employ
different pairs of antennas to obtain the CSI ratio and exploit the complementarity of those pairs for better
sensing performance. We plan to explore the MIMO sensing capability using the CSI-ratio model in our
future work.
9 CONCLUSION
Contactless respiration sensing with pervasive WiFi signals is promising for real-life deployment. However, the
small sensing range of existing systems severely limits their application in reality. In this paper, we propose to
employ the ratio of CSI readings from two adjacent antennas to significantly push the sensing range limit from
room level (2-4m) to house level (8-9m). We also propose novel methods to elaborately combine the complementary amplitude and phase for sensing in a much finer-grained way, further improving the sensing accuracy and
Proc. ACM Interact. Mob. Wearable Ubiquitous Technol., Vol. 3, No. 3, Article 121. Publication date: September 2019.
121:24 • Zeng et al.
range. With the proposed methods, for the first time, we are able to enable through-wall respiration sensing
with commodity WiFi hardware. We believe the proposed system greatly reduces the gap between lab prototype
and real-life deployment. In addition, the proposed ratio of CSI readings from two adjacent antennas could be
used as a new base signal in all MIMO devices, which could help to achieve high SNR and benefit a large group
of other sensing applications.