Annealing machines have been developed as non-von Neumann computers aimed at solving combinatorial optimization problems efficiently. To use annealing machines for solving combinatorial optimization problems, we have to represent the objective function and constraints by an Ising model, which is a theoretical model in statistical physics. Further, it is necessary to transform the Ising model according to the hardware limitations. In the transformation, the process of effectively reducing the bit-widths of coefficients in the Ising model has hardly been studied so far. Thus, when we consider the Ising model with a large bit-width, a naive method, which means right bit-shift, has to be applied. Since it is expected that obtaining highly accurate solutions is difficult by the naive method, it is necessary to construct a method for efficiently reducing the bit-width. This article proposes methods for reducing the bit-widths of interaction and external magnetic field coefficients in the Ising model and proves that the reduction gives theoretically the same ground state of the original Ising model. The experimental evaluations also demonstrate the effectiveness of our proposed methods.
SECTION 1Introduction
Combinatorial optimization problems are to find a combination of decision variables optimized under various constraints, such as a graph partitioning problem, a number partitioning problem, and a traveling salesman problem. In general, obtaining an optimal solution from these problems using von Neumann computers may be challenging since these problems have many solutions, including optimal ones and not optimal ones. Non-von Neumann computers called Annealing machines have been developed to challenge these problems, such as quantum annealing machines [1], [2], [3], [4], [5], CMOS Annealing machines [6], [7], [8], Digital Annealers [9], [10], coherent Ising machines [11], [12], and Simulated Bifurcation machine [13].

To utilize the computers developed in those researches, We formulate a combinatorial optimization problem into a theoretical model in statistical mechanics called Ising model [14]. The annealing machines search for the ground state of the Ising model corresponding to the optimal solution of the combinatorial optimization problem, where the ground state refers to as the lowest-energy state. The overview of the Ising model and the ground state of the Ising model are shown in Fig. 1. The Ising model consists of spins, interactions between spins, and external magnetic fields on spins. In Fig. 1, circles, edges (solid lines and dotted lines), and arrows (lines and dotted lines) represent spins, interactions, and external magnetic fields, respectively. Each spin has a value of (+1) or (−1). Fig. 1a shows an initial state of the Ising model before the annealing process, which is not a ground state. Fig. 1b shows the ground state of the Ising model after the annealing process. In the ground state, the energy function given in Eq. (1) is minimized (See Section 2 in detail).


Fig. 1.
An example of an Ising model. The solid lines and solid arrows show the positive coefficients. The dotted lines and dotted arrows show the negative coefficients. (a) The initial state of the Ising model. (b) The ground state of the Ising model after the annealing process.

Show All

The overall flow of solving a combinatorial optimization problem using annealing machines are shown in Fig. 2. The flow consists of the five phases, as follows:

A combinatorial optimization problem is formulated into a logical Ising model consisting of the objective function and the penalty function;


Fig. 2.
Overall flow of solving a combinatorial optimization problem using annealing machines.

Show All

The Ising model formulated in Phase 1 is embedded onto a physical Ising model or a real annealing machine;

An annealing machine searches for the ground state (the lowest-energy state) of the Ising model;

The state of the logical Ising model is restored from the state of the physical Ising model after annealing;

The state of the logical Ising model is interpreted as the solution to the problem.

In Phase 1, a combinatorial optimization problem is formulated into a logical Ising model consisting of interactions between any pairs of spins, i.e., we assume a fully-connected Ising model. Every interaction and external magnetic field of a logical Ising model takes any value. Phase 1 itself is a very challenging task. However, the Ising model or quadratic unconstrained binary optimization (QUBO) model formulations targeted for practical combinatorial optimization problems have been proposed [15], [16], [17], [18], [19]. Especially, PyQUBO is a software package that supports these formulations [19]. Also, the method to determine the hyper-parameters used in the formulations has been proposed [20]. In Phase 2, a logical Ising model is embedded onto a physical Ising model (or a real annealing machine). The physical Ising model differs from the logical Ising model in that it has a specific topology in connecting spins and takes a numerical range, which is called bit-width, for interaction and external magnetic field coefficients. A specific topology and a numerical range depend on individual real annealing machines (details are described in Section 2.2). Thus, we need to consider the topology transformation and the coefficient transformation when a logical Ising model is embedded onto a physical Ising model. The topology transformation methods have been proposed against D-Wave [2], [21], [22], [23], [24], [25], [26], and CMOS Annealing machine (v1) [27], and any topologies [28]. The number of total spins used is also limited in a physical Ising model. The method in [29] has been proposed for annealing using the limited number of spins. As far as we know, there have been no efficient bit-width coefficient transformation methods proposed so far. In Phase 3, the ground state of the physical Ising model is searched by an annealing machine. Software packages to use real annealing machines are also developed [30], [31]. In Phase 4, the state of the logical Ising model is restored from the result of the annealed physical Ising model since the spins may be duplicated by the embedding method. In Ref. [27], a majority vote is employed. In Phase 5, the state of the logical Ising model is interpreted as the solution to the problem. The interpretation method satisfying the constraints of a combinatorial optimization problem has been proposed [18].

Based on this discussion, we propose embedding methods that transform not bit-width limited coefficients into bit-width limited coefficients. The proposed methods transform the coefficients and theoretically reduce their bit-widths by adding auxiliary spins. The ground states of the original Ising model and the Ising model to which auxiliary spins are added are the same.

The main contributions of this paper are summarized in:

We propose embedding methods for reducing the bit-widths of interaction and external magnetic field coefficients in the Ising model by adding auxiliary spins.

The mathematical proof shows that the ground states of the Ising model obtained by our proposed methods are exactly the same as the ground states of the original Ising model. This is the world-first proposal to reduce the bit-widths of interaction and external magnetic field coefficients theoretically.

Experimental evaluations using a real Ising machine for typical combinatorial problems confirm that our proposed methods successfully obtain the ground states equal to the original ones.

The rest of this paper is organized as follows: Section 2 introduces the backgrounds and motivation; Section 3 first formulates the bit-width reduction and explains the naive method which reduces the bit-width of the Ising model; Section 4 proposes the bit-width reduction methods of the Ising model; Section 5 demonstrates the experimental results; Section 6 gives our conclusions.

SECTION 2Background
2.1 Ising Model
An Ising model is a statistical mechanics model defined on an undirected graph G=(V,E), where V is the set of vertices, and E is the set of edges. The Ising model consists of spins, interactions, and external magnetic fields. Spin σi is defined on vertex i∈V and has either (+1) or (−1) (or states up/down). Interaction Ji,j is defined on edges (i,j)∈E which shows the weight of connection of σi and σj. External magnetic field hi is defined on vertex i∈V which shows the force on the spin σi. The energy function (or Hamiltonian) H of an Ising model is given by:
H=−∑(i,j)∈EJi,jσiσj−∑i∈Vhiσi+const,(1)
View Sourcewhere const is a constant value which does not depend on spins. In this paper, we assume Ji,j and hi are integers.

An Ising model shown in Eq. (1) has the following properties. If the interaction has a positive value, the spins connected to it tend to have the same values. If it has a negative value, the spins connected to it tend to have different values. Every spin has an external magnetic field value. If it is positive, the spin tends to have (+1). If it is negative, the spin tends to have (−1).

Annealing machines search for the ground state of an Ising model by updating the values (states) of spins. The ground state energy refers to as the minimum value of H. When a combinatorial optimization problem is solved using an annealing machine, the optimal solution of the problem is assigned to the ground state of its Ising model.

2.2 Annealing Machine
Annealing machines (or Ising machines) have been developed to solve combinatorial optimization problems as non-von Neumann computers. Annealing machines search for the ground state of the Ising model or quadratic unconstrained binary optimization (QUBO) model. A QUBO model has binary values (1 or 0) instead of spins and is equivalent to an Ising model [15], [16], [19].

The D-Wave quantum annealing (QA) machine [1], [2], [3] has superconducting quantum interference device (SQUID) and works at a low temperature of milli-Kelvin order. The machine has a range of real numbers, [−1,1] as interactions and [−2,2] as external magnetic fields, instead of the bit-width [32]. Note that, these coefficients can be tuned with a binning precision of 0.001 [33]. Complementary metal-oxide-semiconductor (CMOS) Annealing machines (v1 [6], v2 [7], and v3 [8]) are implemented on field-programmable gate array (FPGA). The CMOS Annealing machines (v1 and v2) utilize a simulated annealing (SA) method [34]. The CMOS Annealing machine (v3) utilizes a simulated quantum annealing (SQA) method based on a path integral quantum Monte Carlo method [35]. Coherent Ising machine (CIM) [11], [12] calculates the ground state of an Ising model using a degenerated optical parametric oscillator. Simulated Bifurcation (SB) machine [13] is based on adiabatic and chaotic (or ergodic) evolutions of nonlinear Hamiltonian systems. SB machine is implemented on a graphics processing unit (GPU). Digital Annealers (DAs) [9], [10] are implemented on CMOS hardware. DAs utilize an SA method and a parallel tempering (PT) method [36]. The summary of annealing machines is shown in Table 1. In Table 1, “Signed bit-width” represents the bit-width of integers with the sign bit, i.e., 2-bits show −1, 0, or +1 and 8-bits show [−127,127]. In this paper, we assume that an integer has a specified sign bit and hence changing the sign of an integer does not change its bit width. We also assume that an n-bit integer shows any number in [−(2n−1−1),2n−1−1] as above.

TABLE 1 The Summary of Annealing Machines

As another type of an annealing machine, quantum annealing machine for prime factoring has been developed [4], [5]. The quantum annealing machine employs an application-specific annealing computing (ASAC) architecture to reduce the hardware overhead and the cost and time for development.

2.3 Motivation
As summarized in Table 1, each annealing machine differs in the bit-widths of coefficients, the size of spins, and implementation. Annealing machines can be classified into those implemented with digital circuits (FPGA or GPU) and analog circuits (SQUID or Laser). Now, we focus on the coefficient bit-width of each machine. The bit-widths of coefficients are limited in digital annealing machines, which depend on the implementation method. Thus, users cannot embed the logical Ising model, when its bit-width exceed those of the physical Ising model. By contrast, analog annealing machines can take scalable bit-width; namely, the machines have a dynamic range. For example, D-Wave 2000Q can take any real numbers in [−1,1] as interactions and any real numbers in [−2,2] as external magnetic fields in an ideal case. In D-Wave 2000Q, when we embed the interactions of (+1), (+2), and (+63), the normalized values become 0.016, and 0.032, and 1, respectively, which means that it equivalently represents 7-bit width including a sign bit in this case. The numerical range of the physical Ising model can be equivalent to the numerical range of the logical Ising model since the physical Ising model's coefficients are normalized from the logical Ising model's coefficients. However, the actual machines using quantum effect are susceptible to errors due to decoherence, control errors, diabatic transitions, and thermal noises [24], [37], [38], [39], [40], [41]. As pointed out in Refs. [33], [41], [42], [43], D-Wave 2000Q is affected by noise. In Refs. [41], [43], the control noise is assumed to be the Gaussian distribution with zero mean and standard deviation η=0.015. Thus, the magnitude relationship of small interactions can be broken by the influence of noises.

From the above discussion, users cannot change the bit-widths of coefficients implemented in annealing machines. Therefore, a method is necessary to solve the bit-width limitation. In this paper, we focus on the bit-widths of the coefficients and propose the bit-width reduction methods to convert the original Ising model to a transformed one equivalently.

SECTION 3Problem Formulation and Naive Method
To use annealing machines, we need to transform a logical Ising model into a physical Ising model, as described in Sections 1 and 2. In the physical Ising model, the bit-widths of the interactions and external magnetic fields are limited. In this section, we formulate the bit-width reduction problem and discuss how to reduce the bit-widths of the logical Ising model.

3.1 Formulation of Bit-Width Reduction Problem
We formulate the bit-width reduction problem of an Ising model. Input and output are shown as follows: Input

Ising model defined on G=(V,E)

The interaction and external magnetic field coefficients are defined as: wV:V→Z and wE:E→Z∖{0}. wV(i) is the coefficient of the external magnetic field on vertex i. wE(i,j) is the coefficient of the interaction on edge (i,j).

Upper and lower limits of the coefficients of the target machine

Let rupperV and rlowerV be upper and lower limits of external magnetic field coefficients, respectively. Let rupperE and rlowerE be upper and lower limits of interaction coefficients, respectively. For example, in [8], upper and lower limits of the coefficients are: rlowerV=−127, rupperV=+127, rlowerE=−127, and rupperE=+127. In this paper, we assume: rupperV, rupperE>0 and rlowerV, rlowerE<0.

Output

A new Ising model defined on G′=(V′,E′)

The new interaction and external magnetic field coefficients are defined as the following functions: w′V′:V′→[rlowerV,rupperV]∈Z and w′E′:E′→[rlowerE,rupperE]∖{0}∈Z.

3.2 Naive Bit-Width Reduction Method
We first introduce a naive bit-width reduction method to solve the bit-width reduction problem. When the coefficients of a logical Ising model exceed the range of coefficients of the physical Ising model or annealing machine, all coefficients are divided by a power of two, which means right bit-shift. This method, which we call shift method, is shown in Algorithm 1. We assume that the annealing machines can handle only integer values as described in Section 2.1. Thus, decimal values are rounded. In Algorithm 1, borg shows the original bit-width, which can represent any wV(i) and wE(i,j) for an edge (i,j) and vertex i in G. bdst shows the target bit-width, similarly.

An example of applying Algorithm 1 to Fig. 1a is shown in Fig. 3. The bit-width of the Ising model depicted in Fig. 1a is 4 and it to 3-bits and 2-bits. Figs. 3a and 3b show the Ising models whose bit-width is reduced from 4-bits to 3-bits and 2-bits, respectively.


Fig. 3.
The Ising models obtained by applying the shift method to the Ising model depicted in Fig. 1a (Algorithm 1). The solid lines and solid arrows show positive coefficients. The dotted lines and dotted arrows show the negative coefficients. (a) The Ising model whose bit-width of coefficient is reduced from 4-bits to 3-bits. (b) The Ising model whose bit-width of coefficient is reduced from 4-bits to 2-bits.

Show All

3.3 Disadvantages of the Shift Method
The shift method described in Section 3.2 can naively reduce the bit-width of the coefficients. However, the ground states of the Ising model, which is obtained by reducing the bit-width by this method may differ from the original ground states.

For example, the ground state of the original Ising model shown in Fig. 1a is (σ1,σ2,σ3,σ4,σ5)=(−1,−1,−1,−1,+1) as shown in Fig. 1b. Fig. 4a shows the relationship between the energies of the model and states. In Fig. 4a, the horizontal axis shows the binary representation of all the spins. If the state of the five spins is (−1,−1,−1,−1,−1), its binary representation is 00000. If the state is (−1,−1,−1,−1,+1), its binary representation is 10000. The vertical axis shows the energies in Eq. (1). The red horizontal line shows the energy of ground state, i.e., the minimum value of Eq. (1) for Fig. 1a.

Algorithm 1. Shift Method
Input: G=(V,E),wV,wE,borg,bdst

Output: G′=(V′,E′),w′V,w′E

d←2(borg−bdst)

V′←V

E′←E

for v in V′ do

if wV(v)>0 then

w′V(v)←max(⌊wV(v)d⌋,1)

else

w′V(v)←min(⌈wV(v)d⌉,−1)

end if

end for

for e in E′ do

if wE(e)>0 then

w′E(e)←max(⌊wE(e)d⌋,1)

else

w′E(e)←min(⌈wE(e)d⌉,−1)

end if

end for


Fig. 4.
The relationship between spin states of the Ising models and energies. The state of spins on the horizontal axis is expressed in binary representation of all the spins. (a) Energy of original Ising model corresponding to Fig. 1a. (b) Energy of Ising model reducing 1-bit corresponding Fig. 3a. (c) Energy of original Ising model reducing 2-bits corresponding to Fig. 3a.

Show All

On the other hand, the ground states of the Ising model of Fig. Fig. 3a, which is obtained by reducing 1-bit from the original Ising model by using the shift method, become (σ1,σ2,σ3,σ4,σ5)=(−1,−1,−1,−1,+1) and (σ1,σ2,σ3,σ4,σ5)=(−1,−1,−1,−1,−1). Fig. 4a shows the relationship between the energies of the model and states. The Ising model of Fig. 3a has two ground states.

Furthermore, the ground state of the Ising model of Fig. 3b, which is obtained by reducing 2-bits from the original Ising model by using the shift method, becomes (σ1,σ2,σ3,σ4,σ5)=(−1,+1,−1,−1,−1). Fig. 4c shows the relationship between the energies of the model and states. The Ising model of Fig. 3b has one ground state but it is different from the ground state of Fig. 1a. In all the cases, the relationship between states and energies for Figs. 3a and 3b is much different from that of Fig. 1a.

As mentioned above, we cannot obtain the original ground states from the Ising model in which its bit-width is reduced by the shift method. When we apply the method to the combinatorial optimization problem, we cannot obtain an optimal or quasi-optimal solution since the method may change the ground states from the original ones. We have to develop a bit-width reduction method so that the ground states do not change at all.

SECTION 4Proposed bit-Width Reduction Methods
In this section, we propose methods which reduce the bit-widths of interactions and external magnetic fields of the logical Ising model by adding auxiliary spins. The coefficients of interactions or external magnetic fields are partitioned into smaller bit-width coefficients by using the proposed methods. Further, the proposed methods do not change the ground state of the original Ising model.

4.1 The Method Extending Interactions
Before we propose the method which reduces the bit-widths of interactions of the logical Ising model, we propose a method which extends interactions of the Ising model by adding auxiliary spins.

We assume that two spins σi and σj are connected by the interaction Ji,j. In other words, the graph G =(V,E) which defines the Ising model includes the vertices i and j in V, the edge (i,j) in E, and wE(i,j)=Ji,j. The method extends the interaction Ji,j by adding the auxiliary spin σx as follows:

A new vertex x is added to V.

Edges (i,x) and (j,x) are added to E. Then, wE(i,x) is set to be Ji,j and wE(j,x) is set to be |Ji,j|.

The edge (i,j) is removed from E.

The method is shown in Fig. 5. By applying the proposed method to the Ising model as depicted in the top of Fig. 5, we obtain the extended Ising model as depicted in the bottom of Fig. 5. The energies in all states of the Ising models in Fig. 5 are shown in Table 2 assuming Ji,j>0. In Table 2, “Original” means the energies before applying the method to the Ising model, as shown in the top of Fig. 5 and “Extended” means the energies after applying the method to the Ising model as shown in the bottom of Fig. 5.

TABLE 2 The Energies in all States of Fig. 5 (Ji,j>0)(Ji,j>0)


Fig. 5.
An example of extending an interaction.

Show All

Let us consider a certain state, e.g. σi=1 and σj=1. We have the energy of −Ji,j in “Original” in this case. When we see “Extended”, we have the energies of −2Ji,j and +2Ji,j. When we pick up the lower one, (−2Ji,j) in this case, the difference between them becomes |Ji,j|. Similarly, when we consider the state of σi=−1 and σj=−1, the energy difference between “Original” and the lower one in “Extended” becomes |Ji,j|. This is true when we pick up any state in Table 2.

We can generalize the above property as follows:

Theorem 1.
Assuming that the auxiliary spin added by the method above takes the value which minimizes the energy function in Eq. (1), the energy difference between the original Ising model and the extended Ising model is always |Ji,j|.

Proof 1.
Let H1 be the energy of the Ising model model1, in which two spins σi and σj are connected by an interaction Ji,j. H1 is represented by
H1=−Ji,jσiσj+Hother,(2)
View SourceRight-click on figure for MathML and additional features.where Hother is the energy of the Ising model independent of the interaction Ji,j. Let model′1 be the Ising model in which the interaction Ji,j of model1 is extended by adding the auxiliary spin σx by using the method above and let H′1 be the energy of model′1.

When Ji,j>0, H′1 is represented by
H′1=−Ji,jσiσx−Ji,jσjσx+Hother=−Ji,jσx(σi+σj)+Hother.(3)
View SourceNow, σx takes 1 or −1. If σx is determined so that H′1 is minimized, Eq. (3) is represented by
H′1=−Ji,j|σi+σj|+Hother=−Ji,j(1+σiσj)+Hother=−Ji,jσiσj−Ji,j+Hother.(4)
View SourceThen the difference between Eqs. (2) and (4) becomes |Ji,j|.

When Ji,j<0, H′1 is represented by
H′1=−Ji,jσiσx+Ji,jσjσx+Hother=−Ji,jσx(σi−σj)+Hother.(5)
View SourceIf σx is determined so that H′1 is minimized, Eq. (5) is represented by
H′1=Ji,j|σi−σj|+Hother=Ji,j(1−σiσj)+Hother=−Ji,jσiσj+Ji,j+Hother.(6)
View SourceThen the difference between Eqs. (2) and (6) becomes |Ji,j|.

We further have the following theorem:

Theorem 2.
Let model1 be the original Ising model in which two spins σi and σj are connected by the interaction Ji,j. Let model′1 be the extended Ising model by using the method above. When the spins of model′1 give the ground state, the spins in model1 corresponding to those in model′1 give also the ground state in model1.

Proof 2.
According to Theorem 1, the energy difference between model1 and model′1 is always |Ji,j| when the value of the auxiliary spin added by the method above is determined so that the energy is minimized in model′1. Since the energy is minimized in model′1 in the ground state, the energy difference between model1 and model′1 must be |Ji,j| in the ground state. The value of |Ji,j| is independent of spin states and hence the spins in model1 corresponding to those in model′1 give also the ground state in model1.

Theorem 2 indicates that, if we add an auxiliary spin by using the above method, the same ground state can be obtained theoretically when we focus on the original spins.

4.2 The Method Reducing Bit-Width of Interactions
In an Ising model, we can clearly partition any interaction Ji,j into two interactions J′i,j and J′′i,j, both of which connect spins σi and σj so that Ji,j=J′i,j+J′′i,j. Then, we apply the method described in Section 4.1 to one interaction. The scheme is shown in Fig. 6. The Ising model at the top of Fig. 6 takes the lowest energy when σi=σj according to Eq. (1). Similarly, the Ising model at the bottom of Fig. 6 takes the lowest energy when σi=σj=σx according to Eq. (1). That is, if an interaction with a certain bit-width can be partitioned into several interactions with a smaller bit-width, we can reduce the bit-width of the interaction.


Fig. 6.
An example of partitioning an interaction.

Show All

We describe that the bit-width of an n-bit original interaction, Ji,j, is reduced from n-bits to (n−1)-bits. The method is shown as follows:

Ji,j is partitioned into J′i,j=⌊Ji,j/2⌋ when Ji,j>0 or J′i,j=⌈Ji,j/2⌉ when Ji,j<0 and J′′i,j=Ji,j−J′i,j.

J′i,j is extended by applying the method in Section 4.1 so that the Ising model can have only one interaction connecting two spins.

If J′i,j or J′′i,j still requires n-bits, repeat Step 1 and Step 2 until all the interactions have (n−1)-bits.

For example, when the coefficient of the original interaction is Ji,j=+6 (4-bits including a sign bit), we can reduce its bit-width by partitioning it into J′i,j=+3 and J′′i,j=+3, both of which require just 3-bits. When the coefficient of the original interaction is Ji,j=+7 (4-bits), we first partition it into J′i,j=+3 (3-bits) and J′′i,j=+4 (4-bits). After that, J′′i,j=+4 is further partitioned into +2 (3-bits) and +2 (3-bits). In other words, by adding two auxiliary spins into the original Ising model, we can reduce the bit-width of the interaction by 1-bit. As above, we can reduce the bit-width of any interaction by 1-bit.

By repeating this process, we can reduce the bit-width of any interaction by k-bits (2≤k<n−1). Based on Theorem 2, the method above does not change the original ground state, even if bit-widths of interactions are reduced.

4.3 The Method Reducing Bit-Width of External Magnetic Fields
We propose a method which reduces bit-widths of external magnetic fields of the logical Ising model. The bit-width is reduced by adding auxiliary spins as in Section 4.2. We assume that an Ising model includes an external magnetic field hi acting on a spin σi. In other words, the graph G=(V,E) which defines the Ising model includes the vertex i in V and wV(i)=hi. The method reduces the bit-width of the external magnetic field hi by adding the auxiliary spin σx as follows:

A new vertex x is added in V. Then, wV(i) is set to be h′i and wV(x) is set to be hx so that hi=h′i+hx.

Edge (i,x) is added in E. Then, wE(i,x) is set to be |hx|.

The method is shown in Fig. 7. By applying the proposed method to the Ising model as depicted in the left of Fig. 7, we obtain the extended Ising model as depicted in the right of Fig. 7. The energies in all states of the Ising models in Fig. 7 are shown in Table 3 assuming hx>0. In Table 3, “Original” means the energies before applying the method to the Ising model, as shown in the left of Fig. 7 and “Extended” means the energies after applying the method to the Ising model as shown in the right of Fig. 7.

TABLE 3 The Energies in all States of Fig. 7 (hx>0)(hx>0)


Fig. 7.
An example of partitioning an external magnetic field.

Show All

Let us consider a certain state, e.g. σi=1. We have the energy of −hi in “Original” in this case. When we see “Extended”, we have the energies of −hi−hx and −hi+3hx. When we pick up the lower one, (−hi−hx) in this case, the difference between them becomes |hx|. When we consider the state of σi=−1, the energy difference between “Original” and the lower one in “Extended” becomes |hx|. The strategy is the same as the discussion in Section 4.2.

We can generalize the above property as follows:

Theorem 3.
Assuming that the auxiliary spin added by the method above takes the value which minimizes the energy function in Eq. (1), the energy difference between the original Ising model and the extended Ising model is always |hx|.

Proof 3.
Let H2 be the energy of the Ising model model2, in which an external magnetic field hi acting on a spin σi is included. H2 is represented by
H2=−hiσi+Hother,(7)
View Sourcewhere Hother is the energy of the Ising model independent of the external magnetic field hi. Let model′2 be the Ising model in which a spin σx is added by the above method and let H′2 be the energy of model′2.

When hi>0, H′2 is represented by
H′2=−h′iσi−hxσx−hiσiσx+Hother=−h′iσi−hxσx(1+σi)+Hother,(8)
View Sourcewhere (1+σi) is always non-negative since σi takes either (+1) or (−1). When σx=1, H′2 is minimized and Eq. (8) is represented by
H′2=−h′iσi−hx(1+σi)+Hother=−(h′i+hx)σi−hx+Hother.(9)
View SourceSince h′i+hx=hi, Eq. (9) is represented by
H′2=−hiσi−hx+Hother.(10)
View SourceThen the difference between Eqs. (7) and (10) becomes |hx|.

When hi<0, H′2 is represented by
H′2=−h′iσi−hxσx+hiσiσx+Hother=−h′iσi−hxσx(1−σi)+Hother,(11)
View Sourcewhere (1−σi) is always non-negative since a spin takes either (+1) or (−1). When σx=−1, H′2 is minimized and Eq. (11) is represented by
H′2=−h′iσi+hx(1−σi)+Hother=−(h′i+hx)σi+hx+Hother.(12)
View SourceSince h′i+hx=hi, Eq. (12) is represented by
H′2=−hiσi+hx+Hother(13)
View SourceThen the difference between Eqs. (7) and (13) becomes |hx|.

We further have the following theorem:

Theorem 4.
Let model2 be the original Ising model, in which an external magnetic field hi acting on a spin σi is included. Let model′2 be the extended Ising model by using the method above. When the spins of model′2 give the ground state, the spins in model2 corresponding to those in model′2 give also the ground state in model2.

Proof 4.
According to Theorem 3, the energy difference between model2 and model′2 is always |hx| when the value of the auxiliary spin added by the method above is determined so that the energy is minimized in model′2. Since the energy is minimized in model′2 in the ground state, the energy difference between model2 and model′2 must be |hx| in the ground state. The value of |hx| is independent of spin states and hence the spins in model2 corresponding to those in model′2 give also the ground state in model2.

Theorem 4 indicates that, if we add an auxiliary spin and edge by using the above method, the same ground state can be obtained theoretically when we focus on the original spins. By using the proposed method, we can obtain smaller bit-width magnetic fields and smaller interaction coefficients compared to the original Ising model.

4.4 Comparing the Extended Methods to the Shift Method
In this subsection, we compare the bit-width reduction methods described in Sections 4.2 and 4.3, and the shift method described in Section 3.2. In the above subsections, we prove that the ground states of the extended Ising model obtained by applying the proposed methods give the ground states of the original Ising model. As an example, the original Ising model and the extended Ising model obtained by applying the shift method and our proposed methods are shown in Figs. 8a, 8b, and 8c, respectively. In this case, we try to reduce 3-bit coefficients to 2-bits. The ground states of the Ising models in Fig. 8 are shown in Table 4.

TABLE 4 The Ground States of Ising Models in Fig. 8


Fig. 8.
Comparison between the shift method and the proposed methods. (a) The original Ising model. (b) The Ising model obtained by applying the shift method in Algorithm 1. (c) The Ising model obtained by applying the proposed methods.

Show All

In Fig. 8b, the coefficients are reduced to 1 or −1 by Algorithm 1. The ground states of the Ising model shown in Fig. 8b include the ground state of the Ising model shown in Fig. 8a, nevertheless the numbers of the ground states do not match. In Fig. 8c, the coefficients are reduced to 1 or −1 by the proposed methods described in Sections 4.2 and 4.3. The solid lines and dotted lines mean +1 and −1, respectively, in Fig. 8c. (a1,a2,…,a6) represent auxiliary spins added by the proposed methods. The ground state of the spins except for ai (i=1,2,…,6) in Fig. 8c is equal to the ground state (σ1,σ2,σ3,σ4)=(1,1,1,1) in Fig. 8a, and the number of ground states matches.

By using the proposed methods, the bit-width can be reduced without changing the ground states. However, the number of spins in the Ising model increases by using the proposed methods.

We formulate the number of increased spins by using the proposed method as follows. Let Ji,j and hi be the coefficients of the interaction and the external magnetic field, both of which are represented by n-bits including the sign bit. Consider that Ji,j is reduced by 1-bit (n−1≥2) by using the proposed methods. We assume that a signed (n−1)-bit integer shows any number in [−(2n−2−1),2n−2−1], as discussed in Section 2.2. Then the number si,j of the increase in spins in this case by using the proposed method is clearly represented by:
si,j=⌈|Ji,j|2n−2−1⌉−1.(14)
View SourceWhen hi is reduced by 1-bit (n−1≥2) by using the proposed method, the number si of the increase in spins is represented by:
si=⌈|hi|2n−2−1⌉−1.(15)
View SourceFrom Eqs. (14) and (15), when the Ising model whose bit-width is represented by n-bits is reduced by 1-bit (n−1≥2) by using the proposed methods, the number s of the increase in spins is represented by:
s=∑(i,j)∈Esi,j+∑i∈Vsi.(16)
View SourceIn Fig. 8c, we obtain s=6 by Eq. (16), i.e., the number of spins in the original Ising model increases by 6.

SECTION 5Experimental Evaluations
We evaluate our proposed methods by obtaining the ground states of random Ising models and solving two combinatorial optimization problems. In this section, we describe two combinatorial optimization problems used and demonstrate the results of the evaluation. We have implemented the combinatorial optimization problems, the naive method, and our proposed methods in Python3 language on macOS 10.15 and Intel Xeon CPU W-2191B 2.30 GHz × 18 machine with 128 GB memory.

5.1 Random Ising Models and Combinatorial Optimization Problems
We apply our proposed methods to random Ising models and two combinatorial optimization problems. The two combinatorial optimization problems used here are formulated into Ising models for using an annealing machine.

5.1.1 Random Ising Models
Random Ising models are generated as follows: We randomly generate vertices and edges for Ising models. The number of vertices ranges from 5 to 20, and the edge density is set to around 1.0. The interaction and the external magnetic field coefficients are randomly generated, such that their values take a uniform distribution of the given bit-width. The bit-width ranges from 4-bits to 10-bits (see Tables 6 and 9 later in detail). Each Ising model generated here is a connected graph.

TABLE 5 DA Parameters

TABLE 6 The Number of Spins When the Bit-Width is Reduced by the Proposed Methods in Random Ising Models

TABLE 7 The Number of Spins When the Bit-Width is Reduced by the Proposed Methods in NPPs

TABLE 8 The Number of Spins When the Bit-Width is Reduced by the Proposed Methods in VCPs
Table 8- 
The Number of Spins When the Bit-Width is Reduced by the Proposed Methods in VCPs
TABLE 9 The Result of Applying the Naive Method to the Random Ising Models
Table 9- 
The Result of Applying the Naive Method to the Random Ising Models
5.1.2 Number Partition Problem
The number partition problem (NPP) judges whether the sums of two disjoint subsets partitioning a set of N positive numbers (M={m1,m2,…,mN}) are the same or not [15]. For example, given M={1,2,4,7} as the set of 4 positive numbers, we can partition it into two disjoint subsets M1={1,2,4} and M2={7}, in which the sum of each subset is the same. This problem is known to be NP-complete [44].

We prepare N (=|M|) spins. The problem is formulated into the Ising model as follows:
HNPP=(∑i=1Nmiσi)2,(17)
View Sourcewhere σi (1≤i≤N) represents
σi={1mi is assigned to a subset M1,−1mi is assigned to a subset M2.(18)
View SourceIn Eq. (17), the lowest value of HNPP becomes zero. When HNPP is zero, the set of positive numbers can be partitioned into two disjoint subsets, in which the sum of each subset is the same.

An example of the Ising model formulation of NPP is shown in Fig. 9. The set of positive numbers M is {1,2,4,7}. A spin σi (1≤i≤4) represents mi (1≤i≤4). An interaction Ji,j of the Ising model is 2mimj. In Fig. 9, M is partitioned into two subset M1={1,2,4} and M2={7}. When σ1=σ2=σ3=1 and σ4=−1 or σ1=σ2=σ3=−1 and σ4=1, HNPP takes the minimum energy.


Fig. 9.
An Ising model of NPP and the ground states.

Show All

5.1.3 Vertex Cover Problem
A vertex cover of an undirected graph G=(V,E) is a subset V′ ⊆V which includes at least one of vertices that constitute every edge in E. The vertex cover problem (VCP) is to find the smallest size of V′ [15]. An example of a vertex cover problem is shown in Fig. 10. In Fig. 10, the graph has 8 vertices and 16 edges. The vertices, including a vertex cover of the graph, are represented by the orange circles. The smallest size of V′ is 5 and includes the vertices 1, 3, 4, 6, and the vertex 7 or 2, 4, 5, 7, and 8 in Fig. 10. The problem is known to be NP-hard [44].


Fig. 10.
An example of VCP and the optimal solutions.

Show All

We prepare N (=|V|) spins. The problem is formulated into the Ising model as follows:
HVCP=αVCP∑(i,j)∈E(1−σi)(1−σj)+βVCP∑i∈Vσi,(19)
View Sourcewhere αVCP and βVCP are positive weight parameters and σi (1≤i≤N) represents
σi={1−1Vertex i∈V is in V′,Vertex i∈V is not in V′.(20)
View SourceThe first term of Eq. (19) means a penalty function. When V′⊆V is a vertex cover of the graph G=(V,E), the first term is zero. In this case, at least one of the vertices which constitute every edge (i,j)∈E is in V′. The second term of Eq. (19) means an objective function. If the set of vertices V′ equals to V, V′ is a vertex cover of the graph G=(V,E). In this case, however, V′ may not be the smallest size. The motivation of VCP is to find the smallest subset of V′. When the size of V′ is the smallest, the second term of Eq. (19) is minimized. When the solution is optimal, the first term is zero, and the second term is minimized. Note that, we should set βVCP≤αVCP to obtain solutions satisfying the constraints called feasible solutions.

5.2 Results of Evaluation
In this subsection, we demonstrate the results of applying the naive method and the proposed methods to the random Ising model and combinatorial optimization problems. The combinatorial optimization problems used are NPP and VCP described in Section 5.1.

5.2.1 Results of the Proposed Methods
We demonstrate the results of applying the proposed methods. We have used DA unit 2 [10] as an annealing machine to confirm that the optimal solution can be obtained. The DA parameters used in the experiment are summarized in Table 5. We have confirmed that an optimal solution can be obtained using DA unit 2 when the spin number is 8192 or less since DA unit 2 has 8192 spins.

The results of applying the proposed methods to random Ising models, NPPs, and VCPs are shown in Tables 6, 7, and 8, respectively. In these tables, “Name” column indicates the problems used in the evaluation experiments. “Bit-width” column indicates the bit-widths of the coefficients of the Ising model. For example, when it is 4-bits, the coefficients range is [−7,7]. “#Spins” columns indicate the number of spins after reducing the bit-width of the original Ising model. The column in which the number of reduction bit is zero means the number of spins of the original Ising model. When “#Spins” column is a blank, the bit-width cannot be reduced any more.

In Table 6, 11 random Ising models are used as described in Section 5.1.1. In Table 7, we define f(i,j) by
f(i,j)=⎧⎩⎨⎪⎪f(i,j−2)+f(i,j−1)i02≤jj=0 or 1others,(21)
View Sourcewhich is the Fibonacci sequence. When a set of N (Nmod3=0 or 2) positive numbers is created based on Eq. (21), NPPs always have solutions which successfully partition the given set of positive numbers. In Table 8, the benchmark graphs are picked up from AG-Monien Graph Collection [45]. We have set αVCP and βVCP to one in all problems.

In all cases, we have obtained the ground states of all problems by brute-force for the original Ising model. For the extended Ising model obtained by the proposed methods, when its spin number is less than 8192, we can successfully obtain its ground states by using the annealing machine [10], which demonstrates that Theorem 2 and Theorem 4 are practically true.

5.2.2 Results of the Naive Method
We demonstrate the results of applying the naive method to random Ising models, NPPs, and VCPs are shown in Tables 9, 10, and 11, respectively. In these tables, “Name” column indicates the problems used in the evaluation experiments. “a”/“b” in “#Ground states by the naive method/ #Original ground states matched” columns means that “a” is the number of ground states of the Ising model whose bit-width is reduced by the naive method and “b” is the number of the ground states that match the original ground states of the original Ising model. In this experiment, we have obtained the ground states of all problems by brute-force.

TABLE 10 The Result of Applying the Naive Method to NPPs
Table 10- 
The Result of Applying the Naive Method to NPPs
TABLE 11 The Result of Applying the Naive Method to VCPs
Table 11- 
The Result of Applying the Naive Method to VCPs
In Table 9, the ground states of each Ising model whose bit-width is reduced to 3-bits (the underlined data in Table 9) by the naive method are almost the same as the ground state of the original Ising model. However, when the bit-width is reduced to 2-bits (the double-underlined data in Table 9), the ground state does not match the original ground state.

In Table 10, The number of the ground states of each Ising model whose bit-width is reduced by the naive method is hardly the same as the number of the ground state of the original Ising model. For example, when the Ising model into which problem #14 is formulated is reduced by 3-bits, we cannot obtain the solution of NPP. In all problems, when the bit-width is reduced to 2-bits (the underlined data in Table 10), the number of the ground states of each Ising model whose bit-width is reduced by the naive method is much more than the number of the original ground state matched. Thus, we hardly obtain the optimal solution of NPP in this case.

In Table 11, when the number of the vertexes is less than 15, the result in which “#Ground states by the naive method/#Original ground states matched” is 0 is equal to the result in which “#Ground states by the naive method/#Original ground states matched” is 1. However, when the size of the graph increases, the number of ground states does not match the number of the ground state of the original Ising model. In “bfly 1”, when we reduce the coefficient bit-width only by 1-bit by using the naive method, we cannot obtain the optimal solution in VCP at all.

SECTION 6Conclusion
To solve a combinatorial optimization problem using real annealing machines, the method which embeds a logical Ising model into a physical Ising model is indispensable. For that purpose, the topology transformation and the bit-width coefficient transformation are required.

In this paper, we proposed embedding methods that transform not bit-width limited coefficients into bit-width limited coefficients. The proposed methods reduce the coefficient bit-widths by adding auxiliary spins. The mathematical proof shows that the ground state of the Ising model obtained by our proposed methods gives the ground state of the original Ising model. Experimental results show that the optimal solution of the combinatorial optimization problem can be obtained even if the coefficient bit-width of the Ising model is reduced by the proposed methods.

As a future work, we challenge an embedding method that combines the topology transformation and the proposed methods.