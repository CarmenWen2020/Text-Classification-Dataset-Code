Emotions are time varying affective phenomena that are elicited as a result of stimuli. Videos and movies in particular are made to elicit emotions in their audiences. Detecting the viewers' emotions instantaneously can be used to find the emotional traces of videos. In this paper, we present our approach in instantaneously detecting the emotions of video viewers' emotions from electroencephalogram (EEG) signals and facial expressions. A set of emotion inducing videos were shown to participants while their facial expressions and physiological responses were recorded. The expressed valence (negative to positive emotions) in the videos of participants' faces were annotated by five annotators. The stimuli videos were also continuously annotated on valence and arousal dimensions. Long-short-term-memory recurrent neural networks (LSTM-RNN) and continuous conditional random fields (CCRF) were utilized in detecting emotions automatically and continuously. We found the results from facial expressions to be superior to the results from EEG signals. We analyzed the effect of the contamination of facial muscle activities on EEG signals and found that most of the emotionally valuable content in EEG features are as a result of this contamination. However, our statistical analysis showed that EEG signals still carry complementary information in presence of facial expressions.

SECTION 1Introduction
Video is a form of visual art that conveys emotions in its content. Depending on users’ mood and the context they are in, they prefer different type of emotional content, for example, users in negative mood are more likely to prefer a sad stimulus [1]. Affective characterization in multimedia can be used to improve multimedia retrieval and recommendation [2]. Emotion detection is an effective way to unobtrusively identify emotional traces of videos or other content without interrupting viewers. The collected emotional trace is more reliable since we do not have to rely on emotional self-reports that can be influenced by different social and personality factors, e.g., male participants are less likely to report fear. The focus of this paper is on continuous emotion recognition in response to videos and the cross-modality interference between EEG signals and facial expressions. Emotional highlights of video can be detected based on the emotions expressed by viewers. The moments in which emotions are expressed will build an emotional profile or trace with applications in video summarization, video indexing [3] and movie rating estimation [4]. For example, a movie trailer can be built based on the moments which evoke the strongest emotional response in the audiences.

There are three different perspectives dealing with affect in multimedia, namely, expressed emotions, felt emotions and expected emotions [2], [5]. Expressed or intended emotions are the ones that the artist or content creator is intending to elicit in the audience; independent of the fact that the users feel those emotions or not. Expected emotions are the emotions that arise as a result of the content in most of its audience. Felt emotions are the ones that audience individually feel and can be personal.

In this work, our main aim was to detect felt emotions; as we were labeling and detecting expressions and physiological responses. However, we also annotated the videos by the expected emotions and tried to detect the expected emotions from the responses as well.

Psychologists proposed and identified different models for representing emotions [6]. Discrete emotions such as happiness and disgust are easier to understand since they are based on the language. However, they can fall short in expressing certain emotions in different languages, for example, there was no exact translation for disgust in Polish [7]. On the other hand, emotions can be presented in multi-dimensional spaces which are derived based on studies that identified the axes that carry the largest variance of all the possible emotions. Valence, arousal and dominance (VAD) space is one of the most well known dimensional representations of emotions. Valence ranges from unpleasant to pleasant; arousal ranges from calm to activated and can describe emotions intensity; and dominance ranges from not in control to dominant [8]. Given that most of the variance in emotions comes from two dimensions, i.e., arousal and valence, continuous annotation and recognition of emotions are often performed using these dimensions.

The goal of this work was to detect emotions continuously from EEG signals and facial expressions. The utilized data set consists in viewers responses to a set of emotional videos. First, five annotators continuously annotated the emotional responses visible in facial expressions of participants watching videos. We also annotated the stimuli continuously for both valence and arousal to indicate the level of expected arousal and valence with the help of five annotators. The averaged continuous annotations served as the ground truth for our continuous emotion detection system. We analyzed EEG signals and facial expressions of multiple participants and extracted emotional features for continuous emotion detection. Power spectral density (PSD) from EEG signals and facial landmarks were extracted as features. We applied different regression models, including linear regression, support vector regression (SVR), continuous conditional random fields (CCRF) and recurrent neural networks, which has been successfully used in the previous studies [9]. We evaluated the valence detection results in a 10-fold cross validation strategy using averaged correlation coefficients and root-mean-square error (RMSE) metrics.

We performed statistical analyses to identify the relationship between EEG signals and facial expressions. We were particularly interested to identify how much of the emotion detection using EEG signals can be attributed to the electromyogenic artifacts caused by facial expressions. We used a linear mixed-effect model and causality analysis using Granger causality [10] to answer these questions.

The main contributions of this work are as follows. First, we detected continuous valence, in both time and space, using EEG signals and facial expressions. Second, we studied the correlation between the EEG power spectral features and features extracted from facial expressions and continuous valence annotations to look for the possible cross modality effect of muscular electromyogram (EMG) activities. The analysis included Granger causality tests to identify the causality relationship between facial expressions and EEG features. We also performed statistical analyses to verify whether EEG features provide any additional information in presence of features extracted from facial expressions. Finally, we applied the models trained with the continuously annotated data on EEG responses that could not be interpreted due to the lack of facial expressions from the users. We found facial expression analysis in combination with the LSTM-RNN gives the best results for this given task. We also observed that an important part of the affective information in EEG signals is caused by electromyogenic interferences from facial expressions. However, we could not completely rule out the existence of emotion related information in EEG signals independent of facial expression analysis. This paper is an extended version of our previously published work [11]. In comparison to that work, the following analysis and methods are extended and added: (i) we redid and simplified the facial expression analysis which led into improved performance; an extended description of the facial features are also added (ii) we added statistical analysis and discussion on the effect of facial expressions on EEG signals and the band-pass filter (between 4 Hz-45 H) was removed in EEG pre-processing; (iii) an analysis of annotation delay and its effect on performance was added; (iv) different architectures for the long-short-term-memory recurrent neural network (LSTM-RNN) and its parameters were tested; (v) we added the statistical analysis identifying the relationship between affective information in EEG signals and facial expressions and (vi) we annotated the stimuli continuously for both arousal and valence dimensions and reported the results for expected emotional trace detection.

The remaining of this paper is organized as follows. In Section 2, a background on continuous emotion detection and emotion detection from physiological signals is given. The data collection protocols are presented in Section 3. The method for emotion recognition from facial expressions and EEG signals are given in Section 4. An analysis on the correlations between EEG signals and facial expressions and their relationship is given in Section 5. The experimental results are presented in Section 6. Finally, the paper is concluded in Section 7.

SECTION 2Background
2.1 Continuous Emotion Recognition
Wöllmer et al. [12] suggested abandoning the emotional categories in favor of dimensions and applied it on emotion recognition from speech. Nicolaou et al. [13] used audio-visual modalities to detect valence and arousal on SEMAINE database [14]. They used support vector regression and Bidirectional Long-Short-Term-Memory Recurrent Neural Networks (BLSTM-RNN) to detect emotion continuously in time and dimensions. Nicolaou et al. also proposed using an output-associative relevance vector machines (RVM) which smooths the RVM output for continuous emotion detection [15]. Although they showed how it improved the performance of RVM for continuous emotion detection they did not compare its performance directly to the BLSTM recurrent neural network.

One of the major attempts in advancing the state of the art in continuous emotion detection was the audio/visual emotion challenge (AVEC) 2012 [16] which was proposed using SEMAINE database. SEMAINE database includes the audio-visual responses of participants recorded while interacting with the sensitive affective listeners (SAL) agents. The responses were continuously annotated on four dimensions of valence, activation, power, and expectation. The goal of the AVEC 2012 challenge was to detect the continuous dimensional emotions using audio-visual signals. In other notable work, Baltrusaitis et al. [17] used CCRF to jointly detect the emotional dimensions of AVEC 2012 continuous sub-challenge. They achieved superior performance compared to the SVR. For a comprehensive review of continuous emotion detection, we refer the reader to [9].

2.2 Implicit Tagging for Video Tagging and Summarization
Implicit tagging refers to identifying metadata describing the content, including tags and traces, from users’ spontaneous reactions [18].

Movie ratings are indicators of viewers’ desired for watching movies and are often used in recommendation applications. Spontaneous reactions were used to estimate these ratings. In a study on estimating movie ratings [4], galvanic skin responses (GSR) were recorded and analyzed from movie audience. Their method could achieve better results incorporating GSR responses in addition to the demography information for two out of three studied movies. Bao et al. [19] used facial expressions, acoustic, motion and user interaction features captured on mobile phones and tablets to estimate movie ratings. They discovered that the individual responses are too diverse and unreliable to be taken into account and focused on processing the collective responses of the audience. McDuff et al. [20], [21] measured the level of smile from the video advertisement's audience to assess their preference for the content. They collected a large number of samples from users’ webcams who were recruited using crowdsourcing. Ultimately, they were able to detect fairly accurately the desire to watch the video again and whether the viewers liked the videos.

Spontaneous behavioral reactions were also used for video highlight detection. A video highlight detection method was proposed using facial expression analysis [3], [22]. In their study, Joho et al. used a probabilistic emotion recognition from facial expression analysis to detect emotions. Results were reported for 10 participants watching eight video clips. Different features were developed for video highlight detection including expression change rate and pronounce level. Highly expressive emotions including surprise and happiness received high pronounce levels whereas no expression or neutral had low pronounce levels. Physiological linkage between multiple viewers were proposed for video highlight detection by Chênes et al. [23]. Galvanic skin response and skin temperature were the most informative signals in detecting video highlights using physiological linkage. In a more recent study, Fleureau et al. [24] used GSR responses of a group of audience simultaneously to create an emotional trace of movies. The traces generated from the physiological reposes were shown to match the user reported highlight.

Spontaneous reactions can be also translated into affective tags, for example, a sad video. Physiological signals have been used to detect emotions with the goal of implicit emotional tagging. A video affective representation technique through physiological responses was proposed in [25]. In this affective representation study, physiological responses were recorded from eight participants while watched 64 movie scenes. Participants’ self-reported emotion were detected from their physiological responses using a linear regression trained by a relevance vector machine. Kierkels et al. [26] extended these results and analyzed the effectiveness of tags detected by physiological signals for personalized affective tagging of videos. Emotional labels were reconstructed by mapping the quantized arousal and valence values. The videos were ranked for retrieval mapping queries to valence-arousal space. A similar method was developed for emotional characterization of music videos using ridge regression where arousal, valence, dominance, and like/dislike ratings were estimated from the physiological responses and the stimuli content [27] . Koelstra et al. [28] employed central and peripheral physiological signals for emotional tagging of music videos. In a similar study [29] , a multimodal emotional tagging was conducted using EEG signals and pupillary reflex. Abadi et al. [30] recorded and analyzed Magnetoencephalogram (MEG) signals as an alternative to the EEG signals with the ability to monitor brain activities.

SECTION 3Data Set and Annotations
The data set, which was used in this study, is a part of MAHNOB-HCI database, which is a publicly available database for multimedia implicit tagging.1 MAHNOB-HCI database includes recordings from two experiments. The recordings that were used in this paper are from the experiment where we recorded participants’ emotional responses to short videos with the goal of emotional tagging.

3.1 Stimuli Video Clips
We chose 20 videos as emotion evoking stimuli to cover the whole spectrum of emotions. Fourteen out of 20 videos were excerpts from movies and were chosen based on the preliminary study. In the preliminary study, the participants self-reported their felt emotion on nine-point scales, including arousal (ranging from calm to excited/activated) and valence (ranging from unpleasant to pleasant). The initial set of videos in the preliminary study consisted in 155 movie scenes from famous commercial movies, including, “The Pianist”, “Love Actually”, “The Shining”; for the full list of movies from which the scenes were selected we refer the reader to [31]. To facilitate emotional self-assessment SAM manikins were shown above the ratings [32]. Three additional videos, well-known for eliciting certain emotions, e.g., funny, were selected based on authors’ judgment from online resources and were added to this set (two for joy and one for disgust). To have a number of neutral videos, three old weather forecast reports were selected from YouTube. Finally, we selected 20 videos to be shown as stimuli. Video clips were between 34.9 to 117 s long (M=81.4s,SD=22.5s). Psychologists suggested videos from one to ten minutes long for eliciting single emotions [33], [34]. In MAHNOB-HCI data collection, the video clips were kept as short as possible to reduce the chance of co-occurring emotions or habituation to the stimuli [35]. However, the clips were kept long enough to convey the content and elicit the desired emotions.

3.2 Data Collection
Twenty-eight healthy volunteers were recruited on campus, comprising 12 male and 16 female between 19 to 40 years old. Different bodily responses were recorded from the participants watching video clips. EEG signals were acquired from 32 active electrodes on 10-20 international system using a Biosemi Active II system. To capture facial expression, a frontal view video was recorded at 60 frames per second. For a detailed explanation of the synchronization method, hardware setup and the database, we refer the reader to the original database article [31].

A subset of 239 trials (every recorded response of a participant to a video is a trial) containing visible facial expressions was selected to be annotated in this study. A large number of these frontal videos from participant faces do not contain visible facial expressions according to the authors' judgment. The lead author initially annotated all the 540 videos available in this data set and chose the 239 trials that could be further annotated. We then trained five annotators, including the authors and researches from Northeastern University to conduct the continuous annotation from participants’ facial expressions in the laboratory. Valence from the frontal videos were annotated continuously using a software implemented based on FEELTRACE [36] and a joystick. Unlike SEMAINE database [14] where the participants were engaged in a conversation with an agent, in this study, they were quiet and passively watching videos. Hence, the annotators were unable to annotate arousal, power or expectation. An example of the continuous annotations and their averaged curve which served as the ground truth are shown in Fig. 1. We also annotated the 20 stimuli videos by five annotators. We asked the annotators to indicate the level of “expected” valence and arousal for a given video continuously using a joystick.


Fig. 1.
The continuous annotations for one sequence and their averaged curve (the strong red line) are shown.

Show All

We calculated the Cronbach's alpha from the pairwise correlation coefficients to measure the inter-rater agreement for the expression annotations (M=0.53, SD=0.41); 48.7 percent of sequences agreement were above 0.7. This is lower that what is reported for the SEMAINE database [14] which is due to the difference in the nature of the databases and the lack of speech in this database. In the case of stimuli annotations, we again calculated the Cronbach's alpha from the pairwise correlations of the annotations; 50 percent of the sequences’ agreement were above 0.7 for arousal (M=0.58, SD=0.38); and 70 percent of sequences’ agreement were above 0.7 for valence (M=0.64, SD=0.40).

SECTION 4Methods
4.1 EEG Signals
EEG signals were available at 256 Hz sampling rate. EEG signals were re-referenced to the average reference to enhance the signal-to-noise ratio. Average re-referencing is performed when there is no reference electrode by subtracting the average amplitude of EEG signals from all the electrodes from every EEG signal recorded from any electrode. This averaged signal includes noise and artifacts that can be detected on the scalp but are not originated from the brain, e.g., electric potentials from cardiac activities.

The power spectral densities of EEG signals in different bands are correlated with emotions [37]. The power spectral densities were extracted from 1 second time windows with 50 percent overlapping. We used all the 32 electrodes for EEG feature extraction. The logarithms of the PSD from theta (4Hz<f<8Hz), alpha (8Hz<f<12Hz), beta (12Hz<f<30Hz) and gamma (30Hz<f) bands were extracted to serve as features. In total, the number of EEG features of a trial for 32 electrodes and four bands is 32×4=128 features. These features were available at 2 Hz temporal resolution due to the STFT window size (256).

4.2 Analysis of Facial Expressions
A face tracker was employed to track 49 facial fiducial points or landmarks [38] . In this tracker, a regression model is used to detect the landmarks from features. It then calculates translational and scaling difference between the initial and true landmark locations. The main idea for feature tracking is to use supervised descent method (SDM) for the detection in each frame by using the landmark estimate of the previous frame. The model is trained with 66 landmarks, and provides the coordinates of 49 points in its output (see Fig. 2). The facial points were extracted after correcting the head pose. An affine transformation was found between a neutral face of each subject and an averaged face of all the subjects and all the tracked points of sequences were registered using that transformation. A reference point was generated by averaging the coordinates of the inner corners of eyes and nose landmarks. We assumed this reference point to be stationary. The distances of 38 point including eyebrows, eyes, and lips to the reference point were calculated and averaged to be used as features.


Fig. 2.
Examples of the recorded camera view including tracked facial points.

Show All

4.3 Dimensional Affect Detection
Four commonly used regression models for similar studies were utilized for continuous emotion detection, namely, multi-linear regression (MLR), SVR, CCRF [17], and LSTM-RNN [39].

4.3.1 Long Short Term Memory Neural Networks
LSTM-RNN have shown to achieve top performances in emotion recognition studies for audio-visual modalities [9], [13]. LSTM-RNN is a network which has one or more hidden layers including LSTM cells. These cells contain a memory block and some multiplicative gates which will determine whether the cell stores, maintains or resets its state. In this way, the network learns when to remember and forget information coming in a sequence over time and therefore it is able to preserve long-range dependencies in sequences. Recurrent neural networks are able to remember the short term input events through their feedback connections. LSTM adds the ability to also remember the input events from a longer period using the gated memory cell.

An open source implementation of LSTM2 which is powered by NVIDIA Inc., compute unified device architecture (CUDA) technology was used in this paper. We chose to have two hidden layers containing LSTM cells for all the three configurations that we used based on the results we obtained trying different configurations (see Section 6.3). The number of hidden neurons were set to a quarter of the number of the input layer neurons, or features. The learning rate was set to 1E-4 with the momentum of 0.9. The sequences were presented in random order in training and a Gaussian noise with the standard deviation of 0.6 has been added to the input to reduce the problem of over-fitting. The maximum epochs in training were 100. If there was no improvement on the performance, i.e., sum of squared errors, on the validation set after 20 epochs, the training was stopped with the early stopping strategy.

4.3.2 Continuous Conditional Random Fields
Conditional random fields (CRF) are frameworks for building probabilistic models to segment and classify sequential data. Unlike hidden Markov models (HMM), they do not assume that the observations are conditionally independent and therefore are good alternatives for cases where there is a strong dependency between observations. CCRF [17] were developed to extend the CRFs for regression. CCRF in this configuration acts as a smoothing operator on the per sample estimations from another model; in this work, we fed CCRF with the outputs estimated by a multi-linear regression. CCRF models a conditional probability distribution with the probability density function:
P(y|X)=exp(Ψ)∫∞−∞exp(Ψ)dy,(1)
View SourceRight-click on figure for MathML and additional features.where ∫∞−∞exp(Ψ)dy is the normalization function which makes the probability distribution a valid one (by making it sum to 1).
Ψ=∑i∑k=1K1αkfk(yi,X)+∑i,j∑k=1K2βkgk(yi,yj,X).(2)
View SourceRight-click on figure for MathML and additional features.

In this equation, Ψ is the potential function, X={x1,x2,…,xn} is the set of input feature vectors (matrix with per frame observation as rows, valence estimation from another regression technique such as MLR in our case), Y={y1,y2,…,yn} is the target, αk is the reliability of fk and βk is the same for edge feature function gk . fk, the Vertex feature function, (dependency between yi and Xi,k) is defined as:
fk(yi,X)=−(yi−Xi,k)2(3)
View SourceRight-click on figure for MathML and additional features.And gk, the Edge feature function, which describes the relationship between two estimation at steps i and j, is defined as:
gk(yi,yj,X)=−12S(k)i,j(yi−yj)2.(4)
View Source

The similarity measure, S(k), controls how strong the connections are between two vertices in this fully connected graph. There are two types of similarities:
S(neighbor)i,j={1,0,|i−j|=notherwise(5)
View Source
S(distance)i,j=exp(−|Xi−Xj|σ).(6)
View SourceThe neighbor similarity, in Equation (5), defines the connection of one output with its neighbors and the distance similarity, in Equation (6) , controls the relationship between y terms based on the similarity of x terms (by distance σ).

The CCRF can be trained using stochastic gradient descent. Since the CCRF model can be viewed as a multivariate Gaussian, the inference can be done by calculating the mean of the resulting conditional distribution, i.e., P(y|X).

SECTION 5Artifacts and Their Effect
There is often a strong interference of facial muscular activities and eye movements in the EEG signals. The facial muscular artifacts and eye movements are usually more present in the peripheral electrodes and higher frequencies (beta and gamma bands) [40]. We, hence, expected that the contamination from the facial expressions in the EEG signals to contribute to the effectiveness of the EEG signals for valence detection. In this Section, the EEG features were extracted from all the 32 electrodes (128 features from four bands).

To study this assumption, we used a linear mixed-effect model to test the effect of EEG features on estimating valence (annotated from the expressions) given the information from eye gaze and facial expressions (see Equation (7)). Linear mixed-effect model enables us to model the between participant variations in a random effect term while studying the effect of the independent variables (EEG, face and eye gaze) on the dependent variable, valence. The eye movements were taken from the data recorded by the Tobii eye gaze tracker at 60 Hz which we resampled to 4Hz to match the other modalities. The facial point movements were defined by how much they moved from one sample to the next. We calculated this in our feature set (see Section 4.2)
vi=β0+∑j=1Nβkxij+∑k=1qbkzi+ϵ.(7)
View Source

In this equation, vi is the valence at ith sample, xij is the feature, including facial, EEG and eye gaze; zi is the random effect variable representing different subjects and is only one when the sample i belongs to the kth subject; and ϵ is the random error that is normally distributed with zero mean. The result of the analysis showed that the coefficients of the majority of the EEG features were significantly different from zero. The percentage of the features with significant effect on valence estimations in different bands are as follows: theta band: 41 percent alpha band: 47 percent beta band: 50 percent and gamma: 81 percent; significance was defined by the results of the ANOVA test rejecting the null hypothesis with p-value smaller than 0.05. In total, the percentage of the EEG coefficient which was significantly different from zero was 55 percent. The average (absolute) β for the face features was 0.057 in comparison to 0.002 for EEG and 0.0005 for gaze. Given that the face features and eye gaze features were present in the model as fixed effect, this shows that the EEG features add information which was not in the facial movements detected by face tracker and useful for valence detection. It is however, unclear whether this information was originally related to the facial movement artifacts which were not detected by the computer vision based face trackers or not.

We also calculated the correlation between EEG spectral power in different bands and all the electrodes with the valence labels. The topographs in Fig. 3 show that the higher frequency components from electrodes positioned on the frontal, parietal and occipital lobes have higher correlation with valence measurements.

Fig. 3. - 
The correlation maps between PSD and continuous valence for theta, alpha, beta, and gamma bands. The correlation
 values are averaged over all sequences. In these topographs the frontal lobe, the nose, is positioned on the top.
Fig. 3.
The correlation maps between PSD and continuous valence for theta, alpha, beta, and gamma bands. The correlation values are averaged over all sequences. In these topographs the frontal lobe, the nose, is positioned on the top.

Show All

In order to check how much of the variation of EEG signals are correlated with the facial movement, we used a multi-linear regression model to estimate the EEG features from eye gaze, head pose and face features. In this analysis, we used a larger set of samples including the trials in which the participants did not show any visible facial expression. Eye gaze movement and head pose could not predict the EEG features, however, the features extracted from facial expressions could detect different EEG features with different degrees. Eye movements usually affect low frequency components of EEG signals which were discarded in these set of EEG features. The R-squared results of the estimation of the EEG features from face features are shown in Fig. 4. The association between EEG signals and facial expressions cannot be as a result of motor cortex activation since Mu rhythms are associated with motor cortex activation originated by movement (9-11Hz) [41] were not very strong. Mu Rhythm has the same frequency as alpha waves and originated from the motor cortex; see the alpha activity in Fig. 4. Comparing Figs. 3 and 4, we can see a large overlap between the features detecting valence and the features with a strong correlation and dependency on face features. Even though, using the linear mixed-effect model we found that the EEG features were still significant in detecting valence in the presence of face features, most of the variance which was useful in detecting valence was strongly correlated with facial muscle artifacts. The most effective facial points on EEG signals included the landmarks on lips.


Fig. 4.
The R-squared topographs depicting how much the EEG power spectral features could be estimated and as a result of facial movements or expressions.

Show All

We wanted to further clarify whether the effect is originated from facial expressions or EEG signals. In order to detect the relationship between two time series, we used Granger causality test. Granger [10] stated that y Granger causes x, if adding time series y to the auto regressive time series x reduces the variance of prediction error of x. Given time series x={x1,x2,…,xn} that can be described by an auto regressive model
xi=∑j=1kxw(kx−j)x(i−j)+ϵx,(8)
View SourceRight-click on figure for MathML and additional features.where kx is the model order for auto regressive time series, calculated using model selection criteria, like Baysian information criterion (BIC) or akaike information criterion (AIC). If time series y is:
yi=∑j=1kyw′(ky−j)y(i−j)+ϵy(9)
View SourceRight-click on figure for MathML and additional features.we can reconstruct x by:
xi=∑j=1kxw(kx−j)x(i−j)+∑j=1kyw′′(ky−j)y(i−j)+ϵxy.(10)
View SourceIn Equation (10) the first component is x being described using an autoregressive model, see Equation (8), and the second component models reconstructing x from the lagged values of y. The presence of Granger causality can be determined by an F-test using the following F-value:
F=(ϵ2x−ϵ2xy)/kyϵ2xy/(n−(kx+ky+1)).(11)
View SourceRight-click on figure for MathML and additional features.

We can then verify whether the null hypothesis, or the absence of Granger causality, can be rejected or not; in this paper we used the significance level of 5 percent.

We generated the squared EEG signals resampled to 60 Hz to represent their energy and to match the facial expressions sampling rate. We then performed the Granger causality test from each of 38 facial points to each of 32 EEG signals from all the electrodes and back. We found that in average 28 percent of the causality test are positive when we test whether the facial expressions are Granger caused by EEG signals whereas this percentage was 54 percent for EEG signals being under influence of facial expressions. In Fig. 5, we show the averaged percentage of causality tests that came positive for different electrodes when we tested the causality from facial expressions to EEG signals. We can observe that it has a similar pattern to the correlation analysis and further strengthens the idea that a large part of the variance in EEG signals is as a result of facial expressions artifacts.


Fig. 5.
The average percentage of significant causation from facial points to different EEG signals.

Show All

SECTION 6Experimental Results
6.1 Analyses of Features
We calculated the correlation between different facial expression features and the ground truth for each sequence and averaged them over all sequences. The features with the highest correlation coefficients were related to the mouth/lip points, e.g., lower lip angle (ρ=0.23), left and right lip corner distance (ρ=−0.23), etc. The results showed that the lip points were the most informative features for valence detection. The openness of mouth and eyes were also strongly correlated with valence.

6.2 Analysis of the Lag of Annotations
Mariooryad and Busso [42] analyzed the effect of lag on continuous emotion detection on SEMAINE database [14]. They found a delay of 2 seconds will improve their emotion detection results. SEMAINE database is annotated by Feeltrace [36] using a mouse as annotation interface. In contrast, our database is annotated using a joystick which we believe has a shorter response time and is easier to use for such purpose. We shifted our annotations and considered delays from 250ms up to 4 seconds and calculated the averaged correlation coefficients for the valence detection results from different modalities and their combinations. The results, in Fig. 6 , showed that in our case the delay of 250 ms increased the detection performance whereas longer delays deteriorated it. Therefore, we observed the advantage of using joystick over mouse in this context.

Fig. 6. - 
The resulting $\bar{\rho}$
 for different hypothetical
 annotation delays.
Fig. 6.
The resulting ρ¯ for different hypothetical annotation delays.

Show All

6.3 LSTM Structure
We experimented different LSTM structures from one hidden layer to two hidden layers and with different number of LSTM cells. The results are summarized in Table 1. Two hidden layers yielded higher detection performance compared to one. We tested with different number of neurons in the hidden layer including 1/8, 1/4, and 1/2 the input layer neurons or the number of features. Different number of neurons did not change the results significantly; we confirmed this with performing a one-sided non-parametric rank-sum test. Therefore, we chose a quarter of the input neurons with two hidden layers for the final settings. Weninger et al. [43] reported that adding the differences between the consecutive targets as outputs improved their regression performance in music emotion estimation from content features. They argue that adding the target differences acts like regularization of the weights. We tried the same technique in which we added the difference between the targets of each point with its neighboring samples (Δ(v)/Δ(t)) in the training phase and discard those output during testing. Unlike [43], the results of including the target differences (Δ(v)/Δ(t)) did not have any significant effect on the performance. Hence, we did not use the extra differential targets in our final model.

TABLE 1 The Performance of Continuous Valence Detection Using Different Structures of LSTM Network

6.4 Continuous Emotion Detection
In this Section, we present the results of continuous emotion detection in case of felt-emotions. All the features and annotations were re-sampled to 4 Hz from their original sampling rates. To recall, EEG features were the power spectral densities in different bands and facial expression features were extracted from the facial landmarks detected in each frame. This re-sampling enabled us to perform multimodal fusion on different levels. All the features were normalized by removing the average value of the features in the training set and dividing by their standard deviation. The results were evaluated in a 10-fold cross validation which is not participant-independent. However, the training, validation and test sets do not contain information from the same trials. In every fold, the samples were divided in three sets. Ten percent were taken as the test set, 60 percent of the remaining samples (54 percent of the total number of samples) were taken as the training set and the rest were used as the validation set. For the MLR, only the training sets were used to train the regression models and the validation sets were not used. A linear ϵ-SVR with L2 regularization, from Liblinear library [44], was used and its hyper-parameters were found based on the lowest RMSE on the validation set. We used the validation sets in the process of training the LSTM-RNN to avoid overfitting. The output of MLR on the validation set was used to train the CCRF. The trained CCRF was applied on the MLR output on the test set. The CCRF regularization hyper-parameters were chosen based on a grid search using the training set. The rest of the parameters were kept the same as [17].

Two fusion strategies were employed to fuse these two modalities. In the feature level fusion (FLF), the features of these modalities were concatenated to form a larger feature vector before feeding them into models. In the decision level fusion (DLF), the resulting estimation of valence scores from different modalities were averaged.

The emotion recognition results are given in Table 2. We reported the averaged Pearson correlation to show the similarity between the detected curves and the annotations. Root-mean-squared error (RMSE) is also reported to show how far the estimations were in average compared to the ground truth. RMSE penalizes the larger errors more than the smaller ones. Consistently, facial expressions outperformed EEG features. This might be as a result of the bias of the data set towards the trials with expressions. We could show that in this particular case unlike the work of Koelstara and Patras [45], facial expressions can outperform EEG signals for valence detection. It is worth noting that the facial landmark detector used in this study is a more recent landmark tracking technique compared to the one in [45] whereas the EEG features are identical. Moreover, compared to the previous work, we were using a different set of labels which were not based on self-reports. Finally, [45] was a single trial classification study whereas here we are detecting emotions continuously.

TABLE 2 To Evaluate the Detection Performances from Different Modalities and Fusion Schemes the Averaged Pearson Correlation Coefficient (ρ¯ ) and RMSE Are Reported

A one sided Wilcoxon test showed that the difference between the performance of the decision level fusion compared to the results of a single modality facial expression analysis using LSTM-RNN was not significant. Therefore, we conclude that the fusion of EEG signals is not beneficial and the LSTM-RNN on a single modality, i.e., facial expressions, performed the best in this setting. Using the non-parametric Wilcoxon test, we found that the difference between correlations resulted from LSTM-RNN and CCRF is not significant, however, RMSE is significantly lower for LSTM-RNN (p<1E−4). Although, direct comparison of the performance is not possible with the other work due to the difference in the nature of the databases, the best achieved correlation is in the same range as the result of [46] , the winner of AVEC 2012 challenge, on valence and superior to the correlation value reported on valence in a more recent work, [47]. Unfortunately, the previous papers on this topic did not report the standard deviation of their results; thus its comparison was impossible. We have also tested the BLSTM-RNN, but their performance was inferior compared to the simpler LSTM-RNN for this task.

Two examples of detection results are given in Fig. 7. We observed that positive emotions were easier to detect compared to the negative ones. Smiles are strong indicators of pleasantness of emotions and there are a large number of instances of smile in the current data set. It was also shown that smile detection has a high performance in spontaneous expression recognition [48]. Our analysis on the face features also showed that most of the highly correlated features were the points on lips.

Fig. 7. - 
Two examples of the detected valence traces. The results depicted on top (
$\rho _{FLF}$
 = 0.80, RMSE$_{FLF}$
 = 0.034) is a good
 example of correct detection of the trend in a positive stimulus. The example shown in the bottom (
$\rho _{FLF}$
 = -0.11, RMSE
$_{FLF}$
 = 0.036), on the
 other hand is an example where the detection did not pick up the correct trend for this negative stimulus.
Fig. 7.
Two examples of the detected valence traces. The results depicted on top ( ρFLF = 0.80, RMSEFLF = 0.034) is a good example of correct detection of the trend in a positive stimulus. The example shown in the bottom (ρFLF = -0.11, RMSE FLF = 0.036), on the other hand is an example where the detection did not pick up the correct trend for this negative stimulus.

Show All

6.5 Expected Emotion Detection
If the goal of emotion detection is to identify the emotional highlight and emotional trace of videos, then the ground truth should reflect the expected emotions. For this reason, we repeated the same procedure for detecting the expected emotion this time using both continuous arousal and valence labels given to the stimuli. When we annotated the stimuli directly we did not have the same limitation as annotating facial expressions that made annotating arousal impossible. This time, we only report the results of the best performing model, i.e., LSTM-RNN. The results are given in Table 3. Again the facial expressions results are superior to the EEG signals and fusion of two modalities do not outperform facial expressions. It is worth noting that even without the labels crated based on the expressions, see Section 6.4, facial expressions outperform the EEG signals. The results are in average inferior to the results obtained using the expression-based labels in Section 6.4. This might be as a result of different factors that we summarize as follows. Not all the viewers at all times feel the emotions that are expected; e.g., a person might have already watched a surprising moment in a movie scene and it is surprising to her for the second time. Often times we only express or feel high level of emotion or arousal only in the first moment of facing a stimulus; the emotional response usually decays afterward due to the habituation to the stimulus [35]. Moreover, the personal and contextual factors, such as mood, fatigue and familiarity with the stimuli have effect on what we feel in response to videos [2] . One solution to these problems can be to combine several users’ responses. Multi-user fusion has been shown to achieve superior results in emotional profiling of videos using physiological signals compared to single-user response [24].

TABLE 3 The Detection Results with the Aim of Recovering the Expected Emotion Using the Labeled Stimuli
Table 3- 
The Detection Results with the Aim of Recovering the Expected Emotion Using the Labeled Stimuli
In order to verify whether the model trained on annotations based on facial expression analyses can reflect on the case without any facial expressions. We chose one of the videos with distinct emotional highlight moments, the church scene from “Love Actually”, and took the EEG responses of the 13 participants who did not show any significant. Since these responses did not include any visible facial expressions, they were not used for the annotation procedure and were not in any form in our training data. We extracted the power spectral features from their EEG responses and fed it into our models and averaged the output curves. Fig. 8 show that despite the fact that the participants did not express any facial expressions and likely did not have very strong emotions, the valence detected from their EEG responses covaries with the highlight moments and the valence trend in the video. The CCRF provides a smoother trace which matches better with the overall trend compared to the other methods. The snapshots in Fig. 8, show the frames corresponding to three different moments. The first one, at 20 seconds, is during the marriage ceremony. The second and third frames are the surprising and joyful moments when the participants bring their musical instruments in sight and start playing a romantic song unexpectedly.

Fig. 8. - 
The average valence curve, emotional trace, resulted from the EEG signals of participants who did not show any
 facial expressions while watching a scene from Love Actually. The general trend is correlated with the emotional
 moments. The labels given directly to the stimulus were divided by 10 for visualization purposes and are in green dash
 dots. The figure is best seen in color.
Fig. 8.
The average valence curve, emotional trace, resulted from the EEG signals of participants who did not show any facial expressions while watching a scene from Love Actually. The general trend is correlated with the emotional moments. The labels given directly to the stimulus were divided by 10 for visualization purposes and are in green dash dots. The figure is best seen in color.

Show All

SECTION 7Conclusions
We presented a study of continuous detection of valence using EEG signals and facial expressions. Promising results were obtained from EEG signals and facial expressions. We expected the results from facial expressions to be superior due to the bias of the ground truth towards the expressions, i.e., the ground truth was generated based on the judgment of the facial expressions. The results from the statistical test on the linear mixed-effect model showed that EEG modality carries useful information for detecting valence. The information gain from including EEG signals however did not improve the performance of the detection in our different fusion approaches. It is also possible that the rest of the valence related information in EEG signals were also related to subtle facial expressions which were not captured by the machine vision based face tracker. The results of detecting the labeled stimuli again demonstrated that facial expressions had superior performance compared to the EEG signals for emotion detection. In summary, facial expressions outperformed EEG signals for emotion detection in this study. The data set that was used in this study consisted of responses with apparent facial expressions with face videos captured in high quality with limited head movements and pose variance. However, this conclusion cannot be generalized to all conditions and all emotion detection scenarios as the opposite was reported previously [45].

Even with inferior performance, EEG signals can still be considered in applications where we cannot record users’ faces. The current wearable headsets, e.g., EMOTIV,3 demonstrate the potentials in EEG analysis. Moreover, with correct electrode placement electromyogenic signals and the artifacts from facial expression on EEG signals can be used to detect facial expressions to replace the need for a front-facing camera capturing users’ faces.

The analyses of the correlation between the EEG signals and the ground truth showed that the higher frequency components of the signals carry more important information regarding the pleasantness of emotion. The analysis of correlation and causation between EEG signals and facial expressions further showed that the informative features from EEG signals were mostly originated from the contamination from facial muscular activities. The analysis of the valence detection also showed that the results were superior for the sequences with positive emotions compared to the negative ones. The continuous annotation of facial expressions suffers from a lag and we showed the superior time response of annotators while using joystick instead of using a mouse [14], [42].

In the future work, it will be beneficial to record multimodal data for the sole aim of understanding the correlation and causation relationships between facial expressions and EEG signals. Recordings of the future work can include acted and spontaneous expressions in different situations.