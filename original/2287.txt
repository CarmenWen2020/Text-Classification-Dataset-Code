Exploiting the prior information is fundamental for image reconstruction in computational hyperspectral imaging (CHI). Existing methods usually unfold the 3D signal as a 1D vector and then handle the prior information among different dimensions in an indiscriminative manner, which inevitably ignores the high-dimensionality nature of the hyperspectral image (HSI) and thus results in poor reconstruction performance. In this paper, we propose a high-order tensor optimization based reconstruction method to boost the quality of CHI. Specifically, we first propose an adaptive dimension-discriminative low-rank tensor recovery (ADLTR) model to exploit the high-dimensionality prior of HSI faithfully. In the ADLTR model, we utilize the 3D tensors as the basic elements to fundamentally preserve the structure information in the spatial and spectral dimensions, introduce a dimension-discriminative low-rankness model to fully characterize the prior in the basic elements, and propose a weight estimation strategy by adaptively exploiting the diversity in each dimension. Then, we develop an optimization framework for the CHI reconstruction by integrating the structure prior in ADLTR with the system imaging principle, which is finally solved via the alternating minimization scheme. Extensive experiments on both synthetic and real data demonstrate that our method outperforms state-of-the-art methods.

Access provided by University of Auckland Library

Introduction
Hyperspectral imaging is an emerging technique for capturing the reflectance of a real scene across tens to hundreds of discrete bands. The captured hyperspectral image (HSI) is 3D in nature, including one spectral dimension and two spatial dimensions. Compared with traditional RGB images, HSIs can provide more details and features with the additional spectral dimension. Such characteristics have been applied to various computer vision tasks, such as detection (Kwon and Nasrabadi 2007; Gevers and Stokman 2003), segmentation (Tarabalka et al. 2009; Salzenstein and Collet 2006), recognition (Pan et al. 2003; He et al. 2019) and tracking (He et al. 2011; Nguyen et al. 2010).

To obtain a 3D HSI, the conventional spectrometers (Porter and Enmark 1987; Basedow et al. 1995; Yamaguchi et al. 2006; Schechner and Nayar 2002), which are equipped with 1D or 2D detectors, need to scan the scene along the spatial dimension or spectral dimension. However, the traditional scanning-based hyperspectral imaging methods suffer from low temporal resolution and cannot be used to capture dynamic scenes. Thanks to the flourish of computational photography, computational hyperspectral imaging (CHI) has been developed to overcome this problem (Okamoto and Yamaguchi 1991; Descour and Dereniak 1995; Cao et al. 2011). Among the numerous imaging systems, coded aperture snapshot spectral imaging (CASSI) (Arce et al. 2014; Wagadarikar et al. 2008) and its dual-camera design (DCD) (Wang et al. 2015a, b) have attracted increasing attention in recent years due to the snapshot advantage. With the elaborate optical implementation, these systems encode the 3D HSI into the 2D compressive measurements, where the number of the measurements is far less than what is required by the Nyquist sampling frequency. Based on the compressive sensing theory (Baraniuk 2007; Candes 2006), the 3D HSI can be reconstructed from the 2D measurements. Though these CHI systems have led to promising results, the bottleneck lies in the limited reconstruction quality, which precludes them from wide applications.

Since the reconstruction problem is severely under-determined, image prior information must be modeled to regularize the reconstruction. So far numerous image priors, including piece-wise smoothing, sparsity and low-rank, have been developed (Figueiredo et al. 2007; Tan et al. 2016; Lin et al. 2014a; Wang et al. 2015b, 2017; Fu et al. 2016; Liu et al. 2018; Fu et al. 2017).Among those priors, the low-rank prior can fully exploit the spectral-spatial correlation and shows an impressive reconstruction accuracy (Liu et al. 2018; Fu et al. 2017). However, existing methods model the prior by unfolding the 3D signal as a 1D vector or a 2D matrix, and treating the prior information among different dimensions in an indiscriminative manner. The vectorization process ignores the high-dimensionality nature of HSI and breaks the original structure information in HSI. As an intuitive example, Fig. 1 shows a comparison of pixel value distributions of one spatialâ€“spectral patch with and without vectorization. It is clear that the vectorization process introduces plenty of disruptive information and losses the intrinsic correlation. Recently, deep learning has attracted flourishing attention in various computer vision tasks. Several methods have been derived from this technique and provide alternative approaches for HSI reconstruction (Sun et al. 2016; Zhang and Ghanem 2018; Choi et al. 2017; Xiong et al. 2017; Wang et al. 2018). Deep learning based methods usually learn the prior by modeling the local and nonlocal correlation of HSI with various neural networks. However, they usually take all neighbors of the target into consideration, which inevitably introduces irrelevant information. This limitation causes the low-rank prior of HSI, especially in a high-dimensional manner, to be ignored and hinders the reconstruction accuracy.

Fig. 1
figure 1
Illustration of the spectral-spatial correlation in a local patch. a A local spectral-spatial patch with size 36Ã—31. b The 3D smooth surface of (a). c The vectorized 1D signal of (a). It shows that the vectorization process introduces plenty of disruptive information and breaks the intrinsic structure

Full size image
To handle the aforementioned issues, we consider the high-dimensional prior in HSI and propose a new reconstruction method based on the adaptive dimension-discriminative low-rank tensor recovery model. Three-fold main contributions are summarized as below.

First, we propose a high-order tensor optimization based method to boost the reconstruction performance for CHI. Our key observation is that compared with 1D vector based signal description, high-order tensors can provide a more accurate representation to figure out the multi-dimensionality diversity and deliver the intrinsic structure of HSI. Such an observation motivates us to exploit the tensor representation for HSI reconstruction to address the problem of vectorization. In recent years, we witness the booming growth of the tensor-based image processing techniques, which helps to promote the performance in various practical tasks, such as image denoising (Rajwade et al. 2013), super-resolution (Dian et al. 2017) and data completion (Cao et al. 2015). However, extending the power of high-order tensors to the CHI reconstruction is still nontrivial. Thorough experiments implemented with both synthetic data and real captured data demonstrate that our method outperforms state-of-the-art methods.

Second,  we  propose  a  novel adaptive dimension-discriminative low-rank tensor recovery (ADLTR) model to fully characterize the structure prior. Specifically, we reformulate a 3D tensor for each exemplar cubic patch of HSI to preserve the correlation exiting in the spatial and spectral dimensions. By considering the multi-dimensionality diversity, the constructed 3D tensors naturally possess different low-rank property in different tensor dimensions. Therefore, we propose to pursue the low-rank property on each dimension in a dimension-discriminative manner. The ADLTR model can efficiently characterize the high-order structure prior of HSI, which benefits to boost the performance for CHI. To the best of our knowledge, it is the first time that the ADLTR model has been integrated for CHI.

Third, we propose an adaptive weight estimation strategy for the ADLTR model to further address the multi-dimensionality diversity in the constructed tensors. The weight used in the ADLTR model can be regarded as a correlation measurement, which balances the low-rank degree among the tensor dimensions and even the basic elements. Since the regional correlation in the images is spatially variant and content dependent (Zontak and Irani 2011; Huang et al. 2014), setting a fixed weight manually for all the constructed tensors will fail to fit the data diversity, thereby degrading the recovery performance. To this end, we propose an adaptive weight estimation strategy to make full use of the data diversity, which further promotes the performance in both spatial accuracy and spectral fidelity.

The rest of this paper is organized as follows. The related works are reviewed in Sect. 2. The proposed ADLTR model is described in Sect. 3. The imaging principle and the reconstruction algorithm are presented in Sect. 4. The experimental results on the synthetic data and real data are shown in Sects. 5 and 6, respectively. Finally, the discussion and conclusion are provided.

Related Works
Computational Hyperspectral Imaging
To overcome the limitation of conventional scanning-based hyperspectral imaging systems, several CHI systems have been developed in the last decades to enable the hyperspectral snapshot acquisition of dynamic scenes (Cao et al. 2016; Gao and Wang 2016). Representative systems include computed tomographic imaging spectrometry (CTIS) (Okamoto and Yamaguchi 1991; Descour and Dereniak 1995), prism-mask spectral video imaging system (PMVIS) (Cao et al. 2011; Ma et al. 2014) and CASSI (Arce et al. 2014; Wagadarikar et al. 2008).

Equipped with three transmission sinusoidal phase gratings rotated in 60âˆ˜, CTIS disperses the 3D HSI to multiple 2D images and projects them along multiple directions. Then the underlying HSI can be recovered from the 2D projections based on the Fourier slice theorem (Okamoto and Yamaguchi 1991; Descour and Dereniak 1995). CTIS sacrifices the spatial resolution to achieve the snapshot property and also suffers from the missing cone problem, which results in low fidelity reconstruction. PMVIS utilizes a dispersion system integrated with a customized mask to capture the 3D HSI with a 2D detector (Cao et al. 2011). A modified design, which combines PMVIS with an additional RGB camera, was proposed for capturing 4D hyperspectral video (Ma et al. 2014). A distinct advantage of PMVIS is real-time reconstruction. However, the underlying problem is that the occlusion mask only allows a small portion of the incident light to be captured by the detector, which limits the temporal resolution that can be achieved. Based on the compressive sensing theory, CASSI has attracted increasing attention in recent years. CASSI employs one disperser or two dispersers to capture a 2D encoded image of the target (Arce et al. 2014; Wagadarikar et al. 2008). Then the underlying HSI can be reconstructed based on the compressive sensing theory. Several hardware advancements of CASSI have been developed to improve the performance, e.g. multiple snapshot imaging system (MSIS) (Kittle et al. 2010; Wu et al. 2011), dual-coded compressive spectral imager (DCSI) (Lin et al. 2014b) and spatialâ€“spectral compressive spectral imager (SSCSI) (Lin et al. 2014a). The latest dual-camera design, i.e., DCD, incorporates a co-located panchromatic camera to collect more information simultaneously with CASSI (Wang et al. 2015a, b). With the complementary details from the uncoded image, DCD obtains a significant improvement in reconstruction quality.

Along with the hardware designs, The bottleneck in CHI is how to faithfully reconstruct the 3D HSI from the compressive measurements, especially for CASSI and its advancements. In this paper, we propose a high-order tensor optimization based method to boost the reconstruction performance for CHI.

Hyperspectral Image Reconstruction
Recovering the underlying HSI from the compressive measurements plays an essential role in CHI. So far, methods for HSI reconstruction can be grouped into two categories: prior regularization based methods and deep learning based methods.

Prior regularization based reconstruction
Traditional methods reconstruct HSI by solving prior regularized optimization problems. Based on the compressive sensing theory, HSI can be reconstructed by solving an â„“0 or an â„“1 relaxation optimization problem. With the hypothesis that objects have piecewise smooth structures, the total variation (TV) prior integrated with the two-step iterative shrinkage/thresholding algorithm (TwIST) (Bioucas-Dias and Figueiredo 2007) and alternative direction multiplier method (ADMM) (Boyd et al. 2011), was widely used in CHI (Zhang et al. 2018a, b, 2019). However, TV prior based methods tend to provide over-smoothing results and lost texture details. Then, the sparsity prior based methods were developed base on the orthogonal transformation or over-completed dictionary (Figueiredo et al. 2007; Tan et al. 2016; MejÃ­a et al. 2017; Wang et al. 2015b, 2017). The gradient projection for sparse reconstruction (GPSR) (Figueiredo et al. 2007) transformed the sparsity based problem into a bound-constrained quadratic programming formulation and the approximate message passing (AMP) (Tan et al. 2016; Donoho et al. 2009) imposed a 3D wiener filtering on the wavelet basis, both of which have been used for CASSI reconstruction. Since an over-complete dictionary is often better than a predefined orthogonal transform (Candes et al. 2011), the 3D sparse reconstruction (3DSR) based method was first introduced in SSCSI (Lin et al. 2014a). Then, an adaptive dictionary learned from the panchromatic image in DCD was proposed to recover a 4D hyperspectral video (Wang et al. 2015b). Further, an adaptive non-local sparse representation (ANSR) model (Wang et al. 2017) was developed to enhance the sparsity correlation among the spectral and spatial dimensions and achieved a decent reconstruction quality. Recent researches on matrix rank minimization, including low-rank matrix approximation (LRMA) (Fu et al. 2016) and decompress snapshot compressive imaging (DeSCI) (Liu et al. 2018), were proposed to exploit the spatialâ€“spectral correlation and led to the state-of-art reconstruction results for CHI. However, existing methods always unfold the 3D signal as a 1D vector or 2D matrix and treat the prior information among different dimensions in an indiscriminative way, which ignores the high-dimensionality nature of HSI and results in poor reconstruction quality.

Deep learning based reconstruction
In recent years, deep learning techniques have been employed for image restoration. Several methods have been proposed to mimic the prior regularized optimization algorithm on a deep neural network for natural image compressive imaging, e.g., ADMM-Net (Sun et al. 2016), LISTA (Gregor and LeCun 2010), and ISTA (Zhang and Ghanem 2018). However, the heterogeneity of HSI makes those methods difficult to be extended for CHI. In the field of CHI reconsecration, an early attempt based on a convolutional autoencoder (AE) (Choi et al. 2017) was proposed to build a non-linear sparse representation for CASSI. However, a single sparsity regularization only on the spectral dimension while ignoring the spatial dimension inevitably leads to sub-optimal reconstruction results. Later, the convolutional neural network based methods were introduced for CHI reconstruction. HSCNN (Xiong et al. 2017) treats the reconstruction task as an image enhancement task. But its performance heavily depends on the image initialization. HRNet (Wang et al. 2018) utilized two separate networks to explore spatial similarity and spectral correlation. The spatialâ€“spectral regularization prior (SRP) was learned with an optimization-based network to improve reconstruction quality for CASSI (Wang et al. 2019). Recently, ğœ†-Net integrated the attention mechanism with U-net to finish the CASSI reconstruction problem. But those methods did not take the low-rank prior of HSI into consideration, especially in a high-dimensional manner, which hinders the reconstruction accuracy. Moreover, few experiments are carried out to verify the performance of these deep learning based methods on the actual hardware systems.

Low-Rank Tensor Recovery
Low-rank tensor recovery has been widely used in various computer vision tasks (Li et al. 2015; Peng et al. 2014; Xie et al. 2018a; Chang et al. 2017) in recent years. Based on the high-order singular value decomposition (HOSVD) (Kolda and Bader 2009), low-rank tensor recovery was regarded as a factorization based problem. However, HOSVD needs to predefine the rank of each dimension, which is a hard and unstable task. Another decomposition based low-rank tensor recovery is the tensor singular value decomposition (t-SVD) (Zhang et al. 2014). Based on the definition of the tensor-tensor product, t-SVD was developed as a tensor format extension of matrix SVD. Although the Fourier transform is introduced for acceleration, a heavy computation burden still exists in t-SVD. An advancement of t-SVD is tensor-nuclear-norm (TNN) (Xue et al. 2018), which is defined as the sum of nuclear norms of all frontal slices in the Fourier domain of the tensor. TNN can be regarded as a convex relaxation to the â„“1 norm of the tensor rank. However, it loses the physical meaning of the multi-dimensional low-rank property. Recently, sum of ranks minimization based methods have been widely used for the tensor completion (Li et al. 2015; Romera-Paredes and Pontil 2013). However, these methods treat the rank of all dimensions equally, which ignores the discrepant physical meaning of different dimensions. To figure out this issue, a weighted tensor nuclear norm regularization based model was presented (Liu et al. 2013) and its relaxation with non-convex forms were further developed (Xie et al. 2018b; Cao et al. 2015). But the weight was set manually, which ignores the intrinsic multi-dimensionality diversity of HSI.

In this paper, we take advantage of the trend in this domain and propose an adaptive high-order low-rank tensor recovery model for CHI to boost the reconstruction quality. To the best of our knowledge, it is the first time that the ADLTR model has been integrated for CHI reconstruction.

Adaptive Dimension-Discriminative Low-rank Tensor Model
Notations and Preliminaries
Let us start by introducing the notations and preliminaries that will be used later. Scalars are indicated as lowercase letters, e.g., x, vectors are represented with blodface lowercase letters, e.g., ğ‘¥ğ‘¥, and matrices are denoted as boldface capital letters, e.g., ğ‘‹ğ‘‹. A tensor with N dimensions, which is also known as modes in the mathematical description, is represented as boldface Euler script î‰„î‰„âˆˆâ„ğ¼1Ã—ğ¼2Ã—â‹¯ğ¼ğ‘ and each of its entries is denoted ğ‘¥(ğ‘–1,ğ‘–2,â€¦,ğ‘–ğ‘), 1â‰¤ğ‘–ğ‘›â‰¤ğ¼ğ‘›. By varying the index ğ‘–ğ‘› while keeping the others fixed, the mode-n fiber of î‰„î‰„ can be obtained. By arranging the mode-n fibers of î‰„î‰„ as column vectors, the mode-n unfolding matrix of î‰„î‰„, which is denoted as ğ‘‹ğ‘‹(ğ‘›)âˆˆâ„ğ¼ğ‘›Ã—(ğ¼1â€¦ğ¼ğ‘›âˆ’1ğ¼ğ‘›+1â€¦ğ¼ğ‘), can be obtained. Contrarily, the mode-n unfolding matrix of î‰„î‰„ can be transformed back to the tensor format î‰„î‰„, which is described as î‰„î‰„=foldğ‘›(ğ‘‹ğ‘‹(ğ‘›)), 1â‰¤ğ‘›â‰¤ğ‘. The Frobenius norm of a tensor î‰„î‰„ is defined as the square root of the sum of the squares of all its elements, i.e., â€–î‰„î‰„â€–ğ¹=âˆ‘ğ¼1ğ‘–1=1âˆ‘ğ¼2ğ‘–2=1â‹¯âˆ‘ğ¼ğ‘ğ‘–ğ‘=1ğ‘¥(ğ‘–1,ğ‘–2,â€¦,ğ‘–ğ‘)2â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾âˆš.

Model Formulation
The fundamental solution for HSI reconstruction is to solve an optimization problem with a prior information based regularization. Therefore, it is essential to fully leverage the intrinsic properties behind the desired signal and develop an appropriate regularization. So far, two kinds of priors for HSI recovery are the spectral correlation and spatial self-similarity. The spectral correlation states the fact that HSI contains a small number of basic materials and thus exhibits rich spectral redundancy. While the spatial self-similarity indicates that each exemplary patch would have multiple similar patches sharing the homologous structure. It has been shown that such two kinds of priors are beneficial for HSI processing (Li et al. 2015; Peng et al. 2014; Xie et al. 2018a; Chang et al. 2017). In order to take such two priors into full consideration, we formulate 3D tensors to promote reconstruction quality.

We first partition the HSI î‰„î‰„ into overlapped cubic patches with the spatial block size of ğ‘ Ã—ğ‘  across full spectral bands. Then we reorder the spatial block of each band into a 1D column vector lexicographically. For each patch, we can find k nearest similar neighbors including itself and obtain a corresponding 3D tensor. We denote the constructed tensor at position l as î‰„î‰„ğ‘™ with the size of ğ‘ 2Ã—ğ›¬Ã—ğ‘˜, where ğ›¬ is the number of spectral band. Although it is someway reasonable to construct a 4D tensor to preserve the 2D spatial structure, the spatial size ğ‘ Ã—ğ‘  is usually set to be small, which can not extract the intrinsic spatial features. While for a large s, unaffordable computation and memory burden will be introduced in practice.

Fig. 2
figure 2
Tensor low-rank property analysis. We exploit the nonlocal similarity across spatial and spectral dimensions to reformulate a low-rank tensor in the first row. We unfold the tensor along each mode in the second row and show the corresponding singular values in the third row

Full size image
The constructed 3D tensor utilizes the spatial self-similarity (mode-1), the spectral correlation (mode-2), and the joint correlation (mode-3) simultaneously, which would benefit us for investigating the priors in a unified framework. Due to the strong correlation and high redundancy in each dimension, î‰„î‰„ğ‘™ naturally possesses the low-rank property. Assuming that î‰„î‰„ğ‘™ is corrupted by Gasussian noise, i.e., î‰„î‰„ğ‘™=îˆ¼îˆ¼ğ‘™+î‰ƒî‰ƒğ‘™, where îˆ¼îˆ¼ğ‘™ and î‰ƒî‰ƒğ‘™ denote the clean low-rank tensor and the Gaussian noise tensor, respectively. Then the clean low-rank tensor îˆ¼îˆ¼ğ‘™ can be recovered by solving the following optimization problem:

minimizeîˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ rank(îˆ¼îˆ¼ğ‘™)subject to â€–â€–î‰„î‰„ğ‘™âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹â‰¤ğœ2ğ‘¤,
(1)
where ğœ2ğ‘¤ denotes the variance of additive Gaussian noise.

In practice, the above constrained minimization problem can be solved with its Lagrangian form:

minimizeîˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ ğœâ€–â€–î‰„î‰„ğ‘™âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+rank(îˆ¼îˆ¼ğ‘™),
(2)
where ğœ denotes the penalty factor.

With the Tucker decomposition (Tucker 1966), the tensor rank is characterized by the sum of ranks of unfolding matrices along each mode, i.e., rank(îˆ¼îˆ¼ğ‘™)=âˆ‘3ğ‘›=1rank(îˆ¼îˆ¼ğ‘™(ğ‘›)). Specifically, îˆ¼îˆ¼ğ‘™(1)âˆˆâ„ğ‘ 2Ã—ğ›¬ğ‘˜, îˆ¼îˆ¼ğ‘™(2)âˆˆâ„ğ›¬Ã—ğ‘ 2ğ‘˜ and îˆ¼îˆ¼ğ‘™(3)âˆˆâ„ğ‘˜Ã—ğ‘ 2ğ›¬. However, simply summing the ranks lacks a clear investigation on different dimensions. In Fig. 2, we analyze the low-rank property of the constructed 3D tensor. We extract a non-local tensor from a clean HSI and implement SVD on the corresponding three unfolding matrices. It shows that the singular values of each unfolding matrix tend to be dropping to zero fleetly. But discrepancy exists in the descending rates of singular values of different modes. For example, due to the strong redundancy in non-local similar patches, the magnitude of singular values in mode-3 tends to decrease to zero at a relatively faster speed. Thus, a single penalty factor acted on all modes would produce poor tensor recovery results, e.g., modes of lower rank still contain biased redundancy while those of higher rank are overestimated.

Considering such discrepancy in different modes, it is beneficial to estimate rank(îˆ¼îˆ¼ğ‘™) in a dimensional discriminative manner. To address this issue, we propose to utilize the sum of weighted ranks regularization to exploit the multi-dimensionality diversity:

minimizeîˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ğœâ€–â€–î‰„î‰„ğ‘™âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘3ğ‘›=1ğ‘¤ğ‘›rank(îˆ¼îˆ¼ğ‘™(ğ‘›)),
(3)
where ğ‘¤ğ‘›>0 is the weight factor that can be regarded as the importance measurement of mode-n. In the following, we will illustrate the physical meaning of the weight factor ğ‘¤ğ‘› and propose an adaptive estimation strategy to determine the value of ğ‘¤ğ‘›.

Adaptive Weight Estimation Strategy
Because the inherent characteristics of HSI, such as materials, textures, and gradients, vary in a large extend, degrees of low-rankness change in different constructed tensors. It means that setting a fixed weight manually for all tensors will not be able to fit the multi-dimensionality diversity, thereby inevitably degrading the recovery accuracy. Therefore, it is necessary to design an adaptive weight estimation strategy for fully exploiting the multi-dimensionality diversity in HSI.

From Eq. (3), we can see that the weight measures the importance contributed from the rank of the corresponding unfolding matrix. When the rank of a mode is lower than other modes, it means that singular values in this mode drop to zero faster than other modes. In other words, more important information with higher correlation and less noise exists in this mode (Chang et al. 2017; Xie et al. 2018a, 2016). To preserve the information in this mode, we need to provide a weaker shrinkage upon these singular values. In contrast, if the rank of a mode is higher than other modes, it means that singular values in this mode drop to zero slower than other modes. In other words, lower correlation with more noise exists in this mode. To remove the noise and restore the information in this mode, we need to provide a stronger shrinkage upon these singular values. According to the analysis above, we can determine the weight on the rank of the corresponding matrix. Specifically, the proposed adaptive weight estimation strategy is defined as follows.

Fig. 3
figure 3
Reconstructed results with and without the adaptive weight estimation strategy (shorted as AWES). a A testing scene with the size of 256Ã—256Ã—31. b The local magnification maps marked in (a). c The spectral RMSE of three representative regions labeled in (a). d The reconstructed PSNR/SSIM results of (a). e The singular value distributions of constructed tensors centered on (d) along three modes

Full size image
(1)
First, we approximate the rank of the mode-n unfolding matrix based on SVD. We know that the nuclear norm can approximate the rank of the corresponding unfolding matrix, so the rank in mode-n can be approximated as

ğ‘Ÿğ‘›=âˆ‘ğ¼ğ‘›ğ‘Ÿ=1ğœğ‘Ÿ,
(4)
where ğœğ‘Ÿ(ğ‘Ÿ=1â‹…â‹…â‹…ğ¼ğ‘›) are the singular values of îˆ¼îˆ¼(ğ‘›).

(2)
Then, we calculate the importance degree of the mode-n :

ğ›½ğ‘›=ğ‘Ÿğ‘›ğ‘Ÿ1+ğ‘Ÿ2+ğ‘Ÿ3.
(5)
We use the sum normalization to obtain the same scaled important factors in different modes.

(3)
Finally, we use ğ›½ğ‘› to calculate the adaptive weight ğ‘¤ğ‘›:

ğ‘¤ğ‘›=ğ‘’ğœƒğ›½ğ‘›ğ‘’ğœƒğ›½1+ğ‘’ğœƒğ›½2+ğ‘’ğœƒğ›½3,
(6)
where ğœƒ>0 is a positive constant and the exponential function proportional to ğ‘¤ğ‘› is utilized to control the distribution of weights in different modes.

There are three motivations for using this specific formula in Eq. (6). First, the weights applied on each mode of the tensor should be proportional to the rank of the unfolding matrix in that mode. Second, the weight should be adaptive and sensitive to the rank and flexible to be controlled. Third, the weight should vary in a reasonable range to keep the balance between the data fidelity term and the regularization term.

Here we give an intuitive example to validate the effectiveness of the proposed adaptive weight estimation strategy. Figure 3 shows the reconstructed results of a synthetic HSI. It demonstrates that the reconstruction with the adaptive weight estimation strategy can promote both spatial accuracy and spectral fidelity. Meanwhile, the singular value distributions along three modes produced by our strategy are closer to the ground truth.

Dimension-Discriminative Low-Rank Tensor Recovery Based Reconstruction
Representative Systems
We briefly introduce two representative CHI systems, i.e., CASSI and DCD. It is worth noting that our method is also suited for other computational imaging systems, such as MSIS (Kittle et al. 2010; Wu et al. 2011), DCSI (Lin et al. 2014b) and SSCSI (Lin et al. 2014a). The difference between the implementation of CASSI/DCD and other CHI systems is only the forward imaging system principles. Therefore, our method can easily be extended to other CHI systems.

The incident light in the CASSI system, as shown in Fig. 4, is first projected onto the plane of a coded aperture through the objective lens. After spatial modulation by a coded aperture, the incident light goes through a relay lens and is spectrally dispersed in the vertical direction by Amici prism. Finally, the modulated and dispersed spectral information is captured by a grayscale camera. Let î‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğ›¬ denote the original HSI and ğ‘¥(ğ‘–,ğ‘—,ğœ†) is its element, where 1â‰¤ğ‘–â‰¤ğ‘€, 1â‰¤ğ‘—â‰¤ğ‘ index the spatial coordinate and 1â‰¤ğœ†â‰¤ğ›¬ indexes the spectral coordinate. The compressive measurement at position (i, j) on the focal plane of CASSI can be represented as:

ğ‘¦c(ğ‘–,ğ‘—)=âˆ‘ğœ†=1ğ›¬ğœŒ(ğœ†)ğœ‘(ğ‘–âˆ’ğœ™(ğœ†),ğ‘—)ğ‘¥(ğ‘–âˆ’ğœ™(ğœ†),ğ‘—,ğœ†),
(7)
where ğœ‘(ğ‘–,ğ‘—) denotes the pattern of the coded aperture, ğœ™(ğœ†) denotes the dispersion introduced by Amici prism, ğœŒ(ğœ†) is the spectral response of the detector and c denotes the CASSI branch. For brevity, let ğ‘Œğ‘Œcâˆˆâ„(ğ‘€+ğ›¬âˆ’1)Ã—ğ‘denote the matrix representation of ğ‘¦c(ğ‘–,ğ‘—). Then the matrix form of CASSI imaging can be expressed as:

ğ‘Œğ‘Œc=ğ›·ğ›·c(î‰„î‰„),
(8)
where ğ›·ğ›·c denotes the forward imaging function, which is jointly determined by ğœŒ(ğœ†),ğœ‘(ğ‘–,ğ‘—), ğœ™(ğœ†) and integration.

Fig. 4
figure 4
Diagram of two typical snapshot hyperspectral imaging systems

Full size image
The incident light in the DCD system, as shown in Fig. 4, is first divided into two directions by the beam splitter equivalently. The light in one direction is captured by the CASSI system, while the light on the other direction is captured directly by a grayscale camera. The uncoded measurement at position (i, j) on the panchromatic detector can be represented as:

ğ‘¦p(ğ‘–,ğ‘—)=âˆ‘ğœ†=1ğ›¬ğœŒ(ğœ†)ğ‘¥(ğ‘–,ğ‘—,ğœ†),
(9)
where p denotes the panchromatic branch.

Similar to the CASSI formulation in Eq. (8), Eq. (9) can be expressed in the matrix form as:

ğ‘Œğ‘Œp=ğ›·ğ›·p(î‰„î‰„),
(10)
where ğ‘Œğ‘Œpâˆˆâ„ğ‘€Ã—ğ‘denotes the uncoded measurements and ğ›·ğ›·p is the forward imaging function of the grayscale camera.

A general imaging representation of CHI can be derived as:

ğ‘Œğ‘Œ=ğ›·ğ›·(î‰„î‰„).
(11)
For CASSI, ğ‘Œğ‘Œ=ğ‘Œğ‘Œc and ğ›·ğ›·=ğ›·ğ›·c, For DCD, ğ‘Œğ‘Œ=[ğ‘Œğ‘Œc;ğ‘Œğ‘Œp] and ğ›·ğ›·=[ğ›·ğ›·c;ğ›·ğ›·p]. Actually, the goal of computational imaging reconstruction is to estimate î‰„î‰„ from the compressive measurements ğ‘Œğ‘Œ.

Reconstruction Formulation
By integrating the structure prior in ADLTR with the system imaging principle, a general reconstruction algorithm can be derived as follows:

minimizeî‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğœ†,îˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜12â€–ğ‘Œğ‘Œâˆ’ğ›·ğ›·(î‰„î‰„)â€–2ğ¹+âˆ‘ğ¿ğ‘™=1(ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13ğ‘¤ğ‘›rank(ğ‘ƒğ‘ƒğ‘™(ğ‘›))),
(12)
where ğ‘ğ‘™(â‹…) represents the operator extracting the 3D tensor îˆ¼îˆ¼ğ‘™ from î‰„î‰„ and L denotes the total number of exemplar tensors. Minimizing the rank of matrix in Eq. (12) is a NP-hard problem. To make a more explicit and accurate estimation, we further propose to introduce a non-convex relaxation of nuclear norm using a log-sum form:

minimizeî‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğœ†,îˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜12â€–ğ‘Œğ‘Œâˆ’ğ›·ğ›·(î‰„î‰„)â€–2ğ¹+âˆ‘ğ¿ğ‘™=1(ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13ğ‘¤ğ‘›ğ›©(îˆ¼îˆ¼ğ‘™(ğ‘›),ğœ–)),
(13)
where ğ›©(îˆ¼îˆ¼ğ‘™(ğ‘›),ğœ–)=âˆ‘ğ‘Ÿlog(ğœğ‘Ÿ(îˆ¼îˆ¼ğ‘™(ğ‘›))+ğœ–), ğœ– is a small positive constant number and ğœ(îˆ¼îˆ¼ğ‘™(ğ‘›)) defines the singular values of îˆ¼îˆ¼ğ‘™(ğ‘›).

Fig. 5
figure 5
Flowchart of the proposed method for CHI reconstruction. We first get an initialization from the compressive measurements. Then our reconstruction method, including matching, adaptive dimension-discriminative low-rank tensor recovery (shortened as ADLTR in the figure) and projection, is iteratively performed. Finally, we get the reconstructed HSI as output

Full size image
The above log-sum form of nuclear norm helps to faithfully preserve the desired structure information. Specifically, let ğ‘“(ğœ,ğœ–)=log(ğœ+ğœ–), ğ‘“(ğœ,ğœ–) can be approximated using the first-order Taylor expansion at ğœ=ğœğ‘¡, i.e., ğ‘“(ğœ,ğœ–)=ğ‘“(ğœğ‘¡,ğœ–)+<âˆ‡ğ‘“(ğœğ‘¡,ğœ–),ğœâˆ’ğœğ‘¡>, where ğœğ‘¡ denotes the result at the tth iteration. Actually, the solution of minğœğ‘“(ğœ,ğœ–) can be reasonably approximated by minğœ(ğœ/(ğœğ‘¡+ğœ–)) since the constants in the first Taylor expansion donâ€™t influence the minimization problem and can be neglected. Therefore, minğ›©(îˆ¼îˆ¼ğ‘™(ğ‘›),ğœ–) =minâˆ‘ğ‘Ÿ(ğœğ‘Ÿ(îˆ¼îˆ¼ğ‘™(ğ‘›))/(ğœğ‘¡ğ‘Ÿ(îˆ¼îˆ¼ğ‘™(ğ‘›))+ğœ–)). It means that those greater singular values at the tth iteration, which deliver more important information, will get a smaller weight and be shrunk by a lower amplitude at the (ğ‘¡+1)th iteration. Therefore, structure information can be faithfully preserved. A numerical iterative algorithm for solving Eq. (13) is proposed in the following.

Consequently, the overall flowchart of our reconstruction method based on the ADLTR model is illustrated in Fig. 5. Due to the advantage of the ADLTR model, the intrinsic high-order nature of HSI can be effectively exploited, which helps to obtain an accurate reconstruction result.

Optimization Algorithm
To optimize Eq. (13), we adopt an alternating minimization scheme to split it into two finer subproblems, i.e., updating low-rank tensor îˆ¼îˆ¼ğ‘™ and updating the whole HSI î‰„î‰„.

Updating Low-Rank Tensor îˆ¼îˆ¼ğ‘™
By fixing the HSI î‰„î‰„, we can estimate each low-rank tensor îˆ¼îˆ¼ğ‘™ independently by solving the following reformulated equation for ğ‘™=1,2,â€¦,ğ¿:

minimizeîˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13ğ‘¤ğ‘›ğ›©(îˆ¼îˆ¼ğ‘™(ğ‘›),ğœ–).
(14)
The difficulty for solving Eq. (14) is how to split the variables of the tensor îˆ¼îˆ¼ğ‘™ and its unfolding matrices îˆ¼îˆ¼ğ‘™(ğ‘›)(1â‰¤ğ‘›â‰¤3). We here employ the ADMM framework to solve the large scale optimization conundrum with multiple finer problems. Specifically, by introducing auxiliary variables îˆ¹îˆ¹ğ‘›=îˆ¼îˆ¼ğ‘™(1â‰¤ğ‘›â‰¤3), Eq. (14) can be reformulated into

minimizeîˆ¼îˆ¼ğ‘™,îˆ¹îˆ¹ğ‘›âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13ğ‘¤ğ‘›ğ›©(îˆ¹îˆ¹ğ‘›,(ğ‘›),ğœ–)subject to îˆ¹îˆ¹ğ‘›=îˆ¼îˆ¼ğ‘™,ğ‘›=1,2,3.
(15)
The augmented Lagrangian function of Eq. (15) can be expressed as:

ğ¿ğœ‡(îˆ¼îˆ¼ğ‘™,îˆ¹îˆ¹ğ‘›,î‰î‰ğ‘›)=ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13(ğ‘¤ğ‘›ğ›©(îˆ¹îˆ¹ğ‘›,(ğ‘›),ğœ–)+ğœ‡2â€–â€–â€–îˆ¹îˆ¹ğ‘›âˆ’îˆ¼îˆ¼ğ‘™+î‰î‰ğ‘›ğœ‡â€–â€–â€–2ğ¹),
(16)
where î‰î‰ğ‘› is the Lagrangian multiplier and ğœ‡ is a regularization factor. With the ADMM framework, îˆ¼îˆ¼ğ‘™ and îˆ¹îˆ¹ğ‘› can be iteratively updated with two subproblems.

îˆ¼îˆ¼ğ‘™-subproblem. For ğ‘™=1,2,â€¦,ğ¿, îˆ¼îˆ¼ğ‘™ can be updated by solving

minimizeîˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹+âˆ‘ğ‘›=13â€–â€–â€–îˆ¼îˆ¼ğ‘™âˆ’îˆ¹îˆ¹ğ‘›âˆ’î‰î‰ğ‘›ğœ‡â€–â€–â€–2ğ¹.
(17)
îˆ¼îˆ¼ğ‘™ admits a straightforward least-square solution:

îˆ¼îˆ¼ğ‘™=ğœğ‘ğ‘™(î‰„î‰„)+âˆ‘ğ‘›=13(ğœ‡îˆ¹îˆ¹ğ‘›+î‰î‰ğ‘›)ğœ+3ğœ‡.
(18)
îˆ¹îˆ¹ğ‘›-subproblem. For ğ‘›=1,2,3, îˆ¹îˆ¹ğ‘› can be updated by solving

minimizeîˆ¹îˆ¹ğ‘›âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜12â€–â€–â€–îˆ¹îˆ¹ğ‘›âˆ’îˆ¼îˆ¼ğ‘™+î‰î‰ğ‘›ğœ‡â€–â€–â€–2ğ¹+ğ›¼ğ‘›âˆ‘ğ‘Ÿlog(ğœğ‘Ÿ(îˆ¹îˆ¹ğ‘›,(ğ‘›))+ğœ–),
(19)
where ğ›¼ğ‘›=ğ‘¤ğ‘›/ğœ.

figure a
With the relaxation of log(ğœğ‘Ÿ(îˆ¹îˆ¹ğ‘›,(ğ‘›))+ğœ–), the log-sum nuclear norm regularization based problem Eq. (19) admits a closed-form solution, which can be effectively solved by a singular value thresholding algorithm. Specifically, for ğ‘›=1,2 and 3, îˆ¹îˆ¹ğ‘› can be updated by the following:

îˆ¹îˆ¹ğ‘›=foldğ‘›(ğ‘ˆğ‘ˆğ›´ğ›´ğ›¼ğ‘›ğ‘‰ğ‘‰ğ‘‡),
(20)
where ğ›´ğ›´ğ›¼ğ‘›=diag(ğ’ğ›¼ğ‘›,ğœ–(ğœ1),ğ’ğ›¼ğ‘›,ğœ–(ğœ2),â€¦,ğ’ğ›¼ğ‘›,ğœ–(ğœğ·ğ‘›)) and ğ‘ˆğ‘ˆdiag(ğœ1,ğœ2,â€¦,ğœğ·ğ‘›)ğ‘‰ğ‘‰ğ‘‡ is SVD of the mode-n matrix of îˆ¼îˆ¼ğ‘™âˆ’î‰î‰ğ‘›ğœ‡. The singular value thresholding operation ğ’ğ›¼,ğœ–(ğœ) is defined as:

ğ’ğ›¼,ğœ–(ğœ)={0sign(ğœ)(ğ‘0+ğ‘1âˆš2)if  ğ‘1â‰¤0if  ğ‘1>0
(21)
with that ğ‘0=|ğœ|âˆ’ğœ– and ğ‘1=(ğ‘0)2âˆ’4(ğ›¼âˆ’ğœ–|ğœ|).

Then we update î‰î‰ğ‘› with

î‰î‰ğ‘›=î‰î‰ğ‘›+ğœ‡(îˆ¹îˆ¹ğ‘›âˆ’îˆ¼îˆ¼ğ‘™).
(22)
Here we set a fixed iteration number ğ‘‡ğ‘ for the ADMM framework. It should be noted that the weight ğ‘¤ğ‘› used in Eq. (16) should be calculated with the proposed adaptive weight estimation strategy described in Sect. 3.3. More specifically, a new weight ğ‘¤ğ‘› will be obtained after updating îˆ¼îˆ¼ğ‘™ at each iteration.

Table 1 Average reconstruction results (PSNR(dB)/SSIM/ERGAS) of different methods on CASSI
Full size table
Updating the Whole HSI î‰„î‰„
Once we obtain the low-rank tensor îˆ¼îˆ¼ğ‘™, the whole HSI î‰„î‰„ can be updated by solving the following problem:

minimizeî‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğœ†12â€–ğ‘Œğ‘Œâˆ’ğ›·ğ›·(î‰„î‰„)â€–2ğ¹+âˆ‘ğ‘™=1ğ¿ğœâ€–â€–ğ‘ğ‘™(î‰„î‰„)âˆ’îˆ¼îˆ¼ğ‘™â€–â€–2ğ¹.
(23)
Actually, Eq. (23) is a quadratic optimization problem and admits a straightforward least-square solution:

î‰„î‰„=ğ›·ğ›·Â¯âˆ’1(ğ›·ğ›·ğ‘‡(ğ‘Œğ‘Œ)+2ğœâˆ‘ğ‘™=1ğ¿ğ‘ğ‘™ğ‘‡(îˆ¼îˆ¼ğ‘™)),
(24)
where ğ›·ğ›·Â¯=ğ›·ğ›·ğ‘‡ğ›·ğ›·+2ğœâˆ‘ğ‘™ğ‘ğ‘™ğ‘‡ğ‘ğ‘™. In practice, Eq. (24) can be solved by the conjugate gradient algorithm (Hestenes and Stiefel 1952). The complete reconstruction algorithm is summarized in Algorithm 1.

Experiments on Synthetic Data
Implementation Details
Systems and Datasets
The simulation in this section is conducted on two representative CHI systems, i.e., CASSI and DCD. We generate the mask of the coded aperture of CASSI as a random Bernoulli distribution with ğ‘=0.5. The dispersion of the Amici prism obeys a linear distribution across the wavelength dimension. Three public HSI datasets, including the Columbia dataset (Yasuma et al. 2010), the Harvard dataset (Chakrabarti and Zickler 2011) and the KAIST dataset (Choi et al. 2017) are used as synthetic data in our experiment. These datasets contain various real-world objects of different materials. In our experiment, the resolution of all tested images is cropped into 256Ã—256 and 31 spectral bands (400â€“700 nm in Columbia, while 420â€“720 nm in Harvard and KAIST). All tested HSIs are scaled into the interval [0, 1]. The compression ratios of CASSI and DCD are (ğ‘€+ğ›¬âˆ’1)ğ‘/ğ‘€ğ‘ğ›¬ â‰ˆ0.0360 and ((ğ‘€+ğ›¬âˆ’1)ğ‘+ğ‘€ğ‘)/ğ‘€ğ‘ğ›¬â‰ˆ0.0683, respectively.

Comparison Methods
We produce a thorough comparison with other reconstruction methods in this domain to verify the reconstruction performance. Specifically, our algorithm is compared with 5 prior regularization based methods, i.e., TV integrated with TwIST (Bioucas-Dias and Figueiredo 2007), AMP (Tan et al. 2016), 3DSR (Lin et al. 2014a), ANSR (Wang et al. 2017) and DeSCI (Liu et al. 2018), and 5 deep learning based methods, i.e., AE (Choi et al. 2017), ISTA (Zhang and Ghanem 2018), HRNet (Wang et al. 2018), ğœ†-Net (Miao et al. 2019) and SRP (Wang et al. 2019).

Parameters Setting
In order to produce a fair comparison, we make great efforts to achieve the best results for all the competing methods. Specifically, we set the parameters according to the released codes or corresponding publications and also consult the authors of these methods for the parameter tuning. For the Columbia dataset, we use 22 HSIs for training and 10 HSIs for testing. For the KAIST dataset, we use 29 HSIs for training and 3 HSIs for testing. For the Harvard dataset, we randomly select 35 HSIs for training and 9 HSIs for testing. The parameters of our proposed method are set as follows. We set the penalty factor ğœ=1 and the spatial patch size ğ‘ =5 with the overlapping size of 4 empirically. The factor ğœƒ in the adaptive weight estimation strategy is fixed to 100. 45 nearest similar patches are searched for each exemplary patch within a [âˆ’20,20]Ã—[âˆ’20,20] window. We execute our experiments on a platform of the Windows 10 64-bit system with Intel I7 6700 and 64 GB RAM.

Fig. 6
figure 6
Reconstructed quality comparison of CASSI. By comparing the reconstructed results and ground truth (shortened as GT in the figure), our method obtains better spatial contents and textures

Full size image
Fig. 7
figure 7
The spectral curves of the regions labeled in Fig. 6. The reconstructed curve of our method is closer to the ground truth (shortened as GT in the figure)

Full size image
Table 2 The correlation scores of the spectra curves in Fig. 7 between the ground truth and reconstruction
Full size table
Fig. 8
figure 8
The error maps comparison of three typical scenes in three datasets on DCD. Our method suffers from smaller error than other methods

Full size image
Fig. 9
figure 9
The spectral curves of the regions labeled in Fig. 6. The reconstructed curve of our method is closer to the ground truth (shortened as GT in the figure)

Full size image
Table 3 DCD reconstruction accuracy comparison with prior knowledge based methods on three datasets
Full size table
Evaluation Measures
For quantitative evaluation, four image quality indexes are adopted in our experiment: peek signal-to-noise ratio (PSNR), structure similarity (SSIM) (Wang et al. 2004), root mean square error (RMSE) and relative dimensionless global error (ERGAS) (Wald 2002). PSNR and SSIM are two kinds of criteria for spatial quality assessment, which measure the visual quality and structure similarity, respectively. A larger value of PSNR and SSIM suggests a better spatial reconstruction. RMSE and ERGAS are two measurements for spectral fidelity, where RMSE is calculated on each 1D spectral vector, and ERGAS is calculated on the weighted sum of MSE in each band. A smaller value of RMSE and ERGAS suggests a better spectral reconstruction.

Performance on CASSI
The average quantitative results of CASSI on three datasets are shown in Table 1. The best values for each index are highlighted in bold. We can see that our method obtains remarkable promotion in PSNR, SSIM, ERGAS, and RMSE compared with all state-of-art methods. Specifically, the quality promotion of our method upon TV, AMP and ANSR indicates the superiority of low rank prior in exploiting the intrinsic structure. The quality promotion upon DeSCI demonstrates that the high-order tensor is more efficient than the matrix to deliver the structure information of HSI. While the promotion upon the deep learning based methods demonstrates that the low-rank prior with high-order optimization can account for the intrinsic property faithfully. Note the PSNR of ours is 1.21 dB, 0.64 dB, and 0.68 dB higher than the other state-of-arts methods on the three datasets, respectively. Therefore, our method is accustomed to various scenes and materials.

Visual comparison on three datasets is shown in Fig. 6. For a comprehensive comparison, we convert HSIs into RGB images using the CIE color mapping. We can see that more spatial details and textures are obtained in our method. By contrast, other prior based methods introduce over-smoothing artifacts and noise while deep learning based methods lose texture structures. Figure 7 are the spectral curves of the representative regions, which are labeled in Fig. 6, and Table 2 is the corresponding correlation scores between ground truth and reconstruction. It shows that the spectral curves of our method are relatively closer to the ground truth and owns higher correlation scores. Therefore, our method outperforms all the competitive methods in terms of both spectral and spatial accuracy on CASSI.

Performance on DCD
Next, we evaluate the performance of our method on DCD. The learning based methods are all based on the block layout to reconstruct HSI. However, the dispersion in CASSI leads to a mismatch in the two branches of DCD. Such mismatch results in that block layout based methods can not be implemented on DCD. Until now, no deep learning based method has been reported for DCD. So here we compare our method only with the prior regularization based methods. The average quantitative results of three datasets are presented in Table 3. It shows that our method can produce the best quantitative performance.

Further, we show the average absolute error maps between ground truth and restored results in Fig. 8. It can be seen that the results produced by our method own less reconstruction error, which verifies that our method obtains higher spatial accuracy. We display the spectral curves of the representative regions in Fig. 7 and the corresponding correlation scores in Table 2. It shows that the curves of our method are closer to the ground truth with higher correlation, which verifies the spectral superiority. Therefore, our method is also superior to all compared methods on DCD.

Ablation Study
Here we carry out an extended ablation study on the effectiveness of the ADLTR model and the impact of important parameters to make our contributions more distinct and convincing.

Effectiveness of ADLTR
We first show the changes of the calculated weights with iteration in Fig. 10. With the increase of iteration, the weights of different modes tend to be stable. Meanwhile, since the non-local similar patches usually own higher correlation, the rank of mode-3 is lower than that of other modes. Therefore, the ADLTR model provides a smaller weight reasonably.

We then conduct an experiment to comprehensively evaluate the effectiveness of the ADLTR model. On the one hand, to justify the dimension-discriminative low-rank property, we address the impact of each dimension by exploiting the low-rankness prior on only one mode. On the other hand, we verify the effectiveness of the proposed adaptive weight estimation strategy.

Fig. 10
figure 10
The changes of the weights with iteration

Full size image
The average results of the CAVE data on CASSI by setting different weights are shown in Table 5. It means only exploiting the spatial self-similarity, spectral correlation, and spatialâ€“spectral correlation by setting the weight as [1, 0, 0], [0, 1, 0] and [0, 0, 1], respectively. By comparing the results of the first three rows with that of the weight fixation as [1, 1, 1], we can see that the dimension-discriminative low-rankness on three modes can efficiently promote the reconstructed quality. Further, the promotion of the adaptive weight upon the results of the manually fixed weight indicates that the proposed adaptive weight estimation strategy can further improve reconstruction quality.

Impacts of Important Parameters
Further, there are some parameters that have significant impacts on the performance of our method, i.e., the spatial block size s in the patch matching and the factor ğœƒ in the adaptive weight estimation strategy.

The block size s is a scale parameter for preserving the spatial feature. Bigger or smaller values of s would lead to loss of spatial information and degradation of reconstruction accuracy. Figure 11a shows the PSNR results with different values of block size s. It can be seen that the best results can be obtained when ğ‘ =6.

Table 4 The correlation scores of the spectra curves in Fig. 9 between ground truth and reconstruction
Full size table
Table 5 The results by setting different weights
Full size table
Fig. 11
figure 11
The impact of block size and the factor on reconstruction accuracy

Full size image
The factor ğœƒ is a scale parameter used to balance the weight distribution based on the low-rank degree of different modes. The mode with a low-rank degree should be shrunk by a low threshold value, so ğœƒ is supposed to be positive. Figure 11b shows the PSNR results of different values of ğœƒ. It can be seen that a good reconstruction result can be obtained when ğœƒ is set in the range [50, 100].

Experiments on Real Data
We further evaluate the performance of the proposed method on the real captured data. To this end, we have built a hardware prototype as shown in Fig. 12. Both branches are equipped with a band-pass optical filter from 450 to 700 nm. The light into the CASSI branch is randomly modulated by a customized coded aperture obeying a random binary pattern with 300Ã—300 elements, and the spatial size of each element is 10 Âµm Ã— 10 Âµm. Then the spatially coded light gets spectrally dispersed by the Amici prism with the central wavelength at 550 nm in the vertical direction. The whole spectrum spanning is discretized into 28 bands. Finally, the light is captured by a grayscale camera (PointGrey FL3-U3-13Y3M) with a resolution of 1280 Ã— 1024. Due to the effect of the relay lens (Edmund 45-762), each element on the coded aperture is optically mapped to 2 Ã— 2 pixels on the camera in CASSI. The panchromatic branch contains the same detector as CASSI to capture the uncoded information.

Fig. 12
figure 12
Hardware system for capturing the real scene

Full size image
Fig. 13
figure 13
Measurements of two real scenes Ninji and Box. (a) and (b) are the CASSI images. (c) and (d) are the corresponding panchromatic images of DCD

Full size image
Fig. 14
figure 14
Reconstruction performance comparison of the real data on CASSI. Compared with other methods, our method can produce better visual details

Full size image
Fig. 15
figure 15
Reconstructed RGB images of the real data on DCD. Compared with other methods, our method can produce better or competitive visual details

Full size image
The captured scenes are two cartoon covers under the laboratory ambient light condition. The compressive measurements of CASSI and the panchromatic images of DCD are shown in Fig. 13. We also capture a hyperspectral image with a scanning-based commercial spectrometer (SOC 710) for reference.

The reconstruction images and the local magnification maps on CASSI are shown in Fig. 14. The results on DCD are shown in Fig. 15. For better visual comparison, we convert the reconstructed HSIs on DCD into RGB images using the CIE color mapping. To further demonstrate the spectral performance, we display the spectral curves and their correlation scores of the two regions in Figs. 16 and 17. In the reconstructed images, we can see that TV and 3DSR suffer from over-smoothing and indistinct textures, ANSR and DeSCI introduce stripe artifacts and ğœ†-Net introduces severe noise. In contrast, our method can produce better spatial structure details. Meanwhile, the spectral curves of our method are closer to the reference with higher correlation, which demonstrates the superiority of our method. Therefore, our method is also potential to be applied in real applications.

Fig. 16
figure 16
The spectral curves and their correlation scores on CASSI of the regions labeled in Fig. 15

Full size image
Fig. 17
figure 17
The spectral curves and their correlation scores on DCD of the regions labeled in Fig. 15

Full size image
Table 6 Reconstruction results under 3 different levels of Gaussian noise variance
Full size table
Discussion
Performance Under Noisy Measurements
The observed compressive measurements in practice usually suffers from various noise, such as Gaussian white noise and Poisson noise. Gaussian white noise is mainly caused by insufficient background light and high detector temperature, while Poisson noise results from the random photon fluctuation when the detector receives the light. Here we implement an additional experiment under such two types of real noise to validate the robustness of our method. To generate the compressive measurements with Poisson noise (Salmon et al. 2014; Giryes and Elad 2014), the peak value of the noise-free measurements is set as 255. The average results of the KAIST data on DCD under Gaussian white noise with different variance are shown in Table 6. The average results under Poisson noise are shown in Table 7. It can be seen that reconstruction with a single sparse prior, such as TV, AMP, and 3DSR, leads to serious accuracy degradation when considering the noisy measurements. ANSR and DeSCI exploit the spatialâ€“spectral correlation for denoising and produce a sub-optimal reconstruction. In contrast, our method with full consideration of the inherent high-order nature of HSI can effectively reduce the impact of noisy measurements on reconstruction and obtain the most robust results.

Table 7 Reconstruction results under Poisson noise, the corresponding average SNR is 9.12 dB
Full size table
Table 8 Average results on DCD of two remote-sensing datasets
Full size table
Performance on Remote-Sensing Datasets
Remote-sensing is an important application field of HSI. We implement reconstruction with two remote-sensing datasets on DCD to demonstrate the performance of our method. We use the PAVIA Center data (Zhao and Du 2016) and the Chikusei data (Yokoya and Iwasaki 2016) as the reference images. The PAVIA Center data is the HSI of Pavia, Italy, including 102 spectral bands from 430 to 860 nm. The Chikusei data is the HSI of Chikusei, Japan, including 128 bands from 360 to 1018 nm. In order to remove the influence of noise, we remove 5 bands at each end. Meanwhile, the resolution of both tested images is cropped into 256Ã—256. The average numerical results of remote-sensing datasets are shown in Table 8. And the absolute error between the ground truth and restored results across spectra is shown in Fig. 18. We can see that our method obtains the best quality in terms of both spatial accuracy and spectral fidelity on remote-sensing datasets.

Performance Under Imperfect Calibration
Optical calibration is important in hardware implementation. In particular, the incident light and its compressive measurements should meet the requirements of spatial alignment in the imaging process. We execute an extended experiment when the measurements of two branches on DCD exist a misalignment to validate the robustness to imperfect calibration. Specifically, there is a pixel offset between the measurements of the CASSI branch and that of the panchromatic branch. The reconstruction results are shown in Table 9. We can see that our method obtains the best quality, which validates the reconstruction robustness of our method.

Fig. 18
figure 18
The absolute error along spectra of two remote-sensing datasets

Full size image
Table 9 Reconstruction results when the measurements of two branches on DCD exists imperfect calibration
Full size table
Computational Complexity Analysis
Considering Algorithm 1 for reconstructing a HSI î‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğ›¬, the main complexity lines in three aspects: constructing L low-rank tensors îˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜, updating L low-rank tensors îˆ¼îˆ¼ğ‘™âˆˆâ„ğ‘ 2Ã—ğ›¬Ã—ğ‘˜, and updating the whole HSI î‰„î‰„âˆˆâ„ğ‘€Ã—ğ‘Ã—ğ›¬.

In our implementation, we construct the low-rank tensor îˆ¼îˆ¼ğ‘™ with the nearest neighbor algorithm. The computational complexity of the nearest neighbor algorithm is îˆ»(ğ¿ğ‘ 2ğ›¬). We update the low-rank tensor îˆ¼îˆ¼ğ‘™ based on the economic SVD. Therefore, the main complexity of updating îˆ¼îˆ¼ğ‘™ is consumed by performing SVD on the unfolding matrices îˆ¼îˆ¼ğ‘™(ğ‘›),ğ‘›=1,2,3. Accordingly, the computational complexity is îˆ»(ğ¿(ğ‘ 4+ğ›¬2+ğ‘˜2)). We update the whole HSI î‰„î‰„ with the conjugate gradient algorithm. Therefore, the computational complexity is îˆ»(ğ‘€ğ‘ğ›¬ğ‘‘â€¾â€¾âˆš) (Shewchuk et al. 1994), where d is the conditional number of ğ›·ğ›·Â¯.

Since we introduce 3D tensor to model the image prior, the computational complexity is reasonably increased. In practice, it takes 20 min to reconstruct a 320Ã—256Ã—24 HSI of real data with our method while DeSCI takes 14 min. However, constructing and updating L low-rank tensors can be processed in parallel (Zhang et al. 2018a), each with relatively small computation complexity. In that way, the complexity of constructing and updating low-rank tensors becomes îˆ»(ğ‘ 2ğ›¬) and îˆ»(ğ‘ 4+ğ›¬2+ğ‘˜2), respectively. Therefore, the consuming time can be further decreased.

Conclusion
In this paper, we proposed a general reconstruction method based on the ADLTR model for CHI. We utilized 3D tensors to exploit the intrinsic properties of HSIs, including spatial self-similarity, spectral correlation, and joint correlation to boost the reconstruction performance. To figure out the multi-dimensionality diversity, a dimensional-discriminative low-rank tensor recovery model based on an adaptive weight estimation strategy is developed. Then the tensor recovery model and the compressive sensing process are united in a general reconstruction formulation, which can be effectively solved by an iterative numerical algorithm. We implemented experiments on CASSI and DCD to verify the superior performance of our method.

So far, one of the most important issues for real CHI applications is to reconstruct the underlying HSI with high spatial and spectral quality. Although considerable works have been published in this domain, there is still a gap between simulation conditions and real applications. For example, the performance of deep learning based methods inevitably depends on the content correlation between the training and testing datasets. As a contrast, our method takes full consideration in the intrinsic properties of HSI and achieves state-of-the-art performance on both synthetic and real data, which verifies the practical application potential of our method. We believe our method can provide positive encouragement to further promote the performance of CHI systems in practice.

It is also worth mentioning that our method can be extended neatly to temporal imaging system (Llull et al. 2013; Yuan et al. 2014). We know that the temporal video contains a similar 3D structure with HSI and thus exhibits a homologous prior. Therefore, our method based on the ADLTR model can also be applied to snapshot-video reconstruction. This will be one of the directions in our future work.

In some practical applications, such as recognition and detection, real-time acquisition of spectral information is an important foundation of the imaging system. In our method, the constructing and updating of low-rank tensors require a relatively high computational workload, which inevitably results in that our methon can not reconstruct HSI with a real-time speed. Fortunately, by utilizing the high parallelism in such two processes, we can handle this issue with fast implementation on GPU. This will be another direction in our future work.