Various types of electric fields contained in the laboratory and astrophysical plasma cause a Stark broadening of spectral lines in plasma. Therefore, a large number of spectroscopic diagnostics of laboratory and astrophysical plasma are based on experimental and theoretical studies of Stark broadening of spectral lines in plasma. The topic of the present investigation is the Stark broadening caused by free electrons in plasma and its dependence on certain atomic parameters using a new method based on the machine learning (ML) approach. Analysis of empirical data on atomic parameters was done by ML algorithms with more success that it was previously done by classical methods of data analysis. The correlation parameter obtained by artificial intelligence (AI) is slightly better than the one obtained by classical methods, but the scope of application is much wider. AI conclusions are applicable to any physical system while conclusions made by classical analysis are applicable only to a small portion of these systems. ML algorithms successfully identified quantum nature by analyzing atomic parameters. The biggest issue of classical analysis, which is infinite spectral line broadening for high ionization stages, was resolved by AI with a saturation tendency.

Introduction
One of the greatest challenges of the modern science is the processing of enormous amounts of data. Two primary goals in this field are how to learn from data and how to make data predictions [37]. Data science and machine learning (ML) have made tremendous progress in the last few decades. Statistical physics have a great contribution to the development and understanding methods in ML [6]. ML algorithms have become very important in the analysis of data in physics and related sciences. ML methods have been shown to be useful in different physical sciences: astrophysics, particle physics, chemical physics, condensed-matter physics, quantum physics. In astrophysics and particle physics experiments such as CMS and ATLAS at the LHC in CERN, as well as projects such as the Sloan Digital Sky Survey (SDSS), gives enormous amount of data measuring the particle collisions and properties of a billion stars and galaxies [37]. Object classification in astrophysics is very important task [3, 27, 46] whose successful solution enables easier selection of objects according to certain criteria and their further study. Use of ML algorithms enables the solution of numerous problems in the processing of astronomical data and enables the consideration of dependences and correlations that have not been observed before [25, 26, 44, 45]. In one of the most significant modern experiment: observation of the gravitational waves arises from the merger of a binary black hole, ML algorithms are used to clear the noise in the signals of gravitational waves [1, 57]. Large development in the domain of data science, as well as the strengthening of connection to quantum physics, enabled the development of our knowledge of the matter. Namely, atomic physics is a base for the creation of new molecules and advanced materials, as well. The theoretical basis of atomic physics is quantum mechanics. Quantum mechanics has provided a base for successful research of molecular physics and condensed matter physics, as well as nuclear physics and particle physics. Consequently, the development of ML algorithms recently has been used to address fundamental questions in the domain of quantum physics [4, 49]. One of the big problems in quantum physics is the inability to solve the Schrödinger equation for multiparticle systems, i.e., inability to obtain appropriate wave functions. In quantum chemistry and chemical physics, ML algorithms are used for analysis and prediction of physical and chemical properties, chemical structures, optimization of reaction parameters and process conditions (a type of reagents, catalysts, concentration, time, temperature), prediction of new reaction design, maximization of the production rate of chemical reactions [2, 9, 18, 29, 59, 60]. In condensed-matter physics and material science, ML has been used to improve the calculation of material properties, as well as a modeling of properties of new materials [10, 12, 19, 43, 58]. Learning techniques can be used for the research of advanced materials: materials for memory devices, solar cells, batteries, sensors, nanoparticle catalysts, supercapacitors, superhard material, etc.

From interconnections between quantum physics and ML, scientific community has huge expectation [4, 8, 23, 24, 32, 33, 35, 38, 49, 54]. There are many current questions about entanglement classification [23], quantum state tomography [54], solving the quantum many-body problem [8, 24]. There are many interesting active ML models with the aim of creation of new quantum experiments [32, 33, 38], as well as quantum machine models [17]. Also, ML can be used to discover physical concepts from new experimental data [28]. ML approaches have been applied to atomic physics. The neural networks can be used as a representation of quantum states [6]. There is a lack of atomic parameters for heavy elements and high ionized atoms. ML can be applied to the classification of heavy atoms energy levels according to their electronic configurations [7, 41]. Learning techniques have been applied for the investigation of atomic processes, like ionization and radiation [6]. Analysis of spectra from stars and quasars, as well as laser-produced and fusion plasma, can be done with the help of ML [40, 45]. The knowledge of atomic parameters is a base for atomic processes modeling. The aim of this research work is to use machine learning algorithms for modeling Stark spectral line broadening.

Stark broadening of spectral lines is a tool for spectroscopic diagnostics of laboratory plasma, as well as astrophysical and fusion plasma. In astrophysics, stark line widths are used for analysis of stellar spectra, investigation of chemical abundances of elements in different stellar objects, opacity calculations. Recently, it has been shown that Stark broadening has a big influence on the uncertainties in the calculation of the solar opacity [34]. Spectral analysis has a very important role in the physics of fusion plasma, too. Part of the current research in this field is concentrated on the possibility of using various durable materials, (as Mo, Ti, Zr...) for tungsten alloying. During the operation of fusion machines, it is expected that a small amount of these materials would be found in the peripheral regions of confined plasma, because of the spattering process. Stark widths of these atoms and their ions are needed for a detailed spectral analysis and diagnostics.

Stark broadening of spectral lines of neutral atoms and ions is used in science for a number of problems in various physical conditions. Theoretical calculations of the Stark width values usually use one of the models given by Griem et al. [20]; Sahal-Bréchot et al. [47]; Griem [21]; Dimitrijević and Konjević [13]. Recent research indicates the importance and usefulness of searching for possible types of regularities in the framework of a Stark broadening investigation [16, 53, 56]. Still, existing tables with calculated and measured Stark widths have a big lack of data. There is a need for Stark widths data in the wide range of chemical elements, plasma temperature and electron densities. In this paper a correlation between Stark broadening and environment parameters, such as the ionization potential of the upper level of the corresponding transition, electron density and temperature, will be investigated using modern ML algorithms. If this method proves to be accurate enough, the process of calculating the value of stark widths will be significantly accelerated and facilitated.

Theoretical background of Stark line broadening
One of the primary deexcitation ways of excited atoms is photon emission. A cumulative signal obtained from a radiating medium (for example plasma) is a spectral line with a small frequency range. Each spectral line emitted by atoms in plasma has a finite frequency range represented as line width. Generally, there are four types of spectral line broadening in plasma. One is a natural line broadening, related with the uncertainty in the energy of the states involved in the transition profile, with line width negligible compared to the other broadening mechanisms. The second is instrumental line broadening which includes the influence of spectral device on a line profile. Doppler broadening is caused by a distribution of velocities of atoms or molecules and depends on plasma temperature. The pressure broadening, which generally depends on pressure (i.e., density of active species) and temperature, results from the interactions of the emitters with neighboring neutral particles (resonant and Van der Waals broadening) and ionized particles (Stark broadening). Natural and instrumental broadening are always present. The existence of other types of spectral line broadening depends on the plasma conditions. Stark broadening is caused by the free charges which surround the emitters in plasma and produce the local electric field which affects the emission process, giving rise to shifts of the emission wavelengths or changes in the phase of the radiation. This is observed as a phenomenon of broadening and shift of the spectral lines [22]. This effect is determined by the intensity of the local electric field and it depends on the density of charged particles in the plasma (electrons and ions). The influence of free electrons on the line broadening in plasma is much more pronounced than the influence of ions. The topic of the present investigation is the Stark broadening caused by free electrons in plasma using new method based on ML approach.

The general formula for Stark width calculation in the impact approximation, which is appropriate to use in the overwhelming number of cases, is [22]:

𝜔=𝑁𝑒⟨𝑣⋅⎛⎝⎜⎜𝜎𝑖𝑓+∑𝑖′𝜎𝑖𝑖′+∑𝑓′𝜎𝑓𝑓′⎞⎠⎟⎟⟩𝑎𝑣
(1)
The line has a Lorentzian profile whose width is 𝜔, expressed in angular frequencies unit [rad/s]. 𝑁𝑒 and v are electron density and velocity, respectively. The average is being over the velocity distribution of perturbing electrons. The cross sections 𝜎𝑖𝑖′ (𝜎𝑓𝑓′) are for inelastic scattering on the initial (final) state of the line,

while 𝜎𝑖𝑓 is an effective elastic cross section to be calculated essentially from the difference of elastic scattering amplitudes 𝑓𝑖 and 𝑓𝑓.

The formula proposed by Griem [22] is very complicated, it cannot be resolved exactly, so it is useful to use different approaches in the calculation. The regularity approach which correlates Stark width of spectral line, 𝜔, expressed in [rad/s], electron density 𝑁𝑒, electron temperature 𝑇𝑒 and positive value of electron binding energy on the upper level of the transition, expressed in [eV], is given by Purić and Šćepanović [42] (Eq. 2):

𝜔=𝑍𝑘𝑒⋅𝑎⋅𝑁𝑒⋅𝑓(𝑇𝑒)⋅𝜒−𝑏
(2)
where 𝑍𝑒=1,2,3... for neutrals, singly charged ions, ... respectively and it represents the rest core charge of the ionized emitter and a, b and k are coefficients independent of electron concentration and ionization potential for a particular transition and the rest core charge of the emitter. In Eq. 2, stark width is expressed in radian per second and this is the only suitable unit to analyze the regularity of Stark broadening. If regularity analysis use wavelengths (𝜆) and line widths (Δ𝜆) expressed in meters, Eq. 2 should be written as follows:

Δ𝜆=𝑍𝑘𝑒⋅𝑎⋅𝑁𝑒⋅𝑓(𝑇𝑒)⋅𝜒−𝑏⋅𝜆22⋅𝜋⋅𝑐
(3)
In Eq. 3, every transition have its own wavelength, while the other parameters remain unchanged, so regularity can’t be seen.

Atoms and ions with the same number of electrons form an isoelectronic sequence. It is expected that spectral series within an isoelectronic sequence show regularity behavior because a wide range of atomic/ionic parameters depend on the electron number. The results obtained by regularity studies have proven to be very precise and this approach has been used in previous papers of our group. In the last decade we have investigated Stark broadening regularities using Eq. 2 within spectral series of individual elements [14, 15, 30, 51, 52], within spectral series of individual isoelectronic sequences [53, 55, 56] and we published one paper with analysis of Stark line broadening regularities within two spectral series of isoelectronic sequences simultaneously: potassium and copper [16]. The present investigation goes one step further and analyses all elements for which there are available data needed for Stark broadening investigation, simultaneously, using machine learning approach. The aim is to find the best possible model which correlates Stark width of spectral line with all available parameters for transition of interest (atomic parameters and environmental parameters).

Dataset creation and data cleaning
In order to create our dataset we used two public repositories connected with atomic spectroscopy. First one is Stark B database [48], where the parameters of Stark broadening for different emitters are given. The features taken from this database are: chemical element, ionization stage, upper and lower level of spectral transitions, Stark broadening, the environment temperature and electron density in environment. In the available database, stark widths are expressed in angstroms (1 angstrom = 10−10 m). For analysis purpose, angstroms are converted in radian per second [53] (Eq. 4). In the physical sense, radian per second is unit related with energy.

𝜔=2𝜋⋅𝑐⋅Δ𝜆𝜆2
(4)
We also performed data analysis with Stark widths expressed in meters, using machine learning and results have not shown any meaningful trends. This is confirmation that radians per second are suitable unit for machine learning approach, too. When the difference between energy levels of the same multiplet is small compared to the distance to the next level linked by an allowed transition, all the fine structure lines of the same multiplet have the same width and shift in Stark B database . In that case, the data are given of the multiplet only (𝑤mult) and for an average wavelength of the whole multiplet (𝜆mult). The width value for a particular line (𝑤line) within a multiplet is obtained from:

𝑤line=𝑤mult⋅𝜆2line𝜆2mult
(5)
To ensure better results, we enriched features taken from Stark B database with ones taken from NIST Atomic Spectra database [31]: binding energy of both upper and lower transition levels, ground level energy, total angular momentum quantum number J of both upper and lower transition level, as well as principal n and orbital ℓ quantum numbers and total angular momentum J quantum numbers of upper and lower transition levels.

The algorithm of connecting those two databases to form our own works as described below. For every transition connected with certain chemical element, we take the electronic configuration of both upper and lower levels from Stark B database. Then, we look for that particular element in NIST database and compare the electronic configurations. If they match, then we take the binding energy of those levels, their principal quantum number n, orbital quantum number ℓ and total angular momentum quantum number J and finally the ionization energy of that atom. The ionization energy is needed for calculation of the so-called upper level ionization potential 𝜒. For practical purposes, we replaced the chemical element name with its atomic number Z and its charge, obtained from periodic system of elements (i.e., instead of Ar+2, we used Z = 10 and charge = + 2). For better understanding of the algorithm mentioned above, pseudo code is given in table Algorithm 1 while the complete code can be found at https://github.com/ivantraparic/StarkBroadeningMLApproach. After we completed the creation of database, it consisted of 54,236 successfully matched transitions for 53 different emitters.

Then we proceeded with data cleaning. Outliers were detected as those transitions where the energy of upper level is smaller than the energy of lower level, which is physically impossible, thus those lines were removed from the database. Next, we excluded transitions given for temperatures above 150,000 K and electron densities above 1018cm−3, because we are currently not interested in making predictions for those plasma conditions. As a result, this dataset contains 53 emitters and 34,973 spectral lines and follows a normal distribution.

figure a
It consisted of 15 columns, 14 of those were our features (atomic number Z, electron temperature, electron density, charge, lower level ionization potential 𝜒, ground level energy, lower level energy, lower level J, upper level energy, upper level J, principal quantum number of lower level 𝑛𝑓, orbital quantum number of lower level ℓ𝑓, principal quantum number of upper level 𝑛𝑖, orbital quantum number of upper level ℓ𝑖), and 15th column was our target value 𝜔.

Model creation and training
For model creation and training, we used public Python package Sci-kit learn. We created four models, every being Pipeline with two steps. In each object of Pipeline class, the first step was data scaling using StandardScaler, and in second step we made our predictions with defined model. Considered models were: Linear Regression, Decision Tree Regressor, Random Forest Regressor and Gradient Boosting Regressor. We split the dataset into training and test dataset using train_test_split method, leaving 25% of the data for testing. To find the best model out of four considered, and best parameters for that model, we used ShuffleSplit combined with GridSearchCV. In ShuffleSplit object we set number of splits to 5, and we left 30% of data for testing. In GridSearchCV object we set cross validation to ShuffleSplit object. The values for parameters of models used in GridSearchCV are presented in table 1. Other parameters of the model remained at their default values.

Table 1 List of ML algorithms and parameters
Full size table
To rank the performance of models, we used best Coefficient of Determination, 𝑅2, value obtained after GridSearchCV algorithm finished. We have taken the parameters that the algorithm used to score that particular 𝑅2. As a result, we got that the best 𝑅2 value was for Random Forest Regressor having 𝑅2 = 0.95 for n_estimators = 100. The results of other model is given in table 2.

Table 2 List of ML algorithms and their final score
Full size table
So, our winning model after performing hyper parameter tuning using GridSearchCV was Random Forest Regressor with number of estimators set to 100. Random Forest is a learning method that operates by constructing a large number of decision trees during the training process [5]. It is simple to use and shows high performance for a wide variety of tasks, making it one of the most popular ML algorithms in different sciences. Random forests are an effective tool in predicting new data, in our case new atomic parameters. It should be emphasized that Breimans paper [5] is cited more about 30,000 times (Web of Science: 36.234, CrossRef: 27.683). In order to check overfitting of the winning model, we did 𝑅2 score check of the model on both training and test datasets. Training 𝑅2 score was 0.98, and test score was 𝑅2=0.95, so we were sure our model is not overfitting the data.

Results
The Random Forest model is used to calculate Stark broadening data for spectral series within neutral lithium Li I. Calculated stark widths (red lines) for transitions within analyzed series are represented with existing known values of Stark widths data at the same graphs.

Figure 1 shows the dependence of the Stark width (𝜔) on the reciprocal value of the electron binding energy at the upper level of the transition (𝜒−1) for 2s-np and 3s-np transitions within lithium atom at a temperature of T = 30,000 K and electron concentration 𝑁𝑒=1020m−3.

Fig. 1
figure 1
Stark widths regularities within 2s-np i 3s-np spectral series of Li I (T = 30,000 K, 𝑁𝑒=1020m−3)

Full size image
Figures 2 and 3 show the change in Stark width under the same conditions (temperature 𝑇=30,000K and electron concentration 𝑁𝑒=1020m−3), but for 2p-nd and 3p-nd transitions, as well as 3d-np and 4d-np. A very good description of the atomic structure of lithium, i.e., the values of atomic parameters, can be observed. Interestingly, points 2s-2p and 2p-3d were omitted in our previous analysis [15], while the ML algorithm includes them in the overall analysis and gives excellent agreement with the Stark width value.

Fig. 2
figure 2
Stark widths regularities within 2p-nd and 3p-nd spectral series of Li I (T = 30,000 K, 𝑁𝑒=1020m−3)

Full size image
Fig. 3
figure 3
Stark widths regularities within 3d-np and 4d-np spectral series of Li I (T = 30,000 K, 𝑁𝑒=1020m−3)

Full size image
Of special importance is the possibility of obtaining the value of stark widths at higher energy levels, for which these data are not quantitatively calculated. Figure 4 shows the change of Stark widths for the 2p-ns and 3p-ns transitions at a temperature of T = 30,000 K and electronic concentration 𝑁𝑒=1022m−3. In Fig. 5, the conditions are the same, but the initial values of the Stark width and the values obtained by the ML algorithm are given for higher energy levels of lithium atom. A slight saturation of the values of Stark parameters at higher energy levels can be observed.

The functional dependence obtained using the ML algorithm describes the quantum structure of the energy levels of lithium atoms. From the model lines (red lines), it can be concluded that the model successfully (within the error) indicates the quantum nature of atomic transitions and that other results do not make physical sense, but only jumps.

Fig. 4
figure 4
Stark widths regularities within 2p-ns and 3p-ns spectral series of Li I (T = 30,000 K, 𝑁𝑒=1022m−3)

Full size image
Fig. 5
figure 5
Stark widths predictions for 2p-ns and 3p-ns spectral series of Li I (T = 30,000 K, 𝑁𝑒=1022𝑚−3)

Full size image
Conclusion
Analysis of spectral data on Stark broadening for 53 different emitters and 34973 lines by ML algorithms was done with more success than it was previously done by classical methods of data analysis. Random forest has scored an average of 𝑅2=0.95 which makes it an excellent choice for Stark broadening calculations. The correlation parameter obtained by AI is slightly better than the one obtained by classical methods of Stark broadening analysis, but the scope of application is much wider. AI conclusions are applicable to any physical system while conclusions made by classical analysis are applicable only to a small portion of these systems, mostly to ions with low ionization stage. This improves the quality of predictions and enhance a broader usability of results. In fact, these results can be used for any transition and any environment without any restrictions. ML algorithms successfully identified quantum nature by analyzing Stark broadening parameters which can not be done with similar analyses that used classical methods and obtained linear correlation. The biggest issue of the classical analysis is infinite spectral line broadening for high ionization stages and it was successfully resolved by AI with a saturation tendency.

The process of calculating the values of Stark widths, which is used in science for a number of problems in various physical conditions in spectroscopic diagnostics of laboratory plasma, as well as astrophysical and fusion plasma, is significantly accelerated and facilitated with new method based on ML and proposed in the present paper. Using our new proposed model, Stark databases can be significantly improved. For example, Stark broadening calculations can be made for some spectral transitions within W, Ti, Mo and Zr atoms, which are common in nuclear fusion diagnostics and of interest for spectral analysis in fusion physics [39], as titanium, molybdenum and zirconium are used as alloying materials for tungsten [11, 50]. Lines of Ti are used for astrophysics diagnostics, too [36]. Despite their significance, there is a very big lack of Stark data for these atoms and their ions. There is a lot of missing energy data for higher energy levels for W, Ti, Mo and Zr atoms and their ions. For example, there is no precise value of energy for 6p level for Ti II, so there is no calculated Stark data for transition for which this level is the closest perturbing level. Although very rich in data, NIST database does not have energy values data for all possible excited states of atoms. With standard known methods for Stark width calculation, it is not possible to calculate Stark widths for levels for which energy values of the closest perturbing levels are missing, but ML algorithms enable calculation in these situations, too. In next step, ML predictions and analytic calculations will be compared and ML technique will be used for atomic parameters analyses. Special attention will be paid to spectral lines that are important for fusion and astrophysical research.

Keywords
Machine learning
Stark broadening
Atomic data
Plasma physics