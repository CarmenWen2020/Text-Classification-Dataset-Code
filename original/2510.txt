Coconut (Cocos nucifera) is one of the major plantation crops in Sri Lanka. It has paved the way for establishing many industries due to versatility of the crop earning significant income to the country. One of the most important export products of coconut is “Copra” which earns a high export market income to the country (927.7 Rs/Mln in 2019). Literature reports that the copra conversion factor (CCF) is 0.19 kg, where approximately 5 nuts are required to produce 1 kg of copra. This study investigates the stability of this conversion factor and the dependency of it with various nut parameters (number of nuts in a harvest, fresh nut weight, husked nut weight (DW) and split nut weight (SW)) and meteorological parameters (rainfall, maximum and minimum air temperatures) to establish a relationship to estimate CCF of a nut. Results showed that CCF was temporally not stable and positively correlated with DW and SW. The study established a model to predict CCF using multilayer feed-forward neural network approach (MLFFNN). Performance of the model showed R  = 0.83  in training, 0.93 in testing and 0.93 in validation with MSE < 0.0002. Study further revealed that ~ 50% of the temporal variability of copra outturn was explained by temperature related parameters.

Introduction
Coconut is one of the major plantation crops grown in Sri Lanka covering land area of 443,538 hectares [1]. Sri Lanka annually produces 2500–3000 million nuts, in which, around 70% (1700–1800 million nuts) is locally consumed [2]. The balance is used for industrial purposes, mainly for the export of desiccated coconut, coconut oil, virgin coconut oil, copra, coconut milk, coconut milk powder, coconut cream and fresh coconuts. “Copra” is one of the most important export products of coconut having a high export market value. Copra is literally the dried meat/kernel of coconuts mainly used for coconut oil extraction. In addition, copra can also be a raw material for many industries including manufacture of soaps, detergents, shampoos, synthetic rubber, glycerin, confectioners and copra residues such as oil cake as livestock feed. Sri Lanka has a stable export market for copra but still they have to compete with the global producers to save their place in the global market. The industry consumes 63 million coconuts on average to produce copra for the export market (average export value for 2015–2019), in which 7 million nuts equivalent for direct exports as copra and 56 million nuts equivalent for producing coconut oil, earning significant foreign income each year. Extremely high domestic consumption within the country and the seasonality of coconut production based on the weather aberrations creates a stiff competition of nuts for each coconut related sub industry. Therefore, coconut industry of Sri Lanka should be carefully planned with the available production among existing coconut-based markets.

Annual national coconut production (ANCP) of the country is vulnerable to change each year as coconut is considered a highly heterogeneous crop that is sensitive to several abiotic factors such as pest and diseases and weather. Most importantly, weather factors become the most decisive factor that can make ANCP falls below 2500 million nuts in some extreme years. There are many evidences in the literature supporting the fact that the annual yield of a coconut palm is subjected to fluctuate principally on weather aberrations [3,4,5,6,7]. Furthermore, there are evidences for increase in total copra production of a coconut palm as a result of watering coconut palms during drought due to more bunches, more female flowers per bunch, less immature nut fall, more mature nuts and increased nut size [8]. Studies conducted in India indicated that the average weight of copra from a mature coconut was recorded as 191 g but the copra content in a nut varies spatially and temporally [9]. They observed that the copra outturns varied from 0.135 to 0.216 kg among 10 coconut varieties with 0.027 standard deviation. Even before their finding, the same copra conversion factor (CCF), i.e., 0.19 kg of copra from one nut (~ 5000 coconuts to yield 1 metric ton of copra), was recorded on the literature [10, 11]. To date, the same conversion factor is being used by the Sri Lankan coconut industry [12] to decide the number of nuts allocated/used for copra industry regardless the possible temporal and spatial changes. However, use of a constant conversion factor may sometimes over/under estimate the nut requirement for copra industry, which is not beneficial for an industry like Sri Lankan coconut industry that suffers from inadequate national coconut production. If a relationship can be established between copra outturn and other nut parameters and/or any external factor to predict the copra outturn in advance, the industry can save some nuts for other industries and thereby reduce the competition for nuts in the market. Moreover, identification of this relationship has a great importance in modeling the whole coconut industry in a systems’ approach for better planning. Therefore, the main objective of this research is to identify whether the copra conversion factor is temporally stable and, if not, to establish a relationship to predict the expected copra outturn in advance using crop/weather factors.

Methodology
Data used in the study
Randomly selected 60 coconut palms in four different blocks (15 palms per block) from Rathmallagara sub-research station of Coconut Research Institute (CRI) that located in the low country intermediate zone (IL1) of Sri Lanka were used in the study. Data collection was conducted in four years, from 2007 to 2010. As coconuts were harvested in bimonthly intervals (pick 1—Jan/Feb, pick 2—Mar/Apr, pick 3—May/Jun, pick 4—Jul/Aug, pick 5—Sep/Oct and pick 6—Nov/Dec.), data were collected from experimental palms in every two months starting from July 2007. During each harvest, total nut counts of each block were recorded separately, and randomly selected 100 nuts from each block were weighed (fresh weight—FW) at the field. Selected sample of nuts were kept under covered condition for three weeks seasoning prior copra preparation. Thereafter, nuts were dehusked and weights of husked nuts (dehusked weight—DW) and split nuts (without husk and coconut water) (split nut weight—SW) were recorded. Finally, weight of copra produced from each sample was separately collected in each harvest during the data collection period. Copra processing was done using CRI improved Ceylon copra kiln using charcoal powder as the fuel source. CCF was considered as the weight of copra per a coconut.

Bimonthly meteorological data on maximum air temperature (Tmax), minimum air temperature (Tmin) and rainfall (RF) from the same experimental site from 2006 to 2010 were used in the study because these are the main weather parameters, which have been proved showing a significant relationship with nut development of coconut [3,4,5,6,7]. It was specifically reported in the literature that increase in temperature during the nut development is likely to influence the copra outturn [13].

Data analysis
First, analysis of variance (ANOVA) was conducted to find whether the copra outturn is temporally stable taking year and pick (1–6) as the temporal factors.

Linear correlations were studied using Spearman's rank correlation coefficient to measure the degree of association between CCF with other nut parameters; number of nuts, FW, DW and SW. Moreover, meteorological data (RF, and Tmax and Tmin) were arranged bimonthly to represent lag phases of coconut development cycle from harvesting up to spathe opening. Correlation analysis was also done to study the association of nut parameters and weather variables. Six lag phases of weather were considered for relevant coconut parameters of a given pick (harvest); lag 2 is the average weather of two months before harvesting, lag 4 is the average weather during 3rd and 4th months before harvesting and similarly up to lag 6, which is the average weather during 11th and 12th months before harvesting.

As the initial step of model building procedure, a regression analysis was done to establish a relationship with one of three nut parameters (FW, SW and DW), one at a time (all three cannot be used together due to high multicollinearity), to predict copra outturn. Then, best subsets regression approach was used in the analysis to further improve the predictability of each model by incorporating all the lags of three weather variables (6 × 3), while eliminating multicollinearity and keeping one of three nut parameters at a time as the fixed predictor. Best subsets regression is an efficient way to identify models with as few predictors as possible to estimate the regression coefficients and predict future responses with smaller variance than the full model [14]. However, lags of two temperature parameters, Tmax and Tmin, were not considered together in the models because of the existence of high multicollinearity. Therefore, separate parameter subsets were defined, and models were simulated from each different combinations of temperature (Tmax/Tmin) and nut parameters (one in each model as a fixed factor). Rainfall lags were considered in each model. Accordingly, there were six parameter subsets such as RF-FW-Tmax, RF-FW-Tmin, RF-SW-Tmax, RF-SW-Tmin, RF-DW-Tmax and RF-DW-Tmin. In selecting the best subset model, several goodness of fit measures such as Mallows' Cp-statistic, adjusted and predicted R-squares were employed. Mallows’ Cp-statistic was used to identify the best model such that the best model should produce the lowest Cp value less than P + 1, where P is the number of predictor variables in the model. The predicted R-squared indicates how well a regression model predicts responses for new observations. If both adjusted and predicted R-squared values are comparable it indicates that the model fits the original data and also capable of providing valid predictions for new observations. All the analyses were done using Minitab software (version 14).

Lastly, MLFFNN approach was also used to establish a relationship of copra outturn with nut and weather parameters due to its widespread applications on capturing nonlinear complex relationships through hidden layers. The idea was to further improve the predictability of the models in comparison to the selected best subset models. The multiple layers of neurons with nonlinear differentiable transfer function allow the network to learn nonlinear and linear relationship between input and output vectors. Therefore, in the model development process, a two-layer tansig/purelin network was used (i.e., A hyperbolic tangent sigmoid function (h) in the hidden layer and a linear function in the output layer) after trying different transfer function combinations with randomly divided three subsets of data for model training, validation and testing. The model structure was as shown in eqs.1 and 2.

𝑌𝑖=𝑓[𝑣0∑𝑚𝑗=1ℎ(𝜆𝑗+∑𝑛𝑖=1𝑥𝑖𝑤𝑖𝑗)𝑣𝑗]
(1)
ℎ(𝑗)=𝜆𝑗+∑𝑛𝑖=1𝑤𝑖𝑗2(1+𝑒−2𝑥𝑖)−1
(2)
where Yi = network output, f = output layer activation function, v0 = output bias, m = number of hidden units, h = hidden layer activation function, λj = hidden unit biases (j = 1, …, m), n = number of input units, xi = input vector (i = 1, …, n), wij = weight from input unit i and hidden unit j, vj = weights from hidden unit j to the output (j = 1, …, m).

The training set was used to train/calibrate the model, the validation set for testing the performance of the trained model and the testing set for cross-validation. The fastest training function, the Levenberg–Marquardt algorithm was used to train the network by performing calculations backward to update weights and biases. The back-propagation learning algorithm is the most widely used training algorithm in multi-layered feed forward networks. Each network was trained multiple times to ensure that a network with good generalization is found. Mean Squared error and the R values in training, validation and testing were considered for selecting the best model. Neural network toolbox in MATLAB 2018a software was used for the network analysis [15]. Neural network weights were partitioned to examine the relative importance of the inputs in final model using Garson’s algorithm [16].

Results and discussion
According to the results of the study, CCF varied between 0.16 and 0.21 kg/nut during the period. Results of ANOVA further revealed that within and between years’ variations were significant. This variation can cause the nut requirement to produce 1MT of copra varies between 4761 and 6210 nuts. If the above variation is considered in estimating the nut requirement for annual copra production of Sri Lanka that has the potential of saving around 50 Mn nuts to other sub industries. This saving is very important to the industry as unplanned distribution of nuts among different sub-industries cause high competition for nuts in local market resulting unnecessary price fluctuations each year.

As the data collection started in July 2007 and ended in August 2010, means of first three harvests (January–June) were compared between 2008 and 2010, and the same of the last three harvests (July to December) were compared between 2007 and 2009 (Table 1). Taken together, results indicated that 2009 and 2010 have produced lower outturn of copra than previous two years. Moreover, within a year variation between bi-monthly periods (picks) were also not consistent along the years (i.e., Pick * Year interaction was significant in first three picks, F = 8.77, p = 0.000) indicating that the nuts harvested in similar months in different years yielded significantly different CCFs. The closest and the most relevant factor causing this difference may be the weather fluctuations in different years that differently affected on the development phases of these nuts.

Table 1 Comparison of mean copra weight between years and picks (pick 1—Jan/Feb., pick 2—Mar/Apr., pick 3—May/Jun., pick 4—Jul/Aug, pick 5—Sep/Oct. and pick 6—Nov/Dec)
Full size table
As the results of ANOVA signified the existence of temporal variation in CCF, linear dependency of all nut parameters was compared using correlation analysis to study whether CCF can be estimated using any other nut parameters (Table 2).

Table 2 Linear correlations (Pearson Correlation) between nut parameters
Full size table
Results showed that from the measured nut parameters, CCF was significantly correlated with all three weight parameters (SW, DW and FW as in the Table 2) indicating that one of these three have a potential to predict copra outturn. However, the strength of the correlations was not strong. Nut number, the most sensitive factor to weather aberrations, did not show a significant linear dependence with CCF or any other weight parameters of a nut. As shown in Table 1, on average, significantly lower CCF was resulted in May/Jun harvest, where the highest number of nuts were harvested very often due to higher number of bunches produced, higher number of female flowers per bunch and higher setting percentage [17]. This may be due to high competition of nuts for the dry matter produced in a palm. However, Fig. 1a provides evidences that regardless the highest number of nuts reported in May/Jun period during each experimental year, CCF does not show a clear association with the same pattern. FW and CCF also showed significantly positive but a weak association. This could be attributed to the fact that a nut weight represents both water and kernel contents but water content varies largely with seasonal influence and harvest time [18]. Of the three significant correlations, CCF showed the highest correlation with SW (Fig. (d) also proves it). Both SW and DW were strongly correlated with the FW of a nut but dependance of CCF was comparatively low. Timeseries of both DW and SW series in Fig. 1 showed comparatively higher nonlinear dependance with the CCF timeseries. These results proved that the influence of characteristics (variations) of coconut husk was not strong on deciding the copra outturn of a nut.

Fig. 1
figure 1
Time series plots of mean bi-monthly CCF (kg/nut) with other nut parameters a Nut number per palm, b Fresh nut weight (kg/nut), c De-husked weight (kg/nut) and d Split nut weight (kg/nut)

Full size image
Study evaluated the possibilities of establishing a relationship between CCF and SW/DW/FW. Although the relationships were significant, strengths of the relationships were not adequate (adj. R2 values were low) to explain the total variability of CCF (Eqs. 1–3). Therefore, they were not considered to be used as a tool estimating CCF of a nut.

CCF=0.028+0.288 SW(𝑅2(adj)=32.1,𝑝=0.008)
(3)
CCF=0.041+0.203DW (𝑅2(adj)=29.1,𝑝=0.012)
(4)
CCF=0.133+0.0291 FW (𝑅2(adj)=06.2,𝑝=0.019)
(5)
The next step was to incorporate meteorological parameters in the model to improve the accuracy. There are not much scientific evidences to be found in the literature for the effect of weather fluctuations on the copra yield. Therefore, considering the development cycle of a coconut bunch, different approaches were tried to find a suitable relationship between CCF and weather aberrations.

An adult coconut palm generally produces one mature bunch/crop at minimum in each month of a year. Each such crop is the final outcome of several crop components, which are conditioned at different phases of a long cycle of development, lasts for about 39 months. The primordium of the inflorescence is formed about 28 months prior to the opening of the inflorescence (Fig. 2). The inflorescences are tightly enclosed by the thin prophyll and thick peduncular bract up to stage-4, and the bracts become fibrous with maturation [19]. After the spathe opens at stage 0, fertilization takes place within about a month, and it takes about 11 months for the female flowers to develop into fully mature nuts [20]. During these 11 months, an inflorescence is fully open to the environment, hence, the effect of changing weather is high on the growing nuts.

Fig. 2
figure 2
Source: Coconut Research Institute, Sri Lanka

Development stages of a coconut inflorescence (Tall variety).

Full size image
Of the total period of development cycle, the first three months subsequent to inflorescence opening is said to be the most vulnerable period to climatic variation [7]. Considering this, weather parameters (RF, Tmax and Tmin) were calculated to represent 12 monthly lag periods of each coconut harvest (representing the development period, which is fully exposed to weather aberrations) from the maturity, and correlation analysis was done to find any association that could be of use to explain the variability of CCF. Results revealed that none of the weather parameters were significantly correlated with copra but there were several meteorological parameters, which showed significant correlations with other nut parameters (results were not shown). Maximum temperature during the 6–7 months period before harvest showed a significant negative relationship with other three nut parameters; FW, DW and SW. This was supported by the literature that claims serious influence of weather aberrations during the phase of early four months after spathe opens (from 8 to 12 months before harvest) on the final yield [21]. Some researchers observed that the final nut weight and copra content in nuts were highly correlated with the growth of the bunch during second phase and the weather condition of the region [22]. According to them, the first phase of slow progressive growth is for about three months after fertilization, followed by the next phase of rapid growth for about four months and finally the rapid decline in growth rate in about two months. They observed that the rate of growth during the second phase of development is highly correlated with the final volume and weight of unhusked nut and copra content [13, 22]. Temperature, as found on the literature, is an important factor showing profound influence on the final yield of the coconut palm. Literature provides evidence for negative correlation of the coconut yield with temperature [23]. Nambiar et.al. [22] also revealed a negative relationship between heat units (a function of temperature) during the second phase of development (4–7 months after fertilization) and husked nut weight. Nambiar and Rao [24] reported that the copra content of coconuts was maximum during summer followed by winter and minimal in the post-monsoon period of October–November. There were no such significant differences observed in the current data set for CCF but comparison of bi-monthly copra outturns resulted that the copra out turns in dry months, from January to April, were comparatively higher and significant at probability = 0.086. However, the copra production per palm was higher during May/June period and lower during Jan/Feb and Sep/Oct periods as a result of variations in the number of nuts harvested during corresponding periods.

As such explanations on experimental literature supporting copra out-turns has a significant temporal effect, it was tried to estimate CCF using meteorological variables. As there were 13 explanatory variables in a full model, it was decided to select the best set of variables to keep the model parsimony. In the next step, best subsets of meteorological parameters were identified using best subsets regression approach while keeping one of nut parameters (FW, DW and SW) fixed in each model. Table 3 displays the results of the best subset regression. The results of the full models of 6 sets (RF-FW-Tmax, RF-FW-Tmin, RF-SW-Tmax, RF-SW-Tmin, RF-DW-Tmax and RF-DW-Tmin) were also displayed for the better comparison. In the Table 3, first six models were the full models, and models 7–12 were the best subsets selected from each set using R-sq (Adj.), R-sq (Pred.), MSE and Mallows’ Cp. MSE and R-sq (Adj.) were nearly similar in full model and the best subset but the selected subsets showed better R-sq (pred.) and lower Mallows’ Cp compared to the full models. Results revealed that the models with Tmax variables in general showed lower accuracy (R-squared values were less than 40 even for the full models) compared to the models with Tmin (Table 3). Full models and the subset models, which have Mallows’ Cp greater than P + 1 (P is the number of predictor variables in the model), were disregarded for the next step because larger Mallows’ Cp indicates the lack of fit of the models. When aiming to assess the precision and bias of the predictors, it is considered that the models with small Mallows’ Cp value near to the number of predictors are unbiased and precise. Accordingly, the models 7 and 9 (shaded and bolded rows in Table 3) were selected as the best subset models as they resulted the lowest Mallows’ Cp value and fairly high R-squares. Overall, all selected subset models and full models explained half of the variability of CCF indicating that there is more room for further improvement. Therefore, neural network approach was executed using the variables in the two selected best subset models with the aim of enhancing prediction accuracy.

Table 3 Results of full models and best subset models identified with different fixed factor and temperature (T) combinations
Full size table
Artificial neural network (ANN) approach, one of the artificial intelligence techniques, is a promising alternative to model nonlinear relationships with more prediction power compared to traditional regression methods. Literature provides proof for more accurate predictions through MLFFNN in variety of fields compared to classical regression models [25,26,27]. Two MLFFNN models have three layers as input (best subsets identified by the previous regression approach), one hidden and one output layer (CFF). The first model included eight independent variables, FW, RF10, RF6, Tmin2, Tmin4, Tmin6, Tmin8 and Tmin12 (number attached to meteorological abbreviations indicates the corresponding lag period), in the input neurons, two sigmoid hidden neurons and the linear output neuron (Fig. 3(A)). The second-best model was defined by DW, RF10, RF6, Tmin2, Tmin4, Tmin6 and Tmin12 with the structure and the transfer functions similar to the first model (Fig. 3(B)).

Fig. 3
figure 3
Schematic representation of two MLFFNN models A Model with FW as the fixed predictor and B Model with DW as the fixed predictor. Bias parameters of hidden and output layers are, respectively, denoted by BH1, BH2 and B_OUT

Full size image
Table 4 shows the results of the two MLFFNN models. According to the results, both models explained the variability of CCF with higher accuracy compared to best subset regression models. Mean squared error (MSE) for training, testing and validation was less than 0.0002 in both models. The R values in training, validation and testing were, respectively, 0.83, 0.93 and 0.93 (R-squares were 0.69, 0.86 and 0.86) in the model containing FW as the fixed factor confirming the adequacy of the network (MSE = 1.7e − 04) estimating CCF (Fig. 4). The model with DW as the fixed factor also confirmed the adequacy in estimating CCF with R = 0.80 in training, 0.88 in validation and 0.87 in testing (MSE = 1.4e − 04).

Table 4 Neural network results
Full size table
Fig. 4
figure 4
Regression plots for training, validation and testing accuracies in the selected MLFFNN model

Full size image
It was tried to further improve the model accuracy by adjusting the network topology (changing the number of hidden neurons), changing the training algorithms and changing the activation functions from inputs to the hidden layer. Those changes could not significantly improve the model accuracy further, thus the simplest model structure with two hidden neurons was selected. Of the two models that produced a stronger relationship with CCF, the model with FW as the fixed factor was considered to predict the CCF as it has the higher R values (Fig. 4) and the lead time.

The weights of input variables in a neural network are partially analogous to parameter coefficients in a standard regression model hence can be used to describe the relative importance of the variables. Input variables that are not important to explain the variability of response variable are suppressed by the weights, and weights are strong for important explanatory variables. However, larger number of weights in the MLFFNN models make the interpretation of the effects of specific variables challenging but this characteristic is advantageous making the neural networks very flexible for modeling nonlinear functions with multiple interactions.

In this study, neural network connection weights were partitioned in order to determine the relative importance of each input variable in the final model using a popular method based on Garson’s algorithm [16]. The basic idea of Garson’s algorithm is to determine the relative importance of a specific explanatory variable for the response variable by identifying all weighted connections between the nodes of interest. For that, all weights connecting the specific input node to the output variable through the hidden layer are identified. The connections are tallied for each input node and scaled relative to all other inputs. Table 5 displays the proportional contribution of each parameter defining the output in the final model. According to the sensitivity analysis, more than 50% of the variability of CCF was defined by minimum temperature during first six months after spathe opening (lags 6–12), when FW was used in the model as a nut parameter. It indicates the high sensitivity of temperature related parameters in deciding copra out turn of a coconut. However, as the original algorithm estimates the relative importance of the absolute magnitude of the weights, the direction of the response could not be determined.

Table 5 Sensitivity of input variables in the MLFFNN
Full size table
Above results indicates that the final MLFFNN model can be used to estimate the CCF of a nut if the FW is known priori with other required weather parameters as in Table 5. This relationship is advantageous in several ways such that it can be used to approximate the copra out turn of an estate by substituting average FW from a representative sample and required weather parameters into the MLFFNN model and multiplying the output with the total number of nuts harvested. Using this model, the nuts required for a given amount of copra production can be estimated with > 1 month lead time because fresh nuts are being seasoned for more than three weeks before splitting them to initiate copra production. Moreover, this model can be further studied to scale up the relationship into national level to be used accurately in estimating the number of nuts used in Sri Lankan copra industry. For that, spatial differences of CCF should also be studied with temporal variations.

Conclusion
Weather parameters are the most decisive abiotic factors making ANCP of Sri Lanka fluctuates more often between 2500 and 3000 million nuts. This is due to the influence of weather aberrations on all stages of the development cycle of coconut. Depending on these influences, number of nuts, size of the nuts, kernel production and several other nut parameters in a harvest fluctuate. Regardless of possible temporal differences, the coconut industry approximates the annual coconut equivalent on copra production using the conversion that five nuts are required to produce 1 kg of copra. The objective of this study was to find out whether this conversion is acceptable with the assumption of CCF being constant along the time and if not identify the temporal variations of it. The study concludes that similar to the number of nuts on a palm, copra out-turn also has a significant temporal variation causing inconsistency of CCF of a nut between years and even between harvests of the same year. However, there is no direct linear relationship between CCF with RF, Tmax and Tmin. Results of the study discover a significant relationship between nut parameters and weather parameters deciding CCF using artificial neural network approach. Accordingly, a MLFFNN model was identified to predict the CCF. The model contained FW, and several other weather parameters as a classifying variable and showed a greater accuracy (R > 0.9 and MSE < 0.0002) than best subset regression approach. The model revealed that the temperature is the major factor deciding CCF of a nut.

Keywords
Climate
Coconut
Copra
Temporal variability
Neural network
MLFFNN