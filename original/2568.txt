Human mobility analysis is one of the most important research problems in the field of urban computing.
Existing research mainly focuses on the intra-city ground travel behavior modeling, while the inter-city air
travel behavior modeling has been largely ignored. Actually, the inter-city travel analysis can be of equivalent importance and complementary to the intra-city travel analysis. Understanding massive passenger-airtravel behavior delivers intelligence for airlines’ precision marketing and related socioeconomic activities,
such as airport planning, emergency management, local transportation planning, and tourism-related businesses. Moreover, it provides opportunities to study the characteristics of cities and the mutual relationships
between them. However, modeling and predicting air traveler behavior is challenging due to the complex
factors of the market situation and individual characteristics of customers (e.g., airlines’ market share, customer membership, and travelers’ intrinsic interests on destinations). To this end, in this article, we present
a systematic study on the personalized air travel prediction problem, namely where a customer will fly to
and which airline carrier to fly with, by leveraging real-world anonymized Passenger Name Record (PNR)
data. Specifically, we first propose a relational travel topic model, which combines the merits of latent factor
model with a neighborhood-based method, to uncover the personal travel preferences of aviation customers
and the latent travel topics of air routes and airline carriers simultaneously. Then we present a multi-factor
travel prediction framework, which fuses complex factors of the market situation and individual characteristics of customers, to predict airline customers’ personalized travel demands. Experimental results on two
real-world PNR datasets demonstrate the effectiveness of our approach on both travel topic discovery and
customer travel prediction.
CCS Concepts: •Information systems→Location based services; Data mining; • Computing methodologies → Factor analysis; • Human-centered computing → Mobile computing;
Additional Key Words and Phrases: Air travel demand, latent dirichlet allocation, travel topic model, urban
computing
1 INTRODUCTION
Air transportation has always been one of the most important ways for long-distance travel, and
air-travel-related mobility is closely associated with the urbanization and modern civilization process. The air-travel flow reflects various characteristics of the cities, for example, the economic
and culture status, with which we can better understand the role that a city plays against others. Moreover, the airline market is large, competitive, and fast growing. According to a report
from the International Air Transport Association (IATA), the airline industry was able to make
$33 billion profit in 2015.1 Despite this, the profit was hovering around merely $9 per passenger.
Therefore, it is important to accurately model the travel preferences of airline customers and predict their travel demands. The benefits are twofold. In the first place, airlines can leverage customer
travel preferences to improve services in the competitive market and to optimize flight schedules
based on travel demand. Besides, travel behavior understanding is of great value for many related
aviation industry sectors, such as airport planning, supplier requirements, and tourism-related
businesses.
There are some previous works on airline customer analysis; however, fine-grained personalized
travel prediction with customer historical travel records is still unexplored. Works [29, 32] investigated customer segmentation based on their purchase histories. Nevertheless, all consumers are
not created equal, which is true even with those that are segmented into the same cluster, such
as high-value or business. For example, a businessman may travel not only for business but also
for recreation. Therefore, the travel demand of a passenger is a mixture of different aspects and
varies from one passenger to another. Moreover, previous works [29, 32, 40] that mainly focus on
high-value consumers often lack taking the understanding of low-frequent passengers due to the
large volume and sparsity of the data. Figure 1 shows the relationship between customers’ travel
frequency, total travel distance, and total number of trips. Specifically, as shown in Figure 1(a),
customers’ travel frequency has a long-tail distribution with respect to travel mileage as well as
the number of trips, which means that most of the mileage and trips are conducted by people with
low travel frequencies. It can be further observed from Figure 1(b) that the total mileage of lowfrecuency customers is much higher than that of frequent customers. This means low-frequency
customers contribute a lot to the whole market and can also be important for market potential in
addition to frequent customers.
In this article, we aim to bridge this gap via exploring personalized travel demand, namely predicting where a customer will fly to and which airline carrier to fly with. However, it is challenging
due to the unique characteristics of the airline domain. First, the air travel data is much sparser
than the data in traditional recommendation fields, which limits the performance of conventional
popularity-based approaches due to overfitting. Second, a trip is affected by multiple complex factors, such as the intrinsic characteristics of the passenger and external factors from the market
situation.
To this end, we propose a probabilistic framework to model airline customer travel preferences,
and to further predict travel demand. First, we develop a Bayesian network-based topic model,
1http://www.iata.org/pressroom/facts_figures.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:3
Fig. 1. Customer travel analysis based on 1-year travel history in China. (a) The power distribution of the
aviation customer travel frequency. (b) A comparison of mileage contributed by high-frequency and lowfrequency customers according to different thresholds.
named Relational Travel Topic Model (RTTM), to uncover the latent topic distributions of customers’ preferences, air routes, and airline carriers. RTTM is a generative model that represents
each customer with a mixture of travel topics. In this way, RTTM extends the Latent Dirichlet
Allocation (LDA) [6] to simultaneously model the interests of customers and the characteristics
of air routes and airline companies. Furthermore, a customer relation network is constructed and
incorporated to enhance the latent topic modeling by considering the neighborhood information
in the trip generation process. This mechanism offers RTTM the ability to capture local similarity information conveyed by the network, in addition to the semantic information captured by
the global topic modeling across the whole dataset. Then we design a Multiple Factor Travel Prediction (MFTP) framework for the travel demand prediction. A customer’s travel decision can be
influenced by multiple factors including personal intrinsic factors, that is, the travel preference
of the customer, and other important extrinsic factors. For example, when people are planning
holiday trips, popular cities are usually chosen as destinations with high probabilities. Likewise,
when choosing airlines, companies with more market share on the targeted route are more attractive, as they provide more flights and therefore facilitate more flexible options on departure
time and plane models. The proposed MFTP framework is capable of fusing different factors to
make accurate predictions. Finally, we evaluate the proposed approach with real-world data. The
experimental results demonstrate that the RTTM model can effectively capture the unique characteristics of the travel data, and the proposed probabilistic prediction framework consistently and
substantially outperforms state-of-the-art approaches.
To the best of our knowledge, this is the first work proposed to systematically study personalized air travel demand prediction problem, and our work contributes to its advancements in the
following ways:
— We analyze the characteristics of aviation customers’ travel behavior, and formulate the air
travel demand prediction problem under a probabilistic framework that integrates multiple
factors of customer’s travel decision making process.
—We develop a RTTM, which extends LDA with a customer relation graph to discover passengers’ intrinsic travel characteristics from the sparse PNR data. It provides a reasonable
and effective way to compute the underlying topics of passengers, routes, and carriers, respectively.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:4 J. Liu et al.
—We conduct extensive experiments to evaluate our proposed framework on travel prediction
for all passengers using two real-world datasets. The experimental results demonstrate the
superiority of our methods.
The remainder of this article is organized as follows. Section 2 highlights the related work. In
Section 3, we describe the PNR dataset and formulate the prediction problem. Section 4 and Section
5 present the detailed travel topic modeling approach and the travel prediction framework. And
we evaluate our proposed framework and analyze the experimental results in Section 6. Finally,
we conclude our work in Section 7.
2 RELATED WORK
In this section, we first introduce relevant studies on mining airline data, followed by general
methods on travel behavior modeling. At last we summarize methods used for user preference
modeling.
Airline Data Mining. The aviation industry generates large quantities of complex and rapidly
changing data, requiring specialized analysis and modeling to explore these big datasets for useful
business knowledge. Many researchers have investigated big-data-related topics in the aviation
industry. Most of these research works focus on operation problem and revenue management.
Focusing on the aviation safety domain, Melnyk et al. propose a framework which represents
each flight with a semi-Markov switching vector autoregressive model to detect anomalous flight
segments [30]. Ayhan and Samet describe a stochastic trajectory prediction approach for Air Traffic Management [2]. A hidden Markov model is exploited to predict trajectories taking environmental uncertainties into account. To control aviation hazards and manage route traffic flow, an
ensemble-based numerical weather prediction model is proposed to forecast the weather-related
probabilistic aviation impact [38]. Belcastro et al. implement a parallel predictor of the arrival delay
of a scheduled flight due to weather conditions [4].
Besides the works focusing on airline operational issues, there are some research efforts on
the customer behavior analysis and customer-relationship management. Using the case of China
Southern Airlines on Sina Weibo, a passenger value model illustrates how big social data analysis
can help an airline company to better understand the passengers and improve customer relationship management [8]. An et al. [1] propose a MAP (Maximizing Air-line Profits) architecture to
predict airline market share and route demand. Hence optimal allocation of flight frequencies over
multiple routes can be achieved. From the perspective of customers, price trend modeling is studied in [9, 25]. By incorporating elementary user-provided domain knowledge with a systematic
feature extraction technique, Groves and Gini develop an approach to optimize purchase timing
for customers and provide performance estimates of its computed action policy based on past
performance [14].
Travel Behavior Modeling. The understanding of travel behavior is an important problem, which
is known as urban computing for transportation [52]. General travel behavior mining has attracted
considerable research interests. For example, works have been done to understand people’s travel
habits [21, 22] and identify possible tourists [46] by mining public transportation data. By examining the relation between urban mobility and fare purchasing habits in datasets from London,
England’s public transportation network, Lathia et al. [22] propose to estimate passengers’ future
travel patterns for personalized ticket recommendations. Xue et al. [46] develop machine learning
techniques to identify possible tourists among public commuters using the public transportation
data from Singapore. In addition to the public transport data mining, quite a few works have been
done on analyzing GPS-embedded taxicabs to understand human mobility in a city [11, 12, 50].
There are also extensive studies on recommendations in Location-based Social Networks [3], in
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:5
which both the people mobility and social network information are considered for recommendation tasks. There are also plenty of works for urban computing problems based on citywide
mobility modeling [28, 35, 39, 48, 53].
Although there are extensive research on travel behavior modeling on the ground transportation, it is barely touched in the field of air travel. Air travel behavior is complex and dramatically
different from the traditional ground transportation behavior in many aspects. First, the air travel
is usually more carefully planned than ground travel. Second, it is more expensive. Third, it is
often not only influenced by preferences of customers, but the market situation. The research on
analyzing airline customer travel behavior by leveraging real-world customer travel records is very
limited. Some works have been done from the perspective of airline customer segmentation, including clustering customers into groups based on services, mileage, and membership [29], and
classifying trip purposes into leisure, business, and the like [32]. Besides, there are some works
on customer no-show rate prediction [23]. However, their task is to predict the total number of
passenger for given routes, which is not as fine-grained as ours. Some works [18, 36, 41] focus
on the air traffic forecasting problem, which is more related to our study in this work. Instead of
merely estimating overall traffic, our task aims to model the personalized travel preferences and
demand, which is able to provide fine-grained understanding of customers, and hence benefits
more aviation related business.
User Preference Modeling. In this study, we model the aviation customer’s preference over routes
and carrier companies, which is related to user preference modeling. User preference modeling
has been an important research topic due to its wide applications in recommendation, customer
relationship management, advertising, and so on. Collaborative filtering (CF)–based approach is
one of the most important techniques for user preference modeling [33]. Neighborhood-based CF
models might be the most natural methods for preference prediction [5, 16, 19], which recommend
items preferred by other similar users. Latent factor models have shown great success in many
application domains [10, 20, 27, 34]. Similar to latent factor models, Latent Dirichlet Allocation
(LDA)–based models [6] have also been successfully applied to deal with many recommendation
problems because of its superiority in preventing overfitting and providing better interpretability
[26, 43, 47].
Although LDA-based topic models are widely recognized as being effective in behavior modeling, they are faced with two challenges. For one thing, although LDA-based models are generally
effective in estimating overall structure that relates simultaneously to most or all items, they are
poor at detecting and exploiting strong associations among a small set of closely related users,
where neighborhood-based models provide a better solution. In the field of text mining, Reference
[7] proposes a relational topic model (RTM) for linked document semantic analysis, where the link
is represented by a binary random variable. Whereas, in our problem, the customer relation can
be more complex as continuous affinity scores are obtained from the customer attributes. Reference [33] proposes an Author-Topic Model (ATM) that takes the authors into consideration during
the generation of documents. The relationship of documents with common author(s) can be implicitly considered in ATM. However, they are often awkward when applied to combinations of
behavior data and user attribute data. Whereas the attributes of aviation customer, such as gender, age, travel frequency, and so on, are of importance for behavior modeling. To exploit content
data and metadata, a Dirichlet-Multinomial Regression (DMR) topic model is proposed for uncovering document latent topics by including a log-linear prior to document-topic distributions that
is a function of observed features of the document, such as author, publication venue, references,
and dates [31]. Latterly, the DMR model is applied for discovering the regions of different functions in a city using human mobility and points of interests (POIs) [48]. In our recent work [45], a
hashtag-graph–based topic model was proposed for short text semantic mining in microblogs. In
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:6 J. Liu et al.
Table 1. Attributes Used for the Travel Behavior Analysis
Attribute Explanation
ID unique ID number of the passenger
gender gender of the passenger
birth_year the year when the passenger was born
carrier the carrier company of this flight
origin_airport the airport the passenger flies from
destination_airport the airport the passenger flies to
this article, we further develop an RTTM that leverages the neighborhood structure and attributes
information simultaneously to enhance the topic modeling for airline customer interest discovery.
By transferring the knowledge between the locally related customers, the quality of topics can
be better learned from the sparse aviation travel data. Based on the travel topic model (TTM), we
further propose a multiple factors model that is closely related to the technique of data fusion [51].
Our method simultaneously considers market situation, passenger intrinsic interest, and a route
latent topic when estimating passengers’ future air travel pattern.
3 OVERVIEW OF OUR WORK
3.1 Background
Information about individual passengers is available from the airline reservation systems in the
form of so-called passenger name records (PNRs). Although the attributes of PNRs may vary with
different airlines or agents, the main information of PNRs usually includes passenger-specific information such as ID number, name, and gender, and flight-specific information such as carrier
company, departure airport, and arrival airport. In this article, we focus on using such travel
records to model and understand the travel behavior of the aviation passengers. Table 1 lists the
PNR attributes that are used for travel behavior modeling. The data used, which has been processed for privacy preserving, is provided by TravelSky.2 Its clients include airlines, airports, air
travel suppliers, travel agencies, individual and corporate travel consumers, and cargo services.
3.2 PNR Data Characteristics
In this article, we conduct experiments on the 2-year travel records of two representative cities in
China: Beijing and Guangzhou, which are also noted as PEK and CAN using their airport codes.
To reduce noise in data, we remove users who have less than five travel records within 2 years.
Details of the data are depicted as follows:
— The PEK dataset has 49,627,025 flight records from 2,503,880 customers with a total of 305
air routes and 42 carrier companies. Figure 2 is an illustration of the air traffic volumes for
each destination with the two cities as the origins in terms of the number of passengers.
On the other hand, the CAN dataset consists of 1,206,735 users, 241 routes from 21 carrier
companies.
—The average number of traveled routes of a customer is 8.25 and 6.88 for the PEK and CAN
dataset, respectively. The average number of passengers for a route is 162,711.56 in the PEK
dataset and 82,177.65 in the CAN dataset, respectively. The average number of carriers a
customer has flied with is 3.81 and 3.75 for the PEK and CAN datasets, respectively. The
2TravelSky Technology Limited is a Chinese State-owned enterprise and the dominant provider of information technology
solutions to People’s Republic of China’s air travel and tourism industries.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:7
Fig. 2. Air traffic volumes from Beijing (a) and Guangzhou (b) to other cities.
average number of passengers a carrier has served is 1,181,595.83 in the PEK dataset and
943,086.38 in the CAN dataset, respectively.
—In the PEK dataset, the maximum number of routes taken by a customer is 116; in the CAN
dataset, the maximum number is 76. The maximum number of passengers held by a route
is 2,803,196 for PEK and 1,582,248 for CAN. In the PEK dataset, the maximum number of
carriers a customer has travelled with is 22; in the CAN dataset, the maximum number
is 13. The maximum number of passengers served by a carrier is 22,775,842 for PEK and
16,071,503 for CAN.
As mentioned earlier, the power-law distributions shown in Figure 1 illustrate that the highfrequency flyers are only a very small portion of the whole body of the aviation customers. The
customers with low travel frequencies contribute a much larger portion of purchases and mileage.
Similarly, due to the distinct characteristics of different cities, the popularity of destinations also
show a long-tail distribution in attracting passengers. As shown in Figure 2, the traffic volumes
to a small number of big cities are much higher than others, and the traffic volumes to average
cities show significant differences. Furthermore, with different attributes, such as gender, age,
travel frequency, and so on, the passengers demonstrate different interests in choosing travel
destinations. As shown in Figure 3(a), we can see that the proportion of children and youth is
significantly larger in route Beijing-Sanya than that in route Beijing-Shenzhen. This observation
is reasonable, because Sanya, which is a popular tourism city, is often chosen as the vacation
destination for the whole family. While Shenzhen is an economically developed city in south
China, and a large amount of passengers take route Beijing-Shenzhen for business, which leads
to the higher proportion of travelers with ages between 20-50. Hence, as shown in Figure 3(b),
Shenzhen has higher frequency than Sanya, because it is a business-dominant destination. For
a similar reason, Figure 3(c) illustrates that the gender distribution is more balanced on the
route Beijing-Sanya than Beijing-Shenzhen. In addition, we demonstrate the impact of customer
attributes on their travel characteristics in Figure 3(d). All these observations show that the
customer attributes play an important role in air travel planning. As a result, it is important to
consider the customer attributes in behavior modeling, in addition to the travel histories.
3.3 Problem Formulation
In the airline industry, PNRs contain the itineraries for the passengers in the airline reservation
systems. As shown in Table 1, a PNR entry records the departure, destination, and carrier for a
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:8 J. Liu et al.
Fig. 3. The comparison of age distributions (a), travel frequency distributions (b), and gender distributions
(c) on route Beijing-Sanya and Beijing-Shenzhen. Figure (d) shows the travel characteristics of people with
different genders and ages in terms of travel frequency.
passenger. For the ease of following presentation, we define and list the notations in Table 2. We
clarify some terms, including route, trip, and profile as follows.
Definition 3.1. (Route). A route is a two-tuple r = dpt,dst, where r.dpt is the departure city,
and r.dst is the arrival city.
Definition 3.2. (Trip). A trip is a two-tuple t = r,c representing a travel activity taken by a
customer on route r served by carrier company c.
Definition 3.3. (Travel profile). A profile du ∈ D for each passenger u is a collection of trips (i.e.,
r,c) associated with u. The frequency of each tuple t = r,c in du corresponds to the number of
times that u has traveled on route r with airline carrier on c.
Definition 3.4. (Customer attribute). Attribute au is a vector associated with u, which includes
the demographic information and statistical information based on customer u’s travel history.
Definition 3.5. (Travel preference). The intrinsic interest of customer u is represented by θu , a
probability distribution over travel topics.
Definition 3.6. (Travel topic). A travel topic corresponds to two components: route topic model
φ and carrier topic model ϕ, which are multinomial distributions w.r.t. routes and carriers, respectively. Thus, a travel topic has both travel route preference and carrier preference.
The design of each travel topic z corresponding to two components enables φz and ϕz to be
mutually influenced and enhanced during the topic discovery process.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.        
Personalized Air Travel Prediction 30:9
Table 2. Symbols and Descriptions
Symbol Description
u, r, c customer, route, carrier
U, R, C, T user set, route set, carrier set, and trip set
U, R,C,T the number of customers, routes, carriers, and trips
du the profile of customer
Nu the number trips of customer u, i.e., Nu = |du |
D the customer travel profiles, i.e., D =
u du
θu the interest of customer u, expressed by a multinomial distribution over trip-topics
φz a multinomial distribution over routes specific to topic z
ϕz a multinomial distribution over carriers specific to topic z
zui the travel-topic assigned to trip tui = rui,cui
h the switch variable for the sampling of u
u the latent customer sampled from customer relation graph
τ the parameter of Bernoulli distribution
K the number of latent topics
α, β,γ Dirichlet priors to multinomial distributions θu,φz ,ϕz
eij similarity between ui and uj
G the customer similarity graph
gu the normalized row vector of G
In this article, we aim to predict where a customer will fly to and with which airline carrier a
customer will fly by leveraging a real-world anonymized PNR dataset provided by an important
air travel and tourism state-owned enterprise provider in China. Formally, let U = {u1,u2,...,uU }
be a set of air travel customers, R = {r1,r2,...,rR } be a set of air routes, and C = {c1,c2,...,cC }
be a set of carrier companies. With the PNR records, we establish a set of trips T = {t1,t2,...,tT },
and a set of profiles D = {d1,d2,...,dU } to denote the customers’ travel records. Each profile d is
composed of a sequence of trips t, and Nu = |du | is the number of trips of u. Our goal is to predict
future trip with route r and carrier c for each costumer u, namely P (r,c|u).
3.4 Architecture
Figure 4 shows the architecture of our approach, which is comprised of three parts. First,
passengers’ travel profiles are constructed from the raw PNR records. Each travel record is a three
tuple u,r,c, whose elements are customer u, route r, and carrier c, respectively. The profile of
u is naturally composed of the tuples u,r,c corresponding to the trips taken by the customer u.
Based on the customer attributes and travel histories, a customer relation graph is constructed. In
the graph, each node represents a customer, and each edge is weighted according to characteristics
of a pair of customers. The graph is crucial for the subsequent travel topic discovery process. And
the central problem of the graph construction is the weight assigning of the edges. In this article,
both the characteristics of customers and their travel histories are considered when evaluating
the customer similarity. The second phase is to discover the latent topics of aviation customers,
routes, and carriers using our proposed RTTM. In the generation process of the RTTM, a customer
travel profile is generated by his/her own latent topics and those of his/her related customers on
the graph to achieve better topic discovery. In the third phase, a personalized travel prediction is
conducted by fusing multiple factors in a probabilistic framework. The meaningful factors, which
are popularity of route, preference of travel, loyalty to carrier, and share of market, effectively
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.       
30:10 J. Liu et al.
Fig. 4. The architecture of our approach.
reflect the customer intrinsic preferences and the market situation as well. As the last step, the
trip prediction can be used for recommendation or other related applications.
4 CUSTOMER TRAVEL PREFERENCE MODELING
In this section, we first introduce our RTTM to profile airline customer travel preferences, and
then describe the inference of the model parameters.
4.1 Relational Travel Topic Model
We propose to use a topic-model–based approach to capture customer travel preferences. For the
sake of both modeling capacity and interpretability, we develop an RTTM to model customer travel
preferences based on their trip records, that is, {r,c}. Before introducing RTTM, we first describe
TTM, which generates trips without considering relation information. The topic discovery of TTM
is influenced not only by routes co-occurrences, but also airline carrier information. Then we
further present the construction and incorporation of a customer relation graph, which leads to
RTTM.
4.1.1 Travel Topic Model. TTM represents each customer u by a K-dimensional latent vector
θu , which is a multinomial distribution over the K hidden “topics,” to capture the customers travel
preferences over the K different “preference aspects.” Each topic is a probability distribution over
the travel routes and airline carriers. Let φ denote the matrix of topic-route distributions, with each
φk being a multinomial distribution over the R route items; similarly, topic-carrier distribution is
denoted as ϕ. It is reasonable to recognize that both passengers and routes could have a wide range
of travel latent topics, such as a visit to family, business affair, vacation, and so on.
When planning a trip, a customer may first have a travel need in mind. More specifically, it is
the topic z of the trip that can be generated from the customer u’s topic distribution θu . After a
topic z is generated, a route r and a carrierc are sampled from φz and ϕz . It enables TTM to capture
the interaction of routes and carriers when modeling the underlying topics. Because the carriers
often have different service and price positioning, a route may be generated by different latent topic
assignment z, due to different choices of airline carriers. This encodes our goal to model customers’
fine-grained preference in topics of air routes by considering the choice of different carriers. This
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.  
Personalized Air Travel Prediction 30:11
Fig. 5. The graphical model representation for (a) TTM and (b) RTTM, where θ is topic distribution matrix
of customers, φ is the route distribution matrix of the topics, ϕ is the carrier distribution matrix of the topics,
and u indicates the related customer assignment for current trip.
design makes ϕz and φz mutually influenced and enhanced during the topic discovery process.
Given a customer u, the likelihood that u will fly route r with carrier c is computed as follows:
P (r,c|u, θ,φ,ϕ) =

z
P (r|φz )P (c|ϕz )P (z|θu ). (1)
The graphical structure of TTM is illustrated in Figure 5(a).
The main strength of the travel topic model in Equation (1) lies in its use of the co-occurrences of
the trips within each customer’s profile, that is, the profile content, to uncover the distributions of
routes and carriers. However, being different from traditional recommendation tasks, it is important to be aware that a large amount of customers take very limited flights during a given period
(e.g., 1 year). Thus, the profiles are very short for most customers, which means high sparsity of the
data. The sparsity will lead to overfitting and restrict the performance of the topic model. Hence,
we further construct the customer relation graph and introduce the neighborhood information
into the TTM.
4.1.2 Relation Travel Topic Model. As discussed earlier, a large amount of customers take limited flights during a given period as long as 1 year, which leads to high sparsity of the vector
representation of customer profiles. The sparsity will restrict the performance of the standard
topic model, like LDA. In addition, the standard topic model treats data as a flat structure without
considering relation between customers. Whereas, customers who often travel on same routes or
have similar background information are more likely to share similar topics. Such customer relation can be utilized as additional information, appealing for modeling the highly sparse air travel
data.
It is reasonable to assume that customers who have similar characteristics, including travel
histories and attributes, are more likely to share similar topics. Hence, we augment the TTM with
the customer relation information. To exploit the relation information of customers, a customer
relational network G = (V, E) is constructed, where nodes V = {ui}i=1:U are customers, and edges
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017. 
30:12 J. Liu et al.
E = {(eij)}i,j ∈V,ij are customer relationships. An edge eij is weighted based on the degree of
association between customer ui and uj .
As aforementioned, customer characteristic is reflected in two vectors, that is, du (customer
travel history) and au (customer attributes). For the customer attributes, we consider gender, age,
travel frequency, and travel mileage. The attribute of gender is a binary value д ∈ {0, 1}. For the
age, it is a discrete value range from 1 to 109 in our datasets. To avoid too fine or too coarse
representation of age, it is necessary to segment the age appropriately. To make reasonable age
splitting, a variance-based method is exploited to get the age segmentations, which is similar to
the one used in [49] for clustering the travel times of taxi drivers. We first sort the ages of the
customers, and then partition the sorted list AL into several sub-lists in a binary-recursive way. In
each iteration, we first compute the variance of all ages in the list. Later, the best split age having
the minimal weighted average variance (WAV) is defined as
W AV (AL;i) = |AL1 (i)|
|AL| V ar(AL1 (i)) +
|AL2 (i)|
|AL| V ar(AL2 (i)), (2)
where AL1 (i) and AL2 (i) are two sub-lists of AL split at the i-th element and V ar represents the
variance. This best split age leads to a maximum decrease of ΔV (i) = V ar(AL) −W AV (i;AL). The
travel frequency and travel mileage are segmented in the same way as age. As a result, age, travel
frequency, and flight mileage are split into eight, six, and five segments, respectively.
Each attribute in vector au is represented as a one-hot vector whose length equals the number of
segments. As such, we can obtain the characteristic xu of a customer by concatenating du and au .
With xu , we utilize cosine similarity to construct the affinity matrix G that captures the transition
probabilities дij between different vertices as follows:
eij = xui · xuj
|xui ||xuj |
, дij = eij

j eij
. (3)
We use gu to denote the row vector ofG that corresponds to the transition probability distribution
of customer u.
Once the network is constructed, the neighborhood relation is exploited in the generation of
the trips in the customer profiles. According to the network, the more similar a neighbor is to the
current customer u, the more likely his/her travel topics will be taken into account for generating
the trips for customer u. As shown in Figure 5(b), a variable u is introduced as a latent customer
for a trip generation given a customer u. With a Bernoulli(τ ), it is first determined whether u is
assigned with the actual customer u or one of its neighbors. With probability 1 − τ , u is assigned
by a related customer sampled from its network neighbors according to a multinomial distribution gu . With this mechanism, the information can be shared and transferred between related
customers during the learning process, which enhances the topic quality learned from the sparse
travel histories.
Following the preceding procedure, the probability of route-carrier pair r,c can be reformulated as
P (r,c|u, θ,φ,ϕ,h,G)
=

z

u
P (r|φz )P (c|ϕz )P (z|θu )Pu
G,h, (4)
where Pu
G,h
def
= P (u
|G,u) indicates the probability of assigning latent customer u for the trip r,c.
With the latent customer u
, an ensemble of u and its closely related neighbors are used for the
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.       
Personalized Air Travel Prediction 30:13
passenger profile generation. And the assignment of u can be sampled as follows:
P (u
|G,u) = ⎧
⎨
⎩
τ if˜u = u
(1 − τ )дu,u otherwise , (5)
where τ = P (u = u) is the probability of using current customer u for trip generation, дu,u is the
transition probability defined in Equation (3).
Based on the preceding design, the whole generative process of RTTM is shown in Algorithm 1.
Figure 5(b) illustrates the graphical structure of the proposed RTTM model. RTTM has a connection with other topic models that consider relationship information. RTM [7] encodes the link of
each pair of documents by adding link variables whose number is quadratic of the number of documents for each possible connection between them. ATM [33] implicitly considers the association
of documents via coauthor relationship. RTM encodes each relation with a binary variable to represent whether each pair of documents is related or not. Similarly, in ATM, an author is chosen uniformly at random for each word in the document. In contrast, our proposed RTTM introduces the
relationship between customers as a probabilistic distribution, and samples customers for trip generation using Bernoulli and multinomial distribution, which can better describe the relation of aviation customers. To some extent, ATM can be regarded as a special case of our RTTM, if we ignore
the weight on the edge of customer graph. Exploiting like-minded customers via neighborhood
structure can guide the topic learning process and force similar consumers to be close in the latent space. This has connection with the idea of neighborhood preserving embedding [15] to some
extent. It is also interesting to note that switching to other like-minded consumers stochastically
can be regarded as a way of regularization by adding noise to prevent overfitting. Such an idea has
effectively been applied in learning neural network in the form of denoising [42] and dropout [37].
ALGORITHM 1: Generative Process in RTTM
Input: K, α, β,γ , τ ;
for each customer u ∈ U do
Sample the mixture distribution of topics θu ∼ Dirichlet (α);
end
for topic k = 1 : K do
Sample the mixture distribution of routes φk ∼ Dirichlet (β);
Sample the mixture distribution of carriers ϕk ∼ Dirichlet (γ );
end
for each customer u ∈ U do
for trip tui = (rui,cui ), i = 1 : Nu do
Sample h ∼ Bernoulli (τ );
if h = 1 then
u = u;
end
if h = 0 then
Sample u ∼ Multinomial(gu );
end
Sample a topic zui ∼ Multinomial (θu );
Sample a route rui ∼ Multinomial 
φzu i

;
Sample a carrier cui ∼ Multinomial 
ϕzu i

;
end
end
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:14 J. Liu et al.
ALGORITHM 2: Inference of RTTM
Input: Topic number K, iteration number I, customer graph G, τ , Priors α, β, γ .
Output: Estimated parameters θ, ϕ, φ.
Initialization: Randomly initialize each latent customer assignment u and topic assignments z for each
trip;
for each iteration ii = 1 : I do
for each customer u ∈ U do
for trip tui = (rui,cui ), i = 1 : Nu do
Sample h ∼ Bernoulli (τ );
if h = 1 then
u = u;
end
if h = 0 then
Sample u ∼ Multinomial(gu );
end
Sample a topic zui as Equation (9);
Update N KU , NRK , NCK ;
end
end
Calculate θ, ϕ, φ using Equation (10);
end
Return estimated parameters θ, ϕ, φ;
4.2 Model Inference
The RTTM has two sets of unknown parameters, including θ, φ, ϕ, and the topic assignment z for
the latent customer assignment u
. To infer θ, φ, ϕ, we need to estimate the posterior probability
of z first. By integrating out {θ,φ,ϕ}, we can get
P (z|u) =

Γ(Kα)
Γ(α)K
U
	
U
u

k Γ(N KU
ku + α)
Γ(
k N KU
k
u + Kα)
, (6)
P (r|z) =

Γ(Rβ)
Γ(β)R
K
	
K
k

r Γ(NRK
r k + β)
Γ(
r NRK
rk + Rβ)
, (7)
P (c|z) =

Γ(Cγ )
Γ(γ )C
K
	
K
k

c Γ(NCK
ck +γ )
Γ(
c NCK
ck + Cγ )
, (8)
where Γ(·) is the gamma function, N KU is the count matrix of the number of times a specific topic
assigned to a specific passenger, NRK and NCK are the count matrix of the number of times a
specific route and carrier assigned to a specific topic.
We employ Gibbs sampling procedure [13], an MCMC (Markov Chain Monte Carlo) algorithm,
to estimate the parameters, which infers complex probability distributions by iterative sampling.
By applying Euler integration, we can obtain the sample posterior distribution:
P (zui = k,u
ui = u
|rui = r,cui = c, z−ui, u
−ui, u, G)
∝ N KU
ku
,−ui + α

k N KU
k
u
,−ui + Kα · NRK
r k,−ui + β

r NRK
rk,−ui + Rβ · NCK
ck,−ui +γ

c NCK
ck,−ui + Cγ · P
u
u i
G,h, (9)
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:15
where “−ui” means assignments excluding the current trip. After iterative sampling, this algorithm
reaches the convergence. The final results of θ, φ, and ϕ are
θu ∝ N KU
ku
,−ui + α

k N KU
k
u
,−ui + Kα
φk ∝ NRK
r k,−ui + β

r NRK
rk,−ui + Rβ
ϕk ∝ NCK
ck,−ui +γ

c NCK
ck,−ui + Cγ .
(10)
Algorithm 2 shows the detailed inference process. At the beginning, it randomly picks topics
for the customers’ trips. In each iteration, the latent customer u is assigned for each customer u
via Bernoulli and multinomial sampling. Afterwards, Equation (9) is utilized to update the topic
assignment. After enough iterations, the algorithm will converge and return the learned model
parameters θ, ϕ, φ.
The computation complexity of the inference is O(JK + JGmax
u ), where J is the total number
of trips, K is the number of topics, Gmax
u is the maximum degree of a customer in the customer
network. In practice, we keep the edges between highly similar customers, so the constructed
graph is very sparse and hence Gmax
u << U . Thus we can see that the time complexity of RTTM
is comparable with LDA whose complexity is O(JK). When topic number K is fixed, RTTM has
nearly linear time complexity with the number of customers U .
5 PERSONALIZED AIR TRAVEL PREDICTION
In this section, we describe an MFTP framework to deal with the task of air travel prediction.
Specifically, given a customer u, the likelihood that he/she prefers the travel on route r ∈ R and
flies with carrier c ∈ C can be formulated as the following:
P (r,c|u) = P (r,c,u)
P (u) ∝ P (r,c,u). (11)
We assume that there is an underlying distribution P over the set R×C×U. Therefore, our goal
is to model P (r,c,u):
P (r,c,u) = P (r)P (u|r)P (c|u,r). (12)
The term P (c|u,r) considers the two factors P (c|u) and P (c|r), the carrier company c chosen by
a customer u when he/she is planning to fly the route r. We use a parameter λ to balance the
importance between P (c|u) and P (c|r):
P (c|u,r) = λP (c|u) + (1 − λ)P (c|r). (13)
Thus we have the overall model:
P (r,c,u) = P (r)P (u|r) (λP (c|u) + (1 − λ)P (c|r)) . (14)
It can be seen that the prediction model consists of four components, that is, P (r), P (u|r), P (c|u),
and P (c|r), which captures route popularity, customer travel preferences, customer loyalty, and
market share, respectively.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:16 J. Liu et al.
Table 3. Examples of Route Popularity
Route Popularity
Beijing-Shanghai 0.0596
Guangzhou-Beijing 0.0534
Chongqing-Guangzhou 0.0263
Shanghai-Guangzhou 0.0465
5.1 Popularity of Route (POR) Factor
The distribution P (r) encodes the popularity knowledge as a distribution of routes, that is, the P (r1)
should be greater than P (r2) if r1 is more popular than r2. For illustration, Table 3 shows selected
routes’ popularity. For example, among China domestic air routes, the route between Beijing and
Shanghai is busier than the others, as both Beijing and Shanghai are international metropolises
with many points of interest.
To achieve precise estimation, we observed that a more popular route usually taken by more
passengers than a less popular one, that is, the more flights and travelers on popular routes. The
route popularity factor uses the route frequencies in the PNR dataset to estimate the distribution
P (r) as follows:
p(r) =

u f (tr,du )

u

r f (tr
,du )
, (15)
where f (tr,du ) is the frequency of a trip on route r in a customer’s profile du , that is, the number
of times that a customer u has travelled on route r.
5.2 Preference on Travel (POT) Factor
P (u|r) captures the extent to which a customer is interested in a route. As aforementioned, a
customer may have multiple preferences on choosing travel destinations, which can be seen as a
distribution of latent travel topics. Such travel topics can range from person to person. For example,
a middle-aged businessman may travel for business and family vacations as well. Similarly, air
routes also have some latent topics, such as business, tour, friend visit, and so on, which have
distinct attractions to different kinds of people. This personalized factor is calculated via the latent
topics of customers and routes learned by RTTM:
P (u|r) =

k θu,kφr,k

u

k θu,kφr,k
, (16)
where θ and φ are the U × K and R × K dimensional latent topic matrices learned by RTTM. It is
worth noting that the latent topics can be very fine-grained in application. For example, BeijingSanya and Beijing-Lijiang, which are both characterized as tourist cities, Sanya is more attractive
for family vacations, while Lijiang is more attractive for young people.
5.3 Loyalty to Carrier (LOC) Factor
P (c|u) is an indicator that reflects a customer’s preference or loyalty to a carrier company. Quite a
few customers may have some preference when selecting a carrier company due to the membership of a frequent flyer program, or the cheap fare of a low-cost carrier, and so on. The customer
loyalty factor P (c|u) captures the probability of a customer u choosing airline carrier c as his/her
carrier service provider. Based on the latent topics learned by RTTM, we have the following estimation for P (c|u):
P (c|u) =

k θu,kϕc,k

c

k θu,kϕc,k
, (17)
where θ and ϕ are the U × K and C × K dimensional latent topic matrices learned by RTTM.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:17
Table 4. Statistics of Datasets
Dataset Customers Records Companies Routes
PEK 2,503,880 49,627,025 42 305
CAN 1,206,735 19,804,814 21 241
5.4 Share of Market (SOM) Factor
P (c|r) is designed to reflect how likely that a carrierc will be chosen on the route r. It can be seen
as an indicator of a carrier’s popularity on a certain route. The more share a company has, the
more popular it is. The market share reflects the potential attractiveness of an airline company.
Based on the latent topics learned by RTTM, we have the following estimation for P (c|r):
P (c|r) =

k ϕc,kφr,k

c

k ϕc,kφr,k
, (18)
where φ and ϕ are the R × K and C × K dimensional latent topic matrices learned by RTTM.
6 EXPERIMENTS
We conduct extensive experiments on two real-world datasets to evaluate the proposed method.
In this section, we first detail the experimental settings, then compare the performance of our
approach with many other methods, and then study the topics learned by the RTTM from the
PNR data.
6.1 Experimental Setup
6.1.1 Dataset. We use 2-year anonymized PNR datasets from the airports of China’s two representative cities: Beijing (denoted as PEK) and Guangzhou (denoted as CAN). Located in north
China, Beijing is the capital city, which plays an important role in politics, economy, and culture.
Guangzhou is a typical economically developed city in south China. The models are trained with
the data of the first year, and used to make predictions for the next year. The statistics of the
datasets are shown in Table 4.
6.1.2 Evaluation Metrics. We use Precision@k, Recall@k, and F1-score@k to evaluate the Topk prediction, which are denoted as P@k, R@k, and F1@k, where k is the number of top-ranked recommendations. Given a customer, a hit occurs if one of the top-k predicted tripst = r,c matches
the ground truth trip profile of the customer. The overall Recall@k (R@k) is estimated by averaging the hit@k over all test cases:
R@k = #hit@k
|Dtest |
, (19)
where #hit@k denotes the number of hits in the test set, and |Dtest | is the number of test cases
in the test set Dtest (all trips taken by the customers in the second year). Compared with the
traditional rating-based recommendation tasks where precision is difficult to accurately compute
due to the uncertainty of zero rating [44], customer’s trip planning is more careful. Hence, we also
use the metric of Precision@k (P@k):
P@k = #hit@k
k × |U| . (20)
Based on the Precision@k and Recall@k, we further evaluate the results with F1-score@k (F1@k),
which is a combination of precision and recall:
F 1@k = 2 ×
P@k × R@k
P@k + R@k . (21)
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.  
30:18 J. Liu et al.
Another important position-based ranking evaluation metric Normalized Discounted Cumulative Gain (NDCG) [17] is also adopted to evaluate the quality of the ranking results for air travel
prediction. The NDCG metric is evaluated over some of the top k trips on the ranked trip list, based
on the assumption that highly possible trips should appear with higher ranks in the prediction list.
The NDCG value at the k-th position of the ranking result for a given tourist is computed by
NDCG@k = DCG@k
IDCG@k
,DCG@k =

k
i=1
2u(i) − 1
loд2 (i + 1)
, (22)
where u(i) is 1 if the customer has taken the trip in the prediction list at position i. IDCG@k is
the DCG@k of an ideal ordering result. The value of NDCG ranges from 0 to 1 and a higher value
indicates better ranking result.
6.1.3 Comparison Models. To evaluate the effectiveness of our proposed approaches, we compare the prediction results of many methods.
(1) LDA: this method captures the passenger preference with latent topics. It treats every
passenger as a document, and each combination of airline company and route as a word.
It takes advantage of LDA model to learn underlying topic distribution, and calculates
the similarity of passenger and carrier-route pair for recommendation.
(2) NMF: this is a well-known matrix factorization method [24]. As a widely used latent
factor model for recommendation, it factorizes the matrix of user-item with nonnegative
constrains. In this experiment, an item is a pair of airline carrier and route, that is, a trip
t = r,c.
(3) ATM: this is an Author-Topic Model [33], which is able to model a document with multiple authors. This model can also be applied to our task by regarding the profiles as
documents, trips ti in the profiles as words, and the customers and its neighbors on the
relation graph as authors.
(4) DMR: this method is also a topic model proposed to exploit arbitrary attributes when
modeling the latent topics. It has been applied in Reference [48] for discovering functional regions in a city. It is an LDA-based topic model characterized by making use of
metadata, which makes it an option for our task. When applied to the problem of air
travel modeling, the profile, trips, and customer attributes can be used as documents,
words, and metadata, respectively.
(5) RTM: this is a Relational Topic Model proposed in Reference [7]. It was developed for
modeling the linked documents. Hence, the relation between two documents is a binary
value instead of a transition probability as in our model.
(6) MFTP-por: this is a degraded version of our proposed approach presented in Equation (14) by removing the route popularity factor defined in Equation (15).
(7) MFTP-pot: this is a degraded version of our proposed approach presented in Equation (14) by removing the preference on travel factor defined in Equation (16).
(8) MFTP-loc: this is a degraded version of our proposed approach presented in Equation (14) by removing the loyalty of customer factor defined in Equation (17).
(9) MFTP-som: this is a degraded version of our proposed approach presented in Equation (14) by removing the share of market factor defined in Equation (18).
(10) MFTP: this is our proposed approach presented in Equation (14).
The parameters τ and λ are validated with values (0.1, 0.2,..., 1.0), the default value of α is
50/K , β and γ are 0.1.
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.   
Personalized Air Travel Prediction 30:19
Fig. 6. Precision and Recall with K = 50, 100 (PEK dataset).
6.2 Experimental Results
6.2.1 Prediction Results. Figures 6 and 7 illustrate the Precision@k and Recall@k of the predictions of the comparison methods. Tables 5–8 show the F1@k. From the results, we can have
the following observations: (1) The DMR model outperforms the basic LDA model, which shows
the usefulness of the customer attributes. (2) The RTM model achieves better performance than
the LDA model, from which one can conclude that the introduction of the customer graph offers
improvement in discovering the latent travel topic. (3) It is apparent that our proposed approach
MFTP achieves the best performance in terms of all the evaluation metrics. Taking the customer
graph and customer attributes into account effectively boosts the performance of topic model. (4)
The four components of our proposed MFTP approach presented in Equation (14) play important
roles for the prediction performance. (5) Especially, compared with other components, the removal
of POT factor, which is obtained via learning the travel topic model RTTM, consistently leads to
the most significant loss of the performance under each metric on both PEK and CAN datasets.
This obviously demonstrates the effectiveness and importance of the travel topic model RTTM.
(6) As the second most influential factor, the removal of route popularity POR also results in great
loss of performance, which implies people (in China) tend to travel to a number of main cities.
Such phenomenon occurs due to the concentration of population, business, tourist resource, and
so on. (7) It is also interesting to observe that the customer loyalty factor LOC shows the least
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:20 J. Liu et al.
Fig. 7. Precision and Recall with K = 50, 100 (CAN dataset).
Table 5. F1@k on PEK Dataset, K = 50
Method F1@5 F1@10 F1@15 F1@20
NMF 0.2177 0.2115 0.1829 0.1606
LDA 0.1695 0.2040 0.1865 0.1709
ATM 0.1620 0.1988 0.1892 0.1713
DMR 0.1650 0.1969 0.1935 0.1760
RTM 0.1767 0.2075 0.1962 0.1747
MFTP-POT 0.1980 0.2148 0.1980 0.1786
MFTP-POC 0.1012 0.1179 0.1218 0.1194
MFTP-LOC 0.2980 0.2949 0.2612 0.2313
MFTP-SOM 0.2792 0.2649 0.2346 0.2099
MFTP 0.3019 0.2966 0.2621 0.2315
impact on the performance. The reason is that the large amount of long-tail passengers are mostly
low-loyalty customers whose travels are often influenced by random factors such as temporary
deals and the like. (8) Although customers do not show much loyalty to carrier overall, they have
some preferences on some carriers given a route selected in mind. Hence, we can see that the SOM
factor p(c|r), which implies the market share of carrier c on route r, shows obvious impact on
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:21
Table 6. F1@k on CAN Dataset, K = 50
Method F1@5 F1@10 F1@15 F1@20
NMF 0.2463 0.2382 0.2031 0.1762
LDA 0.1992 0.2324 0.2118 0.1887
ATM 0.1949 0.2266 0.2093 0.1861
DMR 0.1965 0.2464 0.2234 0.1980
RTM 0.2007 0.2418 0.2214 0.1960
MFTP-POR 0.2271 0.2345 0.2133 0.1913
MFTP-POT 0.1158 0.1262 0.1225 0.1171
MFTP-POC 0.3238 0.3126 0.2692 0.2328
MFTP-SOM 0.3006 0.2753 0.2387 0.2109
MFTP 0.3322 0.3181 0.2725 0.2348
Table 7. F1@k on PEK Dataset, K = 100
Method F1@5 F1@10 F1@15 F1@20
NMF 0.2200 0.2089 0.1835 0.1612
LDA 0.2022 0.2220 0.2026 0.1822
ATM 0.2017 0.2208 0.2014 0.1815
DMR 0.2043 0.2319 0.2172 0.1960
RTM 0.2082 0.2246 0.2072 0.1834
MFTP-POR 0.2380 0.2457 0.2235 0.2013
MFTP-POT 0.1011 0.1181 0.1220 0.1196
MFTP-LOC 0.3177 0.3093 0.2709 0.2380
MFTP-SOM 0.2946 0.2753 0.2418 0.2144
MFTP 0.3272 0.3151 0.2746 0.2402
Table 8. F1@k on CAN Dataset, K = 100
Method F1@5 F1@10 F1@15 F1@20
LDA 0.2316 0.2496 0.2244 0.1977
NMF 0.2392 0.2279 0.1984 0.1710
ATM 0.2363 0.2522 0.2249 0.1979
DMR 0.2354 0.2671 0.2386 0.2100
RTM 0.2437 0.2648 0.2347 0.2049
MFTP-POR 0.2636 0.2682 0.2393 0.2113
MFTP-POT 0.1158 0.1262 0.1225 0.1171
MFTP-LOC 0.3430 0.3262 0.2786 0.2398
MFTP-SOM 0.3159 0.2859 0.2451 0.2152
MFTP 0.3490 0.3299 0.2808 0.2413
prediction performance. This is because carriers with higher market share can often provide more
flexible flights, which facilitates people’s travel.
Figures 8 and 9 illustrate the air travel prediction performance in terms of NDCG@k. The comparison methods demonstrate similar performance with precsion@k, recall@k, and F1@k.
6.2.2 Effectiveness of Customer Network. Next, we investigate the effectiveness of the network
in the RTTM. To make the analysis focus on the RTTM, we study the air route recommendation
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:22 J. Liu et al.
Fig. 8. Performance comparisons based on NDCG results (PEK dataset).
Fig. 9. Performance comparisons based on NDCG results (CAN dataset).
Table 9. Impact of Customer Network in RTTM
Frequency Model PEK CAN
Precision@5 Recall@5 F1@5 Precision@5 Recall@5 F1@5
<5
TTM 0.2673 0.3448 0.3011 0.2869 0.3817 0.3276
RTTM 0.2937 0.3788 0.3309 0.2962 0.3940 0.3381
<10
TTM 0.2656 0.3311 0.2948 0.2858 0.3731 0.3236
RTTM 0.2903 0.3620 0.3222 0.2944 0.3844 0.3334
performance using Equation (16), which is the most influential factor in MFTP. Table 9 shows the
performance comparison between low-frequency customers whose travel frequencies are less than
five in 1 year and those whose frequencies are less than ten. It can be seen from Table 9 that the
RTTM outperforms TTM consistently in terms of Precision, Recall and F1-score across different
travel frequencies. From Figure 10 we can see that the RTTM achieves larger improvements over
TTM on low-frequency customers. Hence, it can be concluded that incorporation of customer
network can effectively boost the travel topic model, and RTTM is useful for latent travel topic
discovering and benefits the prediction of the low-frequency customers’ travel demand.
6.2.3 Case Study. To comprehensively understand the effectiveness of the topic learning of
RTTM, we illustrate some randomly sampled topic-route distributions discovered by RTTM
from the PEK dataset and CAN datasets, respectively. As shown in Figure 11, the results are
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
Personalized Air Travel Prediction 30:23
Fig. 10. Improvement offered by Customer Relation Graph on (a) PEK and (b) CAN datasets.
Fig. 11. Visualization of the topics of routes.
understandable and reasonable. For instance, the destination cities in Topic 1 of Beijing mainly
locate in the southwest of China, and most of them, such as Guilin, Chongqing, and Kunming, are
known for their rich tourism resources. Ningbo, Hangzhou, and Wenzhou are important industrial
and commercial cities in Zhejiang Province, which implies that the routes in Topic 3 of Guangzhou
are business dominant. Such route topics discovered by our RTTM could be potentially beneficial
for marketing strategy designing and many related socioeconomic problems.
7 CONCLUSION
In this article, we presented the first systematic study on understanding and predicting personalized airline travel demand by leveraging real-word anonymized PNR datasets. Compared with
existing intra-city human mobility research based on ground transportation, this article studied
a novel problem, that is, the inter-city human mobility modeling via air travel history. Moreover,
by mining the PNR data generated in the airline industry, we proposed to model personalized air
travel behavior and travel demand. We first proposed an RTTM model, which is a topic model with
a customer relation network, to learn latent customer preferences, route topics, and carrier topics. Then we proposed a probabilistic prediction framework, MFTP, which seamlessly integrates
ACM Transactions on Intelligent Systems and Technology, Vol. 9, No. 3, Article 30. Publication date: December 2017.
30:24 J. Liu et al.
multiple important aspects, including route popularity, customer loyalty, airline market share, and
customer’s latent route preferences, to predict airline customers’ travel demands. From the experimental results on two real-world datasets, we showed the superiority of our proposed probabilistic
model and the effectiveness of each of the components. We also demonstrated the effectiveness of
the travel topic discovery provided by RTTM. With the learned travel topics of customers, routes,
and airline carriers, our approach can facilitate airline precise marketing, nationwide human mobility analysis, inter-relation of cities, and many other related socioeconomic problems, which are
of great importance in urbanization and modern civilization processes.