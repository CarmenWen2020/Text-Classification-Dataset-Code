The emerge of fifth-generation (5G) wireless networks has started a new era of the development of wireless mobile networks. Security of the 5G wireless networks is the major concern when they are deployed for commercial applications. The third-generation partnership project (3GPP) has specified the security functionality of 5G wireless in its standard release 16. However, it is prone to different attacks such as Denial of Service (DoS) attacks and false base-station attacks. Particularly, secure handover becomes a critical issue in the operation of the 5G mobile networks. In the paper, we propose an efficient and secure handover authentication protocol using the Chinese remainder theory at neighbour base stations, gNodeBs (gNBs) for secure handovers. The security of the proposal is formally evaluated to demonstrate its ability against various malicious attacks. The performance of the proposed scheme in terms of the delay incurred and energy consumption is evaluated by using JAVA simulation. The results obtained show that our scheme is secure and efficient with relatively low energy consumption, which is suitable for devices in high-speed movements.


Keywords
5G network
Handover authentication
Chinese remainder theory
Secure handover


1. Introduction
With the development of wireless communication, more and more mobile devices can be connected. The fifth generation (5G) wireless technology has brought many possibilities to our world. It is characterized to hold many outstanding features including reduced latency, lower energy consumption, reduced costs, increased system capacity, high data rates, and large-scale device connectivity. Also 5G has brought more challenges, such as the coexistence of cellular and Wi-Fi (Sathya et al., 2020a, Sathya et al., 2020b), which may affect the user experience. In the 5G wireless mobile networks, mobility management is an important issue to be carefully handled, which is to process the handovers for a user equipment (UE) moving from one service coverage to another. In 5G networks, in order to reduce the distance between UEs and base stations (BSs), more small BSs are deployed under the coverage of a macro BS, which will enhance the frequency of handover. (Ramamurthy et al., 2015, Sathya et al., 2016) Moreover, security in the handovers is critical to protect the networks from various malicious attacks. A handover authentication process is initiated to authenticate a UE with the network, which uses the Authentication and Key Management (AKA) protocol. A session key will be calculated to secure the communication after a successful authentication. The latency and security of a handover authentication protocol are critical when a UE is moving at a high speed. An authentication protocol which needs long time to complete may not be able to support the exchange of payload information when a UE is in a fast movement. And a protocol which has security loopholes may lead to suffering security attacks.

However, existing solutions cannot meet the latency and security requirements when a UE is moving at a high speed. The third-generation partnership project (3GPP) published its standard release 16 in April 2020. It has detailed specifications on the handover authentication. However, there are some weaknesses in the handover authentication process specified by the standard protocol including failure of key forward secrecy (KFS), vulnerability to Denial of Service (DoS) attacks and lack of mutual authentication between a UE and target gNodeB (t-gNB). Detailed analyses of these attacks have been presented in (Gupta et al., 2018). In order to overcome these security drawbacks of the handover processes in 5G mobile networks, many solutions have been designed to enhance the security functionality in the handover processes. A full authentication scheme with a re-authentication has been proposed in (Han et al., 2019) using a Mobile Edge Computing (MEC) server. However, the information exchanged between the MEC and Authentication, Authorization, Accounting (AAA) server has not been encrypted. And the identity of the MEC has not been verified by the AAA server. Attackers may compromise the MEC or make a fake MEC. A novel scheme integrating an initial authentication with a handover authentication has been proposed in (Sharma et al., 2019), which uses Ellipse Curve Cryptography (ECC) to allocate a private key and public key for every entity. This scheme has fixed the security drawbacks in 5G handover mentioned in (Gupta et al., 2018). However, since it has adopted the ECC algorithm, the computational overheads have been increased much. Moreover, the key backward secrecy (KBS) cannot be achieved. A region-based scheme has been proposed in (Fan et al., 2020). It has discussed handover in a heterogeneous network which is not aligned with the system structure specified by the 3GPP standard. Some improvements over the original 3GPP standard handover scheme have been suggested in (Huang and Qian, 2020). A valid solution has been designed to prevent source-gNB (s-gNB) from knowing the session key between UE and gNB. It can solve the problem of failure of KFS in the original standard scheme. However, there is a flaw in the proposed encryption algorithm, which can lead to key leakage. It encrypts Next Hop parameter (NH) by multiplying NH with a factor . The attacker can figure out  and NH from the ciphertext by guessing the factor of . This can happen especially when a group of UEs hand overs from one gNB to another gNB. In this case, each of them has a unique , which makes the attacker even easier to guess the common factor . Also, this scheme has not taken the real situation into consideration. It has suggested that the keys of all the gNBs to be included in the computation of encrypted NH. Since a UE can only handover to 1 of neighbourhood gNBs from the current s-gNB, it will be a waste of time and energy for the AMF to include all keys in the encryption progress. In conclusion, all the above solutions have their weaknesses either in high computational overhead or in security functionality or both. Some schemes have used high-computational encryption algorithms like ECC. Others are susceptible to different types of attacks such as DoS attacks. Motivated by the existing research gap, we plan to design a novel handover authentication scheme to overcome all the drawbacks of the existing solutions with relatively low overhead.

The major contribution in this paper is our proposed scheme, named as Lightweight and Secure Handover Authentication Scheme (LSHA), which holds the following outstanding features: (1) The proposed LSHA follows the system architecture specified by the 3GPP standard Release 16. It can achieve KFS and the integrity of NH by using message authentication code (MAC) with the ability to prevent DoS attacks and de-synchronization attacks. (2) The LSHA scheme repurposes the database encryption system in (Davida et al., 1981) to encrypt NH. The repurposed encryption and decryption approaches are both safe and efficient. (3) The LSHA scheme integrates the concept of cellular networks with a neighbour graph, by which the process of encrypting NH will be limited to the neighbouring gNBs of the s-gNB. The LSHA scheme has a renewal policy of pre-shared keys to prevent key leakage to some extents. 4) The LSHA scheme has a relatively low computational overhead and energy consumption. Thus, it can be used for UEs in high-speed moving scenarios.

The organization of the rest of the paper is as follows: Section 2 presents the key concepts of the paper. Section 3 illustrates the system model and threat model under the study. Section 4 details the proposed LSHA scheme. Section 5 presents the security evaluation of the protocol. Section 6 shows the results of the performances evaluation. Section 7 is the conclusion of the paper.

2. Preliminaries
In this section, we discuss the security parameters mentioned in this paper and the security vulnerabilities of 5G networks.

1.
DoS Attack A denial-of-service (DoS) attack occurs when the services or resources of a network node (e.g. a gNB) are made unavailable to the legitimate users of the network due to the actions of a malicious attacker. It can be accomplished by flooding the targeted resource with requests to overload the network and prevent some or all legitimate requests from being served (Understanding Denial-of-Service Attacks, 2019). In the current 5G standard specified by the 3GPP Technical Specification TS 33.501 R16, a DoS attack can be made by sending falsified Next Hop Chaining Counter (NCC) to UE, because the NCC is sent unprotected from AMF through gNB to UE. An illegal gNB may send a very large NCC to UE to make the authentication failed deliberately.

2.
Eavesdropping Attack Eavesdropping is a passive attack that is used by an unintended receiver to intercept a message from others. Due to the passive nature, eavesdropping is hard to detect. Encryption of the signals over the radio link is most commonly applied to fight against the eavesdropping attack. The eavesdropper cannot intercept the received signal directly due to the encryption(Fang et al., 2017) In the current 5G standard specified by the 3GPP Technical Specification TS 33.501 R16, the next hop session key between t-gNB and UE is known to s-gNB during Xn handover. Therefore, eavesdropping attacks can be made by malicious s-gNBs to compromise all messages between t-gNB and UE.

3.
False Base-station Attack A False Base-station attack can be made by false base stations which are able to mimic all functions on a network, or just simply ask the UEs to send their identifications to identify and track the devices. In the current 5G standard specified by the 3GPP Technical Specification TS 33.501 R16, as mutual authentication between t-gNB and UE is missing, an illegal t-gNB who has received the new session key from s-gNB can communicate with UE and obtain UE’s identity information.

4.
Plaintext attack The plaintext attack happens when the opponent possesses both the plaintext and its corresponding encrypted version (ciphertext). These can be used to reveal further secret information such as secret keys.

3. System model
3.1. System model
This section introduces 5G security architecture system model and attack model. As shown in Fig. 1, the system architecture of the 5G core network and access network includes several types of devices such as Access and Mobility Management Function (AMF), Authentication Server Function (AUSF) and Authentication credential Repository and Processing Function (ARPF). During a handover process, a User Equipment (UE) may hand over within an AMF, or hand over to a different AMF. The UE moves from a s-gNB to t-gNB using Xn interface within an AMF is called Xn-based inter gNB handover, or intra-AMF handover. The UE moves from a s-gNB to t-gNB using N2 interface between different AMFs is called N2-based inter gNB handover, or inter-AMF handover.

In this paper, the Xn-based inter gNB handover or Xn handover is the focus, which has been specified by the 3GPP Technical Specification TS 33.501 R16. By the specification, The Xn handover involves four entities including UE, s-gNB, t-gNB, and AMF (3GPP, 2019). By the specification, the scope of possible t-gNBs has not been specified. In fact, during a handover, the possible t-gNBs cannot be many due to the distribution of base stations. In a cellular network, in order to reuse frequency, an entire service area is divided into many cells as regular polygons, such as hexagons. In a handover, a UE can only move from the cell controlled by its s-gNB to another cell in its neighbourhood. The decision of handover is taken when downlink Signal to Interference plus Noise Ratio (SINR) received by UE from the serving cell is considerably low in comparison to the target cell. (Giluka et al., 2016) A demonstration of the handover to its neighbouring cells is shown in Fig. 2. There are normally 6 neighbouring cells around each cell. The gNB in each cell could build an undirected graph to list its neighbouring cells with corresponding gNBs. The list may include the identifier (ID) of each neighbouring gNB and the types of handover indicated as Xn interface or N2 interface. For example, Table 1 is an example of neighbourhood list of gNB-A. In Table 1, Xn means A has a direct connection with the neighbouring gNB and intra-AMF handover can be applied.
e
Fig. 1. System model of 5G network with different types of handovers.

N2 means A does not have a direct connection with this neighbouring gNB and inter-AMF handover is required. A handover can only take place from a gNB to its neighbouring gNB. The neighbours are determined not only by topological factors, but also by signal strength. This list can be learned or modified automatically by gNBs when facing incidents like power failure of some neighbouring gNBs or permanently gNB location change. In Fig. 2, the arrow from A to F represents that a UE moves from gNB-A to gNB-F. The dotted hexagons in green and red represent neighbouring gNBs of A and F, respectively.


Table 1. Sample of neighbour list.

gNBs ID	B	C	D	E	F	G
Handover type	Xn	Xn	Xn	N2	Xn	Xn
3.2. Attack model
The attack model to the network under the study is the Dolev–Yao model, which is commonly used to present security vulnerabilities in various wireless networks. By the Dolev–Yao intruder model, the intruder could overhear, intercept, analyse, or manipulate messages on the channel. Besides, due to the failure of the KFS in the Xn handover specified by the standard, the attacker who knows a session key may launch eavesdropping attacks or message modification attacks until a new session key is derived. Moreover, impersonation attacks or false base-station attacks may be launched due to the lack of mutual authentication between a UE and t-gNB during the Xn handover process. DoS attacks can also be launched by an illegal gNB who transmits lots of much smaller NCC values to the UE. The NCC is the next hop chaining counter with an initial value of zero to increase one at a time.

4. Proposed LSHA scheme
In this section, we describe our proposed LSHA scheme to overcome the security weaknesses in the existing 5G handover protocols.

4.1. Motivation of the proposal
From the literature survey, it is clear that the existing handover authentication schemes such as the 3GPP standard handover authentication have various shortcomings. They either have security vulnerabilities or are inefficient in terms of latency. Since a next hop gNB has some relationship with the s-gNB and most of the movements of a UE are continuous, handovers usually take place from a s-gNB to its neighbouring cells. Thus, by identifying the neighbour gNBs, the authentication process could be more efficient. And it is critical. Based on these considerations, we propose an efficient and secure handover authentication protocol with the concept of neighbourhood. To mitigate the shortcomings, the scheme aims to achieve various security attributes including identity verification, mutual authentication, perfect KFS, and resistance to a variety of attacks.

4.2. Details of the proposed solution
The notations of the proposed scheme with their definitions are listed in Table 2. The proposed LSHA scheme consists of three phases: (i) initial authentication, (ii) handover preparation, and (iii) handover authentication. The first phase enables mutual authentication for UE and the network. The second phase happens before a handover happens after the UE has completed the initial authentication. The third phase starts whenever the UE enters into the communication area of the t-gNB, when the mutual authentication and key agreement procedure will be initiated. The details of the proposed LSHA scheme are presented in Fig. 3. Before a handover, each gNB has a pre-shared key 
 allocated by the AMF. Only the AMF and the gNBs share the key. The AMF shall renew the key if the criteria for renewing a key are met. The key renewal process should proceed through a N2 interface before a handover operation takes place.


Table 2. Notations and definition of the proposed protocol.

Notation	Definition
Pre-shared key of 
Encrypted NH value
Access key at AMF/UE
Message authentication code
Hash function
Handover request of UE
Absolute radio frequency channel number-down link of gNB
Physical cell identity
New session key of UE/gNB

Fig. 3. The LSHA scheme.

4.2.1. Initial authentication
In this phase, the UEs, the AMF, the AUSF and the ARPF will execute the 5G authentication and key agreement protocol (5G-AKA) specified by the 3GPP standard. The purpose of the primary authentication and key agreement procedures is to enable mutual authentication between the UE and the core network and provide keying material that could be used between the UE and the serving network in subsequent security procedures (3GPP, 2019).

4.2.2. Handover preparation
This phase happens before a handover. Keying material is prepared in this phase. The operations are described below:

Step 1.
After the previous handover, a path shift request message will be sent by s-gNB, where s-gNB reports its neighbourhood list to the AMF.

Step 2.
This step happens depend on the status of pre-shared keys. If the criteria for key renewal are met, i.e., reach maximum time or maximum number of usages at one or more neighbouring gNBs, the AMF should renew the pre-shared keys for these neighbouring gNBs. A time to live (TTL) attribute is included in the message to determine the lifetime of a pre-shared key. The procedure is shown in the dotted line in Fig. 3, where n-gNB 1–5 means that all neighbouring gNBs of the s-gNB other than the t-gNB. Also, the AMF computes the session key between two neighbouring gNBs by 
 and sends them to the corresponding gNB. If the pre-shared key of a gNB is updated, the AMF computes the new session keys.

Step 3.
First, the AMF encrypts NH. Following the Chinese Remainder theory, repurposed from the database encryption and decryption system in (Davida et al., 1981), the AMF encrypts the NH in the following steps: For all allocated pre-shared keys of neighbouring gNBs 
, AMF: Compute 
 For i=1 to 6, compute 
 and 
. According to Fermat’s little theorem, one solution to this equation is 
. AMF generates 6 different 32 bits random values 
 for 6 neighbour gNBs. Then it concatenates this random value 
 with NH for each neighbour gNB, respectively. Finally, it computes 
 to encrypt NH.  is the encrypted NH value. Note that 
 should be less than 
 or the decryption will fail. A demonstration of the encryption method is shown in Fig. 4. Then the AMF encrypts NCC value using its key 
 and generates the 
. Then, it sends 
 to s-gNB in the path shift ACK message.

Step 4.
The s-gNB checks the freshness of the timestamp, stores , and sends 
 to the UE.

Step 5.
The UE decrypts the message and verifies MAC. If the verification passes, the UE trusts s-gNB. If it fails, the UE declines the connection.

4.2.3. Handover authentication
This phase happens when the UE is about to enter the communication area controlled by t-gNB.

Step 1.
The UE generates a nonce and a timestamp and encrypts with 
. Then, the UE sends 
 to s-gNB. REQ is a handover request.

Step 2.
The s-gNB decrypts the message and checks the validity of timestamp, then it sends 
 to t-gNB.

Step 3.
The t-gNB decrypts  by computing 
, where 
 is its own pre-shared key allocated by the AMF. It discards the first 32 bits random bits to recover NH value. After deriving the new NH, t-gNB calculates 
 using the formula stated in 3GPP TS 33.501 (3GPP, 2019). i.e., 
. After deriving the new session key 
, the t-gNB decrypts 
 and checks for freshness. Then, it generates a new timestamp. It sends 
 to the UE. After this step, the handover process finishes from the perspective of gNB.

Step 4.
The UE checks if the nonce received in the message from the t-gNB is equal to the nonce it sent to the s-gNB before. And it checks the freshness of the timestamp. If the verification passes, the handover authentication completes from the UE’s standpoint.

5. Security evaluation
In this section, we first formally prove that the proposed LSHA scheme can achieve mutual authentication and key agreement using the Burrows–Abadi–Needham (BAN)-logic (Burrows et al., 1989). Then we evaluate the security functionality of the scheme by using Scyther tool (Cremers, 2006). The security analysis of the scheme is presented too.

5.1. Formal proof by BAN-logic
BAN logic was first introduced by Burrows et al. It has been used to derive the logic correctness of security protocols formally. BAN-logic provides a logic way to describe the beliefs of trustworthy parties involved in authentication protocols and the evolution of these beliefs. In order to be verified, a protocol first needs to be translated into an idealization version. And assumptions and goals need to be proposed. Then, derivation rules are applied manually to reach the goals. The notations of BAN-logic are listed in Table 3 (Burrows et al., 1989).

The rules of BAN-logic for derivation can be described as follows:


Table 3. Notations of BAN-logic.

Notation	Meaning
 believes the message 
 sees the message 
 said the message 
 has authority on 
 is fresh
 is combined with a secret 
 is encrypted under the key 
 is a secret key shared between  and 
 is a shared secret between  and 
The first rule is Message Meaning Rule (MM). It can be described as 
 
 and 
 
. The first one is for shared secret key and the second one describes shared secret.

The second rule is Freshness Rule (FR). It can be described as 
 
. This rule means if one part of message is fresh, then the entire message is fresh.

The third rule is Nonce Verification Rule (NV). It can be described as 
 
. This rule means if P believes X is fresh and P believes Q sent X, then P believes Q believes X.

The fourth rule is Jurisdiction Rule (JR), which is described as 
 
. This rule means if P believes Q has jurisdiction on message X, and P believes Q believes X, then P believes X.

The fifth rule is Composition Rule (CR), which is 
 
. This rule means if P believes X and P believes Y then P believes (X,Y).

The sixth rule is Decomposition Rule (DR). It can be described as 
 
 and 
 
. This means if a P sees a message and he knows the key to the message, then he also sees its components.

The last rule is Belief Conjunction Rule (BC). It can be described as 
 
 
 and 
 
.

5.1.1. The goals of LSHA
The goals of BAN-logic are key agreement and assurance of key freshness in our scheme. In our scheme, the most important key agreement is the session key agreement between UE and t-gNB. Also, as a pre-shared key has been allocated by AMF to gNB, the key agreement about this pre-shared key between AMF and gNB has to be established. And during handover, a session key has been used to secure the message between gNBs. And therefore the key agreement of this session key has also been proved. The goals can be described as follows:

G1-G4 is the session key agreement between UE and t-gNB. A session key 
, which is only known to UE and t-gNB, will be shared by UE and t-gNB if the four goals are achieved. These four foals are the ultimate goals of the proposed protocol:

(G1) 
 

(G2) 
 

(G3) 
 

(G4) 
 

G5 and G6 describe the assurance of session key freshness between UE and t-gNB. The 
 will be up to date during the session if G5 and G6 are achieved.

(G5)

(G6) 

Since we use 
 between source gNB and one of its neighbour gNB to secure the transmission of NH, key agreement between two gNBs needs to be established, which is described in G7:

(G7) 
 

At last, as a key is allocated by AMF to each gNB to encrypt NH and generate session key between gNBs, key agreement about this key need to be established, which is described in G8:

(G8) 

5.1.2. The assumptions of LSHA
To analyse the protocol, initial assumptions are described as follows: As the connection between AMF and gNBs are considered as safe, all messages exchanged between gNB and AMF are safe, therefore we can obtain A1-A3, A6 and A8:

(A1)

(A2)

(A3)

As  has been generated with pre-shared keys by AMF, therefore:

(A4) 

As the result of the previous handover, UE and s-gNB share the session key, therefore:

(A5) 
 

(A6) 

As 
 has been established since the initial authentication, therefore:

(A7) 
 

(A8) 
 

As NCC is encrypted with 
 and can be verified with MAC, therefore:

(A9) 

As NH is generated by AMF and sent to t-gNB, and NH will be used to derive 
, therefore:

(A10) 

5.1.3. Security result
To idealize the protocol, we describe the messages in the proposed protocol as follows:

Message 1: The AMF sends 
 to all gNBs:

(M1) 

Message 2: The AMF sends 
 to s-gNB:

(M2)

Message 3: The s-gNB sends 
 to UE:

(M3)

Message 4: The UE sends 
 to s-gNB:

(M4)

Message 5: The s-gNB sends 
 to t-gNB:

(M5) 

Message 6: The t-gNB sends 
 to UE:

(M6) 

Using the rules, assumptions and messages described above, the detailed proof is given below:

First, we prove the key agreements of pre-shared keys and session keys between gNBs, which are goals G7 and G8 in step 1–8. G7 and G8 are the basis for the key agreement between UE and t-gNB. Then we prove the assurance of session key freshness between UE and t-gNB, which are G5 and G6. And finally we prove the goal of the session key agreement between UE and t-gNB G1-G4.

According to M1, A8 and rule MM, gNB believes AMF said 
: (1)
If the timestamp 
 is verified to be fresh, then gNB believes 
 is up to date: (2)
According to (2) and rule FR, if gNB believes 
 is up to date then gNB believes the whole message containing 
 is up to date: (3)
According to (1), (3) and rule NV, gNB believes AMF believes 
: (4)
According to (4) and rule BC, gNB believes AMF believes the component of the message 
: (5) (6)
According to (5), (6), A2, A3 and rule JR, all gNBs believes its pre-shared keys S and session keys with another gNB: (7)This is (G8) 
 (8)
This is (G7) 
 

So far, G7 and G8 have been proved. Then we will prove the key agreement between UE and t-gNB, which are goals G1-G4. During the process, we will also prove the freshness of the session key, which are goals G5 and G6.

We will first prove G5 and G6. According to M3 and rule DR, UE sees 
 (9)
If the timestamp 
 is verified to be fresh, according to rule FR, then UE believes the other component in the same message (NCC) is also up to date: (10)Since NCC is used to derive 
 for UE, the freshness of NCC guarantees the freshness of 
: (11)
This means UE believes 
 is fresh and therefore proves G5. According to M5 and rule DR, we have (12)
Similarly, according to (12), rule FR, if the timestamp 
 is verified to be fresh, then the other component () in the same message is also believed fresh: (13)Since  is actually encrypted NH used to derive 
 for t-gNB, the freshness of  guarantees the freshness of 
: (14)
This means t-gNB believes 
 is fresh and therefore proves G6. So far the key freshness has been assured. Then we will prove our ultimate goal G1-G4 in the following steps. According to M3, A7 and rule MM, we have (15)
According to (10) and rule FR, because a part of the message is believed fresh, UE believes the whole message is fresh: (16)
According to (15), (16) and rule NV, UE believes AMF believes 
: (17)
According to (17) and rule BC, UE believes AMF believes NCC: (18)According to (18), A9 and rule JR, consider UE use NCC to derive 
, we have: (19)
which is 
 
(G1)

According to M5 and rule DR, t-gNB sees the component () of the message if it sees the whole message: (20)Since  is NH encrypted with the key S between t-gNB and AMF, according to (7), (20) and rule MM, we have: (21)Since  is actually encrypted NH, which is used to derive 
,t-gNB believes AMF said 
: (22)
According to (22), (14), A10, rule NV and rule JR, we can derive that t-gNB believes 
: (23)
which is (G2) 
 

Then we will derive goal G3 and G4. According to M5 and rule DR, we have (24)
Because 
 is the session key, which is only known by UE and t-gNB. According to (24), (23) and MM, we have: (25)
According to (25) and rule BC, if t-gNB believes UE said the message, then it believes UE said the component of the message, which is 
: (26)
If the timestamp 
 in (24) is verified to be fresh, according to rule FR, t-gNB believes 
 is fresh: (27)
According to (27), (26) and rule NV, we can prove the goal G3: (28)
 
If 
 in M6 is verified to be fresh, then UE believes the message containing 
 is fresh: (29)
This means UE believes the message sent by t-gNB is fresh. According to M6 and rule DR, we have (30)
According to (30), (19) and rule MM, UE believes t-gNB said 
: (31)
According to (31), (29) and rule NV, UE believes t-gNB believes 
: (32)
which is (G4) 
 

In summary, all security goals are achieved. This means assurance of key freshness, key agreement and mutual authentication are achieved. UE and gNB are able to establish a secure session key and use it to encrypt messages between them.

5.2. Formal proof by Scyther tool
Scyther is an effective formal verification tool for falsification, verification and detecting potential attacks. It can analyse the security of models of Dolev–Yao model and other 9 adversary models. It can analyse the claims declared in Scyther by an unbounded model checking approach and a backward symbolic state search technique. It is coded in Security Protocol Description Language (SPDL), which is based on a C/Java-like syntax. Scyther is a tool for the formal analysis of security protocols under perfect cryptography assumption, by which it is assumed that all cryptographic functions are perfect. The adversary learns nothing from an encrypted message unless he knows the decryption key. There are many different claims in Scyther, which are synchronization (Nisynch), agreement (Niagree), aliveness (Alive), weak agreement (Weakagree), secrecy, etc (Cremers, 2006).

In the model of the proposed LSHA scheme, there are 4 roles, which are gNBs, UE, gNBt and the AMF. They represent s-gNB, UE, t-gNB and AMF, respectively. All roles are required to achieve all four claims including Nisynch, Niagree, Alive, Weakagree. And the encrypted NH and NCC are supposed to be secret. Besides, the nonce generated by a UE is required to achieve secrecy. Since the initial handover phase has been assumed secure, we only present the formal verification of the handover authentication in the proposed LSHA scheme here. The verification results are shown in Fig. 5, from which it is shown that all the four roles can achieve synchronization (Nisynch), agreement (Niagree), aliveness (Alive) and weak agreement (Weakagree). And all intermediate keys and nonces are also confidential. In conclusion, the results of the formal verification have shown that the proposed handover authentication scheme is secure.

5.3. Security analysis
The proposed LSHA scheme can resist some malicious attacks in the handover authentication process.

1.
Ability against DoS Attacks By the 3GPP original handover authentication scheme, NCC is used as an index of NH. With the NCC, a UE will know which NH is used to derive the session key. However, an attacker may launch DoS attacks by impersonating a legal gNB and sending lots of fake NCC values to the UE to sabotage the key derivation process. By the proposed scheme, the NCC value is encrypted by 
, and a MAC is computed by the AMF to ensure NCC’s integrity. The UE will check if the NCC’s MAC value is equal to the received MAC value before it uses NCC value to derive NH. Even if an illegal gNB sends a fake NCC to the UE, MAC verification will fail and therefore DoS attack cannot proceed.

2.
Ability against Eavesdropping/Message Modification By the 3GPP original handover authentication scheme, the s-gNB computes 
 and forwards it to the possible t-gNBs. It will be directly used as the next-hop key. So, the s-gNB knows which key will be used in next hop and therefore KFS cannot be ensured. Failed KFS will make it possible for the adversary to know future session keys, which will result in eavesdropping or message modification. By our scheme, the CRT-based encryption algorithm is used to encrypt the NH. Only the neighbour gNBs can decrypt the NH because their pre-shared keys have been included in the computation of  by the AMF. Since the s-gNB’s key is not included, it cannot obtain the NH value and cannot know the next hop key 
. As a result, the illegal gNB cannot access or modify any message exchanged between the UE and the t-gNB.

3.
Ability against Impersonation/False Base-station It is possible for an illegal gNB to impersonate a legal gNB in order to setup illegal communication with UEs. By our proposed scheme, since the MAC has been used, a UE is able to tell if NCC has been modified by an impersonated gNB. Even if a gNB wants to lure the UE by sending a false NCC value, the UE will notice it and disconnect with that gNB by calculating the MAC of NCC value using 
. And this MAC cannot be calculated by the impersonated gNB because only the AMF and the UE know
. Moreover, only the legal gNB can receive the new pre-shared key from the AMF. Even if a compromised gNB steals the pre-shared key from a legal gNB, that key is only valid for a period. Without a valid pre-shared key, the compromised gNB cannot derive 
 to communicate with the UE. The UE can authenticate the gNB by determining if the correct pre-shared key is used to derive the session key and if the gNB has modified the NCC value. In this way, the false base-station attacks and the impersonation attacks can be prevented.

4.
Ability against Pre-shared Key Leakage By our scheme, the AMF computes and sends the pre-shared keys to gNBs. However, the gNBs are usually located far from core networks and have limited protection measures. Therefore, the pre-distributed key may be leaked. By the proposed LSHA scheme, the pre-shared key update mechanism has been introduced, by which the key will be renewed after a period. Even if the key leaks, it will be nullified after a period. The attack is to be solved within the key update interval so the negative impact can be controlled.

5.
Ability against Plaintext Attack An attacker knowing the plaintext value 
 for two messages can determine the key 
 from ciphertexts by computing the greatest common divisor (GCD) of 
 and 
, where  is the ciphertext. This is because the decryption process is done by calculating 
. However, this attack is hard to implement because the 32 bits redundancy 
 has been concatenated with NH. Thus, the attack must be made by subtracting 
 for all possible 
 in two messages. Since 
 is a 32 bits redundancy, the attacker may try 
 combinations to guess the true 
 and 
. Thus, the time for the attacker to compromise a key can be estimated by: 
, where  is the time required to determine the greatest common divisor of two numbers. As the pre-shared keys are to be updated periodically, this attack cannot succeed.

6. Performance evaluation
In this section, we evaluate the performance of our proposed LSHA scheme and the scheme in the paper (Sharma et al., 2019), 5G standard specified by 3GPP (3GPP, 2019), and (Zhang et al., 2019). They are indicated as CSE, 5G and RUSH, respectively. It includes the evaluation of computational cost, communication cost and energy consumption.

6.1. Computational cost
The computational cost is calculated and measured on a laptop which runs 64-bit Windows 10 system with 4.5 GHz Intel Core I7 CPU and 16 GB RAM. The cryptographic libraries used are Bouncy Castle on Java platform and Java Cryptography Architecture (JCA). Using the platform mentioned above and the relevant parameters listed in Table 4, the computation time for cryptographic primitives are measured on the laptop. The results of the measurement are shown in Table 5.

Table 6 includes the computational overhead in the entire handover procedure and the overhead that only appears in the handover authentication phase. Some operations can be done in the handover preparation phase before handover authentication to accelerate the handover process. The UE in the entity column in the table represents the computational overhead at the UE side. The CN represents 5G core networks. As shown in Table 6, the computational overhead of our scheme LSHA is a little higher than 5G. The computational overhead of the CSE scheme is an order of magnitude higher than that of the LSHA scheme. The computational overhead of RUSH is two orders of magnitude higher than that of the LSHA scheme. It is mainly because the CSE and RUSH schemes require two-point multiplication operations in the process. While the LSHA scheme has employed a relatively lightweight encryption algorithm of Advanced Encryption Standard (AES).


Table 4. Length of parameters.

Parameters	Size (in bits)
288
256
160
Hash, nonce, ID, SUCI, ECI, PCI, 
128
64
POS, NAI, LAI	40
timestamp	32
3
ECC parameters 	256,1024

Table 5. Computation cost of basic operation.

Notations	Description	Computation time (μ)
The time cost of one AES (CTR mode) encryption or decryption operation (256 bits block and 128 bits key)	1.522
The time cost of one scalar multiplication operation	536.229
The time cost of one multi scalar multiplication operation	670.286
The time cost of one hash (SHA-256) operation	0.538
The time cost of an MAC (HMAC-SHA-256) generation or verification operation	1.858
The time cost for generating a 128-bits nonce	1.532
The time cost of proposed encryption algorithm	7.829
The time cost of proposed decryption algorithm	0.083

Table 6. Computational costs.

Protocol	Entity	Computational overhead	Execution time (μ)
Total	During handover	Total	During handover	Whole protocol
LSHA	CN	
–	12.731	–	35.544
(12.797 during handover)
UE	
11.538	4.566
gNB	
11.275	8.231
CSE	UE	
542.341	6.112	1085.22
(548.991 during handover)
gNB	
542.879	542.879
5G	UE	
3.674	1.522	9.854
(6.088 during handover)
gNB	
6.18	4.566
RUSH	UE	
2279	1206.515	4558
(2413.03 during handover)
gNB	
2279	1206.515
6.2. Communication cost
The communication delay includes transmission delay and propagation delay. According to the 3GPP specification TS 22.261(3GPP, 2020), the experienced data rate of downlink of general wide-area scenario in the urban area is 50 Mbps and the uplink data rate is 25 Mbps. Using the parameters from the 3GPP standard, the transmission delay for each protocol can be figured out. As for the propagation delay, the wave propagation speed is approximately equal to the speed of light as 
 in wireless communication. The radius of a cell is 200 m. It is assumed that the signal sent by a UE will travel 200 metres at the speed of 
 to arrive at a gNB. So, the propagation delay from the UE to gNB is μ. The theoretical communication cost of the four protocols is compared in Table 7, where 
 represent the transmission delay, propagation delay and total communication time, respectively. As shown in Table 7, the proposed LSHA scheme has a better performance over the RUSH and CSE schemes and has a similar performance with the 5G scheme. This is because our scheme transmits less information to a gNB compared to the CSE and RUSH schemes.

Finally, the robustness of schemes is evaluated on Java JDK 1.8.0 platform. In the simulation, unknown attacks have been introduced to the system. Unlike the attacks claimed in the security analysis section, which can be detected and properly handled, the unknown attacks may or may not be prevented by 4 compared schemes. When facing unknown attacks, the authentication process could be forced to stop and restart. For simpleness, it is assumed that at each step of the authentication, the probability of the unknown attacks appear is even. The average time for a successful handover is calculated following the way as in (Shang et al., 2020). Fig. 6 shows the simulation results in terms of average communicational overhead (in bits) of the proposed LSHA scheme, the CSE scheme, the 5G scheme and the RUSH scheme. In the figure, it can be clearly seen that LSHA has a relatively lower communicational overhead compared to the CSE scheme and the RUSH scheme. And it increases slower when the percentage of unknown attacks increases than the CSE and RUSH schemes. Fig. 7, Fig. 8 show the simulation results in terms of the average time taken for execution of the 4 schemes. The time cost in this figure equals computational cost plus communication cost by each step. In the figures, the average time taken for the handover authentication excluding the handover preparation by the two authentication schemes and the total time have both been presented.

It is clearly shown in two figures that with the increase of the unknown attacks, the time costs by all handover authentication schemes increase. The proposed LSHA scheme has a better performance in terms of the total time costs and handover time costs than the RUSH and CSE schemes and a similar performance with the 5G scheme. To sum up, it is obvious that the LSHA scheme has a better performance over the CSE scheme and the RUSH scheme.


Table 7. Communication costs of different protocols.

Scheme	Link	Communication overhead	
μ	
μ	μ
LSHA	Up	256 bits	10.24	0.67	10.91
Down	387 bits	7.74	1.33	9.07
Insidea	995 bits	19.9	1.33	21.23
CSE	Up	1768 bits	70.72	1.33	72.05
Down	960 bits	19.2	0.67	19.87
5G	Up	640 bits	25.6	2.01	27.64
Down	256 bits	5.12	1.33	6.46
RUSH	Up	896 bits	35.84	1.33	37.17
Down	896 bits	17.92	0.67	18.59
a
Inside means messages sent and received in 5G Access Network (AN) and 5G Core Network.


Fig. 6. Average communicational overhead.


Fig. 7. Time cost simulation result (during handover).
e
Fig. 8. Time cost simulation result (total time).


Table 8. Energy consumption in basic operation.

Notations	Description	Energy consumption
The energy cost of a MAC generation or verification operation	μ
The energy cost for transmitting one bit	μ
The energy cost for receiving one bit	μ
The energy cost of one AES encryption or decryption operation (per 256-bits block with 128-bit key)	μ
The energy cost of one scalar multiplication operation	8.8 mJ
The energy cost of one ECDSA verification.	16.5 mJ
The energy cost of one SHA-1 hash operation	μ
ECDSA: The elliptic curve digital signature algorithm

6.3. Energy consumption
For the energy constraint equipment such as UEs, the energy consumption is a major concern. To answer the concern, the energy consumption at the UEs and other entities in the network have been evaluated and compared.

The energy cost of the cryptographic primitives in Table 8 can be obtained in (Carman et al., 2000, Teo and Ming, 2008). They are evaluated with StrongARM 133MHZ SA-1110 microprocessor and LA-4121 WLAN card respectively. The energy consumption of decrypting the NH is negligible because the decryption method is only a module operation. Using the energy consumption cost of the cryptographic primitives, based on the cryptographic operation used in the four protocols, the theoretical energy costs have been derived in Table 9.

From Table 9, it is shown that the computational energy consumption by the CSE scheme is one order of magnitude higher than the proposed LSHA scheme, and the computational energy consumption by the RUSH scheme is two orders of magnitude higher than the proposed LSHA scheme. This is because the CSE and RUSH schemes use the elliptic curve cryptograghy, which requires point multiplication operations to generate key pairs. This is very energy consumptive. On the other hand, the proposed LSHA scheme only utilizes simple symmetric encryption and it utilizes the CRT-based algorithm to generate the encrypted NH. So, it has a better performance in terms of energy consumption. And our scheme has a similar performance with the 5G scheme.

Fig. 9 shows the relationship between the energy cost at UE and the percentage of unknown attacks. In the figure, it is clearly shown that the LSHA scheme has a lower energy consumption compared to the CSE scheme and the RUSH scheme, which meets the theoretical analysis. The LSHA scheme costs about 
 to complete a handover authentication for UE, while the CSE and the RUSH need about 
 and 
, respectively. Also, the 5G scheme has a lower energy consumption than our scheme. However, the 5G scheme has security problems and is prone to attacks. Our scheme, on the other hand, greatly enhances the security of the network at the cost of a little more overhead than the 5G scheme. Thus, our scheme has a better performance in terms of both security and efficiency.


Table 9. Energy consumption of different protocols.

Protocol	Type	Operation (UE side)	Energy Cost/μJ
LSHA	Computational	
41.22
Transmission	
279.01
CSE	Computational	
8867.26
Transmission	
1464.48
5G	Computational	
12.98
Transmission	
124.16
RUSH	Computational	
42900
Transmission	
869.12
7. Conclusion
In this paper, we have proposed the LSHA scheme to enhance the security functionality of the 3GPP standard handover authentication scheme by pre-distributing keys to neighbouring gNBs. The MAC is used to protect NCC from falsifying. The LSHA scheme has been verified to be able to resist plaintext attacks, DoS attacks, de-synchronization attacks, false base-station attacks with perfect KFS. The performance evaluation has shown that our scheme has a lower delay and lower energy consumption than the other existing schemes. Thus, it can meet the security and latency requirements when UEs are moving at a high speed.

