To access an unlicensed channel, Wi-Fi follows the Listen Before Talk (LBT) mechanism, whereas LTE-U (and future New Radio in Unlicensed (NR-U) Patriciello et al., 2020; Lagen et al., 2019) adopts the ON–OFF duty-cycled mechanism to fairly share the channel with Wi-Fi. These different mechanisms result in quite different performance for Wi-Fi and LTE-U/NR-U based on their relative deployment and density in the environment. In this work, we present an analytical model for the characterization of achievable throughputs of Wi-Fi and LTE-U networks in spatially distributed scenarios with downlink-prevalent traffic. The proposed model is used to study how LTE-U and Wi-Fi coexist with each other in spatially distributed scenarios. Our extensive simulation results show that it is a reliable model for estimating the throughput of both Wi-Fi and LTE-U in a spatially distributed deployment. The impact of various network parameters such as energy detection and carrier sense threshold on Wi-Fi and LTE-U coexistence is explored as a byproduct and corroborated via a National Instrument experimental test bed. Our model gives very high accuracy in throughput estimation and the mean normalized error is less than 3% for a 80-node scenario in which 50% of nodes belong to each of Wi-Fi and LTE-U network. The analytical model is also used to conduct coexistence studies of LTE-U and Wi-Fi.

Previous
Next 
Keywords
Wi-Fi

LTE-U

NR-U

CSAT

LBT

Inter-RAT coexistence

Performance analysis

1. Introduction
Spectrum plays a crucial role for achieving the goals of 5G. The use of limited and costly licensed spectrum is not sufficient enough and economically viable to meet the increasing user demand. Therefore, the mobile operators and telecommunication industries have moved their focus on using unlicensed spectrum to meet the increasing user demand which is expected to cross 77.5 EB per month by 2022 (Cisco, 2019). In a recent study commissioned by the Wi-Fi Alliance (Methley and Webb, 2017), between 2020 and 2025, users worldwide are likely to experience a spectrum shortfall. However, recently on October 23, 2018 Federal Communications Commission (FCC) announced a Notice of Proposed Rule Making (NPRM) seeking to open up 1200 MHz of additional spectrum in 6 GHz band for unlicensed use (FCC, 2018). Similarly, the European Commission also plans to open 500 MHz in the 6 GHz band (5925–6725 MHz) for unlicensed access. Hence it is clear that regulatory authorities worldwide are paying close attention to the 6 GHz band as the next spectrum band that will continue to enhance unlicensed services across the world. However, it is also clear that this band, like the 5 GHz band, will see both Wi-Fi (Wilhelmi et al., 2019) and cellular systems being deployed, and hence the coexistence issues played out in the 5 GHz band will repeat in this new frequency as well. In recognition of this, the two principal stakeholder standardization entities, IEEE and 3GPP, held a coexistence workshop in July 2019 (IEEE 802.11 coexistence workshop, 2019) to discuss methods to address this prior to the next generation of standards being specified. Thus, the usage of unlicensed spectrum seems to be a promising solutions for the operation of LTE and upcoming 5G NR (New Radio) to meet increasing user demand. However, the major challenge for deploying LTE/NR in an unlicensed spectrum is the fair coexistence requirement with existing technologies in the unlicensed spectrum, mainly IEEE 802.11 a.k.a. Wi-Fi technology. Thus, fairness in unlicensed spectrum needs to be properly defined and tested before deploying LTE in unlicensed spectrum. The 3rd Generation Partnership Project (3GPP) (3GPP, 2015) defines fairness as: LTE design in unlicensed spectrum should be in such a way that it should not impact Wi-Fi more than another Wi-Fi on the same unlicensed channel.

There are two ways of operating LTE/NR in unlicensed spectrum: (i) LTE/NR with discontinuous transmissions (ON–OFF cycles) a.k.a. LTE-U (Qualcomm, 2014, LTE-U Forum, 2015b); (ii) LTE/NR with Listen-Before-Talk (LBT) mechanism a.k.a. Licensed Assisted Access (LAA) (3GPP, 2015), which is similar to Wi-Fi in terms of channel access. LTE-U/NR-U has received a lot of attention in the industry because of its ease of implementation and minimal change in the LTE/NR protocol. In the ON–OFF cycle of LTE-U/NR-U, the ON time of LTE-U/NR-U corresponds to the LTE-U transmissions period, and the OFF time corresponds to no transmissions from LTE-U/NR-U so that Wi-Fi and other LTE-U/NR-U can get access to the medium for transmissions. Due to the regulatory restrictions on transmission power in unlicensed spectrum, mobile operators have to deploy a large number of LTE-U/NR-U small cells in indoor/outdoor environments. Such a dense deployment of LTE-U small cells along with existing Wi-Fi Access Points (APs) could lead to inefficient utilization of unlicensed spectrum resources due to interference, inter-RAT hidden terminal problem, and lack of coordination among heterogeneous RATs (Baswade et al., 2018a). The NR-U that may gain momentum in the future, i.e., a duty-cycle version (inspired by LTE-U), which does not perform a Clear Channel Assessment (like LAA) before transmission and may be suitable in world regions without LBT requirements (like in the USA).

Most of the existing works on throughput estimation of Wi-Fi assumes that every node in the Wi-Fi network can sense all the other nodes in the network (Bianchi, 2000, Kala et al., 2019). Further, to calculate the throughput of Wi-Fi network in a generalized scenario, new models have been proposed (Liew et al., 2010) to cover all possible scenarios e.g., a node can only sense transmissions of a subset of nodes. The recent inclusion of LTE-U/NR-U in the unlicensed spectrum makes throughput estimation of Wi-Fi more challenging. In Jiang and Mao (2017) and Abdelfattah and Malouch (2017), the authors modeled throughputs of LTE-U and Wi-Fi networks in the coexistence scenario where each node can sense all the other nodes on the channel (i.e., both the LTE-U and Wi-Fi nodes are inside Energy Detection Threshold (EDT) range of each other). But, the case when the nodes can sense the presence of only a subset of nodes in the network makes throughput estimation more challenging. In practical deployment scenarios, all LTE-U and Wi-Fi nodes cannot hear each other as the nodes are spatially distributed. Hence, throughput estimation in spatially distributed scenarios is essential as it helps to study the coexistence of LTE-U and Wi-Fi in greater depth.

In this paper, we model the throughput of LTE-U and Wi-Fi nodes (eNB or AP) in spatially distributed scenarios. Further, we use the model to study how LTE-U and Wi-Fi coexist with each other in spatially distributed scenarios. To the best of our knowledge, this is the first work in the direction of estimation of throughputs in Wi-Fi–LTE-U networks in spatially distributed scenarios.

1.
We provide an analytical model to evaluate the throughputs of spatially distributed dense LTE-U and Wi-Fi networks.

2.
We validate our proposed analytical model with real-time software defined radio (SDR) based test bed environment for less number of LTE-U and Wi-Fi nodes.

3.
We validate the proposed analytical model in high-density and low-density scenarios through extensive simulation studies.

4.
Using our analytical model, we perform coexistence studies of LTE-U and Wi-Fi in different deployment scenarios.

The rest of the paper is organized as follows. Related works are presented in Section 2, and the system model is given in Section 3. Section 4 formulates the problem of throughput estimation in a spatially distributed LTE-U and Wi-Fi network scenario and Section 5 proposes an analytical model for the same. Section 7 validates the proposed model with analysis, simulation & real-time test bed and studies the performance of Wi-Fi–LTE-U networks in different scenarios. Finally, Section 8 summarizes and concludes the work.

2. Related work
The authors in Sagari et al. (2015b) have demonstrated that the effect on Wi-Fi performance is much more when LTE operates in unlicensed channel without employing any coexistence mechanism compared to the presence of Wi-Fi networks. It is shown that when both LTE and Wi-Fi networks operate on the same channel, Wi-Fi throughput suffers from 20% to 97%, while LTE experiences loss in throughput up to only 10%. Similar studies on performance degradation to Wi-Fi in the presence of LTE are carried out in Nihtilä et al. (2013), Ratasuk et al. (2012), Sagari et al. (2015) and Cavalcante et al. (2013). Thus, for better coexistence with Wi-Fi, duty-cycled LTE-U and LBT based LAA are proposed by LTE-U Forum (LTE-U Forum, 2015b) and 3GPP (3GPP, 2015), respectively. Duty cycled LTE-U solution is easy to implement and required very minimal changes in the LTE protocol stack hence gained a lot of attention from the industry. An almost blank subframe is one way to mute LTE-U transmission (Almeida et al., 2013). In Liu et al. (2019), a comprehensive survey for resource management in LTE-U is presented. In Sathya et al. (2020), the authors focused on studying the user association issue when LTE-U and Wi-Fi coexist on the same channel, specifically addressing the question of how large a duty cycle should LTE-U be using to ensure user association fairness with Wi-Fi. Many studies (LTE-U Forum, 2015b, Li et al., 2016, Cano and Leith, 2015, Biswas and Wu, 2019) demonstrated that the duty cycle mechanism allows LTE to be a fair neighbor to Wi-Fi if the LTE-U ON and LTE-U OFF durations are chosen properly based on the Wi-Fi activities in the unlicensed channel (Cano and Leith, 2015). A detailed survey on fair coexistence of LTE-U and Wi-Fi can be found in Zinno et al. (2018).

In the literature, there has been a lot of work on modeling and performance analysis of Wi-Fi networks (Bianchi, 2000, Liew et al., 2010, Ng and Liew, 2007, Gao et al., 2006). The coexistence of LAA and Wi-Fi is modeled in Chen et al. (2015), Gao et al. (2016) and Baswade et al. (2018b) based on the widely used Bianchi model (Bianchi, 2000). Furthermore, the coexistence of LTE-U and Wi-Fi when all nodes can hear each other is modeled and studied in Jiang and Mao (2017) and Abdelfattah and Malouch (2017). But, in general the nodes are deployed spatially, and all the nodes are not always inside EDT of each other. The placement of both Wi-Fi and LTE-U nodes can be quite arbitrary due to many practical constraints in the environment. Even multiple parallel LTE-U and Wi-Fi transmissions are possible on a given channel based on the deployment scenario. Dense deployment of Wi-Fi and LTE-U networks can have any placement in indoor/outdoor scenarios. Hence, the throughput estimation for a generalized scenario is an essential requirement for the study of fair coexistence of LTE-U and Wi-Fi networks, and it can also help to do the efficient placement of LTE-U and Wi-Fi nodes. In this paper, we propose an analytical model to estimate the throughput of LTE-U and Wi-Fi networks in a generalized scenario.

In Patriciello et al. (2020) and Lagen et al. (2019) author proposed a duty cycle based NR-U Wi-Fi coexistence on 60 GHz millimeter operation. The proposed NR-U duty cycle operation is 50% ON and OFF periods of 9 ms duration. The author compared a different NR-U channel access scheme with LBT and duty cycle approach in this work. The results demonstrate that NR-U with duty cycle or LBT ensures a fair coexistence objective in terms of throughput. The channel access mechanism for NR-U based on LBT or duty cycle ensures a similar friendly approach in millimeter operation. Currently, in a developed country like the USA, most of the carriers like T-Mobile, AT&T, Verizon deployed 5G NR (Xu et al., 2020, Narayanan et al., 2020) in low-band, mid-band, and millimeter band. We expect the NR-U deployment will be soon by the carriers. We also believe that our proposed analytical model on LTE-U and Wi-Fi is well adopted in the future NR-U and Wi-Fi coexistence.

3. System model
The system model comprises of multiple Wi-Fi APs and LTE-U/NR-U eNBs deployed in a spatially distributed configuration. All Wi-Fi and LTE-U/NR-U nodes in the system are operating on the same unlicensed channel. The Wi-Fi is following the distributed CSMA/CA protocol in which they perform Clear Channel Assessment (CCA) before channel access. Whereas, the LTE-U/NR-U is following the ON–OFF cycle (CSAT mechanism) for fair coexistence with the Wi-Fi. The Wi-Fi and LTE-U/NR-U nodes can hear to only a subset of nodes in the network. For analysis, the time is divided into the parts of 
. The 
 denotes the sum of LTE-U/NR-U ON and OFF times. We assume 
 to be the same for all the LTE-U/NR-U nodes for simplicity. Fig. 1a shows one such spatially distributed system, where, there are three LTE-U nodes (L1, L2, and L3) and three Wi-Fi nodes (W1, W2, and W3).

3.1. Assumptions
3.1.1. Traffic
We consider only the downlink traffic for both LTE-U/NR-U and Wi-Fi networks. Also, we assume a full-buffer case where each node (eNB/AP) always has data for transmission, similar to BoE model (Liew et al., 2010).

3.1.2. LTE-U/NR-U operation mechanism
The LTE-U/NR-U follows the ON–OFF mechanism (CSAT mechanism) to coexist with the Wi-Fi. In the CSAT mechanism, LTE-U/NR-U senses the channel during OFF time and tunes its duty cycle as per the load it perceived on the channel. We can roughly map the load to the number of nodes (Wi-Fi and LTE-U/NR-U) in its sensing range in the saturation case and full buffer conditions. So, we can derive the LTE-U/NR-U ON period, 
 as 
. The  in the denominator is to include itself. Unlike Wi-Fi, the LTE-U/NR-U does not perform CCA before transmission; it transmits for 
 duration in a 
 when certain conditions are met as discussed in Section 3.1.3.

3.1.3. LTE-U collision avoidance
After every 
, each LTE-U/NR-U node with non-zero 
 tries to negotiate their transmission willingness through the X2 interface. The primary purpose of the X2 interface is to avoid multiple LTE-U nodes in each other’s vicinity to start transmission at once and thus avoid collisions among LTE-U nodes (Sawahashi et al., 2010, Brueck et al., 2010, Zhang et al., 2019). Since the best LTE-U transmission pattern cannot be known without the knowledge of complete network topology, and we are not addressing the issue in this work, we assume each LTE-U node negotiates its way for transmission with equal probability.

3.2. Wi-Fi–LTE-U/NR-U network graph
The Wi-Fi node classifies another Wi-Fi node to be in its range if the received signal strength exceeds Carrier Sense Threshold (CST), and for any other node, if the received signal strength exceeds Energy Detection Threshold (EDT). Whereas, the LTE-U/NR-U node classifies any node to be in its range if the received signal strength exceeds EDT. In the network graph of Fig. 1b, an edge between two Wi-Fi nodes indicates that both the nodes are inside the CST range of each other and an edge between Wi-Fi and LTE-U/NR-U nodes or LTE-U/NR-U and LTE-U/NR-U nodes indicates that these nodes are inside the EDT range of each other. Thus, whenever there is an edge between two nodes, only one of the nodes can successfully transmit on the channel. In contrast, no edge between the nodes indicates that both the nodes can transmit simultaneously.

3.3. LTE-U/NR-U network graph
An LTE-U/NR-U node before transmitting, only checks for the status of other LTE-U/NR-U nodes in its range through the X2 interface, and acts accordingly. We draw a separate LTE-U/NR-U network graph from Wi-Fi–LTE-U/NR-U network graph, as shown in Fig. 1c to derive the possible LTE-U/NR-U network-states. The LTE-U/NR-U network-state gives the state of each LTE-U/NR-U node in the network (More on that in Section 4). Though Wi-Fi information is missing from the LTE-U/NR-U network graph, LTE-U/NR-U ON time is derived from the activity of all nodes (Wi-Fi and LTE-U/NR-U) in its vicinity.

3.4. Wi-Fi contention graph
The Wi-Fi contention graph represents the set of Wi-Fi nodes that can transmit in a particular LTE-U/NR-U network-state. The Wi-Fi performs CCA before transmission, so when there is an ongoing LTE-U/NR-U transmission, all Wi-Fi nodes in its range back off for 
 duration. Therefore, we can derive the Wi-Fi contention graphs, as shown in Fig. 2 for LTE-U/NR-U network-states, as governed by the LTE-U/NR-U network graph shown in Fig. 1b. Fig. 2a shows the Wi-Fi contention graph when nodes  and  are transmitting. Here, node  cannot transmit due to the ongoing activity of  and . Similarly, based on the states of LTE-U/NR-U nodes in the network (LTE-U/NR-U network-state), other possible Wi-Fi contention graphs are derived as shown in Fig. 2b to e.

4. Problem formulation: Throughput computation from LTE-U /NR-U network-state transition diagram
In this section, we illustrate the behavior of Wi-Fi–LTE-U/NR-U networks in the coexistence scenario. Later, we use these observations to formulate the LTE-U/NR-U network-state Transition Diagram (LTD), which gives the LTE-U/NR-U network behavior over time. For this section, we restrain ourselves to the example-network (Fig. 1a), but in later sections, we define LTD formally.

4.1. Behavior of Wi-Fi–LTE-U/NR-U networks in the coexistence scenario
Consider the Wi-Fi–LTE-U/NR-U network shown in Fig. 1a. From the system model, the ON period (
) is computed as 
 for LTE-U/NR-U nodes L2 and L3, and 
 for LTE-U/NR-U node L1. When the 
 starts, all nodes L1, L2, and L3 try to transmit, but for this example, we can identify two specific events. Irrespective of L2/L3 transmits, L1 transmits since it is outside the EDT range of L2 and L3. For Fig. 1a, two time-sequence diagrams are possible depending on which node among L2/L3 transmits first; Case-1: L2 transmits first, Case-2: L3 transmits first.

The time-sequence diagram gives the sequence of events that happen in a Wi-Fi–LTE-U/NR-U network. For example-network Fig. 1a, two time-sequence diagrams are possible as shown in Fig. 3. In Fig. 3, the 
 is divided into several time segments based on the transmissions of LTE-U/NR-U nodes. The LTE-U/NR-U nodes that are transmitting are shown in the time segment, and the corresponding Wi-Fi contention graph is shown above the time segment. For analysis, consider Case-1 (L2 transmits first), Fig. 3a. L1 and L2 transmit at the start of 
. When the time 
 (
 of L2) elapses, L2 ends its transmission, allowing the other nodes to occupy the channel. L3 picks up from that point. After time 
, L1 ends transmission, and finally, after time 
, L3 ends transmission. During this 
 period, some parts of the Wi-Fi network graph (Wi-Fi contention graphs) are allowed to transmit. At this point, all LTE-U/NR-U nodes completed their transmission, and they all be mute until the next 
. The Wi-Fi network utilizes the remaining 
. A similar explanation goes for Case-2, Fig. 3b. From these two time-sequence diagrams, we observe two major phenomenons in the Wi-Fi–LTE-U/NR-U coexistent network:

Fig. 3. LTE-U/NR-U transmission cases and change in corresponding Wi-Fi contention graphs, over 
 for (a) Case-1 (b) Case-2.

4.1.1. Updation of Wi-Fi contention graph over time
The Wi-Fi contention graph is not constant, and it updates over time. In both cases, Fig. 3a and b, the Wi-Fi contention graph is changing over time, depending on the states of LTE-U/NR-U nodes in the network (LTE-U/NR-U network-state).

4.1.2. Different Wi-Fi contention graphs in different LTE-U/NR-U network-events
The Wi-Fi contention graphs of Case-1 (Fig. 3a) and Case-2 (Fig. 3b) are clearly different, e.g., the Wi-Fi contention graph W1–W2 that occurs between 
 and 
 in Case-1 does not occur in Case-2. And the time for which the Wi-Fi contention graphs occur is also different in the two cases, which results in different channel access time for some Wi-Fi nodes, e.g., in Case-1, the Wi-Fi node W1, gets the channel access time of 
 (
), whereas in Case-2, it gets 
.

4.2. Formulation of LTE-U/NR-U network-state transition diagram, and throughput computation
To start with, we assign each LTE-U/NR-U node a state from {0, 1, 2}. States 0, 1, and 2 mean, yet to transmit, transmitting, and completed transmission, respectively. LTE-U/NR-U network-state is formed by grouping the states of all LTE-U/NR-U nodes, e.g., (0,0,0), (1,0,1). When the 
 starts, all LTE-U/NR-U nodes are in the state 0, so the LTE-U/NR-U network of Fig. 1a, is in the initial network-state (0,0,0). The LTD is formed by identifying the possible events in a given state. Fig. 4 shows the LTD of the network given in Fig. 1a. In Fig. 4, from each network-state, different paths arise, indicating the possibility of different events. The fraction on the path represents the probability of that particular event. The ordered pair above each network-state gives the probability of the network-state and the time for which the network-state exists. The network-states (0,0,0), (1,0,0), (0,1,0), and (0,0,1) are mentioned to be transient states in LTD. We define the term transient state formally in later sections, but for now, transient states are those in which there is an incomplete or immediate transition. The LTE-U/NR-U network does not spend time on transient states, so they are represented by writing  for the time variable in the ordered pair.

The LTD of Fig. 1a, shown in Fig. 4 starts in the state (0,0,0), and after a series of transitions it ends in the state (2,2,2). In LTE-U/NR-U network-state (0,0,0), all LTE-U/NR-U nodes try to transmit, which results in network-states (1,0,0), (0,1,0) and (0,0,1); these events are equiprobable to occur (Section 3.1.2). Here, we need to note that L1 is outside the EDT range of L2 and L3, and transmits independently. So strictly speaking, there are only two events (L2/L3 transmitting first). But we see later, that writing the network-state (1,0,0) separately creates no harm since it converges to the desired states eventually. In the case of network-states (0,1,0) and (0,0,1), there is an incomplete transition, and L1 can transmit in both the states, resulting in new states (1,1,0) and (1,0,1), respectively. Whereas, in the network-state (1,0,0), two events can occur, L2/L3 starting transmission. The network-state (1,0,0) converges to the states (1,1,0) and (1,0,1) depending on L2/L3 transmits first, respectively. We see in the later sections, that considering transient states are important in probability computation. The probability of a network-state is computed by summing up the probabilities it gained in each event (or path) (previous state probability * path probability). From the LTD, the probability of the network-states (1,1,0) and (1,0,1) can be determined to be 
 
 (
 
 
 
); this seems logical since L1 is independent, and among L2/L3, they each transmit with the probability 
 
. The network-states (1,1,0) and (1,0,1) are similar to Case-1 (Fig. 3a) and Case-2 (Fig. 3b), respectively.

When the LTE-U/NR-U node is actively transmitting, it exhausts its 
, and eventually, move from the state transmitting to completed transmission; this results in a network-state change. Therefore, the upper limit on the time, the LTE-U/NR-U network spends in a state is the minimum of the remaining 
 of actively transmitting LTE-U/NR-U nodes. After a series of such network-state transitions, the LTE-U/NR-U network reaches the state (2,2,2). At this point, all LTE-U/NR-U nodes completed their transmission, and they all be mute until the next 
. The Wi-Fi network utilizes the remaining time.

From the LTD, we are successful in formulating the LTE-U/NR-U network-states, their probabilities, and the time for which they occur. The LTE-U/NR-U throughput computation is straightforward because of its simple channel access mechanism; 
 gives the LTE-U/NR-U node throughput. Whereas, for the Wi-Fi throughput, we need to determine the throughputs of individual Wi-Fi contention graphs. To do that, we make use of existing Wi-Fi–Wi-Fi spatial throughput models. Having the probability of Wi-Fi contention graphs (network-state probability), the time for which they occur (network-state time), and the throughput of each Wi-Fi contention graph, the overall Wi-Fi network throughput is computed as; .

This concludes our discussion about the example-network, Fig. 1a. The definition of the LTE-U/NR-U network-state is not complete in the above discussion. The remaining 
 should be specified along with the transmission-status to define the LTE-U/NR-U node state wholly, e.g., (0,1 ms), (1,5 ms) and (2,0 ms). Two network-states with the same set of LTE-U/NR-U nodes transmission-status, and different remaining 
 might have different transitions. So the LTE-U/NR-U network-state is complete when the remaining 
 is included, e.g., {(1,3 ms), (0,4 ms), (1,4 ms)}. The important implication of the inclusion of transmission times is that the network-states are continuous, and after every  time, the LTE-U/NR-U network changes its state. In the next sections, we formally define LTE-U/NR-U network-states, LTD, and generalize the throughput modeling.

5. LTE-U/NR-U network-state transition model
Based on the system model described in Section 3, and the observations made in Section 4, we now present a generalized way to formulate LTE-U/NR-U Network State Transition Diagram. The notations used in the analytical model are summarized in Table 1. The LTE-U/NR-U Network-state Transition model (LNT) models the behavior of LTE-U/NR-U nodes in the network. Using the LNT model, we formulate the LTE-U/NR-U network-states and their probabilities, which are critical in the throughput computations.


Table 1. Notation used for LTE-U/NR-U and Wi-Fi modeling.

Notation	Definition
Number of LTE-U/NR-U nodes in the network.
Number of Wi-Fi nodes in the network.
LTE-U/NR-U ON  LTE-U/NR-U OFF time (same for all LTE-U/NR-U nodes in the network).
Set of all feasible and occurring LTE-U/NR-U network-states for a given network topology
th LTE-U/NR-U network-state in set 
.
The state of th LTE-U/NR-U node is network-state 
The transmission-status of th LTE-U/NR-U node in network-state 
, 
 .
The left over transmission time of th LTE-U/NR-U node in network-state 
.
The probability of state 
 at any time .
Denotes the set of paths to reach network-state 
.
The probability of path 
.
The number of network-state transitions or exit paths from network-state 
.
About to Transmit LTE-U/NR-U network-event.
About to Compete LTE-U/NR-U network-event.
Continuous Count Down LTE-U/NR-U network-event.
Throughput of LTE-U/NR-U network.
Wi-Fi Contention Graph in LTE-U/NR-U network-state 
.
Represents the set of LTE-U/NR-U nodes in the EDT region of Wi-Fi/LTE-U/NR-U node 
.
Represents the set of Wi-Fi nodes in the CST region of Wi-Fi node 
.
Denotes the BoE throughput estimation of Wi-Fi network graph 
.
Throughput of Wi-Fi network.
Air time fraction of Wi-Fi node 
.
Air time fraction of LTE-U/NR-U node 
.
5.1. Notations and definitions
Let 
 be the number of LTE-U/NR-U eNBs in the network and 
 be the set which describes the LTE-U/NR-U network-state, 
. 
 is an ordered pair that denotes the state of th LTE-U/NR-U node (
) in the LTE-U/NR-U network-state 
; 
. 
 of 
, denotes the transmission-status of 
 in the LTE-U/NR-U network-state 
. 
 can take values from {0, 1, 2}, and they mean, yet to transmit, transmitting, and completed transmission, respectively. 
 is the left over transmission time of LTE-U/NR-U node 
 in the LTE-U/NR-U network-state 
. 
 decreases at a rate of 
 if the node is actively transmitting (
), and 
 for the nodes with 
. One of the key parameters that we need to determine is the probability of LTE-U/NR-U network-state, the probability of LTE-U/NR-U network-state 
 at any time t is given as 
. Finally, we formulate 
 on the fly, when constructing LTD; It denotes the set of all LTE-U/NR-U network-states that occur for a given Wi-Fi–LTE-U/NR-U network. 

Fig. 6 represents the LTE-U/NR-U network-state Transition Diagram (LTD) of any Wi-Fi–LTE-U/NR-U network. The -axis represents the time. And, the different LTE-U/NR-U network-states occur at different points in time, e.g., 
 occurs at ϒ
. The dotted line (path) connecting two network-states represents a network-state transition. In Fig. 6, 
 represents one such path, whose probability is given by 
. The set of all paths which lead to the network-state 
 is called path set, and is denoted by 
. As discussed in the earlier sections, several events can occur in a LTE-U/NR-U network-state, giving rise to multiple state transitions (exit paths). In Fig. 6 for network-state 
, a total of 
 events are possible. In each 
, the LTE-U/NR-U network starts at 
 where all LTE-U/NR-U nodes transmission-status is 0, and through a series of transitions, it ends at 
 where all LTE-U/NR-U nodes transmission-status is 2. The Wi-Fi network utilizes the remaining air time after the LTE-U/NR-U network reaches 
. We now identify four categories of LTE-U/NR-U network-states namely, 
, 
, stable states and transient states. 
 and 
 are defined earlier, we define the stable and transient states next.

Stable states: The stable states are those in which there is no immediate change in the transmission-status of any LTE-U/NR-U node. As time passes, the LTE-U/NR-U network continuously moves from one network-state to another. But it is not necessary that the LTE-U/NR-U node’s transmission-status changes in every network-state transition. Since there is no transmission-status change in a stable state, there is only one possible event (exit path), i.e., the 
 counts for actively transmitting LTE-U/NR-U nodes. For a set of stable states with a similar LTE-U/NR-U nodes transmission-statuses, the Wi-Fi contention graph is the same, and the corresponding Wi-Fi throughput computations are also the same; this helps us saving substantial computation.

Transient states: The LTE-U/NR-U network-states in which there is a possibility for at least one transmission-status change in the next  time are termed as transient states. The LTE-U/NR-U network experiences transmission-status change when an actively transmitting LTE-U/NR-U node exhausts its 
 (1 - 2), or when there is an opportunity for an LTE-U/NR-U node to begin its transmission (0 - 1). The transient states will not occur for a longer duration because of incomplete transition; they quickly move to the next possible stable states. So, we do not need to perform any Wi-Fi throughput computations corresponding to the transient states.

The importance of transient states in determining the network-state probability can be quickly realized by considering a few examples. Let us consider a 3-node network as shown in Fig. 5, where all nodes are LTE-U/NR-U. L2 is in the EDT range of L1 and L3, and L1 and L3 are outside the EDT range of each other. Two events (L1/L3 transmits first) lead to the network-state (1,0,1), and one event (L2 transmits first) lead to the network-state (0,1,0), so 
 
 probability for the prior, and 
 
 probability for the later network-state. This can be established by writing transient states. For our 3-node network, the possible states after the first transition are (1,0,0), (0,1,0), and (0,0,1). Two transient states ((1,0,0) and (0,0,1)) lead to the stable state (1,0,1), and the other is already a stable state (0,1,0); the results are similar to what we deduced earlier. On the other hand, only considering the stable states ((1,0,1) and (0,1,0)) will not give a similar results.


Fig. 5. 3-node LTE-U/NR-U network.

5.2. LTE-U/NR-U network-state probability
Let us consider a general LTE-U/NR-U network-state 
 as shown in Fig. 6. In Fig. 6, a set of events prior to the time ϒ
 lead to network-state 
. As defined earlier these event (or path) set is denoted by . Each path 
 is associated with the source state 
 of probability 
ϒ
, and the path probability 
. The path probability (
) is related to the number exits paths (
) by LTE-U/NR-U operation mechanism (Section 3.1.2). The LTE-U/NR-U operation mechanism we considered in this work, dictates that all events in a state are equiprobable to occur; 
 
. Now, the probability of network-state 
 at time ϒ
 (
ϒ
) is computed by summing up the probabilities of all events. (1)
ϒ
ϒ

5.3. LTE-U/NR-U Network-Events
Though Section 5.2 gives the network-state probability equations, terms like path set (), and 
 are not well established. Both the terms are related to network-state transitions or LTE-U/NR-U Network-Events.  is created by identifying the states at time ϒ
, which undergoes an LTE-U/NR-U network-event, and converge to state 
. We identify three types of LTE-U/NR-U Network-Events that are responsible for the network-state transitions; About To Transmit (AT), About To Complete (AC), and Continuous Countdown (CCD), which are explained as follows.

AT event: As the name suggests, AT event involves LTE-U/NR-U network-states with at least one LTE-U/NR-U node which is about to transmit (0  1). From the definition itself, we can sense the transmission-status change; therefore, AT events occur in transient states. When looking for the network-states that contribute to state 
 probability at time  through the AT event, we need to identify such states at time  that undergo the AT event and converge to state 
 after time  (they may or may not exist). Instead of writing down all the states and identifying the desired ones, we trace-back the possible states from state 
 that support our cause as follows.

Let  denote the set of LTE-U/NR-U nodes that are actively transmitting in the state 
; 
. We define an operator 
, that sets the transmission-status of LTE-U/NR-U node 
 to 0 when operated on state 
 (
). We expect that the trace-backed state 
 exists at time  and it contributes to our cause. The state 
 is transient in nature, and its general characteristic is to have multiple equiprobable exit paths. We denote the number of exit paths for state 
 by 
. Now the AT event probability for state 
 at time  is computed by summing up the probabilities gained from all trace-backed states. (2)
 
AC event: The AC event occurs in the network-state, which has at least one LTE-U/NR-U node that is about to complete its transmission. Similar to the AT event, the AC event also deals with the transient states. The probability computations related to the AC event can be realized on the same basis as that of the AT event. We trace-back the desired states as follows.

Let  denote the set of LTE-U/NR-U nodes that have completed their transmissions in the state 
; 
. We define an operator 
, that sets the transmission-status of LTE-U/NR-U node 
 to 1 when operated on state 
 (
). The transient state 
 is expected to undergo AC event at time  and converge to state 
 at time . The number of exit paths from transient state 
 is denoted by 
. Then the probability contribution of AC event for state 
 at time  is derived by summing up the probabilities gained from all trace-backed states. (3)
 
CCD event: In the LTE-U/NR-U network-states that undergo CCD events, the actively transmitting LTE-U/NR-U nodes continuously countdown their 
. Unlike the two previously described events, CCD events occur in stable states since there is no transmission-status change. Our approach in determining the desired states for CCD events should be in such a way that the states considered should undergo a CCD event at time  and converge to state 
 at time . We follow a similar trace-back approach, as followed for the previous events, to obtain the desired states from state 
.

Let  denote the set of LTE-U/NR-U nodes that are actively transmitting in the state 
; 
. We define an operator 
, that when operated on state 
 (
), increases the remaining 
 (
) for each 
 by . The 
 node’s state in the network-state 
 and in the network-state 
 can be related as; 
. If state 
 is valid and exists at time  then it undergoes CCD event and enters state 
. The parameter 
 since there exists only one exit path from the stable states (Section 5.1). Now the probability contribution of CCD Event for state 
 at time t is given as; (4)

5.4. Network-state probability in terms of network-events
For any network-state 
, the probability is computed by summing up the probabilities of all the three events; 
. The probability contribution of each of the three LTE-U/NR-U network-events for state 
 is not necessarily non zero. (5)
 
 

The Eq. (5) is very similar to the Eq. (1). In Eq. (5), we represent the path set  of Eq. (1) in terms of LTE-U/NR-U network-events. Eq. (5) involves recursive computations; The probability of network-state 
 is represented in terms of previous state probabilities, and similar calculations are required for determining the previous state probabilities, and this goes on.

5.5. Estimation of LTE-U/NR-U node’s transmission-status
We can formulate an equation to estimate the transmission-status of an LTE-U/NR-U node at any moment . This equation is used for the model validation (Section 7) rather than for the throughput computations. At any time , the transmission-status of LTE-U/NR-U node 
 can be one among {0,1,2}. Therefore 
, where 
 represents the probability of node 
 to have the transmission-status . Let 
 denote the set of LTE-U/NR-U network-states that occur at time t, with the node 
 having the transmission-status  (we are in a position to derive them). Then the expression for 
 is given as; (6)

6. Wi-Fi LTE-U network throughput estimation
In Section 5, we derived LTE-U network-states and their probabilities using LTD. In this section, we use that knowledge for estimating the throughput of Wi-Fi and LTE-U.

6.1. Wi-Fi throughput estimation
As discussed in Section 4.1.1, the Wi-Fi contention graph changes for each LTE-U/NR-U network-state. The Wi-Fi throughput needs to be modeled for each contention graph separately. We can choose an existing Wi-Fi–Wi-Fi spatially distributed network model from the literature and compute the Wi-Fi contention graph throughput. In this paper, we go with Back-of-the-Envelop (BoE) (Liew et al., 2010) throughput estimation technique to compute contention graphs throughputs.

6.1.1. Deriving the Wi-Fi Contention Graph
In a particular LTE-U/NR-U network-state, due to the ongoing LTE-U/NR-U transmissions, some of the Wi-Fi nodes sense the channel busy. So only a part of the Wi-Fi network actively participates in the transmission; we call it Wi-Fi Contention Graph. The Wi-Fi contention graph is derived as follows. Let 
 denote the number of Wi-Fi nodes in the Wi-Fi–LTE-U/NR-U network. We define a function 
, that gives the status of Wi-Fi node 
 in the LTE-U/NR-U network-state 
.  assigns a value of  if any LTE-U/NR-U node in the EDT range of 
 is actively transmitting; otherwise, it assigns . This is represented in equations as; (7)
 The Wi-Fi contention graph in LTE-U/NR-U network-state 
, denoted by 
, includes all Wi-Fi nodes whose  value is 1. This is represented as; (8)

6.1.2. BoE model
In this section, we adopt few BOE (Liew et al., 2010) definitions and equations in the context of our model.

Independent states: The Independent states (
) is a set of Wi-Fi network-states, which are in accordance with the CSMA/CA protocol; If a Wi-Fi node is actively transmitting, no other Wi-Fi nodes in its CST range should be transmitting (BoE model relaxes Wi-Fi–Wi-Fi collisions). All network-states following this rule are included in the Independent states set. We put this mathematically as follows.

Let 
 denote the th valid Wi-Fi network-state of the Wi-Fi contention graph 
. Each Wi-Fi node in the contention graph 
 has an entry in the 
, which can be either  or . If a Wi-Fi node is actively transmitting, we enter  for that node, and if it is not transmitting because of ongoing Wi-Fi transmissions in its CST range, we enter . The general equation for a valid Wi-Fi network-state for the contention graph 
 is given as; 
 (9)
 Now the Independent States set is constructed by identifying all the possible valid Wi-Fi network-states. 
Maximum Independent States: Among the Independent States, the Wi-Fi network-states in which the maximum number of Wi-Fi nodes are simultaneously transmitting are included in the Maximum Independent States (
) set. This is expressed mathematically as; (10)
 BoE throughput computation: BoE model (Liew et al., 2010) says that the system spends most of its time in the MIS states and very little time in other states, and all the MIS states occur with equal probability. So, the normalized Wi-Fi network throughput is computed by averaging the MIS states. The BoE model computes the actual Wi-Fi throughput by multiplying the normalized Wi-Fi throughput with the data rate at which one Wi-Fi node transmits (
); 
 is derived from the Bianchi Model (Bianchi, 2000). Let 
 denote the throughput of Wi-Fi contention graph 
, then the 
 is given as; (11)
 

6.1.3. Wi-Fi network throughput computation
Eq. (11) gives the BoE throughput estimation of the Wi-Fi contention graph 
. But the throughput of the remaining nodes which are excluded from the Wi-Fi contention graph is zero in that network-state 
. So we define a function 
 which gives the throughput of all Wi-Fi nodes in the network-state 
. 
 is given as 
 (12)
 After having all the feasible LTE-U/NR-U network-states (
), the Wi-Fi network throughput in each network-state (Eq. (12)), the network-state probability (Eq. (5)), and the time of each network-state (), the overall Wi-Fi network throughput denoted by 
 is computed by summing all the individual Wi-Fi contention graphs throughputs. (13)
 

6.2. LTE-U/NR-U throughput estimation
The LTE-U/NR-U node throughput modeling is straight forward. Unlike Wi-Fi, LTE-U/NR-U does not follow any backoff mechanisms; It transmits for 
 duration in the 
 with its basic PHY rate. The LTE-U/NR-U–LTE-U/NR-U collisions are avoided by considering the coordination among LTE-U/NR-U nodes through the X2 interface.

The critical parameter in determining the LTE-U/NR-U node throughput is 
. The LTE-U/NR-U locally determines its 
 based on the load it senses in the channel. Many enhanced CSAT schemes are proposed to coexist with Wi-Fi fairly. So, in each scheme, the LTE-U/NR-U derives its 
 as per the LTE-U/NR-U protocol it follows. We define a function  that computes the 
 of LTE-U/NR-U. In this work, we followed the standard LTE-U/NR-U operation mechanism, as described in Section 3.1.2. So, we derive the 
 of LTE-U/NR-U node 
, denoted by 
, as follows; (14)
 

The  in the denominator of the Eq. (14) is to include itself in the 
 computation. The other parameter that determines the throughput besides the 
 is the rate at which the LTE-U/NR-U node is transmitting; We denote it by 
. Now the equation for the throughput of node 
, denoted by 
 is given by; (15)
 

6.3. Air Time Fraction
We define a metric Air Time Fraction (), which is used to estimate the channel access time of each node in the spatially distributed Wi-Fi–LTE-U/NR-U network. We define the air time fraction for both Wi-Fi and LTE-U/NR-U nodes as follows.

LTE-U/NR-U Air Time Fraction: The LTE-U/NR-U node’s air time fraction is straightforward; the time for which the LTE-U/NR-U node access the channel is given by its 
 (
). Therefore the 
 node’s air time fraction denoted by 
 is given as; (16)
 
Wi-Fi Air Time Fraction: When computing Air Time Fraction of a Wi-Fi node, we must consider the times for both successful and collision events since Wi-Fi gets channel access in both the events. We compute the air time fraction on the same grounds as throughput computations. The Wi-Fi network air time fraction in the LTE-U/NR-U network-state 
 is denoted by 
. 
 is zero for the Wi-Fi nodes which are excluded from the Wi-Fi contention graph (
). But for the nodes in the contention graph, 
 is computed by multiplying the average of MIS states with the air time fraction that one Wi-Fi node would get (
); 
 is computed from Bianchi Model (Bianchi, 2000). Then the overall Air Time Fraction is computed by summing up all the air time fractions in each LTE-U/NR-U network-state. (17)
 


Table 2. Comparison of experiment (Exp), analytical (Ana) and simulation (Sim) based on throughputs (in Mbps) of Wi-Fi–LTE-U/NR-U networks for experiment Topologies 1–5.

Node index	Exp. Topology #1	Exp. Topology #2	Exp. Topology #3	Exp. Topology #4	Exp. Topology #5
Exp	Ana	Sim	Exp	Ana	Sim	Exp	Ana	Sim	Exp	Ana	Sim	Exp	Ana	Sim
W1	12.63	14.83	14.3	63.37	74.15	69.25	34.28	37.07	36.56	38.27	43.25	39.56	54.18	61.79	60.88
W2	11.93	14.83	14.43	2.73	0	4.43	–	–	–	11.16	12.35	15.77	10.12	12.35	12.71
W3	12.17	14.83	14.79	62.18	74.15	69.32	–	–	–	42.71	49.43	45.56	45.24	49.43	46.47
L1	15.21	18.64	18.51	–	–	–	40.17	46.62	46.37	20.93	23.31	22.95	27.1	31.08	30.72
L2	15.92	18.64	18.51	–	–	–	41.48	46.62	46.37	26.37	31.08	30.79	26.52	31.08	30.99
7. Performance evaluation
To validate the proposed model and study the coexistence between Wi-Fi and LTE-U, we developed a system-level simulator for Wi-Fi-LTE-U spatial networks using MATLAB. It is a discrete event simulation with a fixed-increment time progression approach with microsecond granularity. In the system-level simulation, we represent the practical systems through software and try to adapt as much detail as possible for each part of the system to keep the simulations close to practical experiments. Our Wi-Fi-LTE-U system-level simulator captures a wide range of phenomenons that occur in Wi-Fi-LTE-U spatial networks. Some of the critical phenomena include Wi-Fi CSMA contention mechanism, LTE-U duty cycle estimation, Wi-Fi-Wi-Fi collisions, Wi-Fi-LTE-U collisions, and the influence Wi-Fi, LTE-U have on each other. LTE-U-LTE-U collisions are relaxed as per the system model described in Section 3.1.3. Since the Wi-Fi models (Liew et al., 2010, Bianchi, 2000) we used do not model the rate control, and to have a fair comparison between simulation and analysis, rate control is left out in the simulation. But we would like to emphasize that the LTE-U/NR-U Network State Transition Diagram, Wi-Fi contention graphs, and Network State Probabilities that we derive are independent of the transmission after-effects like rate control.

We first validate our MATLAB simulator with the mathematical models of Wi-Fi–Wi-Fi (Bianchi, 2000) and Wi-Fi–LTE-U (Jiang and Mao, 2017), where all nodes can sense the presence of all others. Further, the available model for Wi-Fi–Wi-Fi (Liew et al., 2010) in spatially distributed scenarios is also used to validate the MATLAB simulator. We then use the simulator to validate the proposed analytical model for spatially distributed Wi-Fi–LTE-U networks. The system parameters are shown in Table 3.


Fig. 7. NI experimental topologies.

Fig. 8. NI experiment Topology 4.

Fig. 9. Validation of simulator with the help of existing analytical models (Bianchi, 2000, Liew et al., 2010, Jiang and Mao, 2017).


Table 3. System parameters.

Simulation parameter	Value
16
1024
PHY header size	128 bits
MAC header size	272 bits
ACK size	112 bits
Number of MPDUs	4
Payload size	8148 bits
Slot time	9 μs
DIFS	34 μs
SIFS	16 μs
Max-retry limit	6
EDT value	−62 dBm
CST value	−82 dBm
Tx power of AP and eNB	20 dBm
Operating Freq.	5.3 GHz
System noise	−101 dBm
Wi-FiPHY rate	130 Mbps
Wi-FiACK rate	26 Mbps
Wi-FiHeader rates	6.5 Mbps
LTE-UPHY rate	93.24 Mbps
Traffic	Full buffer via saturated UDP flows
Channel	No shadow/Rayleigh fading
Path loss model (3GPP, 2010)	36.7log10(d [m])22.726log10
(freq [GHz])
40 ms
Duty cycle of th LTE-U node	min(0.95, 1/(1Number of nodes inside EDT of th LTE-U node))
Simulation time	60 s
Experimental parameter	Value
Wi-Fi PHY mode	VHT
Wi-Fi operating mode	IEEE 802.11 ac
Number of Wi-Fi streams	2
VHT PHY rate	130 Mbps
Modulation coding scheme	7 (i.e., 64 QAM)
Coding rate	5/6
Wi-Fi ACK rate	6, 12, 26 Mbps
RF transmission (SDR)	Loop back
LTE-UPDCCH symbol	1
LTE-UPHY rate	92 Mbps
Wi-Fi & LTE-UData traffic	Full buffer
Wi-Fi & LTE-UTransmission power	20 dBm
Wi-Fi & LTE-UBandwidth	20 MHz
Wi-Fi & LTE-UOperating channel	159

Table 4. Comparison of analytical (Ana) and simulation (Sim) based on throughputs (in Mbps) of Wi-Fi–LTE-U networks for Topologies 1–3.

Node index	Topology #1	Topology #2	Topology #3
–	Ana	Sim	Error (%)	Ana	Sim	Error (%)	Ana	Sim	Error (%)
W1	31.51	31.31	0.63%	34.60	33.25	3.90%	55.61	55.13	0.87%
W2	35.22	35.24	0.05%	51.25	50.52	1.44%	30.89	31.38	1.56%
W3	42.02	41.28	1.79%	6.83	7.25	5.79%	24.71	24.09	2.57%
W4	48.20	47.23	2.05%	59.32	58.44	1.50%	–	–	–
W5	33.37	32.93	1.33%	59.32	58.46	1.47%	–	–	–
L1	18.64	18.16	2.6%	23.31	23.20	0.47%	23.31	22.94	1.61%
L2	23.31	22.81	2.19%	23.31	22.91	1.74%	31.08	31.07	0.03%
L3	31.08	30.92	0.51%	23.31	23.17	0.60%	31.08	30.90	0.58%
L4	31.08	30.79	0.94%	18.64	18.22	2.30%	–	–	–
L5	31.08	30.92	0.51%	31.08	30.98	0.32%	–	–	–
7.1. NI experiment validation
The NI LTE-U Labview Application Framework provides functional elements of the Physical (PHY) layer as well as the Medium Access Control (MAC) layer. This platform allows wireless researchers to quickly set up real-time experiments using the LTE and Wi-Fi Application Frameworks. The NI LTE-U framework uses a duty cycled version of the LTE waveform to access the unlicensed channel. LTE-U has the flexibility to implement new algorithms for improving coexistence between LTE-U and Wi-Fi networks. The LTE-U base station listens actively to Wi-Fi and other LTE-U transmissions to estimate the network usage patterns. The online algorithm used by LTE-U that adapts the duty cycle is called CSAT. The duty cycle could be modified by changing the 
 and 
 values appropriately. The selected aspects of the LTE-U protocols and proposed modifications and improvements can be easily implemented and tested. The MAC is implemented on a Field Programmable Gate Array (FPGA) and tightly integrated with the PHY to fulfill the requirements.

Our experimental platform uses National Instruments USRP 2953 R software-defined radios (SDRs) [34]. The NI boards used in our set-up can be configured with two LTE-LTE-U NI eNBs. In our experiment, we used the NETGEAR Wi-Fi AP (Model R6100), which is also backward compatible with 802.11 a/b/g/n devices with dual-band support. In our real-time experiment, we set the Wi-Fi Very High Throughput (VHT) PHY rate to 130 Mbps (i.e., MCS 7 with the coding rate of 
 
), which is similar to the simulation.

As a benchmark comparison with analysis and simulation, we study five different scenarios where LTE-U and Wi-Fi APs are co-channel and contending to transmit full buffer downlink data. All the Wi-Fi AP and LTE-U nodes are configured on the channel 159 i.e., 5.79 GHz, which is the only clean available UNII-3 band channel for our experiment testing. The transmission power of LTE-U and Wi-Fi AP is 20 dBm, and most of the parameters are similar to Table 3. To ensure the EDT and CST in −62 dBm and −82 dBm, we used a Wireshark, NI application framework and spectrum analyzer tool to ensure that the deployed nodes are in the range of each other. In NETGEAR Wi-Fi we configured the 
 and 
 as 16 and 1024, respectively. The LTE-U duty cycle in the NI application framework is configured based on 
 
The hardware requirements consist of two computers which have at least 8 GB RAM (Installed Memory), 64-bit operating system, x64-based processor, Intel (R) Core i7, CPU clock 2.60 GHz. In this work, we study the impact of hidden node and spatially distributed node scenarios in LTE-U Wi-Fi coexistence.

For the coexistence of three Wi-Fi NETGEAR APs and two LTE-U, two of the SDRs are configured to operate as an LTE-U eNB as shown in Fig. 8, and the others are configured as a Wi-Fi AP as shown in Fig. 7. From the results, we observe good trends from the experiment, simulation, and analysis as shown in Table 2. This validates the proposed analytical model is well aligned with the implementation of the standards. Due to hardware and cost limitations, we cannot create a scenario for more LTE-U and Wi-Fi nodes. Hence, we proceed further with our findings with analysis and simulation.

7.2. Simulator validation
Fig. 9a shows the comparison of the Wi-Fi analysis presented in Bianchi (2000) and the Wi-Fi–LTE-U analysis presented in Jiang and Mao (2017) with our MATLAB simulator. Fig. 9a shows the throughput with respect to the number of stations in the network. Fig. 9b shows the normalized throughput comparison between BoE model (Liew et al., 2010) and simulation results. The percentage error in the throughput computation of Wi-Fi–Wi-Fi network (within CST range) is 1.91% and in the Wi-Fi–LTE-U network (within EDT Range) is 1.92%. In Fig. 9b, normalized throughput of each node is shown for a 20-nodes topology. The mean normalized link/node throughput error (metric defined by BoE Liew et al., 2010) in the Wi-Fi–Wi-Fi spatially distributed network is observed to be 2% for 20-node topology. It is clear from the values that the existing models and our simulator are closely matching; this proves the accuracy of the simulator. We use this simulator to validate our proposed analytical model in two phases: (1) Testing against some specific topologies (further used for analysis). (2) Testing against random topologies.

7.3. Validation of the proposed model in specific topologies
In this section, we validate our analytical model for three specific topologies, which are shown in Fig. 10. The number of nodes are 10, 10, and 6 in topology 1, 2, and 3, respectively. In each topology, we have 50% LTE-U and 50% Wi-Fi nodes. Table 4 shows the comparison of simulated and analytical throughputs of each node (Wi-Fi and LTE-U) in all three topologies. Fig. 11 shows the air time fraction estimation for all three topologies. In Fig. 11, the node index is marked on -axis (/) and its air time fraction on -axis. From Table 4 and Fig. 11, it is clear that the analytical and simulation results are close, thereby validating the proposed model.

7.4. Validation of the proposed model in random topologies
In the second phase of the validation, we test our model against randomly generated network topologies. Fig. 12a shows one such randomly generated topology, which consists of 10 Wi-Fi and 10 LTE-U nodes in the area of 100 m × 100 m. Fig. 12b shows the analytical and simulation throughputs for each node of Fig. 12a, and there is a close match between analytical and simulated results.

As presenting the individual throughputs for multiple and higher node count scenarios is difficult, we compute Node Mean Throughput (NMT) error. NMT error gives the mean of the percentage deviation of analytical results from simulation results. We compute the NMT error in two different cases. In Table 5, we present the performance of the model in high-density scenarios by varying the node-count from 10 to 80 in an area of 100 m × 100 m. In Table 6, we validate our model in low-density scenarios by varying the node-count from 10 to 40 in an area of 200 m × 200 m. In Table 5, Table 6, for each node-count, we compute the NMT error associated with Wi-Fi, LTE-U, and system throughput. The NMT errors in high-density and low-density scenarios are found to be quite low for the considered topologies. The BoE model we adopted is computationally expensive. So, the model we proposed is realizable for practical node-count topologies. The complexity grows exponentially with the increasing node-count.

From Table 5, Table 6, we can observe that the NMT error of LTE-U is less compared to Wi-Fi. This is because we can model the LTE-U throughput with greater accuracy due to its simple channel access mechanism. The minimal perceived error is due to Wi-Fi–LTE-U collisions that are not taken care of in the modeling (X2 interface rules out LTE-U–LTE-U collisions). We see later how increasing 
 makes those Wi-Fi–LTE-U collisions less frequent. For Wi-Fi–Wi-Fi collisions, we can always choose a better Wi-Fi–Wi-Fi spatially distributed model to include those collisions. However, the approach considered by the BoE model, which was followed in this work, does not model those collisions.

Fig. 12. One of the randomly generated topologies and the corresponding throughput result of each node obtained through simulation and analytical studies.


Table 5. NMT error in high-density scenario.

# Nodes	10-node	20-node	30-node	40-node	50-node	60-node	70-node	80-node
1.92%	3.23%	4.25%	4.49%	4.92%	5.38%	5.52%	5.93%
0.02%	0.03%	0.04%	0.04%	0.05%	0.05%	0.05%	0.06%
0.97%	1.63%	2.14%	2.26%	2.48%	2.71%	2.78%	2.99%

Table 6. NMT Error in low-density scenario.

# Nodes	10-nodes	20-nodes	30-nodes	40-nodes
0.49%	0.95%	1.61%	2.27%
0.01%	0.01%	0.02%	0.02%
0.25%	0.48%	0.81%	1.14%

Fig. 13. Validation of simulation and analytical results of LTE-U state probability for Topology #2.

7.5. Prediction of LTE-U node’s transmission-status
Eq. (6) in Section 5 gives the probability of LTE-U node’s transmission-status at any moment in time. To prove our theoretical equation, we calculated the transmission-status probabilities using the analytical model and validated them using simulation results, for Topology #2 of Fig. 10. In Fig. 13, transmission-status probability (
, 
 and 
) of each node is shown against time 0  
. Our model estimated the transmission-status of LTE-U nodes accurately.

7.6. Coexistence study
After validating the proposed analytical model, we used the model to perform a coexistence study between Wi-Fi and LTE-U nodes. The motivation behind the coexistence study is to check whether LTE-U is fairly coexisting with Wi-Fi or not. According to the 3GPP definition of fairness, LTE design in unlicensed bands should be in such a way that it should not impact Wi-Fi more than another Wi-Fi network on the same unlicensed channel (3GPP, 2015). Thus, the coexistence study is performed by replacing LTE-U nodes with Wi-Fi nodes and studying network behavior in Wi-Fi–LTE-U (WL) and Wi-Fi–Wi-Fi (WW) scenarios. We performed coexistence studies over a thousand randomly generated 20-node topologies. In the WL scenario, 50% of nodes are Wi-Fi APs (10 nodes), and the rest are LTE-U eNBs (10 nodes). For the WW scenario, LTE-U nodes are replaced with Wi-Fi nodes. One of the topologies from thousand topologies is shown in Fig. 14. Table 7 shows the throughput performance of Wi-Fi nodes in the presence of LTE-U nodes (i.e., WL scenario), and in the presence of Wi-Fi by replacing the LTE-U nodes (i.e., WW scenario).


Table 7. Comparison of WW and WL throughputs (Mbps) in LTE-U and Wi-Fi coexistence study.

Node index	Fig. 14 Topology
–	WL	WW
W1	37.08	37.08
W2	37.08	74.16
W3	74.16	0
W4	49.44	0
W5	74.16	74.16
W6	24.72	0
W7	37.08	0
W8	18.54	0
W9	55.62	74.16
W10	37.08	37.07

Fig. 14. Wi-Fi–LTE-U and Wi-Fi–Wi-Fi contention graphs for one of the randomly generated topologies.

In Table 7, we can see that the throughput performance of Wi-Fi in the WL scenario is better compared to the WW scenario. The reasons behind the throughput decrement of Wi-Fi in the WW scenario are dense contention graph in the WW scenario (shown in Figs. 14a and 14b) and the poor performance of CSMA/CA protocol in spatial distributed topologies (hidden terminal problems). In contrast, the LTE-U gives up the channel allowing the neighboring nodes to transmit. In the WW scenario, our model has nothing much to do; we derive throughputs directly from the BoE model. The following lines are taken from the BoE model (Liew et al., 2010): “The system spends most of its time in MIS, and very little time in other states”. (Section 6.1). Those lines from the BoE model mean, more nodes transmit if the nodes with zero throughputs do not transmit. This can also be put-forth as the nodes with zero throughputs are under the continuous influence of other Wi-Fi nodes transmissions, giving them minimal access to the channel. The exact zero throughputs in the WW scenario of Table 7 are the implications of using the BoE model, but when performed simulations, we observed values close to zero. So, we conclude that, though Wi-Fi–LTE-U lacks the coordination to reduce collisions, LTE-U fairly shares the air time with Wi-Fi.

Finally, in Fig. 15, we have shown the CDF of normalized throughputs of Wi-Fi and LTE-U nodes computed over a thousand randomly generated 20-node topologies in both WL and WW scenarios. The normalized throughput is chosen for comparison since Wi-Fi and LTE-U have different PHY rates (System Parameters, Table 3). The CDF is for a 50% fixed set of Wi-Fi nodes (shown as 
) in WW and WL scenarios. Further, we also plotted CDF for the leftover Wi-Fi in WW scenario (shown as ) and for LTE-U in WL scenario (shown as ). It is clear from Fig. 15 that the throughput of Wi-Fi nodes has improved in the WL scenario compared to the WW scenario. This proves that LTE-U is fair with Wi-Fi in terms of throughput according to the 3GPP definition of fairness. Also, the throughput of leftover Wi-Fi (W) in the WW scenario is less compared to leftover LTE-U (L) in the WL scenario. Thus, not only is LTE-U a better neighbor to Wi-Fi, but it is also better for overall system throughput improvement.

8. Conclusions and future work
In this paper, we proposed a new analytical model to estimate the throughput of spatially distributed Wi-Fi–LTE-U/NR-U networks. We used the model to study the coexistence of Wi-Fi–LTE-U/NR-U networks in spatially distributed topologies downlink-prevalent traffic. The model is based on the probabilistic approach of LTE-U nodes state transitions, which affect the behavior of Wi-Fi nodes. The LTE-U has a significant influence on the throughputs of Wi-Fi nodes. Our model defines the relationship between the Wi-Fi network and the LTE-U network. The model is validated with extensive simulation studies. Further, we have used the model to analyze the performance of Wi-Fi in Wi-Fi–LTE-U and Wi-Fi–Wi-Fi networks. From the coexistence study, considering downlink traffic, we found that in spatially distributed configurations, Wi-Fi’s performance is better in Wi-Fi–LTE-U scenarios than in Wi-Fi–Wi-Fi scenarios. Hence, we believe that our proposed analytical model on LTE-U and Wi-Fi is well adopted in the future NR-U and Wi-Fi coexistence. The lessons learned from 5 GHz i.e., LTE-U Wi-Fi coexistence should inform the development of new standards for 6 GHz i.e., NR-U Wi-Fi, which is greenfield for all players: Wi-Fi, cellular and potential new entrants. There is an opportunity to reevaluate and design all specifications to naturally coexist with any dissimilar system that may coexist in the same spectrum. Also, in future we plan to study the Multi-channel Wi-Fi (i.e., 40 or 80 MHz) with different energy detection thresholds at Wi-Fi primary and secondary carrier and carrier aggregation at LTE-U with different scenario schemes which creates a new coexistence scenario which has not been studied.