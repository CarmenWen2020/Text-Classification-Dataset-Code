Several technological solutions have emerged over the last several months to support proximity contact tracing to fight the COVID-19 pandemic. For this reason, today more than ever, accurate signal location is needed, even in indoor public areas (supermarkets, public transport, etc.). In a previous work, we proposed five methods to solve the problem of signal localization using elements of pole-polar geometry. The proposals were innovative, since they solved a geometric problem (locating a point in a coordinate system) only by applying concepts of geometry. Among these developed methods, the PPC (Pole-Polar Centroid model) was also presented. Although the PPC solves the problem of locating a device with better precision than conventional methods (based on numerical or optimization methods), its accuracy was found to be the worst among the five proposed geometric methods. In this context, this work proposes an extension to our PPC method, called the weighted Pole-Polar Centroid method (wPPC), which improves the accuracy of the previous PPC results. Such an extension does not change the complexity O(m2) or the minimum dimensionality (m = 2) of nodes, which integrate a location network to perform the triangulation of such signals. Moreover, this extension estimates a device's location coordinates by means of the interaction, via signals, of this device with the network nodes distributed in any coordinate system. An IEEE 802.11 network infrastructure is used to accomplish the experiments. Errors in signal data are common, and our new proposed method, the wPPC, can mitigate the influence of these errors, produce more accurate results than the PPC, and outperform some of the other four proposed geometric methods and current numeric methods. Despite the use of an IEEE 802.11 network infrastructure for testing here, this range-based method for signal triangulation can be applied to any signal type (such as Wi-Fi, Bluetooth, and light and sound propagation).

Keywords
2D signal location
Wireless network
Method
Signal processing
Computational geometry
Pole-polar geometry
IEEE 802.11
Contact tracing

1. Introduction
The impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality is globally significant (Wang et al., 2020; Eubank et al., 2020). One of these NPIs is contact tracing, which has become an essential tool for helping public health and local communities to prevent virus spread (Cho et al., 2020), and its use is also recommended by the World Health Organization (onsiderations in the, 2020). Besides manual contact tracing, several technological initiatives have emerged in recent months based on mobile phone apps to track exposures after an infected individual is identified [3] (Klonowska et al., 2020)[eHealth Network Mobile ap, 2020], such as the Trace Together app (Singapore) (Ng et al., 2020), the Pan-European Privacy Preserving Proximity Tracing (PEPP-PT) (-Pan-European Priv), the New Zealand initiative (Rapid Audit of Contact Tr, 2020), and the Apple & Google partnership (Apple and Google partner, 2020). One of the distributed approaches is based on the smart device interaction using tokens and messages through wireless communication by proximity.

2.
Today, most people carry mobile phones that are connected through wireless communication technologies, such as Bluetooth or Wi-Fi (the IEEE 802.11 protocol family). One of the problems of using these interactions to keep track of contacts based on proximity is the possibility of communication or signal data errors, which cause the location of the device to achieve an accuracy that is lower than it should be (Ahvar et al., 2016; Gandotra et al., 2017; Pedhadiya et al., 2019; Yassinet al., 1327; Hassan et al., 2015; Lau et al., 2019).

3.
The present work proposes a new signal location method based on weighted pole-polar geometry that improves the estimation accuracy of signal location.

4.
The paper is structured in five sections. Section 2 describes the initial considerations from our previous work. Section 3 presents a new method called the weighted Pole-Polar Centroid (wPPC). Section 4 shows details experimental cases and their results. Section 5 presents the conclusions of this work.

2. Considerations and algorithm formalization from previous work
6.
Signal location estimation by range-based methods needs to solve a nonlinear system with m-many equations, if obtained the numbers of nodes of the location network. The solution of this system can be obtained by the linearization of these equations. The linearization process can be accomplished by subtracting equations. One equation of this system is chosen and is used to subtract all others from this system. Thus, the terms of all equations of degree two are eliminated, and the system becomes linear. However, the realization of this subtraction also eliminates from the system the equation chosen to perform this linearization. For example, if there were five equations before the linearization, after the linearization, there will be four equations in the system. It is important to consider that this equation that was eliminated contemplates data of the radial range of the signal acquired by a device of the location network system. Eliminating this equation means eliminating this device from the network, and its participation in the final result of the location of a point in space becomes indirect. The most complicated fact of performing the linearization of the equations system by the subtraction of its equations is the possibility of error propagation. Assume that the equation chosen to perform the linearization operation is that corresponding to the device that acquired the signal data with the highest error. By using this equation to subtract all other ones, such error is substantially propagated to the linearized equation system, damaging the accuracy of the solution.

7.
Based on these two problems that the linearization operation causes to the location system, (1) a device is eliminated from the location network, which reduces the redundancy of that network and compromises the ability to minimize errors in the result of the location estimate, and (2) the choice of an equation for this system to perform linearization by subtraction can substantially propagate the signal data errors contained in this chosen equation for the other equations, leading to the proposal of geometric solutions to the problem of 2D signal location (Montanha et al., 2019).

8.
The geometric solutions previously proposed have the following advantages over conventional methods: (1) there is no need to linearize the system of equations, (2) there is no need to remove a node from the location network, and (3) the complexity of geometric methods is of order O(m2) instead of order O(m3) of the conventional methods.

9.
Our previous work [17] proposed five geometric methods to estimate the location of sources emitting/receiving signals based on the signal range: (1) PPC, based on a centroid of a set of polar points; (2) CHC, based on a convex hull region defined by a set of interest points; (3) PLI, based on a centroid of a set of interest points obtained by polar line intersections; (4) TLI, based on a centroid of a set of interest points obtained by tangent lines intersections; and (5) MAI, based on a centroid of a set of interest points obtained by tangent line intersections with minimal angles.

10.
All of these methods have been shown to be capable of estimating a position in a coordinate system, by geometrically manipulating signal range data, with better precision than traditional methods such as Newton–Raphson (NRm) [17][S and Atkinson, 1990], Least-Squares (LSm) [17][19][Acharya, 2014], and Weighted Least-Squares (WLSm) [17][19][Tarrío et al., 2011], leading to the conclusion that the proposed geometric methods are able to handle errors in signal data more adequately.

11.
In this context, this work proposes an extension to the PPC method [17]: the weighted Pole-Polar Centroid model (wPPC) method. It provides the PPC with the ability to process signal data with errors and obtain better accuracy in location estimation, without changing the complexity O(m2) or the minimum dimensionality (m = 2) of nodes in the location network system required by the original PPC method.

12.
This paper does not address operations or methods related to signal data preprocessing. This means it is assumed that there are errors in the acquired data. Such errors are due to the signal multipath, the presence of obstacles, and the co-presence of other electromagnetic sources. Obviously, in order to guarantee the accuracy of location estimation, it is necessary to ensure accurate data.

13.
To analyze the results produced by wPPC, this work uses the same data provided by previous work [17]. Such data, not preprocessed, were acquired using the IEEE 802.11 network infrastructure in a system of radio signal emission and reception devices. Each device in this network allows one to extract the strength value of the emission/reception of a radio signal, supported by IEEE 802.11 by access to the Received Signal Strength Indicator (RSSI). These strength data allow for estimations of the radial distance (signal range) between the sending device and each receiving device (or vice versa). The respective computed radial distances allow for estimations of the location of a specific device in this network. Despite using an IEEE 802.11 network infrastructure for testing here, this range-based method for signal triangulation can be applied to any signal type (such as Wi-Fi, Bluetooth, and light and sound propagation).

2.1. Useful 2D geometric definitions
14.
This subsection describes some important geometric definitions for understanding the proposed geometric models PPC and wPPC. These definitions were listed and organized in the previous work (Montanha et al., 2019). Such definitions are labeled as, for example, (d-9), which means the 9th definition, and its uses are thus referenced in the text. Other definitions and further information in this regard are provided by WCIPEG (Woburn Collegiate Institu, 2018) and Gibson (2004).

2.1.1. Point and line
A coordinate P(x, y) define the point P in the Cartesian plane (
). The line that passes through the points P(x1, y1) and Q(x2, y2), P≠Q, is denoted as 
 
. The line segment 
 
 (with endpoints P and Q) is the portion of the line 
 
 between points P and Q.

(d-1) The Euclidean distance 
 
 between two points P(x1, y1) and Q(x2, y2) is given by
 

(d-2) For constants A, B, and C (A and B not both zero), all points (x,y) satisfying the equation Ax + By + C = 0 define the implicit line equation in the Cartesian plane. For two points P(x1, y1) and Q(x2,y2), a particular line equation is obtained by

(d-3) Two particular lines A1x + B1y + C1 = 0 and A2x + B2y + C2 = 0 have an intercept at the point (x+, y+) if d = A1B2 − A2B1≠0, given by
 
 

If A1A2+B1B2 = 0, the lines are perpendicular. If A1B2 = A2B1, the lines are parallel or coincident.

(d-4) The line equation Apx + Bpy + Cp = 0 that passes through point P(xp, yp) and is perpendicular to the line Ax + By + C = 0 is defined as

2.1.2. Circle
In the Cartesian plane, the equation (x-xc)2 + (y-yc)2 = r2 defines the implicit circle equation centered at the point C(xc, yc) with radius r. Let E(xe, ye) be an external point to a circle. By using E, we can obtain two tangent lines, t1 and t2, to the circle (Fig. 1a), which pass through points P(x1,y1)∗ and Q(x2,y2)∗, respectively. Points P and Q can be computed by applying the geometric concept of pole-polar definition.

Fig. 1
Download : Download high-res image (513KB)
Download : Download full-size image
Fig. 1. (a) Possible tangential straight lines t1 and t2 for the circle line obtained by an external point E(xe, ye) (pole point) (Montanha et al., 2019). Polar line p and its geometric relationship with the tangent lines and a given conic section (a circle in the case of this work). (b) A location system composed by two nodes and one device. Computation of the polar points (red dots) using as pole points (black dots) the respective centers of the signal range (blue lines). The green faced square is the exact emitter location computed by the PPC method in this coordinate system.

(d-5) The distance 
 
 between a point P(x1, y1) and a circle line centered at the point C(xc, yc) with radius r is given by
 
 
where 
 
 is the Euclidean distance between the point P(x1, y1) and the point C(xc, yc) computed by definition (d-1).

2.1.3. Pole-polar geometry
A pole point and polar line are, respectively, a point and a line that have a unique reciprocal relationship with respect to a given conic section. If the point lies on the conic section, its polar line is the tangent line to the conic section at that point (Wyk and O'Rourke, 1995). If the pole point is external to the conic section, the polar line intercepts the conic section exactly at the points that allow passing tangent lines from this pole point (Fig. 1a). Our interest is to pass two tangent lines, t1 and t2, through a circle centered at point C(xc, yc) with radius r. Moreover, these lines must pass through a known external point E(xe, ye) (or pole point) to this circle (Fig. 1a). We need to locate the coordinates of the polar points P(x1, y1)∗ and Q(x2, y2)∗, which define the polar line p and lie on the tangents lines t1 and t2. Additionally, we must find the equation of the polar line p(Ax + By + C = 0).

(d-6) The general equation of a conic in the Cartesian coordinate system is given by

We need the equation of the polar line p(Ax + By + C = 0) that can be obtained by a known pole point E(xe,ye). The required coefficients of the polar line p are given by

In this work, the expected conic section is a circle. For the circle case, the following simplifications are helpful: 
; 
; 
; 
; 
; 
.

The next step consists in placing points 
and 
, which are obtained by computing the intersection between the polar line  and the circle line (Fig. 1a). To compute the intersection of a line, , with a circle, 
, the following conditions must be considered using the parameter 
 
, which is the distance between the polar line  and the circle center point 
:

○ if 
, there is no intersection point;

○ if 
, the line is tangent to the circle and has one intersection point;

○ if 
, the line is secant to the circle and has two intersection points.

The algebraic solution for this intersection is an equation of degree two. Another way to solve this intersection is to apply some geometric relationships, as follows. To find the intersections points 
and 
, which are the polar points, we first have to drop a perpendicular line (by (d-4)) from the center 
 of the circle to the line . Let 
 (Fig. 1a, yellow dot) be the intersection point and 
 
 be the line that passes through  and  (Fig. 1a).

The equation of line  is known (by (d-6)). Thus, the equation of line 
 
 is 
 
. This way, the point 
 can be computed by intersection between  and 
 
 lines (by (d-3)).

 
 represents the Euclidean distance between points  and ; 
 
 refers to the distance between points  and ; 
 
 stands for the distance between points  and ; 
 
 
 (by (d-1)).

The triangles  and  are right-angled, so we prove that
 
 
and
 
 

(d-7) Therefore, 
 
 
 
; now, if we translate the point  by  units in both directions along line , the polar points  and  (Fig. 1a) are determined as follows:
 
 

If , there is a second point of tangency given by
 
 

(d-8) The location estimation of a device, 
, is based on a set  that contains  points, , which are collected in a defined Region Of Interest (ROI). This location is given by the centroid point among all points in , by
 
 

In this work, it is not necessary to define an ROI. All polar points are used for estimating a location point.

An arbitrary 2D coordinate Cartesian system used for positioning a location system composed by two nodes (receiver devices) is shown in Fig. 1b. This coordinate Cartesian system is arbitrary (no units are necessary). The black dots define the positions, previously defined, of the location network nodes. The blue circle lines represent the radial range of the signal, perceived at each node, emitted by a device that needs to be located by this network with two nodes. The red dots are the respective polar points, which were computed using the positions of the nodes (the centers of each circle) as pole points, applying the definition (d-7). By the definition (d-8) and the set  containing all (four in this case) the polar points computed, the location of the respective device (green-faced square) was estimated by the PPC method. The location solution provided in previous work uses the nomenclature 
 (Montanha et al., 2019). This work uses the nomenclature 
 to indicate that this solution is relative to the PPC method and 
 for the wPPC solution.

2.2. The PPC method and Considerations
The PPC model is a method proposed to triangulate the position of a device emitting/receiving signals using specific points computed in an arbitrary coordinate system. These specific points, polar points, are computed with the aid of definitions of pole-polar geometry. Basically, pole-polar geometry relates the lines of a circle (or any other conical section) with center 
 and radius  with any point 
, arranged in a same Cartesian coordinate system. One of the questions that pole-polar geometry answers is: if a spot observer is over point , what fraction of the circle with center  and radius  (Fig. 1a) can they see?

The PPC method explores the solution of this problem to perform triangulation and estimate a location of a specific device inserted in the environment covered by the coordinate system that supports the distribution of the triangulation network nodes. Through signals of some nature (e.g., sound or radio), the network nodes and the device interact (communication). These interactions allow for the extraction of data, such as angles and radial distances, in relation to the device's posture with the physical disposition of each node in the network (Fig. 2a).

Fig. 2
Download : Download high-res image (318KB)
Download : Download full-size image
Fig. 2. Triangulation network with two nodes and a device to be located. (a) Possible data extracted from the signal interaction between the device and each node. (b) The Node 2 “view” limitation on the radial range of Node 1 fixed by the polar points. (c) The Node 1 “view” limitation on the radial range of Node 2 fixed by the polar points. (d) The centroid computed on the union of all polar points estimates the device location.

PPC uses the radial distance 
 (radial range) indicated in each node  of the network to perform the triangulation. Fig. 2b illustrates the case in which Node 2 observes the radial range of Node 1, and Fig. 2c the case in which Node 2 observes the radial range of Node 1. These observations allow for the computation of the respective polar points that provide the “vision” constraint on each node over the radial range of the other node.

For a network consisting of  nodes, PPC requires that pairs of nodes be combined among all these nodes. The number  of possible node pairs is given by Equation (1). The number of polar points obtained when combining pairs of nodes is  (each pair of the combination provides four polar points). If the location network has  nodes, there are  combinations of pairs of nodes and therefore  polar points. In terms of , the computational cost of PPC is 
 in accordance with the cost to perform these combinations.(1) 
 
 

2.2.1. The PPC method and the exact solution
The exact solution of any location system depends exclusively on the quality of the data acquired from the signals used in the interaction of the device to be located with the nodes of the location network. If the data are perfect, the solution must be accurate. In the case of methods based on the data of radial ranges of the nodes (lines of the circles), to obtain the exact solution, these radial ranges derived from all nodes of the network must intersect at a single point in the coordinate system.

PPC is based on the computation of the centroid among all polar points. In practice, the centroid is a geometric mean (see definition (d-8)). The greater the radius of a circle is, the more distant, among them, the polar points are. These great distances move the centroid to the circle neighborhood with the greatest radius, and, if there is no symmetry in the distribution of the network nodes, the PPC can lead the result to a location with a significant error (see Fig. 3).

Fig. 3
Download : Download high-res image (655KB)
Download : Download full-size image
Fig. 3. Exact PPC solutions. Asymmetric distribution of nodes in the location network and the PPC solution shifted from accuracy (green faced square). In this case, the exact solution is given by the polar point highlighted in yellow. (a) Network with three nodes. (b) Network with four nodes.

When an exact solution exists, it can be given by a polar point. In this case, there is no need to compute the centroid. This exact solution is obtained with a sequential search on the set of polar points. If there is at least one polar point in that set that belongs to all lines of the circle at the same time, that point is the exact solution. This solution was addressed in previous work (Montanha et al., 2019), but it has not been formalized. The number of polar points that marks the exact solution depends on the number and geometric arrangement of the nodes in the plane of the coordinate system of the location network. For example, with three nodes (Fig. 3a), there are two polar points indicating the exact solution. With four nodes, there are eight (Fig. 3b). If using only two nodes, there is no polar point marking the solution, but in this case the PPC marks the exact solution (Fig. 1b). Even if there is an exact solution and the network has more than two nodes, there is a dependence on the geometric arrangement of the nodes for a polar point to mark that solution. Fig. 5c shows a case in which the solution is exact, but no polar point marks such a solution. Fig. 6 also illustrates this situation of an absence of a polar point indicating the exact solution. In the case illustrated by Fig. 5c, PPC finds the exact solution. In the case of Fig. 6, the PPC does not find an exact solution. When there is an exact solution, but there is no polar point marking or the PPC does not find such a solution, a precision value  capable of minimizing the error of the location estimation is needed.

In computational practice, two real numerical values computed by different paths are not always the same. Even if they are mathematically equal, computationally, they may be slightly different due to the performance of truncation and rounding operations. This means that there is a risk of applying definition (d-5) with the unique condition of obtaining zero in the result when searching for the exact solution marked by a polar point. It is most appropriate to establish a threshold value  that specifies an acceptable precision value to solve the problem of location. In this case, the polar point is considered an exact solution, if it exists, closer to all lines of the radial ranges of the nodes of the location system; at the same time, it is less than or equal to the pre-established  value (see Equation (2)).

Let  be the number of nodes in the location network. Let 
 be the set of all polar points that belong to the radial range of node. Consider that all polar points are stored in a list (a function)  indexed by the value , 
, and that  is an index identifying any node in the network, . The 
 operation accesses all the polar points stored in  that are on the line of the radial range of node  with center 
 and radius 
. Let 
 be an undefined point in the coordinate system. If in the set of polar points there is at least one point that is the exact solution, or with an acceptable precision, 
 is associated with that point by Equation (2).(2)
 where 
 
;
 
 
 
 
 is the distance between point  and the radial range of node  centered at 
 with radius 
 (definition (d-5));

 is the generalized union of a set of sets, e.g., if ;

 are, respectively, the domain and codomain (range) of a relationship and the minimum value of a set of real values.

Fig. 4 illustrates an example of how Equation (2) works. Consider the radial ranges 
 and 
 of two nodes, 1 and 2, centered at 
 and 
, the permissible precision value T, and the respective polar points 
, 
, and 
, among which only 
 and 
 comply with the solution condition given by Equation (2).

Fig. 4
Download : Download high-res image (433KB)
Download : Download full-size image
Fig. 4. Example illustrating how Equation (2) works.

Fig. 5
Download : Download high-res image (629KB)
Download : Download full-size image
Fig. 5. Restricted solutions. (a) Two nodes with secant ranges. This can be solved algebraically (Montanha et al., 2019). (b) Two nodes without intersection of ranges. This can be solved by optimization (Luo et al., 2018). (c) Three vertical collinear nodes. This can be solved algebraically (Montanha et al., 2019) or by optimization (Luo et al., 2018).

Fig. 6
Download : Download high-res image (362KB)
Download : Download full-size image
Fig. 6. Limitation of the PPC. The two nodes (white and black) are inserted into the radial range of the node with the greatest radial range. The polar points, yellow and black, are complex numbers.

For all cases where Equation (2) produces the value 
, 
 will store the value of the exact solution, or with acceptable precision T. When producing the value 
, 
 is undefined.

2.2.2. The PPC method and restricted solutions
Not all location methods can be applied to all location system configurations. Fig. 5 illustrates some of these cases. There is a dependence on the methods in relation to the number of nodes used in the location network and the geometric arrangement of these nodes in the coordinate system. All these cases of restricted solution are solved by the PPC method with good precision.

Fig. 1b shows a location network consisting of only two nodes. Methods that need to perform the linearization of the system of equations, such as LSm and WLSm, cannot solve the unknown  coordinates of the device's estimated location because, after linearizing the system with two equations, only one equation will be left to solve the two unknowns.

However, as shown in Fig. 1b, if the lines of the two circles touch each other (touch one point), or if they are secant (touch two points—Fig. 5a), there is a direct algebraic solution. Such a solution was addressed in the previous work (Montanha et al., 2019).

When the line of two circles does not intersect (Fig. 5b), the algebraic method also fails and, in this case, it is necessary to have a solution by optimization.

If the geometric arrangement of the network nodes is collinear, parallel to one of the axes of the coordinate system (Fig. 5c), LSm, WLSm, and NRm cannot solve by eliminating all equations from the system of equations.

2.2.3. Limitations of the PPC method
The PPC method is based on obtaining polar points using a pole point that is outside the radial range of the network node (Fig. 1, Fig. 2). However, pole-polar geometry does not preclude that the pole point does not belong to the region covered by the radial range of the node (Fig. 5, Fig. 6). PPC combines all nodes in pairs and alternately uses the positions of these nodes as pole points to observe the radial range of the other nodes in the network. There may be situations of inclusion of one or more nodes in the radial range of other nodes. When this occurs, complex numbers are generated as polar points (Fig. 6).

When this problem occurs, two possibilities are recommended (Montanha et al., 2019): discard those points represented by complex numbers, or use only the real part of those numbers as a solution for the respective polar points.

The points highlighted in yellow and black in Fig. 6 correspond to the real part of the generated complex numbers. Note that these points are outside the context of the radial ranges of any node (the polar points must be on lines of circles). The result presented (the green square) was computed without excluding these points represented by complex numbers. The real part of these complex numbers was used. Even if these points are very much out of context, the solution obtained is close to the exact solution. However, the best alternative to solving this problem is to apply the exact solution search (Section 2.1.1) with a predefinition of an acceptable precision value . Note that, in Fig. 6, there are two polar points near the exact solution and the search for the exact solution chooses one of these points as a solution to estimate the location.

2.2.4. The PPC algorithm
The proposed PPC method in the previous work (Montanha et al., 2019) is applicable to the location network with  nodes. The estimation of the location of a device 
 is based on elements of pole-polar geometry.

Polar-Points Centroid Model (PPC).

Data Input
 is the number of nodes arranged in the location network.
,  is the planar position of each node (geometric arrangement).
 Is the radial signal range of each node.
 is the specification of the minimum precision value acceptable.
Procedure
1: for each node 
2: ;
3: , by (d – 6) and (d – 7), for each node position 
, used as pole points, compute polar points 
 and 
 given by the combination of th and , nodes pair with the respective centers at positions 
 and 
 and signals radial range 
 and 
. join the points 
 and 
 in 
;
4: end for 5: compute 
 (defined in the description of expression (2));
6: if 
 then //there is not exact or acceptable solution.
7: compute 
 using the definition (d-8); //the centroid among the polar points is the PPC solution.
8: FALSE;
9: else //there is exact or acceptable solution. A polar point is the PPC solution.
10: compute 
 using the expression (2);
11: TRUE;
12: end if
Information Output
Device location estimation 
.  set of polar points indexed by nodes.
.
The PPC algorithmic proposed in the previous work (Montanha et al., 2019) use as input data the coordinates of each node, 
, , positioned on a coordinate system previously defined and the respective radial signals ranges 
.

Formally, the presented work, which adds to the initial algorithm, suggested that the PPC can find the exact solution, when possible, or can estimate locations based on a criterion of minimum desired precision . We then insert this innovation in the original algorithm. This new PPC requires a specification for  that acts as input data and is used to establish the criterion for achieving location estimation responses with acceptable precision. The gray typed text lines are instructions that help the original PPC algorithm to obtain the exact solution given by Equation (2) and to organize the data for the wPPC algorithm. The PPC algorithm returns 
, a point solution given by a polar point or by the centroid of the polar point set.

3. The proposed weighted Pole-Polar Centroid method (wPPC)
A new method, called the wPPC method, is proposed to be applicable to  nodes that integrate a location network. By arranging these nodes in a known coordinate system, a system for estimating device locations based on data from sent/received signals among these nodes and devices is defined.

wPPC is a complement to PPC. Its use is recommended when the signal data are compromised. In uncontrolled environments, receiving high quality data is extremely difficult. In this way, this work does not consider this eventual possibility as a solution. Our intention is to present new methods applied to signal triangulation problems and to analyze their behavior facing the inherent errors in data signals. Regarding the problem of localization in wireless sensor networks, several alternative approaches and concerns have been presented about data signal behavior (Wang and Li, 2009; Sahoo and Hwang, 2011; PAL, 2010). In order to achieve better results, pre-processed data were used to process a set of partial results that were analyzed to determine between them the more suitable solution (Schneider et al., 2016). As can be seen, acquiring accurate data signals is an arduous task. Schneider et al. (2016) and Lam et al. (2016) proposed methods for sampling data signal acquisition and discussed uncertainty and signal location. In addition, the environment is not predictable with multipath, fading, interference, and shading effects (Ilyas and Mahgoub, 2005).

There is a consensus that signal data with greater radial range are responsible for propagating more significant errors in estimating the location of a device. Such observation is due to the fact that the greater the signal radial range, the greater distance separates the node from the device. Thus, the signal has to travel longer and suffers greater attenuation by the elements of the environment (e.g. atmosphere and obstacles).

These elements interact and degrade the signal by the action of several mechanisms, such as scattering, reflection, absorption, multipath, and the co-presence of other signal sources.

In this context, if there is no exact solution for the position of a device caused by errors in the signal data, data with errors are assumed, and a coordinate that minimizes the location error is estimated. Assuming that it is possible that radial ranges with a larger radius contribute the largest portion of the error in estimating the location of a device in a location system, an alternative to minimize the error of this estimation is to decrease the influence of the largest radial ranges when computing the coordinate location. A second alternative, through error analysis, is to eliminate these greater ranges of location computation, which is possible if there is a redundancy of nodes in the location network. Let us consider Equation (3):(3)
 
where: ; the pole point 
 places two polar points on each radial range of the nodes, except on the line of its own range;
 

  is an index identifying any node in the network, and  is the set of all polar points that are over the radial range of node ;

 is the jth polar point that belongs to the range of node .

Equation (3) can be written in matrix form:(4)
 
where 
 
 
 
 
 
 
 

The wPPC method, described by Equation (3) or (4), uses the alternative that minimizes the error of the estimated location by decreasing the influence of the largest radial ranges in computing this location. Such a decrease in influence is made by reducing the values of the polar points that are over the range of a given node by a weight value equal to the inverse of the range (radius) of that same node. The greater the range is, the more drastic this reduction is.

Weighted Polar-Points Centroid Model (wPPC)

Data Input
 is the number of nodes arranged in the location network.
, , is the planar position of each node (geometric arrangement).
, is the radial signal range of each node.
 is the specification of the minimum acceptable precision value.
Procedure
1: 
; call PPC and return: 
, location by PPC; , set of polar points by node and a flag indicating whether an exact, or acceptable, solution was found by PPC or not.
2: if not  then //PPC no found satisfactory solution. Do not have polar point that solves the location.
3: if 
 is not solution then //verify, by (2), if PPC solution 
 is not satisfactory.
5 4: compute 
 by Equation (3) or (4); //solve the location using wPPC.
5: else
6: 
; //PPC solves location. The centroid among the polar points is the solution.
7: end if
8: else
9: 
; //PPC found satisfa ctory solution. One polar point solves the location.
10: end if
Information Output
Device location estimation 
.
19
The wPPC algorithm uses the PPC to compute and to organize the polar point data. wPPC and PPC require the same input data: the coordinates of each node, 
, , the respective radial ranges 
, the specification of the minimum precision value  acceptable, and the number of nodes  arranged in the location network to return the location estimation 
.

4. Experimental cases and results
To perform the experimental cases, the present work uses the same dataset used in the previous work (Montanha et al., 2019). It is detailed in Appendix A.

Using the IEEE 802.11 Network Infrastructures, we define a location system composed of a local coordinate system, a set of nodes (Access Points – AP Tp-Link Wireless N 300 Mbps TL-WR849 N) arranged on the coordinate system, thus defining the network of location nodes. Such nodes emit radio signals with a 2.4 GHz frequency.

The location system developed in the previous work used five nodes, which were geometrically distributed (location network) in a region of space (coordinate system) (see Table A1). The device to be located was positioned at different coordinates (see Table A3), in that region (12 cases) and the respective radial distances (see Table A3) between that device and each node in the network was estimated using Equation (5) based on the signal strength measured by the device in each experimental case (see Table A2).

A signal receiving device (a commercial cell phone with the Android operational system) was used to acquire the signals emitted by the nodes of the network. The receiving device, the cell phone, has the ability to identify the source of the signal (the device knows that a given signal was emitted by a specific node—BSSID) and to measure the reception strength 
 (see Table A2), in dBm, of each of these signals (RSSI).

Using this signal strength data emitted by the nodes, the device can estimate the radial distances (signal ranges) 
 (see Table A3). This is from each node  of the network in Equation (5). Fig. 7 shows the preprocessed data generated by the 10th experiment (see Table A3).(5)
 
where

Fig. 7
Download : Download high-res image (329KB)
Download : Download full-size image
Fig. 7. The 10th experimental case performed in the previous work (Montanha et al., 2019). The location system consisting of a location network with five nodes and the respective coordinate system is defined in Table A1. The signal strength data for each node measured on the device to be located are in Table A2 (10th row), and the actual position of this device and the respective radial ranges of each node are in Table A3 (10th row).

 is the signal strength value (dBm) emitted by the  node and measured by the receiver device placed on a specific position on the coordinate system;

 is the signal strength value (dBm) at some reference distance 
 (the calibration of the device with the  node). The authors of (Montanha et al., 2019) used 
;

 is an empirical value that defines the attenuation factor of the signal (path-loss parameter) emitted by the  node. The authors of (Montanha et al., 2019) used the value 
 for all nodes.

4.1. Results
Fig. 8a and b shows how PPC and wPPC work when operating on high-quality data. Fig. 9a and b shows how PPC and wPPC work when operating on low-quality data. In both cases, wPPC produced location estimation results more accurately than PPC.

4.2. Results analysis
Fig. 8, Fig. 9 and all those presented in Appendix B show the 12 experimental cases, with actual data, used in the previous work (Montanha et al., 2019). It can be seen in these figures that the wPPC method is able to compute these data (with errors) more accurately than the PPC. In all these cases, there are errors in the acquired signal data.

As we mentioned before, the previous work (Montanha et al., 2019) proposed five variations of geometric methods (PPC, Polar-Point Centroid, CHC, Convex Hull Centroid, PLI, Polar Line Intersection Centroid, TLI, Tangent Line Intersection Centroid, and MAI, Minimal Angle Tangent Line Intersection Centroid) and compares the results achieved by the methods that we developed with the results produced by traditional methods (NRm, the Newton-Rapson method, LSm, the Least Squares method, and WLSm, the Weighted Least Squares method). Extensive error evaluation was performed on the actual data acquired in the experiment carried out. In order to analyze the results produced by the methods previously proposed, statistical metrics were applied to compare the results produced by the new proposed methods with the results produced by other methods. The same data and the same structure generated in the previous work to analyze the results are used in this case (Table 1, Table 2). The only difference is the inclusion of the results produced by the wPPC method in this analysis.


Table 1. Magnitude in meters of errors in the experimental cases.

Minimum Error	Maximum Error	Mean Error
x-axis	y-axis	distance	x-axis	y-axis	distance	x-axis	y-axis	distance
wPPC	0.4	0.2	0.6	12.0	5.2	13.0	2.6	2.0	3.4
PPCa	0.4	0.2	2.7	15.5	12.5	15.7	4.5	4.4	6.9
CHCa	0.1	0.1	0.6	11.9	6.0	12.8	2.5	2.4	3.7
PLIa	0.1	0.1	0.7	12.8	15.9	16.3	2.4	3.8	5.0
MAIa	1.6	0.3	1.7	7.9	5.3	8.9	4.2	1.5	4.7
TLIa	2.3	0.3	2.3	8.3	3.9	9.2	4.1	1.3	4.4
NRma	0.1	1.1	1.3	14.7	12.2	15.2	2.8	5.1	6.5
LSma	0.3	1.2	1.8	14.1	22.5	23.7	3.6	6.4	7.9
WLSma	0.1	0.7	1.3	13.6	15.3	17.7	3.5	4.9	6.5
a
Available in (Montanha et al., 2019).

This analysis performed in the previous work considers three datasets of errors: (1) the error in distance measurement (the Euclidean distance between the estimated device location 
, computed for each method, and the actual device position 
 (see Table A3)), (2) the absolute error along the x-axis given by 
, and 3) the absolute error along the y-axis given by 
. The present work uses this same strategy to analyze the results of the wPPC and compares them with results obtained previously (Montanha et al., 2019).

The analysis of the errors considers four metrics applied to the three datasets of errors, minimum, maximum, mean, and standard deviation (Table 1, Table 2), and a fifth metric for analyzing global errors called the Effective Variability of the Errors (Table 2).


Table 2. Standard deviation of the errors.

Methods	Standard Deviation of the Errors	Effective Variability of the Errors
x-axis	y-axis	distance
wPPC	3.2	1.5	3.3	2.7
PPCa	4.1	3.8	4.5	4.1
CHCa	3.1	2.1	3.4	2.9
PLIa	3.3	4.1	4.9	4.1
MAIa	2.5	1.6	2.6	2.2
TLIa	2.3	1.0	2.3	1.9
NRma	4.0	4.0	4.9	4.3
LSma	4.3	6.7	7.4	6.1
WLSma	4.2	4.3	5.5	4.7
a
Available in (Montanha et al., 2019).

Table 1 presents an evaluation of the error values considering all experiments for each geometric model and numerical method. These values explain that some geometric models produce results with errors equivalent to those produced by numerical methods. Errors committed by PPC are equivalent to those committed by numerical methods (WLSm, NRm, and LSm). We can observe that errors may be larger or smaller depending on the quality of the acquired data, but in the general context, geometric models present better results than numerical methods.

The minimum error values presented in Table 1 create a hypothetical case of the lowest possible error in the evaluated dataset. In other words, depending on the available data, this operation sets up a case in which the data are accurate. As can be seen, even considering this hypothetical case that includes the most adequate data values, traditional methods (NRm, LSm, and WLSm) and geometric methods (MAI and TLI) propagate more significant errors when the data are of high quality. wPPC, among these minimum errors, has an average of 0.4. The CHC and PLI average 0.3. That is, when the data are good, wPPC produces a response as accurate as CHC and PLI.

Similarly, the maximum error values presented in Table 1 create the case for the greatest possible error in the evaluated dataset. For this case, traditional methods produce error averages between ~13 and ~20. Among geometries, PPC and PLI average ~15, and wPPC and CHC average ~10. MAI and TLI average ~8.

In the case of moderate errors, contemplating the occurrence of the most expected situation in the real world, wPPC has the lowest average error among all other methods.

With these analyses, Table 1 shows that, when there is high accuracy in the data, wPPC produces results with acceptable precision. When the data are bad or have moderate errors, the wPPC response is more accurate than other methods.

When considering the results of all experimental cases, Table 2 shows the variability of the errors committed (for each evaluating metric) by the methods in function of the errors in the data.

The Effective Variability of the Errors (Table 2) allows one to analyze how sensitive a method is to variation in data quality. In other words, this value is a metric that defines how well a method can approach an exact solution when it operates on data with errors. The lower this value is, the less sensitive the method is to errors in data; the method can therefore produce more accurate results. A simple analysis of the data in Table 2 shows that the proposed geometric models, compared with the traditional WLSm, NRm, and LSm methods, are more robust when they operate on data with errors. Among the geometric methods, the TLI, MAI, and wPPC have a greater capacity to process data with errors.

5. Conclusion
This work proposed the wPPC method as an extension of the PPC method, without increasing the computational cost 
 and without increasing the minimum number of nodes  in the composition of the location network.

The ability of the PPC method to produce an exact solution has been formalized in Section 2.1.1. The results produced by wPPC are more accurate when processing data with errors (significant or not). This work helps to cope with the problem of applying 2D point location in a geometric relationship by reducing the number of arithmetic operations needed by the current conventional methods in use and the inherent error propagation in the acquired data. Therefore, this method can benefit wireless interaction among mobile phones for proximity contact tracing by improving the estimation accuracy of signal locations. The computational cost 
 of the geometric methods contrasts significantly with the cost 
 of the numerical and optimization methods. This fact allows for the development of localization applications for devices (such as cell phones) that have a low processing capacity. Such an application can run in the background and process signal data (Wi-Fi, Bluetooth, ultrasound, etc.) for location estimation. Each device can have the capacity to compute the locations of other devices in its vicinity, in either outdoor or indoor public areas (street, parks, supermarkets, public transport, etc.), offering support for the measuring and tracing of proximity relative to another device. The proposed wPPC method has the following limitations: (1) it is a 2D solution, and (2) it requires that the device be located inside the coverage area of the node network. Future work will include a 3D solution. When the device to be located is outside the region covered by the location network nodes, complex numbers are generated in the coordinates of the polar points. For this reason, in order to apply geometric methods, there is a need for the device to be surrounded by the nodes of the location network. We should investigate, in future work, a better interpretation of the meaning of polar point coordinates given by complex numbers in the context of signal location using geometric methods.