Future cellular networks will increasingly rely on the millimeter-wave bands to increase capacity. Migrating to ever higher carrier frequencies will require increasingly directional beamforming to establish and maintain the link. Intelligent beam management (BM) protocols will be critical for establishing and maintaining connections between the base station and user equipment in a dynamic channel. This article first provides a brief overview of the BM protocol in Release 15 of 5G New Radio, then identifies six major challenges to BM for later 5G releases that will likely persist into 6G. We describe the trends and issues behind each of the six challenges, and provide recommendations and suggested research directions to address them.

Introduction
Fifth generation (5G) cellular networks tap into the millimeter-wave (mmWave) bands between 24.25 GHz and 52.6 GHz to deliver high data rates and to support a proliferation of new use cases. The propagation conditions for mmWave bands are significantly harsher compared to legacy sub-6 GHz frequencies due to the high path loss and sensitivity to blockage. In order to guarantee coverage, mmWave devices need to perform beamforming (BF) to concentrate the signal energy in a small angular space. Hence, beam management (BM) - which collectively encompasses initial beam alignment, monitoring, and tracking, as well as recovering from beam failures - is absolutely crucial for mmWave communication systems. The BM approach established in Release 15 of 5G is based primarily on beam sweeping and reporting. However, as 5G is extended to support more sophisticated devices, higher bands, and a wider range of use cases, the existing BM framework will be severely strained.

The authors provide a brief overview of the beam management (BM) protocol in Release 15 of 5G New Radio, then identify six major challenges to BM for later 5G releases that will likely persist into 6G. They describe the trends and issues behind each of the six challenges, and provide recommendations and suggested research directions to address them.

Recent work has provided a useful overview of the BM procedures in 5G, including a high-lev-el overview [1] and a more detailed description [2], which includes a comparison of BM in standalone (SA) and non-standalone (NSA) systems. Additional details of the BM specification solidified in Releases 15 and 16 are included in [3]. In this article, after first providing an overview of the current BM procedure for SA 5G systems, we identify what we believe are the six most important challenges and promising research directions in mmWave BM, with a focus on the enhanced mobile broadband (eMBB) application. These key challenges for BM are:

Inefficient beam sweeping at higher carrier frequencies

BM optimization for multi-panel user equipments (UEs)

Inflexible BM response from over-reliance on downlink (DL)/uplink (UL) beam correspondence

High mobility and device rotation

Robust and adaptive mmWave beam codebook designs

Lack of an effective evaluation framework

We briefly describe each of these challenges and provide recommendations for future research and approaches that appear promising for ameliorating these problems.

Beam Management Framework in 5G
The BM framework specified in the current release of 5G NR is based on measuring and reporting beamformed reference signals (RSs) transmitted either by the BS or by the UE. The DL BM framework is illustrated in Fig. 1. The BS sweeps a fixed set of beams through periodic synchronization signal (SS) blocks. In addition to the SS blocks, the BS can perform additional beam sweeping using channel state information RSs (CSI-RSs), which are configurable and can be aperiodic. The UE measures the RSs using different receive (Rx) beams and reports the quality of the best beams to the BS. Based on the UE feedback, the BS has the flexibility to choose among the reported beams for future communication. In the UL, the UE can transmit beamformed sounding reference signals (SRSs) for BM. We refer to [2] for a more detailed explanation of the structure of RSs used for BM in 5G NR.

In practice, beam correspondence is often assumed so that the BS can determine the UL Rx beam based on DL beam measurements without the UL beam sweeping. The UE can also assume that its best Rx beam in the DL will be the best Tx beam in the UL. As a result, the BM framework in Release 15 of 5G largely relies on DL beam sweeping and measurements.

The BM framework specified in the current release of 5G NR includes four operations: beam sweeping, beam measurement and reporting, beam indication, and beam failure detection and recovery. A summary of the four beam operations and the relevant 5G specifications is shown in Table 1.

Beam Sweeping
Beam sweeping refers to the process where the BS or the UE covers a spatial area by sequentially using different analog beams when transmitting or receiving RSs. The BS and the UE have pre-determined analog beam codebooks. During beam sweeping, the BS or the UE sequentially uses beams from the entire codebook or from a subset of the codebook in order to find good Tx-Rx beam pairs for the data and control channels. On the transmitter side, beam sweeping can be done by sending beamformed RSs such as SS blocks and CSI-RSs by the BS, or SRSs by the UE. On the receiver side, the BS or the UE can sweep through its receiving beams when measuring beamformed RSs transmitted by the other entity. There are three types of beam sweeping, as shown in Fig. 2.

Procedure 1 (P1)
Procedure 1 (P1) Beam Selection
Both the BS and the UE perform beam sweeping. In the DL, the BS periodically sweeps its Tx beams using SS blocks, while the UE uses a different Rx beam for each SS burst set.

Procedure 2 (P2)
Procedure 2 (P2) Beam Refinement for the BS
The UE fixes its beam while the BS performs beam sweeping. P2 can be used to refine the BS beam after coarse beam alignment has been achieved. If the BS uses a hierarchical codebook, it can sweep narrow children beams of the wide beam found in P1 using CSI-RS.

Procedure 3 (P3)
Procedure 3 (P3) Beam Refinement for the UE
The BS fixes its beam while the UE performs beam sweeping. The BS can configure periodic or semi-persistent CSI-RSs that are transmitted in repetition using the same beam.

The three beam sweeping procedures are conceptual and are not specified in the standard. It is not required by the standard that P1, P2, and P3 all be implemented. In fact, in some practical scenarios, P1 alone could be enough.

Beam Measurement and Reporting
The BS or UE measures the UL or DL RSs and reports the corresponding L1-reference signal received power (RSRP). Measurement of the sig-nal-to-interference-plus-noise ratio (SINR) of RSs is also supported in Release 16 of 5G. The UE may measure all SS blocks but only its configured CSI-RSs. Beam reporting by the UE needs to be configured by the BS. Depending on the capability of the UE, it may report the identifiers and measurements of up to four RSs per report. A UE that can simultaneously receive two different RSs can be configured to enable group-based beam reporting, so it reports the two different RSs in a single reporting instance. The beam report needs to be scheduled to be transmitted on either the physical uplink control channel (PUCCH) or the physical uplink shared channel (PUSCH).

Beam Determination and Indication
For idle UEs, beam determination and indication is achieved through the one-to-one mapping between each SS block and each random access channel (RACH) resource during initial access (IA). The UE measures all SS blocks, selects the one with the highest RSRP, and initializes random access using the RACH resource associated with that SS block. The BS can identify the selected beam from the RACH resource used by the UE.

Figure1. - Beam management framework based on DL rss in 5G nr. The BS transmits beamformed rss through SS blocks or CSI-rss, the UE measures and reports the quality of the rss. The BS selects a beam for future data transmission.
Figure1.
Beam management framework based on DL rss in 5G nr. The BS transmits beamformed rss through SS blocks or CSI-rss, the UE measures and reports the quality of the rss. The BS selects a beam for future data transmission.

Show All

For beam tracking, the BS establishes a mapping between the DL physical channels and each BM RS in terms of the beam pair used through Transmission Configuration Indicator (TCI) state. By configuring a TCI state for a UE, the BS informs the UE that the DL channel will use the same beam pair used to measure the BM RS associated with that TCI state. Since the number of beams that can be configured in lower-level messages is limited, beam indication in 5G uses a hierarchical messaging mechanism. A common pool of beams is configured using the slower, more expensive L3 radio resource control (RRC) messaging, while the final beam selection can use faster L1/L2 messaging such as the medium access control control element (MAC-CE) and downlink control information (DCI).

Beam Failure Detection and Recovery
The UE detects beam failure by monitoring the quality of its current connected beams. The block error rate (BLER) of the DL control channel (PDCCH) is estimated from the L1-RSRP of an SS block or a periodic CSI-RS. A beam failure instance is triggered if the estimated BLER is above a configured threshold. If multiple consecutive beam failure triggers have been detected, the UE starts to search for alternative candidate beams with better quality. Upon beam failure, the UE triggers the beam recovery process by sending a request to the BS through the physical RACH (PRACH). The BS then sends a beam failure recovery response using the new candidate beam.

The overall BM framework was introduced in Release 15 of 5G. Release 16 introduced features such as DL multi-panel transmissions, and interference measurement and reporting. Future releases such as Releases 17 and 18 are expected to further extend the mmWave spectrum, support high-speed use cases, enable UL multi-panel operations, and introduce further optimizations for more efficient beam measurement and reporting.

Challenges for Beam Management
In this section, we identify several challenges facing BM in the future releases of 5G and perhaps beyond 5G. A summary of the challenges, open problems, and our recommendations is shown in Table 2.

Figure 2. - Beam sweeping types: beam selection (p1), BS beam refinement (p2), and UE beam refinement (p3).
Figure 2.
Beam sweeping types: beam selection (p1), BS beam refinement (p2), and UE beam refinement (p3).

Show All

Table1. Summary of beam management operations.
Table - Summary of beam management operations.
Inefficient Beam Sweeping at Higher Carrier Frequencies
Future cellular systems will rely on ever-higher carrier frequencies. Release 17 of 5G will extend the mmWave band from 52.6 GHz to 71 GHz, while the 95 GHz-3 THz spectrum has been granted for early 6G experiments. Higher carrier frequencies require even narrower beams to achieve coverage, which increases the size of the codebook, making tracking narrower beams much more difficult. Thus, the existing framework based on beam sweeping will have significantly larger overhead, higher latency, and higher complexity, and will not scale up gracefully to higher frequencies and bandwidths. For instance, the current 5G specification allows each SS period to contain at most 64 SS blocks, which most certainly will not be sufficient to sweep large codebooks. The current beam indication framework allows each RRC reconfiguration to select at most 128 TCI states in the common pool and each MAC-CE to select 8 candidate beams, which will significantly increase the messaging overhead in beam indication alone if adopted directly in systems with higher carrier frequencies.

Recommendations
The current BM framework, relying excessively on beam sweeping, needs to be redesigned and reimagined to efficiently accommodate a very large number of narrow beams. Compressive sensing has been explored to reduce the beam search space by exploiting channel sparsity [4]. BM methods that utilize side information such as location [5] and out-of-band measurements [6] have also been proposed. Data-driven approaches including statistical and machine learning (ML) methods can further leverage such side information and allow customization to the specific environment or use case [7]. These BM methods may require signaling to support the exchange of the side information used. With carefully designed reward signals, reinforcement learning (RL) may allow devices to learn adaptive BM policies by interacting with the environment, instead of each device adhering to a strict human-engineered BM procedure. An application of RL in joint BF, power control, and interference coordination is explored in [8]. Researchers need to consider not only the complexity of the BM procedure itself but also overheads including messaging and power consumption. The new protocol should be backward compatible with the existing beam-sweeping-based framework to ensure easy adoption and smooth transition.

Need Forbmoptimization for Multi-Panel Ues
To increase robustness against channel changes caused by hand blockage, UE mobility, and rotation, mmWave UEs are usually equipped with multiple antenna panels. As shown in Fig. 3, the UE can switch panels if the current one is blocked or ineffective, which not only increases robustness but also brings a significant additional dimension to the BM problem. The UE is typically unaware of the channel quality of inactive panels since inactive panels are typically turned off to save power. In the future, UEs may also use multiple panels simultaneously for joint Tx/ Rx to increase diversity/multiplexing gain, as shown in Fig. 3. For panel switching, finding the optimal beam on the optimal panel requires the UE to search all beams on all panels, which will significantly increase the latency, complexity, and power consumption, and hence is probably a non-starter. The complexity is even worse when joint Tx/Rx is possible, as the UE needs to search all beams on all combinations of panels. Furthermore, in emerging UE form factors such as foldable phones, the physical position and self-blockage condition of the antenna panels may change depending on the folding state of the device. Overall, the multi-panel operation depends significantly on the hardware design, including both the panels themselves and their beamforming architecture and the analog and digital signal processing associated with them.

Recommendations
The BM procedure needs to support effective panel switching and multi-pan-el joint Tx/Rx, and be able to intelligently trade power consumption for beam alignment accuracy. To effectively support UEs with different levels of multi-panel operation capacity, such as whether joint Tx/Rx is supported, the BS may need the UEs to report their capabilities. Researchers need to design BM procedures for multi-panel UEs that do not rely on extensive beam sweeping. The UE often has real-time information that can benefit multi-panel operations, such as blockage conditions, the relative positions of its panels, the orientation of the device, and even what application is currently being used. The BM procedure should take advantage of such information by either enabling more feedback from the UE or directly using such information to aid BM at the UE side. An example of using UE real-time side information is [9], where, for example, it is shown that a video or voice call usually results in a different optimal panel than a UE that is being used for web browsing or typing since the user's hands and body are in different positions relative to the device for these different applications. Similar to the challenge with higher carrier frequencies, ML-aided approaches here can utilize such context information to support effective panel switching and multi-panel joint Tx/Rx.

Table 2. Summary of beam management challenges,
Table 2.- Summary of beam management challenges,
Inflexible Bm Response from Over-Reliance on Dl/ul Beam Correspondence
Beam correspondence, or DL-UL beam reciprocity, refers to the assumption that the best Tx beam in the DL is the best Rx beam in the UL, and vice versa. This is an important assumption that allows the existing BM framework in 5G to rely heavily on DL beam sweeping and avoid UL beam sweeping: UL beams are inferred from the measurements of the DL RSs. Beam correspondence holds when the radio configurations are symmetric in the DL and UL. However, as mmWave technology matures, the DL and UL face different constraints, often breaking beam correspondence. For example, power constraints may require a UE to activate only a portion of its antenna array for UL transmission, while still activating the full array for DL reception. Additionally, Maximum Permissible Exposure (MPE) [10] regulations may require the UE to reduce its Tx power when using the best DL Rx beam so that the radiation absorbed by the human body is limited. An alternative beam may be better for the UL if it allows the UE to transmit at higher power.

Recommendations
While both DL and UL beam sweeping are supported in 5G, adopting simultaneous and independent UL and DL BM procedures for all UEs is expensive and inefficient. UEs without beam correspondence need to frequently perform UL beam sweeping by transmitting SRSs, which increases the power consumption and is particularly taxing for those operating on battery power. Furthermore, there is currently a lack of standardized mechanisms to even identify scenarios where beam correspondence breaks. On the other hand, a mapping between the DL beam measurements and the optimal UL beam may still exist even when the optimal beams in the DL and UL are different. UEs may explore such relationships so that the optimal UL beam may be identified without UL beam sweeping. For instance, when beam correspondence breaks due to the operation scheme of full-array DL reception and sub-array UL transmission, the sub-array UL beams can be shaped to resemble the radiation patterns of the full-array DL beams so that the best UL Tx beam can still be accurately inferred from the best DL Rx beam. If beam correspondence breaks due to MPE-related Tx power constraint, the UE may predict the optimal UL beam using its DL beam measurements and side information such as its orientation, blockage condition, and hand grip position. Since the approach may depend on the specific scenario, researchers need to identify different causes of beam correspondence failure and design appropriate solutions accordingly.

Figure 3. - A UE with three antenna panels on the top and sides may perform panel selection and activate a single panel, or perform multi-panel joint tx/rx with beams on different panels.
Figure 3.
A UE with three antenna panels on the top and sides may perform panel selection and activate a single panel, or perform multi-panel joint tx/rx with beams on different panels.

Show All

High Mobility and Device Rotation
Future releases of 5G are expected to support use cases with increasingly complex mobility patterns. This includes high-mobility outdoor UEs such as highway vehicles and high-speed trains, and new applications with faster rotation and more frequent blockage such as augmented reality (AR), virtual reality (VR), and unmanned aerial vehicles (UAVs). With higher carrier frequencies, smaller cells, and more irregular cell boundaries, UEs with high mobility and rotation will experience more frequent handovers to stay in coverage. Naturally, such dynamics complicate BM significantly and further penalize beam sweeping approaches.


Figure 4.
Multi-bs cooperative beam tracking and handover for mobile ues with rotation through information sharing between bss,

Show All

Recommendations
Although the current BM framework entirely relies on measurement and reporting of beam-sweeping RSs, context information unique to these use cases should be leveraged to aid the BM process. For example, UEs on highways and high-speed trains often have predictable optimal beam sequences corresponding to their trajectories. Designing a BM scheme specifically for such predictable mobility scenarios can greatly increase the beam switching efficiency. Similar to leveraging context information to assist BM for multi-panel UEs, additional UE sensors can provide helpful information such as velocity and orientation to facilitate BM in use cases such as AR, VR, and UAVs, where the mobility patterns are more precarious. Furthermore, instead of BM conducted as a local effort by each individual BS, as in the existing framework, cooperation among a network of BSs may allow for more effective beam tracking, more efficient handovers, and less frequent beam failures, as illustrated in Fig. 4. A centralized system that coordinates beams and handovers globally requires extensive information sharing between BSs. In contrast, a distributed approach may require information exchange only between neighboring BSs, potentially at the cost of BM performance. Multi-agent and distributed RL, where agents can learn to communicate and cooperate with each other, may be a promising way to realize an efficient multi-BS BM framework. Nevertheless, the trade-off between increased network operation complexity and improved BM performance due to BS cooperation needs to be considered.

Need for Robust and Adaptive Mmwave Beam Codebook Designs
Traditional beam codebooks are optimized for a single antenna array operating in a narrow frequency band regardless of the deployment environment. These codebooks require optimization for multi-panel joint Tx/Rx for UEs with such capabilities. MmWave BSs are also likely to be deployed in urban areas with complicated propagation environments. Site-specific BS codebooks, which can efficiently utilize the reflection paths to reach the non-line-of-sight UEs, prioritize the dense regions and significantly improve the coverage and throughput of the mmWave BSs, can be designed by learning the underlying scattering environment and UE distribution. Furthermore, the mmWave band spans drastically different frequencies. As devices are pushed to support ever higher frequencies, the difference in the equivalent antenna spacing (in terms of wavelength) and thus in the antenna element radiation patterns across different bands will become more significant. A codebook designed for a narrow frequency range is sub-optimal for multi-band operations. Additionally, hierarchical codebooks are widely adopted to reduce the beam sweeping complexity. However, a wide range of factors, including the measurement noise, imperfect wide beam shapes, and multi-path channels, can lead to hierarchical beam search errors where the UE ends up with a sub-optimal narrow beam with much worse gain. Both the codebook design and the beam sweeping procedure need to take such imperfections into consideration.

Recommendations
Site-specific codebooks can be first designed offline based on ray-tracing simulation data, and be adapted online to environment changes (e.g., new buildings, UE distribution variation across time) by analyzing the history of the beam reports from all connected UEs. ML can be a powerful tool to learn the spatial properties and adapt to dynamic environments. When hierarchical codebooks are used, redundancy can be injected into both the codebook structure and the beam sweeping procedure to reduce the hierarchical search error. For example, the children beams of the two best wide beams, instead of only the best wide beam, can be searched during beam sweeping. Beam codebooks should also be robust to hardware impairments and uncertainties such as phase errors caused by the antenna feed line and limited resolution phase shifters, the mutual coupling of neighboring antennas, and even changes caused by the protection case of the phone.

Lack of an Effective Evaluation Framework
BM seeks to find and maintain good analog beams despite the channel changes caused by UE mobility. Hence, evaluating BM performance requires accurate modeling of UE mobility and the resulting channel changes. A compatible evaluation framework is required to have meaningful comparisons of BM solutions since their performance can be sensitive to the modeling choices.

The channel models considered in 5G NR are drop-based, where parameters for a channel realization are randomly generated for each UE placement [11]. Such models do not guarantee similar channel realizations at nearby locations and do not support the smooth transition of channels as a UE moves in a local area. Several optional spatial consistency procedures are proposed by 3GPP, which either create time-varying cluster and ray-specific parameters based on the UE's velocity or interpolate large-scale and small-scale parameters of nearby channel realizations [11]. Several other channel models outside of 3GPP, such as NYUSIM [12] and QuaDRiGa [13], have implemented spatial consistency features similar to those proposed by 3GPP. Another class of channel models is ray-tracing models, which can accurately capture the spatial dependency of mmWave channels. Through ray-tracing, for example, using Wireless InSite [14], a user explicitly specifies the location and type of each scatterer in the environment. Ray-tracing emulates the interaction between rays emitting from the Tx antennas and the environment along their paths before reaching the Rx antennas. In practice, there is no consensus on a suitable channel model for the evaluation of BM in NR.

Another integral aspect of evaluating BM performance is the accurate modeling of UE mobility and rotation. The trajectories and orientation change patterns of UEs can be vastly different in different scenarios. An orientation-based random waypoint model is proposed in [15] where the UE rotation is modeled as a random process. However, the modeling is based on a limited number of measurements of static and walking UEs in an indoor scenario. There is currently a lack of consensus and specification on the appropriate mobility and rotation models.

Recommendations
Evaluation of BM performance requires spatially consistent channel models and accurate UE mobility and rotation models. By far the most accurate in terms of capturing the spatial dependency of mmWave channels are ray-tracing models. However, they are less generalizable compared to traditional drop-based statistical channel models since the exact scattering environment needs to be specified. We may draw inspiration from the ML community, where a suite of datasets are developed as common benchmarks for different ML problems. Researchers can create ray-tracing datasets for a wide range of scenarios so that a suite of multiple datasets can constitute an accurate but generalizable benchmark. Similarly, there needs to be an agreed-upon set of UE mobility and rotation patterns used for BM evaluation. On the other hand, a trade-off between accurate modeling and computational complexity needs to be considered since spatially consistent channel and mobility models often impose greater computational burden.

Conclusion
As cellular systems continue to migrate to higher carrier frequencies including above 100 GHz, the critical functions of beam alignment, tracking, and recovery, collectively known as beam management, will become the limiting bottleneck in terms of the latency and reliability of the link, as well as UE power consumption. We have identified six key challenges for beam management and provide recommendations on how to best meet them in future 5G and eventual 6G systems.

As cellular systems continue to migrate to higher carrier frequencies including above 100 GHz, the critical functions of beam alignment tracking, and recovery, collectively known as beam management will become the limiting bottleneck in terms of the latency and reliability of the link, as well as UE power consumption, We have identified six key challenges for beam management and provide recommendations on how to best meet them in future 5G and eventual 6G systems.