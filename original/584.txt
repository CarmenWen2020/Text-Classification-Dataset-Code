Abstract
An Internet of Things (IoT)-based informationized power grid system and a hierarchical energy storage system are put forward to solve energy storage problems in new energy power construction in remote areas. The system applies IoT to construct a distributed new energy grid system to optimize electric energy transmission. The information model is employed to establish a hierarchical energy storage system to combine the advantages of distributed energy storage and centralized energy storage, thereby enhancing the transmission grid security further. An indicator system is established to evaluate the energy storage system, considering the technology, economy, and society, using the Gray Relational Analysis model. Finally, the designed energy storage system is evaluated comprehensively. Experimental results demonstrate that the IoT-based hierarchical energy storage system can alleviate the peak overload of the new energy distributed power generation system. The experiment verifies the effectiveness of the proposed model for new energy storage systems. The comprehensive evaluation result of the lithium battery energy storage system is the highest, with a correlation value of 0.89. Hence, the lithium battery energy storage system has a wider application prospect. The research results can contribute to establishing a distributed new energy storage system based on IoT technology.

Introduction
Energy is the power source for a country’s economic development. However, with the intensification of energy and environmental problems, the energy consumption structure is undergoing profound changes. New energy power generation technologies have been widely used. Power generation technologies such as photovoltaics and wind power have gradually replaced traditional power generation technologies. Especially in rural and remote areas, new energy power generation solves the electricity problems, playing an influential role in constructing new rural areas [1]. However, the rural power infrastructure is affected by the regional economic development. There are problems such as non-centralized coverage of the power grid, uncontrollable operating environment, distributed load, and difficulty in operation and maintenance [2]. To solve the randomness and volatility of new energy power generation, energy storage techniques are vital to adjust the grid’s power, smooth power fluctuations, and improve the dispatchability of electric energy. At present, the global installed capacity of energy storage is mainly pumped storage. However, pumped storage has disadvantages such as geographical limitations, excessive investment, and long construction periods. Hence, it is not used for large-scale popularization. Electrochemical energy storage has many advantages, such as short construction periods, wide application range, and continuous cost reduction. Therefore, its share in the overall installed energy storage capacity is rising rapidly. Nevertheless, the actual proportion is small and has great development potential. Lithium batteries account for 86.3% of electrochemical energy storage. The core reason for lithium batteries occupying the mainstream of energy storage is the large-scale application caused by their performance improvement and cost reduction. The development of energy storage techniques is caused by the intermittent and unstable characteristics of new energy power generation technologies, such as photovoltaics and wind power. It is increasingly difficult for traditional thermal power plants to meet the short-term high-power regulation requirements. The Internet of Things (IoT) can transfer the information of sensors, scanners, and other equipment in real-time, realizing the intelligent perception of things and processes [3]. Therefore, using IoT can centralize the information of the new energy grid, monitor the operation status of the grid equipment in real-time, and manage the power assets effectively, thereby modularizing and visualizing the grid information.

Kabalci et al. [4] integrated multiple energy forms into a smart grid. They connected the smart grid to smart environment metering and energy management infrastructure based on IoT and formulated an energy internet to manage the electric energy efficiently. Khatua et al. [5] constructed a smart grid system using sensors, which transmitted energy-associated data of renewable energy through a communication network and used IoT for real-time monitoring. They also studied the possible security, connectivity, packet loss, and data processing issues in IoT. They evaluated the applicability of different IoT data transmission and communication protocols in modern power grid systems. Elmouatamid et al. [6] used a microgrid system to effectively integrate and manage new energy equipment and energy storage systems. The microgrid system consisted of power generation components, metering components, and control services. It balanced the variability of new energy production and equipment occupancy rate to minimize the consumption of the power grid while ensuring the quality and reliability of power services. Baumann et al. [7] applied the multi-standard decision analysis method to evaluate the sustainability of the grid-connected energy storage system. They summarized the existing research and analyzed and discussed multi-attribute decision-making and quantitative standards for the research objects. The quantitative standards involved technology, economy, society, and the environment. Finally, they adopted the Analytic Hierarchy Process (AHP) to analyse the constructed quantitative standards and linked the assessment to specific applications. Davies et al. [8] studied the economic feasibility of the energy storage system applied to the new energy grid and established a new energy grid energy storage model based on the battery market price model and specific application constraints. They analyzed the power curves of different chemical batteries and evaluated the economic value of the energy storage system. Lv and Xiu [9] applied mobile edge computing that integrated software-defined networking and network function virtualization to solve the load balancing problem of mobile IoT, in an effort to improve the stability of the next-generation mobile IoT, thereby reducing the response time of the server and improving the quality of user service experience. Feroz and Anandharaj [10] proposed an IoT security service technology based on recognizing key management to further improve key management and maintenance in a cluster mobile environment. Cluster heads coordinated the key manager nodes, thereby reducing the computational cost in the mobile conditional network. The experimental results suggested that the proposed algorithm could reduce the computational overhead in terms of computational cost, energy consumption, and transmission delay.

In the present study, a distributed new energy grid system is established using IoT to expand the new energy power generation technology and provide a stable and continuous power supply system for remote areas. This system can improve the capacity of new energy power generation, connect the grids of solar power, wind power, and biomass power generation, and improve the power supply stability of the system. Second, a hierarchical energy storage system is designed based on the information model to communicate and schedule the tasks between the energy storage systems. Finally, a comprehensive evaluation of the energy storage system is made using Gray Relational Analysis (GRA). The innovative points are: (1) combining various new energy power generation technologies on the grid; (2) building a new energy power generation system using IoT to provide a stable power source; (3) applying GRA to evaluate energy storage systems to determine more efficient energy storage batteries.

Method
Distributed power system based on IoT
With the rapid development of the new energy industry, new energies have played an increasingly important role in national production and socioeconomic development. New energy power plants can convert solar, wind, geothermal, and ocean energies into electrical energy, providing new solutions for this society with increasingly precise energy. New energy power generation has a mattering strategic value in rural areas where regional economic development is comparatively backward [11]. With the development of the social economy, the economic gap between urban and rural areas yet exists. New energy can bring modern electricity to rural areas and promote the new village construction. In remote rural areas, solar energy and wind energy are complementary to generate electricity to solve power transmission restriction in complicated terrain. The IoT technology connects sensors and other devices using the network to form multiple integrated sensor networks to monitor, perceive, and collect information in the environment. Applying IoT to construct the new energy power grids and collect power grid information can modularize and visualize power information management.

New energy refers to the resources in nature that can be recycled and used continuously without causing damage to the natural ecology. New energy power generation technologies currently commonly used include solar energy, wind energy, hydro-energy, biomass energy, geothermal energy, and ocean energy power generation. In remote areas, solar, wind, and biomass energies can achieve complementary power generation to make up for the lack of regional power supply [12]. Photovoltaic power generation can convert solar energy into electrical energy. A photovoltaic power generation system consists of a solar cell array, a heat-storage system, a charge–discharge controller, an inverter, an AC power distribution cabinet, and a sun tracker. In the wind power generation systems, the wind pushes the blades to rotate and drives the generator to generate electric energy. A wind power generator includes the generator head, the rotating mechanism, the tail, and the blades. Biomass energy refers to the organic matter produced by the metabolism of animals, plants, and microorganisms, as well as the energy-containing biological remains after their death, which are decomposed through aerobic or anaerobic respiration to generate the required heat energy. The biomass power generation methods include direct combustion and gasification and liquefaction of biomass [13].

Economically underdeveloped areas such as rural areas need power sources with low costs and stable supplies that meet primary power quality requirements. Furthermore, these areas have comparatively abundant sunlight and wind energy resources, as well as numerous biomass energy resources. If these resources can be utilized, they can provide stable and continuous electrical energy and reduce power generation costs and environmental pollution [14]. Therefore, promoting new energy in rural areas can solve the electricity problem in remote areas and utilize nearby resources for complementary power generation. However, the power grid projects in rural areas tend to use simple automatic control of machinery and electrical appliances, which cannot effectively utilize the power resources [15]. The IoT of equipment for power transmission and transformation combines the information system of power transmission and transformation equipment with the supervision and evaluation system to transform system intelligence into equipment intelligence. Therefore, IoT is accepted as the technical basis for constructing rural power grids to intelligently control electricity generation, the microgrid transmission of electricity, and the terminal power consumption.

Distributed energy refers to converting solar energy, wind energy, and biomass energy close to users into electrical energy for specific users nearby. The voltage level of its access to the grid is mostly 10 kV and below, and the single installed capacity does not exceed 6 MW. The relationship between distributed energy and power system is: (1) distributed energy supplies energy to users alone. (2) There is an automatic conversion device between them. (3) They are connected in parallel for no power output to the local power grid; (4) They are operated parallel to output electric energy to the local power grid. IoT can identify, process, return, and support strategy information of the networked systems; it uses the network to connect the sensor networks, the core bearer networks, and the hardware platforms constructed by the information service networks [16]. Sensors are divided into sensing nodes and peripheral networks; the core bearer networks can implement primary communication services; the information service networks can process grid information and provide strategic support [17]. The impact of applying IoT technology to new energy power grid construction is explained in Fig. 1.

Fig. 1
figure 1
Construction of the IoT-based new energy power grid

Full size image

The IoT system consists of three layers: perceptual layer, network layer, and application layer. Its combination with the new energy power system is presented in Fig. 2. The perceptual layer is the foundation of IoT. It receives information such as environment, attributes, and states through sensors, wireless communication, and low-power routing devices. The perceptual layer shows the external physical performance of the IoT of the equipment for power transmission and transformation, including power transmission and transformation facilities, sensors, and infrared induction. It collects and processes the operating conditions of the transmission lines [18]. The network layer plays a role in the transmission, communication, and processing of power grid information. It is divided into two types: wired transmission and wireless transmission. These two networking modes are divided into multiple logical subnets to accomplish a rapid and safe network. The application layer consists of the life cycle management system of power transmission and transformation facilities, which monitors the facilities in all directions, understands the operating conditions of the facilities in real-time and warns the outside in the case of a risk.

Fig. 2
figure 2
The architecture of IoT-based smart grid

Full size image

According to the needs of the new energy power grid, IoT technology is employed to transform the various processes of the power grid system into service targets. Sensors that meet power IoT requirements such as current, voltage, temperature, and wind speed are utilized for an accurate collection of power IoT information. Commonly used sensor facilities include current, voltage and power sensors, electricity measurement sensors, and substation operation sensors. The Wireless Sensor Network (WSN) is scattered in the monitoring area of the power system, forming a communication network through self-organization, using multi-hop relay to transmit the information monitored by the sensor to the gateway node, and processing the information in the computer. A WSN includes communication, networking, management, basic services, and application systems. The Wide Area Measurement System (WAMS) can solve the time synchronization problem of the power system. It uses satellite positioning to monitor the power system, including the PMU communication system at the plant station and the control system of the dispatch center.

Grid-connected technology is the key to combining solar, wind, and biomass power generation technologies. The key technology is the inverter and its control. The grid-connected photovoltaic power generation system includes the multi-branch structure, centralized type, serial structure, master–slave structure, Alternating Current (AC) module type, and Direct Current (DC) module type. AC and DC modules are universally used in the small power generation of rural new energy. Therefore, the photovoltaic grid-connected inverter is selected as the new energy grid-connected AC power and input to the grid to convert and control the AC and DC energy.

The new energy power generation technology based on solar, wind, and biomass energy can adapt to various remote terrains and provide safe, reliable, and stable power output. First, various renewable energy sources are converted into electric energy and stored in the battery. The stability of the voltage is adjusted by charging and discharging. The controller energy manages and controls the power supply process to avoid excessive charging and discharging the battery. Inverters can convert DC power into AC power, which can be used by AC loads in the power system. Figure 3 displays the structural diagram of the new energy combined power generation system. When a power generation method is insufficient, the power generation of other energy sources can make up for it. The IoT technology can accomplish informatization monitoring and intelligent control of the new energy power grid.

Fig. 3
figure 3
The structure of the new energy combined power generation system

Full size image

In summary, establishing a distributed power generation grid-connected system of new energy using IoT technology can modularize and visualize the management and information of the new energy power grid. The application status of distributed power generation in practice is fully considered; multiple new energy power generation systems are connected to the grid to improve the applicability of the new energy power generation system in remote areas.

Layered energy storage system design
The accelerated development of energy storage technology provides an adequate solution to power fluctuations during new energy power grid connections. It also improves the operational safety and stability of the new energy power grid [19]. The energy storage system adjusts the power and states of charging and discharging in real-time. Hence, applying it can enable the power system to have excellent peak regulation capabilities, thereby alleviating regional power peaks and reducing the investment and construction of distribution networks [20]. For distributed new energy grid-connected systems, the rural energy storage system can improve the flexibility and stability of power grid operation, make auxiliary adjustments to the frequency of the power system, and achieve the mediation of the regional power grid. The energy storage system can convert the surplus electricity generated by the new energy power generation into other energy forms for storage. It can also convert the stored energy into electrical energy during peak electricity consumption, ensuring the stable operation of the power system, and increasing the grid-connected power generation of the new energy power grid [21]. Battery energy storage technology has the characteristics of large capacity and wide application range, which applies to new energy grid-connected systems. However, in China, research on battery energy storage technology stays in the preliminary stage. Hence, the application of battery energy storage systems in new energy grid-connected power generation requires research and evaluation.

The distributed new energy power generation system has random and volatile output, which will affect the power grid after being directly connected to the distribution network, limiting its capacity to connect to the power grid [22]. Thus, the distributed energy storage system is applied to combine the highly volatile distributed power generation systems, such as solar, wind, and biomass energy. The distributed energy storage system is connected to the key nodes of the distribution feeder to form a unified unit in the power grid. The rapid charge and discharge characteristics of the energy storage system stabilize the volatility of new energy power generation, improve the power output quality of the power supply, and thereby perfect the power quality [23]. The distributed new energy power generation system and the energy storage system are coordinated to effectively control the terminal voltage of the power supply and solve the node voltage increase problem. Using a plug-and-play distributed energy storage system can solve the impact of accessing distributed power sources on the operating state and control strategy of the system [24].

The information model consists of a device model, a logical node model, and a server model. All the functions of the energy storage system are converted into logical nodes, which are regarded as the smallest functional unit for operating the new energy power generation system. These functions are divided according to the principle of functional clustering. In the islanding mode of the new energy microgrid, the distributed energy storage system will act as the main power source to smooth the power fluctuations in the power grid and ensure the stability of voltage operation [25]. Besides, the energy storage system can provide transient power support during the mode switching process of the new energy power grid, thereby reducing the impact on users during the switching of grid connection and island mode and achieving seamless switching. The energy storage system can be centralized or distributed. The centralized energy storage system has a large storage power but consumes a long time; the distributed energy storage system has various forms, easy quantification, and flexible layout. Therefore, the characteristics of the distributed and centralized energy storage systems are combined to design a layered energy storage system to solve the security problem of grid connection of the distributed new energy power generation system [26]. The structure of the designed layered energy storage system is presented in Fig. 4, including a centralized control layer, a convergence layer, and an autonomous layer.

Fig. 4
figure 4
The structural diagram of the layered energy storage system

Full size image

The single-point centralized energy storage station in the layered energy storage system is a centralized control layer composed of multiple sets of energy storage devices. The convergence layer consists of a multi-point distributed energy storage cluster, including more centralized energy storage devices and regional controllers. This layer directly receives the dispatch of the power grid; in contrast, the energy storage devices in the layer do not accept the direct dispatch of the power grid [27]. Once the constraint conditions are met, the scheduling command can be completed below the minute level, and the convergence effect can smooth the power fluctuations. The regional controller can uniformly schedule the connected energy storage devices and externally exhibit the characteristics of a centralized energy storage system [28]. The autonomous layer is a small distributed energy storage device that runs completely autonomously, which can be a backup or emergency power supply. Its power is small, but it can meet the users’ power demands. It uses the communication connection between layered energy storage systems for task scheduling and autonomous priority division [29].

GRA evaluation model based on entropy
Evaluating the comprehensive benefits of the layered energy storage system in the new energy distributed power generation grid-connected system is necessary for developing and applying the new energy distributed power generation grid-connected project. Therefore, the layered energy storage system will be comprehensively evaluated from the aspects of technology, economy, and society.

(1)
Technical specification there are many types of battery energy storage systems, and the performance of different batteries is different. Here, the acid-lead battery, lithium battery, sodium-sulfur battery, and nickel-metal hydride (NiMH) battery are included as the evaluation objects [30]. The selected technical specification indicators are monomer voltage, specific capacity, specific power, charge and discharge efficiency, and cycle life.

(2)
Economic indicators the economic indicators aim at maximizing the interests of operators and analyse the system from two perspectives of cost and benefit. Evaluation indicators include battery storage cost, equipment cost, operation and maintenance cost, grid-connected power generation revenue, and end-of-period payback benefits [31, 32].

(3)
Social indicators the social indicators analyse the fundamental social benefits brought by the new energy power generation project. The evaluation indicators include delayed grid construction, reduced system backup capacity, and energy-saving and emission reduction benefits [33]. Figure 5 shows the established comprehensive evaluation indicator system for the layered energy storage system of the new energy distributed power generation system.

Fig. 5
figure 5
Evaluation indicator system of the layered energy storage system

Full size image

The entropy weight is a method of objective weighting based on the variability of the indicator. The smaller the information entropy, the greater the degree of variation of the indicator, the more information it contains, and the greater the role it plays in the evaluation; on the contrary, the smaller the function of the indicator, the smaller the weight [34]. GRA is a method of judging the degree of factor correlation based on the geometrical similarity of each factor’s variation curve. The gray correlation degree between the reference series and the comparison series is obtained by comparing the set relationship of time series data in the system. Therefore, the dynamic development process of the system is quantitatively analyzed [35]. The original observations of the evaluation indicator undergo dimensionless processing. Then, the correlation coefficient, correlation degree, and the ranking of the evaluation indicator are calculated to obtain the qualitative analysis results. This method has no dependence on sample size, and the results of qualitative analysis are in line with the actual situation. Hence, it has been widely used [36].

The entropy weight method is employed to determine the weight of each evaluation indicator to improve evaluation accuracy. The data of each indicator are compared through the GRA to obtain the comprehensive evaluation results of different types of battery energy storage systems. This method can fully utilize the gray information in the evaluation data to obtain qualitative and quantitative evaluation results [37, 38]. The detailed calculation process is:

(1)
The evaluation indicator matrix is determined: assuming that there are m evaluation indicators and n evaluation objects, the initial evaluation indicator matrix A = (aij)m×n is obtained. The matrix is then normalized and dimensionless, and the linear dimensionless method is selected to process the data. The equation is:

(2)
The maximum and minimum difference sequences are calculated: assuming that the processing result of the i-th indicator is Yi = (yi1, yi2, …, yin)T, then the optimal sample is constructed as the identity matrix, and the following can be obtained:


 

(2)

The maximum difference sequence is calculated:


 

(3)

The minimum difference sequence is calculated:


 

(4)

(3)
The correlation coefficient is calculated:


 

(5)

where ξ represents the correlation coefficient.

(4)
The weight wj is calculated:

where Hj represents entropy weight.

(5)
The correlation r0i between the evaluation object and the ideal sample is obtained as:

The greater the correlation degree, the closer the evaluation object is to the ideal sample, and the better the comprehensive evaluation result. All the evaluation objects are ranked accordingly.

Simulation experiments are performed on the DIgSILENT PowerFactory platform for the 10 kV/0.4 kV distributed network under the IEEE standard 28-node system. The rated capacity of distributed batteries is 40 kW/h, and the upper and lower limits of State Of Charge (SOC) are 95% and 20%. The battery energy storage system uses Controller Area Network (CAN) connection and SAEJ1939CAN network protocol. The power adjustment system uses RS485 network connection and Modbus TCP protocol for communication. The data acquisition system uses the IEC60870-5-104 protocol for communication [39]. The distributed network of a neighborhood is taken as an example. The designed hierarchical energy system is added to the district power system for field tests, and power data changes during the experiment are collected as the experimental dataset.

Results and discussion
Application effect analysis of energy storage system
Applying the energy storage system improves the operational stability of the new energy system, dispatches the electricity consumption of the power grid, and optimizes the electricity bills of users during peak periods. The usage of terminal power grids of four users in different industries is analyzed, and the results are displayed in Fig. 6.

Fig. 6
figure 6
User load status and utilization of the layered energy storage system

Full size image

As shown in Fig. 6, the maximum load of different users under the original load condition is above 860 kW. After the hierarchical energy storage system is adopted, the maximum energy storage load is about 30% more efficient than the original state. The maximum shared load of multiple energy storage is 860kw, less than the electricity consumption in a single user situation, and the shared utilization rate of multiple energy storage is above 50%. Under the optimized condition of single energy storage, the electricity cost of stratified energy storage can be saved by about 8%. The electricity cost of stratified energy storage system under the multi-energy storage mode can be saved by more than 10%. Therefore, compared with the traditional power supply method, after users join the hierarchical energy storage system, the utilization rate of the energy storage system and the electricity usage of a single user can be optimized [40]. The reason is that the energy storage system can adjust the operating state of the power system through task scheduling. Thus, the maximum load of the power system is significantly reduced, which effectively improves the safety and stability of the power grid and alleviates the overloaded power supply of the new energy grid during peak hours. To sum up, the hierarchical energy storage system can improve the power utilization rate of new energy power generation, save the use of power, improve the user power experience, and provide a stable guarantee for rural power construction in remote areas.

Results of GRA
The comprehensive evaluation datasheet of applying each energy storage system in new energy power generation is obtained by consulting relevant research materials and combining with the practical data of the energy storage system, in an effort to comprehensively evaluate the energy storage system based on acid-lead battery, lithium battery, sodium-sulfur battery, and NiMH battery. Then, the data undergo normalization and dimensionless processing. The results are illustrated in Fig. 7a and b. The calculation result of the correlation between the evaluation object and the ideal sample combined with the comprehensive evaluation data is shown in Fig. 7c.

Fig. 7
figure 7
Comprehensive evaluation results and correlation of energy storage system (a and b represent the dimensionless comprehensive evaluation result, and c represents the calculation result of correlation degree)

Full size image

Figure 7 compares the cell voltage and specific power. The lithium battery has the highest cell voltage and specific power, and its specific capacity is second only to the sodium-sulfur battery, reaching 0.67. Although the charging and discharging efficiencies of lithium batteries are lower than that of acid–lead batteries and sodium–sulfur batteries, lithium batteries have the greatest cycle life and can provide a more long-lasting power supply state. Compared with other batteries, lithium batteries require lower equipment, operation, and maintenance costs and have the highest end-of-term recovery benefits. Hence, they are suitable for large-scale applications. Compared with other energy storage batteries, the lithium battery has the highest comprehensive evaluation result, with a correlation value of 0.89, followed by sodium-sulfur batteries, acid-lead batteries, and NiMH batteries. These results are consistent with the development status of the energy storage battery industry. Through experiments, lithium batteries are proved to possess the advantages of a short construction period, strong performance, and low cost, which can effectively solve the intermittent and instability of new energy power generation and improve the electricity experience of users in remote areas. The comprehensive evaluation data demonstrate a mutual substitution effect between battery energy storage systems, and their external benefits are equivalent. However, due to the differences in the technology and input costs of different energy storage systems, lithium battery-based energy storage systems have the potential for large-scale commercial applications only from an economic point of view. In future, the development of new battery technologies can promote the application potential of battery energy storage systems in new energy power generation [41].

Conclusion
A distributed new energy power generation system based on IoT technology is established to solve the power supply problems in remote areas. As a three-layer structure, this distributed new energy power system includes a perceptual layer, a network layer, and an application layer, which can perceive the operating states of the power system and communicate with it. Second, the solar, wind, and biomass power generation systems are connected to the power grid using grid-connected technology for a continuous and stable power supply. The energy storage system used by the grid-connected system is designed to be layered based on the information model, and the communication connection between the layered energy storage systems is utilized for task scheduling. Finally, the battery energy storage system is comprehensively evaluated by the GRA [42]. The experimental results reveal that introducing the layered energy storage system can efficiently reduce the peak load conditions and improve the safety and stability of the new energy power system. The comprehensive evaluation of the energy storage system shows that the lithium battery energy storage system has better application potential than other batteries. However, there are some limitations in the present work. While designing and evaluating the distributed new energy power generation system, the operation process between the power generation system and the energy storage system has not been optimized to reduce the new energy consumption during transmission. Therefore, the transmission loss of electric energy in the layered system will be studied and optimized in the following work.