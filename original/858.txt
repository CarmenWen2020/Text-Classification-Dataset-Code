Proof-of-work (PoW) cryptocurrency blockchains like Bitcoin
secure vast amounts of money. Their operators, called miners, expend resources to generate blocks and receive monetary rewards
for their effort. Blockchains are, in principle, attractive targets for
Denial-of-Service (DoS) attacks: There is fierce competition among
coins, as well as potential gains from short selling. Classical DoS
attacks, however, typically target a few servers and cannot scale
to systems with many nodes. There have been no successful DoS
attacks to date against prominent cryptocurrencies.
We present Blockchain DoS (BDoS), the first incentive-based DoS
attack that targets PoW cryptocurrencies. Unlike classical DoS,
BDoS targets the system’s mechanism design: It exploits the reward
mechanism to discourage miner participation. Previous DoS attacks
against PoW blockchains require an adversary’s mining power
to match that of all other miners. In contrast, BDoS can cause a
blockchain to grind to a halt with significantly fewer resources,
e.g., 21% as of March 2020 in Bitcoin, according to our empirical
study. We find that Bitcoin’s vulnerability to BDoS increases rapidly
as the mining industry matures and profitability drops.
BDoS differs from known attacks like Selfish Mining in its aim
not to increase an adversary’s revenue, but to disrupt the system.
Although it bears some algorithmic similarity to those attacks, it
introduces a new adversarial model, goals, algorithm, and gametheoretic analysis. Beyond its direct implications for operational
blockchains, BDoS introduces the novel idea that an adversary can
manipulate miners’ incentives by proving the existence of blocks
without actually publishing them.
CCS CONCEPTS
• Security and privacy → Distributed systems security; • Applied computing → Digital cash.
KEYWORDS
Blockchain; Bitcoin; Cryptocurrencies
1 INTRODUCTION
Cryptocurrencies implemented with blockchain protocols based
on Nakamoto’s Bitocoin [88] have a current market capitalization of
about $200B [29]. Like classical state machine replication protocols,
blockchains allow participants to agree on a state—in their case, the
client balances of a cryptocurrency. Unlike those classical protocols,
however, public blockchains are decentralized and allow anyone to
join the system at will.
To deter Sybil attacks [41], where an attacker masquerades as
multiple entities, Nakamoto relies on incentives. Participants, called
miners, expend resources and generate Proofs of Work (PoW) [42,
60]. They are rewarded with cryptocurrency for their efforts. Miners
aggregate cryptocurrency transactions into so-called blocks, that
also contain PoW. The blocks form a tree data structure, and a path
in the tree is called a blockchain. The path representing the most
work is called the main chain; its contents define the system’s state.
An extensive line of work (§2) explores revenue-driven attacks
against blockchains [45, 46, 68, 89, 102]. But DoS attacks, where
the attacker is driven by exogenous incentives to stop a cryptocurrency blockchain, have received less attention. This may be because
classical, network-based DoS attacks [40] do not scale to large decentralized systems; known mining-based DoS attacks [16, 17, 67]
are prohibitively costly, as they require the attacker’s mining resources to be at least equal to those of all other miners combined.
In this work, we present a new type of sabotage attack called
Blockchain Denial of Service (BDoS). BDoS is incentive-based: The
attacker targets the system’s mechanism design and violates its
incentive compatibility. Specifically, the attacker invests resources
in order to incentivize rational miners to stop mining. A BDoS
adversary can cause a blockchain to cease functioning with only a
fraction of the resources of the other miners. It is the first incentivebased DoS attack of which we are aware.
The key element that enables BDoS is the consideration of miner
behavior (§3) that was typically overlooked in previous work. First,
miners can stop mining intermittently if it benefits them, as demonstrated empirically [28, 43, 69]; the majority of previous work assumes a static number of miners, i.e., miners always mine. Like
prior work [23, 43, 116], we consider miners that do not venture on
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 601
more elaborate strategic behavior [46, 89, 102], which indeed has
not been observed in the wild.
Secondly, an attacker can signal to the miners that the system
is in a state that reduces their revenue. Specifically, an attacker
can generate a block and publish only a proof that she mined it,
proving that she has an advantage over other miners, but without
exposing the block’s content. A natural candidate for such a proof
is the block header. The profit of a rational miner decreases if she
is not aware of the proof or ignores it, and therefore it is in her
best interest to receive it (actively or passively). Similar behavior,
where miners change their mining strategy as a result of external
data, has been observed in practice [28, 43, 69]. Therefore, miners
are expected to adapt in order to accept block header publication,
even if currently this is not a standard publication method. Ignoring
the block header is not an effective defense strategy as a miner is
incentivized to defect from this countermeasure strategy to increase
her payoff even at the expense of the common good. This situation
is commonly referred to as tragedy of the commons, or n-person
prisoner’s dilemma [99].
The crux of the BDoS attack (§4) is as follows. The attacker
generates a block BA and publishes only its header (fig. 1b); we
then say the attack is active. A miner can ignore the existence
of the header of BA and generate a block following its parent,
resulting in a fork (fig. 1c). In this case, the attacker publishes the
contents of BA, resulting in a race with two branches (fig. 1d).
The miner’s block might or might not end up in the main chain,
depending on the parameters of the system. The implication is that
the expected profitability of the rational miners decreases, and if it
is low enough, then pausing mining becomes a better option than
mining. If the profitability decrease is significant enough so that all
miners stop mining, the attacker can cease mining as well, while
she has an advantage of one block (BA). The blockchain thus grinds
to a complete halt.
We formulate the behavior of the miners as a game and look for a
dominant strategy (§5). The attack is successful when not mining is
the best response of the miners. Success depends on several factors,
mainly the sizes of the attacker and rational miners and the baseline
profitability of mining. One might think that non-myopic miners
invested in the success of the system would be willing to suffer a
temporary profitability decline to overcome an attack and keep the
blockchain running. However, we find that this is not so: If other
miners behave altruistically and ignore the attack, a rational miner
has an even stronger incentive to stop mining when the attack is
active.
We consider several extensions of the action space. First, in practice, miners can mine on block headers, performing so-called SPV
Mining. This action behavior is performed in practice by otherwise
benign miners to slightly reduce latencies [97]. To overcome SPV
mining we updated the attack (§6) as follows. If a rational miner
successfully mines a block that extends the attacker’s published
header, the attacker abandons this header and never publishes its
content, effectively invalidating the rational miner’s block. We analyze the new game using iterated elimination of strictly dominated
strategies (IESDS) [47], and show that stopping mining remains an
equilibrium with the same parameters.
Secondly, we observe that the situation becomes significantly
worse if miners have the option to use their resources in another
blockchain rather than stop (§7). If two cryptocurrencies have similar baseline profitability, even a small BDoS attacker can tip the scale
and lead rational miners to defect from the attacked cryptocurrency
to the now-more-profitable one.
Thirdly, we propose techniques for the attacker to prove she
has a hidden block without exposing its header, making mitigation
even harder (§8).
To empirically validate the practicality of BDoS, we calculate
profitability in the longest-running cryptocurrency, Bitcoin. We
combine mining difficulty data with mining hardware consumption
and power, historical Bitcoin price fluctuation, and electricity costs.
For example, as of March 13, 2020, given that the miners in Bitcoin
have a $1.47 expected return on every $1 of electricity investment,
an attacker with 21% of the mining power can successfully stop
all rational miners. The instantaneous 50% drop in block reward
(and thus profitability) that took place in 2020 [10] caused Bitcoin’s
security to be in even greater risk. Moreover, since the profitability
of Bitcoin and Bitcoin Cash are almost identical [69, 113], the twocoin model implies that BDoS poses an imminent threat for both.
Constructively, we propose some possible mitigations to
BDoS (§9). First, honest miners can prefer non-attacker blocks
on a fork with a heuristic time-based detector. Secondly, alternative reward mechanisms [22, 123] compensate miners on lost races,
making BDoS ineffective (though similar attacks might apply).
The discovery of BDoS adds another consideration for the evaluation of blockchain systems and raises questions on the existence
of similar attacks against different blockchain designs (§10).
In summary:
• We introduce and explore new, practical actions in the action
space of adversaries and miners.
• We initiate the first formal study of a mechanism-based DoS
attack on PoW blockchains called Blockchain Denial-of-Service.
• We formalize a game between rational miners due to a BDoS adversary and show when the dominant strategy is to stop mining.
• We consider several extensions to the basic BDoS action / strategy
space, including SPV mining, mining on other blockchains, and
different methods of proving the existence of a mined block. We
show that SPV mining doesn’t help, and the other two strengthen
the attack.
• We empirically study BDoS attacks in Bitcoin, showing that under reasonable assumptions, a BDoS attacker can succeed with
roughly 21% mining power as of March 2020.
• We propose mitigations that can reduce the effectiveness of BDoS.
Responsible disclosure We have completed a disclosure process
with prominent blockchain development groups.
2 RELATED WORK
To the best of our knowledge, this work is the first to study
incentive-based denial of service attacks against blockchains. We
present an overview here of previous work on denial-of-service
attacks in the context of blockchains, incentive-related behavior,
and other related work.
DoS Denial-of-Service (DoS) attacks [40] aim to prevent a system
from serving clients, and are often mounted from multiple machines as Distributed DoS (DDoS) attacks. In blockchain networks,
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 602
however, such techniques can only successfully target isolated system elements [61, 87, 118, 124] like cryptocurrency exchanges or
mining coordinators in pools. In eclipse attacks [24, 106, 107] an
adversary monopolizes all connections of a target node and isolates
it from the network. When applied to blockchain systems [56, 76],
the victim’s local view is no longer in sync with the network, disrupting the victim and amplifying other blockchain attacks [89].
Similar effects can be achieved with routing attacks, chiefly BGP
hijacking [4, 5, 114]. However, due to the decentralized structure
of the system, nodes outside the effect of the attack can continue
to interact with the blockchain as usual, apart from the possible
reduction of attacked mining power. In contrast, BDoS stops all
blockchain progress if other miners are rational.
Other attacks [72, 85, 86] saturate the blockchain to prevent
transactions from being placed. Such attacks, however, result in
graceful degradation, as the attacker simply raises the cost of transaction writes. Clients can still place transactions, albeit with a
higher fee, thus also increasing the attacker’s cost. Additionally,
unlike BDoS, such attacks require continuous resource expenditure
for the duration of the attack.
Majority (51%) attacks A 51% attack allows a miner that controls
the majority of the mining power in the system to fork any section
of the chain. She can mine on an old block and eventually build a
longer chain than any minority competitors (even if the competitors
have a significant head start). An attacker controlling a majority
of the mining power violates the assumptions of PoW protocols
and can perform a full-fledged DoS attack by simply generating
empty blocks and ignoring other blocks. Since this is a majority
attacker, her chain will extend faster than any other chain, making
it the main chain, despite its empty content. An attacker with
such power can also perform other attacks violating the system’s
safety properties. Goldfinger and bribery attacks [16, 17, 67, 73, 79,
115] utilize miner bribery to achieve similar effects, only without
requiring the attacker to acquire mining power directly. Majority
attacks have been observed in smaller cryptocurrencies [18, 38, 57],
but not in major ones, possibly due to their high continuous cost. In
contrast to this family of attacks, BDoS requires significantly lower
than 50% mining-power budget, and no continuous expenditure.
Revenue-seeking deviations Nakamoto blockchains’ security
relies on an incentive mechanism that rewards miners that follow
the rules. One line of study [8, 65, 77, 89, 91, 98, 102] considers
incentive compatibility of blockchain protocols. It analyzes mining
as a game, showing when the correct behavior is an equilibrium,
and when deviations allow miners to increase their revenue. Such
attacks may bias the mining power structure, leading to centralization, or affect other desired blockchain properties like censorship
resistance. However, their goal and analysis consider only the internal system revenue, but not exogenous malicious motivations,
and they cannot be directly applied to achieve denial of service.
Goren and Spiegelman [52] show that a miner can increase her
revenue by mining intermittently. Unlike BDoS, this is a revenue
seeking attack, only the attacker stops mining, and she is not manipulating the behavior of other miners.
Several incentive attacks can affect individual mining pools [45,
68, 71, 74, 100], but not directly lead to macro effects on blockchains.
Incentive-based attacks Another line of work explores attacks
that use incentives to affect blockchain properties, using a form of
bribery. Judmayer et al. [63] categorize incentives attacks by their
goals into three groups: transaction revision, transaction ordering,
and transaction exclusion. These attacks may not violate protocol
safety directly, but can be used to force a particular order of transactions [33, 44, 103], or transaction omission [62, 79, 82, 122]. They
do not affect the system liveness.
Non-Nakamoto blockchains The BDoS attack is designed specifically for Nakamoto-like blockchains. Nakamoto-like protocols with
alternatives to PoW [25, 26, 120, 121, 125] are equally vulnerable.
On the other hand, it does not directly apply to the Ethereum
blockchain (that is more vulnerable to other attacks [91, 98],
though), where blocks receive partial rewards even if they are off
the main chain, so in case of a BDoS header publication, it’s better
for a participant to keep mining, getting at least a partial reward.
PoW alternatives such as Proof of Stake (PoS) [7, 34, 36, 51, 66]
do not require participants to waste significant resources to approve
transactions. Thus BDoS is not relevant to PoS in general. However,
Buterin [21] introduced the so-called Discouragement Attack on
PoS, where an attacker reduces the profit of other participants by
censoring victims’ messages, leading to a temporary DoS.
3 MODEL
We describe the system model (section 3.1), namely the participants, their interaction, and network assumptions, and the resultant
game model (section 3.2), namely the miners’ action space and utility function.
3.1 Mining Model
We model the system similarly to previous work [49, 83, 95]
using common network assumptions [46, 89, 102]. However, we
define an additional capability of the attacker. She can publish a
proof that a block was mined, without publishing its content.
Blockchain data structures The system constructs a data structure called the blockchain, which is a a linked list of blocks. A block B
contains block data or payload, denoted by D, and metadata called
block header, denoted by H. Thus, a block is a pair B = (H,D). Each
block header contains a hash reference to another block, except the
so-called genesis block which we denote by B1.
The blockchain is the main data structure in the system, and it defines the state of the cryptocurrency. Each block B in the blockchain
is either a full block containing the entire block information (H,D),
or a block header without the block data (H, ⊥) where ⊥ denotes
the lack of data. The fact that the blockchain can consist of partial
block information is a refinement of our model compared to previous work [8, 46, 49, 83, 89, 91, 95, 98, 102], where a blockchain
consists only of full blocks.
Participants We consider a system that comprises n participants
called miners, denoted by P1, P2, . . . , Pn, and an adversary A. Each
miner Pi has an associated value αi called its mining power, and
the adversary A has mining power αA. The total mining power
is normalized to 1, αA +
Ín
i=1
αi = 1. Each miner has a public key
known to all that allows her to prove her identity to other miners
using a private key.
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 603
Each rational miner Pi possesses a view of the blockchain Li
locally. L
Full
i
is the subset of Li that consists only of the full blocks
in Li – i.e. blocks of the form (H,D) where D , ⊥.
Pi also has a local order function Oi
: L
Full
i →
n
1, . . . ,



L
Full
i



o
.
This function indicates the order of full blocks in Li observed by
miner Pi
. Note that Oi
is not defined for blocks not in L
Full
i
, i.e.,
partial blocks of the form (H, ⊥). For all Pi ∈ {P1, P2, . . . , Pn } it
holds that Oi(B1) = 1, that is, all miners agree that the genesis
block is the first block. Different miners may have different order
functions depending on the order they received their full blocks.
We call a path in the block tree consisting of full blocks a chain.
The longest chain of full blocks in Li represents the state of the
system from miner’s Pi perspective and is called the main chain.
If there are multiple longest chains, Pi considers the chain she
observed first as the main chain, i.e., the chain whose last block B
has the smallest Oi(B) value.
Rushing We denote by γ the strength of A’s rushing ability [46,
89, 102]. That is, if A publishes a block to compete with a newly
published block by some other miner Pi
, γ is the expected ratio of
rational miners that adopt A’s block. The remaining (1 −γ ) are the
miners that adopt Pi
’s block. Throughout the paper we consider
mostly γ =
1
2
in our examples, as, e.g., in [46, 102]. Ethereum
developers even took measures to fix γ =
1
2
[1], as they considered
γ >
1
2
to be achievable by potential selfish miners. Nevertheless,
our results and most charts are generalized for any 0 ≤ γ ≤ 1.
Scheduler The system progresses in rounds, orchestrated by a
scheduler. On each round, the scheduler selects a miner to generate
a new block. Messages are delivered immediately, and the system is
synchronous. The pseudo-code of the scheduler is in Appendix E.
Each round has a duration. We denote by λ a system constant
called the round rate constant. It corresponds to the desired round
rate (average number of rounds per second) in the blockchain. For
instance, in Bitcoin λ =
1
10·60 s
−1
, thus a block is created on average
every 10 minutes.
In the beginning of each round r, the scheduler asks each miner
whether she participates as a candidate to find a new block during this round. We say that a participating miner is active in this
round. The scheduler also records the so-called block template of
each active miner, which includes the miner’s identity (using her
public key) and the hash of the block it extends. Then the scheduler
chooses a miner to mine the next block from the set of active miners by a weighted random distribution. Each miner’s probability
to be chosen is proportional to her mining power. The selected
miner can create a block in round r and is called the winner of the
round, we denote it by wr . We index the blocks B = {B1, B2, . . . }
by the order of their issuance, i.e., wr creates block Br . We denote
by α
r
active the total mining power of active miners in round r. The
scheduler determines the duration of the round, using an exponential distribution with rate λ · α
r
active. Note that we do not consider
difficulty adjustment unless otherwise stated; thus, the expected
block generation time in a round is 1
λ·α
r
active
. If all the miners are
mining during a round r (i.e., α
r
active = 1), which we call the honest
setting, it holds that the exponential distribution of the duration of
round r has a rate of λ.
Next, the scheduler adds the partial or full block to the private
ledgers of all miners. It treats the cases of an adversarial winner and
a rational winner separately. If the adversary A wins, she decides
whether to publish the full block of Br or only the block header.
She then announces her decision to the scheduler. Receiving the
adversary’s decisions, the scheduler adds to the private ledgers of
the other miners either the full block or the block header of Br .
If a rational miner Pi wins, the scheduler first notifies the adversary A of Br . The adversary decides whether to race against Br .
If she decides to race, she sends the full block that corresponds to
a previously withheld block. Otherwise, the adversary sends an
empty message. If the message is empty, the scheduler simply broadcasts Br to all miners. Otherwise, the scheduler sends Br and A’s
competing blocks in different orders to different miners, to simulate
the connectivity factor γ : For each miner p ∈ {P1, ..., Pn } \ {wr },
with probability γ (1−αA )
1−αA −αwr
the scheduler sends A’s competing
blocks first and then Br to p, and with probability 1 −
γ (1−αA )
1−αA −αwr
it
sends Br first and then A’s blocks.
3.2 Game-Theoretic Model
The system model gives rise to a game played among the rational
miners given the adversary’s behavior.
Players The players are the miners where each rational miner Pi
possess a mining power αi
. Each miner knows the adversary’s
attack protocol.
Utility For each miner Pi we denote by Πi(t), Ri(t), and Ci(t) her
expected profit, revenue, and cost until time t, respectively. It holds
that: Πi(t) = Ri(t) − Ci(t). We denote the average revenue and cost
per time unit, for Pi by Rˆ
i =
∆
lim
t→∞
Ri (t)
t
and Cˆ
i =
∆
lim
t→∞
Ci (t)
t
respectively. Consequently, the average profit per time unit, for Pi
,
is: Πˆ
i =
∆
Rˆ
i −Cˆ
i
. Note that any one-time cost is negligible when we
discuss an infinite-horizon game.
For simplicity, we assume that the coin’s real value is constant
during the entire game, and denote the per-block mining reward
by K. We ignore the effect of varying transaction fees, since the
transaction fee is typically negligible [14] and does not change the
results significantly. Different miners may mine at different electricity costs, but we assume that the cost does not change throughout
the game. Thus, we do not consider the difficulty adjustment. This
assumption is reasonable in Bitcoin and other cryptocurrencies
where the difficulty adjustment happens infrequently. Therefore,
A can choose the timing of the attack to be long before the next
difficulty adjustment.
The cost of miner Pi per one second of mining is αici
,
where ci
is the normalized mining cost per second for Pi
. Therefore, when there is no attack, the expected profit per time unit
is Πˆ b
i
= αi(λK − ci).
In order to define the utility function, we normalize the expected
profit by the miner’s mining power. The utility function U of Pi
is
thus: Ui =
∆ Πˆ
i
αi
.
We conclude that the utility of the rational miner Pi during an
honest game (with no attack) is:
U
b
i =
∆
λK − ci
. (1)
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 604
We also define the profitability factor ω
b
i
for miner Pi participating
in an honest game. The profitability factor is the return per dollar
investment for a miner in an honest game:
ω
b
i =
∆
lim
t→∞
Ri(t)
Ci(t)
=
λK
ci
. (2)
We note that U
b
i
> 0 implies ω
b
i
> 1 and U
b
i
< 0 implies ω
b
i
< 1.
Actions We consider miners that are rational, meaning that they
do not participate in the game when it is not profitable. The miners
are trying to maximize their profit within the protocol rules, with
the ability to exit the game – i.e. stop mining. Specifically, each
rational miner has two possible actions:
(1) mine - Mine on the main chain, or
(2) stop - Stop mining.
A miner chooses an action at the beginning of a round by notifying
the scheduler. Note that switching the action within the round does
not make sense, since no new information is available to Pi during
a round. The elapsed time does not provide any new information
due to the memorylessness property [102, 116]. This is formally
justified in Appendix A.
Note that if there is no attack and ω
b
i
> 1, the rational miner
always chooses mine and if ω
b
i
< 1 she chooses stop.
In case the adversary releases a block header, a rational miner
has to choose one of the two actions. The pseudocode that describes
the rational miner’s possible actions is in Appendix E.
4 THE BDOS ATTACK
The BDoS attack aims to incentivize rational miners to stop mining. The crux is that an attacker (A) can bring the system to a state
where if a rational miner Pi chooses mine and finds a block BPi
, A
can invalidate BPi —with some probability. Thus, while Pi
incurs
the same cost for performing mining (including electricity and other
varying costs) as in the honest game, there is a smaller probability
that Pi would see any reward for her investment.
We now describe the strategy, which is illustrated in fig. 1. Denote
by B
∗
the latest block on the main chain. A’s attack algorithm is to
mine on B
∗
(fig. 1a). If she successfully appends a new block BA =
(HA,DA) to B
∗
, rather than publishing BA in full, she publishes
only its header (HA, ⊥). She withholds the rest of the block, namely
its associated transactions. At this point, we refer to the state of
the attack as active. We refer to BA as the leading block. BA is not
part of the main chain, as it has not been published in full (fig. 1b).
The header of BA serves as a proof that A has successfully
mined BA and is currently withholding the full block. Until another
miner produces a new block, A stops mining completely. If all
other miners also stop, the system thus reaches a standstill. But
if at least one miner performs mine it would eventually generate
a block BPi
appended to B
∗
(fig. 1c). In this case A immediately
publishes BA in full, i.e., attempts to add it to the main chain. A race
ensues as describe in §3: Mining power is now divided between BPi
and BA (fig. 1d). The first block to be extended “wins” the race and
becomes part of the main chain.
The effect of the attack on Pi
’s actions depends on the values of
the system parameters ω
b
i
, αi and αA. The pseudocode for BDoS
is in Appendix E.
5 ANALYSIS
If stop is the best response for all miners, we say the attack is
successful as it achieves a complete shutdown of the system. If stop
is best for some miners, we say BDoS is partially successful as it
only slows the blockchain’s progress, leading a partial shutdown.
5.1 Game-Theoretic Analysis
We now derive the possible strategy space for a rational miner.
We analyze the game as an infinite-horizon game where the miners
play indefinitely [46, 110]. This applies although the cryptography
in the Nakamoto consensus breaks in an infinite game – as we
analyze an ergodic process, the average utility over infinite time
is similar to the average utility of finite games. Therefore, we are
interested in the expected profit per second of the miners that would
allow us to compare different strategies. In order to calculate it,
we construct a Continuous-Time Markov Chain for each strategy.
Unlike previous analysis of similar games [46], the block creation
rate varies when the attack is active/inactive, and therefore our
system cannot be described with a discrete-time Markov chain.
The Markov chains allow us to compute the utility function for
each strategy as a function of the other players’ strategies. We
analyze the conditions for a specific strategy (that corresponds to
stop mining) to be the dominant strategy by comparing its utility
to other strategies given the same choice of the other players. The
analysis in this section assumes that ω
b
i
> 1 for all Pi
, i.e., honest
mining is profitable for all players in the absence of an attack.
Strategies We evaluate the strategies from the perspective of a
rational miner Pi
. We denote by ΛB∗ the set of miners actively
mining on B
∗ while the attack is active. Next, we define αB∗ to be
the hash rate of all miners in ΛB∗ . Given the attack algorithm BDoS
and honest game profitability ω
b
i
, our goal is to find an optimal
strategy for Pi which she chooses at the beginning of the game,
i.e., a map from the private ledger Li and the order function Oi
to an optimal action. We say that strategy S1 is more beneficial
than strategy S2, for a rational Pi
, if the utility by playing S1 is
larger than the utility by playing S2. We assume that ω
b
i
> 1 (as
for ω
b
i
≤ 1 no rational miner mines). Therefore, a rational miner
always chooses action mine when the attack is not active. We prove
this intuitive claim in Appendix B. Consequently, we consider only
two strategies, Smine and Sstop, that differ by the actions of Pi
during the attack: mine and stop, respectively. We describe the
game for each strategy with a three-state Markov chain. Strategy
Smine appears in fig. 2a and Sstop in fig. 2b. In both chains, state 0
represents the initial state where everyone mines on B
∗
(fig. 1a).
State 1 represents the state where the adversary managed to find
a block (fig. 1b). State 2 represents the race condition, where the
miners are divided between A’s block and the block generated by
a rational miner (fig. 1c). In both strategies, Pi chooses the action
mine when not in state 1 (when the attack is not active).
State Probabilities We denote Pi
’s strategy by S. We can express αB∗ as a function of S:
αB∗ (S) =
∆

αB∗ + αi
, if S = Smine
αB∗ , otherwise. (3)
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 605
B
∗
(a) State 0
B
∗ BA
(b) State 1
B
∗ BA
BPi
(c) State 2
B
∗ BA
BPi
(d) Race
Figure 1: States
0 1 2
λ · αi
λ · (1 − αA − αi)
λ · αA λ · αB∗
λ · αi
λ · (αA +γ (1 − αA))
λ · (1 −γ )(1 − αA)
(a) Smine: Pi mines on B
∗
in state 1
0 1 2
λ · αi
λ · (1 − αA − αi)
λ · αA λ · αB∗
λ · (αA +γ (1 − αA))
λ · (1 −γ )(1 − αA)
(b) Sstop: Pi stops mining in state 1
Figure 2: Markov chains
We proceed to calculating the state probabilities of the two
Markov chains in fig. 2:
p
S
0
=
αB∗ (S)
αA · αB∗ (S) + αA + αB∗ (S)
,
p
S
1
=
αA
αA · αB∗ (S) + αA + αB∗ (S)
,
p
S
2
=
αA · αB∗ (S)
αA · αB∗ (S) + αA + αB∗ (S)
.
(4)
Note that miner Pi changes the state probabilities depending on
which strategy she chooses, as αB∗ (S) depends on Pi
’s strategy.
Utility For Each Strategy As the first step in calculating the
utility, we calculate the cost and the revenue of Pi
. While a rational
miner is mining, her cost per second is constant. However, when
she stops mining, her cost per second is zero. Therefore for Sstop it
holds that the average cost per time unit Cˆ
Sstop
i
for Pi
is:
Cˆ
Sstop
i
= lim
t→∞
C
Sstop
i
(t)
t
= αi(1 − p
Sstop
1
) ·ci
.
On the other hand when Pi chooses strategy Smine and therefore
keeps mining all the time, her cost Cˆ
Smine
i
is constant:
Cˆ
Smine
i
= lim
t→∞
C
Smine
i
(t)
t
= αi
·ci
.
Therefore, to find the more beneficial strategy, it is left to find the
average revenues Rˆ
Sstop
i
and Rˆ
Smine
i
for Sstop and Smine respectively.
We now analyze the Markov chain: For both strategies the rational miner Pi receives profit K every time she passes from state 0
back to state 0 with the rate αiλ and from state 2 to 0 with rate αiλ.
For strategy Smine, Pi receives profit (1 −γ )(1 − αA) · K when she
passes from state 1 to state 2 with rate αiλ. Therefore the expected
utility for strategy Sstop is:
U
Sstop
i
=
1
αi
(Rˆ
Sstop
i
− Cˆ
Sstop
i
) (5)
=
1
αi
· ((p
Sstop
0
+ p
Sstop
2
) · αiλK − (1 − p
Sstop
1
) · αici)
= (p
Sstop
0
+ p
Sstop
2
) · λK − (1 − p
Sstop
1
) ·ci
.
Similarly the expected utility for strategy Smine is:
U
Smine
i
=
1
αi
(Rˆ
Smine
i
− Cˆ
Smine
i
)
= (p
Smine
0
+ p
Smine
2
+ (1 −γ )(1 − αA) · p
Smine
1
)λK − ci
.
(6)
Conditions for Successful Attack We intend to calculate for
what values of ω
b
i
(defined in eq. (2)) the attack would be successful
given αA and αi
, i.e., the mining power of the attacker and a certain
rational miner Pi
. Note that in order for this attack to enforce
complete shutdown, we have to examine the miner with the largest
mining power. Using eq. (5) and eq. (6) we define D(αB∗ ) to be the
normalized difference between U
Sstop
i
and U
Smine
i
:
D(αB∗ ) =
∆
U
Sstop
i
− U
Smine
i
ci
= (p
Sstop
0
+ p
Sstop
2
− p
Smine
0
− p
Smine
2
− (1 −γ )(1 − αA) · p
Smine
1
) · ω
b
i + p
Sstop
1
.
(7)
Our goal is to find when the attack is successful and all miners stop,
that is, what are the ω
b
i
values for which for all possible αB∗ values
it holds that D(αB∗ ) > 0. We therefore calculate the condition on ω
b
i
so that D(αB∗ ) > 0 using eq. (7):
ω
b
i <
p
Sstop
1
p
Smine
0
+ p
Smine
2
+ (1 −γ )(1 − αA) · p
Smine
1
− (p
Sstop
0
+ p
Sstop
2
)
| {z }
Q(αB∗ )
.
(8)
We use calculus to find the tight condition, and get that Q(αB∗ ) is
minimal when αB∗ = 0, regardless of the parameters’ values.
This result implies that the motivation for a miner to keep mining
during the attack decreases when other miners keep mining, as the
minimum is achieved when all other miners are following Sstop. By
assigning αB∗ = 0 to eq. (8) and using the probabilities calculated
in eq. (4), the tight condition on ω
b
i
is:
ω
b
i <
αA + αi + αAαi
αi + αAαi + (1 −γ )αA(1 − αA)
. (9)
This condition ensures that Sstop is dominant strategy for Pi
. In
other words, Sstop is always the best strategy for Pi regardless of
other payers’ actions. Note that the dominant strategy is Sstop for all
miners if the condition in eq. (9) holds for all miners in the system.
5.2 Threshold Values
We consider specific system parameter values and the resulting
threshold on ω
b
i
for a successful attack.
First we use the condition on ω
b
i
that was obtained in eq. (9).
Figure 3 shows the highest ω
b
i
that allows the attack for different
values of αA, αi and γ . Unlike previous attacks, even an attacker
with a relatively small computational power (e.g., αA < 0.1) can
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 606
successfully mount an attack to stop all other miners from mining.
The mining power of the rational miner αi
is also important to
the success of the attack. For example, with αA = 0.2, γ =
1
2
and αi = 0.1, the threshold ω
b
i
is almost 1.6. Note that even if all
the rational miners have similar profitability, a small attacker would
be able to stop only smaller miners. This shows that larger miners
are harder to attack with BDoS.
Moreover, fig. 3 shows that when γ = 0 and αA = 0.2, the
attacker needs ω
b
i
to be smaller than 1.15 in order to attack a rational miner with αi = 0.1, compared to ω
b
i
< 1.6 when γ =
1
2
and
ω
b
i
< 2.7 whenγ = 1. This highlights the importance of the rushing
ability for the attacker. Note thatγ =
1
2
is a conservative assumption
primarily since an adversary can control a relay network [50] and
therefore potentially achieve γ even closer to 1. In §8, we further
show that even if the rational miners are deviating from Nakamoto’s
protocol by boycotting A’s blocks (and therefore decreasing γ ), she
can use smart contracts (on external cryptocurrency) to make her
blocks indistinguishable from rational miners’ blocks.
Fixing αB∗ We found the borderline ω
b
i
for the worst case, i.e., for
all possible chosen strategies of other miners. But we saw that if
the portion of rational miners that keep mining αB∗ increases, the
motivation for Pi to stop mining also increases. We now consider
a scenario where Pi can accurately estimate αB∗ . In practice, this
can be done by spying on other pools [45, 112] or by monitoring
the recent inter-block time. As before, we assume that γ =
1
2
.
Using eq. (8), we conclude that the bound on ω
b
i
is Q(αB∗ ). We
define: σi =
αB∗
1−αA −αi
, which is the absolute portion of rational
miners other than Pi that continue mining. We plot the borderline
ω
b
i
, αA and αi for different σi values in fig. 4.
We can see that if all other rational miners chose Smine (σi = 1),
then for αA = 0.2 and αi = 0.16, Pi stops mining for ω
b
i
< 2 which
is significantly higher than ω
b
i
< 1.45 for the case with σi = 0. As
expected, the threshold for a partial shutdown is significantly higher
than the threshold for a complete shutdown.
5.3 Partial Shutdown
We now analyze partial-shutdown attacks. The total reduction
in throughput the attacker can cause and the cost of the attack
depend on the portion of the miners that choose Smine.
We denote by σ the portion of all non-adversarial miners that
keep mining. The game can be described by the state machine for
Sstop we used before (fig. 2) assuming that αi = 0. Recall that the
portion of time spent in state 1 of the Sstop state machine (fig. 2)
is p1. The throughput is the average number of blocks that end
up in the main chain per second, i.e., excluding the forked blocks.
The relative throughput is the ratio between the throughput in the
presence of the attack and the throughput in an honest game. It
is easy to see that the relative throughput is (1 − p1), as the block
produced in state 1 is the only block that does not contribute to the
throughput. The attacker’s cost is αAcA(1 − p1), as the attacker
mines at a constant rate in all states but 1. We define the relative
cost as the ratio between the cost of the attacker in BDoS and her
cost in an honest game. Therefore, the relative cost is (1 −p1) – the
same as the relative throughput.
0.00 0.10 0.20 0.30 0.40 0.50
1
2
3
4
αA (portion of adverserial hash power)
Max
ω
b
i for successful attack
γ = 1.00, αi = 0.10 γ = 1.00, αi = 0.20
γ = 0.50, αi = 0.10 γ = 0.50, αi = 0.20
γ = 0.50, αi = 0.15 γ = 0.50, αi = 0.30
γ = 0.00, αi = 0.10 γ = 0.00, αi = 0.20
Figure 3: ω
b
i
that will allow an attack for different αA, γ
and αi (Notice that γ can’t reach 1 in real setting).
0.00 0.20 0.40 0.60 0.80 1.00
1.3
1.5
1.7
1.9
2.1
2.3
2.5
2.7
2.9
3.1
σi
Max
ω
b
i for successful attack
αA = 0.30, αi = 0.05 αA = 0.20, αi = 0.05
αA = 0.30, αi = 0.16 αA = 0.20, αi = 0.16
αA = 0.16, αi = 0.16
Figure 4: ω
b
i
that will allow an attack for different σi
, αA
and αi while γ =
1
2
.
0.00 0.10 0.20 0.30 0.40 0.50
0
0.25
0.5
0.75
1
αA (portion of adversarial hash power)
Relative throughput /
Relative cost
σ = 0.00
σ = 0.10
σ = 0.20
σ = 0.40
σ = 0.60
σ = 0.80
σ = 1.00
Figure 5: The relative throughput (out of the original coin’s
throughput) or relative cost for the attacker αA, σ .
We plot (1 − p1) vs. αA in fig. 5. With σ = 0, the growth of
the blockchain completely stops, and the Markov chain remains in
state 1 forever at cost 0 for the attacker. The graph indeed shows
that when σ is closer to 0, relative cost becomes smaller even for
small attackers, until it collapses to 0 when σ = 0.
The result of this partial denial of service can be a panic and price
crash, as cryptocurrencies’ prices are subject to manipulation [2, 48].
A significant slowdown is an unusual event that can potentially
start a chain reaction in the form of a price fall that can lower the
profitability even further. Eventually, even a partial attack could
cause irreparable damage to a cryptocurrency.
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 607
6 BDOS IN THE PRESENCE SPV MINING
So far, we have assumed that no rational miner mines on the
block header. Note that publishing a header allows miners to extend
it optimistically, as a block can be extended using only its hash.
This is called SPV mining [97], and happens in practice. According
to Nakamoto consensus, no miner considers a block that references
a header as part of her main chain, as the system state is undefined without the block content. It is also impossible to validate the
transactions of the next block (even if it is a full block). Therefore,
when engaging in SPV mining, a miner assumes that the full block
corresponding to the header will be published in the future.
In order to include the action that corresponds to SPV mining,
denoted by mineSPV, we introduce few changes to our attacker
algorithm, model and analysis.
6.1 Model Updates
To assume miners can SPV mine, we have to extend our definition
for miners’ behavior and assume that they can digress from the
protocol with small deviations. Like Carlseten et al. [23], we say
that the miners are petty-compliant, that is, they only take steps that
almost follow the protocol, namely, (1) extending the longest chain,
(2) leave the protocol or (3) engage in SPV mining. Consequently,
we add a third strategy to the rational miners’ strategy space we
have previously considered, namely mining on the attacker’s header
during the attack. We denote it by SSPV.
In addition, we assume that the A is aware of when a rational
miner Pi finds a block that extends A’s header. More formally, if
Pi won the round, the scheduler adds her block to all other miners’
ledgers, including A’s. On a practical note, this can be done by
spying on other mining pools. Thus, A can join all major mining
pools as a miner and be warned when the mining pool manages to
find a block that extends her block header.
Therefore we change A’s strategy so that when a miner successfully finds block BPi
that extends BA, A abandons BA and return
to mining on B
∗
. A will never publish the data that corresponds to
BA, effectively invalidating BPi
.
Note If we consider a setting where A can ignore or be unaware
of a new block BPi mined by Pi that extends her header BA, the
attack, in fact, becomes stronger. This is because BPi would be
withheld by Pi until A publishes the content of BA. But A would
only publish it in case of a race condition, with some other block
BPj
. Once A publishes BA, Pi
immediately publishes BPi
, causing
A to win the race and to invalidate BPj
. So if miners choose SSPV in
such a setting, they only decrease the motivation for other miners
to choose Smine. Moreover, the blocks mined with SPV are likely to
be empty, as a miner who does not possess all the transactions in
the current state would not risk invalidating her block by causing
conflicts. We, therefore, regard the analysis of this case as being
outside the scope of this paper.
6.2 BDoS Effectiveness in the Presence of SSPV
After updating the model and adversarial strategy, it remains
to show that the effectiveness of the attack does not decrease if
some portion of the miners engages in SPV mining. The intuitive
argument is that if a rational miner decides to SPV mine, her next
0.00 0.10 0.20 0.30 0.40 0.50
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
αA (portion of adversarial hash power)
r
∗
γ = 0.00
γ = 0.25
γ = 0.50
γ = 0.75
γ = 1.00
Figure 6: r
∗
that will allow the attack
block would not be included in the main chain. Therefore, the utility
of Smine is strictly higher than the utility of SSPV. Consequently,
assuming that all miners are rational, no miner would choose to engage in SPV mining. The quantitative analysis (§5) of the conditions
for the attack still holds. The formal justification of this argument
is more complicated and is based on a different solution concept –
Iterated Elimination of Strictly Dominated Strategies (IESDS). We
defer the detailed analysis to Appendix D.
7 TWO-COIN MODEL
So far, we used a model where the attacker initiates an attack on
a cryptocurrency, and the rational miners can either mine on this
coin or not mine at all.
We now consider a two-coin model where miners can choose to
mine on one of two coins. This requires the two coins to employ a
similar mining algorithm so that miners could mine on both coins
with similar efficiency. The main difference from the previous model
is that miners have less to lose than by ceasing mining completely.
If the profitability of the coins is similar, even if the attacker lowers
the expected profit slightly, the miners would still be motivated to
switch to the other coin.
Due to the large number of coins in the blockchain world and the
fact that some of them use the same or similar mining schemes [53,
58, 69, 81, 96, 104, 109, 113], the more vulnerable two-coin model
is in fact more realistic as well.
When there is a profitability difference, miners are expected to
switch coins to the more profitable coin. By doing that, they cause
the profitability to decrease in the long term (due to difficulty adjustment) and bring the coins’ profitability to equilibrium. BDoS results
in artificial profitability difference between the coins, causing all
rational miners to abandon the attacked coin for the other coin.
7.1 Model Changes
In our two-coin model, we assume a rational miner can choose
between mining onC1 or a competing coinC2 with the same mining
mechanism. We denote the profitability and utility of Pi for coin
C1 with ω
b
i
and Ui respectively, and the profitability and utility of
Pi for coin C2 with ω
b
′
i
and U
′
i
respectively. If the honest setting
profitability for the miner Pi on both coins is equal ω
b
i
= ω
b
′
i
, then
the attacker no longer has a threshold for an attack on coin C1. This
is because the attack always decreases the mining utility Ui for Pi
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 608
who mines on coin C1 and therefore every miner would choose to
mine on C2 instead (as U
b
′
i
> Ui
).
7.2 Analysis
The model is almost the same as the one described in section 3.2,
and the analysis would be similar to the analysis in §5. The main
difference is that we no longer consider a choice between mine
on B
∗
and stop but between mining on B
∗
in the attacked coin C1
(S
1
mine ) and mining on another coin C2 (S
2
mine ). The utility U
S
1
mine
i
for Pi for the first strategy S
1
mine is the same as U
Smine
i
in eq. (6),
thus U
S
1
mine
i
= U
Smine
i
.
While the utility U
S
2
mine
i
for Pi for the second strategy S
2
mine
(mining in the honest setting in coin C2) is similar to U
b
i
in eq. (1).
We use different λ, ci and K parameters for the second coin (λ
′
, c
′
i
and K
′
respectively), as they are not necessarily the same for both
coins. Thus:U
S
2
mine
i
= U
b
′
i
= λ
′K
′−c
′
i
. To compare the two utilities
in two different coins, we can no longer use the normalized utility, as
the mining power constants αi and α
′
i
of coinC1 andC2 respectively,
are not necessarily the same. Note that the mining cost per second
of Pi
is equal for both coins, so that αici = α
′
i
c
′
i
. We define D as
the difference between the two utilities U
S
1
mine
i
and U
S
2
mine
i
, when
each utility is multiplied by the respective hashrate:
D(αB∗ ) =
∆
αiU
S
1
mine
i
− α
′
i
U
S
2
mine
i
αici
=
αiU
S
1
mine
i
αici
−
α
′
i
U
S
2
mine
i
α
′
i
c
′
i
= (p
Smine
0
+ p
Smine
2
+ (1 −γ )(1 − αA) · p
Smine
1
) · ω
b
i − ω
b
′
i
.
We ask when it holds that D(αB∗ ) > 0, thus look for the ratio r s.t:
r =
∆
ω
b
′
i
ω
b
i
> (p
Smine
0
+ p
Smine
2
+ (1 −γ )(1 − αA) · p
Smine
1
)
| {z }
W (αB∗ )
.
We now need to calculate the maximal valueW (αB∗ ) can get. Using
calculus we derive that it attains maximum for αB∗ = 1 − αA − αi
which holds when all other miners do not switch coins (as this is
the maximum utility they can get):
r > W (αB∗ = 1 − αA − αi) =
(1 − αA)(αA(γ − 2) − 1)
α
2
A
− αA − 1
= r
∗
.
An interesting fact is that the minimal r that allows the attack,
which we denote by r
∗
, does not depend on Pi
’s mining power.
We plot r
∗
that allows the attack for different γ and αA in fig. 6.
When γ =
1
2
and αA = 0.2, it holds that r
∗ = 0.9. This means such
an attacker can launch the attack as long as the profitability of C1
is smaller by at least 11% than the profitability of C2. Note that the
attack is always possible when the profitability of C2 is equal to the
one of C1, i.e. r = 1.
7.3 Estimating Practical r
It is shown in [69] that such migrations between coins happen
frequently. In [113], the authors found a correlation between profitability changes of Bitcoin and Bitcoin Cash with the hashrate
changes of the two coins, concluding that miners migrate between
coins according to profitability.
The ratio between profitabilities of Bitcoin and Bitcoin Cash,
presented in [35], is equivalent to r that was defined in §7. We
can see that r is close to 1 and often is within 5% error range. Such
realistic values forr would allow an attacker with 10% of the mining
power to mount a successful attack.
8 PRACTICAL CONCERNS
Until now we analyzed BDoS within the model introduced in §3.
In this section, we discuss further the practical aspects of launching
BDoS. For this purpose, we use Bitcoin as a case study coin.
8.1 Motivation of the Attacker
The attacker described in this work is different from profit-driven
attackers (or deviating miners) [45, 46, 68, 89, 102]. In the case
of BDoS, the attacker has exogenous motivation for the attack. We
now give some examples of such attackers:
Goverment The rise of cryptocurrencies has raised concern in
some states regarding the negative effects on the strength of their
own fiat money and monetary policy effectiveness [9, 11, 54, 80].
Cyberspace allows large actors to achieve a political or economic
goal while maintaining plausible deniability. Previous reports suggested that governments deploy costly and elaborate attacks to
achieve such goals while hiding their traces [27, 70, 78, 105].
Note that although BDoS requires the attacker to announce
the attack publicly, it does not require the attacker to reveal her
real identity. The Nakamoto consensus allows a mining farm to
have minimal exposure to the network and it only needs to receive
previous blocks’ hashes and send the data of the new block when it
is found. Therefore, the attacker’s P2P node can be a server with no
link to discernible its operator. Governments reportedly [30, 78, 94]
use frontman or proxy entities regularly.
Therefore, given the high motivation to destabilize cryptocurrencies, the ability to allocate significant resources for this goal,
and the possibility of carrying out the attack covertly, state actors
could attempt to execute BDoS in the future.
External profit An attacker can gain profit by taking a short
position on a cryptocurrency, and then sabotaging the coin to cause
a price collapse [20, 101]. Such an attacker can potentially gain
even more by conducting a partial attack, as her aim is not to stop
the coin completely but temporarily destabilize it.
Competing coins The attacker could be affiliated with a competing coin, and willing to spend resources to weaken her competitor. There is evidence that 51% attacks (much more expensive
than BDoS) have aimed to sabotage competing coins [75, 93].
8.2 Rationality of Miners
So far we assumed that all the miners are rational. We would
like to understand what is the effect of non-rational (or altruistic)
miners on the success of the attack.
First, on a practical level, there is evidence that miners tend
to stop mining when it is no longer profitable [28, 43]. Moreover,
miners tend to switch among competing coins due to differing
profitability [69, 113]. This switching happens when mining is still
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 609
profitable on both coins, and strongly suggests those miners are
acting greedily, and not altruistically supporting a particular coin.
Second, our model can describe a system with altruistic miners. We can consider them by assuming that some miners have $0
electricity cost. In the presence of altruistic miners, the attacker
would not cause a complete shutdown but rather a partial shutdown.
A partial shutdown attack can be the desired result for certain attackers (section 8.1), because it can destabilize the coin and cause
the price to crash, yet still allow transactions to be approved.
Finally, the security of blockchains should not rely on altruism [108]. The original Nakamoto consensus [88] was designed to
compensate miners for their work and consequently incentivize
them to stay honest. Therefore, blockchain security analysis should
consider the worst-case when all miners decide to mine based on
the mining profitability [43, 108]. Otherwise, security is contingent
on the existence of miners that are willing to pay to keep the coin
alive. This is a strong requirement for financial systems with a total
market cap of hundreds of billions of dollars.
8.3 Header-Publication Method
BDoS requires the adversary to announce a block header without
revealing a full block. We now describe two publishing methods
that the adversary can use in practice. Crucially, regardless of the
chosen header publication method, a rational miner would never
bury her head in the sand, i.e., ignore the additional info and hence
reduce her profit. In practice, reports [28, 43, 69] suggest that miners
indeed poll external data and change their strategy according to it,
e.g., mine on a more profitable coin or stop mining completely.
In the first method, the attacker announces that she is committing
to an attack, and publishes her block headers on a dedicated web
page. Rational miners would poll this web page.
In the second publication method, the attacker directly sends
block headers (of the block she created) to other miners. In Bitcoin,
this can be done using the built-in BIP152 protocol [31]. However,
the protocol dictates that nodes should not propagate a block header
until fully validating the entire block. Thus, the attacker must be
connected directly to other miners. As before, to maximize her
utility, a rational miner would not ignore such headers.
8.4 Alternative Proofs of Block Possession
Instead of sending a block header, the adversary can use a smart
contract (potentially on an external blockchain) to demonstrate the
discovery of a block without revealing its header.
The idea is to use an economic mechanism to demonstrate knowledge of a valid block header H. Briefly, the attacker places large
collateral in the contract, possibly on a different cryptocurrency
like Ethereum, along with a cryptographic commitment Comm to H
and with the hash of the previous block. If at some predetermined
(distant) future time, she de-commits a valid H for the contract, i.e.,
one that points to the previous block, she recovers the collateral.
Otherwise, she forfeits the collateral to miners. If the contract is
part of a different blockchain, miners can be required to prove their
identity using a signature with their private key from the attacked
coin. Thus, the attacker is incentivized to claim and commit only
to a valid header, but need not reveal any information about H, until
H is no longer useful to miners.
To ensure that the attacker has the incentive to commit to a
valid H, the collateral should be significantly larger than the cost
of mining blocks during the commitment period. The collateral,
if forfeited, can be split among a predefined list of mining pools
(weighted by their mining power). For example, this list might
include miners of the last, e.g., 1,000 blocks.
This approach has one key advantage over the block header approach: untilH is de-committed (again, in the far future), no rational
miner can distinguish the attacker’s block from an honest block as,
during the race, the other miners only posses a commitment for the
block rather than a block header or hash. This approach prevents
rational miners from forming a coalition that would ignore the
attacker’s block. When the attacker reveals the block after a long
time, it would be impractical to ignore it, as it would have a large
number of confirmations [3].
Another method that can achieve a similar effect is ZeroKnowledge proof. An attacker can publish a non-interactive ZeroKnowledge proof on her website and prove she found a block header
without exposing identifying information like the block hash. Like
in the case of smart contracts, rational miners cannot distinguish
the attacker’s block from an honest block in case of a race.
Exact details for both methods are beyond the scope of this paper.
8.5 Practical ωb
The success of the attack relies critically on the baseline profitability ω
b
. To estimate realistic values for ω
b
, we study the properties of Bitcoin, as the archetypal PoW cryptocurrency. First, we
consider the costs that affectω
b
. Next, we explore how and whenω
b
changes in practice. This is important due to the attacker’s liberty
to choose the moment of the attack. Finally, we estimate real values
for ω
b
, using both previous work and our own analysis.
CAPEX and OPEX The miner’s expenses include operating expenses (OPEX or ongoing cost) and capital expenses (CAPEX or
sunk cost) [53, 64]. OPEX includes electricity and cooling. CAPEX
includes costs like buying/renting facilities and mining hardware.
As we compare Sstop to other strategies, we can ignore the CAPEX
element because all strategies have an identical initial cost. Moreover, we showed (§5) that the CAPEX is not relevant in our infinitehorizon game, as it does not change the profit per second.
Nevertheless, high CAPEX affects ω
b
indirectly, as miners have
to return their initial investment. Lower CAPEX can cause ω
b
to
decrease as more potential miners would join the game, bringing
the system closer to equilibrium [13, 52, 59, 117], i.e., ω
b
close to 1.
As we showed in §5 this would hurt the security of the system as
small attackers would be able to mount a successful BDoS attack.
ωb Fluctuations More than 50% of Bitcoin’s hash power is located
in Sichuan, China [126], since the electricity price there is extremely
low during the wet season – as low as $0.04 per kWh [13], slightly
varying between hydropower plants. Although it is easier for a
BDoS attacker to target miners in regions with higher electricity
prices (fig. 3), we show below (section 8.6) that miners in Sichuan
(with minimal electricity prices) are still at risk. Moreover, at the
end of the wet season or in an unexpected dry period [55], before
the difficulty adjustment, the electricity prices increase, therefore
the profitability of most miners can be exceptionally low. This is
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 610
0
1
2
4
6
8
10
12
14
16
18
20
22
24
(a) Profitability
ω
b
Mining hardware models
Bitmain Antminer S17 Pro
Ebang Ebit E11++
ASICminer 8 Nano Pro
Ebang Ebit E10
Bitmain Antminer R4
Bitmain Antminer S9
0
20%
40%
60%
80%
Halving
(b) Attacker’s hashrate threshold
η = 0
η = 20%
η = 50%
η = 80%
7/1/17 2/1/18 5/1/18 10/1/18 4/1/19 5/11/20
0
2
4
Bitmain
Antminer R4
Ebang Ebit E10
ASICminer 8
Nano Pro
Ebang Ebit E11++
Bitmain Antminer
S17 Pro
(c) Attacker’s daily cost ($M)
η = 0
η = 20%
η = 50%
η = 80%
Figure 7: (a) Profitability of mining Bitcoin; (b) Attacker’s
resource threshold; (c) Attacker’s daily cost. The hops indicated by the vertical grids result from mining hardware
switches due to release of new profitable models.
0.05 0.1 0.2 0.3 0.4 0.475
0
0.25
0.5
0.75
1
αA
Relative thoughput
η = 50%, ω
b = 2 η = 50%, ω
b = 1.75
η = 20%, ω
b = 2 η = 20%, ω
b = 1.75
η = 0%, ω
b = 2 η = 0%, ω
b = 1.75
Figure 8: Relative throughput in the Nash equilibrium.
an ideal moment for an attacker to attack as ω
b
is expected to be
at its lowest point.
Another essential factor that can make the system vulnerable to BDoS is the block reward adjustment that happened in
May 2020 [10]. The block reward has dropped from 12.5BTC
to 6.25BTC. The transition was immediate and halved ω
b
.
Estimating Upper Bound for ωb Estimating ω
b
is based on several parameters. Mining hardware rates and electricity consumption
of different mining hardware are available in ASIC Miner Value [84].
We analyzed Bitcoin blocks 471744 to 624960 (June 17, 2017 –
April 8, 2020) using the Google BigQuery [37] Bitcoin dataset to
collect mining difficulty data and compute the expected number
of hashes needed to find a block [119]. We consider an electricity
price of $0.04 per kWh with additional 15% cooling & other OPEX
cost [13] and Bitcoin prices from [32]. We show in fig. 7(a) the
profitability of mining Bitcoin with the best hardware at each point
in time as well as with Antminer S9 which was prevalent until 2019.
The dashed vertical line indicates the most recent Bitcoin block
reward halving [10]. We can see that ω
b has halved immediately.
The lowest historical threshold on adversarial hashrate for a
complete shutdown BDoS, derived according to eq. (9), when the
largest rational miner has 20% of hashing power and γ =
1
2 was 21%
on March 13, 2020. After the Bitcoin block reward halving that took
place in May 11, 2020 [10], the average threshold for the attack has
reduced significantly and the complete shutdown threshold ranged
between 24% and 34% until Jun 5, 2020 (fig. 7(b)). Note that the
attacker can choose the timing of the attack and therefore we are
interested in finding the minimal threshold rather than the average
threshold for the attack.
This attack threshold is significantly lower than the previously
known bound for a complete shutdown attack which is 51%.
Our estimation for electricity cost is conservative and other
sources estimate it to be higher on average [12, 39, 43, 92, 127].
For less conservative electricity prices, the attack is significantly
cheaper. The threshold for the attacker’s hash rate was as low
as 7.7% before halving and 10% after halving for $0.05/kWh. It was
less than 1% for both before and after halving for $0.06/kWh. We
give more details about the attack threshold for other electricity
prices in (Appendix F).
8.6 Partial Attack and Its Costs
A BDoS attacker can stop rational miners from mining and cause
a significant slowdown to the system, even when altruistic miners
exist (section 5.3). We use Bitcoin as a case study and estimate the
mining power threshold and daily cost for the attacker.
We calculate the attack resource threshold over time to stop all
rational miners in Bitcoin based on our estimated mining profitability data (fig. 7(a)). We assume A’s rushing factor γ is 1
2
. We denote
by η the proportion of mining power owned by altruistic miners
among non-adversarial miners. Recall that the mining power required to stop the largest rational miner suffices to stop all rational
miners (fig. 3). To be conservative, we assume the largest rational
miner controls 20% of the mining power [19]. As before, we consider
the adversary as a new miner entering the network in addition to
existing miners, so the actual mining power of each rational miner
in the attack is scaled by a factor (1 − αA). We assume both the
attacker and the rational miners use the most profitable mining
hardware available at each moment; thus, they have the same profitability. It is easier to attack when rational miners know the value
of η than when they don’t because the attack threshold decreases
Session 2E: Smart Contracts and Cryptocurrencies CCS '20, November 9–13, 2020, Virtual Event, USA 611
with the ratio of miners remaining mining (fig. 4). We assume each
rational miner knows η for a tighter bound on attack threshold.
An attacker can achieve this by first attacking with a lot of hash
power for a short while to stop all rational miners and estimate η
according to the reduction in the mining rate.
We calculate and plot the resource threshold required for a BDoS
attacker (fig. 7(b)). As of March 13, 2020, 21% mining power suffices
to launch BDoS when there are no altruistic miners, and even less
than 10% when there are at least 20% altruistic miners.
In addition, we estimate the attacker’s daily OPEX cost (fig. 7(c)).
As of March 13, 2020, an attacker would spend less than $1M daily
to launch BDoS. When all miners are rational, the attacker’s OPEX
cost is zero. For comparison, the cost per day of a 51% attack would
have been $10.6M with Antminer S9 SE [90] rigs and $5.2M with
Antminer S17 Pro [15] (see Appendix C for details).
8.7 Simulation of Realistic Miners
Even if the mining profitability is not low enough to stop all
rational miners, a BDoS attacker can still discourage some small
miners from mining. This is because the upper bound on ω
b
i
, that
drives a rational miner Pi out of mining, increases with the mining
power of Pi
(fig. 3). Assuming all miners have the same profitability
factor ω
b
, consider an adapting process in which rational miners
are always aware of the total mining power of active miners in the
network, and choose between Smine and Sstop adaptively. A rational
miner Pi chooses to mine if the real-world ω
b
is higher than the
upper bound for Pi
, and stops mining otherwise. The process starts
with the state in which everyone mines and ends when no rational
miner changes her strategy anymore. Thus at the end of the process,
rational miners reach a Nash equilibrium.
We simulate the process for Bitcoin to find an equilibrium for all
rational miners. As before, we assume γ =
1
2
and use the mining
power distribution as of March 2020 [19] for rational miners. We
assume η of the non-adversarial mining power belongs to altruistic
miners, thus the hash power of each rational miner is scaled by a
factor (1 − η).
We plot the resulting relative throughput in the Nash Equilibrium
with different mining profitability ω
b
and altruistic parameter η in
separate curves in fig. 8. When αA is low, only some small miners
choose Sstop. As αA grows, it becomes profitable for more mediumsized miners to stop mining. The simulation indicates that there is a
wide range of profitability factor values that allow BDoS that causes
a significant slowdown in practice. For example, with only 20% of
mining power, an attacker may slow down the system by 40% even
when the real-life profitability is 1.75 and 20% of the non-adversarial
miners are altruistic.
9 MITIGATION
We now describe possible mitigations for BDoS attacks.
Uncle blocks BDoS is designed against Nakamoto consensus cryptocurrencies like Bitcoin. However, it is not effective against other
cryptocurrencies, e.g., Ethereum [22, 123]. This is due to the uncle
block mechanism [123], which rewards miners who mined blocks
that are directly connected to the main chain. This thwarts BDoS,
as now, in case a rational miner loses the race, her block is still rewarded. Thus, by publishing a block header, the attacker no longer
reduces the expected profit of rational miners as significantly.
Note that the mechanism does not grant a reward for blocks that
are not directly connected to the main chain. Consequently, there
may be similar attacks that still allow the attacker to decrease the
expected reward, e.g., by publishing two-block headers that fork
the most recent block in the chain. However, the design for such
an attack is beyond the scope of this work.
Ignoring attacker’s block during race Another possible way to
weaken the attack is to change miner behavior so that if there is a
fork, a miner should prefer blocks not generated by an attacker. The
challenge is to identify attack blocks. A third party service for this
goal is out of the question as it violates the decentralized nature of
the system and allows false incrimination. Instead, we propose to
classify according to the time interval between the reception of the
header and the reception of the block. We can safely assume that
for a non-attack block, this interval is bounded by, e.g., one minute,
and blocks with a longer interval are suspect.
Note that this mitigation is possible only when the adversary
chooses to prove that she mined a block using a block header. This
solution does not work with other methods like smart contracts
and ZK proofs (section 8.4).
10 CONCLUSION
We present BDoS, the first Blockchain denial-of-service attack
that uses incentive manipulation. BDoS sabotages the incentive
mechanism behind Nakamoto’s consensus by proving the attacker
has achieved an advantage in mining without releasing her complete block. Such proof reduces miners’ incentive to mine, making
it less profitable than not mining. Thus, rational profit-driven miners would cease mining. We show that cryptocurrencies based on
Nakamoto’s blockchain are vulnerable to BDoS under realistic settings, and propose mitigations.
The header-only publication capability we present is a realistic
extension of the standard model under which blockchain protocols
are typically analyzed. This opens the door to study new equilibria
and strategies where a miner manipulates the system to increase
her revenue rather than sabotage the system.
Additionally, BDoS applies to heaviest-chain PoW blockchains
such as Bitcoin, Litecoin, Bitcoin-Cash, Zcash, and others. We defer
to future work the questions of whether there are similar attacks
against other protocols like Ethereum and whether our heuristic
mitigation applies there as well.
Finally, alternative incentive-based DoS attacks may exist, possibly more efficient than BDoS. The security of blockchain protocols
relies on finding the general bounds for such attacks, as well as
mitigations.