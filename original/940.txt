Algorithmic systems that employ machine learning play an increasing role in making substantive decisions in modern society, ranging from online personalization to insurance and credit decisions to predictive policing. But their decision-making processes are often opaque-it is difficult to explain why a certain decision was made. We develop a formal foundation to improve the transparency of such decision-making systems. Specifically, we introduce a family of Quantitative Input Influence (QII) measures that capture the degree of influence of inputs on outputs of systems. These measures provide a foundation for the design of transparency reports that accompany system decisions (e.g., explaining a specific credit decision) and for testing tools useful for internal and external oversight (e.g., to detect algorithmic discrimination). Distinctively, our causal QII measures carefully account for correlated inputs while measuring influence. They support a general class of transparency queries and can, in particular, explain decisions about individuals (e.g., a loan decision) and groups (e.g., disparate impact based on gender). Finally, since single inputs may not always have high influence, the QII measures also quantify the joint influence of a set of inputs (e.g., age and income) on outcomes (e.g. loan decisions) and the marginal influence of individual inputs within such a set (e.g., income). Since a single input may be part of multiple influential sets, the average marginal influence of the input is computed using principled aggregation measures, such as the Shapley value, previously applied to measure influence in voting. Further, since transparency reports could compromise privacy, we explore the transparency-privacy tradeoff and prove that a number of useful transparency reports can be made differentially private with very little addition of noise. Our empirical validation with standard machine learning algorithms demonstrates that QII measures are a useful transparency mechanism when black box access to the learning system is available. In particular, they provide better explanations than standard associative measures for a host of scenarios that we consider. Further, we show that in the situations we consider, QII is efficiently approximable and can be made differentially private while preserving accuracy.
SECTION I.Introduction
Algorithmic decision-making systems that employ machine learning and related statistical methods are ubiquitous. They drive decisions in sectors as diverse as Web services, healthcare, education, insurance, law enforcement and defense [1], [2], [3], [4], [5]. Yet their decision-making processes are often opaque. Algorithmic transparency is an emerging research area aimed at explaining decisions made by algorithmic systems.

The call for algorithmic transparency has grown in intensity as public and private sector organizations increasingly use large volumes of personal information and complex data analytics systems for decision-making [6]. Algorithmic transparency provides several benefits. First, it is essential to enable identification of harms, such as discrimination, introduced by algorithmic decision-making (e.g., high interest credit cards targeted to protected groups) and to hold entities in the decision-making chain accountable for such practices. This form of accountability can incentivize entities to adopt appropriate corrective measures. Second, transparency can help detect errors in input data which resulted in an adverse decision (e.g., incorrect information in a user's profile because of which insurance or credit was denied). Such errors can then be corrected. Third, by explaining why an adverse decision was made, it can provide guidance on how to reverse it (e.g., by identifying a specific factor in the credit profile that needs to be improved).

Our Goal
While the importance of algorithmic transparency is recognized, work on computational foundations for this research area has been limited. This paper initiates progress in that direction by focusing on a concrete algorithmic transparency question:

How can we measure the influence of inputs (or features) on decisions made by an algorithmic system about individuals or groups of individuals?

Our goal is to inform the design of transparency reports, which include answers to transparency queries of this form. To be concrete, let us consider a predictive policing system that forecasts future criminal activity based on historical data; individuals high on the list receive visits from the police. An individual who receives a visit from the police may seek a transparency report that provides answers to personalized transparency queries about the influence of various inputs (or features), such as race or recent criminal history, on the system's decision. An oversight agency or the public may desire a transparency report that provides answers to aggregate transparency queries, such as the influence of sensitive inputs (e.g., gender, race) on the system's decisions concerning the entire population or about systematic differences in decisions among groups of individuals (e.g., discrimination based on race or age). These reports can thus help identify harms and errors in input data, and provide guidance on what input features to work on to modify the decision.

Our Model
We focus on a setting where a transparency report is generated with black-box access to the decision-making system1 and knowledge of the input dataset on which it operates. This setting models the kind of access available to a private or public sector entity that pro-actively publishes transparency reports. It also models a useful level of access required for internal or external oversight of such systems to identify harms introduced by them. For the former use case, our approach provides a basis for design of transparency mechanisms; for the latter, it provides a formal basis for testing. Returning to our predictive policing system, the law enforcement agency that employs it could proactively publish transparency reports, and test the system for early detection of harms like race-based discrimination. An oversight agency could also use transparency reports for post hoc identification of harms.

Our Approach
We formalize transparency reports by introducing a family of Quantitative Input Influence (QII) measures that capture the degree of influence of inputs on outputs of the system. Three desiderata drove the definitions of these measures.

First, we seek a formalization of a general class of transparency reports that allows us to answer many useful transparency queries related to input influence, including but not limited to the example forms described above about the system's decisions about individuals and groups.

Second, we seek input influence measures that appropriately account for correlated inputs—a common case for our target applications. For example, consider a system that assists in hiring decisions for a moving company. Gender and the ability to lift heavy weights are inputs to the system. They are positively correlated with each other and with the hiring decisions. Yet transparency into whether the system uses the weight lifting ability or the gender in making its decisions (and to what degree) has substantive implications for determining if it is engaging in discrimination (the business necessity defense could apply in the former case [7]). This observation makes us look beyond correlation coefficients and other associative measures.

Third, we seek measures that appropriately quantify input influence in settings where any input by itself does not have significant influence on outcomes but a set of inputs does. In such cases, we seek measures of joint influence of a set of inputs (e.g., age and income) on a system's decision (e.g., to serve a high-paying job ad). We also seek measures of marginal influence of an input within such a set (e.g., age) on the decision. This notion allows us to provide finer-grained transparency about the relative importance of individual inputs within the set (e.g., age vs. income) in the system's decision.

We achieve the first desideratum by formalizing a notion of a quantity of interest. A transparency query measures the influence of an input on a quantity of interest. A quantity of interest represents a property of the behavior of the system for a given input distribution. Our formalization supports a wide range of statistical properties including probabilities of various outcomes in the output distribution and probabilities of output distribution outcomes conditioned on input distribution events. Examples of quantities of interest include the conditional probability of an outcome for a particular individual or group, and the ratio of conditional probabilities for an outcome for two different groups (a metric used as evidence of disparate impact under discrimination law in the US [7]).

We achieve the second desideratum by formalizing causal QII measures. These measures (called Unary QII) model the difference in the quantity of interest when the system operates over two related input distributions—the real distribution and a hypothetical (or counterfactual) distribution that is constructed from the real distribution in a specific way to account for correlations among inputs. Specifically, if we are interested in measuring the influence of an input on a quantity of interest of the system behavior, we construct the hypothetical distribution by retaining the marginal distribution over all other inputs and sampling the input of interest from its prior distribution. This choice breaks the correlations between this input and all other inputs and thus lets us measure the influence of this input on the quantity of interest, independently of other correlated inputs. Revisiting our moving company hiring example, if the system makes decisions only using the weightlifting ability of applicants, the influence of gender will be zero on the ratio of conditional probabilities of being hired for males and females.

We achieve the third desideratum in two steps. First, we define a notion of joint influence of a set of inputs (called Set QII) via a natural generalization of the definition of the hypothetical distribution in the Unary QII definition. Second, we define a family of Marginal QII measures that model the difference on the quantity of interest as we consider sets with and without the specific input whose marginal influence we want to measure. Depending on the application, we may pick these sets in different ways, thus motivating several different measures. For example, we could fix a set of inputs and ask about the marginal influence of any given input in that set on the quantity of interest. Alternatively, we may be interested in the average marginal influence of an input when it belongs to one of several different sets that significantly affect the quantity of interest. We consider several marginal influence aggregation measures from cooperative game theory originally developed in the context of influence measurement in voting scenarios and discuss their applicability in our setting. We also build on that literature to present an efficient approximate algorithm for computing these measures.

Recognizing that different forms of transparency reports may be appropriate for different settings, we generalize our QII measures to be parametric in its key elements: the intervention used to construct the hypothetical input distribution; the quantity of interest; the difference measure used to quantify the distance in the quantity of interest when the system operates over the real and hypothetical input distributions; and the aggregation measure used to combine marginal QII measures across different sets. This generalized definition provides a structure for exploring the design space of transparency reports.

Since transparency reports released to an individual, regulatory agency, or the public might compromise individual privacy, we explore the possibility of answering transparency queries while protecting differential privacy [8]. We prove bounds on the sensitivity of a number of transparency queries and leverage prior results on privacy amplification via sampling [9] to accurately answer these queries.

We demonstrate the utility of the QII framework by developing two machine learning applications on real datasets: an income classification application based on the benchmark adult dataset [10], and a predictive policing application based on the National Longitudinal Survey of Youth [11]. Using these applications, we argue, in Section VII, the need for causal measurement by empirically demonstrating that in the presence of correlated inputs, observational measures are not informative in identifying input influence. Further, we analyze transparency reports of individuals in our dataset to demonstrate how Marginal QII can provide insights into individuals' classification outcomes. Finally, we demonstrate that under most circumstances, QII measures can be made differentially private with minimal addition of noise, and can be approximated efficiently.

In summary, this paper makes the following contributions:

A formalization of a specific algorithmic transparency problem for decision-making systems. Specifically, we define a family of Quantitative Input Influence metrics that accounts for correlated inputs, and provides answers to a general class of transparency queries, including the absolute and marginal influence of inputs on various behavioral system properties. These metrics can inform the design of transparency mechanisms and guide proactive system testing and posthoc investigations.

A formal treatment of privacy-transparency trade-offs, in particular, by construction of differentially private answers to transparency queries.

An implementation and experimental evaluation of the metrics over two real data sets. The evaluation demonstrates that (a) the QII measures are informative; (b) they remain accurate while preserving differential privacy; and (c) can be computed quite quickly for standard machine learning systems applied to real data sets.

SECTION II.Unary QII
Consider the situation discussed in the introduction, where an automated system assists in hiring decisions for a moving company. The input features used by this classification system are: Age, Gender, Weight Lifting Ability, Marital Status and Education. Suppose that, as before, weight lifting ability is strongly correlated with gender (with men having better overall lifting ability than woman). One particular question that an analyst may want to ask is: “What is the influence of the input Gender on positive classification for women?”. The analyst observes that 20% of women are approved according to his classifier. Then, he replaces every woman's field for gender with a random value, and notices that the number of women approved does not change. In other words, an intervention on the Gender variable does not cause a significant change in the classification outcome. Repeating this process with Weight Lifting Ability results in a 20% increase in women's hiring. Therefore, he concludes that for this classifier, Weight Lifting Ability has more influence on positive classification for women than Gender.

By breaking correlations between gender and weight lifting ability, we are able to establish a causal relationship between the outcome of the classifier and the inputs. We are able to identify that despite the strong correlation between a negative classification outcome for women, the feature gender was not a cause of this outcome. We formalize the intuition behind such causal experimentation in our definition of Quantitative Input Influence (QII).

We are given an algorithm A.A operates on inputs (also referred to as features for ML systems), N={1,…,n}. Every i∈N, can take on various states, given by Xi. We let X=∏i∈NXi be the set of possible feature state vectors, let Z be the set of possible outputs of A. For a vector x∈X and set of inputs S⊆N,x|S denotes the vector of inputs in S. We are also given a probability distribution π on X, where π(x) is the probability of the input vector x. We can define a marginal probability of a set of inputs S in the standard way as follows:
πS(x|S)=∑{x′∈X|x′|S=x|S}π(x′)(1)
View Source

When S is a singleton set {i}, we write the marginal probability of the single input as πi(x).

Informally, to quantify the influence of an input i, we compute its effect on some quantity of interest; that is, we measure the difference in the quantity of interest, when the feature i is changed via an intervention. In the example above, the quantity of interest is the fraction of positive classification of women. In this paper, we employ a particular interpretation of “changing an input”, where we replace the value of every input with a random independently chosen value. To describe the replacement operation for input i, we first define an expanded probability space on X×X, with the following distribution:
π~(x,u)=π(x)π(u).(2)
View Source

The first component of an expanded vector (x, u), is just the original input vector, whereas the second component represents an independent random vector drawn from the same distribution π. Over this expanded probability space, the random variable X(x,ui)=x represents the original feature vector. The random variable X−iUi(x,u)=x|N∖{i}ui, represents the random variable with input i replaced with a random sample. Defining this expanded probability space allows us to switch between the original distribution, represented by the random variable X, and the intervened distribution, represented by X−iUi. Notice that both these random variables are defined from X×X, the expanded probability space, to X. We denote the set of random variables of the type X×X→X as R(X).

We can now define probabilities over this expanded space. For example, the probability over X remains the same:
Pr(X=x)=∑{(x′,u′)|x′=x}π~(x′,u′)=⎛⎝∑{x′|x′=x}π(x′)⎞⎠(∑u′π(u′))=π(x)
View Source

Similarly, we can define more complex quantities. The following expression represents the expectation of a classifier c evaluating to 1, when i is randomly intervened on:
E(c(X−iUi)=1)=∑{(x,u)|c(xN∖iui)=1}π~(x,ui).
View Source

Observe that the expression above computes the probability of the classifier c evaluating to 1, when input i is replaced with a random sample from its probability distribution πi(ui).
==∑{(x,u)|c(xN∖iui)=1}π~(x,ui)∑xπ(x)∑{u′i|c(xN∖iu′i)=1}∑{u|ui=u′i}π(u)∑xπ(x)∑{u′i|c(xN∖iu′i)=1}πi(u′i)
View Source

We can also define conditional distributions in the usual way. The following represents the probability of the classifier evaluating to 1 under the randomized intervention on input i of X, given that X belongs to some subset Y⊆X:
E(c(X−iUi)=1|X∈Y)=E(c(X−iUi)=1∧X∈Y)E(X∈Y).
View Source

Formally, for an algorithm A, a quantity of interest QA(⋅):R(X)↦R is a function of a random variable from R(X).

Definition 1
SECTION Definition 1QII
For a quantity of interest QA(⋅), and an input i, the Quantitative Input Influence of i on QA(⋅) is defined to be
ιQA(i)=QA(X)−QA(X−iUi).
View Source

In the example above, for a classifier A, the quantity of interest, the fraction of women (represented by the set W⊆X) with positive classification, can be expressed as follows:
QA(⋅)=E(A(⋅)=1|X∈W),
View Sourceand the influence of input i is:
ι(i)=E(A(X)=1|X∈W)−E(A(X−iUi)=1|X∈W).
View SourceWhen A is clear from the context, we simply write Q rather than QA. We now instantiate this definition with different quantities of interest to illustrate the above definition in three different scenarios.

A. QII for Individual Outcomes
One intended use of QII is to provide personalized transparency reports to users of data analytics systems. For example, if a person is denied a job application due to feedback from a machine learning algorithm, an explanation of which factors were most influential for that person's classification can provide valuable insight into the classification outcome.

For QII to quantify the use of an input for individual outcomes, we define the quantity of interest to be the classification outcome for a particular individual. Given a particular individual x, we define Qxind(⋅) to be E(c(⋅)=1|X=x). The influence measure is therefore:
ιxind(i)=E(c(X)=1|X=x)−E(c(X−iUi)=1|X=x)(3)
View Source

When the quantity of interest is not the probability of positive classification but the classification that x actually received, a slight modification of the above QII measure is more appropriate:
ιxind−act(i)===E(c(X)=c(x)|X=x)−E(c(X−iUi)=c(x)|X=x)1−E(c(X−iUi)=c(x)|X=x)E(c(X−iUi)≠c(x)|X=x)(4)
View Source

The above probability can be interpreted as the probability that feature i is pivotal to the classification of c(x). Computing the average of this quantity over X yields:
=∑x∈XPr(X=x)E(i is pivotal for c(X)|X=x)E(i is pivotal for c(X)).(5)
View SourceRight-click on figure for MathML and additional features.

We denote this average QII for individual outcomes as defined above, by ιind−avg(i), and use it as a measure for importance of an input towards classification outcomes.

B. QII for Group Outcomes
As in the running example, the quantity of interest may be the classification outcome for a set of individuals. Given a group of individuals Y⊆X, we define QYgrp(⋅) to be E(c(⋅)=1|X∈Y). The influence measure is therefore:
ιYgrp(i)=E(c(X)=1|X∈Y)−E(c(X−iUi)=1|X∈Y)(6)
View Source

C. QII for Group Disparity
Instead of simply classification outcomes, an analyst may be interested in more nuanced properties of data analytics systems. Recently, disparate impact has come to the fore as a measure of unfairness, which compares the rates of positive classification within protected groups defined by gender or race. The ‘80% rule’ in employment which states that the rate of selection within a protected demographic should be at least 80% of the rate of selection within the unprotected demographic. The quantity of interest in such a scenario is the ratio in positive classification outcomes for a protected group Y from the rest of the population X∖Y.
E(c(X)=1|X∈Y)E(c(X)=1|X∉Y)
View Source

However, the ratio of classification rates is unstable at at low values of positive classification. Therefore, for the computations in this paper we use the difference in classification rates as our measure of group disparity.
QYdisp(⋅)=|E(c(⋅)=1|X∈Y)−E(c(⋅)=1|X∉Y)|(7)
View Source

The QII measure of an input group disparity, as a result is:
ιYdisp(i)=QYdisp(X)−QYdisp(X−iUi).(8)
View Source

More generally, group disparity can be viewed as an association between classification outcomes and membership in a group. QII on a measure of such association (e.g., group disparity) identifies the variable that causes the association in the classifier. Proxy variables are variables that are associated with protected attributes. However, for concerns of discrimination such as digital redlining, it is important to identify which proxy variables actually introduce group disparity. It is straightforward to observe that features with high QII for group disparity are proxy variables, and also cause group disparity. Therefore, QII on group disparity is a useful diagnostic tool for determining discriminiation. The use of QII in identifying proxy variables is explored experimentally in Section VII-B. Note that because of such proxy variables, simply ensuring that protected attributes are not input to the classifier is not sufficient to avoid discrimination (see also [12]).

SECTION III.Set and Marginal QII
In many situations, intervention on a single input variable has no influence on the outcome of a system. Consider, for example, a two-feature setting where features are age (A) and income (I), and the classifier is c(A,I)=(A=old)∧(I=high). In other words, the only datapoints that are labeled 1 are those of elderly persons with high income. Now, given a datapoint where A=young,I=low, an intervention on either age or income would result in the same classification. However, it would be misleading to say that neither age nor income have an influence over the outcome: changing both the states of income and age would result in a change in outcome.

Equating influence with the individual ability to affect the outcome is uninformative in real datasets as well: Figure 1 is a histogram of influences of features on outcomes of individuals for a classifier learnt from the adult dataset [13] 2. For most individuals, all features have zero influence: changing the state of one feature alone is not likely to change the outcome of a classifier. Of the 19537 datapoints we evaluate, more than half have ιx(i)=0 for all i∈N, Indeed, changes to outcome are more likely to occur if we intervene on sets of features. In order to get a better understanding of the influence of a feature i∈N, we should measure its effect when coupled with interventions on other features. We define the influence of a set of inputs as a straightforward extension of the influence of individual inputs. Essentially, we wish the influence of a set of inputs S⊆N to be the same as when the set of inputs is considered to be a single input; when intervening on S, we draw the states of i∈S based on the joint distribution of the states of features in S,πS(uS), as defined in Equation (1).

We can naturally define a distribution over X×∏i∈SXi, naturally extending (2) as:
π~(x,uS)=π(x)πS(uS).(9)
View Source

We also define the random variable X−SUS(x,uS)=x|N∖SuS; X−S(x,uS) has the states of features in N∖S fixed to their original values in x, but features in S take on new values according to uS.

Definition 2
SECTION Definition 2Set QII
For a quantity of interest Q, and an input i, the Quantitative Input Influence of set S⊆N on Q is defined to be
ιQ(S)=Q(X)−Q(X−SUS).
View SourceRight-click on figure for MathML and additional features.

Considering the influence of a set of inputs opens up a number of interesting questions due to the interaction between inputs. First among these is how does one measure the individual effect of a feature, given the measured effects of interventions on sets of features. One natural way of doing so is by measuring the marginal effect of a feature on a set.


Fig. 1:
A histogram of the highest specific causal influence for some feature across individuals in the adult dataset. Alone, most inputs alone have very low influence.

Show All

Definition 3
SECTION Definition 3Marginal QII
For a a quantity of interest Q, and an input i, the Quantitative Input Influence of input i over a set S⊆N on Q is defined to be
ιQ(i,S)=Q(X−SUS)−Q(X−S∪{i}US∪{i}).
View Source

Notice that marginal QII can also be viewed as a difference in set QIIs: ιQ(S∪{i})−ιQ(S). Informally, the difference between ιQ(S∪{i}) and ιQ(S) measures the “added value” obtained by intervening on S∪{i}, versus intervening on S alone.

The marginal contribution of i may vary significantly based on S. Thus, we are interested in the aggregate marginal contribution of i to S, where S is sampled from some natural distribution over subsets of N∖{i}. In what follows, we describe a few measures for aggregating the marginal contribution of a feature i to sets, based on different methods for sampling sets. The primary method of aggregating the marginal contribution is the Shapley value [14]. The less theoretically inclined reader can choose to proceed to Section V without a loss in continuity.

A. Cooperative Games and Causality
In this section, we discuss how measures from the theory of cooperative games define measures for aggregating marginal influence. In particular, we observe that the Shapley value [14] is characterized by axioms that are natural in our setting. However, other measures may be appropriate for certain input data generation processes.

Definition 2 measures the influence that an intervention on a set of features S⊆N has on the outcome. One can naturally think of Set QII as a function v:2N→R, where v(S) is the influence of S on the outcome. With this intuition in mind, one can naturally study influence measures using cooperative game theory, and in particular, prevalent influence measures in cooperative games such as the Shapley value, Banzhaf index and others. These measures can be thought of as influence aggregation methods, which, given an influence measure v:2N→R, output a vector ϕ∈Rn, whose i-th coordinate corresponds in some natural way to the aggregate influence, or aggregate causal effect, of feature i.

The original motivation for game-theoretic measures is revenue division [15, Chapter 18]: the function v describes the amount of money that each subset of players S⊆N can generate; assuming that the set N generates a total revenue of v(N), how should v(N) be divided amongst the players? A special case of revenue division that has received significant attention is the measurement of voting power [16]. In voting systems with multiple agents with differing weights, voting power often does not directly correspond to the weights of the agents. For example, the US presidential election can roughly be modeled as a cooperative game where each state is an agent. The weight of a state is the number of electors in that state (i.e., the number of votes it brings to the presidential candidate who wins that state). Although states like California and Texas have higher weight, swing states like Pennsylvania and Ohio tend to have higher power in determining the outcome of elections.

A voting system is modeled as a cooperative game: players are voters, and the value of a coalition S⊆N is 1 if S can make a decision (e.g. pass a bill, form a government, or perform a task), and is 0 otherwise. Note the similarity to classification, with players being replaced by features. The game-theoretic measures of revenue division are a measure of voting power: how much influence does player i have in the decision making process? Thus the notions of voting power and revenue division fit naturally with our goals when defining aggregate QII influence measures: in both settings, one is interested in measuring the aggregate effect that a single element has, given the actions of subsets.

A revenue division should ideally satisfy certain desiderata. Formally, we wish to find a function ϕ(N,v), whose input is N and v:2N→R, and whose output is a vector in Rn, such that ϕi(N,v) measures some quantity describing the overall contribution of the i-th player. Research on fair revenue division in cooperative games traditionally follows an axiomatic approach: define a set of properties that a revenue division should satisfy, derive a function that outputs a value for each player, and argue that it is the unique function that satisfies these properties.

Several canonical fair cooperative solution concepts rely on the fundamental notion of marginal contribution. given a player i and a set S⊆N∖{i}, the marginal contribution of i to S is denoted mi(S,v)=v(S∪{i})−v(S) (we simply write mi(S) when v is clear from the context). Marginal QII, as defined above, can be viewed as an instance of a measure of marginal contribution. Given a permutation π∈Π(N) of the elements in N, we define Pi(σ)={j∈N|σ(j)<σ(i)}; this is the set of i's predecessors in σ. We can now similarly define the marginal contribution of i to a permutation σ∈Π(N)) as mi(σ)=mi(Pi(σ)). Intuitively, one can think of the players sequentially entering a room, according to some ordering σ; the value mi(σ) is the marginal contribution that i has to whoever is in the room when she enters it.

Generally speaking, game theoretic influence measures specify some reasonable way of aggregating the marginal contributions of i to sets S⊆N. That is, they measure a player's expected marginal contribution to sets sampled from some distribution D over 2N, resulting in a payoff of
ES∼D[mi(S)]=∑S⊆NPrD[S]mi(S).
View Source

Thus, fair revenue division draws its appeal from the degree to which the distribution D is justifiable within the context where revenue is shared. In our setting, we argue for the use of the Shapley value. Introduced by the late Lloyd Shapley, the Shapley value is one of the most canonical methods of dividing revenue in cooperative games. It is defined as follows:
φi(N,v)=Eσ[mi(σ)]=1n!∑σ∈Π(N)mi(σ)
View Source

Intuitively, the Shapley value describes the following process: players are sequentially selected according to some randomly chosen order σ; each player receives a payment of mi(σ). The Shapley value is the expected payment to the players under this regime. The definition we use describes a distribution over permutations of N, not its subsets; however, it is easy to describe the Shapley value in terms of a distribution over subsets. If we define p[S]=1n1(n−1|S|), it is a simple exercise to show that
φi(N,v)=∑S⊆Np[S]mi(S).
View Source

Intuitively, p[S] describes the following process: first, choose a number k∈[0,n−1] uniformly at random; next, choose a set of size k uniformly at random.

The Shapley value is one of many reasonable ways of measuring influence; we provide a detailed review of two others — the Banzhaf index [17], and the Deegan-Packel index [18] — in Appendix A.

B. Axiomatic Treatment of the Shapley Value
In this work, the Shapley value is our function of choice for aggregating marginal feature influence. The objective of this section is to justify our choice, and provide a brief exposition of axiomatic game-theoretic value theory. We present the axioms that define the Shapley value, and discuss how they apply in the QII setting. As we show, by requiring some desired properties, one arrives at a game-theoretic influence measure as the unique function for measuring information use in our setting.

The Shapley value satisfies the following properties:

Definition 4
Definition 4 Symmetry (Sym)
We say that i,j∈N are symmetric if v(S∪{i})=v(S∪{j}) for all S⊆N∖{i,j}. A value ϕ satisfies symmetry if ϕi=ϕj whenever i and j are symmetric.

Definition 5
Definition 5 Dummy (Dum)
We say that a player i∈N is a dummy if v(S∪{i})=v(S) for all S⊆N. A value ϕ satisfies the dummy property if ϕi=0 whenever i is a dummy.

Definition 6
Definition 6 Efficiency (Eff)
A value satisfies the efficiency property if ∑i∈Nϕi=v(N).

All of these axioms take on a natural interpretation in the QII setting. Indeed, if two features have the same probabilistic effect, no matter what other interventions are already in place, they should have the same influence. In our context, the dummy axiom says that a feature that never offers information with respect to an outcome should have no influence. In the case of specific causal influence, the efficiency axiom simply states that the total amount of influence should sum to
=Pr(c(X)=c(x)|X=x)−Pr(c(X−N)=c(x)|X=x)1−Pr(c(X)=c(x))=Pr(c(X)≠c(x)).
View Source

That is, the total amount of influence possible is the likelihood of encountering elements whose evaluation is not c(x). This is natural: if the vast majority of elements have a value of c(x), it is quite unlikely that changes in features' state will have any effect on the outcome whatsoever; thus, the total amount of influence that can be assigned is Pr(c(X)≠c(x)). Similarly, if the vast majority of points have a value different from x, then it is likelier that a random intervention would result in a change in value, resulting in more influence to be assigned.

In the original paper by [14], it is shown that the Shapley value is the only function that satisfies (Sym), (Dum), (Eff), as well as the additivity (Add) axiom.

Definition 7
Definition 7 Additivity (Add)
Given two games ⟨N,v1⟩,⟨N,v2⟩, we write ⟨N,v1+v2⟩ to denote the game v′(S)=v1(S)+v2(S) for all S⊆N. A value ϕ satisfies the additivity property if ϕi(N,v1)+ϕi(N,v2)=ϕi(N,v1+v2) for all i∈N.

In our setting, the additivity axiom makes little intuitive sense; it would imply, for example, that if we were to multiply Q by a constant c, the influence of i in the resulting game should be multiplied by c as well, which is difficult to justify.

[19] offers an alternative characterization of the Shapley value, based on the more natural monotonicity assumption, which is a strong generalization of the dummy axiom.

Definition 8
Definition 8 Monotonicity (Mono)
Given two games ⟨N,v1⟩,⟨N,v2⟩, a value ϕ satisfies strong monotonicity if mi(S,v1)≥mi(S,v2) for all S implies that ϕi(N,v1)≥ϕi(N,v2), where a strict inequality for some set S⊆N implies a strict inequality for the values as well.

Monotonicity makes intuitive sense in the QII setting: if a feature has consistently higher influence on the outcome in one setting than another, its measure of influence should increase. For example, if a user receives two transparency reports (say, for two separate loan applications), and in one report gender had a consistently higher effect on the outcome than in the other, then the transparency report should reflect this.

Theorem 9 [19]
The Shapley value is the only function that satisfies (Sym), (Eff) and (Mono).

To conclude, the Shapley value is a unique way of measuring aggregate influence in the QII setting, while satisfying a set of very natural axioms.

SECTION IV.Transparency Schemas
We now discuss two generalizations of the definitions presented in Section II, and then define a transparency schema that map the space of transparency reports based on QII.

a) Intervention Distribution
In this paper we only consider randomized interventions when the interventions are drawn independently from the priors of the given input. However, depending on the specific causal question at hand, we may use different interventions. Formally, this is achieved by allowing an arbitrary intervention distribution πinter such that
π~(x,u)=π|(x)πinter(u).
View Source

The subsequent definitions remain unchanged. One example of an intervention different from the randomized intervention considered in the rest of the paper is one held constant at a vector x0:
πinterx0(u)={10for u=x0o.w.
View SourceRight-click on figure for MathML and additional features.

A QII measure defined on the constant intervention as defined above, measures the influence of being different from a default, where the default is represented by x0.

b) Difference Measure
A second generalization allows us to consider quantities of interest which are not real numbers. Consider, for example, the situation where the quantity of interest is an output probability distribution, as in the case in a randomized classifier. In this setting, a suitable measure for quantifying the distance between distributions can be used as a difference measure between the two quantities of interest. Examples of such difference measures include the KL-divergence [20] between distribution or distance metrics between vectors.

c) Transparency Schema
We now present a transparency schema that maps the space of transparency reports based on QII measures. It consists of the following elements:

A quantity of interest, which captures the aspect of the system we wish to gain transparency into.

An intervention distribution, which defines how a counterfactual distribution is constructed from the true distribution.

A difference measure, which quantifies the difference between two quantities of interest.

An aggregation technique, which combines marginal QII measures across different subsets of inputs (features).

For a given application, one has to appropriately instantiate this schema. We have described several instances of each schema element. The choices of the schema elements are guided by the particular causal question being posed. For instance, when the question is: “Which features are most important for group disparity?”, the natural quantity of interest is a measure of group disparity, and the natural intervention distribution is using the prior as the question does not suggest a particular bias. On the other hand, when the question is: “Which features are most influential for person A's classification as opposed to person B?”, a natural quantity of interest is person A's classification, and a natural intervention distribution is the constant intervention using the features of person B. A thorough exploration of other points in this design space remains an important direction for future work.

SECTION V.Estimation
While the model we propose offers several appealing properties, it faces several technical implementation issues. Several elements of our work require significant computational effort; in particular, both the probability that a change in feature state would cause a change in outcome, and the game-theoretic influence measures are difficult to compute exactly. In the following sections we discuss these issues and our proposed solutions.

A. Computing Power Indices
Computing the Shapley or Banzhaf values exactly is generally computationally intractable (see [21, Chapter 4] for a general overview); however, their probabilistic nature means that they can be well-approximated via random sampling. More formally, given a random variable X, suppose that we are interested in estimating some determined quantity q(X) (say, q(X) is the mean of X); we say that a random variable q∗ is an ε−δ approximation of q(X) if
Pr[|q∗−q(X)|≥ε]<δ;
View Sourcein other words, it is extremely likely that the difference between q(X) and q∗ is no more than ε. An ε−δ approximation scheme for q(X) is an algorithm that for any ε,δ∈(0,1) is able to output a random variable q∗ that is an ε−δ approximation of q(X), and runs in time polynomial in 1ε,log1δ.

[22] show that when ⟨N,v⟩ is a simple game (i.e. a game where v(S)∈{0,1} for all S⊆N), there exists an ε−δ approximation scheme for both the Banzhaf and Shapley values; that is, for ϕ∈{φ,β}, we can guarantee that for any ε,δ>0, with probability ≥1−δ, we output a value ϕ∗i such that |ϕ∗i−ϕi|<ε.

More generally, [23] observe that the number of i.i.d. samples needed in order to approximate the Shapley value and Banzhaf index is parametrized in Δ(v)=maxS⊆Nv(S)−minS⊆Nv(S). Thus, if Δ(v) is a bounded value, then an ε−δ approximation exists. In our setting, coalitional values are always within the interval [0, 1], which immediately implies the following theorem.

Theorem 10
There exists an ε−δ approximation scheme for the Banzhaf and Shapley values in the QII setting.

B. Estimating Q
Since we do not have access to the prior generating the data, we simply estimate it by observing the dataset itself. Recall that X is the set of all possible user profiles; in this case, a dataset is simply a multiset (i.e. possibly containing multiple copies of user profiles) contained in X. Let D be a finite multiset of X, the input space. We estimate probabilities by computing sums over D. For example, for a classifier c, the probability of c(X)=1.
E^D(c(X)=1)=∑x∈D1(c(x)=1)|D|.(10)
View SourceRight-click on figure for MathML and additional features.

Given a set of features S⊆N, let D|S denote the elements of D truncated to only the features in S. Then, the intervened probability can be estimated as follows:
E^D(c(X−S)=1)=∑uS∈D|S∑x∈D1(c(x|N∖SuS)=1)|D|2.(11)
View SourceRight-click on figure for MathML and additional features.

Similarly, the intervened probability on individual outcomes can be estimated as follows:
E^D(c(X−S)=1|X=x)=∑uS∈DS1(c(x|N∖SuS)=1)|D|.(12)
View SourceRight-click on figure for MathML and additional features.

Finally, let us observe group disparity:
∣∣E^D(c(X−S)=1|X∈Y)−E^D(c(X−S)=1|X∉Y)∣∣
View SourceRight-click on figure for MathML and additional features.

The term E^D(c(X−S)=1|X∈Y) equals
1|Y|∑x∈Y∑u∈DS1(c(x|N∖SuS)=1),
View SourceRight-click on figure for MathML and additional features.

Thus group disparity can be written as:
∣∣1|Y|∑x∈Y∑uS∈DS1(c(x|N∖SuS)=1)−1|D∖Y|∑x∈D∖Y∑uS∈DS1(c(x|N∖SuS)=1)∣∣.(13)
View SourceRight-click on figure for MathML and additional features.

We write Q^Ydisp(S) to denote (13).

If D is large, these sums cannot be computed efficiently. Therefore, we approximate the sums by sampling from the dataset D. It is possible to show using the According to the Hoeffding bound [24], partial sums of n random variables Xi, within a bound Δ, can be well-approximated with the following probabilistic bound:
Pr(∣∣∣1n∑i=1n(Xi−EXi)∣∣∣≥ε)≤2exp(−2nε2Δ)
View Source

Since all the samples of measures discussed in the paper are bounded within the interval [0, 1], we admit an ε−δ approximation scheme where the number of samples n can be chosen to be greater than log(2/δ)/2ε2. Note that these bounds are independent of the size of the dataset. Therefore, given an efficient sampler, these quantities of interest can be approximated efficiently even for large datasets.

SECTION VI.Private Transparency Reports
One important concern is that releasing influence measures estimated from a dataset might leak information about individual users; our goal is providing accurate transparency reports, without compromising individual users' private data. To mitigate this concern, we add noise to make the measures differentially private. We show that the sensitivities of the QII measures considered in this paper are very low and therefore very little noise needs to be added to achieve differential privacy.

The sensitivity of a function is a key parameter in ensuring that it is differentially private; it is simply the worst-case change in its value, assuming that we change a single data point in our dataset. Given some function f over datasets, we define the sensitivity of a function f with respect to a dataset D, denoted by Δf(D) as
maxD′|f(D)−f(D′)|
View SourceRight-click on figure for MathML and additional features.where D and D′ differ by at most one instance. We use the shorthand Δf when D is clear from the context.

In order to not leak information about the users used to compute the influence of an input, we use the standard Laplace Mechanism [8] and make the influence measure differentially private. The amount of noise required depends on the sensitivity of the influence measure. We show that the influence measure has low sensitivity for the individuals used to sample inputs. Further, due to a result from [9] (and stated in [25]), sampling amplifies the privacy of the computed statistic, allowing us to achieve high privacy with minimal noise addition.

The standard technique for making any function differentially private is to add Laplace noise calibrated to the sensitivity of the function:

VI.Theorem 11 [8]
For any function f from datasets to R, the mechanism Kf that adds independently generated noise with distribution Lap (Δf(D)/ϵ) to the k output enjoys ϵ− differential privacy.

Since each of the quantities of interest aggregate over a large number of instances, the sensitivity of each function is very low.

VI.Theorem 12
Given a dataset D,

ΔE^D(c(X)=1)=1|D|

ΔE^D(c(X−S)=1)≤2|D|

ΔE^D(c(X−S)=1|X=x)=1|D|

Q^Ydisp(S)≤max{1|D∩Y|,1|D∖Y|}

VI.Proof
We examine some cases here. In Equation (10), if two datasets differ by one instance, then at most one term of the summation will differ. Since each term can only be either 0 or 1, the sensitivity of the function is
ΔE^D(c(X)=1)=∣∣∣0|D|−1|D|∣∣∣=1|D|.
View SourceRight-click on figure for MathML and additional features.

Similarly, in Equation (11), an instance appears 2|D|−1 times, once each for the inner summation and the outer summation, and therefore, the sensitivity of the function is
ΔE^D(c(X−S)=1)=2|D|−1|D|2≤2|D|.
View SourceRight-click on figure for MathML and additional features.

For individual outcomes (Equation (12)), similarly, only one term of the summation can differ. Therefore, the sensitivity of (12) is 1/|D|.

Finally, we observe that a change in a single element x′ of D will cause a change of at most 1|D∩Y| if x′∈D∩Y, or of at most 1|D∖Y| if x′∈D∖Y. Thus, the maximal change to (13) is at most max{1|Y|,1|D∖Y|}.□

While the sensitivity of most quantities of interest is low (at most a 2|D|), Q^Ydisp(S) can be quite high when |Y| is either very small or very large. This makes intuitive sense: if Y is a very small minority, then any changes to its members are easily detected; similarly, if Y is a vast majority, then changes to protected minorities may be easily detected.

We observe that the quantities of interest which exhibit low sensitivity will have low influence sensitivity as well: for example, the local influence of S is 1(c(x)=1)−E^D(c(X−S)=1] | X=x); changing any x′∈D (where x′≠x will result in a change of at most 1|D| to the local influence.

Finally, since the Shapley and Banzhaf indices are normalized sums of the differences of the set influence functions, we can show that if an influence function ι has sensitivity Δι, then the sensitivity of the indices are at most 2Δι.

To conclude, all of the QII measures discussed above (except for group parity) have a sensitivity of α|D|, with α being a small constant. To ensure differential privacy, we need only need add noise with a Laplacian distribution Lap (k/|D|) to achieve 1-differential privacy.

Further, it is known that sampling amplifies differential privacy.

VI.Theorem 13 [9], [25]
If A is 1-differentially private, then for any ϵ∈(0,1),A′(ϵ) is 2ϵ-differentially private, where A′(ϵ) is obtained by sampling an ϵ fraction of inputs and then running A on the sample.

Therefore, our approach of sampling instances from D to speed up computation has the additional benefit of ensuring that our computation is private.

Table I contains a summary of all QII measures defined in this paper, and their sensitivity.

SECTION VII.Experimental Evaluation
We demonstrate the utility of the QII framework by developing two simple machine learning applications on real datasets. Using these applications, we first argue, in Section VII-A, the need for causal measurement by empirically demonstrating that in the presence of correlated inputs, observational measures are not informative in identifying which inputs were actually used. In Section VII-B, we illustrate the distinction between different quantities of interest on which Unary QII can be computed. We also illustrate the effect of discrimination on the QII measure. In Section VII-C, we analyze transparency reports of three individuals to demonstrate how Marginal QII can provide insights into individuals' classification outcomes. Finally, we analyze the loss in utility due to the use of differential privacy, and provide execution times for generating transparency reports using our prototype implementation.

We use the following datasets in our experiments:

adult [10]: This standard machine learning benchmark dataset is a a subset of US census data that classifies the income of individuals, and contains factors such as age, race, gender, marital status and other socio-economic parameters. We use this dataset to train a classifier that predicts the income of individuals from other parameters. Such a classifier could potentially be used to assist credit decisions.

arrests [11]: The National Longitudinal Surveys are a set of surveys conducted by the Bureau of Labor Statistics of the United States. In particular, we use the National Longitudinal Survey of Youth 1997 which is a survey of young men and women born in the years 1980–84. Respondents were ages 12–17 when first interviewed in 1997 and were subsequently interviewed every year till 2013. The survey covers various aspects of an individual's life such as medical history, criminal records and economic parameters. From this dataset, we extract the following features: age, gender, race, region, history of drug use, history of smoking, and history of arrests. We use this data to train a classifier that predicts history of arrests to aid in predictive policing, where socio-economic factors are used to decide whether individuals should receive a visit from the police. This application is inspired by a similar application in [26].

The two applications described above are hypothetical examples of decision-making aided by machine learning that use potentially sensitive socio-economic data about individuals, and not real systems that are currently in use. We use these classifiers to illustrate the subtle causal questions that our QII measures can answer.

We use the following standard machine learning classifiers in our dataset: Logistic Regression, SVM with a radial basis function kernel, Decision Tree, and Gradient Boosted Decision Trees. Bishop's machine learning text [27] is an excellent resource for an introduction to these classifiers. While Logistic Regression is a linear classifier, the other three are nonlinear and can potentially learn very complex models. All our experiments are implemented in Python with the numpy library, and the scikit-learn machine learning toolkit, and run on an Intel i7 computer with 4 GB of memory.

A. Comparison with Observational Measures
In the presence of correlated inputs, observational measures often cannot identify which inputs were causally influential. To illustrate this phenomena on real datasets, we train two classifiers: (A) where gender is provided as an actual input, and (B) where gender is not provided as an input. For classifier (B), clearly the input Gender has no effect and any correlation between the outcome and gender is caused via inference from other inputs. In Table II, for both the adult and the arrests dataset, we compute the following observational measures: Mutual Information (MI), Jaccard Index (Jaccard), Pearson Correlation (corr), and the Disparate Impact Ratio (disp) to measure the similarity between Gender and the classifiers outcome. We also measure the QII of Gender on outcome. We observe that in many scenarios the observational quantities do not change, or sometimes increase, from classifier A to classifier B, when gender is removed as an actual input to the classifier. On the other hand, if the outcome of the classifier does not depend on the input Gender, then the QII is guaranteed to be zero.

Table I: A summary of the QII measures defined in the paper

B. Unary QII Measures
In Figure 2, we illustrate the use of different Unary QII measures. Figures 2a, and 2b, show the Average QII measure (Equation (5)) computed for features of a decision forest classifier. For the income classifier trained on the adult dataset, the feature with highest influence is Marital Status, followed by Occupation, Relationship and Capital Gain. Sensitive features such as Gender and Race have relatively lower influence. For the predictive policing classifier trained on the arrests dataset, the most influential input is Drug History, followed by Gender, and Smoking History. We observe that influence on outcomes may be different from influence on group disparity.

QII on Group Disparity
Figures 2c, 2d show influences of features on group disparity for two different settings. The figure on the left shows the influence of features on group disparity by Gender in the adult dataset; the figure on the right shows the influence of group disparity by Race in the arrests dataset. For the income classifier trained on the adult dataset, we observe that most inputs have negative influence on group disparity; randomly intervening on most inputs would lead to a reduction in group disparity. In other words, a classifier that did not use these inputs would be fairer. Interestingly, in this classifier, marital status and not sex has the highest influence on group disparity by sex.

For the arrests dataset, most inputs have the effect of increasing group disparity if randomly intervened on. In particular, Drug history has the highest positive influence on disparity in arrests. Although Drug history is correlated with race, using it reduces disparate impact by race, i.e. makes fairer decisions.

In both examples, features correlated with the sensitive attribute are the most influential for group disparity according to the sensitive attribute instead of the sensitive attribute itself. It is in this sense that QII measures can identify proxy variables that cause associations between outcomes and sensitive attributes.

QII with Artificial Discrimination
We simulate discrimination using an artificial experiment. We first randomly assign ZIP codes to individuals in our dataset. Then to simulate systematic bias, we make an f fraction of the ZIP codes discriminatory in the following sense: All individuals in the protected set are automatically assigned a negative classification outcome. We then study the change in the influence of features as we increase f. Figure 3a, shows that the influence of Gender increases almost linearly with f. Recall that Marital Status was the most influential feature for this classifier without any added discrimination. As f increases, the importance of Marital Status decreases as expected, since the number of individuals for whom Marital Status is pivotal decreases.

C. Personalized Transparency Reports
To illustrate the utility of personalized transparency reports, we study the classification of individuals who received potentially unexpected outcomes. For the personalized transparency reports, we use decision forests.

The influence measure that we employ is the Shapley value, with the underlying cooperative game defined over the local influence Q. In more detail, v(S)=ιQA(S), with QA being E[c(⋅)=1|X=x]; that is, the marginal contribution of i∈N to S is given by mi(S)=E[c(X−S)=1|X=x]−E[c(X−S∪{i})=1|X=x].

We emphasize that some features may have a negative Shapley value; this should be interpreted as follows: a feature with a high positive Shapley value often increases the certainty that the classification outcome is 1, whereas a feature whose Shapley value is negative is one that increases the certainty that the classification outcome would be zero.

Mr. X
The first example is of an individual from the adult dataset, who we refer to as Mr. X, and is described in Figure 4a. He is is deemed to be a low income individual, by an income classifier learned from the data. This result may be surprising to him: he reports high capital gains (14k),andonly2.110k are reported as low income. In fact, he might be led to believe that his classification may be a result of his ethnicity or country of origin. Examining his transparency report in Figure 4b, however, we find that the the most influential features that led to his negative classification were Marital Status, Relationship and Education.

Table II: Comparison of QII with associative measures. For 4 different classifiers, we compute metrics such as mutual information (MI), jaccard index (JI), pearson correlation (corr), group disparity (disp) and average QII between gender and the outcome of the learned classifier. Each metric is computed in two situations: (A) When gender is provided as an input to the classifier, and (B) when gender is not provided as an input to the classifier

Mr. Y
The second example, to whom we refer as Mr. Y (Figure 5), has even higher capital gains than Mr. X. Mr. Y is a 27 year old, with only Preschool education, and is engaged in fishing. Examination of the transparency report reveals that the most influential factor for negative classification for Mr. Y is his Occupation. Interestingly, his low level of education is not considered very important by this classifier.

Mr. Z
The third example, who we refer to as Mr. Z (Figure 6) is from the arrests dataset. History of drug use and smoking are both strong indicators of arrests. However, Mr. X received positive classification by this classifier even without any history of drug use or smoking. On examining his classifier, it appears that race, age and gender were most influential in determining his outcome. In other words, the classifier that we train for this dataset (a decision forest) has picked up on the correlations between race (Black), and age (born in 1984) to infer that this individual is likely to engage in criminal activity. Indeed, our interventional approach indicates that this is not a mere correlation effect: race is actively being used by this classifier to determine outcomes. Of course, in this instance, we have explicitly offered the race parameter to our classifier as a viable feature. However, our influence measure is able to pick up on this fact, and alert us of the problematic behavior of the underlying classifier. More generally, this example illustrates a concern with the black box use of machine learning which can lead to unfavorable outcomes for individuals.

D. Differential Privacy
Most QII measures considered in this paper have very low sensitivity, and therefore can be made differentially private with negligible loss in utility. However, recall that the sensitivity of influence measure on group disparity ιYdisp depends on the size of the protected group in the dataset D as follows:
ιYdisp=2max(1|D∖Y|,1|D∩Y|)
View SourceRight-click on figure for MathML and additional features.

For sufficiently small minority groups, a large amount of noise might be required to ensure differential privacy, leading to a loss in utility of the QII measure. To estimate the loss in utility, we set a noise of 0.005 as the threshold of noise at which the measure is no longer useful, and then compute fraction of times noise crosses that threshold when Laplacian noise is added at ϵ=1. The results of this experiment are as follows: Y Count Loss in Utility Race: White 27816 2.97×10−14 Race: Black 3124 5.41×10−14 Race: Asian-Pac-Islander 1039 6.14×10−05 Race: Amer-Indian-Eskimo 311 0.08 Race: Other 271 0.13 Gender: Male 21790 3.3×10−47 Gender: Female 10771 3.3×10−47

We note that for most reasonably sized groups, the loss in utility is negligible. However, the Asian-Pac-Islander, and the Amer-Indian-Eskimo racial groups are underrepresented in this dataset. For these groups, the QII on Group Disparity estimate needs to be very noisy to protect privacy.

E. Performance
We report runtimes of our prototype for generating transparency reports on the adult dataset. Recall from Section VI that we approximate QII measures by computing sums over samples of the dataset. According to the Hoeffding bound to derive an (ϵ,δ) estimate of a QII measure, at ϵ=0.01, and n=37000 samples, δ=2exp(−nϵ2)<0.05 is an upper bound on the probability of the output being off by ϵ. Table III shows the runtimes of four different QII computations, for 37000 samples each. The runtimes of all algorithms except for kernel SVM are fast enough to allow real-time feedback for machine learning application developers. Evaluating QII metrics for Kernel SVMs is much slower than the other metrics because each call to the SVM classifier is very computationally intensive due to a large number of distance computations that it entails. We expect that these runtimes can be optimized significantly. We present them as proof of tractability.

Fig. 2: - QII measures for the adult and arrests datasets
Fig. 2:
QII measures for the adult and arrests datasets

Show All

Table III: Runtimes in seconds for transparency report computation

SECTION VIII.Discussion
A. Probabilistic Interpretation of Power Indices
In order to quantitatively measure the influence of data inputs on classification outcomes, we propose causal interventions on sets of features; as we argue in Section III, the aggregate marginal influence of i for different subsets of features is a natural quantity representing its influence. In order to aggregate the various influences i has on the outcome, it is natural to define some probability distribution over (or equivalently, a weighted sum of) subsets of N∖{i}, where Pr[S] represents the probability of measuring the marginal contribution of i to S;Pr[S] yields a value ∑S⊆N∖{i}mi(S).

For the Banzhaf index, we have Pr[S]=12n−1, the Shapley value has Pr[S]=k!(n−k−1)!n! (here, |S|=k), and the Deegan-Packel Index selects minimal winning coalitions uniformly at random. These choices of values for Pr[S] are based on some natural assumptions on the way that players (features) interact, but they are by no means exhaustive. One can define other sampling methods that are more appropriate for the model at hand; for example, it is entirely possible that the only interventions that are possible in a certain setting are of size ≤k+1, it is reasonable to aggregate the marginal influence of i over sets of size ≤k, i.e.
Pr[S]={1(n−1|S|)0if |S|≤kotherwise.
View Source


Fig. 3:
The effect of discrimination on QII.

Show All

The key point here is that one must define some aggregation method, and that choice reflects some normative approach on how (and which) marginal contributions are considered. The Shapley and Banzhaf indices do have some highly desirable properties, but they are, first and foremost, a-priori measures of influence. That is, they do not factor in any assumptions on what interventions are possible or desirable.

One natural candidate for a probability distribution over S is some natural extension of the prior distribution over the dataset; for example, if all features are binary, one can identify a set with a feature vector (namely by identifying each S⊆N with its indicator vector), and set Pr[S]=π(S) for all S⊆N. If features are not binary, then there is no canonical way to transition from the data prior to a prior over subsets of features.

Fig. 4: - Mr. X
Fig. 4:
Mr. X

Show All

B. Fairness
Due to the widespread and black box use of machine learning in aiding decision making, there is a legitimate concern of algorithms introducing and perpetuating social harms such as racial discrimination [28], [6]. As a result, the algorithmic foundations of fairness in personal information processing systems have received significant attention recently [29], [30], [31], [12], [32]. While many of of the algorithmic approaches [29], [31], [32] have focused on group parity as a metric for achieving fairness in classification, Dwork et al. [12] argue that group parity is insufficient as a basis for fairness, and propose a similarity-based approach which prescribes that similar individuals should receive similar classification outcomes. However, this approach requires a similarity metric for individuals which is often subjective and difficult to construct.

QII does not suggest any normative definition of fairness. Instead, we view QII as a diagnostic tool to aid fine-grained fairness determinations. In fact, QII can be used in the spirit of the similarity based definition of [12]. By comparing the personalized privacy reports of individuals who are perceived to be similar but received different classification outcomes, and identifying the inputs which were used by the classifier to provide different outcomes. Additionally, when group parity is used as a criteria for fairness, QII can identify the features that lead to group disparity, thereby identifying features being used by a classifier as a proxy for sensitive attributes.

Fig. 5: - Mr. Y.
Fig. 5:
Mr. Y.

Show All

The determination of whether using certain proxies for sensitive attributes is discriminatory is often a task-specific normative judgment. For example, using standardized test scores (e.g., SAT scores) for admissions decisions is by and large accepted, although SAT scores may be a proxy for several protected attributes. In fact, several universities have recently announced that they will not use SAT scores for admissions citing this reason [33], [34]. Our goal is not to provide such normative judgments. Rather we seek to provide fine-grained transparency into input usage (e.g., what's the extent to which SAT scores influence decisions), which is useful to make determinations of discrimination from a specific normative position.

Finally, we note that an interesting question is whether providing a sensitive attribute as an input to a classifier is fundamentally discriminatory behavior, even if QII can show that the sensitive input has no significant impact on the outcome. Our view is that this is a policy question and different legal frameworks might take different viewpoints on it. At a technical level, from the standpoint of information use, the two situations are identical: the sensitive input is not really used although it is supplied. However, the very fact that it was supplied might be indicative of an intent to discriminate even if that intended goal was not achieved. No matter what the policy decision is on this question, QII remains a useful diagnostic tool for discrimination because of the presence of proxy variables as described earlier.

Fig. 6: - Mr. Z.
Fig. 6:
Mr. Z.

Show All

SECTION IX.Related Work
A. Quantitative Causal Measures
Causal models and probabilistic interventions have been used in a few other settings. While the form of the interventions in some of these settings may be very similar, our generalization to account for different quantities of interests enables us to reason about a large class of transparency queries for data analytics systems ranging from classification outcomes of individuals to disparity among groups. Further, the notion of marginal contribution which we use to compute responsibility does not appear in this line of prior work.

Janzing et al. [35] use interventions to assess the causal importance of relations between variables in causal graphs; in order to assess the causal effect of a relation between two variables, X→Y (assuming that both take on specific values X=x and Y=y), a new causal model is constructed, where the value of X is replaced with a prior over the possible values of X. The influence of the causal relation is defined as the KL-Divergence of the joint distribution of all the variables in the two causal models with and without the value of X replaced. The approach of the intervening with a random value from the prior is similar to our approach of constructing X−S.

Independently, there has been considerable work in the machine learning community to define importance metrics for variables, mainly for the purpose of feature selection (see [36] for a comprehensive overview). One important metric is called Permutation Importance [37], which measures the importance of a feature towards classification by randomly permuting the values of the feature and then computing the difference of classification accuracies before and after the permutation. Replacing a feature with a random permutation can be viewed as a sampling the feature independently from the prior.

There exists extensive literature on establishing causal relations, as opposed to quantifying them. Prominently, Pearl's work [38] provides a mathematical foundation for causal reasoning and inference. In [39], Tian and Pearl discuss measures of causal strength for individual binary inputs and outputs in a probabilistic setting. Another thread of work by Halpern and Pearl discusses actual causation [40], which is extended in [41] to derive a measure of responsibility as degree of causality. In [41], Chockler and Halpern define the responsibility of a variable X to an outcome as the amount of change required in order to make X the counterfactual cause. As we discuss in Appendix A-B, the Deegan-Packel index is strongly related to causal responsibility.

B. Quantitative Information Flow
One can think of our results as a causal alternative to quantitative information flow. Quantitative information flow is a broad class of metrics that quantify the information leaked by a process by comparing the information contained before and after observing the outcome of the process. Quantitative Information Flow traces its information-theoretic roots to the work of Shannon [42] and Rényi [43]. Recent works have proposed measures for quantifying the security of information by measuring the amount of information leaked from inputs to outputs by certain variables; we point the reader to [44] for an overview, and to [45] for an exposition on information theory. Quantitative Information Flow is concerned with information leaks and therefore needs to account for correlations between inputs that may lead to leakage. The dual problem of transparency, on the other hand, requires us to destroy correlations while analyzing the outcomes of a system to identify the causal paths for information leakage.

C. Interpretable Machine Learning
An orthogonal approach to adding interpretability to machine learning is to constrain the choice of models to those that are interpretable by design. This can either proceed through regularization techniques such as Lasso [46] that attempt to pick a small subset of the most important features, or by using models that structurally match human reasoning such as Bayesian Rule Lists [47], Supersparse Linear Integer Models [48], or Probabilistic Scaling [49]. Since the choice of models in this approach is restricted, a loss in predictive accuracy is a concern, and therefore, the central focus in this line of work is the minimization of the loss in accuracy while maintaining interpretability. On the other hand, our approach to interpretability is forensic. We add interpretability to machine learning models after they have been learnt. As a result, our approach does not constrain the choice of models that can be used.

D. Experimentation on Web Services
There is an emerging body of work on systematic experimentation to enhance transparency into Web services such as targeted advertising [50], [51], [52], [53], [54]. The setting in this line of work is different since they have restricted access to the analytics systems through publicly available interfaces. As a result they only have partial control of inputs, partial observability of outputs, and little or no knowledge of input distributions. The intended use of these experiments is to enable external oversight into Web services without any cooperation. Our framework is more appropriate for a transparency mechanism where an entity proactively publishes transparency reports for individuals and groups. Our framework is also appropriate for use as an internal or external oversight tool with access to mechanisms with control and knowledge of input distributions, thereby forming a basis for testing.

E. Game-Theoretic Influence Measures
Recent years have seen game-theoretic influence measures used in various settings. Datta et al. [55] also define a measure for quantifying feature influence in classification tasks. Their measure does not account for the prior on the data, nor does it use interventions that break correlations between sets of features. In the terminology of this paper, the quantity of interest used by [55] is the ability of changing the outcome by changing the state of a feature. This work greatly extends and generalizes the concepts presented in [55], by both accounting for interventions on sets, and by generalizing the notion of influence to include a wide range of system behaviors, such as group disparity, group outcomes and individual outcomes.

Game theoretic measures have been used by various research disciplines to measure influence. Indeed, such measures are relevant whenever one is interested in measuring the marginal contribution of variables, and when sets of variables are able to cause some measurable effect. Lindelauf et al. [56] and Michalak et al. [57] use game theoretic influence measures on graph-based games in order to identify key members of terrorist networks. Del Pozo et al. [58] and Michalak et al. [59] use similar ideas for identifying important members of large social networks, providing scalable algorithms for influence computation. Bork et al. [60] use the Shapley value to assign importance to protein interactions in large, complex biological interaction networks; Keinan et al. [61] employ the Shapley value in order to measure causal effects in neurophysical models. The novelty in our use of the game theoretic power indices lies in the conception of a cooperative game via a valuation function ι(S), defined by an randomized intervention on inputs S. Such an intervention breaks correlations and allows us to compute marginal causal influences on a wide range of system behaviors.

SECTION X.Conclusion & Future Work
In this paper, we present QII, a general family of metrics for quantifying the influence of inputs in systems that process personal information. In particular, QII lends insights into the behavior of opaque machine learning algorithms by allowing us to answer a wide class of transparency queries ranging from influence on individual causal outcomes to influence on disparate impact. To achieve this, QII breaks correlations between inputs to allow causal reasoning, and computes the marginal influence of inputs in situations where inputs cannot affect outcomes alone. Also, we demonstrate that QII can be efficiently approximated, and can be made differentially private with negligible noise addition in many cases.

An immediate next step in this line of work is to explore adoption strategies in the many areas that use personal information to aid decision making. Areas such as healthcare [3], predictive policing [1], education [4], and defense [5] all have a particularly acute need for transparency in their decision making. It is likely that specific applications will guide us in our choice of a QII metric that is appropriate for that scenario, which includes a choice for our game-theoretic power index.

We have not considered situations where inputs do not have well understood semantics. Such situations arise often in settings such as image or speech recognition, and automated video surveillance. with the proliferation of immense processing power, complex machine learning models such as deep neural networks have become ubiquitous in these domains. Defining transparency and developing analysis techniques in such settings is important future work.

In what follows, we describe two alternatives to the Shapley value used in this work. The Shapley value makes intuitive sense in our setting, as we argue in Section III-B. However, other measures may be appropriate for certain input data generation processes. In what follows we revisit the Banzhaf index, briefly discussed in Section III-A, and introduce the readers to the Deegan-Packel index, a game-theoretic influence measure with deep connections to a formal theory of responsibilty and blame [41].

A.
A. The Banzhaf Index
Recall that the Banzhaf index, denoted βi(N,v) is defined as follows:
βi(N,v)=12n−1∑S⊆N∖{i}mi(S).
View SourceRight-click on figure for MathML and additional features.

The Banzhaf index can be thought of as follows: each j∈N∖{i} will join a work effort with probability 12 (or, equivalently, each S⊆N∖{i} has an equal chance of forming); if i joins as well, then its expected marginal contribution to the set formed is exactly the Banzhaf index. Note the marked difference between the probabilistic models: under the Shapley value, we sample permutations uniformly at random, whereas under the regime of the Banzhaf index, we sample sets uniformly at random. The different sampling protocols reflect different normative assumptions. For one, the Banzhaf index is not guaranteed to be efficient; that is, ∑i∈Nβi(N,v) is not necessarily equal to v(N), whereas it is always the case that ∑ni=1φi(N,v)=v(N). Moreover, the Banzhaf index is more biased towards measuring the marginal contribution of i to sets of size n2±O(n−−√); this is because the expected size of a randomly selected set follows a binomial distribution B(n,12). On the other hand, the Shapley value is equally likely to measure the marginal contribution of i to sets of any size k∈{0,…,k}, as i is equally likely to be in any one position in a randomly selected permutation σ (and, in particular, the the set of i's predecessors in σ is equally likely to have any size k\in\{0,\ldots,n-1\}).

Going back to the QII setting, the difference in sampling procedure is not merely an interesting anecdote: it is a significant modeling choice. Intuitively, the Banzhaf index is more appropriate if we assume that large sets of features would have a significant influence on outcomes, whereas the Shapley value is more appropriate if we assume that even small sets of features might cause significant effects on the outcome. Indeed, as we mention in Section VIII, aggregating the marginal influence of i over sets is a significant modeling choice; while using the measures proposed here is perfectly reasonable in many settings, other aggregation methods may be applicable in others.

Unlike the Shapley value, the Banzhaf index is not guaranteed to be efficient (although it does satisfy the symmetry and dummy properties). Indeed, [62] shows that replacing the efficiency axiom with an alternative axiom, uniquely characterizes the Banzhaf index; the axiom, called 2-efficiency, prescribes the behavior of an influence measure when two players merge. First, let us define a merged game; given a game \langle N,v\rangle, and two players i,j\in N, we write T=\{i,j\}. We define the game \bar{v} on N\backslash T\cup\{\bar{t}\} as follows: for every set S\subseteq N\backslash\{i,j\},\bar{v}(S)=v(S), and \bar{v}(S\cup\{\bar{t})=v(S\cup\{i,j\}), note that the added player \bar{t} represents the two players i and j who are now acting as one. The 2-Efficiency axiom states that influence should be invariant under merges.

Definition 14
Definition 14 2-Efficiency (2-EFF)
Given two players i,j\in N, let \bar{v} be the game resulting from the merge of i and j into a single player \bar{t}; an influence measure \phi satisfies 2-Efficiency if \phi_{i}(N,v)+\phi_{j}(N,v)=\phi_{\bar{t}}(N\backslash\{i, j\}\cup\{\bar{t}\},\bar{v}).

Theorem 15 [62]
The Banzhaf index is the only function to satisfy (Sym), (D), (Mono) and (2-EFF).

In our context, 2-Efficiency can be interpreted as follows: suppose that we artificially treat two features i and j as one, keeping all other parameters fixed; in this setting, 2-efficiency means that the influence of merged features equals the influence they had as separate entities.

B.
B. The Deegan-Packel Index
Finally, we discuss the Deegan-Packel index [18]. While the Shapley value and Banzhaf index are well-defined for any coalitional game, the Deegan-Packel index is only defined for simple games. A cooperative game is said to be simple if v(S)\in\{0,1\} for all S\subseteq N. In our setting, an influence measure would correspond to a simple game if it is binary (e.g. it measures some threshold behavior, or corresponds to a binary classifier). The binary requirement is rather strong; however, we wish to draw the reader's attention to the Deegan-Packel index, as it has an interesting connection to causal responsibility [41], a variant of the classic Pearl-Halpern causality model [40], which aims to measure the degree to which a single variable causes an outcome.

Given a simple game v:2^{N}\rightarrow\{0,1\}, let \mathcal{M}(v) be the set of minimal winning coalitions; that is, for every S\in\mathcal{M}(v),v(S)=1, and v(T)=0 for every strict subset of S. The Deegan-Packel index assigns a value of\begin{equation*} \delta_{i}(N,v)=\frac{1}{\vert\mathcal{M}(v)\vert}\sum_{S\in\mathcal{M}(v):i\in S}\frac{1}{\vert S\vert}. \end{equation*}
View Source

The intuition behind the Deegan-Packel index is as follows: players will not form coalitions any larger than what they absolutely have to in order to win, so it does not make sense to measure their effect on non-minimal winning coalitions. Furthermore, when a minimal winning coalition is formed, the benefits from its formation are divided equally among its members; in particular, small coalitions confer a greater benefit for those forming them than large ones. The Deegan-Packel index measures the expected payment one receives, assuming that every minimal winning coalition is equally likely to form. Interestingly, the Deegan-Packel index corresponds nicely to the notion of responsibility and blame described in [41]. Suppose that we have a set of variables X_{1},\ldots,X_{n} set to x_{1},\ldots,x_{n}, and some binary effect f(x_{1},\ldots,x_{n}) (written as f(\mathbf{x})) occurs (say, f(\mathbf{x})=1). To establish a causal relation between the setting of X_{i} to x_{i} and f(\mathbf{x})=1, [40] require that there is some set S\subseteq N\backslash\{i\} and some values (y_{j})_{j\in S\cup\{i\}} such that f(\mathbf{x}_{-S\cup\{i\}},(y_{j})_{j\in S\cup\{i\}})=0, but f(\mathbf{x}_{-S},(y_{j})_{j\in S})=1. In words, an intervention on the values of both S and i may cause a change in the value of f, but performing the same intervention just on the variables in S would not cause such a change. This definition is at the heart of the marginal contribution approach to interventions that we describe in Section III-A. [41] define the responsibility of i for an outcome as \frac{1}{k+1}, where k is the size of the smallest set S for which the causality definition holds with respect to i. The Deegan-Packel index can thus be thought of as measuring a similar notion: instead of taking the overall minimal number of changes necessary in order to make i a direct, counterfactual cause, we observe all minimal sets that do so. Taking the average responsibility of i (referred to as blame in [41]) according to this variant, we obtain the Deegan-Packel index.

Example 16
Let us examine the following setup, based on Example 3.3 in [41]. There are n=2k+1 voters (n is an odd number) who must choose between two candidates, Mr. B and Mr. G ([41] describe the setting with n=11). All voters elected Mr. B, resulting in an n-0 win. It is natural to ask: how responsible was voter i for the victory of Mr. B ? According to [41], the degree of responsibility of each voter is \frac{1}{k+1}. It will require that i and k additional voters change their vote in order for the outcome to change. Modeling this setup as a cooperative game is quite natural: the voters are the players N=\{1,\ldots,n\}; for every subset S\subseteq N we have\begin{equation*} v(S)=\begin{cases} 1 & \text{if}\ \vert S\vert\geq k+1\\ 0 & \text{otherwise}. \end{cases} \end{equation*}
View Source

That is, v(S)=1 if and only if the set S can change the outcome of the election. The minimal winning coalitions here are the subsets of N of size k+1, thus the Deegan-Packel index of player i is\begin{align*} \delta_{i}(N,v) & =\frac{1}{\vert\mathcal{M}(v)\vert}\sum_{S\in\mathcal{M}(v):i\in S}\frac{1}{\vert S\vert}\\ & =\frac{1}{\binom{n}{k+1}}\binom{n}{k}\frac{1}{k+1}=\frac{1}{n-k}=\frac{1}{k+1} \end{align*}
View SourceRight-click on figure for MathML and additional features.

We note that if one assumes that all voters are equally likely to prefer Mr. B over Mr. G, then the blame of voter i would be computed in the exact manner as the Deegan-Packel index.

